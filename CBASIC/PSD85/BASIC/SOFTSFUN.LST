   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   SOFTSFUN.bas  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.4  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************
  10: 0000: \***
  11: 0000: \***   $Log:   V:/Archive/Basarch/SOFTSFUN.bav  $
  12: 0000: \***   
  13: 0000: \***      Rev 1.4   26 Oct 2006 14:26:46   paul.bowers
  14: 0000: \***    
  15: 0000: \***   
  16: 0000: \***      Rev 1.3   Oct 22 1999 14:47:44   dev11ps
  17: 0000: \***    
  18: 0000: \***   
  19: 0000: \***      Rev 1.2   22 Mar 1995 13:23:18   DEVDSPS
  20: 0000: \***   Fix to WRITE.SOFTS
  21: 0000: \***   
  22: 0000: \***      Rev 1.1   11 Oct 1994 15:04:22   NIK
  23: 0000: \***    
  24: 0000: \***   
  25: 0000: \***      Rev 1.0   11 Oct 1994 14:50:00   DEVNSPS
  26: 0000: \***    
  27: 0000: \***   
  28: 0000: \******************************************************************************
  29: 0000: \******************************************************************************REM \
  30: 0000: \******************************************************************************
  31: 0000: \******************************************************************************
  32: 0000: \***
  33: 0000: \***               FUNCTIONS FOR THE SOFTWARE STATUS FILE
  34: 0000: \***
  35: 0000: \***                     REFERENCE    : SOFTSFUN.BAS
  36: 0000: \***
  37: 0000: \***	   Version A          Andrew Wedgeworth           24th June 1992
  38: 0000: \***
  39: 0000: \***   Version B               Nik Sen                 11th October 1994
  40: 0000: \***   Added WRITE.SOFTS function. This function had been added previously
  41: 0000: \***   but was not on the archive.      
  42: 0000: \***
  43: 0000: \***   Version C           David Smallwood             22nd March 1995
  44: 0000: \***   Correct WRITE.SOFTS: pad with spaces and terminate with 0D0A.
  45: 0000: \***
  46: 0000: \******************************************************************************
  47: 0000: \*******************************************************************************
  48: 0000: 
  49: 0000:    %INCLUDE SOFTSDEC.J86
  50: 0000: REM \
  51: 0000: \******************************************************************************
  52: 0000: \******************************************************************************
  53: 0000: \***
  54: 0000: \***                 %INCLUDE FOR THE SOFTWARE STATUS FILE
  55: 0000: \***   
  56: 0000: \***                      FILE TYPE  :   Direct
  57: 0000: \***
  58: 0000: \***                      REFERENCE  :   SOFTSDEC.J86
  59: 0000: \***
  60: 0000: \***	Version A	       Andrew Wedgeworth	      24th June 1992
  61: 0000: \***
  62: 0000: \******************************************************************************
  63: 0000: \*******************************************************************************
  64: 0000: 
  65: 0000:   STRING GLOBAL           \
  66: 0000:     SOFTS.RECORD$,        \           
  67: 0000:     SOFTS.SPACE$,         \           
  68: 0000:     SOFTS.FILE.NAME$    
  69: 0000:     
  70: 0000:   INTEGER*2 GLOBAL        \
  71: 0000:     SOFTS.RECL%,          \            
  72: 0000:     SOFTS.REPORT.NUM%,	  \      
  73: 0000:     SOFTS.SESS.NUM%
  74: 0000: 
  75: 0000:   INTEGER*4 GLOBAL        \
  76: 0000:     SOFTS.REC.NUM% 	         
  77: 0000: 
  78: 0000:    INTEGER*2 GLOBAL CURRENT.REPORT.NUM%
  79: 0000: 
  80: 0000:    STRING GLOBAL                                                       \
  81: 0000:       CURRENT.CODE$,                                                   \
  82: 0000:       FILE.OPERATION$          
  83: 0000:    
  84: 0000:    
  85: 0000:    FUNCTION SOFTS.SET PUBLIC   
  86: 0014:  \***************************
  87: 0014:   
  88: 0014:       SOFTS.REPORT.NUM% = 247            
  89: 001d:       SOFTS.RECL%       = 80 
  90: 0026:       SOFTS.FILE.NAME$  = "SOFTS"
  91: 0035:   
  92: 0035:   
  93: 0035:    END FUNCTION
  94: 0041: \------------------------------------------------------------------------------
  95: 0041: REM EJECT^L    
  96: 0041:  
  97: 0041:  
  98: 0041:    FUNCTION READ.SOFTS PUBLIC
  99: 0055:  \****************************   
 100: 0055: 
 101: 0055:       INTEGER*2 I%, READ.SOFTS      
 102: 0055:     
 103: 0055:       READ.SOFTS = 1
 104: 005a: 
 105: 005a:       IF END #SOFTS.SESS.NUM% THEN END.OF.SOFTS    
 106: 006e:       READ FORM "T1,C80"; #SOFTS.SESS.NUM%,SOFTS.REC.NUM%; SOFTS.RECORD$
 107: 00a0:     
 108: 00a0:       I% = 78
 109: 00a6:       WHILE MID$(SOFTS.RECORD$,I%,1) = " "      \
 110: 00a8:        AND  I% > 1                           
 111: 00a8:          I% = I% - 1
 112: 00ac:       WEND
 113: 00f6:       SOFTS.RECORD$ = LEFT$(SOFTS.RECORD$,I%)  
 114: 0117: 
 115: 0117:       READ.SOFTS = 0     
 116: 011c:       EXIT FUNCTION      
 117: 011e:       
 118: 011e:       
 119: 011e:       END.OF.SOFTS:
 120: 011e:       
 121: 011e:          FILE.OPERATION$     = "R"
 122: 012d:          CURRENT.CODE$       = PACK$("0000000000000000")
 123: 0141:          CURRENT.REPORT.NUM% = SOFTS.REPORT.NUM%	 	  
 124: 014f: 
 125: 014f:          EXIT FUNCTION	                   
 126: 0151:           
 127: 0151: 
 128: 0151:    END FUNCTION                             
 129: 0160: 
 130: 0160: \---------------------------------------------------------------------------- 
 131: 0160:    FUNCTION WRITE.SOFTS PUBLIC
 132: 0174:  \****************************   
 133: 0174: 
 134: 0174:       INTEGER*2 I%, WRITE.SOFTS                                                    
 135: 0174:     
 136: 0174:       WRITE.SOFTS = 1      
 137: 0179:   
 138: 0179:       SOFTS.SPACE$ = STRING$(78 - LEN(SOFTS.RECORD$), " ")                !1.2
 139: 01a4:       SOFTS.RECORD$ = SOFTS.RECORD$ + SOFTS.SPACE$ + CHR$(13) + CHR$(10)  !1.2
 140: 01e1:   
 141: 01e1:       IF END #SOFTS.SESS.NUM% THEN END.OF.WRITE.SOFTS  
 142: 01f5:       WRITE FORM "C80"; #SOFTS.SESS.NUM%,SOFTS.REC.NUM%; SOFTS.RECORD$    !1.2          
 143: 0227:  
 144: 0227:       WRITE.SOFTS = 0     
 145: 022c:       EXIT FUNCTION      
 146: 022e:       
 147: 022e:       
 148: 022e:       END.OF.WRITE.SOFTS:
 149: 022e:       
 150: 022e:          FILE.OPERATION$     = "W"
 151: 023d:          CURRENT.CODE$       = PACK$("0000000000000000")
 152: 0251:          CURRENT.REPORT.NUM% = SOFTS.REPORT.NUM%	 	  
 153: 025f: 
 154: 025f:          EXIT FUNCTION	                   
 155: 0261:           
 156: 0261: 
 157: 0261:    END FUNCTION                           
 158: 0270: \------------------------------------------------------------------------------
 159: 0270: REM EJECT^L
 160: 0270: 
 161: 0270: \------------------------------------------------------------------------------
 162: 0270: End of Compilation
