   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   STKTFFUN.BAS  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.2  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************\******************************************************************************
  10: 0000: \******************************************************************************
  11: 0000: \***
  12: 0000: \***              STOCKTAKE TOTALS FILE FUNCTIONS
  13: 0000: \***
  14: 0000: \***               REFERENCE    : STKTFFUN.BAS
  15: 0000: \***
  16: 0000: \***         VERSION A            Nik Sen         15th July 1997
  17: 0000: \***
  18: 0000: \***
  19: 0000: \*******************************************************************************
  20: 0000: \*******************************************************************************
  21: 0000: 
  22: 0000:     INTEGER*2 GLOBAL                \
  23: 0000:        CURRENT.REPORT.NUM%
  24: 0000:        
  25: 0000:     STRING GLOBAL                    \
  26: 0000:        CURRENT.CODE$,                \
  27: 0000:        FILE.OPERATION$
  28: 0000:     
  29: 0000:     %INCLUDE STKTFDEC.J86                                              
  30: 0000: \******************************************************************************
  31: 0000: \******************************************************************************
  32: 0000: \***
  33: 0000: \***   $Workfile:   STKTFDEC.J86  $
  34: 0000: \***
  35: 0000: \***   $Revision:   1.1  $
  36: 0000: \***
  37: 0000: \******************************************************************************
  38: 0000: \******************************************************************************
  39: 0000: \***
  40: 0000: \***   $Log:   V:\archive\j86\stktfdec.j8v  $
  41: 0000: \***   
  42: 0000: \***      Rev 1.1   15 Jul 1997 14:36:28   DEV45PS
  43: 0000: \***    
  44: 0000: \***   
  45: 0000: \***      Rev 1.0   15 Jul 1997 14:21:02   DEV45PS
  46: 0000: \***   Stocktake System New Files
  47: 0000: \***   
  48: 0000: \******************************************************************************
  49: 0000: \******************************************************************************\******************************************************************************
  50: 0000: \******************************************************************************
  51: 0000: \***
  52: 0000: \***         %INCLUDE FOR STOCKTAKE TOTALS FILE FIELD DECLARATIONS
  53: 0000: \***
  54: 0000: \***               FILE TYPE    : KEYED
  55: 0000: \***
  56: 0000: \***               REFERENCE    : STKTFDEC.J86
  57: 0000: \***
  58: 0000: \***    VERSION A.              Nik Sen.               15 July 1997.
  59: 0000: \***    New file for stocktaking system. Holds information about all counted
  60: 0000: \***    items found on the STOCK and IDF files. Key is Boots Code. 
  61: 0000: \***
  62: 0000: \*******************************************************************************
  63: 0000: \*******************************************************************************
  64: 0000: 
  65: 0000: STRING GLOBAL                                                  \
  66: 0000:        STKTF.FILE.NAME$,               \
  67: 0000:        STKTF.BOOTS.CODE$,              \
  68: 0000:        STKTF.BUSINESS.CENTRE$,         \
  69: 0000:        STKTF.GROUP.SEQUENCE$,          \
  70: 0000:        STKTF.QUANTITY$                
  71: 0000: 
  72: 0000: 
  73: 0000: 
  74: 0000: INTEGER*2 GLOBAL                \
  75: 0000:    STKTF.REPORT.NUM%,           \
  76: 0000:    STKTF.SESS.NUM%             
  77: 0000: 
  78: 0000: 
  79: 0000: INTEGER*1 GLOBAL                \
  80: 0000:    STKTF.RECL%         
  81: 0000: 
  82: 0000: 
  83: 0000: 
  84: 0000:   FUNCTION STKTF.SET PUBLIC
  85: 0014: \***************************
  86: 0014: 
  87: 0014:     STKTF.REPORT.NUM% = 534
  88: 001d:     STKTF.RECL%       = 11
  89: 0025:     STKTF.FILE.NAME$  = "STKTF"
  90: 0034:     
  91: 0034:   END FUNCTION
  92: 0040:     
  93: 0040: \-----------------------------------------------------------------------------
  94: 0040: 
  95: 0040: FUNCTION READ.STKTF PUBLIC
  96: 0054: \****************************
  97: 0054: 
  98: 0054:     INTEGER*2 READ.STKTF
  99: 0054:     
 100: 0054:     READ.STKTF = 1
 101: 0059:                  
 102: 0059: 
 103: 0059:     IF END #STKTF.SESS.NUM% THEN READ.STKTF.ERROR
 104: 006d:     READ FORM "T5,C3,C1,C3"; #STKTF.SESS.NUM% KEY STKTF.BOOTS.CODE$;     \
 105: 00b5:        STKTF.QUANTITY$,                                                \
 106: 00b5:        STKTF.BUSINESS.CENTRE$,                                         \
 107: 00b5:        STKTF.GROUP.SEQUENCE$                                          
 108: 00b5:          
 109: 00b5: 
 110: 00b5:     READ.STKTF = 0
 111: 00ba:     EXIT FUNCTION
 112: 00bc:     
 113: 00bc: READ.STKTF.ERROR:
 114: 00bc:     
 115: 00bc: 
 116: 00bc:        FILE.OPERATION$ = "R"
 117: 00cb:        CURRENT.REPORT.NUM% = STKTF.REPORT.NUM%
 118: 00d9:        
 119: 00d9:        EXIT FUNCTION
 120: 00db: 
 121: 00db: END FUNCTION
 122: 00ea: 
 123: 00ea: \-----------------------------------------------------------------------------
 124: 00ea:   
 125: 00ea: FUNCTION WRITE.STKTF PUBLIC
 126: 00fe: \****************************
 127: 00fe: 
 128: 00fe:     INTEGER*2 WRITE.STKTF
 129: 00fe:     
 130: 00fe:     WRITE.STKTF = 1
 131: 0103:                  
 132: 0103: 
 133: 0103:     IF END #STKTF.SESS.NUM% THEN WRITE.STKTF.ERROR
 134: 0117:     WRITE FORM "C4,C3,C1,C3"; #STKTF.SESS.NUM%;                   \
 135: 0169:        STKTF.BOOTS.CODE$,                                                     \
 136: 0169:        STKTF.QUANTITY$,                                                \
 137: 0169:        STKTF.BUSINESS.CENTRE$,                                         \
 138: 0169:        STKTF.GROUP.SEQUENCE$                                          
 139: 0169: 
 140: 0169: 
 141: 0169:     WRITE.STKTF = 0
 142: 016e:     EXIT FUNCTION
 143: 0170:     
 144: 0170: WRITE.STKTF.ERROR:
 145: 0170:     
 146: 0170: 
 147: 0170:        FILE.OPERATION$ = "R"
 148: 017f:        CURRENT.REPORT.NUM% = STKTF.REPORT.NUM%
 149: 018d:        
 150: 018d:        EXIT FUNCTION
 151: 018f: 
 152: 018f: END FUNCTION
 153: 019e: 
 154: 019e: 
 155: 019e: 
 156: 019e: End of Compilation
