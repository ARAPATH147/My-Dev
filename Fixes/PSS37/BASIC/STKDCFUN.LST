   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   STKDCFUN.BAS  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.2  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************\******************************************************************************
  10: 0000: \******************************************************************************
  11: 0000: \***
  12: 0000: \***              STOCKTAKE DUMP CODE FILE FUNCTIONS
  13: 0000: \***
  14: 0000: \***               REFERENCE    : STKDCFUN.BAS
  15: 0000: \***
  16: 0000: \***         VERSION A            Nik Sen         19th June 1997
  17: 0000: \***
  18: 0000: \***         VERSION B            Johnnie Chan    11th December 1997
  19: 0000: \***         Added extra digit to location code.
  20: 0000: \***
  21: 0000: \***
  22: 0000: \*******************************************************************************
  23: 0000: \*******************************************************************************
  24: 0000: 
  25: 0000:     INTEGER*2 GLOBAL                \
  26: 0000:        CURRENT.REPORT.NUM%
  27: 0000:        
  28: 0000:     STRING GLOBAL                    \
  29: 0000:        CURRENT.CODE$,                \
  30: 0000:        FILE.OPERATION$
  31: 0000:     
  32: 0000:     %INCLUDE STKDCDEC.J86                                             
  33: 0000: \******************************************************************************
  34: 0000: \******************************************************************************
  35: 0000: \***
  36: 0000: \***   $Workfile:   STKDCDEC.J86  $
  37: 0000: \***
  38: 0000: \***   $Revision:   1.0  $
  39: 0000: \***
  40: 0000: \******************************************************************************
  41: 0000: \******************************************************************************
  42: 0000: \***
  43: 0000: \***   $Log:   V:\archive\j86\stkdcdec.j8v  $
  44: 0000: \***   
  45: 0000: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
  46: 0000: \***    
  47: 0000: \***   
  48: 0000: \***      Rev 1.0   09 Jul 1997 11:04:58   DEV45PS
  49: 0000: \***   Stocktake System New Files
  50: 0000: \***   
  51: 0000: \******************************************************************************
  52: 0000: \******************************************************************************\******************************************************************************
  53: 0000: \******************************************************************************
  54: 0000: \***
  55: 0000: \***         %INCLUDE FOR STOCKTAKE DUMP CODEP FIELD DECLARATIONS
  56: 0000: \***
  57: 0000: \***               FILE TYPE    : DIRECT
  58: 0000: \***
  59: 0000: \***               REFERENCE    : STKDCDEC.J86
  60: 0000: \***
  61: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
  62: 0000: \***    New file for stocktaking system. Holds all items counted using
  63: 0000: \***    dump codes during the stocktake.
  64: 0000: \***
  65: 0000: \*******************************************************************************
  66: 0000: \*******************************************************************************
  67: 0000: 
  68: 0000: STRING GLOBAL                                                  \
  69: 0000:        STKDC.FILE.NAME$,               \
  70: 0000:        STKDC.DUMP.CODE$,               \
  71: 0000:        STKDC.QUANTITY$,                \
  72: 0000:        STKDC.PRICE$,                   \
  73: 0000:        STKDC.LOCATION$,                \
  74: 0000:        STKDC.STOCKTAKER.NUM$
  75: 0000:         
  76: 0000: INTEGER*4 GLOBAL               \
  77: 0000:        STKDC.RECORD.NUM%
  78: 0000: 
  79: 0000: 
  80: 0000: INTEGER*2 GLOBAL                \
  81: 0000:    STKDC.REPORT.NUM%,           \
  82: 0000:    STKDC.SESS.NUM%             
  83: 0000: 
  84: 0000: 
  85: 0000: INTEGER*1 GLOBAL                \
  86: 0000:    STKDC.RECL%         
  87: 0000: 
  88: 0000: 
  89: 0000: 
  90: 0000:   FUNCTION STKDC.SET PUBLIC
  91: 0014: \***************************
  92: 0014: 
  93: 0014:     STKDC.REPORT.NUM% = 528
  94: 001d:     STKDC.RECL%       =20                      !*Ver B*
  95: 0025:     STKDC.FILE.NAME$  = "STKDC"
  96: 0034:     
  97: 0034:   END FUNCTION
  98: 0040:     
  99: 0040: \-----------------------------------------------------------------------------
 100: 0040: 
 101: 0040: FUNCTION READ.STKDC PUBLIC
 102: 0054: \****************************
 103: 0054: 
 104: 0054:     INTEGER*2 READ.STKDC
 105: 0054:     
 106: 0054:     READ.STKDC = 1
 107: 0059:     
 108: 0059:     IF END #STKDC.SESS.NUM% THEN READ.STKDC.ERROR
 109: 006d:     READ FORM "C7,2C3,C5,C2"; #STKDC.SESS.NUM%,STKDC.RECORD.NUM%;  \*Ver B*
 110: 00cb:          STKDC.DUMP.CODE$,                             \
 111: 00cb:          STKDC.QUANTITY$,                              \
 112: 00cb:          STKDC.PRICE$,                                 \
 113: 00cb:          STKDC.LOCATION$,                              \
 114: 00cb:          STKDC.STOCKTAKER.NUM$
 115: 00cb: 
 116: 00cb:     READ.STKDC = 0
 117: 00d0:     EXIT FUNCTION
 118: 00d2:     
 119: 00d2: READ.STKDC.ERROR:
 120: 00d2:     
 121: 00d2:        FILE.OPERATION$ = "R"
 122: 00e1:        CURRENT.REPORT.NUM% = STKDC.REPORT.NUM%
 123: 00ef:        
 124: 00ef:        EXIT FUNCTION
 125: 00f1: 
 126: 00f1: END FUNCTION
 127: 0100: 
 128: 0100: \-----------------------------------------------------------------------------
 129: 0100:   
 130: 0100: 
 131: 0100:   
 132: 0100: FUNCTION WRITE.STKDC PUBLIC
 133: 0114: \*****************************
 134: 0114: 
 135: 0114:        INTEGER*2 WRITE.STKDC
 136: 0114:     
 137: 0114:        WRITE.STKDC = 1
 138: 0119:     
 139: 0119:        IF END #STKDC.SESS.NUM% THEN WRITE.STKDC.ERROR
 140: 012d:        WRITE FORM "C7,2C3,C5,C2"; #STKDC.SESS.NUM%,STKDC.RECORD.NUM%; \*Ver B*
 141: 019f:                STKDC.DUMP.CODE$,                               \
 142: 019f:                STKDC.QUANTITY$,                                \
 143: 019f:                STKDC.PRICE$,                                   \
 144: 019f:                STKDC.LOCATION$,                                \
 145: 019f:                STKDC.STOCKTAKER.NUM$
 146: 019f: 
 147: 019f:        WRITE.STKDC = 0
 148: 01a4:        EXIT FUNCTION
 149: 01a6:    
 150: 01a6: WRITE.STKDC.ERROR:
 151: 01a6:    
 152: 01a6: 
 153: 01a6:       FILE.OPERATION$ = "W"                                            
 154: 01b5:       CURRENT.REPORT.NUM% = STKDC.REPORT.NUM%
 155: 01c3:       
 156: 01c3:       EXIT FUNCTION
 157: 01c5: 
 158: 01c5: END FUNCTION
 159: 01d4: 
 160: 01d4: 
 161: 01d4: End of Compilation
