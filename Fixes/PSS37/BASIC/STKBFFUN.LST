   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   STKBFFUN.BAS  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.3  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************\******************************************************************************
  10: 0000: \******************************************************************************
  11: 0000: \***
  12: 0000: \***              STOCKTAKE BUFFER FILE FUNCTIONS
  13: 0000: \***
  14: 0000: \***               REFERENCE    : STKBFFUN.BAS
  15: 0000: \***
  16: 0000: \***         VERSION A            Nik Sen         19th June 1997
  17: 0000: \***
  18: 0000: \***         VERSION B            Nik Sen         18th August 1997
  19: 0000: \***         Changed file length.
  20: 0000: \***
  21: 0000: \***         VERSION C            Nik Sen         10th December 1997
  22: 0000: \***         Changed file length again.
  23: 0000: \***
  24: 0000: \*******************************************************************************
  25: 0000: \*******************************************************************************
  26: 0000: 
  27: 0000:     INTEGER*2 GLOBAL                \
  28: 0000:        CURRENT.REPORT.NUM%
  29: 0000:        
  30: 0000:     STRING GLOBAL                    \
  31: 0000:        CURRENT.CODE$,                \
  32: 0000:        FILE.OPERATION$
  33: 0000:     
  34: 0000:     %INCLUDE STKBFDEC.J86                                              
  35: 0000: \******************************************************************************
  36: 0000: \******************************************************************************
  37: 0000: \***
  38: 0000: \***   $Workfile:   STKBFDEC.J86  $
  39: 0000: \***
  40: 0000: \***   $Revision:   1.0  $
  41: 0000: \***
  42: 0000: \******************************************************************************
  43: 0000: \******************************************************************************
  44: 0000: \***
  45: 0000: \***   $Log:   V:\archive\j86\stkbfdec.j8v  $
  46: 0000: \***   
  47: 0000: \***      Rev 1.0   15 Jul 1997 14:20:36   DEV45PS
  48: 0000: \***    
  49: 0000: \***   
  50: 0000: \***      Rev 1.0   09 Jul 1997 11:04:52   DEV45PS
  51: 0000: \***   Stocktake System New Files
  52: 0000: \***   
  53: 0000: \******************************************************************************
  54: 0000: \******************************************************************************\******************************************************************************
  55: 0000: \******************************************************************************
  56: 0000: \***
  57: 0000: \***         %INCLUDE FOR STOCKTAKE BUFFER FILE FIELD DECLARATIONS
  58: 0000: \***
  59: 0000: \***               FILE TYPE    : DIRECT
  60: 0000: \***
  61: 0000: \***               REFERENCE    : STKBFDEC.J86
  62: 0000: \***
  63: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
  64: 0000: \***    New file for stocktaking system. Holds counts read from PDT.
  65: 0000: \***
  66: 0000: \*******************************************************************************
  67: 0000: \*******************************************************************************
  68: 0000: 
  69: 0000: STRING GLOBAL                                                  \
  70: 0000:    STKBF.FILE.NAME$,           \
  71: 0000:    STKBF.DATA$,                \
  72: 0000:    STKBF.STORE.NUMBER$,        \
  73: 0000:    STKBF.STOCKTAKER.NO$,       \
  74: 0000:    STKBF.DATE$,                \
  75: 0000:    STKBF.LOCATION$,            \
  76: 0000:    STKBF.ITEM.CODE$,           \
  77: 0000:    STKBF.QUANTITY$,            \
  78: 0000:    STKBF.PRICE$,               \
  79: 0000:    STKBF.RECORD.COUNT$,        \
  80: 0000:    STKBF.FILLER$
  81: 0000: 
  82: 0000: 
  83: 0000: INTEGER*4 GLOBAL               \
  84: 0000:    STKBF.RECORD.NUM%
  85: 0000: 
  86: 0000: INTEGER*2 GLOBAL                \
  87: 0000:    STKBF.REPORT.NUM%,           \
  88: 0000:    STKBF.SESS.NUM%             
  89: 0000: 
  90: 0000: 
  91: 0000: INTEGER*1 GLOBAL                \
  92: 0000:    STKBF.RECL%         
  93: 0000: 
  94: 0000: 
  95: 0000: 
  96: 0000:   FUNCTION STKBF.SET PUBLIC
  97: 0014: \***************************
  98: 0014: 
  99: 0014:     STKBF.REPORT.NUM% = 525
 100: 001d:     STKBF.RECL%       = 30                                             ! CNS
 101: 0025:     STKBF.FILE.NAME$  = "STKBF"
 102: 0034:     
 103: 0034:   END FUNCTION
 104: 0040:     
 105: 0040: \-----------------------------------------------------------------------------
 106: 0040: 
 107: 0040: FUNCTION READ.STKBF PUBLIC
 108: 0054: \****************************
 109: 0054: 
 110: 0054:     INTEGER*2 READ.STKBF
 111: 0054:     
 112: 0054:     READ.STKBF = 1
 113: 0059:     
 114: 0059:     IF END #STKBF.SESS.NUM% THEN READ.STKBF.ERROR
 115: 006d:     READ #STKBF.SESS.NUM%;                             \
 116: 008b:        STKBF.DATA$                                    
 117: 008b: 
 118: 008b:     READ.STKBF = 0
 119: 0090:     EXIT FUNCTION
 120: 0092:     
 121: 0092: READ.STKBF.ERROR:
 122: 0092:     
 123: 0092:        FILE.OPERATION$ = "R"
 124: 00a1:        CURRENT.REPORT.NUM% = STKBF.REPORT.NUM%
 125: 00af:        
 126: 00af:        EXIT FUNCTION
 127: 00b1: 
 128: 00b1: END FUNCTION
 129: 00c0:                
 130: 00c0: 
 131: 00c0: \-----------------------------------------------------------------------------
 132: 00c0:   
 133: 00c0: 
 134: 00c0:   
 135: 00c0: FUNCTION WRITE.STKBF PUBLIC
 136: 00d4: \*****************************
 137: 00d4: 
 138: 00d4:        INTEGER*2 WRITE.STKBF
 139: 00d4:     
 140: 00d4:        WRITE.STKBF = 1
 141: 00d9:     
 142: 00d9:        IF END #STKBF.SESS.NUM% THEN WRITE.STKBF.ERROR
 143: 00ed:        WRITE #STKBF.SESS.NUM%;                        \
 144: 010b:           STKBF.DATA$                                    
 145: 010b: 
 146: 010b: 
 147: 010b: 
 148: 010b: 
 149: 010b:        WRITE.STKBF = 0
 150: 0110: 
 151: 0110:        EXIT FUNCTION
 152: 0112:    
 153: 0112: WRITE.STKBF.ERROR:
 154: 0112:    
 155: 0112:       FILE.OPERATION$ = "W"                                            
 156: 0121:       CURRENT.REPORT.NUM% = STKBF.REPORT.NUM%
 157: 012f:       
 158: 012f:       EXIT FUNCTION
 159: 0131: 
 160: 0131: END FUNCTION
 161: 0140: 
 162: 0140: 
 163: 0140: End of Compilation
