   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***                                                                        ***
   4: 0000: \***                                                                        ***
   5: 0000: \***                                                                        ***
   6: 0000: \***           PROGRAM  :  PSS3705                                          ***
   7: 0000: \***                                                                        ***
   8: 0000: \***           AUTHOR   :  Brian Greenfield                                 ***
   9: 0000: \***                                                                        ***
  10: 0000: \***           DATE     :  17th July 2003                                   ***
  11: 0000: \***                                                                        ***
  12: 0000: \***                                                                        ***
  13: 0000: \***                                                                        ***
  14: 0000: \******************************************************************************
  15: 0000: \******************************************************************************
  16: 0000: 
  17: 0000: \******************************************************************************
  18: 0000: \******************************************************************************
  19: 0000: \***                                                                        ***
  20: 0000: \***   O V E R V I E W                                                      ***
  21: 0000: \***                                                                        ***
  22: 0000: \***                                                                        ***
  23: 0000: \***   PSS37 - P.D.T Support Program.                                       ***
  24: 0000: \***                                                                        ***
  25: 0000: \***                                                                        ***
  26: 0000: \***   PSS37 is designed to run concurrently with PSS38. PSS38 handles      ***
  27: 0000: \***   all asyncronous communications with a connected PDT. All data        ***
  28: 0000: \***   sent by the PDT is passed to PSS37 via PSS38 by means of a 'pipe'.   ***
  29: 0000: \***   PSS37 validates the data sent to ensure the data has been sent in    ***
  30: 0000: \***   the correct sequence, has a valid format and is meaningful.          ***
  31: 0000: \***   the correct sequence, has a valid format and is meaningful.          ***
  32: 0000: \***   There are basically two processes PSS37 performs ;                   ***
  33: 0000: \***   i)  takes counts from a PDT and puts them in the stock movement,     ***
  34: 0000: \***   ii) creates a file of lists requested by a PDT.                      ***
  35: 0000: \***                                                                        ***
  36: 0000: \***   This module was created to contain the bulk of the processing for    ***
  37: 0000: \***   the new store stock counts.                                          ***
  38: 0000: \***   The functional logic of this code was obtained from the PSS82 screen ***
  39: 0000: \***   program with the screen handling and messaging display stripped out. ***
  40: 0000: \***                                                                        ***
  41: 0000: \***                                                                        ***
  42: 0000: \******************************************************************************
  43: 0000: \******************************************************************************
  44: 0000: 
  45: 0000: \******************************************************************************
  46: 0000: \******************************************************************************
  47: 0000: \***                                                                        ***
  48: 0000: \***   A M E N D M E N T S                                                  ***
  49: 0000: \***                                                                        ***
  50: 0000: \***   Version A.   Initial Version                   24th July 2003        ***
  51: 0000: \***                                                                        ***
  52: 0000: \***   Version 1.1  Julia Stones                      22nd October 2003     ***
  53: 0000: \***   This module has been updated to contain the bulk of the processing   ***
  54: 0000: \***   to allow SmartScript pharmacy stock to be counted, and those counts  ***
  55: 0000: \***   to be available in a file ready for transfer to the new SmartScript  ***
  56: 0000: \***   pharmacy system.                                                     ***
  57: 0000: \***   Upon successfull completion the program will ADXSTART PSD45 which    ***
  58: 0000: \***   transfer the file to the pharmacy system.                            ***
  59: 0000: \***   A confirmation report will be sent directly to the printer, showing  ***
  60: 0000: \***   Store number, Stock takers number, Date, Time, Count area and number ***
  61: 0000: \***   of items counted                                                     ***
  62: 0000: \***                                                                        ***
  63: 0000: \***   Version 1.2 Julia Stones                      17th December 2003     ***
  64: 0000: \***   A small change to the confirmation report - to print what type of    ***
  65: 0000: \***   count (Book in or Count)and for what area (MDS or Dispensing)        ***
  66: 0000: \***                                                                        ***
  67: 0000: \***   Version 1.3 Julia Stones                      22nd January 2004      ***
  68: 0000: \***   The output files BTCS need to have a carriage return line feed after ***
  69: 0000: \***   each record.  Program changed to add carriage return line feed to    ***
  70: 0000: \***   each record on the BTCS files                                        ***
  71: 0000: \***                                                                        ***
  72: 0000: \***   Version 1.4 Charles Skadorwa                  3rd February 2005      ***
  73: 0000: \***   Change to incorporate new Rectification Process logic in             ***
  74: 0000: \***   Upwards TSF Adjustments in subroutine:  CHECK.STATUS.COUNT           ***
  75: 0000: \***   Fix to Stock Counting PDT Timeout - processing now performed by      ***
  76: 0000: \***   another program to prevent PDT timing out due to waiting for         ***
  77: 0000: \***   processing to complete before receiving End Of Transmission.         ***
  78: 0000: \***                                                                        ***
  79: 0000: \***   Version 1.5 Brian Greenfield                  11th may 2007          ***
  80: 0000: \***   Added new Recalls functions for A7C.                                 ***
  81: 0000: \***                                                                        ***
  82: 0000: \***   Version 1.6   Brian Greenfield                15th April 2008        ***
  83: 0000: \***   Added Reverse Logistics functionality for A8C (part of Recalls.)     ***
  84: 0000: \***                                                                        ***
  85: 0000: \***   Version 1.7   Brian Greenfield                6th May 2008           ***
  86: 0000: \***   Change request to pass MRQ to the PDT for it to display for type     ***
  87: 0000: \***   I & C recalls.                                                       ***
  88: 0000: \***                                                                        ***
  89: 0000: \***   Version 1.8 Charles Skadorwa                  18th June 2008         ***
  90: 0000: \***   Change to expiry date check from >= to > so that recall is still     ***
  91: 0000: \***   visible on the day of expiry.                                        ***
  92: 0000: \***                                                                        ***
  93: 0000: \***   Version 1.9   Stuart Highley                     14 Nov 2008         ***
  94: 0000: \***   Positive UOD Receiving.                                              ***
  95: 0000: \***                                                                        ***
  96: 0000: \***   Version 1.10  Stuart Highley                     11 Mar 2009         ***
  97: 0000: \***   CR10: BOL popup on PDT for +UOD.                                     ***
  98: 0000: \***                                                                        ***
  99: 0000: \******************************************************************************
 100: 0000: \******************************************************************************
 101: 0000: 
 102: 0000: \******************************************************************************
 103: 0000: \******************************************************************************
 104: 0000: \***                                                                        ***
 105: 0000: \***   I N C L U D E S   A N D   V A R I A B L E S                          ***
 106: 0000: \***                                                                        ***
 107: 0000: \******************************************************************************
 108: 0000: \******************************************************************************
 109: 0000: 
 110: 0000:     %INCLUDE PSBF06G.J86                                            ! 1.5BG
 111: 0000: REM\
 112: 0000: \*******************************************************************************
 113: 0000: \*******************************************************************************
 114: 0000: \***
 115: 0000: \***        INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT globals
 116: 0000: \***
 117: 0000: \***        REFERENCE     : PSBF06G.J86
 118: 0000: \***
 119: 0000: \***        Version A     Bruce Scriver                 24th February 1986 
 120: 0000: \***
 121: 0000: \***        Version B     Andrew Wedgeworth                 15th July 1992
 122: 0000: \***        Removal of return code field which no longer required.
 123: 0000: \***
 124: 0000: \*******************************************************************************
 125: 0000: \*******************************************************************************
 126: 0000: 
 127: 0000:       STRING   GLOBAL F06.CHECK.DIGIT$
 128: 0000: 
 129: 0000: 
 130: 0000:     %INCLUDE PSS37G.J86
 131: 0000: \*****************************************************************************
 132: 0000: \*****************************************************************************
 133: 0000: \***                                                                       ***
 134: 0000: \***      G L O B A L   D E F I N I T I O N S   F O R   P S S 3 7          ***
 135: 0000: \***                                                                       ***
 136: 0000: \***           REFERENCE : PSS37G                                          ***
 137: 0000: \***                                                                       ***
 138: 0000: \***           VERSION E                                                   ***
 139: 0000: \***           5th November 1992                                           ***
 140: 0000: \***           Ver D.  Add support for ADXSERCL routine.                   ***
 141: 0000: \***           Ver E.  Add support for LDTBF                               ***
 142: 0000: \***                                                                       ***
 143: 0000: \***                                                                       ***
 144: 0000: \***           Version G                                                   ***
 145: 0000: \***           Add support for Returns/Automatic credit claiming           ***
 146: 0000: \***                                                                       ***
 147: 0000: \***           Version H  Michael J. Kelsall    24th March 1994.           ***
 148: 0000: \***           Add support for CCUPF                                       ***
 149: 0000: \***
 150: 0000: \***           REVISION 1.1  ROBERT COWEY / STEVE WRIGHT  6TH OCTOBER 1994
 151: 0000: \***           Removed version letters from included code (not commented).
 152: 0000: \***
 153: 0000: \***           REVISION 1.2  David Smallwood    26th May 1995
 154: 0000: \***           Add global variable ALLOW.CSR.PROCESSING.
 155: 0000: \***
 156: 0000: \***           REVISION 1.3  Stuart Highly      April 1996
 157: 0000: \***           Gap monitor changes
 158: 0000: \***
 159: 0000: \***           REVISION 1.4  David Smallwood    21st May 1996
 160: 0000: \***           Change global variable "NUM.OF.UODS%" to
 161: 0000: \***           "NUM.STATUS.O.C.X.UODS%".  Add variables "NUM.OF.CANCELLED.UODS%"
 162: 0000: \***           "NUM.OF.DESPATCHED.UODS%".  Add global variables for CCLAM.
 163: 0000: \***
 164: 0000: \***           REVISION 1.5  Nik Sen            30th June 1997
 165: 0000: \***           Add variables for SXTMP STKTK and STKBUF for stocktaking.
 166: 0000: \***
 167: 0000: \***           REVISION 1.6  David Artiss       23rd January 2001
 168: 0000: \***           Add new audit file STLDT
 169: 0000: \***
 170: 0000: \***           REVISION 1.7  Brian Greenfield   17th October 2002
 171: 0000: \***           Added LSSST and IMSTC for LSS stock counts.
 172: 0000: \***
 173: 0000: \***           REVISION 1.8  David Artiss       7th March 2003
 174: 0000: \***           Lots of file and field definitions added for BOL
 175: 0000: \***           stocktake changes.
 176: 0000: \***
 177: 0000: \***           REVISION 1.9  Brian Greenfield   18th July 2003
 178: 0000: \***           New file additions for Store Stock Counts
 179: 0000: \***
 180: 0000: \***           REVISION 2.0  Julia Stones      22nd October 2003
 181: 0000: \***           New file additions for SmartScript Pharmacy Stock system
 182: 0000: \***
 183: 0000: \***           REVISION 2.1  Julia Stones      12th November 2003
 184: 0000: \***           New file additions for Simplification of the credit claim system
 185: 0000: \***
 186: 0000: \***           REVISION 2.2 Julia Stones       12th March 2004
 187: 0000: \***           New file addition for Credit Claim rejection information
 188: 0000: \***
 189: 0000: \***           REVISION 2.3 Charles Skadorwa   10th November 2004
 190: 0000: \***           Shelf Monitor Project: add declarations for PLLOL & PLLDB files
 191: 0000: \***
 192: 0000: \***           REVISION 2.4 Brian Greenfield   11th January 2005
 193: 0000: \***           Fixes to allow old record type P and new record type P to both work.
 194: 0000: \***           The old record type P can be removed next time this module is
 195: 0000: \***           altered.
 196: 0000: \***
 197: 0000: \***           REVISION 2.5    Neil Bennett    22nd December 2006
 198: 0000: \***           Add ASN processing support.
 199: 0000: \***           Remove CSR processing support.
 200: 0000: \***
 201: 0000: \***           REVISION 2.6    Brian Greenfield 11th may 2007
 202: 0000: \***           Added recalls processing for A7C.
 203: 0000: \***
 204: 0000: \*****************************************************************************
 205: 0000: \*****************************************************************************
 206: 0000: 
 207: 0000: \*****************************************************************************
 208: 0000: \***   include global definitions for the following functions and procedures
 209: 0000: \***
 210: 0000: \***     APPLICATION.LOG              01
 211: 0000: \***     READ.NEXT.IEF                11
 212: 0000: \***     SORT.TABLE                   14
 213: 0000: \***     CONV.TO.HEX                  16
 214: 0000: \***     CONV.TO.STRING               17
 215: 0000: \***     SESS.NUM.UTILITY             20
 216: 0000: \***     CIMF
 217: 0000: \***     CITEM
 218: 0000: \***     CSR
 219: 0000: \***     CSRWF
 220: 0000: \***     CSRBF
 221: 0000: \***     FPF
 222: 0000: \***     IDF
 223: 0000: \***     IDSOF
 224: 0000: \***     INVOK
 225: 0000: \***     ONORD
 226: 0000: \***     PCHK
 227: 0000: \***     PIPEI
 228: 0000: \***     UNITS
 229: 0000: \***     STKMQ
 230: 0000: \***     BCSMF
 231: 0000: \***     IEF
 232: 0000: \***     DIRORD
 233: 0000: \***     DIRSUP
 234: 0000: \***     DIRWF
 235: 0000: \***     DIR
 236: 0000: \***     LDTBF
 237: 0000: \***     LDTCF
 238: 0000: \***     UOD
 239: 0000: \***     UODBF
 240: 0000: \***     UODTF
 241: 0000: \***     STKBF
 242: 0000: \***     SXTMP
 243: 0000: \***     STKTK
 244: 0000: \***     SSPSC
 245: 0000: \***     BTCS
 246: 0000: \***     PRINT
 247: 0000: \***     SOPTS
 248: 0000: \***     TSF
 249: 0000: \***     LOCAL
 250: 0000: \***
 251: 0000: \*****************************************************************************
 252: 0000: 
 253: 0000:  %INCLUDE PSBF01G.J86                     ! FLC
 254: 0000: REM \
 255: 0000: \*******************************************************************************
 256: 0000: \*******************************************************************************
 257: 0000: \***
 258: 0000: \***       %INCLUDE FOR GLOBAL DEFINITIONS FOR FUNCTION APPLICATION.LOG
 259: 0000: \***
 260: 0000: \***                FUNCTION NUMBER    : PSBF01
 261: 0000: \***
 262: 0000: \***                REFERENCE          : PSBF01G.J86
 263: 0000: \***
 264: 0000: \***                DATE OF LAST AMENDMENT  - 27/2/86
 265: 0000: \***
 266: 0000: \***
 267: 0000: \*******************************************************************************
 268: 0000: 
 269: 0000:       INTEGER GLOBAL  F01.RETURN.CODE%
 270: 0000: 
 271: 0000: 
 272: 0000:  %INCLUDE PSBF05G.J86                     ! 1.9BG
 273: 0000: REM\
 274: 0000: \*******************************************************************************
 275: 0000: \*******************************************************************************
 276: 0000: \***
 277: 0000: \***        INCLUDE       : CHECK.BOOTS.CODE globals
 278: 0000: \***
 279: 0000: \***        REFERENCE     : PSBF05G.J86
 280: 0000: \***
 281: 0000: \***        Version A      Bruce Scriver              25th February 1986
 282: 0000: \*** 
 283: 0000: \***        Version B      Andrew Wedgeworth              15th July 1992
 284: 0000: \***        Removal of return code field which no longer required.
 285: 0000: \***
 286: 0000: \*******************************************************************************
 287: 0000: \*******************************************************************************
 288: 0000: 
 289: 0000:       STRING   GLOBAL F05.VALID.CODE$
 290: 0000: 
 291: 0000: 
 292: 0000: !%INCLUDE PSBF06G.J86                     ! FLC
 293: 0000:  %INCLUDE PSBF11G.J86                     ! DLC
 294: 0000: REM \
 295: 0000: \*******************************************************************************
 296: 0000: \*******************************************************************************
 297: 0000: \***
 298: 0000: \***    %INCLUDE FOR GLOBALS DEFINITIONS FOR FUNCTION READ.NEXT.IEF
 299: 0000: \***
 300: 0000: \***            FUNCTION NUMBER    : PSBF11
 301: 0000: \***
 302: 0000: \***            REFERENCE          : PSBF11G.J86
 303: 0000: \***
 304: 0000: \***    Version B            Bruce Scriver             11th December 1986 
 305: 0000: \***
 306: 0000: \***    Version C            Andrew Wedgeworth             15th July 1992
 307: 0000: \***    Redundant return code field removed.
 308: 0000: \***
 309: 0000: \*******************************************************************************
 310: 0000: \*******************************************************************************
 311: 0000: 
 312: 0000:       STRING    GLOBAL  F11.ERROR.FLAG$,                               \ BBAAS
 313: 0000:                         F11.NEXT.BAR.CODE$                             ! BBAAS
 314: 0000: 
 315: 0000:       INTEGER*2 GLOBAL  F11.CURRENT.COUNT%
 316: 0000: 
 317: 0000: 
 318: 0000:  %INCLUDE PSBF14G.J86                     ! DLC
 319: 0000: REM\
 320: 0000: \*******************************************************************************
 321: 0000: \*******************************************************************************
 322: 0000: \***
 323: 0000: \***        INCLUDE       : SORT.TABLE globals
 324: 0000: \***
 325: 0000: \***        REFERENCE     : PSBF14G.J86
 326: 0000: \***
 327: 0000: \***        Version A     Bruce Scriver                3rd March 1986
 328: 0000: \*** 
 329: 0000: \***        Version B     Andrew Wedgeworth            17th July 1992
 330: 0000: \***        Removal of now redundant return code field.
 331: 0000: \***
 332: 0000: \*******************************************************************************
 333: 0000: \*******************************************************************************
 334: 0000: 
 335: 0000:       STRING   GLOBAL F14.TABLE$(1)
 336: 0000: 
 337: 0000: 
 338: 0000:  %INCLUDE PSBF16G.J86                     ! DLC
 339: 0000: REM\
 340: 0000: \*******************************************************************************
 341: 0000: \*******************************************************************************
 342: 0000: \***
 343: 0000: \***           %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.HEX FUNCTION
 344: 0000: \***
 345: 0000: \***                       REFERENCE     : PSBF16G.J86
 346: 0000: \*** 
 347: 0000: \***       Version A           Bruce Scriver            25th February 1986
 348: 0000: \***
 349: 0000: \***       Version B         Andrew Wedgeworth               2nd July 1992
 350: 0000: \***       Removal of now redundant F16.RETURN.CODE%.
 351: 0000: \***
 352: 0000: \*******************************************************************************
 353: 0000: \*******************************************************************************
 354: 0000: 
 355: 0000:       STRING   GLOBAL F16.HEX.STRING$
 356: 0000: 
 357: 0000:       ! 1 line deleted from here                                       ! BAW
 358: 0000:  %INCLUDE PSBF17G.J86                     ! DLC
 359: 0000: REM \
 360: 0000: \*******************************************************************************
 361: 0000: \*******************************************************************************
 362: 0000: \***
 363: 0000: \***
 364: 0000: \***        %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.STRING FUNCTION
 365: 0000: \***
 366: 0000: \***                    REFERENCE     : PSBF17G.J86
 367: 0000: \***
 368: 0000: \***        Version A         Bruce Scriver      24th February 1986
 369: 0000: \***
 370: 0000: \***        Version B       Andrew Wedgeworth         2nd July 1992
 371: 0000: \***        Removal of now redundant F17.RETURN.CODE%
 372: 0000: \***
 373: 0000: \*******************************************************************************
 374: 0000: \*******************************************************************************
 375: 0000: 
 376: 0000:       STRING   GLOBAL F17.RETURNED.STRING$
 377: 0000: 
 378: 0000:       ! 1 line deleted from here                                       ! BAW
 379: 0000: 
 380: 0000:  %INCLUDE PSBF18G.J86                     ! 1.8DA
 381: 0000: REM\
 382: 0000: \*******************************************************************************
 383: 0000: \*******************************************************************************
 384: 0000: \***
 385: 0000: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT globals
 386: 0000: \***
 387: 0000: \***        REFERENCE     : PSBF18G.J86
 388: 0000: \***
 389: 0000: \***        Version A     Stephen Kelsey                  23rd March 1987
 390: 0000: \***
 391: 0000: \***        Version B     Andrew Wedgeworth                 7th July 1992
 392: 0000: \***        Removal of return code field which no longer required.
 393: 0000: \***
 394: 0000: \*******************************************************************************
 395: 0000: \*******************************************************************************
 396: 0000: 
 397: 0000:       STRING   GLOBAL F18.CHECK.DIGIT$
 398: 0000:     
 399: 0000:       ! 1 line deleted from here                                       ! BAW    
 400: 0000: 
 401: 0000:  %INCLUDE PSBF20G.J86                     ! DLC
 402: 0000: REM\
 403: 0000: \*******************************************************************************
 404: 0000: \*******************************************************************************
 405: 0000: \***
 406: 0000: \***     %INCLUDE GLOBAL VARIABLE DEFINITIONS FOR SESS.NUM.UTILITY FUNCTION
 407: 0000: \***
 408: 0000: \***                       REFERENCE     : PSBF20G.J86
 409: 0000: \*** 
 410: 0000: \***     Version A              Bruce Scrive                   5th May 1988   
 411: 0000: \*** 
 412: 0000: \***     Version B              Robert Cowey                   7th May 1991
 413: 0000: \***     Global variable F20.INTEGER.FILE.NO% changed from one byte integer
 414: 0000: \***     to two byte integer.
 415: 0000: \***
 416: 0000: \***     Version D              Andrew Wedgeworth             1st July 1992
 417: 0000: \***     F20.RETURN.CODE% removed as it is no longer required.
 418: 0000: \***
 419: 0000: \*******************************************************************************
 420: 0000: \*******************************************************************************
 421: 0000: 
 422: 0000:       STRING    GLOBAL F20.FILE.NAME$,                                 \
 423: 0000:                        F20.STRING.FILE.NO$,                            \
 424: 0000:                        F20.TABLE.DIMENSIONED.FLAG$,                    \
 425: 0000:                        SESS.NUM.TABLE$(1)
 426: 0000: 
 427: 0000:       INTEGER*2 GLOBAL F20.INTEGER.FILE.NO%
 428: 0000: 
 429: 0000:       ! 1 line deleted from here                                       ! DAW 
 430: 0000: 
 431: 0000:  %INCLUDE PSBF21G.J86                     ! 1.9BG
 432: 0000: REM\
 433: 0000: \*******************************************************************************
 434: 0000: \*******************************************************************************
 435: 0000: \***
 436: 0000: \***        INCLUDE       : CHECK.BAR.CODE globals
 437: 0000: \***
 438: 0000: \***        REFERENCE     : PSBF21G.J86
 439: 0000: \***
 440: 0000: \***        Version A     Bruce Scriver                  13th May 1988
 441: 0000: \***
 442: 0000: \***        Version B     Andrew Wedgeworth             21st July 1992
 443: 0000: \***        Return code removed as no longer used.
 444: 0000: \***
 445: 0000: \*******************************************************************************
 446: 0000: \*******************************************************************************
 447: 0000: 
 448: 0000:       STRING    GLOBAL F21.VALID.CODE.FLAG$
 449: 0000: 
 450: 0000: 
 451: 0000: 
 452: 0000: !%INCLUDE ASYNCNUB.J86                    ! FLC
 453: 0000:  %INCLUDE CHKBFDEC.J86                    ! DLC
 454: 0000: \******************************************************************************
 455: 0000: \***
 456: 0000: \***           %INCLUDE FOR CHKBF - PRICE CHECK BUFFER FILE
 457: 0000: \***
 458: 0000: \***                    - FIELD DECLARATIONS   
 459: 0000: \***                    - FILE REFERENCE PARAMETERS  
 460: 0000: \***  
 461: 0000: \***                    REFERENCE: CHKBFDEC.J86
 462: 0000: \***
 463: 0000: \******************************************************************************
 464: 0000: 
 465: 0000:    INTEGER*1 GLOBAL				\
 466: 0000: 	CHKBF.SESS.NUM%
 467: 0000: 
 468: 0000:    INTEGER*2 GLOBAL				\
 469: 0000: 	CHKBF.RECL%,                            \
 470: 0000:         CHKBF.REPORT.NUM% 	
 471: 0000: 
 472: 0000:    INTEGER*4 GLOBAL				\ DLC
 473: 0000:         CHKBF.POINTER%
 474: 0000: 	
 475: 0000:    STRING GLOBAL			\
 476: 0000: 	CHKBF.ITEM.CODE$,	\ 13 byte ASC - bar code, as passed from PDT
 477: 0000: 	CHKBF.PRICE$,		\  6 byte ASC - price, as passed from PDT 
 478: 0000: 	CHKBF.FILLER$,		\  1 byte ASC - spare
 479: 0000: 	CHKBF.FILE.NAME$
 480: 0000:  %INCLUDE GAPBFDEC.J86                    ! SDH !2.3CS !2.4BG
 481: 0000: \*****************************************************************************
 482: 0000: \***                                                                         *
 483: 0000: \***           %INCLUDE FOR GAPBF - GAP BUFFER FILE                          *
 484: 0000: \***                                                                         *
 485: 0000: \***                    - FIELD DECLARATIONS                                 *
 486: 0000: \***                    - FILE REFERENCE PARAMETERS                          *
 487: 0000: \***                                                                         *
 488: 0000: \***                    REFERENCE: GAPBFDEC.J86                              *
 489: 0000: \***                                                                         *
 490: 0000: \*****************************************************************************
 491: 0000: 
 492: 0000:    INTEGER*1 GLOBAL            \
 493: 0000:    GAPBF.SESS.NUM%
 494: 0000: 
 495: 0000:    INTEGER*2 GLOBAL            \   
 496: 0000:    GAPBF.REPORT.NUM%    
 497: 0000: 
 498: 0000:    STRING GLOBAL               \
 499: 0000:    GAPBF.BOOTS.CODE$,          \ 7 bytes ASC - Item code
 500: 0000:    GAPBF.FILE.NAME$
 501: 0000:  %INCLUDE PLLOLDEC.J86                    ! 2.3CS
 502: 0000: 
 503: 0000: \******************************************************************************
 504: 0000: \******************************************************************************
 505: 0000: \***
 506: 0000: \***         %INCLUDE FOR RF PICKING LIST OF LISTS FILE FIELD DECLARATIONS
 507: 0000: \***
 508: 0000: \***               FILE TYPE    : DIRECT
 509: 0000: \***
 510: 0000: \***               REFERENCE    : PLLOLDEC.J86
 511: 0000: \***
 512: 0000: \***    VERSION A.           Julia Stones.               11 August 2004
 513: 0000: \***               New file for RF system. Holds list of picking lists.
 514: 0000: \***
 515: 0000: \***    VERSION B            Mark Goode                  17th January 2005
 516: 0000: \***    Additional field required to state the lists status ('S' - Shelf Monitor
 517: 0000: \***    'F' - Fast Fill, 'O' - OSSR or 'E' - excess stock.
 518: 0000: \*******************************************************************************
 519: 0000: \*******************************************************************************
 520: 0000: 
 521: 0000: STRING GLOBAL                                                  \
 522: 0000:    PLLOL.FILE.NAME$,           \
 523: 0000:    PLLOL.LISTID$,              \ 3 bytes unpacked list ID
 524: 0000:    PLLOL.CREATOR.ID$,          \ 3 bytes unpacked Creator user ID
 525: 0000:    PLLOL.PICKER.ID$,           \ 3 bytes unpacked Picker user ID
 526: 0000:    PLLOL.ITEM.STATUS$,         \ 1 byte item status " "
 527: 0000:                                \                    "P" = Picked
 528: 0000:                                \                    "U" = Unpicked
 529: 0000:                                \                    "A" = List is active (someone is picking it)
 530: 0000:                                \                    "X" = List is cancelled
 531: 0000:    PLLOL.CREATE.DATE$,         \ 6 bytes unpacked create date YYMMDD
 532: 0000:    PLLOL.CREATE.TIME$,         \ 4 bytes unpacked create time HH:MM
 533: 0000:    PLLOL.PICK.START.TIME$,     \ 4 bytes unpacked pick start time HH:MM
 534: 0000:    PLLOL.PICK.END.TIME$,       \ 4 bytes unpacked pick end time HH:MM
 535: 0000:    PLLOL.ITEM.COUNT$,          \ 4 bytes unpacked item count (max number of items in list
 536: 0000:                                \                              duplicates will cobine to 1 record
 537: 0000:                                \                              on the PLLDB file)
 538: 0000:    PLLOL.OSSR.PICKING$,        \ 1 byte Marked for OSSR picking "Y" = marked for OSSR picking
 539: 0000:                                \                                "N" = not marked for OSSR picking
 540: 0000:    PLLOL.OSSR.STATUS$          ! 1 byte mark the status of the list.         ! BMG         
 541: 0000: 
 542: 0000: 
 543: 0000: INTEGER*4 GLOBAL               \
 544: 0000:        PLLOL.RECORD.NUM%
 545: 0000: 
 546: 0000: INTEGER*2 GLOBAL                \
 547: 0000:    PLLOL.REPORT.NUM%,           \
 548: 0000:    PLLOL.SESS.NUM%
 549: 0000: 
 550: 0000: 
 551: 0000: INTEGER*1 GLOBAL                \
 552: 0000:    PLLOL.RECL%
 553: 0000: 
 554: 0000: 
 555: 0000:  %INCLUDE PLLDBDEC.J86                    ! 2.3CS
 556: 0000: 
 557: 0000: \******************************************************************************
 558: 0000: \******************************************************************************
 559: 0000: \***
 560: 0000: \***         %INCLUDE FOR RF PICKING LIST ITEMS IN LISTS FILE FIELD DECLARATIONS
 561: 0000: \***
 562: 0000: \***               FILE TYPE    : KEYED
 563: 0000: \***
 564: 0000: \***               REFERENCE    : PLLDBDEC.J86
 565: 0000: \***
 566: 0000: \***    VERSION A.              Julia Stones.                   11th August 2004
 567: 0000: \***    New file for RF system. Holds picking list items in lists information.
 568: 0000: \***
 569: 0000: \***    VERSION B.              Mark Goode                     17th january 2005
 570: 0000: \***    Changes for OSSR WAN
 571: 0000: \***
 572: 0000: \***    VERSION C.              Charlies Skadorwa
 573: 0000: \***    Add Stock fig to filler space for PST47
 574: 0000: \***
 575: 0000: \***    VERSION D.              Mark Goode                      29th August 2008
 576: 0000: \***    Add new fields for Multi-site project
 577: 0000: \***
 578: 0000: \***    VERSION E.              Wasim Abdulkalam              11th November 2011
 579: 0000: \***    Added new fields for backshop and OSSR pending sales plan for Stock
 580: 0000: \***    file accuracy project
 581: 0000: \*******************************************************************************
 582: 0000: \*******************************************************************************
 583: 0000: 
 584: 0000: STRING GLOBAL                          \
 585: 0000:        PLLDB.FILE.NAME$,               \
 586: 0000:        PLLDB.KEY$,                     \ 6 bytes unpacked LISTID + ITEMSEQ
 587: 0000:        PLLDB.LISTID$,                  \ 3 bytes unpacked List Number
 588: 0000:        PLLDB.ITEMSEQ$,                 \ 3 bytes unpacked Item Sequence Number
 589: 0000:        PLLDB.BOOTSCODE$,               \ 4 bytes packed Boots item code including check digit
 590: 0000:        PLLDB.QTY.ONSHELF$,             \ 4 bytes unpacked Quantity on shelf
 591: 0000:        PLLDB.FILL.QTY$,                \ 4 bytes unpacked Fill quantity
 592: 0000:        PLLDB.GAPFILL.MRK$,             \ 1 byte ASC Gap/Fill marker "Y" = Gap created from Shelf monitor
 593: 0000:                                        \                            "N" = Fast Fill no TSF update
 594: 0000:        PLLDB.ITEM.STATUS$,             \ 1 byte ASC Item Status "U" = Unpicked, "P" = picked
 595: 0000:        PLLDB.STOCKROOM.CNT$,           \ 4 bytes unpacked Stock Room Count
 596: 0000:        PLLDB.SHELFMON.SALE.FIG$,       \ 4 bytes unpacked Sales figure at Shelf Monitoring
 597: 0000:        PLLDB.OSSR.FLAG$,               \ 1 bytes item OSSR flag   ! BMG
 598: 0000:      \!PLLDB.FILLER$,                  \ 7 byte filler            ! BMG !EWA
 599: 0000:        PLLDB.CNT.PENDSALES.BACKSHOP$,  \ 2 bytes packed backshop pending sales plan count      ! EWA
 600: 0000:        PLLDB.TIME.PENDSALES.BACKSHOP$, \ 2 bytes packed backshop pending sales plan count time ! EWA
 601: 0000:        PLLDB.CNT.PENDSALES.OSSR$,      \ 2 bytes packed OSSR pending sales plan count          ! EWA
 602: 0000:        PLLDB.TIME.PENDSALES.OSSR$,     \ 2 bytes packed OSSR pending sales plan count time     ! EWA
 603: 0000:        PLLDB.STKFIG.STOCKROOM$,        \ 4 bytes unpacked Sales figure at Shelf Monitoring
 604: 0000:                                        \ progam submitted for pint out
 605: 0000:        PLLDB.OSSR.CNT$,                \ 4 bytes unpacked OSSR item stock count figure
 606: 0000:        PLLDB.TIME.SHELFMON$,           \ 2 bytes packed Time of stock floor count hh:mm
 607: 0000:        PLLDB.TIME.BACKSHOP$,           \ 2 bytes packed Time of back shop count hh:mm
 608: 0000:        PLLDB.TIME.OSSR$,               \ 2 bytes packed Time of OSSR count hh:mm
 609: 0000:        PLLDB.BACKSHOP.SALE$,           \ 4 bytes unpacked Sale at time of backshop count
 610: 0000:        PLLDB.OSSR.SALE$,               \ 4 bytes unpacked Sale at time of OSSR count
 611: 0000:        PLLDB.MS.TABLE$,                \                                           ! DMG
 612: 0000:        PLLDB.MS.LOCATION.CNT$(1),      \ 2 byte packed multi-site location count   ! DMG
 613: 0000:        PLLDB.MS.SALES.FIG$(1),         \ 2 byte packed multi-site sales figure     ! DMG                                             ! CMG
 614: 0000:        PLLDB.MS.TIME.CNT$(1),          \ 2 byte packed multi-site time of count    ! DMG                                             ! CMG
 615: 0000:        PLLDB.MS.FILL.QTY$(1),          \ 2 byte packed multi-site fill quantity    ! DMG                                                        ! CMG
 616: 0000:        PLLDB.FILLER2$(1)               ! 2 byte filler                             ! DMG
 617: 0000: 
 618: 0000: INTEGER*2 GLOBAL                       \
 619: 0000:    PLLDB.REPORT.NUM%,                  \
 620: 0000:    PLLDB.SESS.NUM%
 621: 0000: 
 622: 0000: INTEGER*2 GLOBAL                       \
 623: 0000:    PLLDB.RECL%
 624: 0000: 
 625: 0000: 
 626: 0000: 
 627: 0000: \%INCLUDE CIMFDEC.J86                     ! DLC !2.5NWB
 628: 0000: \%INCLUDE CITEMDEC.J86                    ! DLC !2.5NWB
 629: 0000: \%INCLUDE CSRDEC.J86                      ! DLC !2.5NWB
 630: 0000: \%INCLUDE CSRWFDEC.J86                    ! DLC !2.5NWB
 631: 0000: \%INCLUDE CSRBFDEC.J86                    ! DLC !2.5NWB
 632: 0000: !%INCLUDE EPSOMDEC.J86                    ! FLC TEST
 633: 0000:  %INCLUDE FPFDEC.J86                      ! DLC
 634: 0000:  REM \
 635: 0000: \******************************************************************************
 636: 0000: \******************************************************************************
 637: 0000: \***
 638: 0000: \***         %INCLUDE FOR FLASHPACK / PARENT FILE FIELD DECLARATIONS
 639: 0000: \***
 640: 0000: \***               FILE TYPE    : Keyed
 641: 0000: \***
 642: 0000: \***               REFERENCE    : FPFDEC.J86
 643: 0000: \***
 644: 0000: \***         VERSION A : LES COOK  - 21/8/92
 645: 0000: \***
 646: 0000: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
 647: 0000: \***    No changes to this file.
 648: 0000: \***
 649: 0000: \***    VERSION C.              CLIVE NORRIS.                       17 JAN 1994.
 650: 0000: \***    No changes to this file. Version updated to keep in line 
 651: 0000: \***    with changes in FPFFUNC.BAS.
 652: 0000: \***
 653: 0000: \*******************************************************************************
 654: 0000: \*******************************************************************************
 655: 0000: 
 656: 0000:   STRING GLOBAL                  \
 657: 0000:     FPF.FILE.NAME$,              \
 658: 0000:     FPF.PARENT.CODE$,            \ 4 byte UPD with a check digit
 659: 0000:     FPF.CODE$(1),                \ 4 bytes upd first flashpack code of 10                 ! Boots code with a check digit 
 660: 0000:                                  \ (99999999 if no code) 
 661: 0000:     FPF.MULT.FACTOR$(1)          \ 2 bytes UPD multiplication factor for
 662: 0000:                   		 ! first flashpack code.
 663: 0000: 
 664: 0000:   INTEGER*2 GLOBAL        \
 665: 0000:     FPF.RECL%,            \
 666: 0000:     FPF.REPORT.NUM%,      \
 667: 0000:     FPF.SESS.NUM%,        \
 668: 0000:     MAX.FPF.CODES%
 669: 0000: 
 670: 0000:  %INCLUDE IDFDEC.J86                      ! FLC
 671: 0000: REM \
 672: 0000: \******************************************************************************
 673: 0000: \******************************************************************************
 674: 0000: \***
 675: 0000: \***         %INCLUDE FOR ITEM DATA FILE - FIELD DECLARATIONS
 676: 0000: \***                                       FILE REFERENCE PARAMETERS
 677: 0000: \***
 678: 0000: \***                  FILE TYPE    : Keyed
 679: 0000: \***
 680: 0000: \***                  REFERENCE    : IDFDEC.J86
 681: 0000: \***
 682: 0000: \***         VERSION A : Andrew Wedgeworth  29th June 1992    
 683: 0000: \***
 684: 0000: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
 685: 0000: \***    Replaced un-used RANK$ with BSNS.CNTR$ and FILLER$.
 686: 0000: \***
 687: 0000: \***    VERSION D.              Andrew Wedgeworth               15th March 1995
 688: 0000: \***    Comments updated to reflect the fact that some bits on the file are
 689: 0000: \***    no longer used.
 690: 0000: \***
 691: 0000: \*******************************************************************************
 692: 0000: \*******************************************************************************
 693: 0000: 
 694: 0000:   STRING GLOBAL           \
 695: 0000:     IDF.FILE.NAME$,       \  
 696: 0000:     IDF.BOOTS.CODE$,      \ 4 byte UPD with check digit (key)
 697: 0000:     IDF.FIRST.BAR.CODE$,  \ 6 byte UPD without check digit
 698: 0000:     IDF.SECOND.BAR.CODE$, \ 6 byte UPD without check digit
 699: 0000:     IDF.NO.OF.BAR.CODES$, \ 2 byte UPD. Total number of bar codes for this item
 700: 0000:     IDF.PRODUCT.GRP$,     \ 3 byte UPD. The first two digits are the concept
 701: 0000:                           \ group and the last four the concept sequence
 702: 0000:     IDF.STNDRD.DESC$,     \ 24 bytes
 703: 0000:     IDF.STATUS.1$,        \ 1 byte, values B,C,D,P,X,Z and blank
 704: 0000:     IDF.INTRO.DATE$,      \ 3 byte UPD YYMMDD. Date first added to this file
 705: 0000:     IDF.BSNS.CNTR$,       \ 1 byte ASC. Business Centre ID letter      ! CRC
 706: 0000:     IDF.FILLER$,          \ 1 byte un-used                             ! CRC
 707: 0000:     IDF.PARENT.CODE$,     \ 4 byte UPD with check digit ; may be zero if no
 708: 0000:                           \ flashpacks, current IDF.BOOTS.CODE$ if parent line
 709: 0000:                           \ or Boots Code of parent line if a flashpack.
 710: 0000:     IDF.DATE.OF.LAST.SALE$! 3 byte UPD. Date of last sale.
 711: 0000: 
 712: 0000:   INTEGER*1 GLOBAL        \
 713: 0000:     IDF.BIT.FLAGS.1%,     \ 1 byte - bit values
 714: 0000:                           \ X"80"  - Group code flag
 715: 0000:                           \ X"40"  - Keylines flag
 716: 0000:                           \ X"20"  - Markdown flag
 717: 0000:                           \ X"10"  - Warehouse flag
 718: 0000:                           \ X"08"  - CSR flag
 719: 0000:                           \ X"04"  - Directs A flag
 720: 0000:                           \ X"02"  - Directs B flag
 721: 0000:                           \ X"01"  - Directs C flag
 722: 0000:     IDF.BIT.FLAGS.2%      \ 1 byte - bit values
 723: 0000:                           \ X"80"  - Own brand line flag
 724: 0000:                           \ X"40"  - Exclusive line flag
 725: 0000:                           \ X"20"  - Unused 
 726: 0000:                           \ X"10"  - Unused
 727: 0000:                           \ X"08"  - Stock system flag
 728: 0000:                           \ X"04"  - Pending count flag
 729: 0000:                           \ X"02"  - Reserved
 730: 0000:                           ! X"01"  - Reserved
 731: 0000: 
 732: 0000:   INTEGER*2 GLOBAL        \
 733: 0000:     IDF.RECL%,            \  
 734: 0000:     IDF.REPORT.NUM%,      \ 
 735: 0000:     IDF.SESS.NUM%
 736: 0000:  %INCLUDE INVOKDEC.J86                    ! FLC
 737: 0000: \******************************************************************************
 738: 0000: \******************************************************************************
 739: 0000: \***
 740: 0000: \***   $Workfile:   INVOKDEC.J86  $
 741: 0000: \***
 742: 0000: \***   $Revision:   1.4  $
 743: 0000: \***
 744: 0000: \******************************************************************************
 745: 0000: \******************************************************************************
 746: 0000: \***
 747: 0000: \***   $Log:   V:\archive\j86\invokdec.j8v  $
 748: 0000: \***   
 749: 0000: \***      Rev 1.4   10 Feb 1998 14:11:36   DEV45PS
 750: 0000: \***   Added RP Delivery Days field
 751: 0000: \***   
 752: 0000: \***      Rev 1.3   09 Apr 1997 09:22:06   DEVAWPS
 753: 0000: \***   Added date of successful processing of Points
 754: 0000: \***   Events details.
 755: 0000: \***   
 756: 0000: \***      Rev 1.2   20 Dec 1994 11:02:52   DEVMJPS
 757: 0000: \***   CSR/2 Amendments - new fields added are 
 758: 0000: \***   PSC14 flag and Conversion Status flag 
 759: 0000: \***   
 760: 0000: \******************************************************************************
 761: 0000: \******************************************************************************
 762: 0000: REM \
 763: 0000: \******************************************************************************
 764: 0000: \******************************************************************************
 765: 0000: \***
 766: 0000: \***    FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS FOR INVCE OK FILE 
 767: 0000: \***
 768: 0000: \***                     REFERENCE   : INVOKDEC.J86
 769: 0000: \***
 770: 0000: \***    Version A            Andrew Wedgeworth              3rd August 1992
 771: 0000: \***    
 772: 0000: \***    Version B            Stephen Kelsey                 12th October 1992
 773: 0000: \***    Include Direct Implementation Flag, PSC30 flag and date.
 774: 0000: \***
 775: 0000: \***    Version C            Les Cook                       15th February 1993
 776: 0000: \***    Include UOD Implementation Flag, UOD Booked in date, Previous serial
 777: 0000: \***    number and success flag.
 778: 0000: \***
 779: 0000: \***    Version D            David Smallwood                20th July 1994   
 780: 0000: \***    Include CSR PHASE1 transmission flag and CSR start method flag.
 781: 0000: \***    
 782: 0000: \***    Version E            Mick Bayliss                   19th Oct. 1994
 783: 0000: \***    New fields for CSR Phase 2 - PSC14 Flag and Conversion Status Flag.
 784: 0000: \***
 785: 0000: \***    Version F            Andrew Wedgeworth              27th March 1997
 786: 0000: \***    Added date of successful processing of Points Events details sent from 
 787: 0000: \***    the mainframe.
 788: 0000: \***
 789: 0000: \***    Version G            Nik Sen                        10th February 1998
 790: 0000: \***    Added parameter used by MINSITS RP to determine number of days to 
 791: 0000: \***    check for late delivery.
 792: 0000: \***
 793: 0000: \******************************************************************************
 794: 0000: \******************************************************************************
 795: 0000: 
 796: 0000: 
 797: 0000: \******************************************************************************
 798: 0000: \***
 799: 0000: \***   FILE REFERENCE PARAMETERS
 800: 0000: \***
 801: 0000: \******************************************************************************
 802: 0000: 
 803: 0000:   STRING GLOBAL           \
 804: 0000:     INVOK.FILE.NAME$
 805: 0000: 
 806: 0000:   INTEGER*2 GLOBAL        \
 807: 0000:     INVOK.SESS.NUM%,      \
 808: 0000:     INVOK.REPORT.NUM%
 809: 0000: 
 810: 0000: 
 811: 0000: \******************************************************************************
 812: 0000: \***
 813: 0000: \***   FIELD DECLARATIONS
 814: 0000: \***
 815: 0000: \******************************************************************************
 816: 0000: 
 817: 0000:   STRING GLOBAL                \
 818: 0000:     INVOK.SERIAL.NO$,          \ 5 bytes ASCII
 819: 0000:     INVOK.DATE$,               \ 3 bytes YYMMDD UPD
 820: 0000:     INVOK.SUCCESS.FLAG$,       \ 1 bytes ASCII
 821: 0000:     INVOK.STORE.NO$,           \ 4 bytes ASCII with leading zeroes
 822: 0000:     INVOK.INVENTORY.SRLNO$,    \ 5 bytes ASCII leading zeros
 823: 0000:     INVOK.INVENTORY.SUCCESS$,  \ 1 bytes ASCII 0=failed/1=success
 824: 0000:     INVOK.SALES.SRLNO$,        \ 5 bytes ASCII leading zeros
 825: 0000:     INVOK.SALES.SUCCESS$,      \ 1 bytes ASCII 0=failed/1=success
 826: 0000:     INVOK.NEW.LIST.SRLNO$,     \ 5 bytes ASCII
 827: 0000:     INVOK.NEW.LIST.SUCCESS$,   \ 1 bytes ASCII 0=failed/1=success
 828: 0000:     INVOK.CSR.DELIVERY.NO$,    \ 5 bytes ASCII				
 829: 0000:     INVOK.CSR.IDENT$,          \ 1 bytes ASCII value "Y" 		
 830: 0000:     INVOK.CSR.DELIVERY.DATE$,  \ 6 bytes ASCII YYMMDD			
 831: 0000:     INVOK.CSR.PSC11.FLAG$,     \ 1 bytes ASCII				
 832: 0000:     INVOK.CSR.PSC12.FLAG$,     \ 1 bytes ASCII				
 833: 0000:     INVOK.CSR.PSC13.FLAG$,     \ 1 bytes ASCII				
 834: 0000:     INVOK.CSR.PSC12.DAYS$,     \ 1 bytes UPD				
 835: 0000:     INVOK.PSS33.RUN.DATE$,     \ 3 bytes YYMMDD UPD                     
 836: 0000:     INVOK.PSS33.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success       
 837: 0000:     INVOK.DIR.IMPL.FLAG$,      \ 1 byte ASCII  1=phase 1 implemented   BSPK   
 838: 0000:                                \           blank=not yet implemented   BSPK 
 839: 0000:     INVOK.PSC30.RUN.DATE$,     \ 3 bytes YYMMDD UPD                    BSPK                     
 840: 0000:     INVOK.PSC30.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success      BSPK
 841: 0000:     INVOK.UOD.IMPL.FLAG$,      \ 1 byte ASCII 1=implemented            CLC
 842: 0000:     INVOK.LAST.UOD.DATE$,      \ 3 bytes UPD                           CLC
 843: 0000:     INVOK.PREV.SERIAL.NO$,     \ 5 bytes ASCII                         CLC
 844: 0000:     INVOK.PREV.SUCCESS.FLAG$,  \ 1 byte ASCII                          CLC
 845: 0000:     INVOK.SUPPRESS.EXCEP.REPORT$,     \ 1 byte ASCII Y/N               DDS
 846: 0000:     INVOK.CSR.STARTED.BY.SUP$,        \ 1 byte ASCII Y/N               DDS
 847: 0000:     INVOK.CSR.PSC14.FLAG$,            \ 1 byte ASCII S/E/X/Y           EMJB
 848: 0000:     INVOK.CSR.CONVERSION.STATUS.FLAG$,\ 1 byte ASCII P/S/X/C           EMJB
 849: 0000:     INVOK.PTS.EVENTS.OK.DATE$, \ 3 bytes UPD                           FAW
 850: 0000:     INVOK.RP.DAYS$,            \ 1 byte ASCII                          GNS
 851: 0000:     INVOK.FILLER$              ! 6 bytes spaces                        GNS
 852: 0000: 
 853: 0000:   INTEGER*2 GLOBAL        \
 854: 0000:     INVOK.RECL%
 855: 0000:  %INCLUDE ONORDDEC.J86                    ! DLC
 856: 0000: \******************************************************************************
 857: 0000: \******************************************************************************
 858: 0000: \***
 859: 0000: \***         %INCLUDE FOR CSR ON ORDER FILE - FIELD DECLARATIONS
 860: 0000: \***                                          FILE REFERENCE PARAMETERS
 861: 0000: \***
 862: 0000: \***               FILE TYPE    : Keyed     
 863: 0000: \***
 864: 0000: \***               REFERENCE    : ONORDDEC.J86
 865: 0000: \***
 866: 0000: \***               DATE OF LAST AMENDMENT -  09/10/92
 867: 0000: \***
 868: 0000: \******************************************************************************
 869: 0000: \*******************************************************************************
 870: 0000: 
 871: 0000:   STRING GLOBAL                  \
 872: 0000:     ONORD.FILE.NAME$,		 \
 873: 0000:     ONORD.KEY$,                  \ 12byte ASC
 874: 0000:     ONORD.ORDER.DATE$,           \ 6 byte ASC
 875: 0000:     ONORD.LIST.FREQ$,            \ 1 byte ASC
 876: 0000:     ONORD.UNIT.NO$,              \ 2 byte ASC 
 877: 0000:     ONORD.SEQ.NO$,               \ 3 byte ASC 
 878: 0000:     ONORD.HIGHEST.SEQ.NO$,       \ 3 byte ASC 
 879: 0000:     ONORD.FILLER$,               \
 880: 0000:     ONORD.ITEM.CODE$,            \ 7 byte ASC 
 881: 0000:     ONORD.QTY.1$,                \ 3 byte ASC
 882: 0000:     ONORD.QTY.2$,                \ 3 byte ASC 
 883: 0000:     ONORD.CSRITEM.UNDONE.FLAG$,  \ 1 byte ASC "Y" or "N"
 884: 0000:     ONORD.CSRIMF.UNDONE.FLAG$,   \ 1 byte ASC "Y" or "N" 
 885: 0000:     ONORD.DELETED.FLAG$          ! 1 byte ASC "Y" or "N" 
 886: 0000:     
 887: 0000:   INTEGER*2 GLOBAL		 \
 888: 0000:     ONORD.REPORT.NUM%,		 \
 889: 0000:     ONORD.RECL%,		 \
 890: 0000:     ONORD.SESS.NUM%  
 891: 0000:     
 892: 0000:  %INCLUDE PCHKDEC.J86                     ! DLC
 893: 0000: \******************************************************************************
 894: 0000: \******************************************************************************
 895: 0000: \***
 896: 0000: \***         %INCLUDE FOR PRICE CHECK FILE - FILE REFERENCE PARAMETERS
 897: 0000: \***
 898: 0000: \***               REFERENCE    : PCHKDEC.J86
 899: 0000: \***
 900: 0000: \******************************************************************************
 901: 0000: \*******************************************************************************
 902: 0000: 
 903: 0000:   STRING GLOBAL           \
 904: 0000:     PCHK.FILE.NAME$
 905: 0000: 
 906: 0000:   INTEGER*2 GLOBAL        \
 907: 0000:     PCHK.REPORT.NUM%,      \
 908: 0000:     PCHK.SESS.NUM%
 909: 0000:  %INCLUDE PIPEINUB.J86                    ! DLC
 910: 0000: 
 911: 0000: \******************************************************************************
 912: 0000: \******************************************************************************
 913: 0000: \***
 914: 0000: \***                   %INCLUDE FOR PSS38 INPUT PIPE
 915: 0000: \***
 916: 0000: \***                         LINK TYPE : PIPEI
 917: 0000: \***
 918: 0000: \***                     REFERENCE : PIPEINUM.J86
 919: 0000: \***
 920: 0000: \******************************************************************************
 921: 0000: \******************************************************************************
 922: 0000: 
 923: 0000:    STRING GLOBAL							\
 924: 0000: 	PIPEI.FILE.NAME$
 925: 0000: 	
 926: 0000:    INTEGER*1 GLOBAL							\
 927: 0000: 	PIPEI.REPORT.NUM%,						\
 928: 0000: 	PIPEI.SESS.NUM%
 929: 0000: !%INCLUDE PIPEONUB.J86                    ! FLC TEST
 930: 0000:  %INCLUDE UNITSDEC.J86                    ! DLC
 931: 0000: \******************************************************************************
 932: 0000: \******************************************************************************
 933: 0000: \***
 934: 0000: \***         %INCLUDE FOR UNITS - FILE REFERENCE PAREMETERS
 935: 0000: \***                              FIELD DECLARATIONS
 936: 0000: \***
 937: 0000: \***               REFERENCE    : UNITSDEC.J86
 938: 0000: \***
 939: 0000: \***
 940: 0000: \******************************************************************************
 941: 0000: \******************************************************************************
 942: 0000: 
 943: 0000:   STRING GLOBAL           \
 944: 0000:     UNITS.UNIT$,          \ 1  byte UPD (key)
 945: 0000:     UNITS.UNIT.NAME$,     \ 27 bytes ASCII
 946: 0000:     UNITS.BC.LETTER$,     \ 1  byte  ASCII
 947: 0000:     UNITS.FILLER$,        \ 6  bytes ASCII (spaces).
 948: 0000:     UNITS.FILE.NAME$
 949: 0000: 
 950: 0000:   INTEGER*2 GLOBAL        \
 951: 0000:     UNITS.REPORT.NUM%,    \ 
 952: 0000:     UNITS.RECL%,          \ 
 953: 0000:     UNITS.SESS.NUM%
 954: 0000:  %INCLUDE STKMQDEC.J86                    ! MMJK
 955: 0000: REM \
 956: 0000: \******************************************************************************
 957: 0000: \******************************************************************************
 958: 0000: \***
 959: 0000: \***      %INCLUDE FOR STOCK MOVEMENT QUEUE FILE FIELD DECLARATIONS
 960: 0000: \***                                             FILE REFERENCE PARAMETERS
 961: 0000: \***
 962: 0000: \***               FILE TYPE    : Sequential
 963: 0000: \***
 964: 0000: \***               REFERENCE    : STKMQDEC.J86
 965: 0000: \***
 966: 0000: \***      Version A.     L. Cook
 967: 0000: \***
 968: 0000: \***      Combined from STKMQNUE.J86 and STKMQFLE.J86
 969: 0000: \***
 970: 0000: \***      Version B.     S.P. Kelsey (CTG)            7th November
 971: 0000: \***      Include CSR Marker in the Type 1 and Type 18 transactions.
 972: 0000: \***
 973: 0000: \***      Version C.     S. Goulding                 8th March
 974: 0000: \***      Add fields for new tranctions types 21 & 23
 975: 0000: \***
 976: 0000: \***      Version D.     ???????????            ????????????
 977: 0000: \***      ????????????????????????????????????????????????????????
 978: 0000: \***
 979: 0000: \***      Version E.     Michael J. Kelsall           16th Dec 1993.
 980: 0000: \***      Addition of txn types, 24, 25, 26, 27 and 28. As part of the
 981: 0000: \***      RETURNS/AUTOMATIC CREDIT CLAIMING system.
 982: 0000: \***
 983: 0000: \***      Version 1.1    Michael J. Kelsall           10th Aug 1994.
 984: 0000: \***      Changes as part of R/ACC update to allow for zero price claim
 985: 0000: \***      processing. Addition of type 29 txn for this change.
 986: 0000: \***
 987: 0000: \***      Version 1.2    Nik Sen                       8th November 1994
 988: 0000: \***      Addition of transaction type 30 as oart of Epsom Life CSR Phase 2
 989: 0000: \***
 990: 0000: \***      Version 1.3    Neil Bennett                   2nd January 2007
 991: 0000: \***      Add ASN processing support. (Rec Type 17)
 992: 0000: \***
 993: 0000: \***      Version 1.4    Brian Greenfield               14th may 2007
 994: 0000: \***      Added STKMQ.RECALL.TYPE$ for use in A7C RECALLS - only type 26 records.
 995: 0000: \***
 996: 0000: \***      Version 1.5    Neil Bennett                  31st January 2008
 997: 0000: \***      Add STKMQ.FLAG$ for record type 11
 998: 0000: \***
 999: 0000: \***      Version 1.6    Dave Constable                5th September 2008
1000: 0000: \***      Add STKMQ.FLAG$ for record type 33
1001: 0000: \***
1002: 0000: \***      Version 1.7    Dave Constable                30th December 2008
1003: 0000: \***      Add STKMQ.RESCAN$ for record type 33
1004: 0000: \***
1005: 0000: \***      Version 1.8    Dave Constable                6th January 2009
1006: 0000: \***      Add Bookin date & time for record type 33
1007: 0000: \***
1008: 0000: \***      Version F      Mark Walker                      27th Mar 2014
1009: 0000: \***      F337 Centralised View of Stock
1010: 0000: \***      - Relocated STKMQ item processing variables to here.
1011: 0000: \***
1012: 0000: \******************************************************************************
1013: 0000: \*******************************************************************************
1014: 0000: \***
1015: 0000: \***  The length of the records on this file vary depending on the record
1016: 0000: \***  transaction type, but they all comprise combinations of the fields
1017: 0000: \***  defined below.
1018: 0000: \***
1019: 0000: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,
1020: 0000: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
1021: 0000: \***     END OF RECORD MARKER.
1022: 0000: \***
1023: 0000: \***  Transaction type 1 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1024: 0000: \***     TIME, FSI, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER, STORE SUFFIX,
1025: 0000: \***     COUNT OF ITEMS, INVOICE DAY,(FIELD DELIMITER, BOOTS CODE,
1026: 0000: \***     FIELD DELIMITER, QUANTITY, FIELD DELIMITER, CSR MARKER),
1027: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER.
1028: 0000: \***     The fields within brackets are repeated as many times as count of items.
1029: 0000: \***
1030: 0000: \***  Transaction type 2 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1031: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, RECORD DELIMITER,
1032: 0000: \***     END OF RECORD MARKER.
1033: 0000: \***
1034: 0000: \***  Transaction type 3 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1035: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER,
1036: 0000: \***     REASON CODE, STORE/RETURN CODE, RECORD DELIMITER, END OF RECORD MARKER
1037: 0000: \***
1038: 0000: \***  Transaction type 4 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1039: 0000: \***     TIME, BOOTS CODE, ON IDF FLAG, FIELD DELIMITER, QUANTITY,
1040: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1041: 0000: \***
1042: 0000: \***  Transaction type 5 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1043: 0000: \***     TIME, BOOTS CODE, COUNT FLAG, STOCK MOVEMENT DATE, FIELD DELIMITER,
1044: 0000: \***     QUANTITY, RECORD DELIMITER, END OF RECORD MARKER
1045: 0000: \***
1046: 0000: \***  Transaction type 6 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1047: 0000: \***     TIME, BOOTS CODE, REASON (1 byte ASCII)
1048: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1049: 0000: \***
1050: 0000: \***  Transaction type 7 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1051: 0000: \***     TIME, BOOTS CODE, CONCEPT SEQUENCE
1052: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1053: 0000: \***
1054: 0000: \***  Transaction type 8 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1055: 0000: \***     TIME, PRODUCT GROUP, RECORD DELIMITER, END OF RECORD
1056: 0000: \***     MARKER
1057: 0000: \***
1058: 0000: \***  Transaction type 9 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1059: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, LIST TYPE,
1060: 0000: \***     COUNT.BY.DATE, RECORD DELIMITER, END OF RECORD MARKER
1061: 0000: \***
1062: 0000: \***  Transaction type 10- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1063: 0000: \***     TIME, BOOTS CODE,
1064: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1065: 0000: \***
1066: 0000: \***  Transaction type 11- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1067: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, COUNT QUANTITY, FIELD DELIMITER(opt),
1068: 0000: \***     SOURCE(opt), FLAG(opt), RECORD DELIMITER, END OF RECORD MARKER
1069: 0000: \***
1070: 0000: \***  Transaction type 12- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1071: 0000: \***     TIME, BOOTS CODE,
1072: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1073: 0000: \***
1074: 0000: \***  Transaction type 13- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1075: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1076: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1077: 0000: \***     FIELD DELIMITER, BACKROOM COUNT, RECORD DELIMITER, END OF REC MARKER
1078: 0000: \***
1079: 0000: \***  Transaction type 14- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1080: 0000: \***     TIME, LIST NUMBER, LIST STATUS, RECORD DELIMITER,
1081: 0000: \***     END OF RECORD MARKER
1082: 0000: \***
1083: 0000: \***  Transaction type 16- RECORD DELIMIER, TRANS TYPE, FIELD DELIMITER, DATE,
1084: 0000: \***     TIME, BC LETTER, FIELD DELIMITER, ORIGINAL RECOUNT
1085: 0000: \***     PERCENTAGE, FIELD DELIMITER, CHANGED RECOUNT PERCENTAGE,
1086: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1087: 0000: \***
1088: 0000: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1089: 0000: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
1090: 0000: \***     NUMBER, ITEM COUNT,
1091: 0000: \***     CARTON NUMBER, CARTON FLAG,                                        ! 1.3NWB
1092: 0000: \***     FIELD DELIMITER, ITEM CODE, BAR CODE,
1093: 0000: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
1094: 0000: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
1095: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1096: 0000: \***
1097: 0000: \***  Transaction type 18- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1098: 0000: \***     TIME, FOLIO IDENTIFIER, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER,
1099: 0000: \***     STORE SUFFIX, ITEM COUNT, INVOICE DAY, EXPECTED DATE OF DELIVERY,
1100: 0000: \***     DALLAS MARKER, FIELD DELIMITER, ITEM CODE, FIELD DELIMITER,
1101: 0000: \***     ORDER QUANTITY, FIELD DELIMITER, CSR MARKER,
1102: 0000: \***     (the last six fields repeat ITEM COUNT times),
1103: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1104: 0000: \***
1105: 0000: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1106: 0000: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
1107: 0000: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
1108: 0000: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
1109: 0000: \***
1110: 0000: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1111: 0000: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1112: 0000: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
1113: 0000: \***
1114: 0000: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1115: 0000: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1116: 0000: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, FIELD DELIMITER
1117: 0000: \***     FSI,FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, FOLIO NO, CSR MARKER
1118: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1119: 0000: \***
1120: 0000: \***
1121: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
1122: 0000: \***
1123: 0000: \***  Transaction type 24 - Whole or Part consignment record
1124: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1125: 0000: \***     CREDIT CLAIM NUM, BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM,
1126: 0000: \***     FOLIO NUM, BATCH REF NUM, WHOLE/PART CONSIGNMENT, REPAIR CATEGORY,
1127: 0000: \***     REPAIR NUM, PLAN4 POLICY NUM, DDDA/DCDR NUM, DELIV NOTE NUM,
1128: 0000: \***     DELIV DATE, NUM OF CARTONS, ORDER NUM, COMMENT, NUM OF ITEMS,
1129: 0000: \***     ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, RECORD DELIMITER,
1130: 0000: \***     END OF RECORD MARKER
1131: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1132: 0000: \***
1133: 0000: \***  Transaction type 25 - Non-sales func 16 and Misc. txns from controller
1134: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1135: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS, AUTH CODE/CONTACT,
1136: 0000: \***     ADJUST STOCK FIGURE FLAG, REASON, ITEM/BAR CODE FLAG, BOOTS/BAR CODE,
1137: 0000: \***     QTY, PRICE, RECORD DELIMITER, END OF RECORD MARKER
1138: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1139: 0000: \***
1140: 0000: \***  Transaction type 26 - Data from LDT
1141: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME, UOD NUM,
1142: 0000: \***     UOD STATUS, CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD,
1143: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER,
1144: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
1145: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
1146: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD
1147: 0000: \***     DESPATCHED, RECALL TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.4BG
1148: 0000: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
1149: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
1150: 0000: \***
1151: 0000: \***  Transaction type 27 - End of LDT session
1152: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1153: 0000: \***     DATE SESSION ENDED, TIME SESSION ENDED, RECORD DELIMITER,
1154: 0000: \***     END OF RECORD MARKER
1155: 0000: \***
1156: 0000: \***  Transaction type 28 - Cancelled Credit Claim
1157: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1158: 0000: \***     CLAIM NUMBER, UOD NUM, NEW STATUS FLAG, RECORD DELIMITER,
1159: 0000: \***     END OF RECORD MARKER
1160: 0000: \***
1161: 0000: \***  Transaction type 29 - Zero price update
1162: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1163: 0000: \***     CLAIM NUMBER, ITEM NUMBER, CLAIM VALUE, RECORD DELIMITER,
1164: 0000: \***     END OF RECORD MARKER
1165: 0000: \***
1166: 0000: \***  Transaction type 30 - CSR Issues
1167: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1168: 0000: \***     BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER
1169: 0000: \***     EXPECTED DELIVERY DATE, RECORD DELIMITER, END OF RECORD MARKER
1170: 0000: \***
1171: 0000: \***  Transaction type 31 - Quasi Count
1172: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1173: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1174: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1175: 0000: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1176: 0000: \***      END OF REC MARKER
1177: 0000: \***
1178: 0000: \***  Transaction type 32 - Quasi Adjustment count
1179: 0000: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1180: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1181: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1182: 0000: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1183: 0000: \***     END OF REC MARKER
1184: 0000: \***
1185: 0000: \***  Transaction type 33 - +UOD Receiving
1186: 0000: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1187: 0000: \***     TIME, UOD LICENCE PLATE, DESPATCH DATE, ACTION, ITEM COUNT,
1188: 0000: \***     for audit type+(ITEM CODE, BARCODE, DESPATCHED QTY, VARIANCE )
1189: 0000: \***     END OF REC MARKER
1190: 0000: \***
1191: 0000: \******************************************************************************
1192: 0000: 
1193: 0000:   STRING GLOBAL              \
1194: 0000:     STKMQ.FILE.NAME$,        \
1195: 0000:     STKMQ.RECORD$,           \ Used to store the whole record which is unstrung
1196: 0000:                              \ into the fields below
1197: 0000:     STKMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
1198: 0000:     STKMQ.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
1199: 0000:                              \             01 = W'house invoice delivery record
1200: 0000:                              \             02 = Delivery without invoice record
1201: 0000:                              \             03 = Stock out record
1202: 0000:                              \             04 = Stock count record
1203: 0000:                              \             17 = Delivery without confirmation
1204: 0000:                              \                  of Direct Order detail
1205: 0000:                              \             18 = Confirmed Dallas invoice record
1206: 0000:                              \             19 = Delivery without confirmation
1207: 0000:                              \                  of Direct Order header
1208: 0000:                              \             21 = UOD record
1209: 0000:                              \             23 = Item Level UOD record
1210: 0000:                              \             24 = Whole/Part consignment (R/ACC)
1211: 0000:                              \             25 = NS16 / Misc cont txn (R/ACC)
1212: 0000:                              \             26 = Data from LDT (R/ACC)
1213: 0000:                              \             27 = End of LDT session (R/ACC)
1214: 0000:                              \             28 = Canc. Credit Claim (R/ACC)
1215: 0000:                              \             29 = Zero price update (R/ACC)
1216: 0000:     STKMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1217: 0000:     STKMQ.CREATION.DATE$,    \ 3 byte UPD set to current date
1218: 0000:     STKMQ.CREATION.TIME$,    \ 3 byte UPD set to current time
1219: 0000:     STKMQ.CSR.MARKER$,       \ 1 byte ASCII. "Y" - This is a CSR Item      BSPK
1220: 0000:                              \               " " - This is not a CSR Item  BSPK
1221: 0000:     STKMQ.DATE$,             \ 3 byte UPD set to current date
1222: 0000:     STKMQ.TIME$,             \ 3 byte UPD set to current time
1223: 0000:     STKMQ.FSI$,              \ 1 byte ASCII
1224: 0000:     STKMQ.FOLIO.YEAR$,       \ 1 byte UPD
1225: 0000:     STKMQ.FOLIO.MONTH$,      \ 1 byte UPD
1226: 0000:     STKMQ.FOLIO.NUMBER$,     \ 2 bytes UPD
1227: 0000:     STKMQ.STORE.SUFFIX$,     \ 1 byte ASCII
1228: 0000:     STKMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
1229: 0000:     STKMQ.BOOTS.CODE$,       \ 4 bytes UPD
1230: 0000:     STKMQ.ON.IDF.FLAG$,      \ 1 byte ASCII. Y = On IDF   N = Not on IDF
1231: 0000:     STKMQ.QUANTITY$,         \ variable length string equivalent to
1232: 0000:                              \ STR$(STKMQ.QUANTITY%)
1233: 0000:                              \ +ve indicates add to stock
1234: 0000:                              \ -ve indicates subtract from stock
1235: 0000:     STKMQ.REASON.CODE$,      \ 2 bytes UPD
1236: 0000:     STKMQ.STORE.RET.CODE$,   \ 2 bytes UPD
1237: 0000:     STKMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
1238: 0000:     STKMQ.REASON$,           \ 1 byte ASCII. "I" = ineligible,
1239: 0000:                              \               "U" = unsuppliable,
1240: 0000:                              \               "Z" = deleted,
1241: 0000:                              \               " " = not removed.
1242: 0000:     STKMQ.CONCEPT.SEQUENCE$, \ 3 byte UPD. Concept group / sequence
1243: 0000:     STKMQ.INVOICE.DAY$,      \ 1 byte UPD
1244: 0000:     STKMQ.LIST.NUMBER$,      \ 4 byte ASCII
1245: 0000:     STKMQ.ITEM.NUMBER$,      \ 2 byte ASCII
1246: 0000:     STKMQ.ITEM.STATUS$,      \ 1 byte ASCII
1247: 0000:     STKMQ.COUNT.DATE$,       \ 3 byte UPD - YYMMDD
1248: 0000:     STKMQ.COUNT.TIME$,       \ 2 byte UPD - HHMM
1249: 0000:     STKMQ.PRICE$,            \ 5 byte UPD
1250: 0000:     STKMQ.SHOP.COUNT$,       \ variable ASCII
1251: 0000:     STKMQ.BKRM.COUNT$,       \ variable ASCII
1252: 0000:     STKMQ.LIST.STATUS$,      \ 1 byte ASCII
1253: 0000:     STKMQ.LEFT.TO.COUNT$,    \ variable ASCII
1254: 0000:     STKMQ.COUNT.BY.DATE$,    \ 3 bytes UPD
1255: 0000:     STKMQ.PRODUCT.GROUP$,    \ 3 bytes UPD
1256: 0000:     STKMQ.BC.LETTER$,        \ 1 byte ASCII
1257: 0000:     STKMQ.ORG.RECOUNT$,      \ VARIABLE ASCII
1258: 0000:     STKMQ.NEW.RECOUNT$,      \ VARIABLE ASCII
1259: 0000:     STKMQ.LIST.TYPE$,        \ 1 byte ASCII
1260: 0000:     STKMQ.COUNT.FLAG$,       \ 1 byte ASC from corrections file
1261: 0000:     STKMQ.STMVT.DATE$,       \ 3 bytes UPD
1262: 0000:     STKMQ.SUPPLIER.NO$,      \ 4 bytes UPD
1263: 0000:     STKMQ.ORDER.NO$,         \ 2 bytes UPD
1264: 0000:     STKMQ.ORDER.SFX$,        \ 1 byte ASCII
1265: 0000:     STKMQ.PAGE.NO$,          \ 1 byte UPD
1266: 0000:     STKMQ.ORDER.DATE$,       \ 3 bytes UPD
1267: 0000:     STKMQ.EXP.DELV.DATE$,    \ 3 bytes UPD
1268: 0000:     STKMQ.DALLAS.MKR$,       \ 1 byte ASCII DALLAS system marker
1269: 0000:                              \ 'Y' - invoice is from DALLAS system,
1270: 0000:                              \ 'N' - invoice is not from DALLAS system
1271: 0000:                              \ 'Q' - invoice contains quantity alterations
1272: 0000:     STKMQ.SOURCE$,           \ 1 byte ASCII Source flag
1273: 0000:                              \ 'S' - PSS65, 'P' - PDT, PSS57
1274: 0000:                              \ Transaction type 11 'S' - Stocktake else ' '
1275: 0000:     STKMQ.FLAG$,             \ Transaction type 11 'F' - First 'L' - Last or ' '
1276: 0000:     STKMQ.BAR.CODE$,         \ 6 bytes UPD
1277: 0000:     STKMQ.CODE.FLAG$,        \ 1 BYTE ASCII
1278: 0000:     STKMQ.QTY.GOOD$,         \ VARIABLE ASCII
1279: 0000:                              \ Quantity of singles booked in in good condition
1280: 0000:     STKMQ.QTY.BAD$,          \ VARIABLE ASCII
1281: 0000:                              \ Quantity of singles booked in in bad condition
1282: 0000:     STKMQ.QTY.STOLEN$,       \ VARIABLE ASCII
1283: 0000:                              \ Quantity of singles recognised as stolen
1284: 0000:     STKMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
1285: 0000:                              \ 'C' - Order has been confirmed
1286: 0000:                              \ 'A' - Order has been amended
1287: 0000:                              \ ' ' - Nothing has been done to the order
1288: 0000:     STKMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
1289: 0000:                              \ processed
1290: 0000:     STKMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
1291: 0000:     STKMQ.SNGLS.ADDED$,      \ 2 byte UPD  Singles added to order
1292: 0000:     STKMQ.ITEMS.ADDED$,      \ 2 byte UPD  Items added to order
1293: 0000:     STKMQ.ITEMS.BOOKED$,     \ 2 byte UPD  Items booked in on the order
1294: 0000:     STKMQ.DIST.CENTRE$,      \ 1 byte UPD
1295: 0000:     STKMQ.WHSE.NUMBER$,      \ 1 byte UPD
1296: 0000:     STKMQ.STORE.NUMBER$,     \ 2 byte UPD
1297: 0000:     STKMQ.UOD.NUMBER$,       \ 3 byte UPD
1298: 0000:     STKMQ.STATUS$,           \ 1 byte ASCII
1299: 0000:                              \
1300: 0000:     STKMQ.CREDIT.CLAIM.NUM$, \ 4 byte UPD
1301: 0000:     STKMQ.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
1302: 0000:                              \              "E" = Excess,
1303: 0000:                              \              "R" = Repairs
1304: 0000:     STKMQ.SUPPLIER.NUM$,     \ 3 byte UPD
1305: 0000:     STKMQ.INVOICE.NUM$,      \*9 byte ASC
1306: 0000:     STKMQ.FOLIO.NUM$,        \ 3 byte UPD
1307: 0000:     STKMQ.BATCH.REF$,        \ 3 byte UPD
1308: 0000:     STKMQ.WHOLE.PART.CON$,   \ 1 byte ASC   "W" = Whole, "P" = Part
1309: 0000:     STKMQ.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
1310: 0000:                              \               2 = Estimate,
1311: 0000:                              \               3 = Boots guarantee,
1312: 0000:                              \               4 = Supplier guarantee,
1313: 0000:                              \               5 = Other guarantee,
1314: 0000:     STKMQ.REPAIR.NUM$,       \ 6 byte UPD
1315: 0000:     STKMQ.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
1316: 0000:     STKMQ.DDDA.DCDR.NUM$,    \ 4 byte UPD
1317: 0000:     STKMQ.DELIV.NOTE.NUM$,   \*9 byte ASC
1318: 0000:     STKMQ.NUM.CARTONS.RECEIV$,\1 byte UPD
1319: 0000:     STKMQ.ORDER.NUM$,        \*7 byte ASC
1320: 0000:     STKMQ.COMMENT$,          \*20 byte ASC
1321: 0000:     STKMQ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
1322: 0000:                              \               "B" = Barcode.
1323: 0000:     STKMQ.ITEM.BARCODE$,     \ 7 byte UPD
1324: 0000:     STKMQ.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
1325: 0000:     STKMQ.AUTHORISATION$,    \ 15 byte ASC
1326: 0000:     STKMQ.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
1327: 0000:     STKMQ.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
1328: 0000:     STKMQ.UOD.NUM$,          \ 7 byte UPD
1329: 0000:     STKMQ.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
1330: 0000:                              \              "C" = Closed,
1331: 0000:                              \              "D" = Despatched
1332: 0000:     STKMQ.SUPPLY.ROUTE$,     \ 1 byte ASC
1333: 0000:     STKMQ.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
1334: 0000:                              \              "D" = Dispensary
1335: 0000:     STKMQ.RECALL.NUM$,       \ 8 byte ASC
1336: 0000:     STKMQ.SUPPLIER$,         \ 15 byte ASC
1337: 0000:     STKMQ.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
1338: 0000:                              \               2 = BIRD,
1339: 0000:                              \               3 = Via D6,
1340: 0000:                              \               4 = Representative
1341: 0000:     STKMQ.CARRIER$,          \ 1 byte UPD;   1 = GPO,
1342: 0000:                              \               2 = Parcelforce,
1343: 0000:                              \               3 = Securicor,
1344: 0000:                              \               4 = Other
1345: 0000:     STKMQ.BIRD.NUM$,         \ 8 byte ASC
1346: 0000:     STKMQ.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
1347: 0000:                              \              "C" = CSR
1348: 0000:     STKMQ.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
1349: 0000:                              \               2 = Town Tray,
1350: 0000:                              \               3 = Roll cage,
1351: 0000:                              \               4 = Other
1352: 0000:     STKMQ.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
1353: 0000:                              \               2 = Poor handling
1354: 0000:     STKMQ.RECEIVING.STORE$,  \ 2 byte UPD
1355: 0000:     STKMQ.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
1356: 0000:                              \               2 = MTS,
1357: 0000:                              \               3 = Other
1358: 0000:     STKMQ.DATE.UOD.OPENED$,  \ 3 byte UPD
1359: 0000:     STKMQ.DATE.DESPATCHED$,  \ 3 byte UPD
1360: 0000:     STKMQ.TIME.DESPATCHED$,  \ 3 byte UPD
1361: 0000:     STKMQ.ITEM.UPDATED$,     \ 1 byte ASC
1362: 0000:     STKMQ.DATE.SESS.END$,    \ 3 byte UPD
1363: 0000:     STKMQ.TIME.SESS.END$,    \ 3 byte UPD
1364: 0000:     STKMQ.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
1365: 0000:                              \              "D" = Despatched,
1366: 0000:                              \              "X" = Cancelled
1367: 0000:     STKMQ.ITEM.NUM$,         \ 2 byte UPD   (CCITF key value)
1368: 0000:     STKMQ.CLAIM.VALUE$,      \ 3 byte UPD
1369: 0000:     STKMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.3NWB
1370: 0000:                              \                 'N' Normal Book In           ! 1.3NWB
1371: 0000:                              \                 'A' Carton Audit Process     ! 1.3NWB
1372: 0000:                              \                 'E' Exception Process (nof)  ! 1.3NWB
1373: 0000:     STKMQ.CARTON.NO$,        \ 4 bytes UPD (0-9999)                         ! 1.3NWB
1374: 0000:     STKMQ.RECALL.TYPE$       ! 1 byte ASC   "B" = Batch Recall              ! 1.4BG
1375: 0000:                              !              "N" = Non-batch Recall          ! 1.4BG
1376: 0000:                              !              " " = Old Credit Claim          ! 1.4BG
1377: 0000: 
1378: 0000: !***********************************************************!* DC 1.6
1379: 0000: !* Added for +UOD Development                               !* DC 1.6
1380: 0000: !***********************************************************!* DC 1.6
1381: 0000:   STRING GLOBAL \                                           !* DC 1.6 
1382: 0000:     STKMQ.LICENCE.PLATE$, \                                 !* DC 1.6 
1383: 0000:     STKMQ.DESPATCH.DATE$, \                                 !* DC 1.6 
1384: 0000:     STKMQ.ACTION$, \                                        !* DC 1.6 
1385: 0000:     STKMQ.DELIVERY.DATE$, \                                 !* DC 1.6 
1386: 0000:     STKMQ.DELIVERY.TIME$, \                                 !* DC 1.6 
1387: 0000:     STKMQ.DRIVER.ID$, \                                     !* DC 1.6 
1388: 0000:     STKMQ.BOOKIN.DATE$, \                                   !* DC 1.8
1389: 0000:     STKMQ.BOOKIN.TIME$, \                                   !* DC 1.8 
1390: 0000:     STKMQ.OP.ID$, \                                         !* DC 1.6 
1391: 0000:     STKMQ.BOOKIN.METHOD$, \                                 !* DC 1.6 
1392: 0000:     STKMQ.BOOKIN.LEVEL$, \                                  !* DC 1.6 
1393: 0000:     STKMQ.GIT$, \                                           !* DC 1.6 
1394: 0000:     STKMQ.RESCAN$, \                                        !* DC 1.7
1395: 0000:     STKMQ.FILLER$                                           !* DC 1.6 
1396: 0000: 
1397: 0000:   INTEGER*2 GLOBAL           \                              !* DC 1.6 
1398: 0000:     STKMQ.SESS.NUM%,         \                              !* DC 1.6 
1399: 0000:     STKMQ.REPORT.NUM%                                       !* DC 1.6 
1400: 0000: !***********************************************************!* DC 1.6
1401: 0000: 
1402: 0000:     STRING GLOBAL                                                       \   !FMW
1403: 0000:         STKMQ.UOD.QTY$,         \                                       \   !FMW
1404: 0000:         STKMQ.CODE$(1),         \ Item Code                             \   !FMW
1405: 0000:         STKMQ.TYPE$(1),         \ Code type I = Item code               \   !FMW
1406: 0000:                                 \           B = Barcode                 \   !FMW
1407: 0000:         STKMQ.CSR.FLAG$(1),     \ CSR Flag                              \   !FMW
1408: 0000:         STKMQ.EAN.CODE$(1),     \ Barcode                               \   !FMW
1409: 0000:         STKMQ.QTY$(1),          \ Quantity                              \   !FMW
1410: 0000:         STKMQ.GOOD.QUAN$(1),    \ Good Quantity                         \   !FMW
1411: 0000:         STKMQ.DAM.QUAN$(1),     \ Damaged Quantity                      \   !FMW
1412: 0000:         STKMQ.STOL.QUAN$(1),    \ Stolen Quantity                       \   !FMW
1413: 0000:         STKMQ.PRICE.ARRAY$(1)   ! Retail Price                              !FMW
1414: 0000:                                                                             !FMW
1415: 0000:     INTEGER*2 GLOBAL                                                    \   !FMW
1416: 0000:         STKMQ.ITEM%             ! Count of items in a transaction           !FMW
1417: 0000: 
1418: 0000:  %INCLUDE BCSMFDEC.J86                    ! FLC
1419: 0000: REM \
1420: 0000: \******************************************************************************
1421: 0000: \******************************************************************************
1422: 0000: \***
1423: 0000: \***   %INCLUDE FOR BUSINESS CENTRE SUPPLY METHOD FILE REFERENCE PARAMETERS
1424: 0000: \***                                              FIELD DECLARATIONS
1425: 0000: \***
1426: 0000: \***               REFERENCE    : BCSMFDEC.J86
1427: 0000: \***
1428: 0000: \***  Version A - L Cook
1429: 0000: \***  Copied from bcsmfnue.j86 and bcsmffle.j86
1430: 0000: \***
1431: 0000: \***  Version B - Les Cook
1432: 0000: \***  to include integer missed from bcsmfflf.j86 in error
1433: 0000: \***
1434: 0000: \******************************************************************************
1435: 0000: \*******************************************************************************
1436: 0000: 
1437: 0000:   STRING GLOBAL           \
1438: 0000:     BCSMF.FILE.NAME$,              \ 
1439: 0000:     BCSMF.FSI$,                    \ 1 byte ASCII folio series identifier (key)
1440: 0000:     BCSMF.NAME$,                   \ 14 bytes ASCII business centre name
1441: 0000:     BCSMF.PSEUDO.BUSINESS.CENTRE$, \ 1 byte flag "Y" = pseudo bc
1442: 0000:     BCSMF.FILLER$                  ! 3 bytes spaces
1443: 0000: 
1444: 0000:   INTEGER*1 GLOBAL          \
1445: 0000:     BCSMF.RECNT.LIMIT%,     \ percentage of recounts that may be generated
1446: 0000:     BCSMF.MIN.RECNT.LIMIT%, \ minimum limit
1447: 0000:     BCSMF.MAX.RECNT.LIMIT%, \ maximum limit
1448: 0000:     BCSMF.DISCRPNCY.CNT%,   \ used to calculate   
1449: 0000:     BCSMF.DISCRPNCY.PERCNT%,\ if recount
1450: 0000:     BCSMF.STK.CNT.LIMIT%,   \ is necessary
1451: 0000:     BCSMF.SEQUENCE.NO%,     \ used for displaying
1452: 0000:     BCSMF.NO.REPEAT.TICKETS% ! Number of repeat FALCONCRAFT tickets	! CLC
1453: 0000: 
1454: 0000:   INTEGER*2 GLOBAL        \
1455: 0000:     BCSMF.DISCRPNCY.VAL%,   \ (in pounds) used for determining recounts
1456: 0000:     BCSMF.MIN.LIST.NO%,     \ allowable range of 
1457: 0000:     BCSMF.MAX.LIST.NO%,     \ spare list numbers
1458: 0000:     BCSMF.RECL%,          \
1459: 0000:     BCSMF.SESS.NUM%,      \
1460: 0000:     BCSMF.REPORT.NUM%
1461: 0000:  %INCLUDE IEFDEC.J86                      ! DLC
1462: 0000: REM \
1463: 0000: \******************************************************************************
1464: 0000: \******************************************************************************
1465: 0000: \***
1466: 0000: \***         %INCLUDE FOR ITEM EAN CODES FILE - FIELD DECLARATIONS
1467: 0000: \***                                            FILE REFERENCE PARAMETERS
1468: 0000: \***
1469: 0000: \***               FILE TYPE    : Keyed
1470: 0000: \***
1471: 0000: \***               REFERENCE    : IEFDEC.J86
1472: 0000: \***
1473: 0000: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
1474: 0000: \***    No changes to this file.
1475: 0000: \***
1476: 0000: \*******************************************************************************
1477: 0000: \*******************************************************************************
1478: 0000: 
1479: 0000:   STRING GLOBAL                      \
1480: 0000:     IEF.FILE.NAME$,		     \
1481: 0000:     IEF.BOOTS.CODE.BAR.CODE$,        \ 9 byte UPD -                        BBAAS
1482: 0000:                                      \ 3 bytes UPD boots code              BBAAS   
1483: 0000:                                      \ + 6 UPD bar code,                   BBAAS
1484: 0000:                                      \ no check digits. (key)              BBAAS
1485: 0000:     IEF.NEXT.BAR.CODE$               ! 6 byte UPD without check digit
1486: 0000: 
1487: 0000:   INTEGER*2 GLOBAL        \
1488: 0000:     IEF.REPORT.NUM%,	  \
1489: 0000:     IEF.SESS.NUM%,	  \ 
1490: 0000:     IEF.RECL%
1491: 0000:  %INCLUDE DIRORDEC.J86                    ! DLC
1492: 0000: REM \
1493: 0000: \******************************************************************************
1494: 0000: \******************************************************************************
1495: 0000: \***
1496: 0000: \***     %INCLUDE FOR STORE DIRECT ORDERS FILE  - FIELD DECLARATIONS
1497: 0000: \***                                              FILE REFERENCE PARAMETERS
1498: 0000: \***
1499: 0000: \***               FILE TYPE    : Keyed
1500: 0000: \***
1501: 0000: \***               REFERENCE    : DIRORDEC.J86
1502: 0000: \***
1503: 0000: \***               DATE OF LAST AMENDMENT - 14/08/1992
1504: 0000: \***
1505: 0000: \***               VERSION A    : Les Cook    14th August 1992
1506: 0000: \***
1507: 0000: \***  VERSION B                 Neil Bennett                21st December 2006
1508: 0000: \***  New variable added to hold superceded flag for ASN Carton Support.
1509: 0000: \***
1510: 0000: \******************************************************************************
1511: 0000: \******************************************************************************
1512: 0000: 
1513: 0000:   STRING GLOBAL               \
1514: 0000:       DIRORD.FILE.NAME$,      \
1515: 0000:     DIRORD.RECKEY$,           \ 9 byte key which comprises the following fields
1516: 0000:     DIRORD.SUPPLIER$,         \ 3 bytes UPD (key)
1517: 0000:     DIRORD.ORDER.NO$,         \ 2 bytes UPD (key)
1518: 0000:     DIRORD.ORDER.SUF$,        \ 1 byte ASCII (key)
1519: 0000:     DIRORD.BUS.CENTRE$,       \ 1 byte ASCII (key)
1520: 0000:     DIRORD.SOURCE$,           \ 1 byte ASCII (key), 'D' if from PSS57
1521: 0000:                               \                     ' ' for head office order
1522: 0000:     DIRORD.PAGE.NO$,          \ 1 byte UPD (key)
1523: 0000:                               \
1524: 0000:     DIRORD.CONF.END.TIME$,    \ 2 bytes UPD - Ending time of last update
1525: 0000:     DIRORD.CONF.STRT.TIME$,   \ 2 bytes UPD - Starting time of last update
1526: 0000:     DIRORD.CONFIRM.DATE$,     \ 3 bytes UPD. YYMMDD - set to low values if
1527: 0000:                               \                       confirm flag is blank
1528: 0000:     DIRORD.CONFIRM.FLAG$,     \ 1 byte ASCII. C=Complete, A=Amended,
1529: 0000:                               \               blank = not confirmed
1530: 0000:     DIRORD.DRRF.LAST.DATE$,   \ 3 bytes UPD Date of last run
1531: 0000:     DIRORD.DRRF.LAST.TIME$,   \ 2 bytes UPD Time of last run
1532: 0000:     DIRORD.EXP.DELV.DATE$,    \ 3 bytes UPD. YYMMDD - Expected date of order's
1533: 0000:                               \                       delivery
1534: 0000:     DIRORD.FILLER1$,          \ 494 bytes ASCII set to spaces
1535: 0000:     DIRORD.FILLER2$,          \ 474 bytes ASCII set to spaces
1536: 0000:     DIRORD.FILLER3$,          \ 15 bytes ASCII set to spaces
1537: 0000:     DIRORD.ITEM.COUNT$,       \ 1 byte UPD  - Number of items on record
1538: 0000:     DIRORD.ITEM.DETAILS$(2),  \ 256 bytes containing the repeated item string
1539: 0000:                               \ details. The first dimension has 16 elements
1540: 0000:                               \ corresponding to lines on the invoice.  The
1541: 0000:                               \ second dimension has 4 elements:-
1542: 0000:                               \   1. Boots Code - 4 bytes UPD (0 if bar code
1543: 0000:                               \                                has no matching
1544: 0000:                               \                                Boots code on
1545: 0000:                               \                                file)
1546: 0000:                               \   2. Bar Code   - 6 bytes UPD
1547: 0000:                               \   2. Price      - 4 bytes UPD
1548: 0000:                               \   3. Filler     - 2 bytes ASCII spaces
1549: 0000:                               \ Any unused entries are set to spaces
1550: 0000:     DIRORD.NO.ITEMS.BOOKED$,  \ 2 bytes UPD - Total number of items booked in
1551: 0000:     DIRORD.NO.ITEMS.LST.BKD$, \ 2 bytes UPD - Number of items booked in during
1552: 0000:                               \               last date of update
1553: 0000:     DIRORD.NO.ORDER.ITEM$,    \ 2 bytes UPD - Total number of items in order
1554: 0000:     DIRORD.NO.ORDER.SNGL$,    \ 2 bytes UPD - Total single quantity in order
1555: 0000:     DIRORD.ON.SALE.DATE$,     \ 3 bytes UPD. YYMMDD - Date stock should be on
1556: 0000:                               \                       sale
1557: 0000:     DIRORD.ORDER.DATE$,       \ 3 bytes UPD. YYMMDD Date of order
1558: 0000:     DIRORD.SUPERCEDED$        ! 1 byte ASCII (Y/N) default to N             !BNWB
1559: 0000: 
1560: 0000:     INTEGER*2 GLOBAL       \
1561: 0000:       DIRORD.ITEM.QTY%(2), \ contains the repeated item integer details. The
1562: 0000:                            \ first dimension has 16 elements corresponding to
1563: 0000:                            \ lines on the invoice.  The second dimension has 7
1564: 0000:                            \ elements:-
1565: 0000:                            \   1. Quantity expected from order
1566: 0000:                            \   2. Quantity booked in in good condition
1567: 0000:                            \   3. Quantity booked in in damaged condition
1568: 0000:                            \   4. Quantity booked in as stolen
1569: 0000:                            \   5. Quantity last booked in in good condition
1570: 0000:                            \   6. Quantity last booked in in damaged condition
1571: 0000:                            \   7. Quantity last booked in as stolen
1572: 0000:                            \   Fields 2 to 4 are running totals, fields 5 to 7
1573: 0000:                            \   are the values associated with the confirm/amend
1574: 0000:                            \   date.
1575: 0000:       DIRORD.RECL%,        \
1576: 0000:       DIRORD.SESS.NUM%,    \
1577: 0000:       DIRORD.REPORT.NUM%
1578: 0000: 
1579: 0000:     INTEGER*4 GLOBAL       \
1580: 0000:       DIRORD.NO.RECS%
1581: 0000:  %INCLUDE DIRSUDEC.J86                    ! DLC
1582: 0000: REM \
1583: 0000: \******************************************************************************
1584: 0000: \******************************************************************************
1585: 0000: \***
1586: 0000: \***     %INCLUDE FOR STORE DIRECT SUPPLIER FILE FIELD DECLARATIONS
1587: 0000: \***                                             FILE REFERENCE PARAMETERS
1588: 0000: \***      
1589: 0000: \***               FILE TYPE    : Keyed
1590: 0000: \***
1591: 0000: \***               REFERENCE    : DIRSUDEC.J86
1592: 0000: \***
1593: 0000: \***     Version A - L Cook
1594: 0000: \***
1595: 0000: \***     Combined DIRSUFLA.J86 and DIRSUNUA.J86
1596: 0000: \***
1597: 0000: \***   Version B           Mark Goode          3rd December 2008
1598: 0000: \***   Add new fields for the +ve UOD project
1599: 0000: \***
1600: 0000: \******************************************************************************
1601: 0000: \******************************************************************************
1602: 0000: 
1603: 0000:   STRING GLOBAL            \
1604: 0000:     DIRSUP.FILE.NAME$,     \
1605: 0000:     DIRSUP.RECKEY$,        \ 4 byte key which comprises the following fields
1606: 0000:       DIRSUP.BUS.CENTRE$,  \ 1 byte ASCII (key)
1607: 0000:       DIRSUP.SUPPLIER.NO$, \ 3 bytes UPD (key)
1608: 0000:                            \
1609: 0000:     DIRSUP.SUPPLIER.NAME$, \ 10 byte ASCII
1610: 0000:     DIRSUP.LEAD.TIME.MON$, \ 2 bytes UPD. Lead time for MONDAY in days
1611: 0000:     DIRSUP.LEAD.TIME.TUE$, \ 2 bytes UPD. Lead time for TUESDAY in days
1612: 0000:     DIRSUP.LEAD.TIME.WED$, \ 2 bytes UPD. Lead time for WEDNESDAY in days
1613: 0000:     DIRSUP.LEAD.TIME.THU$, \ 2 bytes UPD. Lead time for THURSDAY in days
1614: 0000:     DIRSUP.LEAD.TIME.FRI$, \ 2 bytes UPD. Lead time for FRIDAY in days
1615: 0000:     DIRSUP.LAPSING.DAYS$,  \ 2 bytes UPD. Number of days before order lapses
1616: 0000:     DIRSUP.PART.ORDER.RULES$, \ 1 byte ASCII. A=Rest of order supplied, 
1617: 0000:                               \               N,Z=not supplied 
1618: 0000:     DIRSUP.MAX.CHECK.QTY$,    \ 2 bytes UPD.
1619: 0000:     DIRSUP.CHECK.QTY$,        \ 2 bytes UPD.
1620: 0000:     DIRSUP.DISCREPANCY.QTY$,  \ 2 bytes UPD.
1621: 0000:     DIRSUP.DISCREPANCY.PERC$, \ 2 bytes UPD. Discrepancy percentage
1622: 0000:     DIRSUP.ASN.FLAG$,         \ 1 byte ASCII. Identifies supplier as ASN or Directs   ! BMG
1623: 0000:     DIRSUP.STATIC.SUPPLIER$,  \ 1 byte ASCII. Identifies supplier as being static     ! BMG
1624: 0000:     DIRSUP.FILLER$          ! 3 bytes ASCII set to low values                         ! BMG
1625: 0000: 
1626: 0000:   INTEGER*2 GLOBAL        \
1627: 0000:     DIRSUP.RECL%,         \
1628: 0000:     DIRSUP.SESS.NUM%,     \
1629: 0000:     DIRSUP.REPORT.NUM%
1630: 0000:     
1631: 0000:   INTEGER*4 GLOBAL        \
1632: 0000:     DIRSUP.NO.RECS%  
1633: 0000:  %INCLUDE DIRWFDEC.J86                    ! DLC
1634: 0000: \******************************************************************************
1635: 0000: \******************************************************************************
1636: 0000: \***
1637: 0000: \***      %INCLUDE FOR DIRWF - DIRECT WORK FILE - FIELD DEFINITIONS
1638: 0000: \***                                              FILE REFERENCE PARAMETERS
1639: 0000: \***
1640: 0000: \***
1641: 0000: \***       REFERENCE: DIRWFDEC.J86
1642: 0000: \***
1643: 0000: \******************************************************************************
1644: 0000: \*******************************************************************************
1645: 0000: 
1646: 0000:   STRING GLOBAL								\
1647: 0000: 	DIRWF.FILE.NAME$,						\
1648: 0000: 	DIRWF.RECORD$
1649: 0000: 
1650: 0000:   INTEGER*2 GLOBAL							\
1651: 0000: 	DIRWF.RECL%,	          					\
1652: 0000: 	DIRWF.SESS.NUM%,						\
1653: 0000: 	DIRWF.REPORT.NUM%
1654: 0000:  %INCLUDE DIRECDEC.J86                    ! DLC
1655: 0000: \******************************************************************************
1656: 0000: \******************************************************************************
1657: 0000: \***
1658: 0000: \***         %INCLUDE FOR DIREC DUMMY FILE I/O SESSION NUMBER
1659: 0000: \***
1660: 0000: \***               REFERENCE    : DIRECDEC.J86
1661: 0000: \***
1662: 0000: \******************************************************************************
1663: 0000: \*******************************************************************************
1664: 0000: 
1665: 0000:   STRING GLOBAL           \
1666: 0000:     DIREC.FILE.NAME$
1667: 0000: 
1668: 0000:   INTEGER*2 GLOBAL        \
1669: 0000:     DIREC.REPORT.NUM%,      \
1670: 0000:     DIREC.SESS.NUM%
1671: 0000:  %INCLUDE LDTCFDEC.J86                    ! DLC
1672: 0000: \******************************************************************************
1673: 0000: \******************************************************************************
1674: 0000: \***
1675: 0000: \***      %INCLUDE FOR LDTCF - LDT CHECK FILE - FILE REFERENCE PARAMETERS
1676: 0000: \***                                            FIELD DEFINITIONS
1677: 0000: \***
1678: 0000: \***       REFERENCE: LDTCFDEC.J86
1679: 0000: \***
1680: 0000: \***
1681: 0000: \******************************************************************************
1682: 0000: \*******************************************************************************
1683: 0000: 
1684: 0000:    STRING GLOBAL							\
1685: 0000: 	LDTCF.FILE.NAME$,						\
1686: 0000: 	LDTCF.VERSION.NO$,                                              \
1687: 0000: 	LDTCF.VERSION.DATE$
1688: 0000: 	
1689: 0000:    INTEGER*2 GLOBAL							\
1690: 0000:         LDTCF.SESS.NUM%,						\
1691: 0000: 	LDTCF.REPORT.NUM%
1692: 0000:  %INCLUDE DRSMQDEC.J86                    ! DLC
1693: 0000: \******************************************************************************
1694: 0000: \******************************************************************************
1695: 0000: \***
1696: 0000: \***      %INCLUDE FOR DIRECTS TEMPORARY STOCK MOVEMENT QUEUE
1697: 0000: \***       FILE FIELD DECLARATIONS
1698: 0000: \***       FILE REFERENCE PARAMETERS
1699: 0000: \***
1700: 0000: \***               FILE TYPE    : Sequential
1701: 0000: \***
1702: 0000: \***               REFERENCE    : DRSMQDEC.J86
1703: 0000: \***
1704: 0000: \***
1705: 0000: \******************************************************************************
1706: 0000: \*******************************************************************************
1707: 0000: \***
1708: 0000: \***  The length of the records on this file vary depending on the record
1709: 0000: \***  transaction type, but they all comprise combinations of the fields
1710: 0000: \***  defined below.
1711: 0000: \***
1712: 0000: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1713: 0000: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
1714: 0000: \***     NUMBER, ITEM COUNT, FIELD DELIMITER, ITEM CODE, BAR CODE,
1715: 0000: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
1716: 0000: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
1717: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1718: 0000: \***
1719: 0000: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1720: 0000: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
1721: 0000: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
1722: 0000: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
1723: 0000: \***
1724: 0000: \*******************************************************************************
1725: 0000: \***
1726: 0000: \***   REVISION 1.0     Neil Bennett                 2nd January 2007
1727: 0000: \***   Add ASN processing support.
1728: 0000: \***
1729: 0000: \*******************************************************************************
1730: 0000: 
1731: 0000:   STRING GLOBAL              \
1732: 0000:     DRSMQ.FILE.NAME$,        \
1733: 0000:     DRSMQ.RECORD$,           \ Used to store the whole record which is unstrung
1734: 0000:                              \ into the fields below
1735: 0000:     DRSMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
1736: 0000:     DRSMQ.TRANS.TYPE$,       \ 1 byte UPD.
1737: 0000:                              \             17 = Delivery without confirmation
1738: 0000:                              \                  of Direct Order detail
1739: 0000:                              \             19 = Delivery without confirmation
1740: 0000:                              \                  of Direct Order header
1741: 0000:     DRSMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1742: 0000:     DRSMQ.DATE$,             \ 3 byte UPD set to current date
1743: 0000:     DRSMQ.TIME$,             \ 3 byte UPD set to current time
1744: 0000:     DRSMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
1745: 0000:     DRSMQ.BOOTS.CODE$,       \ 4 bytes UPD
1746: 0000:     DRSMQ.QUANTITY$,         \ variable length string equivalent to
1747: 0000:                              \ STR$(DRSMQ.QUANTITY%)
1748: 0000:                              \ +ve indicates add to stock
1749: 0000:                              \ -ve indicates subtract from stock
1750: 0000:     DRSMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
1751: 0000:     DRSMQ.SUPPLIER.NO$,      \ 4 bytes UPD
1752: 0000:     DRSMQ.ORDER.NO$,         \ 2 bytes UPD
1753: 0000:     DRSMQ.ORDER.SFX$,        \ 1 byte ASCII
1754: 0000:     DRSMQ.PAGE.NO$,          \ 1 byte UPD
1755: 0000:     DRSMQ.ORDER.DATE$,       \ 3 bytes UPD
1756: 0000:     DRSMQ.SOURCE$,           \ 1 byte ASCII Source flag
1757: 0000:                              \ 'S' - PSS65, 'P' - PDT, PSS57
1758: 0000:     DRSMQ.BAR.CODE$,         \ 6 bytes UPD
1759: 0000:     DRSMQ.QTY.GOOD$,         \ VARIABLE ASCII
1760: 0000:                              \ Quantity of singles booked in in good condition
1761: 0000:     DRSMQ.QTY.BAD$,          \ VARIABLE ASCII
1762: 0000:                              \ Quantity of singles booked in in bad condition
1763: 0000:     DRSMQ.QTY.STOLEN$,       \ VARIABLE ASCII
1764: 0000:                              \ Quantity of singles recognised as stolen
1765: 0000:     DRSMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
1766: 0000:                              \ 'C' - Order has been confirmed
1767: 0000:                              \ 'A' - Order has been amended
1768: 0000:                              \ ' ' - Nothing has been done to the order
1769: 0000:     DRSMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
1770: 0000:                              \ processed
1771: 0000:     DRSMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
1772: 0000:     DRSMQ.SNGLS.ADDED$,      \ 5 bytes ASCII Singles added to order
1773: 0000:     DRSMQ.ITEMS.ADDED$,      \ 5 bytes ASCII Items added to order
1774: 0000:     DRSMQ.ITEMS.BOOKED$,     \ 5 bytes ASCII Items booked in on the order
1775: 0000:     DRSMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.0NWB
1776: 0000:                              \                 'N' Normal Book In           ! 1.0NWB
1777: 0000:                              \                 'A' Carton Audit Process     ! 1.0NWB
1778: 0000:                              \                 'E' Exception Process (nof)  ! 1.0NWB
1779: 0000:     DRSMQ.CARTON.NO$         ! 4 bytes UPD (0-9999)                         ! 1.0NWB
1780: 0000: 
1781: 0000: 
1782: 0000:   INTEGER*2 GLOBAL           \
1783: 0000:     DRSMQ.SESS.NUM%,         \
1784: 0000:     DRSMQ.REPORT.NUM%
1785: 0000:  %INCLUDE LDTBFDEC.J86                    ! ELC
1786: 0000: \******************************************************************************
1787: 0000: \***
1788: 0000: \***           %INCLUDE FOR LDTBF - LDT STOCK BUFFER FILE
1789: 0000: \***
1790: 0000: \***                    - FIELD DECLARATIONS   
1791: 0000: \***                    - FILE REFERENCE PARAMETERS  
1792: 0000: \***  
1793: 0000: \***                    REFERENCE: LDTBFDEC.J86
1794: 0000: \***      
1795: 0000: \******************************************************************************
1796: 0000: \***
1797: 0000: \***     Version A:      Mike Kelsall      12th October 1992
1798: 0000: \***
1799: 0000: \***     Each order in the LDTBF is recorded in the following format:
1800: 0000: \***
1801: 0000: \***         Order Header  -  Record Identifier   2  ASC  "OH"
1802: 0000: \***                          Supplier Number     3  UPD
1803: 0000: \***                          Order Number        2  UPD
1804: 0000: \***                          Order Suffix        1  ASC   
1805: 0000: \*** 
1806: 0000: \***  (N x)  Order Record  -  Record Identifier   2  ASC  "OD"
1807: 0000: \***                          Boots/Bar code      6  UPD
1808: 0000: \***                          Damaged Quantity    2  INT
1809: 0000: \***                          Stolen Quantity     2  INT
1810: 0000: \*** 
1811: 0000: \***         Order Trailer -  Record Identifier   2  ASC  "OT"
1812: 0000: \***                          Number of items     2  INT 
1813: 0000: \***
1814: 0000: \***
1815: 0000: \***     Version B.          Stuart Highley            8th August 1997
1816: 0000: \***     Added fields: LDTBF.DATE$, LDTBF.START.TIME$, LDTBF.END.TIME$,
1817: 0000: \***                   LDTBF.LOGGED.QTY%
1818: 0000: \***
1819: 0000: \******************************************************************************
1820: 0000: 
1821: 0000: INTEGER*1 GLOBAL                 \
1822: 0000:                                  \
1823: 0000:            LDTBF.SESS.NUM% 
1824: 0000: 
1825: 0000: 
1826: 0000: INTEGER*2 GLOBAL                 \
1827: 0000:                                  \
1828: 0000:            LDTBF.RECL%,          \
1829: 0000:            LDTBF.REPORT.NUM%,    \
1830: 0000:                                  \
1831: 0000:            LDTBF.LOGGED.QTY%,    \  2 byte INT - Already logged qty    ! BSH
1832: 0000:            LDTBF.DAMAGED.QTY%,   \  2 byte INT - Damaged quantity, from LDT
1833: 0000:            LDTBF.STOLEN.QTY%,    \  2 byte INT - Stolen quantity, from LDT
1834: 0000:            LDTBF.GOOD.QTY%,      \  2 byte INT - Good quantity, from LDT
1835: 0000:            LDTBF.ORDERED.QTY%,   \  2 byte INT - Ordered quantity
1836: 0000:            LDTBF.NUM.OF.ITEMS%   !  2 byte INT - Number of items in order
1837: 0000:      
1838: 0000: 
1839: 0000: STRING GLOBAL                    \
1840: 0000:                                  \
1841: 0000:            LDTBF.FILE.NAME$,     \
1842: 0000:                                  \
1843: 0000:            LDTBF.RECORD.ID$,     \  2 byte ASC - Record Identifier
1844: 0000:            LDTBF.SUPPLIER.NUM$,  \  3 byte UPD - Supplier number, from LDT
1845: 0000:            LDTBF.ORDER.NUM$,     \  2 byte UPD - Order number, from LDT 
1846: 0000:            LDTBF.ORDER.SUFFIX$,  \  1 byte ASC - Order suffix, from LDT
1847: 0000:            LDTBF.DATE$,          \  3 byte UPD - Date booked in        ! BSH
1848: 0000:            LDTBF.START.TIME$,    \  2 byte UPD - Time started booking  ! BSH
1849: 0000:            LDTBF.END.TIME$,      \  2 byte UPD - Time ended booking    ! BSH
1850: 0000:            LDTBF.REF.CODE$       !  6 byte UPD - Boots/Bar code, from LDT
1851: 0000:  %INCLUDE IDSOFDEC.J86                    ! ELC
1852: 0000: REM \
1853: 0000: \******************************************************************************
1854: 0000: \******************************************************************************
1855: 0000: \***
1856: 0000: \***      %INCLUDE FOR CSR OUTSTANDING INITIAL STOCK QUANTITIES FILE
1857: 0000: \***                                             FIELD DECLARATIONS
1858: 0000: \***                                             FILE REFERENCE PARAMETERS
1859: 0000: \***
1860: 0000: \***               FILE TYPE    : Keyed
1861: 0000: \***
1862: 0000: \***               REFERENCE    : IDSOFFLD.J86
1863: 0000: \***
1864: 0000: \***      Version A.     Stephen Kelsey (CTG)               21st October 1992
1865: 0000: \***
1866: 0000: \******************************************************************************
1867: 0000: \*******************************************************************************
1868: 0000: 
1869: 0000:   STRING GLOBAL                  \
1870: 0000:     IDSOF.BC.LETTER$,            \ 1 byte UPD
1871: 0000:     IDSOF.EXP.DELV.DATE$,        \ 3 byte UPD YYMMDD
1872: 0000:     IDSOF.FILE.NAME$,            \
1873: 0000:     IDSOF.FILLER$,               \ 10 bytes ASC
1874: 0000:     IDSOF.ITEM.CODE$             ! 4 byte UPD
1875: 0000: 
1876: 0000:   INTEGER*2 GLOBAL               \
1877: 0000:     IDSOF.QUANTITY%,             \ Outstanding Stock Quantity
1878: 0000:     IDSOF.RECL%,                 \     
1879: 0000:     IDSOF.REPORT.NUM%,           \     
1880: 0000:     IDSOF.SESS.NUM% 
1881: 0000:     
1882: 0000:  %INCLUDE UODDEC.J86                      ! FLC
1883: 0000: \******************************************************************************
1884: 0000: \******************************************************************************
1885: 0000: \***
1886: 0000: \***         %INCLUDE FOR UOD DUMMY FILE I/O SESSION NUMBER
1887: 0000: \***
1888: 0000: \***               REFERENCE    : UODDEC.J86
1889: 0000: \***
1890: 0000: \******************************************************************************
1891: 0000: \*******************************************************************************
1892: 0000: 
1893: 0000:   STRING GLOBAL           \
1894: 0000:     UOD.FILE.NAME$
1895: 0000: 
1896: 0000:   INTEGER*2 GLOBAL        \
1897: 0000:     UOD.REPORT.NUM%,      \
1898: 0000:     UOD.SESS.NUM%
1899: 0000:  %INCLUDE UODBFDEC.J86                    ! FLC
1900: 0000: REM \
1901: 0000: \******************************************************************************
1902: 0000: \******************************************************************************
1903: 0000: \***
1904: 0000: \***      %INCLUDE FOR UOD BUFFER FILE FIELD DECLARATIONS
1905: 0000: \***                              FILE REFERENCE PARAMETERS
1906: 0000: \***
1907: 0000: \***               FILE TYPE    : Sequential
1908: 0000: \***
1909: 0000: \***               REFERENCE    : UODBFDEC.J86
1910: 0000: \***
1911: 0000: \***      Version A.     Michael Kelsall             8th February 1993
1912: 0000: \***
1913: 0000: \******************************************************************************
1914: 0000: \*******************************************************************************
1915: 0000: \***
1916: 0000: \***  The length of the records on this file vary depending on the record
1917: 0000: \***  transaction type, but they all comprise combinations of the fields
1918: 0000: \***  defined below.
1919: 0000: \***
1920: 0000: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,       
1921: 0000: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
1922: 0000: \***     END OF RECORD MARKER.
1923: 0000: \***
1924: 0000: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, DATE, TIME, 
1925: 0000: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1926: 0000: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
1927: 0000: \***
1928: 0000: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, DATE, TIME,
1929: 0000: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1930: 0000: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, 
1931: 0000: \***     FIELD DELIMITER, FSI, FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, 
1932: 0000: \***     FOLIO NO, RECORD DELIMITER, END OF RECORD MARKER
1933: 0000: \***
1934: 0000: \******************************************************************************
1935: 0000: 
1936: 0000:   STRING GLOBAL              \
1937: 0000:     UODBF.FILE.NAME$,	     \
1938: 0000:     UODBF.RECORD$,           \ Used to store the whole record which is unstrung
1939: 0000:                              \ into the fields below
1940: 0000:     UODBF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
1941: 0000:     UODBF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1942: 0000:     UODBF.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0Ah
1943: 0000:     UODBF.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
1944: 0000: 			     \             21 = UOD record
1945: 0000: 			     \             23 = Item Level UOD record
1946: 0000:     UODBF.CREATION.DATE$,    \ 3 byte UPD set to current date
1947: 0000:     UODBF.CREATION.TIME$,    \ 3 byte UPD set to current time
1948: 0000:     UODBF.DATE$,             \ 3 byte UPD set to current date
1949: 0000:     UODBF.TIME$,             \ 3 byte UPD set to current time
1950: 0000:     UODBF.DIST.CENTRE$,      \ 1 byte UPD   
1951: 0000:     UODBF.WAREHOUSE.NUM$,    \ 1 byte UPD   
1952: 0000:     UODBF.STORE.NUM$,        \ 2 byte UPD
1953: 0000:     UODBF.UOD.NUMBER$,       \ 2 byte UPD
1954: 0000:     UODBF.STATUS$,           \ 1 byte ASC.  "B" = Booked in
1955: 0000:     			     \		    "M" = Missing
1956: 0000: 			     \		    "O" = Opened
1957: 0000: 			     \		    "P" = Picking checked
1958: 0000: 			     \		    "R" = Retro booked in
1959: 0000: 			     \		    "D" = Retrospective opened
1960: 0000: 			     \		    "G" = Retrospective checked
1961: 0000: 			     \		    "A" = Automatically booked in
1962: 0000:     UODBF.BOOTS.BAR.CODE$,   \ 6 byte UPD    
1963: 0000:     UODBF.BOOTS.BAR.CODE.FLAG$, \ 1 byte ASC
1964: 0000:     UODBF.FSI$,              \ 1 byte ASCII
1965: 0000:     UODBF.FOLIO.YEAR$,       \ 1 byte UPD
1966: 0000:     UODBF.FOLIO.MONTH$,      \ 1 byte UPD
1967: 0000:     UODBF.FOLIO.NUMBER$,     \ 2 bytes UPD
1968: 0000:     UODBF.STORE.SUFFIX$      ! 1 byte ASCII
1969: 0000: 
1970: 0000: 			     			     			     
1971: 0000:   INTEGER*2 GLOBAL	     \
1972: 0000:     UODBF.SESS.NUM%,         \
1973: 0000:     UODBF.REPORT.NUM%,	     \
1974: 0000:     UODBF.QUANTITY%
1975: 0000: 			     
1976: 0000:  %INCLUDE UODTFDEC.J86                    ! FLC
1977: 0000: \******************************************************************************
1978: 0000: \******************************************************************************
1979: 0000: \***
1980: 0000: \***      %INCLUDE FOR UODS TEMPORARY FILE
1981: 0000: \***       FILE FIELD DECLARATIONS
1982: 0000: \***       FILE REFERENCE PARAMETERS
1983: 0000: \***
1984: 0000: \***               FILE TYPE    : Sequential
1985: 0000: \***
1986: 0000: \***               REFERENCE    : UODTFDEC.J86
1987: 0000: \***
1988: 0000: \***
1989: 0000: \******************************************************************************
1990: 0000: \*******************************************************************************
1991: 0000: 
1992: 0000:   STRING GLOBAL              \
1993: 0000:     UODTF.FILE.NAME$,	     \
1994: 0000:     UODTF.RECORD$            ! Used to store the whole record 
1995: 0000: 			     			     			     
1996: 0000:   INTEGER*2 GLOBAL	     \
1997: 0000:     UODTF.SESS.NUM%,	     \
1998: 0000:     UODTF.REPORT.NUM%			     
1999: 0000: 			     
2000: 0000:  %INCLUDE PILSTDEC.J86                    ! FLC
2001: 0000: 
2002: 0000: \******************************************************************************
2003: 0000: \***
2004: 0000: \***      %INCLUDE FOR PILST - LIST OF LISTS FILE - FIELD DECLARATIONS
2005: 0000: \***                                                FILE REFERENCE PARAMETERS
2006: 0000: \***
2007: 0000: \***                           8th October 1992
2008: 0000: \***
2009: 0000: \******************************************************************************
2010: 0000: 
2011: 0000:    INTEGER*1 GLOBAL             	\
2012: 0000:         PILST.REPORT.NUM%,		\
2013: 0000: 	PILST.SESS.NUM%,		\
2014: 0000: 	PILST.ITEMS.IN.LIST%,		\ No of items in list
2015: 0000: 	PILST.TO.BE.COUNTED%		! No of items left to be counted
2016: 0000: 
2017: 0000:    INTEGER*2 GLOBAL			\
2018: 0000:         PILST.RECL%
2019: 0000: 
2020: 0000:    STRING GLOBAL			\
2021: 0000: 	PILST.FILE.NAME$,		\
2022: 0000: 	PILST.LIST.NUMBER$,		\ 4 byte - list number
2023: 0000: 	PILST.SPARE.LIST.NUMBER$,	\ 4 byte - spare list number
2024: 0000: 	PILST.LIST.NAME$,		\12 byte - list name
2025: 0000: 	PILST.BC.LETTER$,		\ 1 byte - business centre letter
2026: 0000: 	PILST.LIST.TYPE$,		\ 1 byte - list type :
2027: 0000: 					\    "R" = regular,
2028: 0000: 					\    "C" = CSR,
2029: 0000: 					\    "E" = exceptions.
2030: 0000: 	PILST.COUNT.BY.DATE$,		\ 3 byte UPD - count by date
2031: 0000: 	PILST.PRODUCT.GROUP$,		\ 3 byte UPD - product group
2032: 0000: 	PILST.COUNT.DATE$,		\ 3 byte UPD - scheduled count date
2033: 0000: 	PILST.LIST.STATUS$,		\ 1 byte - list status :
2034: 0000: 					\    "C" = to be counted,
2035: 0000: 					\    "R" = to be re-counted,
2036: 0000: 					\    "X" = cancelled,
2037: 0000: 					\    "F" = completed.
2038: 0000: 	PILST.RECOUNT.DATE$,		\ 3 byte UPD - scheduled re-count date
2039: 0000: 	PILST.RECOUNT.ALLOWED$,		\ 1 byte UPD - re-count allowed flag
2040: 0000: 	PILST.CPM.RUN.DATE$,		\ 3 byte UPD - cpm. run date
2041: 0000: 	PILST.PIPLN.RUN.OK$,	        \ 1 byte - PIPLN run ok flag "Y" / "N"
2042: 0000: 	PILST.HIGHEST.LIST.NO$,	        \ 4 byte - highest transmitted list no
2043: 0000:         PILST.DET.FILLER$,              \ 6 bytes
2044: 0000:         PILST.HDR.FILLER$               ! 24 bytes
2045: 0000: 	
2046: 0000:  %INCLUDE PIITMDEC.J86                    ! FLC
2047: 0000: 
2048: 0000: \******************************************************************************
2049: 0000: \***
2050: 0000: \***     %INCLUDE FOR PIITM - ITEM LIST FILE - FIELD DECLARATIONS
2051: 0000: \***                                           FILE REFERENCE PARAMETERS
2052: 0000: \***
2053: 0000: \***     REFERENCE: PIITMDEC.J86
2054: 0000: \***        
2055: 0000: \***                           8TH OCTOBER 1992
2056: 0000: \***
2057: 0000: \******************************************************************************
2058: 0000: 
2059: 0000:    INTEGER*1 GLOBAL							\
2060: 0000: 	PIITM.REPORT.NUM%,						\
2061: 0000: 	PIITM.SESS.NUM%
2062: 0000: 
2063: 0000:    INTEGER*2 GLOBAL			\
2064: 0000: 	PIITM.RECL%,			\
2065: 0000: 	PIITM.DISCREPANCY%,		\ discrepancy
2066: 0000: 	PIITM.DISCREPANCY.AMT%		! discrepancy amount
2067: 0000: 	
2068: 0000:    STRING GLOBAL			\
2069: 0000: 	PIITM.FILE.NAME$,		\
2070: 0000: 	PIITM.LIST.ITEM.KEY$,		\ 4 + 1 bytes - list no. & item no
2071: 0000: 	PIITM.LIST.NUMBER$,		\ 4 byte - list number
2072: 0000: 	PIITM.ITEM.NUMBER$,		\ 2 byte - item number
2073: 0000: 	PIITM.ITEM.CODE$,		\ 4 byte UPD - item code
2074: 0000: 	PIITM.ON.IDF$,			\ 1 byte - on IDF flag "Y" / "N"
2075: 0000: 	PIITM.ACTIVITY.FLAG$,		\ 1 byte - activity flag
2076: 0000: 	PIITM.CYCLE.LENGTH$,		\ 2 byte - count cycle length (weeks)
2077: 0000: 	PIITM.FAMILY.MARKER$,		\ 2 byte - family marker
2078: 0000: 	PIITM.MEMBERS$,			\ 2 byte - number of members
2079: 0000: 	PIITM.ELIGIBILITY.FLAG$,	\ 1 byte - eligibility flag
2080: 0000: 	PIITM.LIST.STATUS$,		\ 1 byte - list status :
2081: 0000: 					\    "C" = to be counted,
2082: 0000: 					\    "R" = to be re-counted,
2083: 0000: 					\    "D" = counted,
2084: 0000: 					\    "F" = completed,
2085: 0000: 					\    "X" = cancelled.
2086: 0000: 	PIITM.POTENTIAL.RECOUNT$,	\ 1 byte - potential recount flag :
2087: 0000: 					\    "0" = not a potential re-count,
2088: 0000: 					\    "1" = failed value test,
2089: 0000: 					\    "2" = failed percentage test.
2090: 0000:         PIITM.FILLER$                   ! 5 bytes
2091: 0000: 					
2092: 0000: !%INCLUDE PDTWFDEC.J86                    ! FLC
2093: 0000: !%INCLUDE IRFDEC.J86                      ! FLC TEST
2094: 0000: 
2095: 0000:  %INCLUDE CCUODDEC.J86                    ! GMJK
2096: 0000: 
2097: 0000: \*****************************************************************************
2098: 0000: \*****************************************************************************
2099: 0000: \***
2100: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2101: 0000: \***
2102: 0000: \***                   FILE TYPE:  KEYED
2103: 0000: \***
2104: 0000: \***                   REFERENCE:  CCUODDEC.J86
2105: 0000: \***
2106: 0000: \***                 DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2107: 0000: \***                   FILE OF OPEN/CLOSED UODS
2108: 0000: \***
2109: 0000: \***
2110: 0000: \***    VERSION A : Michael J. Kelsall      13th September 1993
2111: 0000: \***      
2112: 0000: \***    VERSION B : Mark Walker                   18th Jul 2015
2113: 0000: \***    F392 Retail Stock 5
2114: 0000: \***    Added CCUOD.RETRIEVAL.FLAG$ field to allow record to be
2115: 0000: \***    marked as processed.
2116: 0000: \***
2117: 0000: \*****************************************************************************
2118: 0000: \*****************************************************************************
2119: 0000: 
2120: 0000: STRING GLOBAL           \
2121: 0000:    CCUOD.FILE.NAME$,        \
2122: 0000:    CCUOD.UOD.NUM$,      \  7 byte UPD;  Record key
2123: 0000:    CCUOD.STATUS$,       \  1 byte ASC;  "O" = Open,
2124: 0000:                 \           "C" = Closed,
2125: 0000:                 \           "D" = Despatched,       
2126: 0000:                 \           "X" = Cancelled.
2127: 0000:    CCUOD.CREDIT.CLAIM.NUM$, \  4 byte UPD
2128: 0000:                 \  CCUOD.NUM.OF.ITEMS% here (I2)
2129: 0000:    CCUOD.SUPPLY.ROUTE$,     \  1 byte ASC;  "W" = Warehouse,
2130: 0000:                 \           "E" = EPSOM,
2131: 0000:                 \           "O" = Other Directs,
2132: 0000:                 \               "D" = Dispensary.
2133: 0000:    CCUOD.DISP.LOCATION$,    \  1 byte ASC   "M" = MDS, "D" = Dispensary.
2134: 0000:    CCUOD.BC.LETTER$,        \  1 byte ASC    
2135: 0000:    CCUOD.RECALL.NUM$,       \  8 byte ASC
2136: 0000:    CCUOD.AUTHORISATION$,    \ 15 byte ASC
2137: 0000:    CCUOD.SUPPLIER$,     \ 15 byte ASC
2138: 0000:    CCUOD.METHOD.OF.RETURN$, \  1 byte UPD;   1 = Carrier,
2139: 0000:                 \                2 = BIRD,
2140: 0000:                 \        3 = Via D6,
2141: 0000:                 \        4 = Representative.
2142: 0000:    CCUOD.CARRIER$,      \  1 byte UPD;   1 = GPO,
2143: 0000:                 \                2 = Parcelforce,
2144: 0000:                 \        3 = Securicor,
2145: 0000:                 \        4 = Other.
2146: 0000:    CCUOD.BIRD.NUM$,     \  8 byte ASC                   
2147: 0000:    CCUOD.REASON.NUM$,       \  1 byte UPD     (See CSRNS declaration)
2148: 0000:    CCUOD.RECEIVING.STORE$,  \  2 byte UPD    
2149: 0000:    CCUOD.DESTINATION$,      \  1 byte UPD    1 = Business Centre, 
2150: 0000:                 \            2 = MTS,
2151: 0000:                 \        3 = Pharmacy, 
2152: 0000:                 \        4 = Other.
2153: 0000:    CCUOD.WAREHOUSE.ROUTE$,  \  1 byte ASC   "R" = RDC, "C" = CSR.
2154: 0000:    CCUOD.UOD.TYPE$,     \  1 byte UPD    1 = Travel Outer,
2155: 0000:                 \        2 = Town tray,
2156: 0000:                 \        3 = Roll cage,
2157: 0000:                 \                4 = Other.
2158: 0000:    CCUOD.DAMAGE.REASON$,         \  1 byte UPD    1 = Bad packaging,    
2159: 0000:                 \        2 = Poor handling.
2160: 0000:    CCUOD.DATE.UOD.OPENED$,  \  3 byte UPD 
2161: 0000:    CCUOD.DATE.UOD.DESPATCHED$,  \  3 byte UPD
2162: 0000:    CCUOD.TIME.UOD.DESPATCHED$,  \  3 byte UPD
2163: 0000:    CCUOD.RETRIEVAL.FLAG$, \  1 byte ASC;  " " = to be retrieved             !BMW
2164: 0000:                           \               "N" = marked as processed         !BMW
2165: 0000:    CCUOD.FILLER$,       \ 19 byte ASC;   Spaces.
2166: 0000:                 \
2167: 0000:                 \
2168: 0000:                 \
2169: 0000:    CCUOD.HEADER$,       \   Hdr rec layout; (key of High values)
2170: 0000:    CCUOD.DATE.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2171: 0000:    CCUOD.TIME.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2172: 0000:    CCUOD.LDT.NUM$,      \  3 byte UPD (Zeros if no outstanding data
2173: 0000:                 \              to be processed by PSS35)
2174: 0000:    CCUOD.HEADER.FILLER$     ! 84 byte ASC;  Spaces.
2175: 0000: 
2176: 0000: 
2177: 0000: INTEGER*2 GLOBAL        \
2178: 0000:    CCUOD.RECL%,         \
2179: 0000:    CCUOD.REPORT.NUM%,       \
2180: 0000:    CCUOD.SESS.NUM%,     \
2181: 0000:                 \
2182: 0000:    CCUOD.NUM.OF.ITEMS%      ! 2 byte INT
2183: 0000: 
2184: 0000:  %INCLUDE CCLAMDEC.J86                    ! 1.4
2185: 0000: 
2186: 0000: \*****************************************************************************
2187: 0000: \*****************************************************************************
2188: 0000: \***
2189: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2190: 0000: \***
2191: 0000: \***                   FILE TYPE:  KEYED
2192: 0000: \***
2193: 0000: \***                   REFERENCE:  CCLAMDEC.J86
2194: 0000: \***
2195: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2196: 0000: \***				   FILE OF CURRENT CREDIT CLAIMS
2197: 0000: \***
2198: 0000: \***
2199: 0000: \***      VERSION A : Michael J. Kelsall      16th December 1993
2200: 0000: \***      
2201: 0000: \*****************************************************************************
2202: 0000: \*****************************************************************************
2203: 0000: 
2204: 0000: STRING GLOBAL			\
2205: 0000:    CCLAM.FILE.NAME$,		\
2206: 0000:    CCLAM.CREDIT.CLAIM.NUM$,	\  4 byte UPD;   Record Key
2207: 0000:    CCLAM.UOD.NUM$,		\  7 byte UPD
2208: 0000:    				\  CCLAM.NUM.OF.ITEMS% here (I2)
2209: 0000:    CCLAM.SUPPLY.ROUTE$,		\  1 byte ASC;  "W" = Warehouse,
2210: 0000:    				\ 	        "E" = EPSOM,
2211: 0000: 				\	        "O" = Other Directs,
2212: 0000: 				\               "D" = Dispensary.
2213: 0000:    CCLAM.DISP.LOCATION$,	\  1 byte ASC   "M" = MDS, "D" = Dispensary.
2214: 0000:    CCLAM.BC.LETTER$,		\  1 byte ASC    
2215: 0000:    CCLAM.RECALL.NUM$,		\  8 byte ASC
2216: 0000:    CCLAM.AUTHORISATION$,	\ 15 byte ASC
2217: 0000:    CCLAM.SUPPLIER$,		\ 15 byte ASC
2218: 0000:    CCLAM.METHOD.OF.RETURN$,	\  1 byte UPD;   1 = Carrier,
2219: 0000:    				\                2 = BIRD,
2220: 0000: 				\	 	 3 = Via D6,
2221: 0000: 				\		 4 = Representative.
2222: 0000:    CCLAM.CARRIER$,		\  1 byte UPD;   1 = GPO,
2223: 0000:    				\                2 = Parcelforce,
2224: 0000: 				\	 	 3 = Securicor,
2225: 0000: 				\ 		 4 = Other.
2226: 0000:    CCLAM.BIRD.NUM$,		\  8 byte ASC					
2227: 0000:    CCLAM.REASON.NUM$,		\  1 byte UPD     (See CSRNS declaration)
2228: 0000:    CCLAM.RECEIVING.STORE$,	\  2 byte UPD    
2229: 0000:    CCLAM.DESTINATION$,		\  1 byte UPD    1 = Business Centre, 
2230: 0000:    				\	         2 = MTS,
2231: 0000:    				\		 3 = Pharmacy, 
2232: 0000: 				\		 4 = Other.
2233: 0000:    CCLAM.WAREHOUSE.ROUTE$,	\  1 byte ASC   "R" = RDC, "C" = CSR.
2234: 0000:    CCLAM.UOD.TYPE$,		\  1 byte UPD    1 = Travel Outer,
2235: 0000:    				\		 2 = Town tray,
2236: 0000: 				\		 3 = Roll cage,
2237: 0000: 				\     	         4 = Other.
2238: 0000:    CCLAM.DAMAGE.REASON$,        \  1 byte UPD    1 = Bad packaging,	
2239: 0000:    				\		 2 = Poor handling.
2240: 0000:    CCLAM.INVOICE.NUM$,		\* 9 byte ASC 
2241: 0000:    CCLAM.FOLIO.NUM$,		\  3 byte UPD
2242: 0000:    CCLAM.BATCH.REF$,		\  3 byte UPD
2243: 0000:    CCLAM.WHOLE.PART.CON$,       \  1 byte ASC   "W" = Whole, "P" = Part
2244: 0000:    CCLAM.REPAIR.CATEGORY$, 	\  1 byte UPD;   1 = Plan4,
2245: 0000:    				\   		 2 = Estimate,
2246: 0000: 				\		 3 = Boots guarantee,
2247: 0000: 				\		 4 = Supplier guarantee,
2248: 0000: 				\		 5 = Other guarantee,
2249: 0000:    CCLAM.REPAIR.NUM$,		\  6 byte UPD
2250: 0000:    CCLAM.PLAN4.POLICY.NUM$,	\  6 byte UPD 
2251: 0000:    CCLAM.DDDA.DCDR.NUM$,	\  4 byte UPD
2252: 0000:    CCLAM.DELIV.NOTE.NUM$,	\* 9 byte ASC
2253: 0000:    CCLAM.DELIV.DATE$,		\  3 byte UPD
2254: 0000:    CCLAM.NUM.CARTONS.RECEIV$,	\  1 byte UPD
2255: 0000:    CCLAM.ORDER.NUM$,		\  7 byte ASC
2256: 0000:    CCLAM.COMMENT$,  		\*20 byte ASC
2257: 0000:    CCLAM.DATE.OF.CLAIM$,	\  3 byte UPD;  Date of UOD despatch
2258: 0000:    CCLAM.TIME.OF.CLAIM$,	\  3 byte UPD;  Time of UOD despatch
2259: 0000:    CCLAM.RETRIEVAL.FLAG$,	\  1 byte ASC;  "Y", "N"  PSS35 sets to Y
2260: 0000:    				\                         PSB30 sets to N
2261: 0000:    CCLAM.CF.RPT.MARKER$,	\  1 byte ASC;  "Y"       PSS35 sets to Y
2262: 0000:    				\               "N"       PSS20 sets to N
2263: 0000:    CCLAM.CANC.MARKER$,		\  1 byte ASC;  Y or N
2264: 0000:    CCLAM.FILLER$		!  7 byte ASC;  Spaces.
2265: 0000: 
2266: 0000: 
2267: 0000: INTEGER*2 GLOBAL		\
2268: 0000:    CCLAM.RECL%,			\
2269: 0000:    CCLAM.REPORT.NUM%,		\
2270: 0000:    CCLAM.SESS.NUM%,		\
2271: 0000: 				\
2272: 0000:    CCLAM.NUM.OF.ITEMS%		!  2 byte INT
2273: 0000: 
2274: 0000:  %INCLUDE CCITMDEC.J86                    ! GMJK
2275: 0000: 
2276: 0000: \*****************************************************************************
2277: 0000: \*****************************************************************************
2278: 0000: \***
2279: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2280: 0000: \***
2281: 0000: \***                   FILE TYPE:  KEYED
2282: 0000: \***
2283: 0000: \***                   REFERENCE:  CCUODITM.J86
2284: 0000: \***
2285: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2286: 0000: \***				   FILE OF ITEMS PER OPEN/CLOSED UOD
2287: 0000: \***
2288: 0000: \***
2289: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
2290: 0000: \***      
2291: 0000: \*****************************************************************************
2292: 0000: \*****************************************************************************
2293: 0000: 
2294: 0000: STRING GLOBAL			\
2295: 0000:    CCITM.FILE.NAME$,		\
2296: 0000:    CCITM.KEY$,			\  Consists of next two fields;
2297: 0000:    CCITM.UOD.NUM$,		\  7 byte UPD
2298: 0000:    CCITM.ITEM.NUM$,		\  2 byte UPD
2299: 0000:    				\
2300: 0000:    CCITM.BOOTS.BAR.CODE.FLAG$,	\  1 byte ASC;  "I" = Boots code,
2301: 0000:    				\		"B" = Bar code.
2302: 0000:    CCITM.BOOTS.BAR.CODE$,	\  7 byte UPD
2303: 0000:    				\  CCITM.QTY% here (I2)
2304: 0000:    CCITM.FILLER$                !  4 byte ASC;  Spaces
2305: 0000:       				
2306: 0000: 
2307: 0000: INTEGER*2 GLOBAL		\
2308: 0000:    CCITM.RECL%,			\
2309: 0000:    CCITM.REPORT.NUM%,		\
2310: 0000:    CCITM.SESS.NUM%,		\
2311: 0000: 				\
2312: 0000:    CCITM.QTY%			!  2 byte INT
2313: 0000: 
2314: 0000:  %INCLUDE CCTRLDEC.J86                    ! GMJK
2315: 0000: 
2316: 0000: \*****************************************************************************
2317: 0000: \*****************************************************************************
2318: 0000: \***
2319: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2320: 0000: \***
2321: 0000: \***                   FILE TYPE:  DIRECT
2322: 0000: \***
2323: 0000: \***                   REFERENCE:  CCTRLDEC.J86
2324: 0000: \***
2325: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2326: 0000: \***				   CREDIT CLAIMS CONTROL FILE
2327: 0000: \***
2328: 0000: \***
2329: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
2330: 0000: \***      
2331: 0000: \*****************************************************************************
2332: 0000: \*****************************************************************************
2333: 0000: 
2334: 0000: STRING GLOBAL			\
2335: 0000:    CCTRL.FILE.NAME$,		\
2336: 0000:    CCTRL.RECORD$,		\
2337: 0000:    CCTRL.CREDIT.CLAIM.NUM$,	\  4 byte UPD
2338: 0000:    CCTRL.CREDIT.RPT.RUN.DATE$,	\  3 byte UPD
2339: 0000:    CCTRL.UOD.RPT.RUN.DATE$,	\  3 byte UPD
2340: 0000:    CCTRL.FILLER$		! 65 byte ASC;  Spaces
2341: 0000:    
2342: 0000: 
2343: 0000: INTEGER*2 GLOBAL		\
2344: 0000:    CCTRL.RECL%,			\
2345: 0000:    CCTRL.REPORT.NUM%,		\
2346: 0000:    CCTRL.SESS.NUM%,		\
2347: 0000:    CCTRL.REC.NUM%
2348: 0000: 
2349: 0000: INTEGER*4 GLOBAL		\
2350: 0000:    CCTRL.STAFF.SALES%		!  4 INT, total sales to store staff,
2351: 0000:    				!  stored as 5 byte UPD on file
2352: 0000: 
2353: 0000:  %INCLUDE CCTMPDEC.J86                    ! GMJK
2354: 0000: REM \
2355: 0000: \******************************************************************************
2356: 0000: \******************************************************************************
2357: 0000: \***
2358: 0000: \***      %INCLUDE FOR CREDIT CLAIMING TEMPORARY FILE FIELD DECLARATIONS
2359: 0000: \***                                             FILE REFERENCE PARAMETERS
2360: 0000: \***
2361: 0000: \***               FILE TYPE    : Sequential
2362: 0000: \***
2363: 0000: \***               REFERENCE    : CCTMPDEC.J86
2364: 0000: \***
2365: 0000: \***      Version A.     Michael J. Kelsall           30th September 1993.
2366: 0000: \***
2367: 0000: \***      Version 1.1    Brian Greenfield             14th May 2007
2368: 0000: \***      Added new variable CCTMP.RECALL.TYPE$ for A7C Recalls.
2369: 0000: \***
2370: 0000: \******************************************************************************
2371: 0000: \*******************************************************************************
2372: 0000: \***
2373: 0000: \***  The length of the records on this file vary depending on the record
2374: 0000: \***  transaction type, but they all comprise combinations of the fields
2375: 0000: \***  defined below.
2376: 0000: \***
2377: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
2378: 0000: \***
2379: 0000: \***  Transaction type 24 - Whole or Part consignment record
2380: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
2381: 0000: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
2382: 0000: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
2383: 0000: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
2384: 0000: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
2385: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
2386: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
2387: 0000: \***
2388: 0000: \***  Transaction type 26 - Data from LDT
2389: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
2390: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
2391: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
2392: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
2393: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
2394: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
2395: 0000: \***     DESPATCHED, RECALL.TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.1BG
2396: 0000: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
2397: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
2398: 0000: \***
2399: 0000: \***  Transaction type 28 - Cancelled Credit Claim
2400: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
2401: 0000: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
2402: 0000: \***
2403: 0000: \******************************************************************************
2404: 0000: 
2405: 0000:   STRING GLOBAL              \
2406: 0000:     CCTMP.FILE.NAME$,        \
2407: 0000:     CCTMP.RECORD$,           \ Used to store the whole record which is unstrung
2408: 0000:                              \ into the fields below
2409: 0000:     CCTMP.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2410: 0000:     CCTMP.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
2411: 0000:                  \             25 = NS16 / Misc cont txn (R/ACC)
2412: 0000:                  \             26 = Data from LDT (R/ACC)
2413: 0000:                  \             27 = End of LDT session (R/ACC)
2414: 0000:                  \         28 = Canc. Credit Claim (R/ACC)
2415: 0000:     CCTMP.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2416: 0000:     CCTMP.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0AH
2417: 0000:     CCTMP.BC.LETTER$,        \ 1 byte ASCII
2418: 0000:     CCTMP.CREDIT.CLAIM.NUM$, \ 4 byte UPD
2419: 0000:     CCTMP.NUM.ITEMS.UPDATED$,\ 4 byte ASCII
2420: 0000:     CCTMP.TOTAL.QTY.IN.UOD$, \ 4 byte ASCII
2421: 0000:     CCTMP.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
2422: 0000:                      \          "E" = Excess,
2423: 0000:                  \              "R" = Repairs
2424: 0000:     CCTMP.SUPPLIER.NUM$,     \ 3 byte UPD
2425: 0000:     CCTMP.INVOICE.NUM$,      \ 3 byte UPD 
2426: 0000:     CCTMP.FOLIO.NUM$,        \ 3 byte UPD
2427: 0000:     CCTMP.BATCH.REF$,        \ 3 byte UPD
2428: 0000:     CCTMP.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
2429: 0000:                  \           2 = Estimate,
2430: 0000:                  \           3 = Boots guarantee,
2431: 0000:                  \           4 = Supplier guarantee,
2432: 0000:                  \           5 = Other guarantee,
2433: 0000:     CCTMP.REPAIR.NUM$,       \ 4 byte UPD
2434: 0000:     CCTMP.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
2435: 0000:     CCTMP.DDDA.DCDR.NUM$,    \ 3 byte UPD
2436: 0000:     CCTMP.DELIV.NOTE.NUM$,   \ 3 byte UPD
2437: 0000:     CCTMP.NUM.CARTONS.RECEIV$,\1 byte UPD
2438: 0000:     CCTMP.ORDER.NUM$,        \ 3 byte UPD
2439: 0000:     CCTMP.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
2440: 0000:                  \              "B" = Barcode.
2441: 0000:     CCTMP.ITEM.BARCODE$,     \ 7 byte UPD
2442: 0000:     CCTMP.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
2443: 0000:     CCTMP.AUTHORISATION$,    \ 15 byte ASC
2444: 0000:     CCTMP.ADJ.STOCK.FIGURE$, \ 1 byte ASC  "Y" or "N"
2445: 0000:     CCTMP.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
2446: 0000:     CCTMP.UOD.NUM$,      \ 7 byte UPD
2447: 0000:     CCTMP.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
2448: 0000:                      \              "C" = Closed,
2449: 0000:                  \              "D" = Despatched
2450: 0000:     CCTMP.PREVIOUS.STATUS$,  \ 1 byte ASC   "O" = Open,
2451: 0000:                      \              "C" = Closed
2452: 0000:     CCTMP.SUPPLY.ROUTE$,     \ 1 byte ASC
2453: 0000:     CCTMP.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
2454: 0000:                      \              "D" = Dispensary
2455: 0000:     CCTMP.RECALL.NUM$,       \ 9 byte ASC 
2456: 0000:     CCTMP.SUPPLIER$,         \ 15 byte ASC
2457: 0000:     CCTMP.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
2458: 0000:                      \           2 = BIRD,
2459: 0000:                  \               3 = Via D6,
2460: 0000:                  \               4 = Representative
2461: 0000:     CCTMP.CARRIER$,      \ 1 byte UPD;   1 = GPO,
2462: 0000:                      \               2 = Parcelforce,
2463: 0000:                  \               3 = Securicor,
2464: 0000:                  \               4 = Other
2465: 0000:     CCTMP.BIRD.NUM$,         \ 8 byte ASC
2466: 0000:     CCTMP.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
2467: 0000:                      \          "C" = CSR
2468: 0000:     CCTMP.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
2469: 0000:                      \               2 = Town Tray,
2470: 0000:                  \               3 = Roll cage,
2471: 0000:                  \               4 = Other
2472: 0000:     CCTMP.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
2473: 0000:                      \               2 = Poor handling
2474: 0000:     CCTMP.RECEIVING.STORE$,  \ 2 byte UPD
2475: 0000:     CCTMP.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
2476: 0000:                      \               2 = MTS,
2477: 0000:                  \               3 = Other
2478: 0000:     CCTMP.DATE.UOD.OPENED$,  \ 3 byte UPD
2479: 0000:     CCTMP.DATE.DESPATCHED$,  \ 3 byte UPD
2480: 0000:     CCTMP.TIME.DESPATCHED$,  \ 3 byte UPD
2481: 0000:     CCTMP.ITEM.UPDATED$,     \ 1 byte ASC
2482: 0000:     CCTMP.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
2483: 0000:                      \          "D" = Despatched,
2484: 0000:                  \          "X" = Cancelled
2485: 0000:     CCTMP.ITEM.QTY$,         \ 3 byte ASCII              
2486: 0000:     CCTMP.RECALL.TYPE$       ! 1 byte ASCII "B" = Batch Recall              ! 1.1BG
2487: 0000:                              !              "N" = Non-batch Recall          ! 1.1BG
2488: 0000:                              !              " " = Old Credit Claim          ! 1.1BG
2489: 0000:     
2490: 0000:                                                  
2491: 0000:   INTEGER*2 GLOBAL           \
2492: 0000:     CCTMP.SESS.NUM%,         \
2493: 0000:     CCTMP.REPORT.NUM%,       \
2494: 0000:                      \
2495: 0000:     CCTMP.NUM.OF.ITEMS%,     \
2496: 0000:     CCTMP.NUM.ITEMS.UPDATED%,\ 
2497: 0000:     CCTMP.TOTAL.QTY.IN.UOD%  !
2498: 0000:                          
2499: 0000:                  
2500: 0000:  %INCLUDE CCBUFDEC.J86                    ! GMJK
2501: 0000: REM \
2502: 0000: \******************************************************************************
2503: 0000: \******************************************************************************
2504: 0000: \***
2505: 0000: \***      %INCLUDE FOR CREDIT CLAIMING BUFFER FILE FIELD DECLARATIONS
2506: 0000: \***                                          FILE REFERENCE PARAMETERS
2507: 0000: \***
2508: 0000: \***               FILE TYPE    : Sequential
2509: 0000: \***
2510: 0000: \***               REFERENCE    : CCBUFDEC.J86
2511: 0000: \***
2512: 0000: \***      Version A.     Michael J. Kelsall           30th September 1993.
2513: 0000: \***
2514: 0000: \******************************************************************************
2515: 0000: \*******************************************************************************
2516: 0000: \***
2517: 0000: \***  The length of the records on this file vary depending on the record
2518: 0000: \***  transaction type, but they all comprise combinations of the fields
2519: 0000: \***  defined below.
2520: 0000: \***
2521: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
2522: 0000: \***
2523: 0000: \***  Transaction type 24 - Whole or Part consignment record
2524: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
2525: 0000: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
2526: 0000: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
2527: 0000: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
2528: 0000: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
2529: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
2530: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
2531: 0000: \***
2532: 0000: \***  Transaction type 26 - Data from LDT
2533: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
2534: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
2535: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
2536: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
2537: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
2538: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
2539: 0000: \***     DESPATCHED, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY, ITEM UPDATED 
2540: 0000: \***     FLAG, RECORD DELIMITER, END OF RECORD MARKER
2541: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
2542: 0000: \***
2543: 0000: \***  Transaction type 28 - Cancelled Credit Claim
2544: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
2545: 0000: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
2546: 0000: \***
2547: 0000: \******************************************************************************
2548: 0000: 
2549: 0000:   STRING GLOBAL              \
2550: 0000:     CCBUF.FILE.NAME$,        \
2551: 0000:     CCBUF.RECORD$,           \ Used to store the whole record which is unstrung
2552: 0000:                              \ into the fields below
2553: 0000:     CCBUF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2554: 0000:     CCBUF.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
2555: 0000: 			     \             25 = NS16 / Misc cont txn (R/ACC)
2556: 0000: 			     \	           26 = Data from LDT (R/ACC)
2557: 0000: 			     \             27 = End of LDT session (R/ACC)
2558: 0000: 			     \		   28 = Canc. Credit Claim (R/ACC)
2559: 0000:     CCBUF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2560: 0000:     CCBUF.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
2561: 0000:     CCBUF.BC.LETTER$,        \ 1 byte ASCII
2562: 0000:     CCBUF.CREDIT.CLAIM.NUM$, \ 4 byte UPD
2563: 0000:     CCBUF.CLAIM.TYPE$,	     \ 1 byte ASC;  "M" = Missing,
2564: 0000:     			     \		    "E" = Excess,
2565: 0000: 			     \              "R" = Repairs
2566: 0000:     CCBUF.SUPPLIER.NUM$,     \ 3 byte UPD
2567: 0000:     CCBUF.INVOICE.NUM$,	     \ 3 byte UPD 
2568: 0000:     CCBUF.FOLIO.NUM$,	     \ 3 byte UPD
2569: 0000:     CCBUF.BATCH.REF$,	     \ 3 byte UPD
2570: 0000:     CCBUF.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
2571: 0000:    			     \ 		     2 = Estimate,
2572: 0000: 			     \		     3 = Boots guarantee,
2573: 0000: 			     \		     4 = Supplier guarantee,
2574: 0000: 			     \		     5 = Other guarantee,
2575: 0000:     CCBUF.REPAIR.NUM$,       \ 4 byte UPD
2576: 0000:     CCBUF.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
2577: 0000:     CCBUF.DDDA.DCDR.NUM$,    \ 3 byte UPD
2578: 0000:     CCBUF.DELIV.NOTE.NUM$,   \ 3 byte UPD
2579: 0000:     CCBUF.NUM.CARTONS.RECEIV$,\1 byte UPD
2580: 0000:     CCBUF.ORDER.NUM$,	     \ 3 byte UPD
2581: 0000:     CCBUF.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
2582: 0000:   			     \              "B" = Barcode.
2583: 0000:     CCBUF.ITEM.BARCODE$,     \ 7 byte UPD
2584: 0000:     CCBUF.ITEM.PRICE$,	     \ 3 byte UPD;  Spaces.
2585: 0000:     CCBUF.AUTHORISATION$,    \ 15 byte ASC
2586: 0000:     CCBUF.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
2587: 0000:     CCBUF.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
2588: 0000:     CCBUF.UOD.NUM$,	     \ 7 byte UPD
2589: 0000:     CCBUF.UOD.STATUS$,	     \ 1 byte ASC;  "O" = Open,
2590: 0000:     			     \              "C" = Closed,
2591: 0000: 			     \              "D" = Despatched
2592: 0000:     CCBUF.SUPPLY.ROUTE$,     \ 1 byte ASC
2593: 0000:     CCBUF.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
2594: 0000:     			     \              "D" = Dispensary
2595: 0000:     CCBUF.RECALL.NUM$,       \ 9 byte ASC 
2596: 0000:     CCBUF.SUPPLIER$,	     \ 15 byte ASC
2597: 0000:     CCBUF.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
2598: 0000:     			     \		     2 = BIRD,
2599: 0000: 			     \               3 = Via D6,
2600: 0000: 			     \               4 = Representative
2601: 0000:     CCBUF.CARRIER$,	     \ 1 byte UPD;   1 = GPO,
2602: 0000:     			     \               2 = Parcelforce,
2603: 0000: 			     \               3 = Securicor,
2604: 0000: 			     \               4 = Other
2605: 0000:     CCBUF.BIRD.NUM$,	     \ 8 byte ASC
2606: 0000:     CCBUF.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
2607: 0000:     			     \  	    "C" = CSR
2608: 0000:     CCBUF.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
2609: 0000:     			     \               2 = Town Tray,
2610: 0000: 			     \               3 = Roll cage,
2611: 0000: 			     \               4 = Other
2612: 0000:     CCBUF.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
2613: 0000:      			     \               2 = Poor handling
2614: 0000:     CCBUF.RECEIVING.STORE$,  \ 2 byte UPD
2615: 0000:     CCBUF.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
2616: 0000:     			     \               2 = MTS,
2617: 0000: 			     \               3 = Other
2618: 0000:     CCBUF.DATE.UOD.OPENED$,  \ 3 byte UPD
2619: 0000:     CCBUF.DATE.DESPATCHED$,  \ 3 byte UPD
2620: 0000:     CCBUF.TIME.DESPATCHED$,  \ 3 byte UPD
2621: 0000:     CCBUF.ITEM.UPDATED$,     \ 1 byte ASC
2622: 0000:     CCBUF.NEW.STATUS.FLAG$   \ 1 byte ASC   "C" = Closed,
2623: 0000:     			     \   	    "D" = Despatched,
2624: 0000: 			     !    	    "X" = Cancelled
2625: 0000:     
2626: 0000: 			     			     			     
2627: 0000:   INTEGER*2 GLOBAL           \
2628: 0000:     CCBUF.SESS.NUM%,         \
2629: 0000:     CCBUF.REPORT.NUM%,	     \
2630: 0000:     			     \
2631: 0000:     CCBUF.NUM.OF.ITEMS%,     \
2632: 0000:     CCBUF.NUM.ITEMS.UPDATED%,\
2633: 0000:     CCBUF.QTY%,		     \
2634: 0000:     CCBUF.TOTAL.QTY.IN.UOD%  !
2635: 0000:         			     
2636: 0000: 			     
2637: 0000:  %INCLUDE CCUPFDEC.J86                    ! HMJK
2638: 0000: 
2639: 0000: \*****************************************************************************
2640: 0000: \*****************************************************************************
2641: 0000: \***
2642: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2643: 0000: \***
2644: 0000: \***                   FILE TYPE:  KEYED
2645: 0000: \***
2646: 0000: \***                   REFERENCE:  CCUPFDEC.J86
2647: 0000: \***
2648: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2649: 0000: \***				   UOD PROCESSED FILE
2650: 0000: \***
2651: 0000: \***
2652: 0000: \***      VERSION A : Michael J. Kelsall      14th March 1994
2653: 0000: \***      
2654: 0000: \*****************************************************************************
2655: 0000: \*****************************************************************************
2656: 0000: 
2657: 0000: STRING GLOBAL			\
2658: 0000:    CCUPF.FILE.NAME$,		\
2659: 0000:    CCUPF.UOD.NUM$,		\  7 byte UPD
2660: 0000:    CCUPF.CURRENT.STATUS$	!  1 byte ASC;  "C" = Closed,
2661: 0000:    				!               "D" - Despatched,
2662: 0000:    				!               "X" - Cancelled.
2663: 0000:       				
2664: 0000: 
2665: 0000: INTEGER*2 GLOBAL		\
2666: 0000:    CCUPF.RECL%,			\
2667: 0000:    CCUPF.REPORT.NUM%,		\
2668: 0000:    CCUPF.SESS.NUM%
2669: 0000: 
2670: 0000:  %INCLUDE CCWKFDEC.J86                    ! GMJK
2671: 0000: \******************************************************************************
2672: 0000: \******************************************************************************
2673: 0000: \***
2674: 0000: \***      %INCLUDE FOR RETURNS WORK FILE - FIELD DEFINITIONS
2675: 0000: \***                                       FILE REFERENCE PARAMETERS
2676: 0000: \***
2677: 0000: \***                  REFERENCE: CCWKFDEC.J86
2678: 0000: \***
2679: 0000: \***  Version A          Michael J. Kelsall              30th September 1993
2680: 0000: \***
2681: 0000: \******************************************************************************
2682: 0000: \*******************************************************************************
2683: 0000: 
2684: 0000:   STRING GLOBAL								\
2685: 0000: 	CCWKF.FILE.NAME$,						\
2686: 0000: 	CCWKF.RECORD$
2687: 0000: 
2688: 0000:   INTEGER*2 GLOBAL							\
2689: 0000: 	CCWKF.RECL%,	          					\
2690: 0000: 	CCWKF.SESS.NUM%,						\
2691: 0000: 	CCWKF.REPORT.NUM%
2692: 0000:  %INCLUDE CCDMYDEC.J86                    ! GMJK
2693: 0000: \******************************************************************************
2694: 0000: \******************************************************************************
2695: 0000: \***
2696: 0000: \***         %INCLUDE FOR RETURNS DUMMY FILE I/O SESSION NUMBER
2697: 0000: \***
2698: 0000: \***               REFERENCE    : CCDMYDEC.J86
2699: 0000: \***
2700: 0000: \***    Version A           Michael J. Kelsall          30th September 1993
2701: 0000: \***
2702: 0000: \******************************************************************************
2703: 0000: \*******************************************************************************
2704: 0000: 
2705: 0000:   STRING GLOBAL           \
2706: 0000:     CCDMY.FILE.NAME$
2707: 0000: 
2708: 0000:   INTEGER*2 GLOBAL        \
2709: 0000:     CCDMY.REPORT.NUM%,    \
2710: 0000:     CCDMY.SESS.NUM%
2711: 0000:  %INCLUDE LDTAFDEC.J86                    ! HMJK
2712: 0000: 
2713: 0000: \*****************************************************************************
2714: 0000: \*****************************************************************************
2715: 0000: \***
2716: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2717: 0000: \***
2718: 0000: \***                   FILE TYPE:  DIRECT
2719: 0000: \***
2720: 0000: \***                   REFERENCE:  LDTAFDEC.J86
2721: 0000: \***
2722: 0000: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
2723: 0000: \***
2724: 0000: \***
2725: 0000: \***      VERSION A         Michael J. Kelsall       30th September 1993
2726: 0000: \***
2727: 0000: \***      VERSION B         Michael J. Kelsall       25th March 1994
2728: 0000: \***      Conversion of LDTAF link duration from minutes to seconds, requiring
2729: 0000: \***      4 byte integer to hold times >09:06:07 (= 32767 seconds)
2730: 0000: \***      
2731: 0000: \*****************************************************************************
2732: 0000: \*****************************************************************************
2733: 0000: 
2734: 0000:   STRING GLOBAL                 \
2735: 0000:     LDTAF.FILE.NAME$,		\
2736: 0000:     LDTAF.START.DATE$,		\ 3 byte UPD  (YYMMDD)
2737: 0000:     LDTAF.START.TIME$		! 3 byte UPD  (HHMMSS)
2738: 0000:     
2739: 0000: 
2740: 0000:   INTEGER*1 GLOBAL              \
2741: 0000:     LDTAF.LINK.TYPE%		!  1 - CSR file    (CSRWF size / num of UNITS)
2742: 0000: 				!  2 - PCHECK      (CHKBF size / null)
2743: 0000: 				!  3 - LDT PROG    (LDTPF size / null)
2744: 0000: 				!  4 - DIRECTS     (DRSMQ size / DIRWF size)
2745: 0000: 				!  5 - UOD         (UODTF size / null)
2746: 0000: 				!  6 - EPSOM req   (PDTWF size / null)
2747: 0000: 				!  7 - EPSOM lists (num of lists / null)
2748: 0000: 				!  8 - RETURNS UOD (CCTMP size / CCBUF size)
2749: 0000: 				!  9 - RETURNS req (CCWKF size / null)
2750: 0000: 				!  MSB ---> 0 = Port A , 1 = Port B. 
2751: 0000: 
2752: 0000:   INTEGER*2 GLOBAL              \
2753: 0000:     LDTAF.SESS.NUM%,            \
2754: 0000:     LDTAF.REPORT.NUM%,		\
2755: 0000:     LDTAF.RECL%
2756: 0000:     				
2757: 0000: 
2758: 0000:   INTEGER*4 GLOBAL              \
2759: 0000:     LDTAF.DATA.VOLUME.1%,	\
2760: 0000:     LDTAF.DATA.VOLUME.2%,	\
2761: 0000:     LDTAF.DURATION%    		! BMJK
2762: 0000:  %INCLUDE SOFTSDEC.J86                    ! GMJK
2763: 0000: REM \
2764: 0000: \******************************************************************************
2765: 0000: \******************************************************************************
2766: 0000: \***
2767: 0000: \***                 %INCLUDE FOR THE SOFTWARE STATUS FILE
2768: 0000: \***   
2769: 0000: \***                      FILE TYPE  :   Direct
2770: 0000: \***
2771: 0000: \***                      REFERENCE  :   SOFTSDEC.J86
2772: 0000: \***
2773: 0000: \***	Version A	       Andrew Wedgeworth	      24th June 1992
2774: 0000: \***
2775: 0000: \******************************************************************************
2776: 0000: \*******************************************************************************
2777: 0000: 
2778: 0000:   STRING GLOBAL           \
2779: 0000:     SOFTS.RECORD$,        \           
2780: 0000:     SOFTS.SPACE$,         \           
2781: 0000:     SOFTS.FILE.NAME$    
2782: 0000:     
2783: 0000:   INTEGER*2 GLOBAL        \
2784: 0000:     SOFTS.RECL%,          \            
2785: 0000:     SOFTS.REPORT.NUM%,	  \      
2786: 0000:     SOFTS.SESS.NUM%
2787: 0000: 
2788: 0000:   INTEGER*4 GLOBAL        \
2789: 0000:     SOFTS.REC.NUM% 	         
2790: 0000:  %INCLUDE STKBFDEC.J86                    ! 1.5
2791: 0000: \******************************************************************************
2792: 0000: \******************************************************************************
2793: 0000: \***
2794: 0000: \***   $Workfile:   STKBFDEC.J86  $
2795: 0000: \***
2796: 0000: \***   $Revision:   1.0  $
2797: 0000: \***
2798: 0000: \******************************************************************************
2799: 0000: \******************************************************************************
2800: 0000: \***
2801: 0000: \***   $Log:   V:\archive\j86\stkbfdec.j8v  $
2802: 0000: \***   
2803: 0000: \***      Rev 1.0   15 Jul 1997 14:20:36   DEV45PS
2804: 0000: \***    
2805: 0000: \***   
2806: 0000: \***      Rev 1.0   09 Jul 1997 11:04:52   DEV45PS
2807: 0000: \***   Stocktake System New Files
2808: 0000: \***   
2809: 0000: \******************************************************************************
2810: 0000: \******************************************************************************\******************************************************************************
2811: 0000: \******************************************************************************
2812: 0000: \***
2813: 0000: \***         %INCLUDE FOR STOCKTAKE BUFFER FILE FIELD DECLARATIONS
2814: 0000: \***
2815: 0000: \***               FILE TYPE    : DIRECT
2816: 0000: \***
2817: 0000: \***               REFERENCE    : STKBFDEC.J86
2818: 0000: \***
2819: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
2820: 0000: \***    New file for stocktaking system. Holds counts read from PDT.
2821: 0000: \***
2822: 0000: \*******************************************************************************
2823: 0000: \*******************************************************************************
2824: 0000: 
2825: 0000: STRING GLOBAL                                                  \
2826: 0000:    STKBF.FILE.NAME$,           \
2827: 0000:    STKBF.DATA$,                \
2828: 0000:    STKBF.STORE.NUMBER$,        \
2829: 0000:    STKBF.STOCKTAKER.NO$,       \
2830: 0000:    STKBF.DATE$,                \
2831: 0000:    STKBF.LOCATION$,            \
2832: 0000:    STKBF.ITEM.CODE$,           \
2833: 0000:    STKBF.QUANTITY$,            \
2834: 0000:    STKBF.PRICE$,               \
2835: 0000:    STKBF.RECORD.COUNT$,        \
2836: 0000:    STKBF.FILLER$
2837: 0000: 
2838: 0000: 
2839: 0000: INTEGER*4 GLOBAL               \
2840: 0000:    STKBF.RECORD.NUM%
2841: 0000: 
2842: 0000: INTEGER*2 GLOBAL                \
2843: 0000:    STKBF.REPORT.NUM%,           \
2844: 0000:    STKBF.SESS.NUM%             
2845: 0000: 
2846: 0000: 
2847: 0000: INTEGER*1 GLOBAL                \
2848: 0000:    STKBF.RECL%         
2849: 0000: 
2850: 0000: 
2851: 0000:  %INCLUDE SXTMPDEC.J86                    ! 1.5
2852: 0000: \******************************************************************************
2853: 0000: \******************************************************************************
2854: 0000: \***
2855: 0000: \***         %INCLUDE FOR TEMPORARY STOCKTAKE BUFFER FILE FIELD DECLARATIONS
2856: 0000: \***
2857: 0000: \***               FILE TYPE    : DIRECT
2858: 0000: \***
2859: 0000: \***               REFERENCE    : SXTMPDEC.J86
2860: 0000: \***
2861: 0000: \***    VERSION A.              Nik Sen.               30 Jun 1997.
2862: 0000: \***    New file for stocktaking system. Holds counts read from PDT.
2863: 0000: \***
2864: 0000: \***    VERSION B              Nik Sen                 23 September 1997
2865: 0000: \***    Removed record count as file converted from direct to sequential.
2866: 0000: \***
2867: 0000: \*******************************************************************************
2868: 0000: \*******************************************************************************
2869: 0000: 
2870: 0000: STRING GLOBAL                                                  \
2871: 0000:    SXTMP.FILE.NAME$,           \
2872: 0000:    SXTMP.DATA$,                \
2873: 0000:    SXTMP.STORE.NUMBER$,        \
2874: 0000:    SXTMP.STOCKTAKER.NO$,       \
2875: 0000:    SXTMP.DATE$,                \
2876: 0000:    SXTMP.LOCATION$,            \
2877: 0000:    SXTMP.ITEM.CODE$,           \
2878: 0000:    SXTMP.QUANTITY$,            \
2879: 0000:    SXTMP.PRICE$,               \
2880: 0000:    SXTMP.RECORD.COUNT$,        \
2881: 0000:    SXTMP.FILLER$
2882: 0000: 
2883: 0000: 
2884: 0000: INTEGER*2 GLOBAL                \
2885: 0000:    SXTMP.REPORT.NUM%,           \
2886: 0000:    SXTMP.SESS.NUM%             
2887: 0000: 
2888: 0000: 
2889: 0000: INTEGER*1 GLOBAL                \
2890: 0000:    SXTMP.RECL%         
2891: 0000: 
2892: 0000: 
2893: 0000:  %INCLUDE STKTKDEC.J86                    ! 1.5
2894: 0000: REM \
2895: 0000: \******************************************************************************
2896: 0000: \******************************************************************************
2897: 0000: \***
2898: 0000: \***         %INCLUDE FOR STOCKTAKE DUMMY FILE - FILE REFERENCE PARAMETERS
2899: 0000: \***
2900: 0000: \***               REFERENCE    : STKTKDEC.J86
2901: 0000: \***
2902: 0000: \******************************************************************************
2903: 0000: \*******************************************************************************
2904: 0000: 
2905: 0000:   STRING GLOBAL           \
2906: 0000:     STKTK.FILE.NAME$
2907: 0000: 
2908: 0000:   INTEGER*2 GLOBAL        \
2909: 0000:     STKTK.REPORT.NUM%,      \
2910: 0000:     STKTK.SESS.NUM%
2911: 0000:  %INCLUDE STLDTDEC.J86                    ! 1.6
2912: 0000: REM \
2913: 0000: \******************************************************************************
2914: 0000: \******************************************************************************
2915: 0000: \***
2916: 0000: \***            %INCLUDE FOR STLDT FILE VARIABLES
2917: 0000: \***
2918: 0000: \***                 FILE TYPE    : Direct
2919: 0000: \***
2920: 0000: \***                 REFERENCE    : STLDTDEC.J86
2921: 0000: \***
2922: 0000: \***       Version B          David Artiss      03/09/2002
2923: 0000: \***       Increase field from 2 to 2 bytes
2924: 0000: \***
2925: 0000: \******************************************************************************
2926: 0000: \*******************************************************************************
2927: 0000: 
2928: 0000:   STRING GLOBAL           \
2929: 0000:     STLDT.FILE.NAME$,     \
2930: 0000:     STLDT.RECORD$,        \ 25 bytes
2931: 0000:     STLDT.STORE$,         \ 4 bytes
2932: 0000:     STLDT.STOCKTAKER$,    \ 4 bytes
2933: 0000:     STLDT.LDT.SERIAL$,    \ 6 bytes
2934: 0000:     STLDT.DATE$,          \ 6 bytes DDMMYY
2935: 0000:     STLDT.TIME$,          \ 4 bytes HHMM
2936: 0000:     STLDT.CRLF$           \
2937: 0000: 
2938: 0000:   INTEGER*2 GLOBAL        \
2939: 0000:     STLDT.RECL%,          \
2940: 0000:     STLDT.SESS.NUM%,      \
2941: 0000:     STLDT.REPORT.NUM%     ! BDA
2942: 0000:      
2943: 0000:   INTEGER*4 GLOBAL        \
2944: 0000:     STLDT.RECORD.NUM%,    \
2945: 0000:     STLDT.COUNTS%,        \ BDA
2946: 0000:     STLDT.ITEMS%
2947: 0000:       
2948: 0000:  %INCLUDE STOCKDEC.J86                    ! 1.7BG
2949: 0000: \***********************************************************************
2950: 0000: \***********************************************************************
2951: 0000: \***
2952: 0000: \***    DESCRIPTION: Stock File
2953: 0000: \***                 Field Definitions         
2954: 0000: \***
2955: 0000: \***    FILE TYPE : Keyed
2956: 0000: \***
2957: 0000: \***********************************************************************
2958: 0000: \***
2959: 0000: \***    Version B.              Robert Cowey             21st Oct 1993
2960: 0000: \***    No changes to this file.
2961: 0000: \***
2962: 0000: \***    Version C.              Mark Walker              24th Jan 2014
2963: 0000: \***    F337 Centralised View of Stock
2964: 0000: \***    - Added sequence ID and item status fields.
2965: 0000: \***    - Minor formatting changes (uncommented).
2966: 0000: \***
2967: 0000: \***    Version D.              Mark Walker              15th Mar 2014
2968: 0000: \***    F337 Centralised View of Stock
2969: 0000: \***    Added next sequence ID field.
2970: 0000: \***
2971: 0000: \***    Version E.              Mark Walker               7th May 2014
2972: 0000: \***    F337 Centralised View of Stock
2973: 0000: \***    Added new 'stock flags' field for future use.
2974: 0000: \***
2975: 0000: \***********************************************************************
2976: 0000: \***********************************************************************
2977: 0000: 
2978: 0000: \***********************************************************************
2979: 0000: \***********************************************************************
2980: 0000: \***
2981: 0000: \***    File Record Layout
2982: 0000: \***
2983: 0000: \***    STOCK.BOOTS.CODE$            4 UPD  Item Code (Key)
2984: 0000: \***    STOCK.STOCK.FIG%             2 INT  Stock Figure
2985: 0000: \***    STOCK.LAST.COUNT%            2 INT  Last Count Quantity
2986: 0000: \***    STOCK.DATE.LAST.COUNT$       3 UPD  Date of Last Count
2987: 0000: \***    STOCK.DATE.LAST.MOVE$        3 UPD  Date of Last Movement
2988: 0000: \***    STOCK.LAST.REC%              2 INT  Last Receipt Quantity
2989: 0000: \***    STOCK.DATE.LAST.REC$         3 UPD  Date of Last Receipt
2990: 0000: \***    STOCK.DATE.LAST.GAP$         3 UPD  Date of Last Gap
2991: 0000: \***    STOCK.SID%                   4 INT  Sequence ID                     !CMW
2992: 0000: \***    STOCK.STATUS.1$              1 ASC  Item Status                     !CMW
2993: 0000: \***    STOCK.FLAGS%                 1 INT  Stock flags                     !EMW
2994: 0000: \***    STOCK.FILLER$                2 UPD  Filler                          !EMW
2995: 0000: \***
2996: 0000: \***********************************************************************
2997: 0000: \***********************************************************************
2998: 0000: 
2999: 0000:     INTEGER*1 GLOBAL                                                    \
3000: 0000:         STOCK.FLAGS%,                                                   \   !EMW
3001: 0000:         STOCK.RECL%
3002: 0000: 
3003: 0000:     INTEGER*2 GLOBAL                                                    \
3004: 0000:         STOCK.LAST.COUNT%,                                              \
3005: 0000:         STOCK.LAST.REC%,                                                \
3006: 0000:         STOCK.REPORT.NUM%,                                              \
3007: 0000:         STOCK.SESS.NUM%,                                                \
3008: 0000:         STOCK.STOCK.FIG%
3009: 0000: 
3010: 0000:     INTEGER*4 GLOBAL                                                    \   !CMW
3011: 0000:         STOCK.NEXT.SID%,                                                \   !DMW
3012: 0000:         STOCK.SID%                                                          !CMW
3013: 0000: 
3014: 0000:     STRING GLOBAL                                                       \
3015: 0000:         STOCK.BOOTS.CODE$,                                              \
3016: 0000:         STOCK.DATE.LAST.COUNT$,                                         \
3017: 0000:         STOCK.DATE.LAST.GAP$,                                           \
3018: 0000:         STOCK.DATE.LAST.MOVE$,                                          \
3019: 0000:         STOCK.DATE.LAST.REC$,                                           \
3020: 0000:         STOCK.FILE.NAME$,                                               \
3021: 0000:         STOCK.FILLER$,                                                  \
3022: 0000:         STOCK.STATUS.1$                                                     !CMW
3023: 0000: 
3024: 0000:  %INCLUDE IMSTCDEC.J86                    ! 1.7BG
3025: 0000: \***********************************************************************
3026: 0000: \***********************************************************************
3027: 0000: \***
3028: 0000: \***    DESCRIPTION: Item Movement & Stock File
3029: 0000: \***                 Field Definitions         
3030: 0000: \***
3031: 0000: \***    FILE TYPE : Keyed
3032: 0000: \***
3033: 0000: \***********************************************************************
3034: 0000: \***
3035: 0000: \***    Version A.          Les Cook                     21st Aug 1992
3036: 0000: \***    Initial version.
3037: 0000: \***
3038: 0000: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
3039: 0000: \***    Added new external functions for
3040: 0000: \***        MIMSTC - merged IMSTC
3041: 0000: \***        CIMSTC - Copy of IMSTC
3042: 0000: \***        BIMSTC - Backup of IMSTC
3043: 0000: \***
3044: 0000: \***    Version C.          Mark Walker                  23rd Jan 2014
3045: 0000: \***    F337 Centralised View of Stock
3046: 0000: \***    - Added sequence ID field definition.
3047: 0000: \***    - Moved BIMST, CIMST and MIMST field definitions to separate
3048: 0000: \***      modules.
3049: 0000: \***    - Moved TIMST record length to TIMSTDEC.J86.
3050: 0000: \***    - Minor formatting changes (uncommented).
3051: 0000: \***
3052: 0000: \***    Version D.          Mark Walker                  30th Apr 2014
3053: 0000: \***    F337 Centralised View of Stock
3054: 0000: \***    QC599: Introduced item level TSL restart pointer to allow
3055: 0000: \***           Sales Support restart/recovery to continue processing
3056: 0000: \***           correctly from the next unprocessed item.
3057: 0000: \***
3058: 0000: \***********************************************************************
3059: 0000: \***********************************************************************
3060: 0000: 
3061: 0000: \***********************************************************************
3062: 0000: \***********************************************************************
3063: 0000: \***
3064: 0000: \***    File Record Layout
3065: 0000: \***
3066: 0000: \***    IMSTC.BAR.CODE$             11 UPD  Barcode (Key)
3067: 0000: \***    IMSTC.RESTART%               4 INT  IMSTC Restart pointer
3068: 0000: \***    IMSTC.NUMITEMS%              4 INT  Number of items sold
3069: 0000: \***    IMSTC.AMTSALE%               4 INT  Amount of items sold
3070: 0000: \***    IMSTC.TSL.RESTART%           4 INT  TSL Restart pointer             !DMW
3071: 0000: \***    IMSTC.STKMQ.RESTART%         4 INT  STKMQ Restart pointer
3072: 0000: \***    IMSTC.STATUS.FLAG$           1 ASC  Status flags
3073: 0000: \***    IMSTC.STOCK.FIGURE%          2 INT  Stock Figure
3074: 0000: \***    IMSTC.REASON.ITEM.REMOVED$   1 ASC  Deletion Reason
3075: 0000: \***    IMSTC.SID%                   4 INT  Sequence ID
3076: 0000: \***    IMSTC.FILLER$                1 UPD  Filler
3077: 0000: \***
3078: 0000: \***********************************************************************
3079: 0000: \***********************************************************************
3080: 0000: 
3081: 0000:     INTEGER*2 GLOBAL                                                    \
3082: 0000:         IMSTC.SESS.NUM%,                                                \
3083: 0000:         IMSTC.RECL%,                                                    \
3084: 0000:         IMSTC.REPORT.NUM%,                                              \
3085: 0000:         IMSTC.STOCK.FIGURE%
3086: 0000: 
3087: 0000:     INTEGER*4 GLOBAL                                                    \
3088: 0000:         IMSTC.AMTSALE%,                                                 \
3089: 0000:         IMSTC.NEXT.SID%,                                                \   !CMW
3090: 0000:         IMSTC.NUMITEMS%,                                                \
3091: 0000:         IMSTC.RESERVED%,                                                \
3092: 0000:         IMSTC.RESTART%,                                                 \
3093: 0000:         IMSTC.SID%,                                                     \   !CMW
3094: 0000:         IMSTC.STKMQ.RESTART%,                                           \
3095: 0000:         IMSTC.TSL.RESTART%                                                  !DMW
3096: 0000: 
3097: 0000:     STRING GLOBAL                                                       \
3098: 0000:         IMSTC.BAR.CODE$,                                                \
3099: 0000:         IMSTC.FILE.NAME$,                                               \
3100: 0000:         IMSTC.FILLER$,                                                  \
3101: 0000:         IMSTC.HOLD.PENDING$,                                            \
3102: 0000:         IMSTC.REASON.ITEM.REMOVED$,                                     \
3103: 0000:         IMSTC.STATUS.FLAG$
3104: 0000: 
3105: 0000:  %INCLUDE LSSSTDEC.J86                    ! 1.7BG
3106: 0000: REM \
3107: 0000: \******************************************************************************
3108: 0000: \******************************************************************************
3109: 0000: \***
3110: 0000: \***                 %INCLUDE FOR THE LSS STOCK COUNT FILE
3111: 0000: \***   
3112: 0000: \***                      FILE TYPE  :   Direct
3113: 0000: \***
3114: 0000: \***                      REFERENCE  :   LSSSTDEC.J86
3115: 0000: \***
3116: 0000: \***    Version A          Brian Greenfield          16th October 2002
3117: 0000: \***
3118: 0000: \******************************************************************************
3119: 0000: \*******************************************************************************
3120: 0000: 
3121: 0000:   STRING GLOBAL              \ 
3122: 0000:     LSSST.FILE.NAME$,        \
3123: 0000:     LSSST.IRF.BAR.CODE$,     \
3124: 0000:     LSSST.STOCK.BOOTS.CODE$, \
3125: 0000:     LSSST.STOCK.COUNT$,      \
3126: 0000:     LSSST.TSF$
3127: 0000:         
3128: 0000:   INTEGER*2 GLOBAL        \
3129: 0000:     LSSST.RECL%,          \            
3130: 0000:     LSSST.REPORT.NUM%,    \      
3131: 0000:     LSSST.SESS.NUM%
3132: 0000: 
3133: 0000:          
3134: 0000:  %INCLUDE SXTCFDEC.J86                    ! 1.8DA
3135: 0000: \******************************************************************************
3136: 0000: \******************************************************************************
3137: 0000: \***
3138: 0000: \***   $Workfile:   SXTCFDEC.J86  $
3139: 0000: \***
3140: 0000: \***   $Revision:   1.1  $
3141: 0000: \***
3142: 0000: \******************************************************************************
3143: 0000: \******************************************************************************
3144: 0000: \***
3145: 0000: \***   $Log:   V:\archive\j86\sxtcfdec.j8v  $
3146: 0000: \***   
3147: 0000: \***      Rev 1.1   07 Jan 1998 10:26:30   DEV69PS
3148: 0000: \***    
3149: 0000: \***   
3150: 0000: \***      Rev 1.0   15 Jul 1997 14:21:06   DEV45PS
3151: 0000: \***    
3152: 0000: \***   
3153: 0000: \***      Rev 1.1   15 Jul 1997 13:44:06   DEV45PS
3154: 0000: \***    
3155: 0000: \***   
3156: 0000: \***      Rev 1.0   09 Jul 1997 11:05:28   DEV45PS
3157: 0000: \***   Stocktake System New Files
3158: 0000: \***   
3159: 0000: \*** 
3160: 0000: \***   
3161: 0000: \******************************************************************************
3162: 0000: \******************************************************************************\*****************************************************************************
3163: 0000: \*****************************************************************************
3164: 0000: \***
3165: 0000: \***               %INCLUDE FOR SXTCF - FIELD DECLARATIONS
3166: 0000: \***                                    FILE REFERENCE PARAMETERS
3167: 0000: \***
3168: 0000: \***                      FILE TYPE    : DIRECT
3169: 0000: \***
3170: 0000: \***                      REFERENCE    : SXTCFDEC
3171: 0000: \***
3172: 0000: \***           VERSION A : NIK SEN  3rd July 1997
3173: 0000: \***
3174: 0000: \***
3175: 0000: 
3176: 0000: \*****************************************************************************
3177: 0000: \*****************************************************************************
3178: 0000: 
3179: 0000: 
3180: 0000:   STRING GLOBAL           \
3181: 0000:     SXTCF.FILE.NAME$
3182: 0000: 
3183: 0000:   INTEGER*1 GLOBAL        \
3184: 0000:     SXTCF.HEADER.EXPECTED%
3185: 0000: 
3186: 0000:   INTEGER*2 GLOBAL        \
3187: 0000:     SXTCF.SESS.NUM%,      \
3188: 0000:     SXTCF.REPORT.NUM%,    \
3189: 0000:     SXTCF.RECL%
3190: 0000: 
3191: 0000:   INTEGER*4 GLOBAL        \
3192: 0000:     SXTCF.REC.NUM%
3193: 0000: 
3194: 0000: 
3195: 0000:   INTEGER*4 GLOBAL                                   \
3196: 0000:             SXTCF.STKBF.POINTER%,                    \ Pointer to STKBF
3197: 0000:             SXTCF.ITEM.COUNT%,                       \ No of items processed
3198: 0000:             SXTCF.CURRENT.COUNT%                     ! Items in current batch
3199: 0000: 
3200: 0000: 
3201: 0000:   STRING GLOBAL                                 \
3202: 0000:        SXTCF.START.DATE$,                       \
3203: 0000:        SXTCF.START.TIME$,                       \
3204: 0000:        SXTCF.END.DATE$,                         \
3205: 0000:        SXTCF.END.TIME$,                         \
3206: 0000:        SXTCF.STOCKTAKE.IN.PROGRESS$,            \ Y=Yes; N=No; S=Stop; C=Complete 1 BYTE
3207: 0000:        SXTCF.STOCKTAKER$,                       \ Current Stocktaker
3208: 0000:        SXTCF.CUR.LOCATION$,                     \ Location code currently be processed ! 1.1
3209: 0000:        SXTCF.FILLER$                            \ 
3210: 0000: 
3211: 0000: 
3212: 0000:  %INCLUDE STKCFDEC.J86                    ! 1.8DA
3213: 0000: \******************************************************************************
3214: 0000: \******************************************************************************
3215: 0000: \***
3216: 0000: \***   $Workfile:   STKCFDEC.J86  $
3217: 0000: \***
3218: 0000: \***   $Revision:   1.2  $
3219: 0000: \***
3220: 0000: \******************************************************************************
3221: 0000: \******************************************************************************
3222: 0000: \***
3223: 0000: \***   $Log:   V:\archive\j86\stkcfdec.j8v  $
3224: 0000: \***   
3225: 0000: \***      Rev 1.2   03 Jul 1997 14:18:38   DEV45PS
3226: 0000: \***   Stocktake In Progress Flag Removed
3227: 0000: \***   
3228: 0000: \***      Rev 1.1   30 Jun 1997 15:29:04   DEV45PS
3229: 0000: \***   Added Stocktake In Progress flag
3230: 0000: \***   
3231: 0000: \******************************************************************************
3232: 0000: \******************************************************************************\*****************************************************************************
3233: 0000: \*****************************************************************************
3234: 0000: \***
3235: 0000: \***               %INCLUDE FOR STKCF - FIELD DECLARATIONS
3236: 0000: \***                                    FILE REFERENCE PARAMETERS
3237: 0000: \***
3238: 0000: \***                      FILE TYPE    : DIRECT
3239: 0000: \***
3240: 0000: \***                      REFERENCE    : STKCFDEA
3241: 0000: \***
3242: 0000: \***           VERSION A : STEVEN GOULDING  11.01.93
3243: 0000: \***
3244: 0000: \***
3245: 0000: \***           VERSION B        NIK SEN        5th June 1997
3246: 0000: \***           Added Stocktake.In.Progress flag.
3247: 0000: \***           
3248: 0000: \***           VERSION C        NIK SEN        3rd July 1997
3249: 0000: \***           Removed Stocktake.In.Progress flag. Now moved to Stocktake
3250: 0000: \***           Control File to prevent conflicts when STKCF is locked.
3251: 0000: \***
3252: 0000: \*****************************************************************************
3253: 0000: \*****************************************************************************
3254: 0000: 
3255: 0000: REM \
3256: 0000: 
3257: 0000:   STRING GLOBAL           \
3258: 0000:     STKCF.FILE.NAME$
3259: 0000: 
3260: 0000:   INTEGER*2 GLOBAL        \
3261: 0000:     STKCF.SESS.NUM%,      \
3262: 0000:     STKCF.REPORT.NUM%,    \
3263: 0000:     STKCF.RECL%
3264: 0000: 
3265: 0000:   INTEGER*4 GLOBAL        \
3266: 0000:     STKCF.REC.NUM%
3267: 0000: REM \
3268: 0000: 
3269: 0000: 
3270: 0000:   INTEGER*4 GLOBAL                                   \
3271: 0000:             STKCF.STKMQ.POINTER%,                    \ Pointer to STKMQ
3272: 0000:             STKCF.ITEM.COUNT%                        \ No of items processed
3273: 0000: 
3274: 0000:   INTEGER*2 GLOBAL                                   \
3275: 0000:             STKCF.STMVT.REC.CNT%                     \ No of recs on STMVT file
3276: 0000: 
3277: 0000:   INTEGER*1 GLOBAL                                   \
3278: 0000:             STKCF.PREV.PITRL.UPDATE%                 \ The HOUR of update
3279: 0000: 
3280: 0000:   STRING    GLOBAL                                   \ 1 BYTE
3281: 0000:             STKCF.STOCK.SUPPORT.STATUS$              \ Y = enabled
3282: 0000:                                                      \ N = disabled
3283: 0000:                                                      \ C = Not available to
3284: 0000:                                                      \         Screens
3285: 0000:                                                      \ T = Trailer written
3286: 0000:                                                      \ 1 - 7 According to
3287: 0000:                                                      \       which STKMQ backup
3288: 0000:                                                      \       done.
3289: 0000: 
3290: 0000:   STRING    GLOBAL                                   \
3291: 0000:   	    STKCF.LAST.DIRORD.BC$,	 	     \ Last BC processed
3292: 0000: 	    					     \ in type 17 (1 byte)
3293: 0000:   	    STKCF.LAST.DIRORD.SUPPLIER$,	     \ Last supplier processed
3294: 0000: 	    					     \ in type 17 (3 bytes UPD)
3295: 0000: 	    STKCF.LAST.DIRORD.ORDER.NO$,	     \ last order no processed
3296: 0000: 	    					     \ in type 17 (2 bytes UPD)
3297: 0000: 	    STKCF.LAST.DIRORD.ORDER.SUFFIX$,	     \ last order sfx processed
3298: 0000: 	    					     \ in type 17 (1 byte)
3299: 0000:   	    STKCF.LAST.DIRORD.REC.SOURCE$, 	     \ Last record source
3300: 0000: 	    					     \ in type 17 (1 byte)
3301: 0000:        STKCF.STK.FILE.AVAIL$,                   \ Y=Yes; N=No; 1 BYTE
3302: 0000:        STKCF.STOCK.TAKE.PROCESSING.REQUIRED$,   \ Y=Yes; N=No; 1 BYTE
3303: 0000:        STKCF.FILLER$                            \ 
3304: 0000: 
3305: 0000: 
3306: 0000:  %INCLUDE STKMFDEC.J86                    ! 1.8DA
3307: 0000: \******************************************************************************
3308: 0000: \******************************************************************************
3309: 0000: \***
3310: 0000: \***   $Workfile:   STKMFDEC.J86  $
3311: 0000: \***
3312: 0000: \***   $Revision:   1.0  $
3313: 0000: \***
3314: 0000: \******************************************************************************
3315: 0000: \******************************************************************************
3316: 0000: \***
3317: 0000: \***   $Log:   V:\archive\j86\stkmfdec.j8v  $
3318: 0000: \***   
3319: 0000: \***      Rev 1.0   15 Jul 1997 14:20:54   DEV45PS
3320: 0000: \***    
3321: 0000: \***   
3322: 0000: \***      Rev 1.0   09 Jul 1997 11:05:16   DEV45PS
3323: 0000: \***   Stocktake System New Files
3324: 0000: \***   
3325: 0000: \******************************************************************************
3326: 0000: \******************************************************************************\******************************************************************************
3327: 0000: \******************************************************************************
3328: 0000: \***
3329: 0000: \***  %INCLUDES FOR STOCKTAKE MAONFRAME TRANSMISSION FILE FIELD DECLARATIONS
3330: 0000: \***
3331: 0000: \***               FILE TYPE    : DIRECT
3332: 0000: \***
3333: 0000: \***               REFERENCE    : STKMFDEC.J86
3334: 0000: \***
3335: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3336: 0000: \***    New file for stocktaking system. Holds stocktake data for 
3337: 0000: \***    transmission to the maonframe.
3338: 0000: \***
3339: 0000: \*******************************************************************************
3340: 0000: \*******************************************************************************
3341: 0000: 
3342: 0000: STRING GLOBAL                                                  \
3343: 0000:        STKMF.FILE.NAME$,               \
3344: 0000:        STKMF.DATA$,                    \
3345: 0000:        STKMF.STORE.NUMBER$,            \
3346: 0000:        STKMF.STOCKTAKER.NUM$,          \
3347: 0000:        STKMF.FILLER$,                  \
3348: 0000:        STKMF.DELIMITER$,               \
3349: 0000:        STKMF.DATE$,                    \
3350: 0000:        STKMF.LOCATION$,                \
3351: 0000:        STKMF.ITEM.CODE$,               \
3352: 0000:        STKMF.QUANTITY$,                \
3353: 0000:        STKMF.PRICE$,                   \
3354: 0000:        STKMF.RECORD.COUNT$
3355: 0000:                        
3356: 0000: INTEGER*4 GLOBAL               \
3357: 0000:        STKMF.RECORD.NUM%
3358: 0000: 
3359: 0000: INTEGER*2 GLOBAL                \
3360: 0000:    STKMF.REPORT.NUM%,           \
3361: 0000:    STKMF.SESS.NUM%             
3362: 0000: 
3363: 0000: 
3364: 0000: INTEGER*1 GLOBAL                \
3365: 0000:    STKMF.RECL%         
3366: 0000: 
3367: 0000: 
3368: 0000:  %INCLUDE STKRCDEC.J86                    ! 1.8DA
3369: 0000: \******************************************************************************
3370: 0000: \******************************************************************************
3371: 0000: \***
3372: 0000: \***   $Workfile:   STKRCDEC.J86  $
3373: 0000: \***
3374: 0000: \***   $Revision:   1.1  $
3375: 0000: \***
3376: 0000: \******************************************************************************
3377: 0000: \******************************************************************************
3378: 0000: \***
3379: 0000: \***   $Log:   V:\archive\j86\stkrcdec.j8v  $
3380: 0000: \***   
3381: 0000: \***      Rev 1.1   03 Feb 1998 10:06:02   DEV69PS
3382: 0000: \***    
3383: 0000: \***   
3384: 0000: \***      Rev 1.0   15 Jul 1997 14:20:58   DEV45PS
3385: 0000: \***    
3386: 0000: \***   
3387: 0000: \***      Rev 1.0   09 Jul 1997 11:05:22   DEV45PS
3388: 0000: \***   Stocktake System New Files
3389: 0000: \***   
3390: 0000: \******************************************************************************
3391: 0000: \******************************************************************************\******************************************************************************
3392: 0000: \******************************************************************************
3393: 0000: \***
3394: 0000: \***         %INCLUDE FOR STOCKTAKE RECOUNT FILE FIELD DECLARATIONS
3395: 0000: \***
3396: 0000: \***               FILE TYPE    : DIRECT
3397: 0000: \***
3398: 0000: \***               REFERENCE    : STKRCDEC.J86
3399: 0000: \***
3400: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3401: 0000: \***    New file for stocktaking system. Holds all items where a recount
3402: 0000: \***    has occurred.
3403: 0000: \***
3404: 0000: \*******************************************************************************
3405: 0000: \*******************************************************************************
3406: 0000: 
3407: 0000: STRING GLOBAL                                                  \
3408: 0000:        STKRC.FILE.NAME$,               \
3409: 0000:        STKRC.ITEM.CODE$,               \
3410: 0000:        STKRC.ITEM.DESCRIPTION$,        \
3411: 0000:        STKRC.LOCATION$,                \
3412: 0000:        STKRC.INITIAL.QUANTITY$,        \
3413: 0000:        STKRC.INITIAL.STOCKTAKER$,      \
3414: 0000:        STKRC.FINAL.QUANTITY$,          \
3415: 0000:        STKRC.FINAL.STOCKTAKER$
3416: 0000: 
3417: 0000: INTEGER*4 GLOBAL               \     !1.1
3418: 0000:        STKRC.RECORD.NUM%
3419: 0000: 
3420: 0000: 
3421: 0000: INTEGER*2 GLOBAL                \
3422: 0000:    STKRC.REPORT.NUM%,           \
3423: 0000:    STKRC.SESS.NUM%             
3424: 0000: 
3425: 0000: 
3426: 0000: INTEGER*1 GLOBAL                \
3427: 0000:    STKRC.LOC.CNT%,              \     
3428: 0000:    STKRC.RECL%         
3429: 0000: 
3430: 0000: 
3431: 0000:  %INCLUDE XGCFDEC.J86                     ! 1.8DA
3432: 0000: \******************************************************************************
3433: 0000: \******************************************************************************
3434: 0000: \***
3435: 0000: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
3436: 0000: \***
3437: 0000: \***                  FILE TYPE    : Keyed
3438: 0000: \***
3439: 0000: \***                  REFERENCE    : XGCFDEC.J86
3440: 0000: \***
3441: 0000: \***    VERSION A               Steve Wright                        24 Aug 1999
3442: 0000: \***
3443: 0000: \*******************************************************************************
3444: 0000: \*******************************************************************************
3445: 0000: 
3446: 0000: STRING GLOBAL           \
3447: 0000:    XGCF.FILE.NAME$,     \
3448: 0000:    XGCF.PRODUCT.GRP$,   \  Redundant - key changed from product group to BC
3449: 0000:    XGCF.BAR.CODE$,      \
3450: 0000:    XGCF.BSNS.CNTR$,     \  New key - 1 byte business centre
3451: 0000:    XGCF.RSRVD$          !  New key - 2 byte filler, must be 0x0000 (set by function)
3452: 0000: 
3453: 0000: INTEGER*2 GLOBAL        \
3454: 0000:    XGCF.RECL%,          \  
3455: 0000:    XGCF.REPORT.NUM%,    \ 
3456: 0000:    XGCF.SESS.NUM%
3457: 0000:  %INCLUDE STKEXDEC.J86                    ! 1.8DA
3458: 0000: \******************************************************************************
3459: 0000: \******************************************************************************
3460: 0000: \***
3461: 0000: \***   $Workfile:   STKEXDEC.J86  $
3462: 0000: \***
3463: 0000: \***   $Revision:   1.1  $
3464: 0000: \***
3465: 0000: \******************************************************************************
3466: 0000: \******************************************************************************
3467: 0000: \***
3468: 0000: \***   $Log:   V:\archive\j86\stkexdec.j8v  $
3469: 0000: \***   
3470: 0000: \***      Rev 1.1   05 Aug 1997 13:49:18   DEV45PS
3471: 0000: \***   Added Reason Code
3472: 0000: \***   
3473: 0000: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
3474: 0000: \***    
3475: 0000: \***   
3476: 0000: \***      Rev 1.0   09 Jul 1997 11:05:04   DEV45PS
3477: 0000: \***   Stocktake System New Files
3478: 0000: \***   
3479: 0000: \******************************************************************************
3480: 0000: \******************************************************************************\******************************************************************************
3481: 0000: \******************************************************************************
3482: 0000: \***
3483: 0000: \***         %INCLUDE FOR STOCKTAKE EXCEPTIONS FILE FIELD DECLARATIONS
3484: 0000: \***
3485: 0000: \***               FILE TYPE    : DIRECT
3486: 0000: \***
3487: 0000: \***               REFERENCE    : STKEXDEC.J86
3488: 0000: \***
3489: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3490: 0000: \***    New file for stocktaking system. Holds all counted items which  
3491: 0000: \***    are not on the IDF.
3492: 0000: \***
3493: 0000: \***    VERSION B              Nik Sen                 5th August 1997
3494: 0000: \***    Added reason code.
3495: 0000: \***
3496: 0000: \*******************************************************************************
3497: 0000: \*******************************************************************************
3498: 0000: 
3499: 0000: STRING GLOBAL                                                  \
3500: 0000:    STKEX.FILE.NAME$,            \
3501: 0000:    STKEX.ITEM.CODE$,           \
3502: 0000:    STKEX.QUANTITY$,            \
3503: 0000:    STKEX.LOCATION$,            \
3504: 0000:    STKEX.STOCKTAKER.NUM$,      \
3505: 0000:    STKEX.REASON.CODE$
3506: 0000: 
3507: 0000: 
3508: 0000: INTEGER*4 GLOBAL               \
3509: 0000:        STKEX.RECORD.NUM%
3510: 0000: 
3511: 0000: INTEGER*2 GLOBAL                \
3512: 0000:    STKEX.REPORT.NUM%,           \
3513: 0000:    STKEX.SESS.NUM%             
3514: 0000: 
3515: 0000: 
3516: 0000: INTEGER*1 GLOBAL                \
3517: 0000:    STKEX.RECL%         
3518: 0000: 
3519: 0000: 
3520: 0000:  %INCLUDE STKIFDEC.J86                    ! 1.8DA
3521: 0000: \******************************************************************************
3522: 0000: \******************************************************************************
3523: 0000: \***
3524: 0000: \***   $Workfile:   STKIFDEC.J86  $
3525: 0000: \***
3526: 0000: \***   $Revision:   1.2  $
3527: 0000: \***
3528: 0000: \******************************************************************************
3529: 0000: \******************************************************************************
3530: 0000: \***
3531: 0000: \***   $Log:   V:\archive\j86\stkifdec.j8v  $
3532: 0000: \***   
3533: 0000: \***      Rev 1.2   21 Aug 1997 11:20:56   DEV45PS
3534: 0000: \***    
3535: 0000: \***   
3536: 0000: \***      Rev 1.1   19 Aug 1997 11:06:14   DEV45PS
3537: 0000: \***   Added Stocktake Transmission File Record Number Field
3538: 0000: \***   
3539: 0000: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
3540: 0000: \***    
3541: 0000: \***   
3542: 0000: \***      Rev 1.0   09 Jul 1997 11:05:10   DEV45PS
3543: 0000: \***   Stocktake System New Files
3544: 0000: \***   
3545: 0000: \******************************************************************************
3546: 0000: \******************************************************************************\******************************************************************************
3547: 0000: \******************************************************************************
3548: 0000: \***
3549: 0000: \***         %INCLUDE FOR STOCKTAKE ITEM FILE FIELD DECLARATIONS
3550: 0000: \***
3551: 0000: \***               FILE TYPE    : KEYED
3552: 0000: \***
3553: 0000: \***               REFERENCE    : STKIFDEC.J86
3554: 0000: \***
3555: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3556: 0000: \***    New file for stocktaking system. Holds information about all counted
3557: 0000: \***    items found on the STOCK and IDF files. Key is Boots Code + Location 
3558: 0000: \***
3559: 0000: \***    VERSION B               Nik Sen                19 August 1997
3560: 0000: \***    Added STKMF Record Number field.
3561: 0000: \***
3562: 0000: \*******************************************************************************
3563: 0000: \*******************************************************************************
3564: 0000: 
3565: 0000: STRING GLOBAL                                                  \
3566: 0000:        STKIF.FILE.NAME$,               \
3567: 0000:        STKIF.KEY$,                     \
3568: 0000:        STKIF.ITEM.CODE$,               \
3569: 0000:        STKIF.LOCATION$,                \
3570: 0000:        STKIF.BUSINESS.CENTRE$,         \
3571: 0000:        STKIF.GROUP.SEQUENCE$,          \
3572: 0000:        STKIF.QUANTITY$,                \
3573: 0000:        STKIF.DESCRIPTION$,             \
3574: 0000:        STKIF.STOCKTAKER.NUM$
3575: 0000: 
3576: 0000: 
3577: 0000: 
3578: 0000: INTEGER*2 GLOBAL                \
3579: 0000:    STKIF.REPORT.NUM%,           \
3580: 0000:    STKIF.SESS.NUM%             
3581: 0000: 
3582: 0000: 
3583: 0000: INTEGER*1 GLOBAL                \
3584: 0000:    STKIF.RECL%         
3585: 0000: 
3586: 0000: INTEGER*4 GLOBAL                \
3587: 0000:    STKIF.STKMF.RECORD.NUM%
3588: 0000: 
3589: 0000: 
3590: 0000: 
3591: 0000:  %INCLUDE LOCNTDEC.J86                    ! 1.8DA
3592: 0000: \******************************************************************************
3593: 0000: \******************************************************************************
3594: 0000: \***
3595: 0000: \***   $Workfile:   LOCNTDEC.J86  $
3596: 0000: \***
3597: 0000: \***   $Revision:   1.0  $
3598: 0000: \***
3599: 0000: \******************************************************************************
3600: 0000: \******************************************************************************
3601: 0000: \***
3602: 0000: \***   $Log:   V:\archive\j86\locntdec.j8v  $
3603: 0000: \***   
3604: 0000: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
3605: 0000: \***    
3606: 0000: \***   
3607: 0000: \******************************************************************************
3608: 0000: \******************************************************************************
3609: 0000: \***
3610: 0000: \***         %INCLUDE FOR STOCKTAKE LOCATION COUNTERS (LOCCNT) DECLARATIONS
3611: 0000: \***
3612: 0000: \***               FILE TYPE    : DIRECT
3613: 0000: \***
3614: 0000: \***               REFERENCE    : LOCNTDEC.J86
3615: 0000: \***
3616: 0000: \***    VERSION A.              Johnnie Chan           6th Jan 1998
3617: 0000: \***    New file for stocktaking system. Holds all locations counted using
3618: 0000: \***    1st to 10000th record for S0000-S9999 and 10001st to 20000th record
3619: 0000: \***    for B0000-B9999.
3620: 0000: \***
3621: 0000: \*******************************************************************************
3622: 0000: \*******************************************************************************
3623: 0000: 
3624: 0000: STRING GLOBAL                           \
3625: 0000:        LOCCNT.FILE.NAME$
3626: 0000:        
3627: 0000: INTEGER*4 GLOBAL                        \
3628: 0000:        LOCCNT.RECORD.NUM%
3629: 0000: 
3630: 0000: 
3631: 0000: INTEGER*2 GLOBAL                        \
3632: 0000:        LOCCNT.REPORT.NUM%,              \
3633: 0000:        LOCCNT.SESS.NUM%             
3634: 0000: 
3635: 0000: 
3636: 0000: INTEGER*1 GLOBAL                        \
3637: 0000:        LOCCNT.LOCATION.COUNT%,          \
3638: 0000:        LOCCNT.RECL%         
3639: 0000: 
3640: 0000: 
3641: 0000:  %INCLUDE STKIGDEC.J86                    ! 1.8DA
3642: 0000: \******************************************************************************
3643: 0000: \******************************************************************************
3644: 0000: \***
3645: 0000: \***         %INCLUDE FOR STOCKTAKE ITEM GROUP FIELD DECLARATIONS
3646: 0000: \***
3647: 0000: \***               FILE TYPE    : DIRECT
3648: 0000: \***
3649: 0000: \***               REFERENCE    : STKIGDEC.J86
3650: 0000: \***
3651: 0000: \***    VERSION A.              Nik Sen.               17 Jun 1997.
3652: 0000: \***    New file for stocktaking system. Holds Business Centres, Concept
3653: 0000: \***    and product groups which define scope of stocktake.
3654: 0000: \***
3655: 0000: \*******************************************************************************
3656: 0000: \*******************************************************************************
3657: 0000: 
3658: 0000: STRING GLOBAL                                                  \
3659: 0000:    STKIG.FILE.NAME$,            \
3660: 0000:    STKIG.DATA$
3661: 0000: 
3662: 0000: INTEGER*4 GLOBAL               \
3663: 0000:    STKIG.RECORD.NUM%
3664: 0000: 
3665: 0000: INTEGER*2 GLOBAL                \
3666: 0000:    STKIG.REPORT.NUM%,           \
3667: 0000:    STKIG.SESS.NUM%             
3668: 0000: 
3669: 0000: 
3670: 0000: INTEGER*1 GLOBAL                \
3671: 0000:    STKIG.RECL%         
3672: 0000: 
3673: 0000: 
3674: 0000:  %INCLUDE STKTFDEC.J86                    ! 1.8DA
3675: 0000: \******************************************************************************
3676: 0000: \******************************************************************************
3677: 0000: \***
3678: 0000: \***   $Workfile:   STKTFDEC.J86  $
3679: 0000: \***
3680: 0000: \***   $Revision:   1.1  $
3681: 0000: \***
3682: 0000: \******************************************************************************
3683: 0000: \******************************************************************************
3684: 0000: \***
3685: 0000: \***   $Log:   V:\archive\j86\stktfdec.j8v  $
3686: 0000: \***   
3687: 0000: \***      Rev 1.1   15 Jul 1997 14:36:28   DEV45PS
3688: 0000: \***    
3689: 0000: \***   
3690: 0000: \***      Rev 1.0   15 Jul 1997 14:21:02   DEV45PS
3691: 0000: \***   Stocktake System New Files
3692: 0000: \***   
3693: 0000: \******************************************************************************
3694: 0000: \******************************************************************************\******************************************************************************
3695: 0000: \******************************************************************************
3696: 0000: \***
3697: 0000: \***         %INCLUDE FOR STOCKTAKE TOTALS FILE FIELD DECLARATIONS
3698: 0000: \***
3699: 0000: \***               FILE TYPE    : KEYED
3700: 0000: \***
3701: 0000: \***               REFERENCE    : STKTFDEC.J86
3702: 0000: \***
3703: 0000: \***    VERSION A.              Nik Sen.               15 July 1997.
3704: 0000: \***    New file for stocktaking system. Holds information about all counted
3705: 0000: \***    items found on the STOCK and IDF files. Key is Boots Code. 
3706: 0000: \***
3707: 0000: \*******************************************************************************
3708: 0000: \*******************************************************************************
3709: 0000: 
3710: 0000: STRING GLOBAL                                                  \
3711: 0000:        STKTF.FILE.NAME$,               \
3712: 0000:        STKTF.BOOTS.CODE$,              \
3713: 0000:        STKTF.BUSINESS.CENTRE$,         \
3714: 0000:        STKTF.GROUP.SEQUENCE$,          \
3715: 0000:        STKTF.QUANTITY$                
3716: 0000: 
3717: 0000: 
3718: 0000: 
3719: 0000: INTEGER*2 GLOBAL                \
3720: 0000:    STKTF.REPORT.NUM%,           \
3721: 0000:    STKTF.SESS.NUM%             
3722: 0000: 
3723: 0000: 
3724: 0000: INTEGER*1 GLOBAL                \
3725: 0000:    STKTF.RECL%         
3726: 0000: 
3727: 0000: 
3728: 0000:  %INCLUDE IRFDEC.J86                      ! 1.8DA
3729: 0000: 
3730: 0000: \**********************************************************************************
3731: 0000: \***
3732: 0000: \***       %INCLUDE FOR ITEM RECORD FILE - FIELD DECLARATIONS
3733: 0000: \***                                     - FILE REFERENCE PARAMETERS
3734: 0000: \***
3735: 0000: \***                      FILE TYPE    : Keyed
3736: 0000: \***
3737: 0000: \***                      REFERENCE    : IRFDEC.J86
3738: 0000: \***
3739: 0000: \***     Version A               Andrew Wedgeworth            29th June 1992
3740: 0000: \***
3741: 0000: \***     Version B               Andrew Wedgeworth        14th December 1992
3742: 0000: \***     Version letter incremented to match other IRF code.
3743: 0000: \***
3744: 0000: \***     Version C             Steve Windsor          12.02.93
3745: 0000: \***     Version letter incremented to match other IRF code.
3746: 0000: \***
3747: 0000: \***     Version D             Steve Windsor          12.05.93
3748: 0000: \***     Version letter incremented to match other IRF code.
3749: 0000: \***
3750: 0000: \***     Version E           Steve Perkins       20th September 1993
3751: 0000: \***     Deals project : Handling of Converted/Unconverted records
3752: 0000: \***     ++   Anything with 'Delete' after initials should be   ++
3753: 0000: \***     ++   deleted once the IRF has been converted in all    ++
3754: 0000: \***     ++   stores.                                           ++
3755: 0000: \***
3756: 0000: \***     Version F           Mark Walker            5th January 1994
3757: 0000: \***     Version letter incremented to match other IRF code.
3758: 0000: \***
3759: 0000: \***     Version 96A         Mark Walker               22nd May 1995
3760: 0000: \***     Definition for IRF.POINTS% added.
3761: 0000: \***
3762: 0000: \***                     Stuart McConnachie           12th June 1995
3763: 0000: \***     INDICAT3% comments added for discount/loyalty flags.
3764: 0000: \***
3765: 0000: \***     Version for 96C  Andrew Wedgeworth            22nd May 1996
3766: 0000: \***     Removed IRF.FILLER$ field, as this is now redundant.
3767: 0000: \***
3768: 0000: \***     Version G     Stuart William McConnachie      11th February 2000
3769: 0000: \***     Converted IRF.INDICAT2$ to integer flag byte.
3770: 0000: \***
3771: 0000: \***     REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
3772: 0000: \***     Major changes for 2002 Deals Rewrite project.
3773: 0000: \***     Incorporated up to date record layout to assist development work
3774: 0000: \***     (placed in the IRFDEC.J86 to make it visible from ...LST files).
3775: 0000: \***     Moved various comments against variables to record layout.
3776: 0000: \***     Relisted variables in alphabetical order.
3777: 0000: \***     Deleted redundant variables associated with the old deals system ...
3778: 0000: \***     DEAL.NUM$, DEAL.SAVING$
3779: 0000: \***     Retained variables that are otherwise redundant (to be set to null X'00'
3780: 0000: \***     within file functions) ...
3781: 0000: \***     INDICAT2%, INDICAT4%, SALEQUAN$, POINTS%
3782: 0000: \***     Defined variables to hold interpreted deals data for new deals system ...
3783: 0000: \***     DEAL.NUM$(n) and LIST.ID%(n) (where 'n' represents entry 0, 1 and 2).
3784: 0000: \***     These two variables are interpretations of DEAL.DATA% which is defined
3785: 0000: \***     locally within IRFFUN.BAS to keep underlying data invisible to programs.
3786: 0000: \***
3787: 0000: \***     REVISION 1.7                ROBERT COWEY.               5 AUG 2002.
3788: 0000: \***     Further changes for 2002 Deals Rewrite project (PSBF19 related).
3789: 0000: \***     Defined NEW.IRF.DATA$ as a global variable for use with new functions
3790: 0000: \***     CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
3791: 0000: \***
3792: 0000: \***     REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
3793: 0000: \***     Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
3794: 0000: \***     No changes to this file other than description.
3795: 0000: \***     No changes to IRF file functions.
3796: 0000: \***
3797: 0000: \***     REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
3798: 0000: \***     Changes to remove limit of 3 deals per item.
3799: 0000: \***     Declaration of new variables for IRF Deal Extension file (IRFDEX).
3800: 0000: \***
3801: 0000: \***     REVISION 2.0.            ALAN CARR                       9 FEB 2006.
3802: 0000: \***     Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
3803: 0000: \***
3804: 0000: \***     REVISION 2.1              TITTOO THOMAS                  01 July 2011
3805: 0000: \***     The IRF.UNUSED field is disintegrated to 2 new indicator fields
3806: 0000: \***                      IRF.INDICAT9%   1 INT
3807: 0000: \***                      IRF.INDICAT10%  1 INT
3808: 0000: \***...............................................................................
3809: 0000: 
3810: 0000: 
3811: 0000: \**********************************************************************************
3812: 0000: \***
3813: 0000: \***    IRF RECORD LAYOUT - REVISION 1.7 - CORRECT FOR 2011 CORE Stores PROJECT
3814: 0000: \***
3815: 0000: \***     1 11  UPD  BAR.CODE$   Without check digit - File KEY
3816: 0000: \***    12  1  INT  INDICAT0%
3817: 0000: \***                    X"01" - Contains statins                           ! 2.2 TT
3818: 0000: \***                    X"02" - Item not priced (giveaway)
3819: 0000: \***                    X"04" - Item not returnable
3820: 0000: \***                    X"08" - Item contains alcohol
3821: 0000: \***                    X"10" - Blocked from sale                          ! 2.2 TT
3822: 0000: \***                    X"20" - Enforced price entry
3823: 0000: \***                    X"40" - Enforced quantity entry
3824: 0000: \***                    X"80" - Movement kept
3825: 0000: \***    13  1  INT  INDICAT1%
3826: 0000: \***                    X"01" - Asprin
3827: 0000: \***                    X"02" - Paracetamol
3828: 0000: \***                    X"04" - TPLU inclusion flag
3829: 0000: \***                    X"08" - Giftcard item                              ! 2.2 TT
3830: 0000: \***                    X"10" - Withdrawn Block from sale                  ! 2.2 TT
3831: 0000: \***                    X"20" - Non-solid dose painkiller                  ! 2.2 TT
3832: 0000: \***                    X"40" - Insurance policy item                      ! 2.2 TT
3833: 0000: \***                    X"80" - Ibuprofen
3834: 0000: \***    14  2  INT  DEAL.DATA%(0)   Interpreted into sub-variables ...
3835: 0000: \***                    X'3F' - into DEAL.NUM$(0) "0000" to "9999" (2 byte UPD)
3836: 0000: \***                    X'C0' - into LIST.ID%(0) X'00' X
3837: 0000: \***                                             X'01' A
3838: 0000: \***                                             X'10' B
3839: 0000: \***                                             X'11' C                   ! 1.9 RC
3840: 0000: \***    16  1  INT  INDICAT8%                                              ! 2.0 AJC
3841: 0000: \***                    X"01" - Chlamydia NHS test kit                     ! 2.2 TT
3842: 0000: \***                    X"02" - Chlamydia open sell test kit               ! 2.2 TT
3843: 0000: \***                    X"04" - Unrestricted group code                    ! 2.2 TT
3844: 0000: \***                    X"08" - Nightingale Till prompt                    ! 2.2 TT
3845: 0000: \***                    X"10" - Contains Ephedrine                         ! 2.2 TT
3846: 0000: \***                    X"60" -  X'00' - If also Blocked From Sale Recall, ! 2.2 TT
3847: 0000: \***                                        Emergency                      ! 2.2 TT
3848: 0000: \***                             X'00' - If NOT Blocked From Sale Recall,  ! 2.2 TT
3849: 0000: \***                                        No recall                      ! 2.2 TT
3850: 0000: \***                             X'20' 100% returns                        ! 2.2 TT
3851: 0000: \***                             X'40' Withdrawn recall                    ! 2.2 TT
3852: 0000: \***                             X'60' Reverse Logistics                   ! 2.2 TT
3853: 0000: \***                    X"80" - WEEE item flag                             ! 2.0 AJC
3854: 0000: \***    17  1  INT  INDICAT9%
3855: 0000: \***                    X'3F' - Disposal special instruction (0-63)
3856: 0000: \***                    X"40" - Resaleable Indicator
3857: 0000: \***                    X"80" - Boots.com Extended Indicator
3858: 0000: \***    18  1  INT  INDICAT10%
3859: 0000: \***                    X'07' - Age restrictions
3860: 0000: \***                             X'00' - No Age restriction
3861: 0000: \***                             X'01' - Age 12 or over
3862: 0000: \***                             X'02' - Age 15 or over
3863: 0000: \***                             X'03' - Age 16 or over
3864: 0000: \***                             X'04' - Age 18 or over
3865: 0000: \***                             X'05' - Age 21 or over
3866: 0000: \***                             X'06' - Reserved
3867: 0000: \***                             X'07' - Reserved
3868: 0000: \***                    X'38' - Ethical classification
3869: 0000: \***                             X'00' - No ethical classification
3870: 0000: \***                             X'08' - Pharmacy medicine (P)
3871: 0000: \***                             X'10' - General Sale License (GSL)
3872: 0000: \***                             X'18' - Prescription Only Medicine (POM)
3873: 0000: \***                             X'20' - Reserved
3874: 0000: \***                             X'28' - Reserved
3875: 0000: \***                             X'30' - Reserved
3876: 0000: \***                             X'38' - Reserved
3877: 0000: \***                    X'C0' - Returns route
3878: 0000: \***                             X'00' - Not Returnable (Destroy)
3879: 0000: \***                             X'40' - Returns & Recovery
3880: 0000: \***                             X'80' - Direct
3881: 0000: \***                             X'C0' - Semi-centralised
3882: 0000: \***    19  5  UPD  SALEPRIC$   Current price in pence
3883: 0000: \***    24  1  INT  INDICAT5%   Guarantee duration
3884: 0000: \***                    X'3F' - Lowest 6 bits indicate duration (1-63)
3885: 0000: \***                    X'40' - Contains Pseudoephedrine                   ! 2.2 TT
3886: 0000: \***                    X'80' - Guarantee Duration Type                    ! 2.2 TT
3887: 0000: \***                              (1 = Months, 0 = Years)                  ! 2.2 TT
3888: 0000: \***    25 18  ASC  ITEMNAME$   Description used by till
3889: 0000: \***    43  3  UPD  BOOTS.CODE$ Without check digit
3890: 0000: \***    46  2  INT  DEAL.DATA%(1)   Similar structure to DEAL.DATA%(0)
3891: 0000: \***    48  2  INT  DEAL.DATA%(2)   Similar structure to DEAL.DATA%(0)
3892: 0000: \***    50  1  INT  INDICAT3%
3893: 0000: \***                    X"01" - Discountexempt (item exempt from discount)
3894: 0000: \***                    X"02" - Boots brand item
3895: 0000: \***                    X"04" - Item redeemable for loyalty
3896: 0000: \***                    X"08" - Loyalty exempt (item exempt from loyalty)
3897: 0000: \***                    X"10" - **Redundant                                ! 2.2 TT
3898: 0000: \***                    X"20" - Local Price active
3899: 0000: \***                    X"40" - Stock system item
3900: 0000: \***                    X"80" - **Redundant                                ! 2.2 TT
3901: 0000: \***
3902: 0000: \***    Record Length 50
3903: 0000: \***
3904: 0000: \***
3905: 0000: \***    IRF DEAL EXTENSION RECORD LAYOUT ! 1.9 RC
3906: 0000: \***
3907: 0000: \***     1  3  UPD  BOOTS.CODE$
3908: 0000: \***     4  2  INT  IRF.DEAL.DATA%(3)   Similar structure to DEAL.DATA%(0)
3909: 0000: \***     6  2  INT  IRF.DEAL.DATA%(4)   Similar structure to DEAL.DATA%(0)
3910: 0000: \***     8  2  INT  IRF.DEAL.DATA%(5)   Similar structure to DEAL.DATA%(0)
3911: 0000: \***    10  2  INT  IRF.DEAL.DATA%(6)   Similar structure to DEAL.DATA%(0)
3912: 0000: \***    12  2  INT  IRF.DEAL.DATA%(7)   Similar structure to DEAL.DATA%(0)
3913: 0000: \***    14  2  INT  IRF.DEAL.DATA%(8)   Similar structure to DEAL.DATA%(0)
3914: 0000: \***    16  2  INT  IRF.DEAL.DATA%(9)   Similar structure to DEAL.DATA%(0)
3915: 0000: \***
3916: 0000: \***    Record Length 17
3917: 0000: \***
3918: 0000: \**********************************************************************************
3919: 0000: 
3920: 0000: 
3921: 0000:     STRING GLOBAL            \
3922: 0000:         IRF.ALT.FILE.NAME$,  \
3923: 0000:         IRF.BAR.CODE$,       \
3924: 0000:         IRF.BOOTS.CODE$,     \
3925: 0000:         IRF.DEAL.SAVING$,    \ 2 byte - deal saving amount (0 - 99.99) ! ESP
3926: 0000:         IRF.DEPARTME$,       \ 3 byte UPD. Department number          ! ESP Delete
3927: 0000:         IRF.FILE.NAME$,      \
3928: 0000:         IRF.HOLDING.PRICE$,  \ 4 byte UPD. Current H.O. price in pence if a local
3929: 0000:                              \ price is in effect, zero otherwise.     ! ESP Delete
3930: 0000:         IRF.ITEMNAME$,       \
3931: 0000: \       IRF.MPGROUP$,        \ Removed SBH 31/1/96
3932: 0000:         IRF.RECORD$,         \                                         ! ESP Delete
3933: 0000:         IRF.SALEPRIC$,       \
3934: 0000:         IRF.SALEQUAN$,       \ Redundant (set to null within functions)    ! 1.6 RC
3935: 0000:         IRF.UNUSED$,         \                                                        ! 1.6 RC
3936: 0000:         NEW.IRF.DATA$        !                                             ! 1.7 RC
3937: 0000: 
3938: 0000:     STRING GLOBAL            \                                             ! 1.6 RC
3939: 0000:         IRF.DEAL.NUM$(1)                                                   ! 1.6 RC
3940: 0000: 
3941: 0000:     INTEGER*1 GLOBAL         \
3942: 0000:         IRF.DD.SUB%,         \ IRF.DEAL.DATA% subscript                    ! 1.6 RC
3943: 0000:         IRF.INDICAT0%,       \
3944: 0000:         IRF.INDICAT1%,       \
3945: 0000:         IRF.INDICAT2%,       \ Redundant (set to null within functions)    ! 1.6 RC
3946: 0000:         IRF.INDICAT3%,       \
3947: 0000:         IRF.INDICAT4%,       \ Redundant (set to null within functions)    ! 1.6 RC
3948: 0000:         IRF.INDICAT5%,       \                                             ! 2.0 AJC
3949: 0000:         IRF.INDICAT8%,       \                                             ! 2.0 AJC
3950: 0000:         IRF.INDICAT9%,       \                                             ! 2.2 TT
3951: 0000:         IRF.INDICAT10%                                                     ! 2.2 TT
3952: 0000: 
3953: 0000:     INTEGER*1 GLOBAL         \                                             ! 1.6 RC
3954: 0000:         IRF.LIST.ID%(1)                                                    ! 1.6 RC
3955: 0000: 
3956: 0000:     INTEGER*2 GLOBAL         \
3957: 0000:         IRF.ALT.REPORT.NUM%, \
3958: 0000:         IRF.ALT.SESS.NUM%,   \
3959: 0000:         IRF.POINTS%,         \ Redundant (set to null within functions)    ! 1.6 RC
3960: 0000:         IRF.RECL%,           \
3961: 0000:         IRF.REPORT.NUM%,     \
3962: 0000:         IRF.SESS.NUM%,       \
3963: 0000:         IRF.MAX.DEALS%       !                                             ! 1.9 SM
3964: 0000: 
3965: 0000:     STRING GLOBAL IRFDEX.FILE.NAME$                                        ! 1.9 SM
3966: 0000: 
3967: 0000:     INTEGER*2 GLOBAL IRFDEX.SESS.NUM%                                      ! 1.9 SM
3968: 0000:     INTEGER*2 GLOBAL IRFDEX.REPORT.NUM%                                    ! 1.9 SM
3969: 0000:     INTEGER*2 GLOBAL IRFDEX.RECL%                                          ! 1.9 SM
3970: 0000: 
3971: 0000: 
3972: 0000: !   INTEGER*2 GLOBAL      \ IRF.DEAL.DATA%(n) variables are defined locally  1.6 RC
3973: 0000: !       IRF.DEAL.DATA%(1) \ within IRFFUN.BAS to keep invisible to programs  1.6 RC
3974: 0000: 
3975: 0000:  %INCLUDE STKDCDEC.J86                    ! 1.8DA
3976: 0000: \******************************************************************************
3977: 0000: \******************************************************************************
3978: 0000: \***
3979: 0000: \***   $Workfile:   STKDCDEC.J86  $
3980: 0000: \***
3981: 0000: \***   $Revision:   1.0  $
3982: 0000: \***
3983: 0000: \******************************************************************************
3984: 0000: \******************************************************************************
3985: 0000: \***
3986: 0000: \***   $Log:   V:\archive\j86\stkdcdec.j8v  $
3987: 0000: \***   
3988: 0000: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
3989: 0000: \***    
3990: 0000: \***   
3991: 0000: \***      Rev 1.0   09 Jul 1997 11:04:58   DEV45PS
3992: 0000: \***   Stocktake System New Files
3993: 0000: \***   
3994: 0000: \******************************************************************************
3995: 0000: \******************************************************************************\******************************************************************************
3996: 0000: \******************************************************************************
3997: 0000: \***
3998: 0000: \***         %INCLUDE FOR STOCKTAKE DUMP CODEP FIELD DECLARATIONS
3999: 0000: \***
4000: 0000: \***               FILE TYPE    : DIRECT
4001: 0000: \***
4002: 0000: \***               REFERENCE    : STKDCDEC.J86
4003: 0000: \***
4004: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4005: 0000: \***    New file for stocktaking system. Holds all items counted using
4006: 0000: \***    dump codes during the stocktake.
4007: 0000: \***
4008: 0000: \*******************************************************************************
4009: 0000: \*******************************************************************************
4010: 0000: 
4011: 0000: STRING GLOBAL                                                  \
4012: 0000:        STKDC.FILE.NAME$,               \
4013: 0000:        STKDC.DUMP.CODE$,               \
4014: 0000:        STKDC.QUANTITY$,                \
4015: 0000:        STKDC.PRICE$,                   \
4016: 0000:        STKDC.LOCATION$,                \
4017: 0000:        STKDC.STOCKTAKER.NUM$
4018: 0000:         
4019: 0000: INTEGER*4 GLOBAL               \
4020: 0000:        STKDC.RECORD.NUM%
4021: 0000: 
4022: 0000: 
4023: 0000: INTEGER*2 GLOBAL                \
4024: 0000:    STKDC.REPORT.NUM%,           \
4025: 0000:    STKDC.SESS.NUM%             
4026: 0000: 
4027: 0000: 
4028: 0000: INTEGER*1 GLOBAL                \
4029: 0000:    STKDC.RECL%         
4030: 0000: 
4031: 0000: 
4032: 0000:  %INCLUDE MINLSDEC.J86                    ! 1.9BG
4033: 0000: 
4034: 0000: \*****************************************************************************
4035: 0000: \*****************************************************************************
4036: 0000: \***
4037: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4038: 0000: \***
4039: 0000: \***                   FILE TYPE:  KEYED
4040: 0000: \***
4041: 0000: \***                   REFERENCE:  MINLSDEC.J86
4042: 0000: \***
4043: 0000: \***              DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
4044: 0000: \***
4045: 0000: \***
4046: 0000: \***
4047: 0000: \***      VERSION 1 : Julia Stones             8th January 1998  
4048: 0000: \***      
4049: 0000: \*****************************************************************************
4050: 0000: \*****************************************************************************
4051: 0000: 
4052: 0000: STRING GLOBAL   \
4053: 0000:    MINLS.FILE.NAME$,  \
4054: 0000:    MINLS.ITEM.CODE$,     \  4 byte UPD;  Record key
4055: 0000:    MINLS.RECOUNT.DATE$,  \  3 byte UPD;  YYMMDD      
4056: 0000:    MINLS.DISCREPANCY$,    \  3 byte UPD        
4057: 0000:    MINLS.COUNT.STATUS$     ! 1 byte ASCII 
4058: 0000: 
4059: 0000: INTEGER*2 GLOBAL  \
4060: 0000:    MINLS.RECL%,   \
4061: 0000:    MINLS.REPORT.NUM%,  \
4062: 0000:    MINLS.SESS.NUM%   !
4063: 0000: 
4064: 0000: 
4065: 0000: 
4066: 0000:  %INCLUDE NEGSCDEC.J86                    ! 1.9BG
4067: 0000: 
4068: 0000: \*****************************************************************************
4069: 0000: \*****************************************************************************
4070: 0000: \***
4071: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4072: 0000: \***
4073: 0000: \***                   FILE TYPE:  KEYED
4074: 0000: \***
4075: 0000: \***                   REFERENCE:  NEGSCDEC.J86
4076: 0000: \***
4077: 0000: \***              DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
4078: 0000: \***
4079: 0000: \***
4080: 0000: \***
4081: 0000: \***      VERSION 1 : Julia Stones             15th July 1999  
4082: 0000: \***      
4083: 0000: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
4084: 0000: \***    Changes for RF trial.
4085: 0000: \***    Recompiled to prevent future automatic recompiles.
4086: 0000: \***    No changes to actual code.
4087: 0000: \***
4088: 0000: \*****************************************************************************
4089: 0000: \*****************************************************************************
4090: 0000: 
4091: 0000: STRING GLOBAL   \
4092: 0000:    NEGSC.FILE.NAME$,  \
4093: 0000:    NEGSC.KEY$,   \      !  5 bytes UPD; 1 byte Record type 
4094: 0000:                         \                 Record type 01 item record
4095: 0000:                         \                 Record type 02 total count record
4096: 0000:                         \               4 bytes item code (set to zero's if
4097: 0000:                         \                 record type 02)
4098: 0000:    NEGSC.STATUS.1$      !  1 byte ASC
4099: 0000:                         !            'B' - Discontinued but still on display
4100: 0000:                         !            'C' - Cancel outstanding orders
4101: 0000:                         !            'D' - Discontinued and no longer on display
4102: 0000:                         !            'P' - Suspended (orders to Store)
4103: 0000:                         !            'X' - Deleted
4104: 0000:                         !            ' ' - No special Status (default value)
4105: 0000:   
4106: 0000: INTEGER*2 GLOBAL  \
4107: 0000:    NEGSC.RECL%,   \
4108: 0000:    NEGSC.REPORT.NUM%,  \
4109: 0000:    NEGSC.SESS.NUM%,    \
4110: 0000:    NEGSC.ITEM.TSF%,    \
4111: 0000:    NEGSC.NUMBER.OF.DAYS%   !
4112: 0000: 
4113: 0000: 
4114: 0000: 
4115: 0000:  %INCLUDE SSPSCDEC.J86                    ! 2.0JAS
4116: 0000: \*****************************************************************************
4117: 0000: \*****************************************************************************
4118: 0000: \***
4119: 0000: \***               %INCLUDE FOR SSPSCTRL - FIELD DECLARATIONS
4120: 0000: \***                                          FILE REFERENCE PARAMETERS
4121: 0000: \***
4122: 0000: \***                      FILE TYPE    : DIRECT
4123: 0000: \***
4124: 0000: \***                      REFERENCE    : SSPSCdea.J86
4125: 0000: \***
4126: 0000: \***    Version A               Julia Stones          23 Oct 2003
4127: 0000: \***
4128: 0000: \***
4129: 0000: \*****************************************************************************
4130: 0000: \*****************************************************************************
4131: 0000: 
4132: 0000: REM \
4133: 0000: 
4134: 0000:   STRING GLOBAL           \
4135: 0000:     SSPSCTRL.FILE.NAME$
4136: 0000: 
4137: 0000:   INTEGER*2 GLOBAL        \
4138: 0000:     SSPSCTRL.REPORT.NUM%,   \
4139: 0000:     SSPSCTRL.SESS.NUM%
4140: 0000: REM \
4141: 0000: 
4142: 0000:   STRING GLOBAL           \
4143: 0000:     SSPS.BTCSK.NUM$,      \ 3 byte, file ext number (000 - 999)
4144: 0000:     SSPS.BTCSF.NUM$,      \ 3 byte, file ext number (000 - 999)
4145: 0000:     SSPS.BTCSK.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4146: 0000:     SSPS.BTCSF.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4147: 0000:     SSPS.FILLER$          ! 68 byte, spaces
4148: 0000: 
4149: 0000:   INTEGER*2 GLOBAL        \
4150: 0000:     SSPSCTRL.RECL%
4151: 0000:  %INCLUDE BTCSDEC.J86                     ! 2.0JAS
4152: 0000: \*****************************************************************************
4153: 0000: \*****************************************************************************
4154: 0000: \***
4155: 0000: \***      %INCLUDE FOR BTCS FILE - FIELD DECLARATIONS
4156: 0000: \***                               FILE REFERENCE PARAMETERS
4157: 0000: \***
4158: 0000: \***      FILE TYPE    : DIRECT
4159: 0000: \***
4160: 0000: \***      REFERENCE    : BTCSDEC
4161: 0000: \***
4162: 0000: \***      VERSION A    : Julia Stones 22/10/03
4163: 0000: \***
4164: 0000: \*****************************************************************************
4165: 0000: \*****************************************************************************
4166: 0000: 
4167: 0000:     STRING GLOBAL        BTCS.FILE.NAME$
4168: 0000: 
4169: 0000: 
4170: 0000:     INTEGER*2 GLOBAL     BTCS.SESS.NUM%,        \
4171: 0000:                          BTCS.RECL%,            \
4172: 0000:                          BTCS.REPORT.NUM%
4173: 0000: 
4174: 0000: 
4175: 0000:     INTEGER*4 GLOBAL     BTCS.REC.NUM%
4176: 0000: 
4177: 0000: 
4178: 0000:     STRING GLOBAL        BTCS.RECORD$,           \ Whole record form file:
4179: 0000:                          BTCS.RECORD.TYPE$,      \ 1 ASC Type of record:
4180: 0000:                                                  \       "H" = header
4181: 0000:                                                  \       "D" = detail
4182: 0000:                                                  \       "T" = trailer
4183: 0000:                          BTCS.STORE.NUMBER$,     \ 4 ASC 4 digit Store number
4184: 0000:                          BTCS.STKTAKE.NUM$,      \ 4 ASC 4 digit Stock take number
4185: 0000:                          BTCS.DATE$,             \ 6 ASC Date YYMMDD
4186: 0000:                          BTCS.TIME$,             \ 6 ASC Time HHMMSS
4187: 0000:                          BTCS.DISP.AREA$,        \ 1 ASC M = MDS
4188: 0000:                                                  \       D = Dispensing
4189: 0000:                          BTCS.FILLER$,           \   ASC Set to spaces
4190: 0000:                          BTCS.NUM.RECORD$,       \ 4 ASC Record sequence number starting at 0001
4191: 0000:                          BTCS.ITEM.CODE$,        \13 ASC Item Code/PIP code
4192: 0000:                          BTCS.CODE.TYPE$,        \ 1 ASC E = EAN item code
4193: 0000:                                                  \       P = PIP code
4194: 0000:                          BTCS.PACK.QTY$,         \ 6 ASC Number of packs, bottles etc
4195: 0000:                          BTCS.DIS.UNIT.QTY$,     \ 4 ASC Dispensed unit quantity
4196: 0000:                          BTCS.RECORD.COUNT$,     \ 4 ASC Amount of records in file (inc header and trailer)
4197: 0000:                          BTCS.ENDREC$            \ 2 ASC ODOA
4198: 0000: 
4199: 0000:  %INCLUDE PRINTDEC.J86                    ! 2.0JAS
4200: 0000: 
4201: 0000: REM \
4202: 0000: \*******************************************************************************
4203: 0000: \*******************************************************************************
4204: 0000: \***
4205: 0000: \***    %INCLUDE FOR PRINT FILE VARIABLE DECLARATIONS
4206: 0000: \***
4207: 0000: \***        REFERENCE   :   PRINTDE (J86)
4208: 0000: \***
4209: 0000: \***        FILE TYPE   :   Printer / Labeller
4210: 0000: \***
4211: 0000: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
4212: 0000: \***    Original version created by merging PRINTFLG and PRINTNUG.
4213: 0000: \***
4214: 0000: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
4215: 0000: \***    Changes unknown.             
4216: 0000: \***
4217: 0000: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
4218: 0000: \***    No changes made to this file.
4219: 0000: \***
4220: 0000: \***    Version D               Andrew Wedgeworth                 24th May 1992
4221: 0000: \***    Variable added to contain condensed print record length.
4222: 0000: \***
4223: 0000: \*******************************************************************************
4224: 0000: \*******************************************************************************
4225: 0000: 
4226: 0000: 
4227: 0000:     STRING GLOBAL \
4228: 0000:         PRINT.LINE$, \
4229: 0000:         PRINT.FILE.NAME$, \
4230: 0000:         SELF.LAN.NAME$, \
4231: 0000:         SELF.NOLAN.NAME$
4232: 0000: 
4233: 0000:     INTEGER*2 GLOBAL \
4234: 0000:         PRINT.CONDENSED.RECL%, \                                       ! DAW  
4235: 0000:         PRINT.SESS.NUM%, \
4236: 0000:         PRINT.REPORT.NUM%, \
4237: 0000:         PRINT.REPORT.RECL%, \
4238: 0000:         PRINT.SELF.RECL%
4239: 0000: 
4240: 0000:  %INCLUDE SOPTSDEC.J86                    ! 2.1JAS
4241: 0000: REM \
4242: 0000: \******************************************************************************
4243: 0000: \******************************************************************************
4244: 0000: \***
4245: 0000: \***                 %INCLUDE FOR THE STORE OPTIONS FILE
4246: 0000: \***   
4247: 0000: \***                      FILE TYPE  :   Direct
4248: 0000: \***
4249: 0000: \***                      REFERENCE  :   SOPTSDEC.J86
4250: 0000: \***
4251: 0000: \***    Version A         Stuart William McConnachie      19th June 1995
4252: 0000: \***
4253: 0000: \******************************************************************************
4254: 0000: \*******************************************************************************
4255: 0000: 
4256: 0000:   STRING GLOBAL           \
4257: 0000:     SOPTS.RECORD$,        \           
4258: 0000:     SOPTS.SPACE$,         \           
4259: 0000:     SOPTS.FILE.NAME$
4260: 0000:     
4261: 0000:   INTEGER*2 GLOBAL        \
4262: 0000:     SOPTS.RECL%,          \            
4263: 0000:     SOPTS.REPORT.NUM%,    \      
4264: 0000:     SOPTS.SESS.NUM%
4265: 0000: 
4266: 0000:   INTEGER*4 GLOBAL        \
4267: 0000:     SOPTS.REC.NUM%
4268: 0000: 
4269: 0000:  %INCLUDE TSFDEC.J86                      ! 2.1JAS
4270: 0000: \*****************************************************************************
4271: 0000: \*****************************************************************************
4272: 0000: \***
4273: 0000: \***      %INCLUDE FOR TERMINAL STATUS FILE - FIELD DECLARATIONS
4274: 0000: \***                                          FILE REFERENCE PARAMETERS
4275: 0000: \***
4276: 0000: \***                      FILE TYPE    : KEYED
4277: 0000: \***
4278: 0000: \***                      REFERENCE    : TSFDEC
4279: 0000: \***
4280: 0000: \***           VERSION A : STEVEN GOULDING              13.10.92
4281: 0000: \***
4282: 0000: \***           VERSION B : STEVE WINDSOR                15.09.93
4283: 0000: \***           Updated to keep in step.
4284: 0000: \***
4285: 0000: \***           VERSION C : STUART WILLIAM MCCONNACHIE   18.03.97
4286: 0000: \***           Added extra fields in user data.
4287: 0000: \*** 
4288: 0000: \***           VERSION D : REBECCA DAKIN                22.02.99
4289: 0000: \***           Added ACSALD.CUT.OFF, as part of Cash Accounting project.
4290: 0000: \***
4291: 0000: \***           VERSION E : AMY HOGGARD                  16.10.00
4292: 0000: \***           Added TILLBAG.CUT.OFF, as part of ECO project.
4293: 0000: \***
4294: 0000: \***           VERSION F : STUART WILLIAM MCCONNACHIE   20.05.05
4295: 0000: \***           Added "new" fields as no one else can be bothered.
4296: 0000: \***           Corrected offset bug of controller ID.
4297: 0000: \***
4298: 0000: \***           VERSION G : JAMIE THORPE                 05.10.05
4299: 0000: \***           Added new INVDUE.DATE record to the store record 
4300: 0000: \***           (for Zero TSF proj.)
4301: 0000: \***           This is the date that the most recent INVDUE file
4302: 0000: \***           was created.
4303: 0000: \***
4304: 0000: \***    VERSION H               Mark Walker                      3rd Nov 2014
4305: 0000: \***    F294 PCI Phase 1
4306: 0000: \***    Includes the following changes:
4307: 0000: \***    - Removed redundant 'smartcard software level' field.
4308: 0000: \***    - Extended TSF.INDICAT2% integer field from 1 to 2 bytes.
4309: 0000: \***
4310: 0000: \*****************************************************************************
4311: 0000: \*****************************************************************************
4312: 0000: 
4313: 0000:     STRING GLOBAL               \
4314: 0000:         TSF.FILE.NAME$,         \
4315: 0000:         TSF.REC$(1),            \ One dimensional array
4316: 0000:         TSF.SECTOR.FILLER$,     \
4317: 0000:         TSF.SECTOR.INFO$
4318: 0000:         
4319: 0000:     INTEGER*1 GLOBAL            \
4320: 0000:         TSF.REC.SUB%            ! Subscript used with TSF.REC array
4321: 0000: 
4322: 0000:     INTEGER*2 GLOBAL            \
4323: 0000:         TSF.SESS.NUM%,          \
4324: 0000:         TSF.RECL%,              \
4325: 0000:         TSF.REPORT.NUM%,        \
4326: 0000:         TSF.SECTOR.NUM%
4327: 0000: 
4328: 0000:     STRING GLOBAL               \
4329: 0000:         TSF.TERM.STORE$,        \ 2 byte UPD.Terminal number or 
4330: 0000:                                 \ 9999 for store (key)
4331: 0000:         TSF.TSL.NAME$,          \ 8 bytes. Most recent old TSL file
4332: 0000:         TSF.MONITOR$,           \ 2 byte UPD last monitoring terminal
4333: 0000:         TSF.TLOGFLAG$,          \ 1 byte, EALLGHC processed flag
4334: 0000:         TSF.OPERATOR$,          \ Operator number
4335: 0000:         TSF.TRANSNUM$,          \ Most recent transaction
4336: 0000:         TSF.RCPSTATUS$,         \ Store close requested through RCF                                                             
4337: 0000:         TSF.SIGN.OFF.DELAY$,    \ 1 byte PD counter to auto sign off    \  !CSWM
4338: 0000:         TSF.USER$,              \ User data
4339: 0000:         TSF.CONTROLLER$,        \ Controller ID
4340: 0000:         TSF.INVDUE.DATE$,       \ Creation date of the INVDUE
4341: 0000:                                 \ (Updated by PSS33)                    \   !GJT
4342: 0000:         TSF.SPACE$              ! 34 bytes or 14 bytes
4343: 0000: 
4344: 0000:     INTEGER*1 GLOBAL            \
4345: 0000:         TSF.INDICAT0%,          \ Indicator byte 0
4346: 0000:         TSF.INDICAT1%,          \ Indicator byte 1
4347: 0000: \       TSF.INDICAT2%,          \ Indicator byte 2                      \   !HMW
4348: 0000:         TSF.MTSL.CUT.OFF%,      \ MTSL cut-off required flag            \  !CSWM
4349: 0000:         TSF.CUSTD.CUT.OFF%,     \ CUSTD cut-off required flag           \  !CSWM
4350: 0000:         TSF.ACSAL.CUT.OFF%,     \ ACSAL cut-off required flag               !DRD
4351: 0000:         TSF.TILLBAG.CUT.OFF%    ! TILLBAG cut-off required flag             !EAH
4352: 0000:     
4353: 0000:     INTEGER*2 GLOBAL            \
4354: 0000: \       TSF.SC.LEVEL%           ! Smartcard software level              \   !HMW
4355: 0000:         TSF.INDICAT2%           ! Indicator flags 2                         !HMW
4356: 0000: 
4357: 0000:     INTEGER*4 GLOBAL            \
4358: 0000:         TSF.GROSSPOS,           \ Gross plus
4359: 0000:         TSF.GROSSNEG,           \ Gross minus
4360: 0000:         TSF.NETCASH,            \ Net cash
4361: 0000:         TSF.NETNCASH,           \ Net non-cash
4362: 0000:         TSF.AMTLOAN,            \ Loans
4363: 0000:         TSF.AMTPICKU,           \ Withdrawals
4364: 0000:         TSF.AMTCASHC,           \ Cash count
4365: 0000:         TSF.NETCCURR,           \ Net cash currency face value
4366: 0000:         TSF.NETCCCURR           ! Net cash count currency face value
4367: 0000: 
4368: 0000:  %INCLUDE LOCALDEC.J86                    ! 2.1JAS
4369: 0000: \***********************************************************************
4370: 0000: \***********************************************************************
4371: 0000: \***
4372: 0000: \***    DESCRIPTION: Local Price File
4373: 0000: \***                 Field Definitions
4374: 0000: \***
4375: 0000: \***    FILE TYPE : Keyed
4376: 0000: \***
4377: 0000: \***********************************************************************
4378: 0000: \***
4379: 0000: \***    Version A.          Paul Flanagan                1st Jul 1993
4380: 0000: \***    Initial version.
4381: 0000: \***
4382: 0000: \***    Version B.          Clive Norris                24th Nov 1993
4383: 0000: \***    AUTH.NUM$, STOCK.FIG$ and RETRIEVAL.FLAG$ replaced filler as
4384: 0000: \***    part of the RETURNS/AUTOMATIC CREDIT CLAIMING package.
4385: 0000: \***
4386: 0000: \***    Version C.          Mick Bayliss                 6th Dec 1994
4387: 0000: \***    Added missing field.
4388: 0000: \***
4389: 0000: \***    Version D.          Mark Walker                  1st Jul 2015
4390: 0000: \***    F392 Retail Stock 5
4391: 0000: \***    Added key length field.
4392: 0000: \***
4393: 0000: \***********************************************************************
4394: 0000: \***********************************************************************
4395: 0000: 
4396: 0000:     STRING GLOBAL             \
4397: 0000:         LOCAL.AUTH.NUM$,      \ 4 bytes UPD Auth'n number
4398: 0000:                               \             from Business Centre.
4399: 0000:         LOCAL.END.DATE$,      \ 3 bytes UPD yymmdd.
4400: 0000:         LOCAL.FILE.NAME$,     \
4401: 0000:         LOCAL.H.O.PRICE$,     \ 5 byte UPD.
4402: 0000:         LOCAL.HO.CHANGE$,     \ 3 bytes UPD. Date of HO price change
4403: 0000:                               \ (this will be zero if no change since
4404: 0000:                               \ local price was initiated).
4405: 0000:         LOCAL.ITEM.CODE$,     \ 4 bytes UPD (key) Boots code 
4406: 0000:                               \                   with check digit. 
4407: 0000:         LOCAL.OPERATOR$,      \ 4 bytes UPD operator id (when set up).
4408: 0000:         LOCAL.PRICE$,         \ 5 bytes UPD.
4409: 0000:         LOCAL.REASON$,        \ 4 byte ASCII 
4410: 0000:         LOCAL.RETRIEVAL.FLAG$,\ 1 byte ASC "Y" or "N"  
4411: 0000:         LOCAL.SPACE$,         \                                            !CMJB
4412: 0000:         LOCAL.START.DATE$,    \ 3 bytes UPD yymmdd. 
4413: 0000:         LOCAL.START.TIME$     ! 2 bytes UPD hhmm.
4414: 0000:         
4415: 0000:     INTEGER*2 GLOBAL          \
4416: 0000:         LOCAL.KEYL%,          \                                             !DMW
4417: 0000:         LOCAL.RECL%,          \
4418: 0000:         LOCAL.REPORT.NUM%,    \
4419: 0000:         LOCAL.SESS.NUM%,      \
4420: 0000:         LOCAL.STOCK.FIG%      !  No. of items authorised at the price.
4421: 0000: 
4422: 0000:  %INCLUDE CCREJDEC.J86                    ! 1.2JAS
4423: 0000: REM \
4424: 0000: \******************************************************************************
4425: 0000: \******************************************************************************
4426: 0000: \***
4427: 0000: \***      %INCLUDE FOR CREDIT CLAIMING REJECT FILE FIELD DECLARATIONS
4428: 0000: \***                                          FILE REFERENCE PARAMETERS
4429: 0000: \***
4430: 0000: \***               FILE TYPE    : Sequential
4431: 0000: \***
4432: 0000: \***               REFERENCE    : CCREJDEC.J86
4433: 0000: \***
4434: 0000: \***      Version A.     Julia Stones           11th March 2004.
4435: 0000: \***
4436: 0000: \******************************************************************************
4437: 0000: \*******************************************************************************
4438: 0000: \***
4439: 0000: \***
4440: 0000: \***
4441: 0000: \******************************************************************************
4442: 0000: 
4443: 0000:   STRING GLOBAL              \
4444: 0000:     CCREJ.FILE.NAME$,        \
4445: 0000:     CCREJC.FILE.NAME$,       \
4446: 0000:     CCREJP.FILE.NAME$,       \
4447: 0000:     CCREJ.RECORD$,           \ Used to store the whole record which is unstrung
4448: 0000:                              \ into the fields below
4449: 0000:     CCREJ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
4450: 0000:     CCREJ.DATE$,             \ 8 byte ASCII
4451: 0000:     CCREJ.RETURN.REASON$,    \ 2 byte ASCII
4452: 0000:     CCREJ.BC.LETTER$,        \ 1 byte ASCII
4453: 0000:     CCREJ.UOD.NUM$,          \ 14 byte ASCII
4454: 0000:     CCREJ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
4455: 0000:               \                             "B" = Barcode.
4456: 0000:     CCREJ.ITEM.BARCODE$,     \ 12 byte ASCII
4457: 0000:     CCREJ.DESC$,             \ 24 byte ASCII
4458: 0000:     CCREJ.ITEM.BC$,          \ 1 byte ASCII
4459: 0000:     CCREJ.ITEM.QTY$,         \ 4 byte ASCII
4460: 0000:     CCREJ.REJECT.REASON$     ! 1 byte ASCII "1" = Item not on file
4461: 0000:                              !              "2" = Credit Claim not allowed against this
4462: 0000:                              !                    Business Centre
4463: 0000:                              !              "3" = Item does not belong to Business Centre
4464: 0000:                              !                    being claimed against
4465: 0000: 
4466: 0000: 
4467: 0000:   INTEGER*2 GLOBAL           \
4468: 0000:     CCREJ.RECL%,             \
4469: 0000:     CCREJC.RECL%,            \
4470: 0000:     CCREJP.RECL%,            \
4471: 0000:     CCREJC.SESS.NUM%,        \
4472: 0000:     CCREJP.SESS.NUM%,        \
4473: 0000:     CCREJ.SESS.NUM%,         \
4474: 0000:     CCREJC.REPORT.NUM%,      \
4475: 0000:     CCREJP.REPORT.NUM%,      \
4476: 0000:     CCREJ.REPORT.NUM%
4477: 0000: 
4478: 0000: 
4479: 0000:  %INCLUDE RBDEC.J86                       ! 2.6BG
4480: 0000: \/******************************************************************/
4481: 0000: \/*                                                                */
4482: 0000: \/* Recalls Buffer FILE GLOBAL VARIABLE DECLARATIONS               */
4483: 0000: \/*                                                                */
4484: 0000: \/* REFERENCE   : RBDEC.J86                                        */
4485: 0000: \/*                                                                */
4486: 0000: \/* VERSION A.          Brian Greenfield        11th may 2007      */
4487: 0000: \/*                                                                */
4488: 0000: \/******************************************************************/
4489: 0000: 
4490: 0000:    STRING GLOBAL                \
4491: 0000:       RB.FILE.NAME$,            \
4492: 0000:                                 \
4493: 0000:       RB.RCD$,                  \  ? bytes  (25/14/12)
4494: 0000:       RB.REC.TYPE$,             \  1 byte   (H/D/T)
4495: 0000:       RB.REFERENCE$,            \  8 bytes
4496: 0000:       RB.LABEL$,                \ 14 bytes (8 bytes label type)
4497: 0000:                                 \          (6 bytes label number)
4498: 0000:       RB.ITEM.CODE$,            \  7 bytes (with check digit)
4499: 0000:       RB.STOCK.COUNT$,          \  4 bytes (1 - 9999)
4500: 0000:       RB.ITEM.COUNT$,           \  5 bytes (1 - 99999)
4501: 0000:       RB.RECORD.COUNT$          !  4 bytes (1 - 9999 inc header and trailer)
4502: 0000: 
4503: 0000:    INTEGER*2 GLOBAL             \
4504: 0000:       RB.REPORT.NUM%,           \
4505: 0000:       RB.SESS.NUM%              !
4506: 0000: 
4507: 0000: \/******************************************************************/
4508: 0000:  %INCLUDE REWKFDEC.J86                    ! 2.6BG
4509: 0000: \/******************************************************************/
4510: 0000: \/*                                                                */
4511: 0000: \/* Recalls Work FILE GLOBAL VARIABLE DECLARATIONS                 */
4512: 0000: \/*                                                                */
4513: 0000: \/* REFERENCE   : REWKFDEC.J86                                     */
4514: 0000: \/*                                                                */
4515: 0000: \/* VERSION A.          Brian Greenfield        11th may 2007      */
4516: 0000: \/*                                                                */
4517: 0000: \/* VERSION B.          Brian Greenfield        15th April 2008    */
4518: 0000: \/*                                                                */
4519: 0000: \/* VERSION C.          Brian Greenfield        6th May 2008       */
4520: 0000: \/*                                                                */
4521: 0000: \/******************************************************************/
4522: 0000: 
4523: 0000:    STRING GLOBAL                \
4524: 0000:       REWKF.FILE.NAME$,         \
4525: 0000:                                 \
4526: 0000:       REWKF.RCD$,               \  ? bytes  (25/47/8)
4527: 0000:       REWKF.REC.TYPE$,          \  1 byte   (H/D/T)
4528: 0000:       REWKF.REFERENCE$,         \  8 bytes
4529: 0000:       REWKF.LABEL$,             \ 14 bytes (8 bytes label type)
4530: 0000:                                 \          (6 bytes label number - zero's)
4531: 0000:       REWKF.BATCH.TYPE$,        \  1 byte  (E/F/R/S/W/X/I/C) !BBG
4532: 0000:       REWKF.MRQ$,               \  2 bytes ASCII !CBG
4533: 0000:       REWKF.DUE.BY.DATE$,       \  8 bytes (YYYYMMDD) !BBG
4534: 0000:       REWKF.BARCODE$,           \ 13 bytes (with check digit)
4535: 0000:       REWKF.ITEM.CODE$,         \  7 bytes (with check digit)
4536: 0000:       REWKF.DESCRIPTION$,       \ 20 bytes (truncated from the IDF)
4537: 0000:       REWKF.TSF$,               \  4 bytes (1 - 9999 or SPACES for recall types F, S, & X)
4538: 0000:       REWKF.ITEM.COUNT$         !  5 bytes (1 - 99999)
4539: 0000:       
4540: 0000:    INTEGER*2 GLOBAL             \
4541: 0000:       REWKF.REPORT.NUM%,        \
4542: 0000:       REWKF.SESS.NUM%           !
4543: 0000: 
4544: 0000: \/******************************************************************/
4545: 0000:  %INCLUDE RECALDEC.J86                    ! 2.6BG
4546: 0000: \******************************************************************************
4547: 0000: \******************************************************************************
4548: 0000: \***
4549: 0000: \***         INCLUDE FOR RECALLS.BIN DECLARATIONS
4550: 0000: \***
4551: 0000: \***               FILE TYPE    : Keyed
4552: 0000: \***
4553: 0000: \***               REFERENCE    : RECALDEC.J86
4554: 0000: \***
4555: 0000: \***    VERSION A               BRIAN GREENFIELD                    14th May 2007
4556: 0000: \***    Initial Version
4557: 0000: \***
4558: 0000: \***    Version B               BRIAN GREENFIELD                    20th June 2007
4559: 0000: \***    Altered due to a change in the file layout.
4560: 0000: \***
4561: 0000: \*******************************************************************************
4562: 0000: \*******************************************************************************
4563: 0000: 
4564: 0000:   STRING GLOBAL                \
4565: 0000:     RECALLS.FILE.NAME$,        \
4566: 0000:                                \
4567: 0000:     RECALLS.REFERENCE$,        \ 8 bytes UPD  - Key is reference + RECALLS.CHAIN%
4568: 0000:     RECALLS.TYPE$,             \ 1 byte  ASC  - E = Emergency
4569: 0000:                                \                F = Batch Emergency
4570: 0000:                                \                G = generic items not authorised for sale
4571: 0000:                                \                R = 100% Returns
4572: 0000:                                \                S = Batch 100% Returns
4573: 0000:                                \                W = Withdrawn
4574: 0000:                                \                X = batch Withdrawn
4575: 0000:     RECALLS.DESCRIPTION$,      \ 20 bytes ASC
4576: 0000:     RECALLS.LABEL.TYPE$,       \ 8 bytes ASC
4577: 0000:     RECALLS.SUPPLY.ROUTE$,     \ 1 byte ASC
4578: 0000:     RECALLS.REASON.CODE$,      \ 1 byte ASC
4579: 0000:     RECALLS.BC$,               \ 1 byte ASC
4580: 0000:     RECALLS.ACTIVE.DATE$,      \ 8 bytes ASC  - YYYYMMDD
4581: 0000:     RECALLS.DUE.BY.DATE$,      \ 8 bytes ASC  - YYYYMMDD
4582: 0000:     RECALLS.COMPLETION.DATE$,  \ 8 bytes ASC  - YYYYMMDD
4583: 0000:     RECALLS.STATUS$,           \ 1 byte ASC   - N = Not Actioned, A = Actioned, P = Partially Actioned
4584: 0000:     RECALLS.BATCH.NUM$,        \ 30 bytes ASC
4585: 0000:     RECALLS.ITEM.COUNT$,       \ 4 bytes ASC  - Total count of items in this recall
4586: 0000:                                \
4587: 0000:                                \ The following 8 bytes are repeated for the number of items in this part
4588: 0000:                                \ of the recall chain - up to 50 items per chain.
4589: 0000:     RECALLS.ITEM.CODE$(1),     \ 4 bytes PD   - 6 digit Item Code
4590: 0000:     RECALLS.ITEM.STOCK$(1),    \ 2 bytes PD   - SPACES if not yet actioned                         !BBG
4591: 0000:     RECALLS.SESS.STOCK$(1),    \ 2 bytes PD   - 4 digit session stock count - used only by the PPC !BBG
4592: 0000:     RECALLS.ITEM.UPT.FLAG$(1), \ 1 byte ASC   - used by the PPC only - Y = actioned, N - reset, space = unactioned
4593: 0000:                                \
4594: 0000:     RECALLS.FILLER$            !
4595: 0000:     
4596: 0000:   INTEGER*1 GLOBAL             \
4597: 0000:     RECALLS.CHAIN%
4598: 0000:     
4599: 0000:   INTEGER*2 GLOBAL             \
4600: 0000:     RECALLS.RECL%,             \
4601: 0000:     RECALLS.KEYL%,             \
4602: 0000:     RECALLS.REPORT.NUM%,       \
4603: 0000:     RECALLS.SESS.NUM%,         \
4604: 0000:     RECALLS.MAX.REC.ITEMS%
4605: 0000: 
4606: 0000: 
4607: 0000:  %INCLUDE DELVIDEC.J86                    ! 2.7SH
4608: 0000: \/******************************************************************/
4609: 0000: \/*                                                                */
4610: 0000: \/* DELVINDX FILE GLOBAl VARIABLE DECLARATIONS                     */
4611: 0000: \/*                                                                */
4612: 0000: \/* REFERENCE   : DELVIDEC.J86                                     */
4613: 0000: \/*                                                                */
4614: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
4615: 0000: \/*                                                                */
4616: 0000: \/* VERSION B.          Stuart Highley               18 Dec 2008   */
4617: 0000: \/* Make file fixed rec length.                                    */
4618: 0000: \/******************************************************************/
4619: 0000: 
4620: 0000:    STRING GLOBAL                    \
4621: 0000:       DELVINDX.FILE.NAME$,          \
4622: 0000:       DELVINDX.FILLER$,             \
4623: 0000:       DELVINDX.ASN.NUM$,            \
4624: 0000:       DELVINDX.ASN.CARTON.COUNT$,   \
4625: 0000:       DELVINDX.UOD.LICENCE$,        \
4626: 0000:       DELVINDX.UOD.DESPATCH.DATE$,  \
4627: 0000:       DELVINDX.UOD.BOL.FLAG$,       \
4628: 0000:       DELVINDX.UOD.SEQ$,            \
4629: 0000:       DELVINDX.UOD.PARENT$,         \
4630: 0000:       DELVINDX.UOD.TYPE$,           \
4631: 0000:       DELVINDX.UOD.EXP.DEL.DATE$
4632: 0000: 
4633: 0000:    INTEGER*2 GLOBAL             \
4634: 0000:       DELVINDX.REPORT.NUM%,     \
4635: 0000:       DELVINDX.SESS.NUM%
4636: 0000: 
4637: 0000: \/******************************************************************/
4638: 0000:  %INCLUDE UODOTDEC.J86                    ! 2.7SH
4639: 0000: \*******************************************************************************
4640: 0000: \***
4641: 0000: \***    UOD Outers FILE GLOBAl VARIABLE DECLARATIONS
4642: 0000: \***
4643: 0000: \***    REFERENCE   : UODOTDEC.J86
4644: 0000: \***
4645: 0000: \***    VERSION A.              Stuart Highley                  14th Jul 2008
4646: 0000: \***
4647: 0000: \***    VERSION B.              Mark Goode                      10th Dec 2008
4648: 0000: \***    Add summary record read/write functionality.
4649: 0000: \***
4650: 0000: \***    REVISION 1.8.           Robert Cowey                    14th Jan 2009
4651: 0000: \***    Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
4652: 0000: \***    No new variables but defined new function UODOT.REC$.
4653: 0000: \***
4654: 0000: \***    VERSION C.              Mark Walker                     18th Feb 2015
4655: 0000: \***    F391 HUMSS UOD Messaging
4656: 0000: \***    Includes the following changes:
4657: 0000: \***    - Defined UOD number field.
4658: 0000: \***    - Various coding standards related changes (uncommented).
4659: 0000: \***
4660: 0000: \*******************************************************************************
4661: 0000: 
4662: 0000:     STRING GLOBAL                                                       \
4663: 0000:         UODOT.AUDIT.OP.ID$,                                             \
4664: 0000:         UODOT.BOOKED.DATE$,                                             \
4665: 0000:         UODOT.BOOKED.TIME$,                                             \
4666: 0000:         UODOT.CHILD.LICENCE$(1),                                        \
4667: 0000:         UODOT.CHILD.TYPE$(1),                                           \
4668: 0000:         UODOT.DESPATCH.DATE$,                                           \
4669: 0000:         UODOT.DRVR.DEL.DATE$,                                           \
4670: 0000:         UODOT.DRVR.DEL.TIME$,                                           \
4671: 0000:         UODOT.DRVR.ID$,                                                 \
4672: 0000:         UODOT.EST.DEL.DATE$,                                            \
4673: 0000:         UODOT.FILE.NAME$,                                               \
4674: 0000:         UODOT.FILLER$,                                                  \
4675: 0000:         UODOT.IMMEDIATE.PARENT$,                                        \
4676: 0000:         UODOT.LEVEL$,                                                   \
4677: 0000:         UODOT.LICENCE$,                                                 \
4678: 0000:         UODOT.OPEN.FLAG$,                                               \
4679: 0000:         UODOT.REASON$,                                                  \
4680: 0000:         UODOT.STATUS$,                                                  \
4681: 0000:         UODOT.STORE.OP.ID$,                                             \
4682: 0000:         UODOT.SUMMARY.STATUS$,                                          \   !BMG
4683: 0000:         UODOT.TYPE$,                                                    \
4684: 0000:         UODOT.ULTIMATE.PARENT$,                                         \
4685: 0000:         UODOT.UOD.NUMBER$,                                              \   !CMW
4686: 0000:         UODOT.WAREHOUSE.AREA$
4687: 0000: 
4688: 0000:     INTEGER*1 GLOBAL                                                    \
4689: 0000:         UODOT.BOL,                                                      \
4690: 0000:         UODOT.SDPD
4691: 0000: 
4692: 0000:     INTEGER*2 GLOBAL                                                    \
4693: 0000:         UODOT.AUDITED,                                                  \
4694: 0000:         UODOT.AUTO,                                                     \
4695: 0000:         UODOT.BOOKED,                                                   \
4696: 0000:         UODOT.CONTROLLER,                                               \
4697: 0000:         UODOT.GIT.MISMATCH,                                             \
4698: 0000:         UODOT.KEYL%,                                                    \
4699: 0000:         UODOT.MAX.CHILDREN%,                                            \
4700: 0000:         UODOT.MC70,                                                     \
4701: 0000:         UODOT.NUM.CHILDREN%,                                            \
4702: 0000:         UODOT.NUM.ITEMS%,                                               \
4703: 0000:         UODOT.PARTIAL,                                                  \
4704: 0000:         UODOT.PDT,                                                      \
4705: 0000:         UODOT.RECL%,                                                    \
4706: 0000:         UODOT.REPORT.NUM%,                                              \
4707: 0000:         UODOT.RF,                                                       \
4708: 0000:         UODOT.SEQ%,                                                     \
4709: 0000:         UODOT.SESS.NUM%,                                                \
4710: 0000:         UODOT.STOCK.UPDATED
4711: 0000: 
4712: 0000:  %INCLUDE AFDEC.J86                       ! 2.7SH
4713: 0000: 
4714: 0000: \REM
4715: 0000: \*******************************************************************************
4716: 0000: \*******************************************************************************
4717: 0000: \***
4718: 0000: \***    %INCLUDE FOR GSA AUTHORISATION FILE VARIABLE DECLARATIONS
4719: 0000: \***
4720: 0000: \***        REFERENCE   :  AFDEC (J86)
4721: 0000: \***
4722: 0000: \***        FILE TYPE   :  Keyed
4723: 0000: \***
4724: 0000: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
4725: 0000: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
4726: 0000: \***
4727: 0000: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
4728: 0000: \***    Original version created by merging AFFLDD and AFNUMD.
4729: 0000: \***
4730: 0000: \***    VERSION B.              Steve Windsor                          Nov 1992.
4731: 0000: \***    Addition of new fields for the CASTLE project.
4732: 0000: \***    Supervisor flag and operator model.
4733: 0000: \***
4734: 0000: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
4735: 0000: \***    Defined fields DATE.PSWD.CHANGE$, and MODEL.FLAGS.1% and ...2%.
4736: 0000: \***
4737: 0000: \***    VERSION D.             Mike Bishop                          30 JUN 2004
4738: 0000: \***    Defined field AF.STAFF.NUM$ AF.EMPLOYEE.FLAG$
4739: 0000: \***
4740: 0000: \***    VERSION E.             Alan Carr  (AJC)                      4 Oct 2004
4741: 0000: \***    Defined field AF.RECEIPT.NAME$
4742: 0000: \***
4743: 0000: \***    VERSION F.             Alan Carr  (AJC)                     31 Jan 2005
4744: 0000: \***    Defined field AF.GROUP.CODE$
4745: 0000: \***
4746: 0000: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
4747: 0000: \***    Changes for A9C POS improvements project.
4748: 0000: \***    Used up last available three bytes of EALAUTH user data by redefining 
4749: 0000: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
4750: 0000: \***    See IBM manual "GSA Programming Guide" Appendix A-27 for file layout 
4751: 0000: \***    describing INDICAT flags (and position of original 20 bytes user data).
4752: 0000: \***
4753: 0000: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
4754: 0000: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
4755: 0000: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format as UPD-hex DDMCYY.
4756: 0000: \***    Description text change only - No code changes to this file.
4757: 0000: \***
4758: 0000: \*******************************************************************************
4759: 0000: \*******************************************************************************
4760: 0000: 
4761: 0000: 
4762: 0000:     STRING GLOBAL \
4763: 0000:         AF.BIRTH.DATE$,       \ ! 3 byte DDMCYY UPD/hex format         ! 1.7 RC
4764: 0000:                               \ ! M is month  A=Oct B=Nov C=Dec        ! 1.7 RC
4765: 0000:                               \ ! C is century  0=19xx 1=20xx          ! 1.7 RC
4766: 0000:         AF.DATE.PSWD.CHANGE$, \ ! 3 bytes UPD                          ! CRC
4767: 0000:         AF.FILE.NAME$, \
4768: 0000:         AF.FLAGS.01.12$, \      ! 15 bytes
4769: 0000:         AF.FLAGS.13.16$, \      ! 4 bytes
4770: 0000:         AF.OPERATOR.NAME$,\     ! 20 bytes
4771: 0000:         AF.OPERATOR.NO$, \      ! 4 byte UPD (key)
4772: 0000:         AF.OPTIONS.KEY$, \      ! 1 byte UPD
4773: 0000:         AF.PASSWORD$, \         ! 4 byte UPD
4774: 0000:         AF.RECEIPT.NAME$, \     ! 12 bytes                             ! AJC
4775: 0000:         AF.STAFF.NUM$, \         ! 4 byte UPD                          DMB
4776: 0000:         AF.EMPLOYEE.FLAG$, \     ! 1 byte UPD                          DMB
4777: 0000:         AF.GROUP.CODE$, \       ! 1  byte UPD                          AJC
4778: 0000: \       AF.USER$, \             ! 3  bytes                             ! 1.6 RC
4779: 0000:         AF.SUP.FLAG$, \         ! 1  byte                              BSJW
4780: 0000:         AF.OP.MODEL$            ! 3  bytes                             BSJW
4781: 0000: 
4782: 0000:     INTEGER*1 GLOBAL \
4783: 0000:         AF.INDICAT4%, \
4784: 0000:         AF.INDICAT5%, \
4785: 0000:         AF.INDICAT6%, \
4786: 0000:         AF.INDICAT7%, \
4787: 0000:         AF.INDICAT8%, \
4788: 0000:         AF.INDICAT9%, \
4789: 0000:         AF.INDICAT10%, \
4790: 0000:         AF.INDICAT11%, \
4791: 0000:         AF.INDICAT12%, \
4792: 0000:         AF.INDICAT13%, \
4793: 0000:         AF.INDICAT14%, \
4794: 0000:         AF.INDICAT15%, \
4795: 0000:         AF.INDICAT16%, \
4796: 0000:         AF.REPORT.NUM%
4797: 0000: 
4798: 0000:     INTEGER*2 GLOBAL \
4799: 0000:         AF.INDICAT1%, \
4800: 0000:         AF.INDICAT2%, \
4801: 0000:         AF.INDICAT3%, \
4802: 0000:         AF.MODEL.FLAGS.1%, \                                           ! CRC
4803: 0000:         AF.MODEL.FLAGS.2%, \                                           ! CRC
4804: 0000:         AF.RECL%, \
4805: 0000:         AF.SESS.NUM%
4806: 0000: 
4807: 0000:  %INCLUDE UBDEC.J86                       ! 2.7SH
4808: 0000: \/******************************************************************/
4809: 0000: \/*                                                                */
4810: 0000: \/* UOD Banked FILE GLOBAL VARIABLE DECLARATIONS                   */
4811: 0000: \/*                                                                */
4812: 0000: \/* REFERENCE   : UBDEC.J86                                        */
4813: 0000: \/*                                                                */
4814: 0000: \/* VERSION A.          Stuart Highley            14 August 2008   */
4815: 0000: \/                                                                 */
4816: 0000: \/* VERSION B.          Charles Skadorwa          9 October 2008   */
4817: 0000: \/*                                                                */
4818: 0000: \/* VERSION C.          Stuart Highley            16 December 2008 */
4819: 0000: \/* Look carefully below and ye shall find my change.              */
4820: 0000: \/*                                                                */
4821: 0000: \/* VERSION D.          Mark Goode                22nd December 08 */
4822: 0000: \/* Changes to the fields on the audit record                      */
4823: 0000: \/******************************************************************/
4824: 0000: 
4825: 0000:    STRING GLOBAL                \
4826: 0000:       UB.TEMP.NAME$,            \
4827: 0000:       UB.FILE.NAME$,            \
4828: 0000:       UB.REC$,                  \
4829: 0000:       UB.REC.TYPE$,             \
4830: 0000:       UB.OP.ID$,                \
4831: 0000:       UB.METHOD$,               \
4832: 0000:       UB.REPORT.RQD$,           \
4833: 0000:       UB.LICENCE$,              \
4834: 0000:       UB.DESPATCH.DATE$,        \
4835: 0000:       UB.BOOKED.DATE$,          \
4836: 0000:       UB.BOOKED.TIME$,          \
4837: 0000:       UB.BOOK.TYPE$,            \
4838: 0000:       UB.BAR.CODE$,             \
4839: 0000:       UB.QTY$,                  \
4840: 0000:       UB.DRVR.ID$,              \
4841: 0000:       UB.DRVR.CHCK.DATE$,       \
4842: 0000:       UB.DRVR.CHCK.TIME$,       \
4843: 0000:       UB.DRVR.GIT.MATCH$,       \
4844: 0000:       UB.REC.COUNT$,            \
4845: 0000:       UB.ONIGHT.DELIVERY.TYPE$, \                                !BCSk
4846: 0000:       UB.DRIVER.CHECKIN.REQD$,  \                                !BCSk
4847: 0000:       UB.DRVR.REJECTED$,        \ "Y" or "N" on batch rec,       !CSH
4848: 0000:                                 \ " " on session rec             !CSH
4849: 0000:       UB.DRVR.CONFIRM.SCAN$,    \                                !BCSk
4850: 0000:       UB.BOOKED.STATUS$                                          !DMG
4851: 0000:       
4852: 0000:    INTEGER*2 GLOBAL             \
4853: 0000:       UB.RECL%,                 \
4854: 0000:       UB.REPORT.NUM%,           \
4855: 0000:       UB.SESS.NUM%
4856: 0000: 
4857: 0000: \/******************************************************************/
4858: 0000:  
4859: 0000: \*****************************************************************************
4860: 0000: \*****************************************************************************
4861: 0000: \***                                                                       ***
4862: 0000: \***      V A R I A B L E   D E C L A R A T I O N S                        ***
4863: 0000: \***                                                                       ***
4864: 0000: \*****************************************************************************
4865: 0000: \*****************************************************************************
4866: 0000: 
4867: 0000: INTEGER*1 GLOBAL                          \
4868: 0000:         ASN.ACTIVE%,                      \ 2.5NWB
4869: 0000:         BC.CHECK%(1),                     \ FLC
4870: 0000:         ERROR.COUNT%,                     \
4871: 0000:         REC.MAX%,                         \
4872: 0000:         LDT.TRANSMIT,                     \ HDS
4873: 0000:         NESTING.LEVEL%,                   \ FLC
4874: 0000:         TRUE,                             \ HDS
4875: 0000:         FALSE,                            \ HDS
4876: 0000:         PORT.EVENT%,                      \ FLC
4877: 0000:         RE.CHAIN,                         \ DSW
4878: 0000:         WARM.START,                       \ DSW
4879: 0000:         GAP,                              \ GMJK
4880: 0000:         CCBUF.ENTRY.REQUIRED,             \ GMJK
4881: 0000:         CCBUF.RECS.PRESENT,               \ GMJK
4882: 0000:         CCREJ.RECS.PRESENT,               \ 2.2JAS
4883: 0000:         DETAIL.RECORDS.RECEIVED,          \ GMJK
4884: 0000:         END.OF.CCTMP,                     \ GMJK
4885: 0000:         END.OF.FILE,                      \ GMJK
4886: 0000:         TABLE.FULL,                       \ GMJK
4887: 0000:         REWKF.RECS.PRESENT,               \ 2.6BG
4888: 0000:         ALL.PRODUCTS                      ! 1.8DA
4889: 0000: \       ALLOW.CSR.PROCESSING              ! 1.2 !2.5NWB
4890: 0000: 
4891: 0000: INTEGER*2 GLOBAL                          \
4892: 0000:         ACTUAL.NUM.OF.UODS%,              \ FLC
4893: 0000:         BTSCNT%,                          \2.3CS
4894: 0000:         EANCNT%,                          \2.3CS
4895: 0000:         COUNTED.ITEMS%,                   \ FLC
4896: 0000: \       CSR.ITEMS.COUNT%,                 \     !2.5NWB
4897: 0000:         CSR.AUDIT.SESS.NUM%,              \ CDS
4898: 0000:         CURRENT.REPORT.NUM%,              \ DLC
4899: 0000:         EXPECTED.NUM.OF.UODS%,            \ FLC
4900: 0000:         FILE.HEADER.LISTS%,               \ FLC
4901: 0000:         FILE.TRAILER.LISTS%,              \ FLC
4902: 0000:         FIRST.TIME,                       \ CDS
4903: 0000:         ORDERS.EXPECTED%,                 \ CDS
4904: 0000:         INT.DELAY%,                       \ FLC
4905: 0000:         ITEMS.BOOKED.IN%,                 \ CDS
4906: 0000:         ITEM.COUNT%,                      \ FLC
4907: 0000:         LINES.BOOKED.IN%,                 \ CDS
4908: 0000:         LINES.ADDED%,                     \ CDS
4909: 0000:         LINE.TOTAL%,                      \ CDS
4910: 0000:         LIST.COUNT%,                      \ FLC
4911: 0000:         LIST.TRAILER.ITEMS%,              \ FLC
4912: 0000:         ONORD.COUNT%,                     \
4913: 0000:         ORDERS.FOUND%,                    \ CDS
4914: 0000:         RC%,                              \ DLC
4915: 0000:         SINGLES.ADDED%,                   \ CDS
4916: 0000:         TYPE.17.WRITTEN,                  \ CDS
4917: 0000:         UOD.NUM.ITEMS%,                   \ FLC
4918: 0000:         ACTUAL.NUM%,                      \ GMJK
4919: 0000:         ACTUAL.UOD.ITEMS%,                \ GMJK
4920: 0000:         CURR.ITEM%,                       \ GMJK
4921: 0000:         CURR.REC%,                        \ GMJK
4922: 0000:         CURR.SUBSCRIPT%,                  \ GMJK
4923: 0000:         EXPECTED.NUM%,                    \ GMJK
4924: 0000:         FILE.NUM%,                        \ GMJK
4925: 0000:         ITEM.POS%,                        \ GMJK
4926: 0000:         MAX.TABLE.SIZE%,                  \ GMJK
4927: 0000:         NUM.BARCODES%,                    \ GMJK
4928: 0000:         NUM.BC.EXTRACTED%,                \ GMJK
4929: 0000:         NUM.ITEMS%,                       \ GMJK
4930: 0000:         NUM.STATUS.O.C.X.UODS%,           \ 1.4
4931: 0000:         NUM.OF.CANCELLED.UODS%,           \ 1.4
4932: 0000:         NUM.OF.DESPATCHED.UODS%,          \ 1.4
4933: 0000:         NUM.RECORDS%,                     \ GMJK
4934: 0000:         RECORD$,                          \ GMJK
4935: 0000:         REC.NUM%,                         \ GMJK
4936: 0000:         RECS.PER.SECTOR%,                 \ GMJK
4937: 0000:         BC%,CG%,PG%,                      \ 1.8DA
4938: 0000:         SECTOR%                           ! GMJK
4939: 0000: 
4940: 0000: INTEGER*4 GLOBAL                          \
4941: 0000:         LAST.ACTIVE%,                     \
4942: 0000:         LAST.STOCKTAKE%,                  \ 1.5
4943: 0000:         TIMEOUT.VALUE%                    ! FLC
4944: 0000: 
4945: 0000: 
4946: 0000: STRING GLOBAL                             \ for modules 00, 01 , 02 , 03 and 04
4947: 0000:         ACK$,                             \ 1.5
4948: 0000:         ALL.FILES.CLOSED$,                \
4949: 0000:         APPL$,                            \ FLC
4950: 0000:         APPLICATION.NO$,                  \
4951: 0000:         BAR.CODES$(1),                    \ FLC
4952: 0000:         BCSMF.RECORD$,                    \ GMJK
4953: 0000:         BOOKING.STARTED$,                 \ CDS
4954: 0000:         BOOKING.ENDED$,                   \ CDS
4955: 0000:         CCUOD.OPEN.FLAG$,                 \ GMJK
4956: 0000:         CCLAM.OPEN.FLAG$,                 \ 1.4
4957: 0000:         CCITM.OPEN.FLAG$,                 \ GMJK
4958: 0000:         CCTRL.OPEN.FLAG$,                 \ GMJK
4959: 0000:         CCDMY.OPEN.FLAG$,                 \ GMJK
4960: 0000:         CCTMP.OPEN.FLAG$,                 \ GMJK
4961: 0000:         CCBUF.OPEN.FLAG$,                 \ GMJK
4962: 0000:         CCUPF.OPEN.FLAG$,                 \ HMJK
4963: 0000:         CCWKF.OPEN.FLAG$,                 \ GMJK
4964: 0000:         STKRC.OPEN.FLAG$,                 \ 1.8DA
4965: 0000:         XGCF.OPEN.FLAG$,                  \ 1.8DA
4966: 0000:         STKEX.OPEN.FLAG$,                 \ 1.8DA
4967: 0000:         STKIF.OPEN.FLAG$,                 \ 1.8DA
4968: 0000:         LOCCNT.OPEN.FLAG$,                \ 1.8DA
4969: 0000:         STKTF.OPEN.FLAG$,                 \ 1.8DA
4970: 0000:         STKDC.OPEN.FLAG$,                 \ 1.8DA
4971: 0000: \       CSR.LIST.ALREADY.PROCESSED.FLAG$, \ !2.5NWB
4972: 0000: \       CSR.OPEN.FLAG$,                   \ !2.5NWB
4973: 0000:         CHKBF.OPEN.FLAG$,                 \ DSW
4974: 0000:         GAPBF.OPEN.FLAG$,                 \ SDH  2.3CS !2.4BG
4975: 0000:         PLLOL.OPEN.FLAG$,                 \ 2.3CS
4976: 0000:         PLLDB.OPEN.FLAG$,                 \ 2.3CS
4977: 0000:         PLLDB.TABLE$(1),                  \ 2.3CS
4978: 0000:         EAN.TABLE$(1),                    \ 2.3CS
4979: 0000: \       CITEM.OPEN.FLAG$,                 \ !2.5NWB
4980: 0000: \       CIMF.OPEN.FLAG$,                  \ !2.5NWB
4981: 0000: \       CSRWF.OPEN.FLAG$,                 \ !2.5NWB
4982: 0000: \       CSRBF.OPEN.FLAG$,                 \ !2.5NWB
4983: 0000:         CSR.AUDIT.FILE$,                  \ CDS
4984: 0000:         CSR.AUDIT.DATA$,                  \ CDS
4985: 0000:         CSR.AUDIT.OPEN.FLAG$,             \ CDS
4986: 0000:         CURR.LIST$,                       \ FLC
4987: 0000:         CURR.TERMINAL$,                   \
4988: 0000:         CURRENT.CODE$,                    \ DLC
4989: 0000:         DATA.IN$,                         \
4990: 0000:         DATE.TODAY$,                      \ FLC
4991: 0000:         STKMQ.OPEN.FLAG$,                 \ CDS
4992: 0000:         STLDT.OPEN.FLAG$,                 \ 1.6
4993: 0000:         BCSMF.OPEN.FLAG$,                 \ CDS
4994: 0000:         IEF.OPEN.FLAG$,                   \ CDS
4995: 0000:         DATA.FILES.REQ$,                  \ GMJK
4996: 0000:         DETAIL.RECORDS.RECEIVED$,         \ FLC
4997: 0000:         DIREC.OPEN.FLAG$,                 \ CDS
4998: 0000:         DIRORD.OPEN.FLAG$,                \ CDS
4999: 0000:         DIRSUP.OPEN.FLAG$,                \ CDS
5000: 0000:         DIRWF.OPEN.FLAG$,                 \ CDS
5001: 0000:         EPSOM.OPEN.FLAG$,                 \ FLC
5002: 0000:         LDTAF.OPEN.FLAG$,                 \ GMJK
5003: 0000:         LDTCF.OPEN.FLAG$,                 \ CDS
5004: 0000:         DRSMQ.OPEN.FLAG$,                 \ CDS
5005: 0000:         FILE.OPERATION$,                  \ DLC
5006: 0000: \       FIRST.CSR.LIST.FOR.PDT$,          \ 2.5NWB
5007: 0000:         FIRST.EOT.FOR.THIS.PDT$,          \
5008: 0000:         FIRST.ITEM.TO.BE.PROCESSED$,      \
5009: 0000:         FIRST.RETURN$,                    \ FLC
5010: 0000:         FPF.OPEN.FLAG$,                   \
5011: 0000:         HOLD.FLAG$,                       \
5012: 0000:         IDF.OPEN.FLAG$,                   \
5013: 0000:         IDSOF.OPEN.FLAG$,                 \ ELC
5014: 0000:         IRF.OPEN.FLAG$,                   \ FLC
5015: 0000:         IMSTC.OPEN.FLAG$,                 \1.7BG
5016: 0000:         LAST.ACTIVE.DATE$,                \
5017: 0000:         LAST.STOCKTAKE.DATE$,             \ 1.5
5018: 0000:         LAST.MESSAGE$,                    \
5019: 0000:         LOG.ON.DATE$,                     \ GMJK
5020: 0000:         LOG.ON.TIME$,                     \ GMJK
5021: 0000:         LDTBF.HEADER.WRITTEN$,            \ ELC
5022: 0000:         LDTBF.OPEN.FLAG$,                 \ ELC
5023: 0000:         LIST.ABANDONED$,                  \
5024: 0000:         LIST.BC$,                         \ FLC
5025: 0000:         LIST.TRANSMIT$(1),                \ FLC
5026: 0000:         LSSST.OPEN.FLAG$,                 \1.7BG
5027: 0000:         MONITORED.PORT$,                  \ DLC
5028: 0000:         NUM.SECTOR$,                      \ GMJK
5029: 0000:         ONORD.OPEN.FLAG$,                 \
5030: 0000:         ONORD.DELETED$(1),                \
5031: 0000:         ORDER.LINE.TABLE$(1),             \ CDS
5032: 0000:         PCHK.OPEN.FLAG$,                  \
5033: 0000:         PDT.ACTION$,                      \ FLC
5034: 0000:         PIITM.OPEN.FLAG$,                 \ FLC
5035: 0000:         PILST.OPEN.FLAG$,                 \ FLC
5036: 0000:         PIPE.OUT$,                        \
5037: 0000:         PDTWF.OPEN.FLAG$,                 \ FLC
5038: 0000:         PK2$,                             \
5039: 0000:         PK4$,                             \
5040: 0000:         PORT.STRING$,                     \
5041: 0000:         PREV.LOGGED.STATE$,               \ ELC
5042: 0000: \       PROCESS.CSR.WORKFILE$,            \ !2.5NWB
5043: 0000:         PSS38.STATUS$,                    \ FLC
5044: 0000:         RB.OPEN.FLAG$,                    \ 2.6BG
5045: 0000:         REWKF.OPEN.FLAG$,                 \ 2.6BG
5046: 0000:         RECALLS.OPEN.FLAG$,               \ 2.6BG
5047: 0000:         DELVINDX.OPEN.FLAG$,              \ 2.7SH
5048: 0000:         AF.OPEN.FLAG$,                    \ 2.7SH
5049: 0000:         UB.OPEN.FLAG$,                    \ 2.7SH
5050: 0000:         RECEIVE.STATE$,                   \
5051: 0000:         REQ.LIST.STORE$(1),               \ FLC
5052: 0000:         REQ.LIST.DATA$(1),                \ FLC
5053: 0000:         SAVED.ORDER.NO$,                  \ CDS
5054: 0000:         SAVED.ORDER.SUFFIX$,              \ CDS
5055: 0000:         SAVED.PAGE.NO$,                   \ CDS
5056: 0000:         SAVED.STORE.NUMBER$,              \ 1.8DA
5057: 0000:         SAVED.SUPPLIER.NO$,               \ CDS
5058: 0000:         SECTOR$,                          \ GMJK
5059: 0000:         SOFTS.OPEN.FLAG$,                 \ GMJK
5060: 0000:         SOH$,                             \ 1.5
5061: 0000:         STORED.UOD.HEADER$,               \ FLC
5062: 0000:         STORE.NUMBER$,                    \ 1.5
5063: 0000:         STOCK.OPEN.FLAG$,                 \1.7BG
5064: 0000:         STX$,                             \ FLC
5065: 0000:         STKBF.OPEN.FLAG$,                 \ 1.5
5066: 0000:         SXTMP.OPEN.FLAG$,                 \ 1.5
5067: 0000:         T.DATE$,                          \ 1.5
5068: 0000:         T.TIME$,                          \ 1.5
5069: 0000:         TEMP.TIME$,                       \ GMJK
5070: 0000:         TRAILER.LIST$,                    \ FLC
5071: 0000:         UOD.NUMBER$,                      \ FLC
5072: 0000:         UOD.NUM.ITEMS$,                   \ FLC
5073: 0000:         UOD.OPEN.FLAG$,                   \ FLC
5074: 0000:         UOD.STATUS.FLAG$,                 \ FLC
5075: 0000:         UODBF.OPEN.FLAG$,                 \ FLC
5076: 0000:         UODTF.OPEN.FLAG$,                 \ FLC
5077: 0000:         UNITS.OPEN.FLAG$
5078: 0000: 
5079: 0000: STRING GLOBAL                             \ GMJK
5080: 0000:         ITEM.STORAGE$,                    \ GMJK
5081: 0000:         ITEM.DESC.STORAGE$,               \ GMJK
5082: 0000:         BARCODE.DATA$,                    \ GMJK
5083: 0000:         BARCODE.INDEX$,                   \ GMJK
5084: 0000:         BARCODE.INDEX.STORAGE$,           \ GMJK
5085: 0000:         BARCODE.STORAGE$,                 \ GMJK
5086: 0000:         ITEM.DATA$,                       \ GMJK
5087: 0000:         ITEM.DATA.DESC$,                  \ GMJK
5088: 0000:         ITEM.POS.TABLE$(1),               \ GMJK
5089: 0000:         CCUOD.TABLE$(1),                  \ GMJK
5090: 0000:         CCLAM.TABLE$(1),                  \ 1.4
5091: 0000:         DATA.FILES.REQUIRED$,             \ GMJK
5092: 0000:         FINISH.DATE$,                     \ GMJK
5093: 0000:         FINISH.TIME$,                     \ GMJK
5094: 0000:         LDT.CCUOD.UPDATE.DATE$,           \ GMJK
5095: 0000:         LDT.CCUOD.UPDATE.TIME$,           \ GMJK
5096: 0000:         LDT.DATE.TIME$,                   \ GMJK
5097: 0000:         LDT.LAST.CLAIM.NUM$,              \ GMJK
5098: 0000:         STKCF.OPEN.FLAG$,                 \ 1.8DA
5099: 0000:         STKMF.OPEN.FLAG$,                 \ 1.8DA
5100: 0000:         CONCEPT.GROUPS$(1),               \ 1.8DA
5101: 0000:         PRODUCT.GROUPS$(1),               \ 1.8DA
5102: 0000:         BUSINESS.CENTRES$(1),             \ ! 1.8DA 2.1JAS
5103: 0000:         SOPTS.OPEN.FLAG$,                 \ ! 2.1JAS
5104: 0000:         LOCAL.OPEN.FLAG$,                 \ ! 2.1JAS
5105: 0000:         TSF.OPEN.FLAG$,                   \ ! 2.1JAS 2.2JAS
5106: 0000:         CCREJ.OPEN.FLAG$,                 \ 2.2JAS
5107: 0000:         CREDIT.CLAIM.FLAG$                ! 2.2JAS
5108: 0000: 
5109: 0000: 
5110: 0000: STRING GLOBAL                             \
5111: 0000:         BATCH.SCREEN.FLAG$,               \
5112: 0000:         EXP.STATES$,                      \
5113: 0000:         MODULE.NUMBER$,                   \
5114: 0000:         OPERATOR.ID$,                     \
5115: 0000:         STATE$,                           \
5116: 0000:         TRANS.FROM$,                      \
5117: 0000:         TRANS.TO$
5118: 0000: 
5119: 0000:  STRING GLOBAL                            \
5120: 0000:         REC.CHECK$(1),                    \
5121: 0000:         V.TAB$(1)
5122: 0000: 
5123: 0000: \*****************************************************************************
5124: 0000: \*****************************************************************************
5125: 0000: \***                                                                       ***
5126: 0000: \*** E X T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
5127: 0000: \***                                                                       ***
5128: 0000: \*****************************************************************************
5129: 0000: \*****************************************************************************
5130: 0000: 
5131: 0000: \*****************************************************************************
5132: 0000: \***   include external definitions for the following functions
5133: 0000: \***
5134: 0000: \***     ADXERROR
5135: 0000: \***     ADXSERVE
5136: 0000: \***     ADXSERCL
5137: 0000: \***     APPLICATION.LOG             01
5138: 0000: \***     READ.NEXT.IEF               11
5139: 0000: \***     SORT.TABLE                  14
5140: 0000: \***     CONV.TO.HEX                 16
5141: 0000: \***     CONV.TO.STRING              17
5142: 0000: \***     SESS.NUM.UTILITY            20
5143: 0000: \***     STKMQ
5144: 0000: \***     BCSMF
5145: 0000: \***     IDF
5146: 0000: \***     INVOK
5147: 0000: \***     PCHK
5148: 0000: \***     UOD
5149: 0000: \***     UODBF
5150: 0000: \***     UODTF
5151: 0000: \***     STKBF
5152: 0000: \***     SXTMP
5153: 0000: \***     SSPSC
5154: 0000: \***     BTCS
5155: 0000: \***     PRINT
5156: 0000: \***     SOPTS
5157: 0000: \***     LOCAL
5158: 0000: \***
5159: 0000: \*****************************************************************************
5160: 0000: 
5161: 0000:  %INCLUDE ADXERROR.J86
5162: 0000: \******************************************************************************
5163: 0000: \******************************************************************************
5164: 0000: \***                                                                        ***
5165: 0000: \***    %INCLUDE FOR FUNCTION ADXERROR (an I.B.M. system function)          ***
5166: 0000: \***                                                                        ***
5167: 0000: \***         AUTHOR        :  Stephen Kelsey                                ***
5168: 0000: \***                                                                        ***
5169: 0000: \***         DATE WRITTEN  :  21st February 1986                            ***
5170: 0000: \***                                                                        ***
5171: 0000: \***         DATE OF LAST REVISION  - 21st February 1986                    ***
5172: 0000: \***                                                                        ***
5173: 0000: \***         VERSION B     :  Stuart William McConnachie  18th March 1997   ***
5174: 0000: \***    Define size of ADXERROR return value from function.  This change    ***
5175: 0000: \***    was introduced by IBM in the 4690 Programming Guide.  Not defining  ***
5176: 0000: \***    this variable can cause Memory Protection Violations at run time.   ***
5177: 0000: \***                                                                        ***
5178: 0000: \******************************************************************************
5179: 0000: \******************************************************************************
5180: 0000: 
5181: 0000:    FUNCTION ADXERROR (TERM%,                                                  \
5182: 0000:                       MSGGRP%,                                                \
5183: 0000:                       MSGNUM%,                                                \
5184: 0000:                       SEVERITY%,                                              \
5185: 0000:                       EVENT.NUM%,                                             \
5186: 0000:                       UNIQUE$) EXTERNAL
5187: 0000: 
5188: 0000:       INTEGER*2  MSGNUM%,                                                     \
5189: 0000:                  TERM%,                                                       \
5190: 0000:                  ADXERROR                                                     !BSWM
5191: 0000: 
5192: 0000:       INTEGER*1 EVENT.NUM%,                                                   \
5193: 0000:                 MSGGRP%,                                                      \
5194: 0000:                 SEVERITY%
5195: 0000: 
5196: 0000:       STRING  UNIQUE$
5197: 0000: 
5198: 0000:    END FUNCTION
5199: 0000: 
5200: 0000:  %INCLUDE ADXSERVE.J86
5201: 0000: \******************************************************************************
5202: 0000: \******************************************************************************
5203: 0000: \***                                                                        ***
5204: 0000: \***    %INCLUDE FOR FUNCTION ADXSERVE (an I.B.M. system function)          ***
5205: 0000: \***                                                                        ***
5206: 0000: \***         AUTHOR        :  Bruce Scriver                                 ***
5207: 0000: \***                                                                        ***
5208: 0000: \***         DATE WRITTEN  :  14th March 1986                               ***
5209: 0000: \***                                                                        ***
5210: 0000: \***         DATE OF LAST REVISION  - 14th March 1986                       ***
5211: 0000: \***                                                                        ***
5212: 0000: \***                                                                        ***
5213: 0000: \******************************************************************************
5214: 0000: \******************************************************************************
5215: 0000: 
5216: 0000:    SUB ADXSERVE (RETURN.CODE%,                                                \
5217: 0000:                  ADX.FUNCTION%,                                               \
5218: 0000:                  ADX.PARM.1%,                                                 \
5219: 0000:                  ADX.PARM.2$)                                                 \
5220: 0000:    EXTERNAL
5221: 0000:   
5222: 0000:       STRING     ADX.PARM.2$
5223: 0000: 
5224: 0000:       INTEGER*2  ADX.FUNCTION%,                                               \
5225: 0000:                  ADX.PARM.1%
5226: 0000: 
5227: 0000:       INTEGER*4  RETURN.CODE%                                                 \
5228: 0000: 
5229: 0000:    END SUB     
5230: 0000: 
5231: 0000:  %INCLUDE ADXSERCL.J86                    ! DSW
5232: 0000: SUB ADXSERCL EXTERNAL
5233: 0000: END SUB
5234: 0000:  %INCLUDE PSBF01E.J86                     ! DLC
5235: 0000: REM \
5236: 0000: \*******************************************************************************
5237: 0000: \*******************************************************************************
5238: 0000: \***
5239: 0000: \***      %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION APPLICATION.LOG
5240: 0000: \***
5241: 0000: \***                      FUNCTION NUMBER   : PSBF01
5242: 0000: \***
5243: 0000: \***                    INCLUDE REFERENCE : PSBF01E.J86
5244: 0000: \*** 
5245: 0000: \***      Version B           Andrew Wedgeworth          1st July 1992
5246: 0000: \***      Three parameters which passed to the function have been removed.
5247: 0000: \***      APPLICATION.LOG has been added as a variable name (this holds the
5248: 0000: \***      return code).
5249: 0000: \***
5250: 0000: \*******************************************************************************
5251: 0000: 
5252: 0000: 
5253: 0000:    FUNCTION APPLICATION.LOG (MESSAGE.NO%,                                     \
5254: 0000:                              VAR.STRING.1$,                                   \
5255: 0000:                              VAR.STRING.2$,                                   \
5256: 0000:                              EVENT.NO%)  EXTERNAL
5257: 0000: 
5258: 0000:       INTEGER*1 EVENT.NO%
5259: 0000: 
5260: 0000:       INTEGER*2 APPLICATION.LOG,                                       \ GAW
5261: 0000:                 MESSAGE.NO%
5262: 0000: 
5263: 0000:       STRING VAR.STRING.1$,                                            \
5264: 0000:              VAR.STRING.2$
5265: 0000: 
5266: 0000:    END FUNCTION
5267: 0000: 
5268: 0000: \*******************************************************************************
5269: 0000:  %INCLUDE PSBF05E.J86                     ! 1.9BG
5270: 0000: REM\
5271: 0000: \*******************************************************************************
5272: 0000: \*******************************************************************************
5273: 0000: \***
5274: 0000: \***        INCLUDE       : CHECK.BOOTS.CODE external definition
5275: 0000: \***
5276: 0000: \***        REFERENCE     : PSBF05E.J86
5277: 0000: \***
5278: 0000: \***        Version A       Bruce Scriver                  24th February 1986  
5279: 0000: \*** 
5280: 0000: \***        Version B       Andrew Wedgeworth                  15th July 1992 
5281: 0000: \***        Redundant parameters removed, and CHECK.BOOTS.CODE defined as a 
5282: 0000: \***        variable to hold the return code.  
5283: 0000: \***
5284: 0000: \*******************************************************************************
5285: 0000: \*******************************************************************************
5286: 0000: 
5287: 0000:    FUNCTION CHECK.BOOTS.CODE (BOOTS.CODE$)                                     \
5288: 0000:    EXTERNAL
5289: 0000:    ! 3 parameters removed from here                                    ! BAW   
5290: 0000: 
5291: 0000:       STRING BOOTS.CODE$
5292: 0000:    ! 3 variables removed from here                                     ! BAW
5293: 0000:    
5294: 0000:       INTEGER*2 CHECK.BOOTS.CODE                                       ! BAW
5295: 0000:    
5296: 0000: 
5297: 0000:    END FUNCTION
5298: 0000: 
5299: 0000: !%INCLUDE PSBF06E.J86                     ! FLC
5300: 0000:  %INCLUDE PSBF11E.J86                     ! DLC
5301: 0000: REM \
5302: 0000: \*******************************************************************************
5303: 0000: \*******************************************************************************
5304: 0000: \***
5305: 0000: \***    %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION READ.NEXT.IEF
5306: 0000: \***
5307: 0000: \***
5308: 0000: \***            FUNCTION NUMBER       : PSBF11
5309: 0000: \***
5310: 0000: \***            INCLUDE REFERENCE     : PSBF11E.J86
5311: 0000: \***
5312: 0000: \***            DATE OF LAST AMENDMENT -  3rd March 1986
5313: 0000: \***
5314: 0000: \***     Version B             Andrew Wedgeworth          15th July 1992
5315: 0000: \***     Removal of redundant function parameters.  READ.NEXT.IEF defined as
5316: 0000: \***     a variable to hold the return code.
5317: 0000: \***
5318: 0000: \*******************************************************************************
5319: 0000: \*******************************************************************************
5320: 0000: 
5321: 0000: REM \
5322: 0000: \*******************************************************************************
5323: 0000: \*******************************************************************************
5324: 0000: \***
5325: 0000: \***
5326: 0000: \***            FUNCTION OVERVIEW
5327: 0000: \***            -----------------
5328: 0000: \***
5329: 0000: \***   This function finds and retreives the next bar code in an IEF chain.
5330: 0000: \***   If the code found is the last code in the chain, the function checks that
5331: 0000: \***   the number of codes in the chain is equal to the expected number.  If it
5332: 0000: \***   is not, a message is displayed and logged.  If an error occurs in reading
5333: 0000: \***   the IEF, a message is displayed and logged, and the function returns to
5334: 0000: \***   the calling program with a return code of 1.
5335: 0000: \***
5336: 0000: \***
5337: 0000: \*******************************************************************************
5338: 0000: \*******************************************************************************
5339: 0000: 
5340: 0000:    FUNCTION READ.NEXT.IEF (LAST.BAR.CODE$,                             \
5341: 0000:                            TOTAL.COUNT%,                               \
5342: 0000:                            BOOTS.CODE$)  EXTERNAL
5343: 0000:    ! 3 parameters deleted from here                                    ! BAW			   
5344: 0000: 
5345: 0000:       STRING  BOOTS.CODE$,                                             \
5346: 0000:               LAST.BAR.CODE$
5347: 0000:       ! 3 variables removed from here                                  ! BAW
5348: 0000: 
5349: 0000:       INTEGER*2 READ.NEXT.IEF,                                         \ BAW
5350: 0000:                 TOTAL.COUNT%
5351: 0000:              
5352: 0000: 
5353: 0000: 
5354: 0000:    END FUNCTION
5355: 0000: 
5356: 0000: \*******************************************************************************
5357: 0000:  %INCLUDE PSBF14E.J86                     ! DLC
5358: 0000: REM\
5359: 0000: \*******************************************************************************
5360: 0000: \*******************************************************************************
5361: 0000: \***
5362: 0000: \***        INCLUDE       : SORT.TABLE external definition
5363: 0000: \***
5364: 0000: \***        REFERENCE     : PSBF14E.J86
5365: 0000: \***
5366: 0000: \***        Version A     Bruce Scriver                   3rd March 1986   
5367: 0000: \*** 
5368: 0000: \***        Version B     Andrew Wedgeworth               17th July 1992
5369: 0000: \***        Redundant function parameters removed.  SORT.TABLE defined as a
5370: 0000: \***        variable to hold the return code.
5371: 0000: \***
5372: 0000: \*******************************************************************************
5373: 0000: \*******************************************************************************
5374: 0000: 
5375: 0000:    FUNCTION SORT.TABLE (NUMBER.OF.ENTRIES%)                                    \
5376: 0000:    EXTERNAL
5377: 0000: 
5378: 0000:       INTEGER   NUMBER.OF.ENTRIES%,                                    \ BAW
5379: 0000:                 SORT.TABLE                 
5380: 0000: 
5381: 0000:    END FUNCTION
5382: 0000: 
5383: 0000:  %INCLUDE PSBF16E.J86                     ! DLC
5384: 0000: REM\
5385: 0000: \*******************************************************************************
5386: 0000: \*******************************************************************************
5387: 0000: \***
5388: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.HEX FUNCTION
5389: 0000: \***
5390: 0000: \***                  REFERENCE     : PSBF16E.J86
5391: 0000: \***
5392: 0000: \***       Version A            Bruce Scriver          25th February 1986
5393: 0000: \***
5394: 0000: \***       Version B           Andrew Wedgeworth            2nd July 1992
5395: 0000: \***       Removal of redundant parameters, and CONV.TO.HEX defined as a 
5396: 0000: \***       variable to hold the return code. 
5397: 0000: \***
5398: 0000: \*******************************************************************************
5399: 0000: \*******************************************************************************
5400: 0000: 
5401: 0000:    FUNCTION CONV.TO.HEX (INTEGER4%)                                            \
5402: 0000:    EXTERNAL
5403: 0000:    ! 3 parameters removed from here                                    ! BAW
5404: 0000: 
5405: 0000:    ! 3 lines deleted from here                                         ! BAW
5406: 0000:    
5407: 0000:       INTEGER*2 CONV.TO.HEX                                            ! BAW
5408: 0000: 
5409: 0000:       INTEGER*4 INTEGER4%
5410: 0000: 
5411: 0000:    END FUNCTION
5412: 0000: 
5413: 0000:  %INCLUDE PSBF17E.J86                     ! DLC
5414: 0000: REM \
5415: 0000: \*******************************************************************************
5416: 0000: \*******************************************************************************
5417: 0000: \***
5418: 0000: \***
5419: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.STRING FUNCTION
5420: 0000: \***
5421: 0000: \***                     REFERENCE     : PSBF17E.J86
5422: 0000: \***
5423: 0000: \***       Version A            Bruce Scriver       24th February 1986           
5424: 0000: \***
5425: 0000: \***       Version B          Andrew Wedgeworth          2nd July 1992
5426: 0000: \***       Redundant parameters removed, and the function's name is 
5427: 0000: \***       is defined as a variable to hold the return code. 
5428: 0000: \***
5429: 0000: \*******************************************************************************
5430: 0000: \*******************************************************************************
5431: 0000: 
5432: 0000:    FUNCTION CONV.TO.STRING (EVENT.NUMBER%,                                     \
5433: 0000:                             INTEGER4%)                                         \
5434: 0000:    EXTERNAL
5435: 0000: ! 3 parameters removed from here                                       ! BAW
5436: 0000: 
5437: 0000: ! 3 lines deleted from here                                            ! BAW
5438: 0000: 
5439: 0000:       INTEGER*1 EVENT.NUMBER%
5440: 0000: 
5441: 0000:       INTEGER*2 CONV.TO.STRING                                         ! BAW
5442: 0000: 
5443: 0000:       INTEGER*4 INTEGER4%
5444: 0000: 
5445: 0000:    END FUNCTION
5446: 0000: 
5447: 0000:  %INCLUDE PSBF18E.J86                     ! 1.8DA
5448: 0000: REM\
5449: 0000: \*******************************************************************************
5450: 0000: \*******************************************************************************
5451: 0000: \***
5452: 0000: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT external definition
5453: 0000: \***
5454: 0000: \***        REFERENCE     : PSBF18E.J86
5455: 0000: \***
5456: 0000: \***        Version A      Stephen Kelsey                   23rd March 1987 
5457: 0000: \***
5458: 0000: \***        Version B      Andrew Wedgeworth                  7th July 1992 
5459: 0000: \***        Removal of redundant parameters, and inclusion of function's 
5460: 0000: \***        name as a variable to hold the return code.
5461: 0000: \***
5462: 0000: \*******************************************************************************
5463: 0000: \*******************************************************************************
5464: 0000: 
5465: 0000:    FUNCTION CALC.BOOTS.CODE.CHECK.DIGIT (BOOTS.CODE.6.DIGIT$)          \ 
5466: 0000:    EXTERNAL
5467: 0000:    ! 3 parameters removed from here                                    ! BAW
5468: 0000: 
5469: 0000:    STRING BOOTS.CODE.6.DIGIT$
5470: 0000:    ! 3 variables deleted from here                                     ! BAW
5471: 0000:    
5472: 0000:    INTEGER* 2 CALC.BOOTS.CODE.CHECK.DIGIT                              ! BAW
5473: 0000:    
5474: 0000:    END FUNCTION
5475: 0000: 
5476: 0000:  %INCLUDE PSBF20E.J86                     ! DLC
5477: 0000: REM\
5478: 0000: \*******************************************************************************
5479: 0000: \*******************************************************************************
5480: 0000: \***
5481: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF SESS.NUM.UTILITY
5482: 0000: \***
5483: 0000: \***                  REFERENCE     : PSBF20E.J86
5484: 0000: \***
5485: 0000: \***     VERSION C            Janet Smith                13th May 1992
5486: 0000: \***     Increased PASSED.INTEGER to 2 bytes to cater for more than
5487: 0000: \***     128 files.
5488: 0000: \***
5489: 0000: \***     VERSION D.           Andrew Wedgeworth          1st July 1992
5490: 0000: \***     Removal of redundant parameters and addition of SESS.NUM.UTILITY
5491: 0000: \***     as a variable.  This new variable contains the function's return
5492: 0000: \***     code.
5493: 0000: \***
5494: 0000: \*******************************************************************************
5495: 0000: \*******************************************************************************
5496: 0000: 
5497: 0000:    FUNCTION SESS.NUM.UTILITY (FUNCTION.FLAG$,                          \
5498: 0000:                               PASSED.INTEGER%,                         \
5499: 0000:                               PASSED.STRING$)                          \
5500: 0000:    EXTERNAL
5501: 0000: 
5502: 0000:    STRING    FUNCTION.FLAG$,                                           \
5503: 0000:              PASSED.STRING$
5504: 0000:    ! 3 variables removed from here                                     ! CAW
5505: 0000: 
5506: 0000: 
5507: 0000:    INTEGER*2 SESS.NUM.UTILITY,                                         \ CAW
5508: 0000:              PASSED.INTEGER%				               ! CJAS
5509: 0000: 
5510: 0000:    END FUNCTION
5511: 0000: 
5512: 0000:  %INCLUDE PSBF21E.J86                     ! 1.9BG
5513: 0000: REM\
5514: 0000: \*******************************************************************************
5515: 0000: \*******************************************************************************
5516: 0000: \***
5517: 0000: \***        INCLUDE       : CHECK.BAR.CODE external definition
5518: 0000: \***
5519: 0000: \***        REFERENCE     : PSBF21E.J86
5520: 0000: \***
5521: 0000: \***        Version A     Bruce Scriver                  13th May 1988
5522: 0000: \***
5523: 0000: \***        Version B     Andrew Wedgeworth             21st July 1992
5524: 0000: \***        Redundant function parameters removed.  CHECK.BAR.CODE defined as
5525: 0000: \***        a variable to hold the return code.
5526: 0000: \***
5527: 0000: \*******************************************************************************
5528: 0000: \*******************************************************************************
5529: 0000: 
5530: 0000:    FUNCTION CHECK.BAR.CODE (BAR.CODE$)                                 \
5531: 0000:    EXTERNAL
5532: 0000: 
5533: 0000:    STRING    BAR.CODE$
5534: 0000: 
5535: 0000:    INTEGER*2 CHECK.BAR.CODE                                            ! BAW
5536: 0000: 
5537: 0000:    END FUNCTION
5538: 0000: 
5539: 0000: 
5540: 0000:  %INCLUDE IDFEXT.J86                      ! FLC
5541: 0000: \*******************************************************************************
5542: 0000: \***                                                                         ***
5543: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM DESCRIPTION FILE        ***
5544: 0000: \***                                                                         ***
5545: 0000: \***                       REFERENCE : IDFEXT.J86                            ***
5546: 0000: \***                                                                         ***
5547: 0000: \***      Version A           Andrew Wedgeworth         9th July 1992        ***
5548: 0000: \***
5549: 0000: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
5550: 0000: \***    No changes to this file.
5551: 0000: \***
5552: 0000: \***   VERSION D               Nik Sen                 22nd December 1994
5553: 0000: \***   WRITE.IDF.HOLD added
5554: 0000: \***
5555: 0000: \*******************************************************************************
5556: 0000: 
5557: 0000:        FUNCTION IDF.SET EXTERNAL                                      
5558: 0000:        END FUNCTION                                                   
5559: 0000: 
5560: 0000: 
5561: 0000:        FUNCTION READ.IDF EXTERNAL                                     
5562: 0000:           INTEGER*2 READ.IDF                                          
5563: 0000:        END FUNCTION                                                   
5564: 0000: 
5565: 0000: 
5566: 0000:        FUNCTION READ.IDF.LOCK EXTERNAL                                
5567: 0000:           INTEGER*2 READ.IDF.LOCK                                     
5568: 0000:        END FUNCTION                                                   
5569: 0000: 
5570: 0000:        FUNCTION WRITE.IDF EXTERNAL
5571: 0000:           INTEGER*2 WRITE.IDF
5572: 0000:        END FUNCTION	       
5573: 0000: 
5574: 0000:        FUNCTION WRITE.IDF.HOLD EXTERNAL
5575: 0000:           INTEGER*2 WRITE.IDF.HOLD
5576: 0000:        END FUNCTION
5577: 0000: 
5578: 0000:        FUNCTION WRITE.IDF.UNLOCK EXTERNAL                                  
5579: 0000:           INTEGER*2 WRITE.IDF.UNLOCK                                      
5580: 0000:        END FUNCTION                                                   
5581: 0000: !%INCLUDE IRFEXT.J86                      ! FLC TEST
5582: 0000:  %INCLUDE STKMQEXT.J86                    ! GMJK
5583: 0000: \*****************************************************************************
5584: 0000: \*****************************************************************************
5585: 0000: \***
5586: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCK MOVEMENT QUEUE FILE
5587: 0000: \***
5588: 0000: \***                      REFERENCE: STKMQEXT.J86
5589: 0000: \***
5590: 0000: \***       Version A            Les Cook                     8/9/92
5591: 0000: \***
5592: 0000: \***    VERSION F.              ROBERT COWEY.                       21 OCT 1993.
5593: 0000: \***    No changes to this file.
5594: 0000: \***
5595: 0000: \*******************************************************************************
5596: 0000: \*******************************************************************************
5597: 0000: 
5598: 0000:      FUNCTION STKMQ.SET EXTERNAL
5599: 0000:      END FUNCTION
5600: 0000:      
5601: 0000:      FUNCTION READ.STKMQ EXTERNAL
5602: 0000:         INTEGER*2 READ.STKMQ
5603: 0000:      END FUNCTION
5604: 0000:      
5605: 0000:      FUNCTION WRITE.STKMQ EXTERNAL
5606: 0000:         INTEGER*2 WRITE.STKMQ
5607: 0000:      END FUNCTION
5608: 0000:      
5609: 0000:      FUNCTION WRITE.HOLD.STKMQ EXTERNAL
5610: 0000:         INTEGER*2 WRITE.HOLD.STKMQ
5611: 0000:      END FUNCTION
5612: 0000:      
5613: 0000:      
5614: 0000:      
5615: 0000:  %INCLUDE BCSMFEXT.J86                    ! FLC
5616: 0000: \*****************************************************************************
5617: 0000: \*****************************************************************************
5618: 0000: \***
5619: 0000: \***   EXTERNAL FUNCTION DEFINITIONS FOR BUSINESS CENTRE SUPPLY METHOD FILE
5620: 0000: \***
5621: 0000: \***               REFERENCE: BCSMFFUN.BAS
5622: 0000: \***
5623: 0000: \***        Version B           Les Cook              11/1/93
5624: 0000: \***
5625: 0000: \*****************************************************************************
5626: 0000: \*****************************************************************************
5627: 0000: 
5628: 0000:     FUNCTION BCSMF.SET EXTERNAL
5629: 0000:     END FUNCTION
5630: 0000:     
5631: 0000:     FUNCTION READ.BCSMF EXTERNAL
5632: 0000:        INTEGER*2 READ.BCSMF
5633: 0000:     END FUNCTION
5634: 0000:     
5635: 0000:     FUNCTION READ.BCSMF.LOCK EXTERNAL
5636: 0000:        INTEGER*2 READ.BCSMF.LOCK
5637: 0000:     END FUNCTION
5638: 0000:     
5639: 0000:     FUNCTION WRITE.BCSMF EXTERNAL
5640: 0000:        INTEGER*2 WRITE.BCSMF
5641: 0000:     END FUNCTION
5642: 0000:     
5643: 0000:     FUNCTION WRITE.BCSMF.UNLOCK EXTERNAL
5644: 0000:        INTEGER*2 WRITE.BCSMF.UNLOCK
5645: 0000:     END FUNCTION
5646: 0000:     
5647: 0000:     
5648: 0000:  %INCLUDE INVOKEXT.J86                    ! FLC
5649: 0000: \*******************************************************************************
5650: 0000: \***                                                                         ***
5651: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE INVCE OK FILE                ***
5652: 0000: \***                                                                         ***
5653: 0000: \***                     REFERENCE : INVOKEXT.J86                            ***
5654: 0000: \***                                                                         ***
5655: 0000: \***      Version A         Andrew Wedgeworth       3rd August 1992          ***
5656: 0000: \***                                                                         ***
5657: 0000: \***      Version B         Stephen Kelsey (CTG)    9th October 1992         ***
5658: 0000: \***          Add functions READ.INVOK.LOCKED and WRITE.INVOK.UNLOCK         ***
5659: 0000: \***                                                                         ***
5660: 0000: \*******************************************************************************
5661: 0000: 
5662: 0000: 
5663: 0000:       FUNCTION INVOK.SET EXTERNAL 
5664: 0000:       END FUNCTION
5665: 0000:       
5666: 0000:       FUNCTION READ.INVOK EXTERNAL
5667: 0000:          INTEGER*2 READ.INVOK
5668: 0000:       END FUNCTION	             
5669: 0000:       
5670: 0000:       FUNCTION READ.INVOK.LOCKED EXTERNAL                              ! BSPK
5671: 0000:          INTEGER*2 READ.INVOK.LOCKED                                   ! BSPK
5672: 0000:       END FUNCTION	                                               ! BSPK
5673: 0000:       
5674: 0000:       FUNCTION WRITE.INVOK.UNLOCK EXTERNAL                             ! BSPK
5675: 0000:          INTEGER*2 WRITE.INVOK.UNLOCK                                  ! BSPK
5676: 0000:       END FUNCTION	                                               ! BSPK
5677: 0000:  %INCLUDE PCHKEXT.J86                     ! DLC
5678: 0000: \*****************************************************************************
5679: 0000: \*****************************************************************************
5680: 0000: \***
5681: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR PCHK
5682: 0000: \***
5683: 0000: \***        REFERENCE: PCHKEXT.J86
5684: 0000: \***
5685: 0000: \*****************************************************************************
5686: 0000: \*****************************************************************************
5687: 0000: 
5688: 0000: 
5689: 0000:    FUNCTION PCHK.SET EXTERNAL
5690: 0000:    END FUNCTION
5691: 0000:    
5692: 0000:    FUNCTION READ.PCHK EXTERNAL
5693: 0000:    END FUNCTION
5694: 0000:    
5695: 0000:    FUNCTION WRITE.PCHK EXTERNAL
5696: 0000:    END FUNCTION
5697: 0000:    
5698: 0000:    
5699: 0000: \%INCLUDE CSREXT.J86                      ! DLC !2.5NWB
5700: 0000:  %INCLUDE EPSOMEXT.J86                    ! DLC
5701: 0000: \*****************************************************************************
5702: 0000: \*****************************************************************************
5703: 0000: \***
5704: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR EPSOM
5705: 0000: \***
5706: 0000: \***      REFERENCE: EPSOMEXT.J86
5707: 0000: \***
5708: 0000: \*****************************************************************************
5709: 0000: \*****************************************************************************
5710: 0000: 
5711: 0000: 
5712: 0000:    FUNCTION EPSOM.SET EXTERNAL
5713: 0000:    END FUNCTION
5714: 0000:    
5715: 0000:  %INCLUDE UNITSEXT.J86                    ! DLC
5716: 0000: \*****************************************************************************
5717: 0000: \*****************************************************************************
5718: 0000: \*** 
5719: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR UNITS
5720: 0000: \***
5721: 0000: \***        REFERENCE:  UNITSEXT.J86
5722: 0000: \***
5723: 0000: \*****************************************************************************
5724: 0000: \*****************************************************************************
5725: 0000: 
5726: 0000:    FUNCTION UNITS.SET EXTERNAL
5727: 0000:    END FUNCTION
5728: 0000:    
5729: 0000:    FUNCTION READ.UNITS EXTERNAL
5730: 0000:       INTEGER*2 READ.UNITS
5731: 0000:    END FUNCTION
5732: 0000:    
5733: 0000:    FUNCTION READ.UNITS.LOCK EXTERNAL
5734: 0000:       INTEGER*2 READ.UNITS.LOCK
5735: 0000:    END FUNCTION
5736: 0000:    
5737: 0000:    FUNCTION WRITE.UNITS EXTERNAL
5738: 0000:       INTEGER*2 WRITE.UNITS
5739: 0000:    END FUNCTION
5740: 0000:    
5741: 0000:    FUNCTION WRITE.UNITS.UNLOCK EXTERNAL
5742: 0000:       INTEGER*2 WRITE.UNITS.UNLOCK
5743: 0000:    END FUNCTION
5744: 0000:    
5745: 0000:    
5746: 0000:    
5747: 0000:  %INCLUDE DIRECEXT.J86                    ! DLC
5748: 0000: \*****************************************************************************
5749: 0000: \*****************************************************************************
5750: 0000: \***
5751: 0000: \***       EXTERNAL FUNCTION DEFINITIONS FOR DIREC
5752: 0000: \***
5753: 0000: \***       REFERENCE: DIRECEXT.J86
5754: 0000: \***
5755: 0000: \*****************************************************************************
5756: 0000: \*****************************************************************************
5757: 0000: 
5758: 0000:    FUNCTION DIREC.SET EXTERNAL 
5759: 0000:    END FUNCTION
5760: 0000:    
5761: 0000:    
5762: 0000:  %INCLUDE LDTBFEXT.J86                    ! ELC
5763: 0000: \*******************************************************************************
5764: 0000: \***                                                                         
5765: 0000: \***         EXTERNAL FUNCTION DEFINITIONS FOR THE LDT BUFFER FILE          
5766: 0000: \***                                                                         
5767: 0000: \***                     REFERENCE : LDTBFEXT.J86                            
5768: 0000: \***                                                                         
5769: 0000: \***          Version B     Les Cook      4th November 1992               
5770: 0000: \***                                                                         
5771: 0000: \*******************************************************************************
5772: 0000: 
5773: 0000:        FUNCTION LDTBF.SET EXTERNAL                                      
5774: 0000:        END FUNCTION                                                   
5775: 0000: 
5776: 0000: 
5777: 0000:        FUNCTION READ.LDTBF EXTERNAL                                  
5778: 0000:           INTEGER*2 READ.LDTBF                                       
5779: 0000:        END FUNCTION                                                   
5780: 0000:        
5781: 0000:        FUNCTION WRITE.LDTBF EXTERNAL
5782: 0000:           INTEGER*2 WRITE.LDTBF
5783: 0000:        END FUNCTION
5784: 0000:  %INCLUDE UODEXT.J86                      ! FLC
5785: 0000: \*****************************************************************************
5786: 0000: \*****************************************************************************
5787: 0000: \***
5788: 0000: \***     EXTERNAL FUNCTION DEFINITIONS FOR UOD DUMMY FILE
5789: 0000: \***
5790: 0000: \***     REFERENCE: UODEXT.J86
5791: 0000: \***
5792: 0000: \*****************************************************************************
5793: 0000: \*****************************************************************************
5794: 0000: 
5795: 0000:    FUNCTION UOD.SET EXTERNAL
5796: 0000:    END FUNCTION
5797: 0000:    
5798: 0000:    
5799: 0000:  %INCLUDE UODBFEXT.J86                    ! FLC
5800: 0000: \*******************************************************************************
5801: 0000: \*******************************************************************************
5802: 0000: \***
5803: 0000: \***           UOD BUFFER FILE EXTERNAL FILE PUBLIC DEFINITIONS
5804: 0000: \***
5805: 0000: \***                    REFERENCE    : UODBFEXT.BAS
5806: 0000: \***
5807: 0000: \***    Version A.         Michael Kelsall              08th February 1993
5808: 0000: \***
5809: 0000: \*******************************************************************************
5810: 0000: \*******************************************************************************
5811: 0000: 
5812: 0000:  
5813: 0000:   FUNCTION UODBF.SET EXTERNAL
5814: 0000:       INTEGER*2 UODBF.SET
5815: 0000:   END FUNCTION
5816: 0000: 
5817: 0000: 
5818: 0000:   FUNCTION READ.UODBF EXTERNAL
5819: 0000:       INTEGER*2 READ.UODBF 
5820: 0000:   END FUNCTION
5821: 0000: 
5822: 0000:   
5823: 0000:   FUNCTION WRITE.UODBF EXTERNAL
5824: 0000:       INTEGER*2 WRITE.UODBF
5825: 0000:   END FUNCTION
5826: 0000: 
5827: 0000:   
5828: 0000:   FUNCTION WRITE.HOLD.UODBF EXTERNAL
5829: 0000:       INTEGER*2 WRITE.HOLD.UODBF						
5830: 0000:   END FUNCTION								
5831: 0000: 
5832: 0000:  %INCLUDE UODTFEXT.J86                    ! FLC
5833: 0000: \*****************************************************************************
5834: 0000: \*****************************************************************************
5835: 0000: \***
5836: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR UODTF
5837: 0000: \***
5838: 0000: \***        REFERENCE:  UODTFEXT.J86
5839: 0000: \***
5840: 0000: \***        Version A         Les Cook         22/2/1993
5841: 0000: \***
5842: 0000: \*****************************************************************************
5843: 0000: \*****************************************************************************
5844: 0000: 
5845: 0000:    FUNCTION UODTF.SET EXTERNAL
5846: 0000:    END FUNCTION
5847: 0000:    
5848: 0000:    FUNCTION READ.UODTF EXTERNAL
5849: 0000:       INTEGER*2 READ.UODTF
5850: 0000:    END FUNCTION
5851: 0000:    
5852: 0000:    FUNCTION WRITE.UODTF EXTERNAL
5853: 0000:       INTEGER*2 WRITE.UODTF
5854: 0000:    END FUNCTION
5855: 0000:    
5856: 0000:    
5857: 0000:  %INCLUDE PILSTEXT.J86                    ! FLC
5858: 0000: \*****************************************************************************
5859: 0000: \*****************************************************************************
5860: 0000: \***
5861: 0000: \***     EXTERNAL FUNCTION DEFINITIONS FOR PILST
5862: 0000: \***
5863: 0000: \***     REFERENCE: PILSTEXT.J86
5864: 0000: \***
5865: 0000: \***     9th October 1992
5866: 0000: \***
5867: 0000: \*****************************************************************************
5868: 0000: \*****************************************************************************
5869: 0000: 
5870: 0000:    FUNCTION PILST.SET EXTERNAL
5871: 0000:    END FUNCTION
5872: 0000:    
5873: 0000:    FUNCTION READ.PILST EXTERNAL
5874: 0000:       INTEGER*2 READ.PILST
5875: 0000:    END FUNCTION
5876: 0000:    
5877: 0000:    FUNCTION READ.PILST.LOCK EXTERNAL
5878: 0000:       INTEGER*2 READ.PILST.LOCK
5879: 0000:    END FUNCTION
5880: 0000:    
5881: 0000:    FUNCTION WRITE.PILST EXTERNAL
5882: 0000:       INTEGER*2 WRITE.PILST
5883: 0000:    END FUNCTION
5884: 0000:    
5885: 0000:    FUNCTION WRITE.PILST.HOLD EXTERNAL
5886: 0000:       INTEGER*2 WRITE.PILST.HOLD
5887: 0000:    END FUNCTION
5888: 0000:    
5889: 0000:    FUNCTION WRITE.PILST.UNLOCK EXTERNAL
5890: 0000:       INTEGER*2 WRITE.PILST.UNLOCK
5891: 0000:    END FUNCTION
5892: 0000:    
5893: 0000:    
5894: 0000:  %INCLUDE PIITMEXT.J86                    ! FLC
5895: 0000: \*****************************************************************************
5896: 0000: \*****************************************************************************
5897: 0000: \***
5898: 0000: \***            EXTERNAL FUNCTION DEFINITIONS FOR PIITM
5899: 0000: \***
5900: 0000: \***            REFERENCE: PIITMEXT.J86
5901: 0000: \***
5902: 0000: \***            Les Cook 9/10/1992
5903: 0000: \***
5904: 0000: \*****************************************************************************
5905: 0000: \*****************************************************************************
5906: 0000: 
5907: 0000:    FUNCTION PIITM.SET EXTERNAL
5908: 0000:    END FUNCTION
5909: 0000:    
5910: 0000:    FUNCTION READ.PIITM EXTERNAL
5911: 0000:       INTEGER*2 READ.PIITM
5912: 0000:    END FUNCTION
5913: 0000:    
5914: 0000:    FUNCTION READ.PIITM.LOCK EXTERNAL
5915: 0000:       INTEGER*2 READ.PIITM.LOCK
5916: 0000:    END FUNCTION
5917: 0000:    
5918: 0000:    FUNCTION WRITE.PIITM EXTERNAL
5919: 0000:       INTEGER*2 WRITE.PIITM
5920: 0000:    END FUNCTION
5921: 0000:    
5922: 0000:    FUNCTION WRITE.PIITM.UNLOCK EXTERNAL
5923: 0000:       INTEGER*2 WRITE.PIITM.UNLOCK
5924: 0000:    END FUNCTION
5925: 0000:    
5926: 0000:    FUNCTION WRITE.PIITM.HOLD.UNLOCK EXTERNAL
5927: 0000:       INTEGER*2 WRITE.PIITM.HOLD.UNLOCK
5928: 0000:    END FUNCTION
5929: 0000:    
5930: 0000:    FUNCTION WRITE.PIITM.HOLD EXTERNAL
5931: 0000:       INTEGER*2 WRITE.PIITM.HOLD
5932: 0000:    END FUNCTION
5933: 0000:    
5934: 0000: !%INCLUDE PDTWFEXT.J86                    ! FLC
5935: 0000: 
5936: 0000:  %INCLUDE CCUODEXT.J86                    ! GMJK
5937: 0000: 
5938: 0000: \*****************************************************************************
5939: 0000: \*****************************************************************************
5940: 0000: \***
5941: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
5942: 0000: \***
5943: 0000: \***                   FILE TYPE:  KEYED
5944: 0000: \***
5945: 0000: \***                   REFERENCE:  CCUODEXT.J86
5946: 0000: \***
5947: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
5948: 0000: \***				   FILE OF OPEN/CLOSED UODS
5949: 0000: \***
5950: 0000: \***
5951: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
5952: 0000: \***      
5953: 0000: \*****************************************************************************
5954: 0000: \*****************************************************************************
5955: 0000: 
5956: 0000: 
5957: 0000:   FUNCTION CCUOD.SET EXTERNAL
5958: 0000:      INTEGER*2 CCUOD.SET
5959: 0000:   END FUNCTION
5960: 0000: 
5961: 0000: 
5962: 0000:   FUNCTION READ.CCUOD EXTERNAL
5963: 0000:     INTEGER*2 READ.CCUOD
5964: 0000:   END FUNCTION
5965: 0000:   
5966: 0000: 
5967: 0000:   FUNCTION READ.CCUOD.LOCKED EXTERNAL
5968: 0000:     INTEGER*2 READ.CCUOD.LOCKED
5969: 0000:   END FUNCTION  
5970: 0000: 
5971: 0000: 
5972: 0000:   FUNCTION WRITE.HOLD.CCUOD EXTERNAL
5973: 0000:     INTEGER*2 WRITE.HOLD.CCUOD
5974: 0000:   END FUNCTION
5975: 0000: 
5976: 0000: 
5977: 0000:   FUNCTION WRITE.UNLOCK.CCUOD EXTERNAL
5978: 0000:     INTEGER*2 WRITE.UNLOCK.CCUOD
5979: 0000:   END FUNCTION
5980: 0000: 
5981: 0000: 
5982: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCUOD EXTERNAL
5983: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUOD
5984: 0000:   END FUNCTION
5985: 0000:   
5986: 0000: 
5987: 0000:   FUNCTION WRITE.CCUOD EXTERNAL
5988: 0000:     INTEGER*2 WRITE.CCUOD
5989: 0000:   END FUNCTION
5990: 0000: 
5991: 0000:  %INCLUDE CCLAMEXT.J86                    ! 1.4
5992: 0000: 
5993: 0000: \*****************************************************************************
5994: 0000: \*****************************************************************************
5995: 0000: \***
5996: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
5997: 0000: \***
5998: 0000: \***                   FILE TYPE:  KEYED
5999: 0000: \***
6000: 0000: \***                   REFERENCE:  CCLAMEXT.J86
6001: 0000: \***
6002: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6003: 0000: \***				   FILE OF CURRENT CREDIT CLAIMS
6004: 0000: \***
6005: 0000: \***
6006: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
6007: 0000: \***      
6008: 0000: \*****************************************************************************
6009: 0000: \*****************************************************************************
6010: 0000: 
6011: 0000: 
6012: 0000:   FUNCTION CCLAM.SET EXTERNAL
6013: 0000:      INTEGER*2 CCLAM.SET
6014: 0000:   END FUNCTION
6015: 0000: 
6016: 0000: 
6017: 0000:   FUNCTION READ.CCLAM EXTERNAL
6018: 0000:     INTEGER*2 READ.CCLAM
6019: 0000:   END FUNCTION
6020: 0000:   
6021: 0000: 
6022: 0000:   FUNCTION READ.CCLAM.LOCKED EXTERNAL
6023: 0000:     INTEGER*2 READ.CCLAM.LOCKED
6024: 0000:   END FUNCTION  
6025: 0000: 
6026: 0000: 
6027: 0000:   FUNCTION WRITE.HOLD.CCLAM EXTERNAL
6028: 0000:     INTEGER*2 WRITE.HOLD.CCLAM
6029: 0000:   END FUNCTION
6030: 0000: 
6031: 0000: 
6032: 0000:   FUNCTION WRITE.UNLOCK.CCLAM EXTERNAL
6033: 0000:     INTEGER*2 WRITE.UNLOCK.CCLAM
6034: 0000:   END FUNCTION
6035: 0000: 
6036: 0000: 
6037: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCLAM EXTERNAL
6038: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCLAM
6039: 0000:   END FUNCTION
6040: 0000:   
6041: 0000: 
6042: 0000:   FUNCTION WRITE.CCLAM EXTERNAL
6043: 0000:     INTEGER*2 WRITE.CCLAM
6044: 0000:   END FUNCTION
6045: 0000: 
6046: 0000:  %INCLUDE CCITMEXT.J86                    ! GMJK
6047: 0000: 
6048: 0000: \*****************************************************************************
6049: 0000: \*****************************************************************************
6050: 0000: \***
6051: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6052: 0000: \***
6053: 0000: \***                   FILE TYPE:  KEYED
6054: 0000: \***
6055: 0000: \***                   REFERENCE:  CCITMEXT.J86
6056: 0000: \***
6057: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6058: 0000: \***				   FILE OF ITEMS PER OPEN/CLOSED UODS
6059: 0000: \***
6060: 0000: \***
6061: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
6062: 0000: \***      
6063: 0000: \*****************************************************************************
6064: 0000: \*****************************************************************************
6065: 0000: 
6066: 0000: 
6067: 0000:   FUNCTION CCITM.SET EXTERNAL
6068: 0000:      INTEGER*2 CCITM.SET
6069: 0000:   END FUNCTION
6070: 0000: 
6071: 0000: 
6072: 0000:   FUNCTION READ.CCITM EXTERNAL
6073: 0000:     INTEGER*2 READ.CCITM
6074: 0000:   END FUNCTION
6075: 0000:   
6076: 0000: 
6077: 0000:   FUNCTION READ.CCITM.LOCKED EXTERNAL
6078: 0000:     INTEGER*2 READ.CCITM.LOCKED
6079: 0000:   END FUNCTION  
6080: 0000: 
6081: 0000: 
6082: 0000:   FUNCTION WRITE.HOLD.CCITM EXTERNAL
6083: 0000:     INTEGER*2 WRITE.HOLD.CCITM
6084: 0000:   END FUNCTION
6085: 0000: 
6086: 0000: 
6087: 0000:   FUNCTION WRITE.UNLOCK.CCITM EXTERNAL
6088: 0000:     INTEGER*2 WRITE.UNLOCK.CCITM
6089: 0000:   END FUNCTION
6090: 0000: 
6091: 0000: 
6092: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCITM EXTERNAL
6093: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCITM
6094: 0000:   END FUNCTION
6095: 0000: 
6096: 0000: 
6097: 0000:   FUNCTION WRITE.CCITM EXTERNAL
6098: 0000:     INTEGER*2 WRITE.CCITM
6099: 0000:   END FUNCTION
6100: 0000: 
6101: 0000:  %INCLUDE CCTRLEXT.J86                    ! GMJK
6102: 0000: 
6103: 0000: \*****************************************************************************
6104: 0000: \*****************************************************************************
6105: 0000: \***
6106: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6107: 0000: \***
6108: 0000: \***                   FILE TYPE:  DIRECT
6109: 0000: \***
6110: 0000: \***                   REFERENCE:  CCTRLEXT.J86
6111: 0000: \***
6112: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6113: 0000: \***				   CREDIT CLAIMS CONTROL FILE
6114: 0000: \***
6115: 0000: \***
6116: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
6117: 0000: \***      
6118: 0000: \*****************************************************************************
6119: 0000: \*****************************************************************************
6120: 0000: 
6121: 0000: 
6122: 0000:   FUNCTION CCTRL.SET EXTERNAL
6123: 0000:      INTEGER*2 CCTRL.SET
6124: 0000:   END FUNCTION
6125: 0000: 
6126: 0000: 
6127: 0000:   FUNCTION READ.CCTRL EXTERNAL
6128: 0000:     INTEGER*2 READ.CCTRL
6129: 0000:   END FUNCTION
6130: 0000:   
6131: 0000: 
6132: 0000:   FUNCTION READ.CCTRL.LOCKED EXTERNAL
6133: 0000:     INTEGER*2 READ.CCTRL.LOCKED
6134: 0000:   END FUNCTION  
6135: 0000: 
6136: 0000: 
6137: 0000:   FUNCTION WRITE.HOLD.CCTRL EXTERNAL
6138: 0000:     INTEGER*2 WRITE.HOLD.CCTRL
6139: 0000:   END FUNCTION
6140: 0000: 
6141: 0000: 
6142: 0000:   FUNCTION WRITE.UNLOCK.CCTRL EXTERNAL
6143: 0000:     INTEGER*2 WRITE.UNLOCK.CCTRL
6144: 0000:   END FUNCTION
6145: 0000: 
6146: 0000: 
6147: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCTRL EXTERNAL
6148: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCTRL
6149: 0000:   END FUNCTION
6150: 0000:   
6151: 0000: 
6152: 0000:   FUNCTION WRITE.CCTRL EXTERNAL
6153: 0000:     INTEGER*2 WRITE.CCTRL
6154: 0000:   END FUNCTION
6155: 0000: 
6156: 0000:  %INCLUDE CCTMPEXT.J86                    ! GMJK
6157: 0000: \*******************************************************************************
6158: 0000: \*******************************************************************************
6159: 0000: \***
6160: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6161: 0000: \***
6162: 0000: \***                    REFERENCE    : CCTMPEXT.BAS
6163: 0000: \***
6164: 0000: \***    Version A.         Michael Kelsall              30th September 1993
6165: 0000: \***
6166: 0000: \*******************************************************************************
6167: 0000: \*******************************************************************************
6168: 0000: 
6169: 0000:  
6170: 0000:   FUNCTION CCTMP.SET EXTERNAL
6171: 0000:       INTEGER*2 CCTMP.SET
6172: 0000:   END FUNCTION
6173: 0000: 
6174: 0000: 
6175: 0000:   FUNCTION READ.CCTMP EXTERNAL
6176: 0000:       INTEGER*2 READ.CCTMP 
6177: 0000:   END FUNCTION
6178: 0000: 
6179: 0000:   
6180: 0000:   FUNCTION WRITE.CCTMP EXTERNAL
6181: 0000:       INTEGER*2 WRITE.CCTMP
6182: 0000:   END FUNCTION
6183: 0000: 
6184: 0000:   
6185: 0000:   FUNCTION WRITE.HOLD.CCTMP EXTERNAL
6186: 0000:       INTEGER*2 WRITE.HOLD.CCTMP						
6187: 0000:   END FUNCTION								
6188: 0000: 
6189: 0000:  %INCLUDE CCBUFEXT.J86                    ! GMJK
6190: 0000: \*******************************************************************************
6191: 0000: \*******************************************************************************
6192: 0000: \***
6193: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6194: 0000: \***
6195: 0000: \***                    REFERENCE    : CCBUFEXT.BAS
6196: 0000: \***
6197: 0000: \***    Version A.         Michael Kelsall              30th September 1993
6198: 0000: \***
6199: 0000: \*******************************************************************************
6200: 0000: \*******************************************************************************
6201: 0000: 
6202: 0000:  
6203: 0000:   FUNCTION CCBUF.SET EXTERNAL
6204: 0000:       INTEGER*2 CCBUF.SET
6205: 0000:   END FUNCTION
6206: 0000: 
6207: 0000: 
6208: 0000:   FUNCTION READ.CCBUF EXTERNAL
6209: 0000:       INTEGER*2 READ.CCBUF 
6210: 0000:   END FUNCTION
6211: 0000: 
6212: 0000:   
6213: 0000:   FUNCTION WRITE.CCBUF EXTERNAL
6214: 0000:       INTEGER*2 WRITE.CCBUF
6215: 0000:   END FUNCTION
6216: 0000: 
6217: 0000:   
6218: 0000:   FUNCTION WRITE.HOLD.CCBUF EXTERNAL
6219: 0000:       INTEGER*2 WRITE.HOLD.CCBUF						
6220: 0000:   END FUNCTION								
6221: 0000: 
6222: 0000:  %INCLUDE CCUPFEXT.J86                    ! HMJK
6223: 0000: 
6224: 0000: \*****************************************************************************
6225: 0000: \*****************************************************************************
6226: 0000: \***
6227: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6228: 0000: \***
6229: 0000: \***                   FILE TYPE:  KEYED
6230: 0000: \***
6231: 0000: \***                   REFERENCE:  CCUPFEXT.J86
6232: 0000: \***
6233: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6234: 0000: \***				   UOD PROCESSED FILE 
6235: 0000: \***
6236: 0000: \***      VERSION A : Michael J. Kelsall      14th March 1994
6237: 0000: \***      
6238: 0000: \*****************************************************************************
6239: 0000: \*****************************************************************************
6240: 0000: 
6241: 0000: 
6242: 0000:   FUNCTION CCUPF.SET EXTERNAL
6243: 0000:      INTEGER*2 CCUPF.SET
6244: 0000:   END FUNCTION
6245: 0000: 
6246: 0000: 
6247: 0000:   FUNCTION READ.CCUPF EXTERNAL
6248: 0000:     INTEGER*2 READ.CCUPF
6249: 0000:   END FUNCTION
6250: 0000:   
6251: 0000: 
6252: 0000:   FUNCTION READ.CCUPF.LOCKED EXTERNAL
6253: 0000:     INTEGER*2 READ.CCUPF.LOCKED
6254: 0000:   END FUNCTION  
6255: 0000: 
6256: 0000: 
6257: 0000:   FUNCTION WRITE.HOLD.CCUPF EXTERNAL
6258: 0000:     INTEGER*2 WRITE.HOLD.CCUPF
6259: 0000:   END FUNCTION
6260: 0000: 
6261: 0000: 
6262: 0000:   FUNCTION WRITE.UNLOCK.CCUPF EXTERNAL
6263: 0000:     INTEGER*2 WRITE.UNLOCK.CCUPF
6264: 0000:   END FUNCTION
6265: 0000: 
6266: 0000: 
6267: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCUPF EXTERNAL
6268: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUPF
6269: 0000:   END FUNCTION
6270: 0000: 
6271: 0000: 
6272: 0000:   FUNCTION WRITE.CCUPF EXTERNAL
6273: 0000:     INTEGER*2 WRITE.CCUPF
6274: 0000:   END FUNCTION
6275: 0000: 
6276: 0000:  %INCLUDE CCWKFEXT.J86                    ! GMJK
6277: 0000: \*****************************************************************************
6278: 0000: \*****************************************************************************
6279: 0000: \***
6280: 0000: \***       EXTERNAL FUNCTION DEFINTIONS FOR CCWKF - RETURNS WORK FILE
6281: 0000: \***
6282: 0000: \***                      REFERENCE: CCWKFEXT.J86
6283: 0000: \***
6284: 0000: \***    Version A          Michael J. Kelsall            30th September 1993
6285: 0000: \***
6286: 0000: \*****************************************************************************
6287: 0000: \*****************************************************************************
6288: 0000: 
6289: 0000:    FUNCTION CCWKF.SET EXTERNAL
6290: 0000:       INTEGER*2 CCWKF.SET
6291: 0000:    END FUNCTION
6292: 0000:    
6293: 0000:    FUNCTION READ.CCWKF EXTERNAL
6294: 0000:       INTEGER*2 READ.CCWKF
6295: 0000:    END FUNCTION
6296: 0000:    
6297: 0000:    FUNCTION WRITE.CCWKF EXTERNAL
6298: 0000:       INTEGER*2 WRITE.CCWKF
6299: 0000:    END FUNCTION
6300: 0000:    
6301: 0000:  %INCLUDE CCDMYEXT.J86                    ! GMJK
6302: 0000: \*****************************************************************************
6303: 0000: \*****************************************************************************
6304: 0000: \***
6305: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR RETURNS DUMMY FILE
6306: 0000: \***
6307: 0000: \***                      REFERENCE: CCDMYEXT.J86
6308: 0000: \***
6309: 0000: \***    Version A       Michael J. Kelsall             30th September 1993
6310: 0000: \***
6311: 0000: \*****************************************************************************
6312: 0000: \*****************************************************************************
6313: 0000: 
6314: 0000:    FUNCTION CCDMY.SET EXTERNAL
6315: 0000:       INTEGER*2 CCDMY.SET
6316: 0000:    END FUNCTION
6317: 0000:    
6318: 0000:    
6319: 0000:  %INCLUDE LDTAFEXT.J86                    ! HMJK
6320: 0000: 
6321: 0000: \*****************************************************************************
6322: 0000: \*****************************************************************************
6323: 0000: \***
6324: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6325: 0000: \***
6326: 0000: \***                   FILE TYPE:  DIRECT
6327: 0000: \***
6328: 0000: \***                   REFERENCE:  LDTAFEXT.J86
6329: 0000: \***
6330: 0000: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
6331: 0000: \***
6332: 0000: \***
6333: 0000: \***      VERSION A        Michael J. Kelsall        30th September 1993
6334: 0000: \*** 
6335: 0000: \***      VERSION B        Michael J. Kelsall        25th March 1994
6336: 0000: \***      No change to external definitions.
6337: 0000: \***      
6338: 0000: \*****************************************************************************
6339: 0000: \*****************************************************************************
6340: 0000: 
6341: 0000: 
6342: 0000:   FUNCTION LDTAF.SET EXTERNAL
6343: 0000:      INTEGER*2 LDTAF.SET
6344: 0000:   END FUNCTION
6345: 0000: 
6346: 0000: 
6347: 0000:   FUNCTION READ.LDTAF EXTERNAL
6348: 0000:     INTEGER*2 READ.LDTAF
6349: 0000:   END FUNCTION
6350: 0000:   
6351: 0000: 
6352: 0000:   FUNCTION WRITE.HOLD.LDTAF EXTERNAL
6353: 0000:     INTEGER*2 WRITE.HOLD.LDTAF
6354: 0000:   END FUNCTION
6355: 0000: 
6356: 0000: 
6357: 0000:   FUNCTION WRITE.LDTAF EXTERNAL
6358: 0000:     INTEGER*2 WRITE.LDTAF
6359: 0000:   END FUNCTION
6360: 0000: 
6361: 0000:  %INCLUDE SOFTSEXT.J86                    ! GMJK
6362: 0000: \*******************************************************************************
6363: 0000: \***                                                                         ***
6364: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE SOFTWARE STATUS FILE         ***
6365: 0000: \***                                                                         ***
6366: 0000: \***                     REFERENCE : SOFTSEXT.J86                            ***
6367: 0000: \***                                                                         ***
6368: 0000: \***      Version A         Andrew Wedgeworth          1st July 1992         ***
6369: 0000: \***
6370: 0000: \***   Version B
6371: 0000: \***                                                                      ***
6372: 0000: \***      Version C         Steve Wright               3rd May 1996          ***
6373: 0000: \***      Synchronise with function source.                                  ***
6374: 0000: \*******************************************************************************
6375: 0000: 
6376: 0000:       FUNCTION SOFTS.SET EXTERNAL 
6377: 0000:       END FUNCTION
6378: 0000:       
6379: 0000:       FUNCTION READ.SOFTS EXTERNAL
6380: 0000:           INTEGER*2 I%, READ.SOFTS
6381: 0000:       END FUNCTION	                   
6382: 0000: 
6383: 0000:       FUNCTION WRITE.SOFTS EXTERNAL
6384: 0000:           INTEGER*2 I%, WRITE.SOFTS
6385: 0000:       END FUNCTION
6386: 0000: 
6387: 0000: 
6388: 0000:  %INCLUDE STKBFEXT.J86                    ! 1.5
6389: 0000: \******************************************************************************
6390: 0000: \******************************************************************************
6391: 0000: \***
6392: 0000: \***   $Workfile:   STKBFEXT.J86  $
6393: 0000: \***
6394: 0000: \***   $Revision:   1.0  $
6395: 0000: \***
6396: 0000: \******************************************************************************
6397: 0000: \******************************************************************************
6398: 0000: \***
6399: 0000: \***   $Log:   V:\archive\j86\stkbfext.j8v  $
6400: 0000: \***   
6401: 0000: \***      Rev 1.0   15 Jul 1997 14:20:38   DEV45PS
6402: 0000: \***    
6403: 0000: \***   
6404: 0000: \***      Rev 1.0   09 Jul 1997 11:04:54   DEV45PS
6405: 0000: \***   Stocktake System New Files
6406: 0000: \***   
6407: 0000: \******************************************************************************
6408: 0000: \******************************************************************************\*****************************************************************************
6409: 0000: \***
6410: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE BUFFER FILE
6411: 0000: \***
6412: 0000: \***           REFERENCE:   STKBFEXT.J86
6413: 0000: \***
6414: 0000: \***           VERSION A         Nik Sen         19th June 1997
6415: 0000: \***
6416: 0000: \***
6417: 0000: \*******************************************************************************
6418: 0000: \*******************************************************************************
6419: 0000: 
6420: 0000:    FUNCTION STKBF.SET EXTERNAL
6421: 0000:    END FUNCTION
6422: 0000:    
6423: 0000:    FUNCTION READ.STKBF EXTERNAL
6424: 0000:       INTEGER*2 READ.STKBF
6425: 0000:    END FUNCTION
6426: 0000:    
6427: 0000:    FUNCTION WRITE.STKBF EXTERNAL
6428: 0000:       INTEGER*2 WRITE.STKBF
6429: 0000:    END FUNCTION
6430: 0000:  
6431: 0000:  %INCLUDE SXTMPEXT.J86                    ! 1.5
6432: 0000: \*****************************************************************************
6433: 0000: \***
6434: 0000: \***           FUNCTION DEFINITIONS FOR THE TEMPORARY STOCKTAKE BUFFER FILE
6435: 0000: \***
6436: 0000: \***           REFERENCE:   STKBFEXT.J86
6437: 0000: \***
6438: 0000: \***           VERSION A         Nik Sen         30th June 1997
6439: 0000: \***
6440: 0000: \***
6441: 0000: \*******************************************************************************
6442: 0000: \*******************************************************************************
6443: 0000: 
6444: 0000:    FUNCTION SXTMP.SET EXTERNAL
6445: 0000:    END FUNCTION
6446: 0000:    
6447: 0000:    FUNCTION READ.SXTMP EXTERNAL
6448: 0000:       INTEGER*2 READ.SXTMP
6449: 0000:    END FUNCTION
6450: 0000:    
6451: 0000:    FUNCTION WRITE.SXTMP EXTERNAL
6452: 0000:       INTEGER*2 WRITE.SXTMP
6453: 0000:    END FUNCTION
6454: 0000:  
6455: 0000:  %INCLUDE STKTKEXT.J86                    ! 1.5
6456: 0000: \*****************************************************************************
6457: 0000: \*****************************************************************************
6458: 0000: \***
6459: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCKTAKE
6460: 0000: \***
6461: 0000: \***      REFERENCE: STKTKEXT.J86
6462: 0000: \***
6463: 0000: \*****************************************************************************
6464: 0000: \*****************************************************************************
6465: 0000: 
6466: 0000: 
6467: 0000:    FUNCTION STKTK.SET EXTERNAL
6468: 0000:    END FUNCTION
6469: 0000:    
6470: 0000:  %INCLUDE STLDTEXT.J86                    ! 1.6
6471: 0000: \*****************************************************************************
6472: 0000: \*****************************************************************************
6473: 0000: \***
6474: 0000: \***                   FUNCTION DEFINITIONS FOR THE STLDT
6475: 0000: \***
6476: 0000: \***           Version A           David Artiss         20th December 2000
6477: 0000: \***
6478: 0000: \*****************************************************************************
6479: 0000: \*****************************************************************************
6480: 0000: 
6481: 0000:    FUNCTION STLDT.SET EXTERNAL
6482: 0000:    END FUNCTION
6483: 0000: 
6484: 0000:   FUNCTION READ.STLDT EXTERNAL
6485: 0000:    INTEGER*2 READ.STLDT
6486: 0000:   END FUNCTION
6487: 0000: 
6488: 0000:   FUNCTION WRITE.STLDT EXTERNAL
6489: 0000:    INTEGER*2 WRITE.STLDT
6490: 0000:   END FUNCTION
6491: 0000:  %INCLUDE SXTCFEXT.J86                    ! 1.8DA
6492: 0000: \******************************************************************************
6493: 0000: \******************************************************************************
6494: 0000: \***
6495: 0000: \***   $Workfile:   SXTCFEXT.J86  $
6496: 0000: \***
6497: 0000: \***   $Revision:   1.0  $
6498: 0000: \***
6499: 0000: \******************************************************************************
6500: 0000: \******************************************************************************
6501: 0000: \***
6502: 0000: \***   $Log:   V:\archive\j86\sxtcfext.j8v  $
6503: 0000: \***   
6504: 0000: \***      Rev 1.0   15 Jul 1997 14:21:08   DEV45PS
6505: 0000: \***    
6506: 0000: \***   
6507: 0000: \***      Rev 1.0   09 Jul 1997 11:05:30   DEV45PS
6508: 0000: \***   Stocktake System New Files
6509: 0000: \***   
6510: 0000: \******************************************************************************
6511: 0000: \******************************************************************************\*****************************************************************************
6512: 0000: \*****************************************************************************
6513: 0000: \***
6514: 0000: \***                  FUNCTION DEFINITIONS FOR SXTCF
6515: 0000: \***
6516: 0000: \***                      REFERENCE    : SXTCFEXA
6517: 0000: \***
6518: 0000: \***           VERSION A : NIK SEN  3rd July 1997
6519: 0000: \***
6520: 0000: \*****************************************************************************
6521: 0000: \*****************************************************************************
6522: 0000: 
6523: 0000:    FUNCTION SXTCF.SET EXTERNAL
6524: 0000:    END FUNCTION
6525: 0000: 
6526: 0000:   FUNCTION READ.SXTCF.LOCK EXTERNAL
6527: 0000:    INTEGER*1 READ.SXTCF.LOCK
6528: 0000:   END FUNCTION
6529: 0000: 
6530: 0000:   FUNCTION WRITE.SXTCF.UNLOCK EXTERNAL
6531: 0000:    INTEGER*1 WRITE.SXTCF.UNLOCK
6532: 0000:   END FUNCTION
6533: 0000: 
6534: 0000:   FUNCTION WRITE.SXTCF.UNLOCK.HOLD EXTERNAL
6535: 0000:    INTEGER*1 WRITE.SXTCF.UNLOCK.HOLD
6536: 0000:   END FUNCTION
6537: 0000: 
6538: 0000:   FUNCTION READ.SXTCF EXTERNAL
6539: 0000:    INTEGER*1 READ.SXTCF
6540: 0000:   END FUNCTION
6541: 0000: 
6542: 0000:   FUNCTION WRITE.SXTCF         EXTERNAL
6543: 0000:    INTEGER*1 WRITE.SXTCF        
6544: 0000:   END FUNCTION
6545: 0000: 
6546: 0000:  %INCLUDE STKCFEXT.J86                    ! 1.8DA
6547: 0000: \*****************************************************************************
6548: 0000: \*****************************************************************************
6549: 0000: \***
6550: 0000: \***                  FUNCTION DEFINITIONS FOR STKCF
6551: 0000: \***
6552: 0000: \***                      REFERENCE    : STKCFEXA
6553: 0000: \***
6554: 0000: \***           VERSION A : STEVEN GOULDING  11.01.93
6555: 0000: \***
6556: 0000: \*****************************************************************************
6557: 0000: \*****************************************************************************
6558: 0000: 
6559: 0000:    FUNCTION STKCF.SET EXTERNAL
6560: 0000:    END FUNCTION
6561: 0000: 
6562: 0000:   FUNCTION READ.STKCF.LOCK EXTERNAL
6563: 0000:    INTEGER*1 READ.STKCF.LOCK
6564: 0000:   END FUNCTION
6565: 0000: 
6566: 0000:   FUNCTION WRITE.STKCF.UNLOCK EXTERNAL
6567: 0000:    INTEGER*1 WRITE.STKCF.UNLOCK
6568: 0000:   END FUNCTION
6569: 0000: 
6570: 0000:   FUNCTION WRITE.STKCF.UNLOCK.HOLD EXTERNAL
6571: 0000:    INTEGER*1 WRITE.STKCF.UNLOCK.HOLD
6572: 0000:   END FUNCTION
6573: 0000: 
6574: 0000:   FUNCTION READ.STKCF EXTERNAL
6575: 0000:    INTEGER*1 READ.STKCF
6576: 0000:   END FUNCTION
6577: 0000: 
6578: 0000:   FUNCTION WRITE.STKCF         EXTERNAL
6579: 0000:    INTEGER*1 WRITE.STKCF        
6580: 0000:   END FUNCTION
6581: 0000: 
6582: 0000:  %INCLUDE STKMFEXT.J86                    ! 1.8DA
6583: 0000: \******************************************************************************
6584: 0000: \******************************************************************************
6585: 0000: \***
6586: 0000: \***   $Workfile:   STKMFEXT.J86  $
6587: 0000: \***
6588: 0000: \***   $Revision:   1.0  $
6589: 0000: \***
6590: 0000: \******************************************************************************
6591: 0000: \******************************************************************************
6592: 0000: \***
6593: 0000: \***   $Log:   V:\archive\j86\stkmfext.j8v  $
6594: 0000: \***   
6595: 0000: \***      Rev 1.0   15 Jul 1997 14:20:56   DEV45PS
6596: 0000: \***    
6597: 0000: \***   
6598: 0000: \***      Rev 1.0   09 Jul 1997 11:05:18   DEV45PS
6599: 0000: \***   Stocktake System New Files
6600: 0000: \***   
6601: 0000: \******************************************************************************
6602: 0000: \******************************************************************************\*****************************************************************************
6603: 0000: \***
6604: 0000: \***  FUNCTION DEFINITIONS FOR THE STOCKTAKE MAINFRAME TRANSMISSION FILE
6605: 0000: \***
6606: 0000: \***           REFERENCE:   STKMFEXT.J86
6607: 0000: \***
6608: 0000: \***           VERSION A         Nik Sen         19th June 1997
6609: 0000: \***
6610: 0000: \***
6611: 0000: \*******************************************************************************
6612: 0000: \*******************************************************************************
6613: 0000: 
6614: 0000:    FUNCTION STKMF.SET EXTERNAL
6615: 0000:    END FUNCTION
6616: 0000:    
6617: 0000:    FUNCTION READ.STKMF EXTERNAL
6618: 0000:       INTEGER*2 READ.STKMF
6619: 0000:    END FUNCTION
6620: 0000:    
6621: 0000:    FUNCTION WRITE.STKMF EXTERNAL
6622: 0000:       INTEGER*2 WRITE.STKMF
6623: 0000:    END FUNCTION
6624: 0000:  
6625: 0000:  %INCLUDE STKRCEXT.J86                    ! 1.8DA
6626: 0000: \******************************************************************************
6627: 0000: \******************************************************************************
6628: 0000: \***
6629: 0000: \***   $Workfile:   STKRCEXT.J86  $
6630: 0000: \***
6631: 0000: \***   $Revision:   1.0  $
6632: 0000: \***
6633: 0000: \******************************************************************************
6634: 0000: \******************************************************************************
6635: 0000: \***
6636: 0000: \***   $Log:   V:\archive\j86\stkrcext.j8v  $
6637: 0000: \***   
6638: 0000: \***      Rev 1.0   15 Jul 1997 14:21:00   DEV45PS
6639: 0000: \***    
6640: 0000: \***   
6641: 0000: \***      Rev 1.0   09 Jul 1997 11:05:24   DEV45PS
6642: 0000: \***   Stocktake System New Files
6643: 0000: \***   
6644: 0000: \******************************************************************************
6645: 0000: \******************************************************************************\*****************************************************************************
6646: 0000: \***
6647: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE RECOUNT FILE
6648: 0000: \***
6649: 0000: \***           REFERENCE:   STKRCEXT.J86
6650: 0000: \***
6651: 0000: \***           VERSION A         Nik Sen         19th June 1997
6652: 0000: \***
6653: 0000: \***
6654: 0000: \*******************************************************************************
6655: 0000: \*******************************************************************************
6656: 0000: 
6657: 0000:    FUNCTION STKRC.SET EXTERNAL
6658: 0000:    END FUNCTION
6659: 0000:    
6660: 0000:    FUNCTION READ.STKRC EXTERNAL
6661: 0000:       INTEGER*2 READ.STKRC
6662: 0000:    END FUNCTION
6663: 0000:    
6664: 0000:    FUNCTION WRITE.STKRC EXTERNAL
6665: 0000:       INTEGER*2 WRITE.STKRC
6666: 0000:    END FUNCTION
6667: 0000:  
6668: 0000:  %INCLUDE XGCFEXT.J86                     ! 1.8DA
6669: 0000: \******************************************************************************
6670: 0000: \******************************************************************************
6671: 0000: \***
6672: 0000: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
6673: 0000: \***
6674: 0000: \***                  FILE TYPE    : Keyed
6675: 0000: \***
6676: 0000: \***                  REFERENCE    : XGCFEXT.J86
6677: 0000: \***
6678: 0000: \***    VERSION A               Steve Wright                        24 Aug 1999
6679: 0000: \***
6680: 0000: \*******************************************************************************
6681: 0000: \*******************************************************************************
6682: 0000: 
6683: 0000: FUNCTION XGCF.SET EXTERNAL
6684: 0000: END FUNCTION
6685: 0000: 
6686: 0000: FUNCTION READ.XGCF EXTERNAL
6687: 0000:    INTEGER*2 READ.XGCF
6688: 0000: END FUNCTION
6689: 0000: 
6690: 0000: FUNCTION READ.XGCF.LOCK EXTERNAL
6691: 0000:    INTEGER*2 READ.XGCF.LOCK
6692: 0000: END FUNCTION
6693: 0000: 
6694: 0000: FUNCTION WRITE.XGCF EXTERNAL
6695: 0000:    INTEGER*2 WRITE.XGCF
6696: 0000: END FUNCTION
6697: 0000: 
6698: 0000: FUNCTION WRITE.XGCF.HOLD EXTERNAL
6699: 0000:    INTEGER*2 WRITE.XGCF.HOLD
6700: 0000: END FUNCTION
6701: 0000: 
6702: 0000: FUNCTION WRITE.XGCF.UNLOCK EXTERNAL
6703: 0000:    INTEGER*2 WRITE.XGCF.UNLOCK
6704: 0000: END FUNCTION
6705: 0000: 
6706: 0000:  %INCLUDE STKEXEXT.J86                    ! 1.8DA
6707: 0000: \******************************************************************************
6708: 0000: \******************************************************************************
6709: 0000: \***
6710: 0000: \***   $Workfile:   STKEXEXT.J86  $
6711: 0000: \***
6712: 0000: \***   $Revision:   1.0  $
6713: 0000: \***
6714: 0000: \******************************************************************************
6715: 0000: \******************************************************************************
6716: 0000: \***
6717: 0000: \***   $Log:   V:\archive\j86\stkexext.j8v  $
6718: 0000: \***   
6719: 0000: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
6720: 0000: \***    
6721: 0000: \***   
6722: 0000: \***      Rev 1.0   09 Jul 1997 11:05:06   DEV45PS
6723: 0000: \***   Stocktake System New Files
6724: 0000: \***   
6725: 0000: \******************************************************************************
6726: 0000: \******************************************************************************\*****************************************************************************
6727: 0000: \***
6728: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE EXCEPTIONS FILE
6729: 0000: \***
6730: 0000: \***           REFERENCE:   STKEXEXT.J86
6731: 0000: \***
6732: 0000: \***           VERSION A         Nik Sen         19th June 1997
6733: 0000: \***
6734: 0000: \***
6735: 0000: \*******************************************************************************
6736: 0000: \*******************************************************************************
6737: 0000: 
6738: 0000:    FUNCTION STKEX.SET EXTERNAL
6739: 0000:    END FUNCTION
6740: 0000:    
6741: 0000:    FUNCTION READ.STKEX EXTERNAL
6742: 0000:       INTEGER*2 READ.STKEX
6743: 0000:    END FUNCTION
6744: 0000:    
6745: 0000:    FUNCTION WRITE.STKEX EXTERNAL
6746: 0000:       INTEGER*2 WRITE.STKEX
6747: 0000:    END FUNCTION
6748: 0000:  
6749: 0000:  %INCLUDE STKIFEXT.J86                    ! 1.8DA
6750: 0000: \******************************************************************************
6751: 0000: \******************************************************************************
6752: 0000: \***
6753: 0000: \***   $Workfile:   STKIFEXT.J86  $
6754: 0000: \***
6755: 0000: \***   $Revision:   1.0  $
6756: 0000: \***
6757: 0000: \******************************************************************************
6758: 0000: \******************************************************************************
6759: 0000: \***
6760: 0000: \***   $Log:   V:\archive\j86\stkifext.j8v  $
6761: 0000: \***   
6762: 0000: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
6763: 0000: \***    
6764: 0000: \***   
6765: 0000: \***      Rev 1.0   09 Jul 1997 11:05:12   DEV45PS
6766: 0000: \***   Stocktake System New Files
6767: 0000: \***   
6768: 0000: \******************************************************************************
6769: 0000: \******************************************************************************\*****************************************************************************
6770: 0000: \***
6771: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM FILE
6772: 0000: \***
6773: 0000: \***           REFERENCE:   STKIFEXT.J86
6774: 0000: \***
6775: 0000: \***           VERSION A         Nik Sen         19th June 1997
6776: 0000: \***
6777: 0000: \***
6778: 0000: \*******************************************************************************
6779: 0000: \*******************************************************************************
6780: 0000: 
6781: 0000:    FUNCTION STKIF.SET EXTERNAL
6782: 0000:    END FUNCTION
6783: 0000:    
6784: 0000:    FUNCTION READ.STKIF EXTERNAL
6785: 0000:       INTEGER*2 READ.STKIF
6786: 0000:    END FUNCTION
6787: 0000:    
6788: 0000:    FUNCTION WRITE.STKIF EXTERNAL
6789: 0000:       INTEGER*2 WRITE.STKIF
6790: 0000:    END FUNCTION
6791: 0000:  
6792: 0000:  %INCLUDE LOCNTEXT.J86                    ! 1.8DA
6793: 0000: \******************************************************************************
6794: 0000: \******************************************************************************
6795: 0000: \***
6796: 0000: \***   $Workfile:   LOCNTEXT.J86  $
6797: 0000: \***
6798: 0000: \***   $Revision:   1.0  $
6799: 0000: \***
6800: 0000: \******************************************************************************
6801: 0000: \******************************************************************************
6802: 0000: \***
6803: 0000: \***   $Log:   V:\archive\j86\locntext.j8v  $
6804: 0000: \***   
6805: 0000: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
6806: 0000: \***    
6807: 0000: \***   
6808: 0000: \******************************************************************************
6809: 0000: \******************************************************************************
6810: 0000: \***
6811: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE LOCATION COUNT FILE
6812: 0000: \***
6813: 0000: \***           REFERENCE:   LOCNTEXT.J86
6814: 0000: \***
6815: 0000: \***           VERSION A         Johnnie Chan    6th Jan 1998
6816: 0000: \***
6817: 0000: \***
6818: 0000: \*******************************************************************************
6819: 0000: \*******************************************************************************
6820: 0000: 
6821: 0000:    FUNCTION LOCCNT.SET EXTERNAL
6822: 0000:    END FUNCTION
6823: 0000:    
6824: 0000:    FUNCTION READ.LOCCNT EXTERNAL
6825: 0000:       INTEGER*2 READ.LOCCNT
6826: 0000:    END FUNCTION
6827: 0000:    
6828: 0000:    FUNCTION WRITE.LOCCNT EXTERNAL
6829: 0000:       INTEGER*2 WRITE.LOCCNT
6830: 0000:    END FUNCTION
6831: 0000: 
6832: 0000:    FUNCTION GET.LOCCNT.RECNUM(LOC.CODE$) EXTERNAL
6833: 0000:       INTEGER*4 GET.LOCCNT.RECNUM
6834: 0000:       STRING LOC.CODE$
6835: 0000:    END FUNCTION
6836: 0000:  
6837: 0000:  %INCLUDE STKIGEXT.J86                    ! 1.8DA
6838: 0000: \*****************************************************************************
6839: 0000: \***
6840: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM GROUP FILE
6841: 0000: \***
6842: 0000: \***           REFERENCE:   STKIGEXT.J86
6843: 0000: \***
6844: 0000: \***           VERSION A         Nik Sen         17th June 1997
6845: 0000: \***
6846: 0000: \***
6847: 0000: \*******************************************************************************
6848: 0000: \*******************************************************************************
6849: 0000: 
6850: 0000:    FUNCTION STKIG.SET EXTERNAL
6851: 0000:    END FUNCTION
6852: 0000:    
6853: 0000:    FUNCTION READ.STKIG EXTERNAL
6854: 0000:       INTEGER*2 READ.STKIG
6855: 0000:    END FUNCTION
6856: 0000:    
6857: 0000:    FUNCTION WRITE.STKIG EXTERNAL
6858: 0000:       INTEGER*2 WRITE.STKIG
6859: 0000:    END FUNCTION
6860: 0000:  
6861: 0000:  %INCLUDE STKTFEXT.J86                    ! 1.8DA
6862: 0000: \******************************************************************************
6863: 0000: \******************************************************************************
6864: 0000: \***
6865: 0000: \***   $Workfile:   STKTFEXT.J86  $
6866: 0000: \***
6867: 0000: \***   $Revision:   1.1  $
6868: 0000: \***
6869: 0000: \******************************************************************************
6870: 0000: \******************************************************************************
6871: 0000: \***
6872: 0000: \***   $Log:   V:\archive\j86\stktfext.j8v  $
6873: 0000: \***   
6874: 0000: \***      Rev 1.1   15 Jul 1997 14:36:30   DEV45PS
6875: 0000: \***    
6876: 0000: \***   
6877: 0000: \***      Rev 1.0   15 Jul 1997 14:21:04   DEV45PS
6878: 0000: \***   Stocktake System New Files
6879: 0000: \***   
6880: 0000: \******************************************************************************
6881: 0000: \******************************************************************************\*****************************************************************************
6882: 0000: \***
6883: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE TOTALS FILE
6884: 0000: \***
6885: 0000: \***           REFERENCE:   STKTFEXT.J86
6886: 0000: \***
6887: 0000: \***           VERSION A         Nik Sen         15th July 1997
6888: 0000: \***
6889: 0000: \***
6890: 0000: \*******************************************************************************
6891: 0000: \*******************************************************************************
6892: 0000: 
6893: 0000:    FUNCTION STKTF.SET EXTERNAL
6894: 0000:    END FUNCTION
6895: 0000:    
6896: 0000:    FUNCTION READ.STKTF EXTERNAL
6897: 0000:       INTEGER*2 READ.STKTF
6898: 0000:    END FUNCTION
6899: 0000:    
6900: 0000:    FUNCTION WRITE.STKTF EXTERNAL
6901: 0000:       INTEGER*2 WRITE.STKTF
6902: 0000:    END FUNCTION
6903: 0000:  
6904: 0000:  %INCLUDE IRFEXT.J86                      ! 1.8DA
6905: 0000: \*********************************************************************************
6906: 0000: \***
6907: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM REFERENCE FILE
6908: 0000: \***
6909: 0000: \***                    REFERENCE : IRFEXT.J86
6910: 0000: \***
6911: 0000: \***      Version A          Andrew Wedgeworth        9th July 1992
6912: 0000: \***
6913: 0000: \***      Version B          Andrew Wedgeworth        14th December 1992
6914: 0000: \***      Version letter incremented to match other IRF code.
6915: 0000: \***
6916: 0000: \***      Version C           Steve Windsor        12.02.93
6917: 0000: \***      Added external reference to read the alternate IRF.
6918: 0000: \***
6919: 0000: \***      Version D           Steve Windsor        12.05.93
6920: 0000: \***      Added all external references that wre in the original FNS.
6921: 0000: \***
6922: 0000: \***      Version E           Steve Perkins        21.09.93
6923: 0000: \***      Deals project: Fields changed for new deals project
6924: 0000: \*** 
6925: 0000: \***      Version F           Mark Walker          5th January 1994
6926: 0000: \***      Version letter incremented to match other IRF code.           
6927: 0000: \***                                                                    
6928: 0000: \***      Version G     Stuart William McConnachie      11th February 2000
6929: 0000: \***      Converted IRF.INDICAT2$ to integer flag byte.
6930: 0000: \***
6931: 0000: \***      REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
6932: 0000: \***      Major changes to IRF layout for 2002 Deals Rewrite project.
6933: 0000: \***      No changes to this particular file for this revision.
6934: 0000: \***
6935: 0000: \***      REVISION 1.7.               ROBERT COWEY.               5 AUG 2002.
6936: 0000: \***      Further changes for 2002 Deals Rewrite project (PSBF19 related).
6937: 0000: \***      Defined new functions CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
6938: 0000: \***
6939: 0000: \***      REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
6940: 0000: \***      Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
6941: 0000: \***      No changes to this file other than description.
6942: 0000: \***      No changes to IRF file functions.
6943: 0000: \***
6944: 0000: \***      REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
6945: 0000: \***      Changes to remove limit of 3 deals per item.
6946: 0000: \***      No changes to this file.
6947: 0000: \***
6948: 0000: \***      REVISION 2.0.             ALAN CARR                      9 FEB 2006.
6949: 0000: \***      Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
6950: 0000: \***      No changes to this file.
6951: 0000: \***
6952: 0000: \***..............................................................................
6953: 0000:    
6954: 0000:    FUNCTION IRF.SET EXTERNAL
6955: 0000:    END FUNCTION
6956: 0000: 
6957: 0000:   FUNCTION CONCAT.NEW.IRF.DATA$ EXTERNAL                                  ! 1.7 RC
6958: 0000:   END FUNCTION                                                            ! 1.7 RC
6959: 0000: 
6960: 0000:   FUNCTION SPLIT.NEW.IRF.DATA$ EXTERNAL                                   ! 1.7 RC
6961: 0000:   END FUNCTION                                                            ! 1.7 RC
6962: 0000:   
6963: 0000:   FUNCTION READ.IRF EXTERNAL
6964: 0000:    INTEGER*2 READ.IRF
6965: 0000:   END FUNCTION
6966: 0000: 
6967: 0000:   FUNCTION READ.IRF.ALT EXTERNAL
6968: 0000:    INTEGER*2 READ.IRF.ALT
6969: 0000:   END FUNCTION
6970: 0000: 
6971: 0000:   FUNCTION READ.IRF.LOCK EXTERNAL
6972: 0000:    INTEGER*2 READ.IRF.LOCK
6973: 0000:   END FUNCTION
6974: 0000: 
6975: 0000:   FUNCTION WRITE.IRF EXTERNAL
6976: 0000:    INTEGER*2 WRITE.IRF
6977: 0000:   END FUNCTION
6978: 0000: 
6979: 0000:   FUNCTION WRITE.IRF.UNLOCK EXTERNAL
6980: 0000:    INTEGER*2 WRITE.IRF.UNLOCK
6981: 0000:   END FUNCTION
6982: 0000: 
6983: 0000:   FUNCTION WRITE.IRF.HOLD EXTERNAL
6984: 0000:    INTEGER*2 WRITE.IRF.HOLD
6985: 0000:   END FUNCTION
6986: 0000: 
6987: 0000:   FUNCTION WRITE.IRF.HOLD.UNLOCK EXTERNAL
6988: 0000:    INTEGER*2 WRITE.IRF.HOLD.UNLOCK
6989: 0000:   END FUNCTION
6990: 0000: 
6991: 0000:   
6992: 0000:  %INCLUDE STKDCEXT.J86                    ! 1.8DA
6993: 0000: \******************************************************************************
6994: 0000: \******************************************************************************
6995: 0000: \***
6996: 0000: \***   $Workfile:   STKDCEXT.J86  $
6997: 0000: \***
6998: 0000: \***   $Revision:   1.0  $
6999: 0000: \***
7000: 0000: \******************************************************************************
7001: 0000: \******************************************************************************
7002: 0000: \***
7003: 0000: \***   $Log:   V:\archive\j86\stkdcext.j8v  $
7004: 0000: \***   
7005: 0000: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
7006: 0000: \***    
7007: 0000: \***   
7008: 0000: \***      Rev 1.0   09 Jul 1997 11:05:00   DEV45PS
7009: 0000: \***   Stocktake System New Files
7010: 0000: \***   
7011: 0000: \******************************************************************************
7012: 0000: \******************************************************************************\*****************************************************************************
7013: 0000: \***
7014: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE DUMP CODE FILE
7015: 0000: \***
7016: 0000: \***           REFERENCE:   STKDCEXT.J86
7017: 0000: \***
7018: 0000: \***           VERSION A         Nik Sen         19th June 1997
7019: 0000: \***
7020: 0000: \***
7021: 0000: \*******************************************************************************
7022: 0000: \*******************************************************************************
7023: 0000: 
7024: 0000:    FUNCTION STKDC.SET EXTERNAL
7025: 0000:    END FUNCTION
7026: 0000:    
7027: 0000:    FUNCTION READ.STKDC EXTERNAL
7028: 0000:       INTEGER*2 READ.STKDC
7029: 0000:    END FUNCTION
7030: 0000:    
7031: 0000:    FUNCTION WRITE.STKDC EXTERNAL
7032: 0000:       INTEGER*2 WRITE.STKDC
7033: 0000:    END FUNCTION
7034: 0000:  
7035: 0000:  %INCLUDE IMSTCEXT.J86                    ! 1.9BG
7036: 0000: \***********************************************************************
7037: 0000: \***********************************************************************
7038: 0000: \***
7039: 0000: \***    DESCRIPTION: Item Movement & Stock File
7040: 0000: \***                 External File Function Definitions
7041: 0000: \***
7042: 0000: \***    FILE TYPE : Keyed
7043: 0000: \***
7044: 0000: \***********************************************************************
7045: 0000: \***
7046: 0000: \***    Version A.          Les Cook                     21st Aug 1992
7047: 0000: \***    Initial version.
7048: 0000: \***
7049: 0000: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
7050: 0000: \***    Added new external functions for
7051: 0000: \***        MIMSTC - merged IMSTC
7052: 0000: \***        CIMSTC - Copy of IMSTC
7053: 0000: \***        BIMSTC - Backup of IMSTC
7054: 0000: \***
7055: 0000: \***    Version C.          Mark Walker                  23rd Jan 2014
7056: 0000: \***    F337 Centralised View of Stock
7057: 0000: \***    - Moved BIMST, CIMST and MIMST external function definitions
7058: 0000: \***      to separate modules.
7059: 0000: \***    - Minor formatting changes (uncommented).
7060: 0000: \***
7061: 0000: \***********************************************************************
7062: 0000: \***********************************************************************
7063: 0000: 
7064: 0000: FUNCTION IMSTC.SET EXTERNAL
7065: 0000: END FUNCTION
7066: 0000: 
7067: 0000: FUNCTION READ.IMSTC EXTERNAL
7068: 0000:     INTEGER*2 READ.IMSTC
7069: 0000: END FUNCTION
7070: 0000: 
7071: 0000: FUNCTION READ.IMSTC.LOCK EXTERNAL
7072: 0000:     INTEGER*2 READ.IMSTC.LOCK
7073: 0000: END FUNCTION
7074: 0000: 
7075: 0000: FUNCTION WRITE.IMSTC EXTERNAL
7076: 0000:    INTEGER*2 WRITE.IMSTC
7077: 0000: END FUNCTION
7078: 0000: 
7079: 0000: FUNCTION WRITE.IMSTC.UNLOCK.HOLD EXTERNAL
7080: 0000:     INTEGER*2 WRITE.IMSTC.UNLOCK.HOLD
7081: 0000: END FUNCTION
7082: 0000: 
7083: 0000: FUNCTION WRITE.IMSTC.UNLOCK EXTERNAL
7084: 0000:    INTEGER*2 WRITE.IMSTC.UNLOCK
7085: 0000: END FUNCTION
7086: 0000: 
7087: 0000: FUNCTION WRITE.IMSTC.HOLD EXTERNAL
7088: 0000:    INTEGER*2 WRITE.IMSTC.HOLD
7089: 0000: END FUNCTION
7090: 0000: 
7091: 0000:  %INCLUDE STOCKEXT.J86                    ! 1.9BG
7092: 0000: \***********************************************************************
7093: 0000: \***********************************************************************
7094: 0000: \***
7095: 0000: \***    DESCRIPTION: Stock File
7096: 0000: \***                 External File Function Definitions
7097: 0000: \***
7098: 0000: \***    FILE TYPE : Keyed
7099: 0000: \***
7100: 0000: \***********************************************************************
7101: 0000: \***
7102: 0000: \***    Version A.          Les Cook                     21st Aug 1992
7103: 0000: \***    Initial version.
7104: 0000: \***
7105: 0000: \***    Version B.          Robert Cowey                 21st Oct 1993
7106: 0000: \***    No changes to this file.
7107: 0000: \***
7108: 0000: \***    Version C.          Nik Sen                      22nd Dec 1994
7109: 0000: \***    WRITE.STOCK.HOLD added.
7110: 0000: \***
7111: 0000: \***    Version D.          Mark Walker                  23rd Jan 2014
7112: 0000: \***    F337 Centralised View of Stock
7113: 0000: \***    - Minor formatting changes (uncommented).
7114: 0000: \***
7115: 0000: \***********************************************************************
7116: 0000: \***********************************************************************
7117: 0000: 
7118: 0000: FUNCTION STOCK.SET EXTERNAL
7119: 0000: END FUNCTION
7120: 0000:    
7121: 0000: FUNCTION READ.STOCK EXTERNAL
7122: 0000:     INTEGER*2 READ.STOCK
7123: 0000: END FUNCTION
7124: 0000:    
7125: 0000: FUNCTION WRITE.STOCK EXTERNAL
7126: 0000:     INTEGER*2 WRITE.STOCK
7127: 0000: END FUNCTION
7128: 0000:    
7129: 0000: FUNCTION WRITE.STOCK.HOLD EXTERNAL
7130: 0000:     INTEGER*2 WRITE.STOCK.HOLD
7131: 0000: END FUNCTION
7132: 0000: 
7133: 0000: FUNCTION READ.STOCK.LOCK EXTERNAL
7134: 0000:     INTEGER*2 READ.STOCK.LOCK
7135: 0000: END FUNCTION
7136: 0000:    
7137: 0000: FUNCTION WRITE.STOCK.UNLOCK EXTERNAL
7138: 0000:     INTEGER*2 WRITE.STOCK.UNLOCK
7139: 0000: END FUNCTION
7140: 0000:    
7141: 0000: FUNCTION WRITE.STOCK.UNLOCK.HOLD EXTERNAL
7142: 0000:     INTEGER*2 WRITE.STOCK.UNLOCK.HOLD
7143: 0000: END FUNCTION
7144: 0000: 
7145: 0000:  %INCLUDE MINLSEXT.J86                    ! 1.9BG
7146: 0000: 
7147: 0000: \*****************************************************************************
7148: 0000: \*****************************************************************************
7149: 0000: \***
7150: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7151: 0000: \***
7152: 0000: \***                   FILE TYPE:  KEYED
7153: 0000: \***
7154: 0000: \***                   REFERENCE:  MINLSEXT.J86
7155: 0000: \***
7156: 0000: \***	             DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
7157: 0000: \***
7158: 0000: \***
7159: 0000: \***
7160: 0000: \***      VERSION 1 : Julia Stones             8th January 1998   
7161: 0000: \***      
7162: 0000: \*****************************************************************************
7163: 0000: \*****************************************************************************
7164: 0000: 
7165: 0000: 
7166: 0000:   FUNCTION MINLS.SET EXTERNAL
7167: 0000:      INTEGER*2 MINLS.SET
7168: 0000:   END FUNCTION
7169: 0000: 
7170: 0000: 
7171: 0000:   FUNCTION READ.MINLS EXTERNAL
7172: 0000:     INTEGER*2 READ.MINLS
7173: 0000:   END FUNCTION
7174: 0000:   
7175: 0000: 
7176: 0000:   FUNCTION READ.MINLS.LOCKED EXTERNAL
7177: 0000:     INTEGER*2 READ.MINLS.LOCKED
7178: 0000:   END FUNCTION  
7179: 0000: 
7180: 0000: 
7181: 0000:   FUNCTION WRITE.HOLD.MINLS EXTERNAL
7182: 0000:     INTEGER*2 WRITE.HOLD.MINLS
7183: 0000:   END FUNCTION
7184: 0000: 
7185: 0000: 
7186: 0000:   FUNCTION WRITE.UNLOCK.MINLS EXTERNAL
7187: 0000:     INTEGER*2 WRITE.UNLOCK.MINLS
7188: 0000:   END FUNCTION
7189: 0000: 
7190: 0000: 
7191: 0000:   FUNCTION WRITE.HOLD.UNLOCK.MINLS EXTERNAL
7192: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.MINLS
7193: 0000:   END FUNCTION
7194: 0000:   
7195: 0000: 
7196: 0000:   FUNCTION WRITE.MINLS EXTERNAL
7197: 0000:     INTEGER*2 WRITE.MINLS
7198: 0000:   END FUNCTION
7199: 0000: 
7200: 0000:  %INCLUDE NEGSCEXT.J86                    ! 1.9BG
7201: 0000: 
7202: 0000: \*****************************************************************************
7203: 0000: \*****************************************************************************
7204: 0000: \***
7205: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7206: 0000: \***
7207: 0000: \***                   FILE TYPE:  KEYED
7208: 0000: \***
7209: 0000: \***                   REFERENCE:  NEGSCEXT.J86
7210: 0000: \***
7211: 0000: \***                 DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
7212: 0000: \***
7213: 0000: \***
7214: 0000: \***
7215: 0000: \***      VERSION 1 : Julia Stones             15th July 1999   
7216: 0000: \***      
7217: 0000: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
7218: 0000: \***    Changes for RF trial.
7219: 0000: \***    Recompiled to prevent future automatic recompiles.
7220: 0000: \***    No changes to actual code.
7221: 0000: \***
7222: 0000: \*****************************************************************************
7223: 0000: \*****************************************************************************
7224: 0000: 
7225: 0000: 
7226: 0000:   FUNCTION NEGSC.SET EXTERNAL
7227: 0000:      INTEGER*2 NEGSC.SET
7228: 0000:   END FUNCTION
7229: 0000: 
7230: 0000: 
7231: 0000:   FUNCTION READ.NEGSC EXTERNAL
7232: 0000:     INTEGER*2 READ.NEGSC
7233: 0000:   END FUNCTION
7234: 0000:   
7235: 0000: 
7236: 0000:   FUNCTION READ.NEGSC.LOCKED EXTERNAL
7237: 0000:     INTEGER*2 READ.NEGSC.LOCKED
7238: 0000:   END FUNCTION  
7239: 0000: 
7240: 0000: 
7241: 0000:   FUNCTION WRITE.HOLD.NEGSC EXTERNAL
7242: 0000:     INTEGER*2 WRITE.HOLD.NEGSC
7243: 0000:   END FUNCTION
7244: 0000: 
7245: 0000: 
7246: 0000:   FUNCTION WRITE.UNLOCK.NEGSC EXTERNAL
7247: 0000:     INTEGER*2 WRITE.UNLOCK.NEGSC
7248: 0000:   END FUNCTION
7249: 0000: 
7250: 0000: 
7251: 0000:   FUNCTION WRITE.HOLD.UNLOCK.NEGSC EXTERNAL
7252: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.NEGSC
7253: 0000:   END FUNCTION
7254: 0000:   
7255: 0000: 
7256: 0000:   FUNCTION WRITE.NEGSC EXTERNAL
7257: 0000:     INTEGER*2 WRITE.NEGSC
7258: 0000:   END FUNCTION
7259: 0000: 
7260: 0000:  %INCLUDE SSPSCEXT.J86                    ! 2.0JAS
7261: 0000: \*****************************************************************************
7262: 0000: \*****************************************************************************
7263: 0000: \***
7264: 0000: \***         FUNCTION DEFINITIONS FOR SSPSCTRL
7265: 0000: \***
7266: 0000: \***                    REFERENCE : SSPSCexa.J86
7267: 0000: \***
7268: 0000: \***    Version A           Julia Stones         23.10.2003
7269: 0000: \***
7270: 0000: \*******************************************************************************
7271: 0000: \*******************************************************************************
7272: 0000: 
7273: 0000:   FUNCTION SSPSCTRL.SET EXTERNAL
7274: 0000:    INTEGER*2 SSPSCTRL.SET
7275: 0000:   END FUNCTION
7276: 0000: 
7277: 0000:   FUNCTION READ.SSPSCTRL EXTERNAL
7278: 0000:    INTEGER*2 READ.SSPSCTRL
7279: 0000:   END FUNCTION
7280: 0000: 
7281: 0000:   FUNCTION READ.SSPSCTRL.LOCKED EXTERNAL
7282: 0000:    INTEGER*2 READ.SSPSCTRL.LOCKED
7283: 0000:   END FUNCTION
7284: 0000: 
7285: 0000:   FUNCTION WRITE.SSPSCTRL EXTERNAL
7286: 0000:    INTEGER*2 WRITE.SSPSCTRL
7287: 0000:   END FUNCTION
7288: 0000: 
7289: 0000:   FUNCTION WRITE.SSPSCTRL.UNLOCK EXTERNAL
7290: 0000:    INTEGER*2 WRITE.SSPSCTRL.UNLOCK
7291: 0000:   END FUNCTION
7292: 0000: 
7293: 0000:  %INCLUDE BTCSEXT.J86                     ! 2.0JAS
7294: 0000: \*****************************************************************************
7295: 0000: \*****************************************************************************
7296: 0000: \***
7297: 0000: \***         FUNCTION DEFINITIONS FOR BTCS FILE
7298: 0000: \***
7299: 0000: \***         REFERENCE    : BTCSEXT
7300: 0000: \***
7301: 0000: \***         VERSION A    : JULIA STONES 23/10/03
7302: 0000: \***
7303: 0000: \*****************************************************************************
7304: 0000: \*****************************************************************************
7305: 0000: 
7306: 0000:     FUNCTION BTCS.SET EXTERNAL
7307: 0000:     END FUNCTION
7308: 0000: 
7309: 0000:     FUNCTION READ.BTCS EXTERNAL
7310: 0000:     INTEGER*1 READ.BTCS
7311: 0000:     END FUNCTION
7312: 0000: 
7313: 0000:     FUNCTION READ.BTCS.LOCK EXTERNAL
7314: 0000:     INTEGER*1 READ.BTCS.LOCK
7315: 0000:     END FUNCTION
7316: 0000: 
7317: 0000:     FUNCTION WRITE.BTCS EXTERNAL
7318: 0000:     INTEGER*1 WRITE.BTCS
7319: 0000:     END FUNCTION
7320: 0000: 
7321: 0000:     FUNCTION WRITE.BTCS.UNLOCK EXTERNAL
7322: 0000:     INTEGER*1 WRITE.BTCS.UNLOCK
7323: 0000:     END FUNCTION
7324: 0000: 
7325: 0000:     FUNCTION WRITE.BTCS.UNLOCK.HOLD EXTERNAL
7326: 0000:     INTEGER*1 WRITE.BTCS.UNLOCK.HOLD
7327: 0000:     END FUNCTION
7328: 0000: 
7329: 0000:  %INCLUDE PRINTEXT.J86                    ! 2.0JAS
7330: 0000: 
7331: 0000: REM \
7332: 0000: \*******************************************************************************
7333: 0000: \*******************************************************************************
7334: 0000: \***
7335: 0000: \***    %INCLUDE FOR PRINT FILE EXTERNAL FUNCTIONS
7336: 0000: \***
7337: 0000: \***        REFERENCE   :   PRINTEX (J86)
7338: 0000: \***
7339: 0000: \***        FILE TYPE   :   Printer / Labeller
7340: 0000: \***
7341: 0000: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
7342: 0000: \***    Original version created from PRINTEXG.
7343: 0000: \***
7344: 0000: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
7345: 0000: \***    Changes unknown.
7346: 0000: \***
7347: 0000: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
7348: 0000: \***    Defined function variables for use as return codes.
7349: 0000: \***
7350: 0000: \***    Version C               Andrew Wedgeworth                 24th May 1992
7351: 0000: \***    Condensed print function added.
7352: 0000: \***
7353: 0000: \***    Version D               Stuart WIlliam McConnachie       31st July 2000.
7354: 0000: \***    Added function for PCL printing to LaserJet.
7355: 0000: \***
7356: 0000: \***    Version E               Charles Skadorwa                   4th Apr 2008.
7357: 0000: \***    Added parameter to WRITE.CONDENSED.PRINT function to
7358: 0000: \***    enable Alliance Pharmacy Brother Laser printers to print
7359: 0000: \***    in condensed mode.
7360: 0000: \***
7361: 0000: \***    Version F           Charles Skadorwa                       2nd Mar 2016.
7362: 0000: \***    It was found that certain reports would not print when stores
7363: 0000: \***    were converted to LAN attached printing.
7364: 0000: \***
7365: 0000: \***    Added new function: WRITE.PRINT.PLUS.LF based on WRITE.PRINT.
7366: 0000: \***    This adds a Line-Feed characters to every print line.
7367: 0000: \***
7368: 0000: \*******************************************************************************
7369: 0000: \*******************************************************************************
7370: 0000: 
7371: 0000: 
7372: 0000:     FUNCTION PRINT.SET EXTERNAL
7373: 0000:         INTEGER*2 PRINT.SET
7374: 0000:     END FUNCTION
7375: 0000: 
7376: 0000: 
7377: 0000:     FUNCTION WRITE.PRINT EXTERNAL
7378: 0000:        INTEGER*2 WRITE.PRINT
7379: 0000:     END FUNCTION
7380: 0000: 
7381: 0000: 
7382: 0000:     FUNCTION WRITE.PRINT.PLUS.LF EXTERNAL                               !FCS
7383: 0000:        INTEGER*2 WRITE.PRINT.PLUS.LF                                    !FCS
7384: 0000:     END FUNCTION                                                        !FCS
7385: 0000: 
7386: 0000: 
7387: 0000:     FUNCTION WRITE.CONDENSED.PRINT (AP.STORE) EXTERNAL                 ! ECSk
7388: 0000:        INTEGER*2 WRITE.CONDENSED.PRINT
7389: 0000:     END FUNCTION
7390: 0000: 
7391: 0000: 
7392: 0000:     FUNCTION WRITE.PCL.PRINT EXTERNAL                                  ! DSWM
7393: 0000:        INTEGER*2 WRITE.PCL.PRINT                                       ! DSWM
7394: 0000:     END FUNCTION                                                       ! DSWM
7395: 0000: 
7396: 0000: 
7397: 0000:     FUNCTION WRITE.LABEL EXTERNAL
7398: 0000:         INTEGER*2 WRITE.LABEL
7399: 0000:     END FUNCTION
7400: 0000: 
7401: 0000:  %INCLUDE SOPTSEXT.J86                    ! 2.1JAS
7402: 0000: \*******************************************************************************
7403: 0000: \***                                                                         ***
7404: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE STORE OPTIONS FILE           ***
7405: 0000: \***                                                                         ***
7406: 0000: \***                     REFERENCE : SOPTSEXT.J86                            ***
7407: 0000: \***                                                                         ***
7408: 0000: \***      Version A      Stuart William McConnachie      19th June 1995      ***
7409: 0000: \***                                                                         ***
7410: 0000: \*******************************************************************************
7411: 0000: 
7412: 0000:       FUNCTION SOPTS.SET EXTERNAL
7413: 0000:       END FUNCTION
7414: 0000:       
7415: 0000:       FUNCTION READ.SOPTS EXTERNAL
7416: 0000:          INTEGER*2 READ.SOPTS
7417: 0000:       END FUNCTION
7418: 0000: 
7419: 0000:       FUNCTION WRITE.SOPTS EXTERNAL
7420: 0000:          INTEGER*2 WRITE.SOPTS
7421: 0000:       END FUNCTION
7422: 0000: 
7423: 0000:  %INCLUDE LOCALEXT.J86                    ! 2.1JAS
7424: 0000: \***********************************************************************
7425: 0000: \***********************************************************************
7426: 0000: \***
7427: 0000: \***    DESCRIPTION: Local Price File
7428: 0000: \***                 External File Function Definitions
7429: 0000: \***
7430: 0000: \***    FILE TYPE : Keyed
7431: 0000: \***
7432: 0000: \***********************************************************************
7433: 0000: \***
7434: 0000: \***    Version A.              Paul Flanagan            1st Jul 1993
7435: 0000: \***    Initial version.
7436: 0000: \***
7437: 0000: \***    Version B.              Clive Norris            30th Nov 1993
7438: 0000: \***    Renamed to keep the versions in line.
7439: 0000: \***
7440: 0000: \***    Version C.              Mark Walker             29th Jun 2015
7441: 0000: \***    F392 Retail Stock 5
7442: 0000: \***    Added function WRITE.LOCAL.UNLOCK.HOLD
7443: 0000: \***
7444: 0000: \***********************************************************************
7445: 0000: \***********************************************************************
7446: 0000: 
7447: 0000: FUNCTION LOCAL.SET EXTERNAL
7448: 0000: END FUNCTION
7449: 0000: 
7450: 0000: FUNCTION READ.LOCAL EXTERNAL
7451: 0000:     INTEGER*2 READ.LOCAL
7452: 0000: END FUNCTION
7453: 0000: 
7454: 0000: FUNCTION READ.LOCAL.LOCK EXTERNAL
7455: 0000:     INTEGER*2 READ.LOCAL.LOCK
7456: 0000: END FUNCTION
7457: 0000: 
7458: 0000: FUNCTION WRITE.LOCAL EXTERNAL
7459: 0000:     INTEGER*2 WRITE.LOCAL
7460: 0000: END FUNCTION
7461: 0000: 
7462: 0000: FUNCTION WRITE.LOCAL.UNLOCK EXTERNAL
7463: 0000:     INTEGER*2 WRITE.LOCAL.UNLOCK
7464: 0000: END FUNCTION
7465: 0000: 
7466: 0000: FUNCTION WRITE.LOCAL.UNLOCK.HOLD EXTERNAL                                   !CMW
7467: 0000:     INTEGER*2 WRITE.LOCAL.UNLOCK.HOLD                                       !CMW
7468: 0000: END FUNCTION                                                                !CMW
7469: 0000: 
7470: 0000:  %INCLUDE CCREJEXT.J86                    ! 2.2JAS
7471: 0000: \*******************************************************************************
7472: 0000: \*******************************************************************************
7473: 0000: \***
7474: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
7475: 0000: \***
7476: 0000: \***                    REFERENCE    : CCREJEXT.BAS
7477: 0000: \***
7478: 0000: \***    Version A.         Julia Stones              12th March 2004
7479: 0000: \***
7480: 0000: \*******************************************************************************
7481: 0000: \*******************************************************************************
7482: 0000: 
7483: 0000: 
7484: 0000:   FUNCTION CCREJ.SET EXTERNAL
7485: 0000:       INTEGER*2 CCREJ.SET
7486: 0000:   END FUNCTION
7487: 0000: 
7488: 0000:   FUNCTION CCREJC.SET EXTERNAL
7489: 0000:       INTEGER*2 CCREJC.SET
7490: 0000:   END FUNCTION
7491: 0000: 
7492: 0000:   FUNCTION CCREJP.SET EXTERNAL
7493: 0000:       INTEGER*2 CCREJP.SET
7494: 0000:   END FUNCTION
7495: 0000: 
7496: 0000:   FUNCTION READ.CCREJ EXTERNAL
7497: 0000:       INTEGER*2 READ.CCREJ
7498: 0000:   END FUNCTION
7499: 0000: 
7500: 0000:   FUNCTION READ.CCREJC EXTERNAL
7501: 0000:       INTEGER*2 READ.CCREJC
7502: 0000:   END FUNCTION
7503: 0000: 
7504: 0000:   FUNCTION READ.CCREJP EXTERNAL
7505: 0000:       INTEGER*2 READ.CCREJP
7506: 0000:   END FUNCTION
7507: 0000: 
7508: 0000:   FUNCTION WRITE.CCREJ EXTERNAL
7509: 0000:       INTEGER*2 WRITE.CCREJ
7510: 0000:   END FUNCTION
7511: 0000: 
7512: 0000:   FUNCTION WRITE.CCREJC EXTERNAL
7513: 0000:       INTEGER*2 WRITE.CCREJC
7514: 0000:   END FUNCTION
7515: 0000: 
7516: 0000:   FUNCTION WRITE.HOLD.CCREJ EXTERNAL
7517: 0000:       INTEGER*2 WRITE.HOLD.CCREJ
7518: 0000:   END FUNCTION
7519: 0000: 
7520: 0000:   FUNCTION WRITE.HOLD.CCREJC EXTERNAL
7521: 0000:       INTEGER*2 WRITE.HOLD.CCREJC
7522: 0000:   END FUNCTION
7523: 0000: 
7524: 0000:  %INCLUDE RBEXT.J86                       ! 2.6BG
7525: 0000: \/******************************************************************/
7526: 0000: \/*                                                                */
7527: 0000: \/* Recalls Buffer FILE EXTERNAL FUNCTION DEFNS                    */
7528: 0000: \/*                                                                */
7529: 0000: \/* REFERENCE   : RBEXT.J86                                        */
7530: 0000: \/*                                                                */
7531: 0000: \/* VERSION A.          Brian Greenield         11th May 2007      */
7532: 0000: \/*                                                                */
7533: 0000: \/******************************************************************/
7534: 0000: 
7535: 0000:    FUNCTION RB.SET EXTERNAL
7536: 0000:       INTEGER*1 RB.SET
7537: 0000:    END FUNCTION
7538: 0000: 
7539: 0000:    FUNCTION READ.RB EXTERNAL
7540: 0000:       INTEGER*2 READ.RB
7541: 0000:    END FUNCTION
7542: 0000: 
7543: 0000:    FUNCTION WRITE.RB EXTERNAL
7544: 0000:       INTEGER*2 WRITE.RB
7545: 0000:    END FUNCTION
7546: 0000: 
7547: 0000: \/******************************************************************/
7548: 0000:  %INCLUDE REWKFEXT.J86                    ! 2.6BG
7549: 0000: \/******************************************************************/
7550: 0000: \/*                                                                */
7551: 0000: \/* Recalls Work FILE EXTERNAL FUNCTION DEFNS                      */
7552: 0000: \/*                                                                */
7553: 0000: \/* REFERENCE   : REWKFEXT.J86                                     */
7554: 0000: \/*                                                                */
7555: 0000: \/* VERSION A.          Brian Greenield         11th May 2007      */
7556: 0000: \/*                                                                */
7557: 0000: \/******************************************************************/
7558: 0000: 
7559: 0000:    FUNCTION REWKF.SET EXTERNAL
7560: 0000:       INTEGER*1 REWKF.SET
7561: 0000:    END FUNCTION
7562: 0000: 
7563: 0000:    FUNCTION READ.REWKF EXTERNAL
7564: 0000:       INTEGER*2 READ.REWKF
7565: 0000:    END FUNCTION
7566: 0000: 
7567: 0000:    FUNCTION WRITE.REWKF EXTERNAL
7568: 0000:       INTEGER*2 WRITE.REWKF
7569: 0000:    END FUNCTION
7570: 0000: 
7571: 0000: \/******************************************************************/
7572: 0000:  %INCLUDE RECALEXT.J86                    ! 2.6BG
7573: 0000: \******************************************************************************
7574: 0000: \******************************************************************************
7575: 0000: \***
7576: 0000: \***                 FUNCTION DEFINITIONS FOR RECALLS.BIN
7577: 0000: \***
7578: 0000: \***                        REFERENCE: RECALFEXT.J86
7579: 0000: \***
7580: 0000: \***    VERSION A               BRIAN GREENFIELD                14th May 2007
7581: 0000: \***    Initial Version
7582: 0000: \***
7583: 0000: \***    Version B               CHARLES SKADORWA                26th June 2007
7584: 0000: \***    Added DELETE.RECALLS function.
7585: 0000: \***
7586: 0000: \*******************************************************************************
7587: 0000: \*******************************************************************************
7588: 0000: 
7589: 0000:    FUNCTION RECALLS.SET EXTERNAL
7590: 0000:       INTEGER*1 RECALLS.SET
7591: 0000:    END FUNCTION
7592: 0000:    
7593: 0000:    FUNCTION WRITE.RECALLS EXTERNAL
7594: 0000:       INTEGER*1 WRITE.RECALLS
7595: 0000:    END FUNCTION
7596: 0000:    
7597: 0000:    FUNCTION READ.RECALLS EXTERNAL
7598: 0000:       INTEGER*1 READ.RECALLS
7599: 0000:    END FUNCTION
7600: 0000:    
7601: 0000:   FUNCTION DELETE.RECALLS (KEY$) EXTERNAL
7602: 0000:       INTEGER*1 DELETE.RECALLS
7603: 0000:    END FUNCTION
7604: 0000:  %INCLUDE DELVIEXT.J86                    ! 2.7SH
7605: 0000: \/******************************************************************/
7606: 0000: \/*                                                                */
7607: 0000: \/* DELVINDX FILE EXTERNAL FUNCTION DEFNS                          */
7608: 0000: \/*                                                                */
7609: 0000: \/* REFERENCE   : DELVIEXT.J86                                     */
7610: 0000: \/*                                                                */
7611: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
7612: 0000: \/*                                                                */
7613: 0000: \/******************************************************************/
7614: 0000: 
7615: 0000:    FUNCTION DELVINDX.SET EXTERNAL
7616: 0000:       INTEGER*1 DELVINDX.SET
7617: 0000:    END FUNCTION
7618: 0000: 
7619: 0000:    FUNCTION READ.DELVINDX EXTERNAL
7620: 0000:       INTEGER*2 READ.DELVINDX
7621: 0000:    END FUNCTION
7622: 0000: 
7623: 0000:    FUNCTION WRITE.DELVINDX EXTERNAL
7624: 0000:       INTEGER*2 WRITE.DELVINDX
7625: 0000:    END FUNCTION
7626: 0000: 
7627: 0000: \/******************************************************************/
7628: 0000:  %INCLUDE UODOTEXT.J86                    ! 2.7SH
7629: 0000: \/******************************************************************/
7630: 0000: \/*                                                                */
7631: 0000: \/* UOD Outers FILE EXTERNAL FUNCTION DEFNS                        */
7632: 0000: \/*                                                                */
7633: 0000: \/* REFERENCE   : UODOTEXT.J86                                     */
7634: 0000: \/*                                                                */
7635: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
7636: 0000: \/*                                                                
7637: 0000: \/* REVISION 1.8.            ROBERT COWEY.            14 JAN 2009.
7638: 0000: \/* Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
7639: 0000: \/* Defined new function UODOT.REC$.
7640: 0000: \/*
7641: 0000: \/******************************************************************/
7642: 0000: 
7643: 0000:     FUNCTION UODOT.KEY$ EXTERNAL
7644: 0000:         STRING    UODOT.KEY$
7645: 0000:         STRING    WORK$
7646: 0000:     END FUNCTION
7647: 0000: 
7648: 0000:     FUNCTION UODOT.SET EXTERNAL
7649: 0000:         INTEGER*1 UODOT.SET
7650: 0000:     END FUNCTION
7651: 0000: 
7652: 0000:     FUNCTION READ.UODOT EXTERNAL
7653: 0000:         STRING    CHILD.LIST$
7654: 0000:         INTEGER*1 UODOT.INDICAT1%
7655: 0000:         INTEGER*2 UODOT.STATUS%
7656: 0000:         INTEGER*2 READ.UODOT
7657: 0000:         INTEGER*2 I%
7658: 0000:     END FUNCTION
7659: 0000: 
7660: 0000: 
7661: 0000:     FUNCTION READ.UODOT.ON.DESPATCH EXTERNAL
7662: 0000:         STRING TEMP$
7663: 0000:         INTEGER*2 RC%
7664: 0000:         INTEGER*2 READ.UODOT.ON.DESPATCH
7665: 0000:     END FUNCTION
7666: 0000: 
7667: 0000:     FUNCTION READ.UODOT.LOCK EXTERNAL
7668: 0000:         INTEGER*1 UODOT.INDICAT1%
7669: 0000:         INTEGER*2 UODOT.STATUS%
7670: 0000:         INTEGER*2 READ.UODOT.LOCK
7671: 0000:         INTEGER*2 I%
7672: 0000:         STRING    CHILD.LIST$
7673: 0000:     END FUNCTION
7674: 0000: 
7675: 0000:     FUNCTION WRITE.UODOT EXTERNAL
7676: 0000:         INTEGER*1 UODOT.INDICAT1%
7677: 0000:         INTEGER*2 UODOT.STATUS%
7678: 0000:         INTEGER*2 WRITE.UODOT
7679: 0000:         INTEGER*2 I%
7680: 0000:         STRING    CHILD.LIST$
7681: 0000:     END FUNCTION
7682: 0000: 
7683: 0000:     FUNCTION WRITE.UODOT.UNLOCK EXTERNAL
7684: 0000:         INTEGER*1 UODOT.INDICAT1%
7685: 0000:         INTEGER*2 UODOT.STATUS%
7686: 0000:         INTEGER*2 WRITE.UODOT.UNLOCK
7687: 0000:         INTEGER*2 I%
7688: 0000:         STRING    CHILD.LIST$
7689: 0000:     END FUNCTION
7690: 0000: 
7691: 0000: \/******************************************************************/
7692: 0000: 
7693: 0000:     FUNCTION DELETE.UODOT EXTERNAL
7694: 0000:         INTEGER*2 DELETE.UODOT
7695: 0000:     END FUNCTION
7696: 0000: 
7697: 0000: \/******************************************************************/
7698: 0000: 
7699: 0000:     FUNCTION UODOT.REC$ EXTERNAL                                      ! 1.8 RC
7700: 0000:         STRING UODOT.REC$                                             ! 1.8 RC
7701: 0000:     END FUNCTION                                                      ! 1.8 RC
7702: 0000: 
7703: 0000: 
7704: 0000:  %INCLUDE AFEXT.J86                       ! 2.7SH
7705: 0000: 
7706: 0000: \REM
7707: 0000: \*******************************************************************************
7708: 0000: \*******************************************************************************
7709: 0000: \***
7710: 0000: \***    %INCLUDE FOR GSA AUTHORISATION FILE EXTERNAL FUNCTIONS
7711: 0000: \***
7712: 0000: \***        REFERENCE   :  AFEXT (J86)
7713: 0000: \***
7714: 0000: \***        FILE TYPE   :  Keyed
7715: 0000: \***
7716: 0000: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
7717: 0000: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
7718: 0000: \***
7719: 0000: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
7720: 0000: \***    Original version created from AFEXTA.
7721: 0000: \***
7722: 0000: \***    VERSION B.              Steve Windsor                       29 Dec 1992.
7723: 0000: \***    Version incremented to keep in line with other included code           
7724: 0000: \***
7725: 0000: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
7726: 0000: \***    No changes to this file.
7727: 0000: \***
7728: 0000: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
7729: 0000: \***    Changes for A9C POS improvements project.
7730: 0000: \***    Used up last available three bytes of EALAUTH user data by redefining 
7731: 0000: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
7732: 0000: \***    No changes to this file.
7733: 0000: \***
7734: 0000: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
7735: 0000: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
7736: 0000: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format within AFDEC.J86.
7737: 0000: \***    Description text change only - No code changes to this file.
7738: 0000: \***
7739: 0000: \*******************************************************************************
7740: 0000: \*******************************************************************************
7741: 0000: 
7742: 0000: 
7743: 0000: FUNCTION AF.SET EXTERNAL
7744: 0000:     INTEGER*2 AF.SET
7745: 0000: END FUNCTION
7746: 0000: 
7747: 0000: 
7748: 0000: FUNCTION READ.AF EXTERNAL
7749: 0000:     INTEGER*2 READ.AF
7750: 0000: END FUNCTION
7751: 0000: 
7752: 0000: 
7753: 0000: FUNCTION READ.AF.LOCKED EXTERNAL
7754: 0000:     INTEGER*2 READ.AF.LOCKED
7755: 0000: END FUNCTION
7756: 0000: 
7757: 0000:   
7758: 0000: FUNCTION READ.AF.ABREV EXTERNAL
7759: 0000:     INTEGER*2 READ.AF.ABREV
7760: 0000: END FUNCTION
7761: 0000: 
7762: 0000: 
7763: 0000: FUNCTION READ.AF.ABREV.LOCKED EXTERNAL
7764: 0000:     INTEGER*2 READ.AF.ABREV.LOCKED
7765: 0000: END FUNCTION
7766: 0000: 
7767: 0000:   
7768: 0000: FUNCTION WRITE.AF.UNLOCK EXTERNAL
7769: 0000:     INTEGER*2 WRITE.AF.UNLOCK
7770: 0000: END FUNCTION
7771: 0000: 
7772: 0000: 
7773: 0000: FUNCTION WRITE.AF.ABREV EXTERNAL
7774: 0000:     INTEGER*2 WRITE.AF.ABREV
7775: 0000: END FUNCTION
7776: 0000: 
7777: 0000: 
7778: 0000: FUNCTION WRITE.AF.ABREV.UNLOCK EXTERNAL
7779: 0000:     INTEGER*2 WRITE.AF.ABREV.UNLOCK
7780: 0000: END FUNCTION
7781: 0000: 
7782: 0000:  %INCLUDE UBEXT.J86                       ! 2.7SH
7783: 0000: \/******************************************************************/
7784: 0000: \/*                                                                */
7785: 0000: \/* UOD Bookin FILE EXTERNAL FUNCTION DEFNS                        */
7786: 0000: \/*                                                                */
7787: 0000: \/* REFERENCE   : UBEXT.J86                                        */
7788: 0000: \/*                                                                */
7789: 0000: \/* VERSION A.          Stuart Highley            14 August 2008   */
7790: 0000: \/*                                                                */
7791: 0000: \/******************************************************************/
7792: 0000: 
7793: 0000:    FUNCTION UB.SET EXTERNAL
7794: 0000:       INTEGER*1 UB.SET
7795: 0000:    END FUNCTION
7796: 0000: 
7797: 0000:    FUNCTION READ.UB EXTERNAL
7798: 0000:       INTEGER*2 READ.UB
7799: 0000:    END FUNCTION
7800: 0000: 
7801: 0000:    FUNCTION WRITE.UB EXTERNAL
7802: 0000:       INTEGER*2 WRITE.UB
7803: 0000:    END FUNCTION
7804: 0000: 
7805: 0000: \/******************************************************************/
7806: 0000:  
7807: 0000: \*****************************************************************************
7808: 0000: \*****************************************************************************
7809: 0000: \***                                                                       ***
7810: 0000: \*** I N T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
7811: 0000: \***                                                                       ***
7812: 0000: \***   - FN.SECONDS                                                        ***
7813: 0000: \***   - FN.Z.PACK                                                         ***
7814: 0000: \***   - FN.VALIDATE.DATA                                                  ***
7815: 0000: \***   - FN.CONV.TO.INTEGER (SIGNED)                                       ***
7816: 0000: \***                                                                       ***
7817: 0000: \*****************************************************************************
7818: 0000: \*****************************************************************************
7819: 0000: 
7820: 0000: \******************************************************************************
7821: 0000: \***
7822: 0000: \***   Function : FN.SECONDS( TIME.VALUE$ )
7823: 0000: \***
7824: 0000: \***   Purpose  : Convert passed TIME in format HHMMSS to seconds
7825: 0000: \***
7826: 0000: \***   Output   : = 4 byte integer
7827: 0000: \***
7828: 0000: \******************************************************************************
7829: 0000: 
7830: 0000:    FUNCTION FN.SECONDS( TIME.VALUE$ )
7831: 0029: 
7832: 0029:       STRING                                                                  \
7833: 0029:          TIME.VALUE$
7834: 0029:       INTEGER*4                                                               \
7835: 0029:          FN.SECONDS
7836: 0029: 
7837: 0029:       FN.SECONDS = VAL(MID$(TIME.VALUE$,1,2)) * 3600 +                        \
7838: 00fb:                    VAL(MID$(TIME.VALUE$,3,2)) * 60 +                          \
7839: 00fb:                    VAL(MID$(TIME.VALUE$,5,2))
7840: 00fb: 
7841: 00fb:    END FUNCTION
7842: 011a: 
7843: 011a: \******************************************************************************
7844: 011a: \***
7845: 011a: \***   Function : FN.Z.PACK( NUM.STRING$, LENGTH% )
7846: 011a: \***
7847: 011a: \***   Purpose  : Zero pack (to the left) NUM.STRING$ out to LENGTH%
7848: 011a: \***
7849: 011a: \******************************************************************************
7850: 011a: 
7851: 011a:    FUNCTION FN.Z.PACK(NUM.STRING$, LENGTH%)
7852: 0143: 
7853: 0143:       STRING                                                                 \
7854: 0143:          FN.Z.PACK,                                                          \
7855: 0143:          NUM.STRING$
7856: 0143:       INTEGER*2                                                              \
7857: 0143:          LENGTH%
7858: 0143: 
7859: 0143:       FN.Z.PACK = RIGHT$(STRING$(LENGTH%,"0")+NUM.STRING$,LENGTH%)
7860: 018c: 
7861: 018c:    END FUNCTION
7862: 01aa: 
7863: 01aa: \******************************************************************************
7864: 01aa: \***
7865: 01aa: \***   Function : FN.VALIDATE.DATA( RECORD$, FORMAT% )
7866: 01aa: \***
7867: 01aa: \***   Purpose  : Test received record RECORD$ is in correct format for
7868: 01aa: \***              data format FORMAT%
7869: 01aa: \***
7870: 01aa: \***   Output   : = 0 if RECORD$ does not conform to data format FORMAT%
7871: 01aa: \***              = 1 if RECORD$ does conform to data format FORMAT%
7872: 01aa: \***
7873: 01aa: \******************************************************************************
7874: 01aa: 
7875: 01aa:    FUNCTION FN.VALIDATE.DATA(RECORD$, FORMAT%)
7876: 01d3: 
7877: 01d3:       STRING                                                                  \
7878: 01d3:          CHECK$,                                                              \
7879: 01d3:          DATA$,                                                               \
7880: 01d3:          RECORD$,                                                             \
7881: 01d3:          TEST$,                                                               \
7882: 01d3:          TYPE$,                                                               \
7883: 01d3:          VALID.FLAG$
7884: 01d3:       INTEGER*1                                                               \
7885: 01d3:          FORMAT%,                                                             \
7886: 01d3:          FN.VALIDATE.DATA
7887: 01d3:       INTEGER*2                                                               \
7888: 01d3:          BYTE.PTR%,                                                           \
7889: 01d3:          CHECK.PTR%,                                                          \
7890: 01d3:          REC.LENGTH%
7891: 01d3: 
7892: 01d3:       REC.LENGTH% = LEN(RECORD$)
7893: 01eb:       IF REC.LENGTH% < 1                                                      \
7894: 0220:       OR FORMAT% < 1 OR FORMAT% > REC.MAX% THEN BEGIN                         \
7895: 0220:          FN.VALIDATE.DATA = 0
7896: 022c:          EXIT FUNCTION
7897: 0237:       ENDIF
7898: 023f: 
7899: 023f:       CHECK$ = REC.CHECK$(FORMAT%)
7900: 026a:       CHECK.PTR% = 1
7901: 0278:       BYTE.PTR% = 1
7902: 0286:       VALID.FLAG$ = "Y"
7903: 029b: 
7904: 029b:       WHILE BYTE.PTR% <= REC.LENGTH%                                          \
7905: 02a6:         AND CHECK.PTR% < LEN(CHECK$)
7906: 02a6: 
7907: 02a6:          TYPE$ = MID$(CHECK$, CHECK.PTR%, 1)
7908: 02ca:          DATA$ = MID$(CHECK$, CHECK.PTR%+1, 1)
7909: 02ef:          CHECK.PTR% = CHECK.PTR% + 2
7910: 02fc: 
7911: 02fc:          IF TYPE$ = "B" THEN BEGIN
7912: 0317:             IF MID$(RECORD$, BYTE.PTR%, 1) <> DATA$ THEN BEGIN
7913: 034d:                VALID.FLAG$ = "N"
7914: 0362:             ENDIF
7915: 036a:             BYTE.PTR% = BYTE.PTR% + 1
7916: 0376:          ENDIF
7917: 037e: 
7918: 037e:          IF TYPE$ = "N" THEN BEGIN
7919: 039c:             WHILE BYTE.PTR% <= REC.LENGTH% AND DATA$ <> CHR$(0)
7920: 03a7:                TEST$ = MID$(RECORD$, BYTE.PTR%, 1)
7921: 03c9:                IF (TEST$ < "0" OR TEST$ > "9")                               \
7922: 0484:               AND TEST$ <> "-" AND TEST$ <> "+"                              \
7923: 0484:               AND TEST$ <> "." THEN VALID.FLAG$ = "N"
7924: 0499:                BYTE.PTR% = BYTE.PTR% + 1
7925: 04a5:                DATA$ = CHR$(ASC(DATA$) - 1)
7926: 04ca:             WEND
7927: 050a:             IF BYTE.PTR% > REC.LENGTH%                                       \
7928: 0547:            AND DATA$ <> CHR$(0) THEN VALID.FLAG$ = "N"
7929: 055c:          ENDIF
7930: 0564: 
7931: 0564:          IF TYPE$ = "A" THEN BYTE.PTR% = BYTE.PTR% + ASC(DATA$)
7932: 0590: 
7933: 0590:       WEND
7934: 05c5: 
7935: 05c5:       IF CHECK.PTR% <= LEN(CHECK$) THEN VALID.FLAG$ = "N"
7936: 05ee: 
7937: 05ee:       IF VALID.FLAG$ = "Y" THEN BEGIN
7938: 0609:          FN.VALIDATE.DATA = 1
7939: 0615:          LAST.ACTIVE.DATE$ = DATE$
7940: 062d:          LAST.ACTIVE% = FN.SECONDS(TIME$)
7941: 0655:       ENDIF ELSE BEGIN
7942: 065d:          FN.VALIDATE.DATA = 0
7943: 0669:       ENDIF
7944: 0671: 
7945: 0671:    END FUNCTION
7946: 068d: 
7947: 068d: \******************************************************************************
7948: 068d: \***
7949: 068d: \***   Function : FN.CONV.TO.INTEGER( NUM.STRING$ )
7950: 068d: \***
7951: 068d: \***   Purpose  : Convert passed string to a 1, 2 or 4 byte (dependant on
7952: 068d: \***              length of passed string) signed integer.
7953: 068d: \***
7954: 068d: \***   Output   : = 1, 2 or 4 byte integer
7955: 068d: \***
7956: 068d: \******************************************************************************
7957: 068d: 
7958: 068d:    FUNCTION FN.CONV.TO.INTEGER( NUM.STRING$ )
7959: 06b6: 
7960: 06b6:       INTEGER*4                                                              \
7961: 06b6:          BYTE%,                                                              \
7962: 06b6:          BYTE.POS%,                                                          \
7963: 06b6:          BYTES%,                                                             \
7964: 06b6:          SIGN.BIT%
7965: 06b6:       REAL                                                                   \
7966: 06b6:          FN.CONV.TO.INTEGER,                                                 \
7967: 06b6:          NUMBER
7968: 06b6:       STRING                                                                 \
7969: 06b6:          NUM.STRING$
7970: 06b6: 
7971: 06b6:       BYTES% = LEN(NUM.STRING$)
7972: 06db:       NUMBER = 0
7973: 06f6:       FOR BYTE.POS% = 1 TO BYTES%
7974: 070e:          BYTE% = ASC(MID$(NUM.STRING$, BYTE.POS%, 1))
7975: 073f:          IF BYTE.POS% = BYTES% THEN BEGIN
7976: 075a:             SIGN.BIT% = BYTE% AND 80h
7977: 0773:             BYTE% = BYTE% AND (SIGN.BIT% XOR 0FFh)
7978: 079f:          ENDIF
7979: 07a7:          NUMBER = NUMBER + (100h ^ (BYTE.POS% - 1)) * BYTE%
7980: 07fd:       NEXT BYTE.POS%
7981: 082a:       IF SIGN.BIT% <> 0 THEN NUMBER = NUMBER - (80h * (100h ^ (BYTES% - 1)))
7982: 0893: 
7983: 0893:       FN.CONV.TO.INTEGER = NUMBER
7984: 08a9: 
7985: 08a9:    END FUNCTION
7986: 08c2: 
7987: 08c2: \******************************************************************************
7988: 08c2: \***
7989: 08c2: \***   Function : FN.ZERO.PL( TEXT$,
7990: 08c2: \***                          LENGTH% )
7991: 08c2: \***
7992: 08c2: \***   Purpose  : Zero pack, to the left, the passed string TEXT$ to the
7993: 08c2: \***              specified length.
7994: 08c2: \***
7995: 08c2: \******************************************************************************
7996: 08c2: 
7997: 08c2:    FUNCTION FN.ZERO.PL(TEXT$,LENGTH%)
7998: 08eb: 
7999: 08eb:       STRING    FN.ZERO.PL, TEXT$
8000: 08eb:       INTEGER*2 LENGTH%
8001: 08eb: 
8002: 08eb:       FN.ZERO.PL = RIGHT$( STRING$( LENGTH%, "0" ) + TEXT$ , LENGTH% )
8003: 0934: 
8004: 0934:    END FUNCTION
8005: 0952: 
8006: 0952: \*****************************************************************************
8007: 0952: \*****************************************************************************
8008: 0952: \***                                                                       ***
8009: 0952: \*** E N D   OF   G L O B A L   D E F N S   F O R   P S S 3 7              ***
8010: 0952: \***                                                                       ***
8011: 0952: \*****************************************************************************
8012: 0952: \*****************************************************************************
8013: 0952:     %INCLUDE PSBF06E.J86                                            ! 1.5BG
8014: 0952: rem\
8015: 0952: \*******************************************************************************
8016: 0952: \*******************************************************************************
8017: 0952: \***
8018: 0952: \***
8019: 0952: \***         INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT external definition
8020: 0952: \***
8021: 0952: \***         REFERENCE     : PSBF06E.J86
8022: 0952: \***
8023: 0952: \***         Version A     Bruce Scriver                  24th February 1986
8024: 0952: \***
8025: 0952: \***         Version B     Andrew Wedgeworth                  15th July 1992
8026: 0952: \***         Removal of redundant parameters, and inclusion of 
8027: 0952: \***         CALC.BAR.CODE.CHECK.DIGIT as a variable to hold the return code.
8028: 0952: \***
8029: 0952: \*******************************************************************************
8030: 0952: \*******************************************************************************
8031: 0952: 
8032: 0952:    FUNCTION CALC.BAR.CODE.CHECK.DIGIT (BAR.CODE.12$)                           \
8033: 0952:    EXTERNAL
8034: 0952:    ! 3 parameters removed from here                                    ! BAW
8035: 0952: 
8036: 0952:       STRING    BAR.CODE.12$
8037: 0952:    ! 3 variables removed from here                                     ! BAW
8038: 0952:    
8039: 0952:       INTEGER*2 CALC.BAR.CODE.CHECK.DIGIT                              ! BAW
8040: 0952:       
8041: 0952: 
8042: 0952:    END FUNCTION
8043: 0952: 
8044: 0952:     %INCLUDE CMPDATE.J86
8045: 0952: !********************************************************************
8046: 0952: !***
8047: 0952: !***    INCLUDED CODE:  CMPDATE.J86
8048: 0952: !***    AUTHOR:         Stuart William McConnachie
8049: 0952: !***    DATE:           27th January 1997
8050: 0952: !***
8051: 0952: !********************************************************************
8052: 0952: !***   
8053: 0952: !***    Version B            Nik Sen                 30th March 1998
8054: 0952: !***    Changes to cope with a date of '000000' by replacing it with
8055: 0952: !***    '850101' before comparison. An all zero's date is valid in 
8056: 0952: !***    certain date fields and CMPDATE was returning the wrong result
8057: 0952: !***    when comparing with an actual date. Also change to cope with
8058: 0952: !***    dates of '999999' as some date fields are initialised to this
8059: 0952: !***    as a high value.
8060: 0952: !***
8061: 0952: !***    Version C    Stuart William McConnachie   20th December 1999
8062: 0952: !***    Improved function efficiency by changing tests for high and
8063: 0952: !***    low values, added above, to integers (rather than strings).
8064: 0952: !***    Also, using 850101 as a replacement for 000000, will not give
8065: 0952: !***    valid results after 350101 because of the 50 year wrap, so
8066: 0952: !***    corrected this.
8067: 0952: !***
8068: 0952: !***    Version D.  Stuart William McConnachie    26th February 2006
8069: 0952: !***    Place this code in it's own module in FUNLIB.  Make all
8070: 0952: !***    the functions herein EXTERNAL accordingly.
8071: 0952: !***
8072: 0952: !********************************************************************
8073: 0952: !***    
8074: 0952: !***    The following functions compare dates, checking for
8075: 0952: !***    century boundries.  Dates in the 50 years prior to the
8076: 0952: !***    compared date are less than the compared date, dates in
8077: 0952: !***    50 years after the compared date are greater than the
8078: 0952: !***    compared date.
8079: 0952: !***    Can handle dates in both packed and unpacked formats, or
8080: 0952: !***    a mixture of both.
8081: 0952: !***    In the case of a error, for example IH after detecting
8082: 0952: !***    illegal characters in VAL, the functions default to
8083: 0952: !***    comparing strings without testing for a change of century.
8084: 0952: !***
8085: 0952: !***    DATE.GT(DATE1$, DATE2$)  same as  DATE1$ >  DATE2$
8086: 0952: !***    DATE.GE(DATE1$, DATE2$)  same as  DATE1$ >= DATE2$
8087: 0952: !***    DATE.LT(DATE1$, DATE2$)  same as  DATE1$ <  DATE2$
8088: 0952: !***    DATE.LE(DATE1$, DATE2$)  same as  DATE1$ <= DATE2$
8089: 0952: !***
8090: 0952: !********************************************************************
8091: 0952: 
8092: 0952: FUNCTION DATE.GT(DATE1$, DATE2$) EXTERNAL                               !DSWM
8093: 0952:     STRING    DATE1$, DATE2$
8094: 0952:     INTEGER*1 DATE.GT
8095: 0952: END FUNCTION
8096: 0952: 
8097: 0952: 
8098: 0952: FUNCTION DATE.GE(DATE1$, DATE2$) EXTERNAL                               !DSWM
8099: 0952:     STRING    DATE1$, DATE2$
8100: 0952:     INTEGER*1 DATE.GE
8101: 0952: END FUNCTION
8102: 0952: 
8103: 0952: 
8104: 0952: FUNCTION DATE.LT(DATE1$, DATE2$) EXTERNAL                               !DSWM
8105: 0952:     STRING    DATE1$, DATE2$
8106: 0952:     INTEGER*1 DATE.LT
8107: 0952: END FUNCTION
8108: 0952: 
8109: 0952: 
8110: 0952: FUNCTION DATE.LE(DATE1$, DATE2$) EXTERNAL                               !DSWM
8111: 0952:     STRING    DATE1$, DATE2$
8112: 0952:     INTEGER*1 DATE.LE
8113: 0952: END FUNCTION
8114: 0952: 
8115: 0952: 
8116: 0952: ! Added function to ADXSTART PSD45 - to transfer Smartscript count file to pharmacy system.  ! 1.1JAS
8117: 0952: 
8118: 0952:    FUNCTION ADXSTART(NAME$, PARM$, MESS$) EXTERNAL                   ! 1.1JAS
8119: 0952:       INTEGER*2 ADXSTART                                             ! 1.1JAS
8120: 0952:       STRING    NAME$, PARM$, MESS$                                  ! 1.1JAS
8121: 0952:    END FUNCTION                                                      ! 1.1JAS
8122: 0952: 
8123: 0952: FUNCTION FN.REMOVE.ZEROS$(INPUT.TEXT$)
8124: 097b: 
8125: 097b:     ! STRIP LEADING ZEROS OF TEXT PASSED IN STRING
8126: 097b: 
8127: 097b:     STRING INPUT.TEXT$
8128: 097b:     STRING FN.REMOVE.ZEROS$
8129: 097b:     INTEGER*2 COUNT%
8130: 097b: 
8131: 097b:     COUNT% = 1
8132: 0989:     WHILE MID$(INPUT.TEXT$, COUNT%, 1) = "0"
8133: 0993:         COUNT% = COUNT% + 1
8134: 099f:     WEND
8135: 09d1: 
8136: 09d1:     FN.REMOVE.ZEROS$ = MID$(INPUT.TEXT$, COUNT%, 32767)
8137: 09f5:     INPUT.TEXT$ = ""
8138: 0a0b: 
8139: 0a0b: END FUNCTION
8140: 0a29: 
8141: 0a29: !Find the value of a string without risking a runtime error             ! 1.9SH
8142: 0a29: !Returns 0 if an error occurs                                           ! 1.9SH
8143: 0a29:     FUNCTION VALUE%(TXT$)                                               ! 1.9SH
8144: 0a52:         STRING TXT$                                                     ! 1.9SH
8145: 0a52:         INTEGER*4 VALUE%                                                ! 1.9SH
8146: 0a52:         ON ERROR GOTO ERROR.DETECTED                                    ! 1.9SH
8147: 0a67:         VALUE% = VAL(TXT$)                                              ! 1.9SH
8148: 0a88: ERROR.RESUME:                                                           ! 1.9SH
8149: 0a98:         TXT$ = ""                                                       ! 1.9SH
8150: 0aae:         EXIT FUNCTION                                                   ! 1.9SH
8151: 0ab8: ERROR.DETECTED:                                                         ! 1.9SH
8152: 0ac8:         VALUE% = 0                                                      ! 1.9SH
8153: 0ade:         RESUME ERROR.RESUME                                             ! 1.9SH
8154: 0af5:     END FUNCTION                                                        ! 1.9SH
8155: 0b14: 
8156: 0b14: FUNCTION PADNUM$(NUM%, LEN%)                                            ! 1.9SH
8157: 0b38:     STRING PADNUM$                                                      ! 1.9SH
8158: 0b38:     INTEGER*4 NUM%                                                      ! 1.9SH
8159: 0b38:     INTEGER*2 LEN%                                                      ! 1.9SH
8160: 0b38:     IF NUM% < 0 THEN BEGIN                                              ! 1.9SH
8161: 0b50:         PADNUM$ = "-" + RIGHT$(STRING$(LEN%-1, "0") + STR$(ABS(NUM%)), LEN%-1) ! 1.9SH
8162: 0bbf:     ENDIF ELSE BEGIN                                                    ! 1.9SH
8163: 0bc7:         PADNUM$ = RIGHT$(STRING$(LEN%, "0") + STR$(NUM%), LEN%)         ! 1.9SH
8164: 0c20:     ENDIF                                                               ! 1.9SH
8165: 0c28: END FUNCTION                                                            ! 1.9SH
8166: 0c41: 
8167: 0c41: FUNCTION PADNUMSTR$(TXT$, LEN%) RECURSIVE                               ! 1.9SH
8168: 0c6a:     STRING PADNUMSTR$, TXT$                                             ! 1.9SH
8169: 0c6a:     INTEGER*2 LEN%                                                      ! 1.9SH
8170: 0c6a:     IF LEFT$(TXT$, 1) = "-" THEN BEGIN                                  ! 1.9SH
8171: 0c9a:         PADNUMSTR$ = "-" + PADNUMSTR$(MID$(TXT$, 2, 32767), LEN% - 1)   ! 1.9SH
8172: 0cd9:     ENDIF ELSE BEGIN                                                    ! 1.9SH
8173: 0ce1:         PADNUMSTR$ = RIGHT$(STRING$(LEN%, "0") + TXT$, LEN%)            ! 1.9SH
8174: 0d2a:     ENDIF                                                               ! 1.9SH
8175: 0d32:     TXT$ = ""                                                           ! 1.9SH
8176: 0d48: END FUNCTION                                                            ! 1.9SH
8177: 0d66: 
8178: 0d66: \**********************************************************************
8179: 0d66: \***  Increment suffix
8180: 0d66: \**********************************************************************
8181: 0d66: SUB INCREMENT.SUFFIX(SFX$)                                              ! 1.9SH
8182: 0d8a:     STRING SFX$                                                         ! 1.9SH
8183: 0d8a:     SFX$ = PADNUM$(VALUE%(LEFT$(SFX$,6)) + 1, 6) + MID$(SFX$, 7, 32767) ! 1.9SH
8184: 0df8: END SUB                                                                 ! 1.9SH
8185: 0e0c: 
8186: 0e0c: 
8187: 0e0c:     SUB PSS3705 PUBLIC
8188: 0e30: 
8189: 0e30: STRING BAR.CODE$
8190: 0e30: STRING BOOTS.CODE$
8191: 0e30: STRING BUFFER.FILE$                                                  ! 1.4CS
8192: 0e30: STRING BUFFER.RECORD$                                                ! 1.4CS
8193: 0e30: STRING COUNT$
8194: 0e30: STRING COUNT.DAY$
8195: 0e30: STRING COUNT.MONTH$
8196: 0e30: STRING COUNT.QTY$
8197: 0e30: STRING COUNT.YEAR$
8198: 0e30: STRING CURRENT.STOCK$
8199: 0e30: STRING PDT.CODE$(1)
8200: 0e30: STRING SB.ACTION$
8201: 0e30: STRING SB.ERRF$
8202: 0e30: STRING SB.ERRL$
8203: 0e30: STRING SB.ERRS$
8204: 0e30: STRING SB.MESSAGE$
8205: 0e30: STRING SB.UNIQUE$
8206: 0e30: STRING SB.STRING$
8207: 0e30: STRING STOCK.OPEN.FLAG$
8208: 0e30: STRING STORED.CODE$(1)
8209: 0e30: STRING TEMP.CODE$
8210: 0e30: STRING VAR.STRING.1$
8211: 0e30: STRING VAR.STRING.2$
8212: 0e30: STRING SSPSCTRL.OPEN.FLAG$                                           ! 1.1JAS
8213: 0e30: STRING BTCS.OPEN.FLAG$                                               ! 1.1JAS
8214: 0e30: STRING PH.STORE.NUM$                                                 ! 1.1JAS
8215: 0e30: STRING PH.STKTAKE.NUM$                                               ! 1.1JAS
8216: 0e30: STRING PH.DATE$                                                      ! 1.1JAS
8217: 0e30: STRING PH.TIME$                                                      ! 1.1JAS
8218: 0e30: STRING PH.DISP.AREA$                                                 ! 1.1JAS
8219: 0e30: STRING PH.COUNT.TYPE$                                                ! 1.1JAS
8220: 0e30: STRING PH.DETAIL.DATA$(1)                                            ! 1.1JAS
8221: 0e30: STRING PRINTER.STATUS$                                               ! 1.1JAS
8222: 0e30: STRING BLANK.LINE$                                                   ! 1.1JAS
8223: 0e30: STRING FOOTER.LINE$                                                  ! 1.1JAS
8224: 0e30: STRING PAGE.THROW$                                                   ! 1.1JAS
8225: 0e30: STRING BUFFER.OPEN.FLAG$                                             ! 1.5BG
8226: 0e30: STRING PACKED.ITEM.CODE$                                             ! 1.5BG
8227: 0e30: STRING UOD$(1)                                                       ! 1.9SH
8228: 0e30: STRING BATCH.SIZE$                                                   ! 1.9SH
8229: 0e30: STRING FILE.SUFFIX$                                                  ! 1.9SH
8230: 0e30: STRING NEW.SUFFIX$                                                   ! 1.9SH
8231: 0e30: STRING UB.OPEN.FLAG$                                                 ! 1.9SH
8232: 0e30: STRING STATUS$                                                       ! 1.9SH
8233: 0e30: STRING BOL$                                                          ! 1.10SH
8234: 0e30: 
8235: 0e30: INTEGER*4 ADX.RET.CODE%
8236: 0e30: INTEGER*4 FILE.RETURN.CODE%
8237: 0e30: INTEGER*4 STORED.COUNT%(1)
8238: 0e30: INTEGER*4 RECALL.RECS%                                               ! 1.5BG
8239: 0e30: INTEGER*4 LAST.RECALL.REC%                                           ! 1.5BG
8240: 0e30: 
8241: 0e30: INTEGER*2 BUFFER.REPORT.NUM%                                         ! 1.4CS
8242: 0e30: INTEGER*2 COUNT.LOOP%
8243: 0e30: INTEGER*2 COUNT.NUMBER%
8244: 0e30: INTEGER*2 MESSAGE.NO%
8245: 0e30: INTEGER*2 PDT.STOCK%(1)
8246: 0e30: INTEGER*2 RETURN.CODE%
8247: 0e30: INTEGER*2 REP%
8248: 0e30: INTEGER*2 SB.FILE.REP.NUM%
8249: 0e30: INTEGER*2 SB.INTEGER%
8250: 0e30: INTEGER*2 STOCK.COUNT%
8251: 0e30: INTEGER*2 TABLE.LOOP%
8252: 0e30: INTEGER*2 VALID.ITEMS%
8253: 0e30: INTEGER*2 RECALLS.RECORD.COUNT%                                      ! 1.5BG
8254: 0e30: INTEGER*2 CURRENT.RECALL.REC%                                        ! 1.5BG
8255: 0e30: INTEGER*2 REWKF.ITEM.COUNT%                                          ! 1.5BG
8256: 0e30: INTEGER*2 ITEMS.THIS.RECORD%                                         ! 1.5BG
8257: 0e30: INTEGER*2 MAX.RECALLS.ITEMS%                                         ! 1.5BG
8258: 0e30: INTEGER*2 ITEM.IN.PROGRESS%                                          ! 1.5BG
8259: 0e30: INTEGER*2 NUM.UODS%                                                  ! 1.9SH
8260: 0e30: INTEGER*2 NUM.RECS%                                                  ! 1.9SH
8261: 0e30: INTEGER*2 RETRIES%                                                   ! 1.9SH
8262: 0e30: 
8263: 0e30: INTEGER*1 BUFFER.SESS.NUM%                                           ! 1.4CS
8264: 0e30: INTEGER*1 CURR.SESS.NUM%
8265: 0e30: INTEGER*1 COUNT.IN.PROGRESS%
8266: 0e30: INTEGER*1 EVENT.NO%
8267: 0e30: INTEGER*1 FALSE
8268: 0e30: INTEGER*1 MASK%
8269: 0e30: INTEGER*1 SB.EVENT.NO%
8270: 0e30: INTEGER*1 SB.FILE.SESS.NUM%
8271: 0e30: INTEGER*1 STOCK.FOUND%
8272: 0e30: INTEGER*1 TRUE
8273: 0e30: INTEGER*1 VALID.CODE%
8274: 0e30: INTEGER*1 VALID.HEADER%
8275: 0e30: INTEGER*1 VALID.TRAILER%
8276: 0e30: INTEGER*1 PRINTER.ERROR                                              ! 1.1JAS
8277: 0e30: INTEGER*1 PRINTER.OPEN                                               ! 1.1JAS
8278: 0e30: INTEGER*1 PRINTING.COMPLETE%                                         ! 1.1JAS
8279: 0e30: INTEGER*1 AUTHORISED                                                 ! 1.9SH
8280: 0e30: INTEGER*1 ONIGHT                                                     ! 1.9SH
8281: 0e30: 
8282: 0e30: \******************************************************************************
8283: 0e30: \******************************************************************************
8284: 0e30: \***                                                                        ***
8285: 0e30: \***   M A I N L I N E   C O D E                                            ***
8286: 0e30: \***                                                                        ***
8287: 0e30: \******************************************************************************
8288: 0e30: \******************************************************************************
8289: 0e30: 
8290: 0e30: ON ERROR GOTO ERROR.DETECTED
8291: 0e45: 
8292: 0e45:     MODULE.NUMBER$ = "PSS3705"                                       ! 1.9SH   
8293: 0e5c: 
8294: 0e5c:     TRUE = -1                                                        ! 1.9SH
8295: 0e69:     FALSE = 0                                                        ! 1.9SH
8296: 0e76: 
8297: 0e76: ! Check to see if either Stock count or SmartScript pharmacy count   ! 1.1JAS
8298: 0e76: 
8299: 0e76:     IF RECEIVE.STATE$ = "s" OR RECEIVE.STATE$ = "w" THEN BEGIN       ! 1.1JAS
8300: 0ec8:        GOSUB INITIALISE
8301: 0eda:        COUNT.IN.PROGRESS% = TRUE                                     
8302: 0ee8:        GOSUB OPEN.FILES
8303: 0efa:     ENDIF
8304: 0f02:     
8305: 0f02:     IF RECEIVE.STATE$ = "1" OR \                                       ! 1.5BG
8306: 0f8f:        (RECEIVE.STATE$ = "3" AND MID$(DATA.IN$,25,1) = "Y") THEN BEGIN ! 1.5BG
8307: 0f8f:        GOSUB INITIALISE                                                ! 1.5BG
8308: 0fa1:     ENDIF                                                              ! 1.5BG
8309: 0fa9:     
8310: 0fa9:     !If recalls then go to the relevent subroutines - added extra    ! 1.5BG
8311: 0fa9:     !because these states start at 1.                                ! 1.5BG
8312: 0fa9:     IF MATCH(RECEIVE.STATE$,"123456789:;<=",1) > 0 THEN BEGIN        ! 1.9SH
8313: 0fcf:        ON (ASC(RECEIVE.STATE$) - ASC("1") + 1) GOSUB \               ! 1.5BG
8314: 1015:              RECEIVED.RECALLS.REQUEST,        \                      ! 1.5BG
8315: 1015:              RECEIVED.RECALLS.RECEIVED.OK,    \                      ! 1.5BG
8316: 1015:              RECEIVED.RECALLS.HEADER,         \                      ! 1.5BG
8317: 1015:              RECEIVED.RECALLS.DETAIL,         \                      ! 1.5BG
8318: 1015:              RECEIVED.RECALLS.TRAILER,        \                      ! 1.5BG
8319: 1015:              RECEIVED.RECALLS.EOT,            \                      ! 1.9SH
8320: 1015:              RECEIVED.PUOD.SIGN.ON,           \                      ! 1.9SH
8321: 1015:              RECEIVED.PUOD.RECEIVED.OK,       \                      ! 1.9SH
8322: 1015:              RECEIVED.PUOD.HEADER,            \                      ! 1.9SH
8323: 1015:              RECEIVED.PUOD.DETAIL,            \                      ! 1.9SH
8324: 1015:              RECEIVED.PUOD.BATCH.TRAILER,     \                      ! 1.9SH
8325: 1015:              RECEIVED.PUOD.SESSION.TRAILER,   \                      ! 1.9SH
8326: 1015:              RECEIVED.PUOD.EOT                                       ! 1.9SH       
8327: 1015:     ENDIF                                                            ! 1.5BG
8328: 101d: 
8329: 101d: ! Upon Receive State type - process the relevant record type         ! 1.1JAS
8330: 101d: 
8331: 101d:     IF COUNT.IN.PROGRESS% THEN BEGIN
8332: 102f:        IF MATCH(RECEIVE.STATE$,"stuvwxyz",1) > 0 THEN BEGIN          ! 1.1JAS
8333: 1055:           ON (ASC(RECEIVE.STATE$) - ASC("r")) GOSUB \
8334: 109a:                 RECEIVED.STOCKCOUNT.HEADER,         \
8335: 109a:                 RECEIVED.STOCKCOUNT.DETAIL,         \
8336: 109a:                 RECEIVED.STOCKCOUNT.TRAILER,        \
8337: 109a:                 RECEIVED.STOCKCOUNT.EOT,            \                ! 1.1JAS
8338: 109a:                 RECEIVED.SMARTSCRIPT.HEADER,        \                ! 1.1JAS
8339: 109a:                 RECEIVED.SMARTSCRIPT.DETAIL,        \                ! 1.1JAS
8340: 109a:                 RECEIVED.SMARTSCRIPT.TRAILER,       \                ! 1.1JAS
8341: 109a:                 RECEIVED.SMARTSCRIPT.EOT                             ! 1.1JAS
8342: 109a:        ENDIF
8343: 10a2:     ENDIF
8344: 10aa: 
8345: 10aa:     GOTO PROGRAM.EXIT
8346: 10b4: 
8347: 10b4: MODULE.EXIT:
8348: 10c4: 
8349: 10c4:     COUNT.IN.PROGRESS% = FALSE
8350: 10d2:     GOSUB CLOSE.FILES
8351: 10e4:     RECEIVE.STATE$ = "*"
8352: 10fb: 
8353: 10fb: PROGRAM.EXIT:
8354: 110b: 
8355: 110b: ! Trailer record for either Stock count or SmartScript count         ! 1.1JAS
8356: 110b: 
8357: 110b:     IF RECEIVE.STATE$ = "u" OR RECEIVE.STATE$ = "y" AND     \        ! 1.1JAS
8358: 115f:        COUNT.IN.PROGRESS% THEN GOSUB CLOSE.FILES
8359: 1171: 
8360: 1171: ! EOT record for either Stock count or SmartScript count             ! 1.1JAS
8361: 1171: 
8362: 1171:     IF RECEIVE.STATE$ = "v" OR RECEIVE.STATE$ = "z" AND     \        ! 1.1JAS
8363: 11c5:        COUNT.IN.PROGRESS% THEN BEGIN
8364: 11c5:        COUNT.IN.PROGRESS% = FALSE
8365: 11d3:        RE.CHAIN = TRUE
8366: 11e5:        RECEIVE.STATE$ = "?"
8367: 11fc:     ENDIF
8368: 1204:     
8369: 1204:     IF RECEIVE.STATE$ = "1" THEN BEGIN                               ! 1.5BG
8370: 1222:       !Release PDT                                                   ! 1.5BG
8371: 1222:       PIPE.OUT$ = "HN"                                               ! 1.5BG
8372: 1239:       GOSUB SEND.TO.PSS38                                            ! 1.5BG
8373: 124b:       HOLD.FLAG$ = "N"                                               ! 1.5BG
8374: 1262:    ENDIF                                                             ! 1.5BG
8375: 126a: 
8376: 126a:    EXIT SUB
8377: 1275: 
8378: 1275:     STOP
8379: 1282: 
8380: 1282: 
8381: 1282: \******************************************************************************
8382: 1282: \******************************************************************************
8383: 1282: \***                                                                        ***
8384: 1282: \***   S U B R O U T I N E S                                                ***
8385: 1282: \***                                                                        ***
8386: 1282: \******************************************************************************
8387: 1282: \******************************************************************************
8388: 1282: 
8389: 1282: \******************************************************************************
8390: 1282: \***
8391: 1282: \***   INITIALISE
8392: 1282: \***
8393: 1282: \******************************************************************************
8394: 1282: 
8395: 1282: INITIALISE:
8396: 1292: 
8397: 1292:     IF RECEIVE.STATE$ = "s" OR RECEIVE.STATE$ = "w" THEN BEGIN          ! 1.5BG
8398: 12e7:     
8399: 12e7:        COUNT.QTY$ = ""
8400: 12fc:        CURRENT.STOCK$ = ""
8401: 1311: 
8402: 1311:       !Set up report lines for SmartScript confirmation report          ! 1.1JAS
8403: 1311:        BLANK.LINE$ = STRING$(80," ")                                    ! 1.1JAS
8404: 132d:        FOOTER.LINE$ = STRING$(15," ") +                               \ ! 1.1JAS
8405: 135b:                       "* * *   E N D   O F   R E P O R T   * * *"       ! 1.1JAS
8406: 135b:        PAGE.THROW$ = STRING$(79, CHR$(0)) + CHR$(12)                    ! 1.1JAS
8407: 139a: 
8408: 139a:        ! THESE DIMS ARE SET TO 501 BECAUSE THE PDT WILL NOT ALLOW MORE THAN 500 COUNTS.
8409: 139a:        DIM PDT.CODE$(501)            
8410: 13c4:        DIM PDT.STOCK%(501)           
8411: 13ee:        DIM STORED.CODE$(501)         
8412: 1418:        DIM STORED.COUNT%(501)        
8413: 1442: 
8414: 1442:        DIM PH.DETAIL.DATA$(3000)                                     ! 1.1JAS
8415: 146c: 
8416: 146c:        CALL SSPSCTRL.SET                                             ! 1.1JAS
8417: 1479:        CALL BTCS.SET                                                 ! 1.1JAS
8418: 1494:        CALL PRINT.SET                                                ! 1.1JAS
8419: 14a1:    
8420: 14a1:    ENDIF                                                             ! 1.5BG
8421: 14a9: 
8422: 14a9: RETURN
8423: 14b9: 
8424: 14b9: 
8425: 14b9: \******************************************************************************
8426: 14b9: \***
8427: 14b9: \***   RECEIVED.STOCKCOUNT.HEADER:                              STATE : s
8428: 14b9: \***
8429: 14b9: \******************************************************************************
8430: 14b9: 
8431: 14b9: RECEIVED.STOCKCOUNT.HEADER:
8432: 14c9: 
8433: 14c9:     SB.MESSAGE$ = "PDT Support - Stock count header received"
8434: 14de:     GOSUB SB.BG.MESSAGE
8435: 14f0: 
8436: 14f0:     IF FN.VALIDATE.DATA(DATA.IN$, 46) = 0 THEN BEGIN
8437: 1512:        RECEIVE.STATE$ = "*"
8438: 1529:        RETURN
8439: 1539:     ENDIF
8440: 1541: 
8441: 1541:     PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"START OF STOCK COUNTS"
8442: 1569: 
8443: 1569:     VALID.HEADER% = TRUE
8444: 1577:     COUNT.NUMBER% = 0
8445: 1585:     IF MID$(DATA.IN$, 3, 17) <> "00000000000000000" THEN VALID.HEADER% = FALSE
8446: 15c0: 
8447: 15c0: RETURN
8448: 15d0: 
8449: 15d0: \******************************************************************************
8450: 15d0: \***
8451: 15d0: \***   RECEIVED.STOCKCOUNT.DETAIL:                              STATE : t
8452: 15d0: \***
8453: 15d0: \******************************************************************************
8454: 15d0: 
8455: 15d0: RECEIVED.STOCKCOUNT.DETAIL:
8456: 15e0: 
8457: 15e0:     SB.MESSAGE$ = "PDT Support - Stock count detail received"
8458: 15f5:     GOSUB SB.BG.MESSAGE
8459: 1607: 
8460: 1607:     IF FN.VALIDATE.DATA(DATA.IN$, 47) = 0 THEN BEGIN
8461: 1629:        RECEIVE.STATE$ = "*"
8462: 1640:        RETURN
8463: 1650:     ENDIF
8464: 1658: 
8465: 1658:     IF VALID.HEADER% THEN BEGIN
8466: 166a:        COUNT.NUMBER% = COUNT.NUMBER% + 1
8467: 1676:        PDT.CODE$(COUNT.NUMBER%) = MID$(DATA.IN$, 3, 13)
8468: 16a8:        PDT.STOCK%(COUNT.NUMBER%) = VAL(MID$(DATA.IN$, 16, 4))
8469: 16e6:     ENDIF
8470: 16ee: 
8471: 16ee: RETURN
8472: 16fe: 
8473: 16fe: 
8474: 16fe: \******************************************************************************
8475: 16fe: \***
8476: 16fe: \***   RECEIVED.STOCKCOUNT.TRAILER:                               STATE : u
8477: 16fe: \***
8478: 16fe: \******************************************************************************
8479: 16fe: 
8480: 16fe: RECEIVED.STOCKCOUNT.TRAILER:
8481: 170e: 
8482: 170e:     SB.MESSAGE$ = "PDT Support - Stock count trailer received"
8483: 1723:     GOSUB SB.BG.MESSAGE
8484: 1735: 
8485: 1735:     IF FN.VALIDATE.DATA(DATA.IN$, 48) = 0 THEN BEGIN
8486: 1757:        RECEIVE.STATE$ = "*"
8487: 176e:        RETURN
8488: 177e:     ENDIF
8489: 1786: 
8490: 1786:     !RESPOND TO PDT
8491: 1786:     PIPE.OUT$ = "L" + DATA.IN$
8492: 17ab:     IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR
8493: 17c9:     CURRENT.REPORT.NUM% = PIPEI.REPORT.NUM%                                 !1.9SH
8494: 17e0:     WRITE# PIPEI.SESS.NUM%; PIPE.OUT$
8495: 1808: 
8496: 1808:     IF VALID.HEADER% THEN BEGIN
8497: 181a: 
8498: 181a:        VALID.TRAILER% = TRUE
8499: 1828:        IF MID$(DATA.IN$, 3, 13) <> "9999999999999" THEN VALID.TRAILER% = FALSE
8500: 1863: 
8501: 1863:        !CHECK THAT RECORD COUNT MATCHES
8502: 1863:        IF VAL(MID$(DATA.IN$, 16, 4)) <> COUNT.NUMBER% THEN VALID.TRAILER% = FALSE
8503: 18b1: 
8504: 18b1:        IF VALID.TRAILER% THEN BEGIN
8505: 18c3: 
8506: 18c3:           SB.MESSAGE$ = "PDT Support - Stock count trailer received"
8507: 18d8:           GOSUB SB.BG.MESSAGE
8508: 18ea:           
8509: 18ea:           VALID.ITEMS% = 0
8510: 18f8:           PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"VALIDATING " + STR$(COUNT.NUMBER%) + " STOCK COUNT ITEM(S) "
8511: 1945: 
8512: 1945:           ! Output counts to Stock Count Buffer File 
8513: 1945:           CURRENT.REPORT.NUM% = BUFFER.REPORT.NUM%                                    !1.9SH
8514: 1957:           IF END # BUFFER.SESS.NUM% THEN WRITE.ERROR                                  !1.4CS
8515: 1971:                                                                                       !1.4CS
8516: 1971:           FOR COUNT.LOOP% = 1 TO COUNT.NUMBER%                                        !1.4CS
8517: 1982:                                                                                       
8518: 1982:              BUFFER.RECORD$ = PDT.CODE$(COUNT.LOOP%) + \                              !1.4CS
8519: 19ee:                               RIGHT$("0000" + STR$(PDT.STOCK%(COUNT.LOOP%)), 4)       !1.4CS
8520: 19ee:                               
8521: 19ee:              WRITE #BUFFER.SESS.NUM%; BUFFER.RECORD$                                  !1.4CS
8522: 1a0f:                                                                                       !1.4CS
8523: 1a0f:           NEXT                                                                        !1.4CS
8524: 1a2a: 
8525: 1a2a: !          Redundant as LSS does not use this report now                               !1.4CS
8526: 1a2a: !          ADX.RET.CODE% = ADXSTART("ADX_UPGM:LSSST.286", \                     !1.3BG !1.4CS
8527: 1a2a: !                          MONITORED.PORT$,             \                       !1.3BG !1.4CS
8528: 1a2a: !                          "LSS Stock count report")                            !1.3BG !1.4CS
8529: 1a2a:            ! Call new program to process the counts. This prevents the PDT from !1.4CS
8530: 1a2a:            ! timing out when excessive counts are transmitted and processed     !1.4CS
8531: 1a2a:            ADX.RET.CODE% = ADXSTART("ADX_UPGM:PDTSC.286", \                     !1.4CS
8532: 1a59:                            MONITORED.PORT$,               \                     !1.4CS
8533: 1a59:                            "PDT Stock Count Program")                           !1.4CS
8534: 1a59: 
8535: 1a59:           SB.MESSAGE$ = "PDT Support - ADXSTART ADX_UPGM:PDTSC.286"
8536: 1a6e:           GOSUB SB.BG.MESSAGE
8537: 1a80:           PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"ADXSTART ADX_UPGM:PDTSC.286"
8538: 1aa8:           
8539: 1aa8:        ENDIF
8540: 1ab0: 
8541: 1ab0:     ENDIF
8542: 1ab8: 
8543: 1ab8: RETURN
8544: 1ac8: 
8545: 1ac8: 
8546: 1ac8: \******************************************************************************
8547: 1ac8: \***
8548: 1ac8: \***   RECEIVED.STOCKCOUNT.EOT:                              STATE : v
8549: 1ac8: \***
8550: 1ac8: \******************************************************************************
8551: 1ac8: 
8552: 1ac8: RECEIVED.STOCKCOUNT.EOT:
8553: 1ad8: 
8554: 1ad8:     SB.MESSAGE$ = "PDT Support - Stock count EOT received"
8555: 1aed:     GOSUB SB.BG.MESSAGE
8556: 1aff: 
8557: 1aff:     IF FN.VALIDATE.DATA(DATA.IN$, 49) = 0 THEN BEGIN
8558: 1b21:        RECEIVE.STATE$ = "*"
8559: 1b38:        RETURN
8560: 1b48:     ENDIF
8561: 1b50: 
8562: 1b50:     PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"STOCK COUNTS COMPLETE"
8563: 1b78: 
8564: 1b78: RETURN
8565: 1b88: 
8566: 1b88: \******************************************************************************
8567: 1b88: \***
8568: 1b88: \***   RECEIVED.SMARTSCRIPT.HEADER:                              STATE : w
8569: 1b88: \***
8570: 1b88: \******************************************************************************
8571: 1b88: 
8572: 1b88: RECEIVED.SMARTSCRIPT.HEADER:                                         ! 1.1JAS
8573: 1b98: 
8574: 1b98:     SB.MESSAGE$ = "PDT Support - SmartScript header received"        ! 1.1JAS
8575: 1bad:     GOSUB SB.BG.MESSAGE                                              ! 1.1JAS
8576: 1bbf: 
8577: 1bbf:     IF FN.VALIDATE.DATA(DATA.IN$, 50) = 0 THEN BEGIN                 ! 1.1JAS
8578: 1be1:        RECEIVE.STATE$ = "*"                                          ! 1.1JAS
8579: 1bf8:        RETURN                                                        ! 1.1JAS
8580: 1c08:     ENDIF                                                            ! 1.1JAS
8581: 1c10: 
8582: 1c10:     PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"START OF SMARTSCRIPT COUNTS"  ! 1.1JAS
8583: 1c38: 
8584: 1c38:     VALID.HEADER% = TRUE                                             ! 1.1JAS
8585: 1c46:     COUNT.NUMBER% = 0                                                ! 1.1JAS
8586: 1c54:     !Validate that header record not set to all zero's               ! 1.1JAS
8587: 1c54:     IF MID$(DATA.IN$, 3, 22) EQ "0000000000000000000000" THEN VALID.HEADER% = FALSE  ! 1.1JAS
8588: 1c8f: 
8589: 1c8f:     !Validate header record length                                   ! 1.1JAS
8590: 1c8f:     IF LEN(DATA.IN$) NE 24 THEN VALID.HEADER% = FALSE                ! 1.1JAS
8591: 1cb3: 
8592: 1cb3:     IF VALID.HEADER% THEN BEGIN                                      ! 1.1JAS
8593: 1cc5:        PH.STORE.NUM$   = MID$(DATA.IN$, 3,  4)                       ! 1.1JAS
8594: 1cea:        PH.STKTAKE.NUM$ = MID$(DATA.IN$,  7,  4)                      ! 1.1JAS
8595: 1d0f:        PH.DATE$        = MID$(DATA.IN$, 11,  6)                      ! 1.1JAS
8596: 1d34:        PH.TIME$        = MID$(DATA.IN$, 17,  6)                      ! 1.1JAS
8597: 1d59:        PH.DISP.AREA$   = MID$(DATA.IN$, 23,  1)                      ! 1.1JAS
8598: 1d7e:        PH.COUNT.TYPE$  = MID$(DATA.IN$, 24,  1)                      ! 1.1JAS
8599: 1da3:     ENDIF                                                            ! 1.1JAS
8600: 1dab: 
8601: 1dab:     !Validate that count type = C for count or B for Book in         ! 1.1JAS
8602: 1dab:     IF PH.COUNT.TYPE$ <> "C" AND                 \                   ! 1.1JAS
8603: 1df7:        PH.COUNT.TYPE$ <> "B" THEN VALID.HEADER% = FALSE              ! 1.1JAS
8604: 1e05: 
8605: 1e05: RETURN                                                               ! 1.1JAS
8606: 1e15: 
8607: 1e15: \******************************************************************************
8608: 1e15: \***
8609: 1e15: \***   RECEIVED.SMARTSCRIPT.DETAIL:                              STATE : x
8610: 1e15: \***
8611: 1e15: \******************************************************************************
8612: 1e15: 
8613: 1e15: RECEIVED.SMARTSCRIPT.DETAIL:                                         ! 1.1JAS
8614: 1e25: 
8615: 1e25:     SB.MESSAGE$ = "PDT Support - SmartScript detail received"        ! 1.1JAS
8616: 1e3a:     GOSUB SB.BG.MESSAGE                                              ! 1.1JAS
8617: 1e4c: 
8618: 1e4c:     IF FN.VALIDATE.DATA(DATA.IN$, 51) = 0 THEN BEGIN                 ! 1.1JAS
8619: 1e6e:        RECEIVE.STATE$ = "*"                                          ! 1.1JAS
8620: 1e85:        RETURN                                                        ! 1.1JAS
8621: 1e95:     ENDIF
8622: 1e9d: 
8623: 1e9d:     !If header record valid process detail records                   ! 1.1JAS
8624: 1e9d:     IF VALID.HEADER% THEN BEGIN                                      ! 1.1JAS
8625: 1eac:        COUNT.NUMBER% = COUNT.NUMBER% + 1                             ! 1.1JAS
8626: 1eb8:        PH.DETAIL.DATA$(COUNT.NUMBER%) = MID$(DATA.IN$, 3, 24)        ! 1.1JAS
8627: 1eea:     ENDIF                                                            ! 1.1JAS
8628: 1ef2: 
8629: 1ef2: RETURN                                                               ! 1.1JAS
8630: 1f02: 
8631: 1f02: \******************************************************************************
8632: 1f02: \***
8633: 1f02: \***   RECEIVED.SMARTSCRIPT.TRAILER:                               STATE : y
8634: 1f02: \***
8635: 1f02: \******************************************************************************
8636: 1f02: 
8637: 1f02: RECEIVED.SMARTSCRIPT.TRAILER:                                        ! 1.1JAS
8638: 1f12: 
8639: 1f12:     SB.MESSAGE$ = "PDT Support - SmartScript trailer received"       ! 1.1JAS
8640: 1f27:     GOSUB SB.BG.MESSAGE                                              ! 1.1JAS
8641: 1f39: 
8642: 1f39:     IF FN.VALIDATE.DATA(DATA.IN$, 52) = 0 THEN BEGIN                 ! 1.1JAS
8643: 1f5b:        RECEIVE.STATE$ = "*"                                          ! 1.1JAS
8644: 1f72:        RETURN                                                        ! 1.1JAS
8645: 1f82:     ENDIF                                                            ! 1.1JAS
8646: 1f8a: 
8647: 1f8a:     !RESPOND TO PDT                                                  ! 1.1JAS
8648: 1f8a: !    PIPE.OUT$ = "L" + DATA.IN$                                       ! 1.1JAS
8649: 1f8a: !    IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR                         ! 1.1JAS
8650: 1f8a: !    CURR.SESS.NUM% = PIPEI.SESS.NUM%                                 ! 1.1JAS
8651: 1f8a: !    WRITE# PIPEI.SESS.NUM%; PIPE.OUT$                                ! 1.1JAS
8652: 1f8a: 
8653: 1f8a:     IF VALID.HEADER% THEN BEGIN                                      ! 1.1JAS
8654: 1f9c:        !Validate that the trailer record count qty is not greater than 3000 ! 1.1JAS
8655: 1f9c:        !and not less than 2                                          ! 1.1JAS
8656: 1f9c:        VALID.TRAILER% = TRUE                                         ! 1.1JAS
8657: 1faa:        IF VAL(MID$(DATA.IN$, 3, 4)) < 2 OR    \                      ! 1.1JAS
8658: 2059:           VAL(MID$(DATA.IN$,  3,  4)) > 3000 THEN VALID.TRAILER% = FALSE ! 1.1JAS
8659: 2067: 
8660: 2067:        !Check that the record count processed matches the value held in the trailer count field  ! 1.1JAS
8661: 2067:        IF VAL(MID$(DATA.IN$, 3, 4)) <> COUNT.NUMBER% + 2 THEN VALID.TRAILER% = FALSE  ! 1.1JAS
8662: 20b8: 
8663: 20b8:        IF VALID.TRAILER% THEN BEGIN                                  ! 1.1JAS
8664: 20ca:           !Write count information to file                           ! 1.1JAS
8665: 20ca:           PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"WRITING " +         \ 1.1JAS
8666: 2117:                       STR$(COUNT.NUMBER%) + " SMARTSCRIPT COUNT ITEM(S) "  ! 1.1JAS
8667: 2117:           FOR COUNT.LOOP% = 1 TO COUNT.NUMBER%                       ! 1.1JAS
8668: 2127: 
8669: 2127:              IF COUNT.LOOP% = 1 THEN BEGIN                           ! 1.1JAS
8670: 2136:                 GOSUB WRITE.SMARTSCRIPT.HEADER                       ! 1.1JAS
8671: 2148:              ENDIF                                                   ! 1.1JAS
8672: 2150: 
8673: 2150:              GOSUB WRITE.SMARTSCRIPT.DETAIL                          ! 1.1JAS
8674: 2162: 
8675: 2162:           NEXT                                                       ! 1.1JAS
8676: 217a: 
8677: 217a:           GOSUB WRITE.SMARTSCRIPT.TRAILER                            ! 1.1JAS
8678: 218c: 
8679: 218c:        ENDIF                                                         ! 1.1JAS
8680: 2194: 
8681: 2194:     ENDIF                                                            ! 1.1JAS
8682: 219c: 
8683: 219c:     !RESPOND TO PDT                                                  ! 1.1JAS
8684: 219c:     PIPE.OUT$ = "L" + DATA.IN$                                       ! 1.1JAS
8685: 21c1:     IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR                         ! 1.1JAS
8686: 21df:     CURRENT.REPORT.NUM% = PIPEI.REPORT.NUM%                          ! 1.9SH
8687: 21f6:     WRITE# PIPEI.SESS.NUM%; PIPE.OUT$                                ! 1.1JAS
8688: 221e: 
8689: 221e: RETURN                                                               ! 1.1JAS
8690: 222e: 
8691: 222e: \******************************************************************************
8692: 222e: \***
8693: 222e: \***   RECEIVED.SMARTSCRIPT.EOT:                              STATE : z
8694: 222e: \***
8695: 222e: \******************************************************************************
8696: 222e: 
8697: 222e: RECEIVED.SMARTSCRIPT.EOT:                                            ! 1.1JAS
8698: 223e: 
8699: 223e:     SB.MESSAGE$ = "PDT Support - SmartScript EOT received"           ! 1.1JAS
8700: 2253:     GOSUB SB.BG.MESSAGE                                              ! 1.1JAS
8701: 2265: 
8702: 2265:     IF FN.VALIDATE.DATA(DATA.IN$, 53) = 0 THEN BEGIN                 ! 1.1JAS
8703: 2287:        RECEIVE.STATE$ = "*"                                          ! 1.1JAS
8704: 229e:        RETURN                                                        ! 1.1JAS
8705: 22ae:     ENDIF                                                            ! 1.1JAS
8706: 22b6: 
8707: 22b6:     PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"SMARTSCRIPT COUNTS COMPLETE" ! 1.1JAS
8708: 22de: 
8709: 22de: RETURN                                                               ! 1.1JAS
8710: 22ee: 
8711: 22ee: \*****************************************************************************
8712: 22ee: \***
8713: 22ee: \***  WRITE.SMARTSCRIPT.HEADER
8714: 22ee: \***
8715: 22ee: \***  Open Pharmacy SmartScrip system control file (SSPSCTRL)
8716: 22ee: \***  If read is successful check what type of count was passed from the PDT
8717: 22ee: \***  If type = "C" (count) then find last extension number for BTCSK
8718: 22ee: \***  If type = "B" (book in) then find last extension number for BTCSF
8719: 22ee: \***  If last extension number for either file was set to "999" the next number
8720: 22ee: \***  to use will be "001" else add + 1 to give next extension number.
8721: 22ee: \***  Add the rest of the file name to BTCS (either BTCSK.???, or BTCSF.???
8722: 22ee: \***  where ??? = extension number
8723: 22ee: \***  Create the BTCS?.??? output file.
8724: 22ee: \***  Write header record to BTCS?.???
8725: 22ee: \***
8726: 22ee: \*****************************************************************************
8727: 22ee: 
8728: 22ee: WRITE.SMARTSCRIPT.HEADER:                                            ! 1.1JAS
8729: 22fe: 
8730: 22fe:     !Open control file                                               ! 1.1JAS
8731: 22fe:     SB.INTEGER% = SSPSCTRL.REPORT.NUM%                               ! 1.1JAS
8732: 2310:     IF END# SSPSCTRL.SESS.NUM% THEN FILE.NOT.FOUND                   ! 1.1JAS
8733: 232c:     OPEN SSPSCTRL.FILE.NAME$ DIRECT RECL SSPSCTRL.RECL%  \           ! 1.1JAS
8734: 2359:          AS SSPSCTRL.SESS.NUM% LOCKED NODEL                          ! 1.1JAS
8735: 2359: 
8736: 2359:     SSPSCTRL.OPEN.FLAG$ = "Y"                                        ! 1.1JAS
8737: 236e: 
8738: 236e:     !Read control file to get last Extension number                  ! 1.1JAS
8739: 236e:     FILE.RETURN.CODE% = READ.SSPSCTRL                                ! 1.1JAS
8740: 2387: 
8741: 2387:     IF FILE.RETURN.CODE% NE 0 THEN BEGIN                             ! 1.1JAS
8742: 23a2:        GOSUB READ.SSPSCTRL.ERROR                                     ! 1.1JAS
8743: 23b4:        RETURN                                                        ! 1.1JAS
8744: 23c4:     ENDIF                                                            ! 1.1JAS
8745: 23cc: 
8746: 23cc:     !If type = C find last BTCSK ext num, if set to 999 then new ext ! 1.1JAS
8747: 23cc:     !number = 001 else add + 1 to last number.  File name = BTCSK +  ! 1.1JAS
8748: 23cc:     ! ext number                                                     ! 1.1JAS
8749: 23cc:     !If type = B find last BTCSF ext num, if set to 999 then new ext ! 1.1JAS
8750: 23cc:     !number = 001, else add + 1 to last number.  File name = BTCSF + ! 1.1JAS
8751: 23cc:     ! ext number                                                     ! 1.1JAS
8752: 23cc:     IF PH.COUNT.TYPE$ = "C" THEN BEGIN                               ! 1.1JAS
8753: 23ea:        IF SSPS.BTCSK.NUM$ = "999" THEN BEGIN                         ! 1.1JAS
8754: 2408:           SSPS.BTCSK.NUM$ = "001"                                    ! 1.1JAS
8755: 2422:        ENDIF ELSE BEGIN                                              ! 1.1JAS
8756: 242a:           SSPS.BTCSK.NUM$ = RIGHT$("000" + STR$(VAL(SSPS.BTCSK.NUM$) +1),3)  ! 1.1JAS
8757: 249a:        ENDIF
8758: 24a2:        BTCS.FILE.NAME$ = BTCS.FILE.NAME$ + "K." + SSPS.BTCSK.NUM$    ! 1.1JAS
8759: 24d5:     ENDIF ELSE BEGIN                                                 ! 1.1JAS
8760: 24dd:        IF SSPS.BTCSF.NUM$ = "999" THEN BEGIN                         ! 1.1JAS
8761: 24fb:           SSPS.BTCSF.NUM$ = "001"                                    ! 1.1JAS
8762: 2515:        ENDIF ELSE BEGIN                                              ! 1.1JAS
8763: 251d:           SSPS.BTCSF.NUM$ = RIGHT$("000" + STR$(VAL(SSPS.BTCSF.NUM$) +1),3)  ! 1.1JAS
8764: 258d:        ENDIF
8765: 2595:        BTCS.FILE.NAME$ = BTCS.FILE.NAME$ + "F." + SSPS.BTCSF.NUM$    ! 1.1JAS
8766: 25c5:     ENDIF                                                            ! 1.1JAS
8767: 25cd: 
8768: 25cd:     SB.INTEGER% = BTCS.REPORT.NUM%                                   ! 1.1JAS
8769: 25df: 
8770: 25df:     !Create BTCS file
8771: 25df:     IF END #BTCS.SESS.NUM% THEN CREATE.ERROR                         ! 1.1JAS
8772: 25fb:     CREATE POSFILE BTCS.FILE.NAME$ DIRECT 0 RECL BTCS.RECL%       \  ! 1.1JAS
8773: 262c:            AS BTCS.SESS.NUM% LOCKED MIRRORED ATCLOSE                 !1.1JAS
8774: 262c: 
8775: 262c:     BTCS.OPEN.FLAG$ = "Y"                                            ! 1.1JAS
8776: 2641: 
8777: 2641:     BTCS.REC.NUM% = BTCS.REC.NUM% + 1                                ! 1.1JAS
8778: 265a: 
8779: 265a:     !Write BTCS file header record                                   ! 1.1JAS
8780: 265a: 
8781: 265a:     BTCS.STORE.NUMBER$ = PH.STORE.NUM$                               ! 1.1JAS
8782: 2675:     BTCS.STKTAKE.NUM$  = PH.STKTAKE.NUM$                             ! 1.1JAS
8783: 2690:     BTCS.DATE$         = PH.DATE$                                    ! 1.1JAS
8784: 26ab:     BTCS.TIME$         = PH.TIME$                                    ! 1.1JAS
8785: 26c6:     BTCS.DISP.AREA$    = PH.DISP.AREA$                               ! 1.1JAS
8786: 26e1:     BTCS.FILLER$       = STRING$(14, " ")                            ! 1.1JAS
8787: 26ff:     BTCS.RECORD.TYPE$  = "H"                                         ! 1.1JAS
8788: 2716:     BTCS.NUM.RECORD$   = "0001"                                      ! 1.1JAS
8789: 272d:     BTCS.ENDREC$       = CHR$(13) + CHR$(10)                         ! 1.3JAS
8790: 275c: 
8791: 275c:     FILE.RETURN.CODE% = WRITE.BTCS                                   ! 1.1JAS
8792: 2779: 
8793: 2779:     IF FILE.RETURN.CODE% NE 0 THEN BEGIN                             ! 1.1JAS
8794: 2794:        GOSUB WRITE.ERROR                                             ! 1.1JAS
8795: 27a6:     ENDIF                                                            ! 1.1JAS
8796: 27ae: 
8797: 27ae:     BTCS.REC.NUM% = BTCS.REC.NUM% + 1                                ! 1.1JAS
8798: 27c7: 
8799: 27c7: RETURN                                                               ! 1.1JAS
8800: 27d7: 
8801: 27d7: \*****************************************************************************
8802: 27d7: \***
8803: 27d7: \*** WRITE.SMARTSCRIPT.DETAIL:
8804: 27d7: \***
8805: 27d7: \*****************************************************************************
8806: 27d7: 
8807: 27d7: WRITE.SMARTSCRIPT.DETAIL:                                            ! 1.1JAS
8808: 27e7: 
8809: 27e7:     BTCS.ITEM.CODE$     = LEFT$(PH.DETAIL.DATA$(COUNT.LOOP%), 13)    ! 1.1JAS
8810: 2819:     BTCS.CODE.TYPE$     = MID$(PH.DETAIL.DATA$(COUNT.LOOP%), 14,  1) ! 1.1JAS
8811: 284b:     BTCS.PACK.QTY$      = MID$(PH.DETAIL.DATA$(COUNT.LOOP%), 15,  6) ! 1.1JAS
8812: 287d:     BTCS.DIS.UNIT.QTY$  = MID$(PH.DETAIL.DATA$(COUNT.LOOP%), 21,  4) ! 1.1JAS
8813: 28af:     BTCS.FILLER$        = STRING$(11, " ")                           ! 1.1JAS
8814: 28cd:     BTCS.RECORD.TYPE$   = "D"                                        ! 1.1JAS
8815: 28e4:     BTCS.NUM.RECORD$    = RIGHT$("0000" + STR$(COUNT.LOOP% +1),4)    ! 1.1JAS
8816: 292b:     BTCS.ENDREC$       = CHR$(13) + CHR$(10)                         ! 1.3JAS
8817: 295a: 
8818: 295a:     FILE.RETURN.CODE% = WRITE.BTCS                                   ! 1.1JAS
8819: 2977: 
8820: 2977:     IF FILE.RETURN.CODE% NE 0 THEN BEGIN                             ! 1.1JAS
8821: 2992:        GOSUB WRITE.ERROR                                             ! 1.1JAS
8822: 29a4:     ENDIF                                                            ! 1.1JAS
8823: 29ac: 
8824: 29ac:     BTCS.REC.NUM% = BTCS.REC.NUM% + 1                                ! 1.1JAS
8825: 29c5: 
8826: 29c5: RETURN                                                               ! 1.1JAS
8827: 29d5: 
8828: 29d5: \*****************************************************************************
8829: 29d5: \***
8830: 29d5: \*** WRITE.SMARTSCRIPT.TRAILER
8831: 29d5: \***
8832: 29d5: \*****************************************************************************
8833: 29d5: 
8834: 29d5: WRITE.SMARTSCRIPT.TRAILER:                                           ! 1.1JAS
8835: 29e5: 
8836: 29e5:     BTCS.RECORD.COUNT$  = RIGHT$("0000" + STR$(COUNT.LOOP% +1),4)    ! 1.1JAS
8837: 2a2c:     BTCS.FILLER$        = STRING$(31, " ")                           ! 1.1JAS
8838: 2a4a:     BTCS.RECORD.TYPE$   = "T"                                        ! 1.1JAS
8839: 2a61:     BTCS.NUM.RECORD$    = RIGHT$("0000" + STR$(COUNT.LOOP% +1),4)    ! 1.1JAS
8840: 2aa8:     BTCS.ENDREC$       = CHR$(13) + CHR$(10)                         ! 1.3JAS
8841: 2ad7: 
8842: 2ad7:     FILE.RETURN.CODE% = WRITE.BTCS                                   ! 1.1JAS
8843: 2af4: 
8844: 2af4:     IF FILE.RETURN.CODE% NE 0 THEN BEGIN                             ! 1.1JAS
8845: 2b0f:        GOSUB WRITE.ERROR                                             ! 1.1JAS
8846: 2b21:     ENDIF                                                            ! 1.1JAS
8847: 2b29: 
8848: 2b29:     BTCS.REC.NUM% = BTCS.REC.NUM% + 1                                ! 1.1JAS
8849: 2b42: 
8850: 2b42:     SB.INTEGER% = SSPSCTRL.REPORT.NUM%                               ! 1.1JAS
8851: 2b54: 
8852: 2b54:     FILE.RETURN.CODE% = WRITE.SSPSCTRL                               ! 1.1JAS
8853: 2b6d: 
8854: 2b6d:     IF FILE.RETURN.CODE% NE 0 THEN BEGIN                             ! 1.1JAS
8855: 2b88:        GOSUB WRITE.ERROR                                             ! 1.1JAS
8856: 2b9a:     ENDIF                                                            ! 1.1JAS
8857: 2ba2: 
8858: 2ba2:     GOSUB WRITE.SMARTSCRIPT.REPORT                                   ! 1.1JAS
8859: 2bb4: 
8860: 2bb4:     !ADXSTART PSD45 to transfer file to pharmacy system              ! 1.1JAS
8861: 2bb4: 
8862: 2bb4:     ADX.RET.CODE% = ADXSTART("ADX_UPGM:PSD45.286",              \    ! 1.1JAS
8863: 2be3:                     MONITORED.PORT$,                            \    ! 1.1JAS
8864: 2be3:                   "PSD45 - Smartscript File transfer program")       ! 1.1JAS
8865: 2be3: 
8866: 2be3: RETURN                                                               ! 1.1JAS
8867: 2bf3: 
8868: 2bf3: \*****************************************************************************
8869: 2bf3: \***
8870: 2bf3: \*** WRITE.SMARTSCRIPT.REPORT
8871: 2bf3: \***
8872: 2bf3: \*****************************************************************************
8873: 2bf3: 
8874: 2bf3: WRITE.SMARTSCRIPT.REPORT:                                            ! 1.1JAS
8875: 2c03: 
8876: 2c03:   PRINTER.ERROR = FALSE                                              ! 1.1JAS
8877: 2c11:   PRINTER.OPEN  = FALSE                                              ! 1.1JAS
8878: 2c1f: 
8879: 2c1f:   SB.INTEGER% = PRINT.REPORT.NUM%                                    ! 1.1JAS
8880: 2c31:   IF END# PRINT.SESS.NUM% THEN FILE.NOT.FOUND                        ! 1.1JAS
8881: 2c4d:   OPEN PRINT.FILE.NAME$ AS PRINT.SESS.NUM%                           ! 1.1JAS
8882: 2c74: 
8883: 2c74:   PRINTER.OPEN = TRUE                                                ! 1.1JAS
8884: 2c82: 
8885: 2c82:   IF PRINTER.OPEN THEN BEGIN                                         ! 1.1JAS
8886: 2c94: 
8887: 2c94:      PRINT.LINE$ = "S3705" + STRING$(18," ")                  +  \   ! 1.1JAS
8888: 2ce2:                    "SMARTSCRIPT PHARMACY STOCK COUNT"         +  \   ! 1.1JAS
8889: 2ce2:                    STRING$(12," ") + "PAGE 1 OF 1"                   ! 1.1JAS
8890: 2ce2: 
8891: 2ce2:      CALL WRITE.PRINT                                                ! 1.1JAS
8892: 2cef: 
8893: 2cef:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8894: 2d0a: 
8895: 2d0a:      CALL WRITE.PRINT                                                ! 1.1JAS
8896: 2d17: 
8897: 2d17:      PRINT.LINE$ = STRING$(5," ") + "STORE NUMBER"            +  \   ! 1.1JAS
8898: 2d65:                    STRING$(18," ") + PH.STORE.NUM$                   ! 1.1JAS
8899: 2d65: 
8900: 2d65:      CALL WRITE.PRINT                                                ! 1.1JAS
8901: 2d72: 
8902: 2d72:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8903: 2d8d: 
8904: 2d8d:      CALL WRITE.PRINT                                                ! 1.1JAS
8905: 2d9a: 
8906: 2d9a:      PRINT.LINE$ = STRING$(5," ") + "STOCK TAKERS NUMBER"     +  \   ! 1.1JAS
8907: 2de8:                    STRING$(11," ") + PH.STKTAKE.NUM$                 ! 1.1JAS
8908: 2de8: 
8909: 2de8:      CALL WRITE.PRINT                                                ! 1.1JAS
8910: 2df5: 
8911: 2df5:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8912: 2e10: 
8913: 2e10:      CALL WRITE.PRINT                                                ! 1.1JAS
8914: 2e1d: 
8915: 2e1d:      PRINT.LINE$ = STRING$(5," ") + "DATE"                    +  \   ! 1.1JAS
8916: 2eb2:                    STRING$(26," ") + LEFT$(PH.DATE$,2)        +  \   ! 1.1JAS
8917: 2eb2:                    "/" + MID$(PH.DATE$,3,2) + "/"             +  \   ! 1.1JAS
8918: 2eb2:                    RIGHT$(PH.DATE$,2)                                ! 1.1JAS
8919: 2eb2: 
8920: 2eb2:      CALL WRITE.PRINT                                                ! 1.1JAS
8921: 2ebf: 
8922: 2ebf:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8923: 2eda: 
8924: 2eda:      CALL WRITE.PRINT                                                ! 1.1JAS
8925: 2ee7: 
8926: 2ee7:      PRINT.LINE$ = STRING$(5," ") + "TIME"                    +  \   ! 1.1JAS
8927: 2f7c:                    STRING$(26," ") + LEFT$(PH.TIME$,2)        +  \   ! 1.1JAS
8928: 2f7c:                    ":" + MID$(PH.TIME$,3,2) + ":"             +  \   ! 1.1JAS
8929: 2f7c:                    RIGHT$(PH.TIME$,2)                                ! 1.1JAS
8930: 2f7c: 
8931: 2f7c:      CALL WRITE.PRINT                                                ! 1.1JAS
8932: 2f89: 
8933: 2f89:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8934: 2fa4: 
8935: 2fa4:      CALL WRITE.PRINT                                                ! 1.1JAS
8936: 2fb1: 
8937: 2fb1:      IF PH.COUNT.TYPE$ = "C" THEN BEGIN                             ! 1.2JAS
8938: 2fcf:         IF PH.DISP.AREA$ = "M" THEN BEGIN                            ! 1.2JAS
8939: 2fea:            PRINT.LINE$ = STRING$(5," ") + "COUNT TYPE"        +  \   ! 1.2JAS
8940: 3036:                          STRING$(20," ") + "COUNT MDS"               ! 1.2JAS
8941: 3036:         ENDIF ELSE BEGIN                                             ! 1.2JAS
8942: 303e:            PRINT.LINE$ = STRING$(5," ") + "COUNT TYPE"        +  \   ! 1.2JAS
8943: 3088:                          STRING$(20," ") + "COUNT DISPENSING"        ! 1.2JAS
8944: 3088:         ENDIF                                                        ! 1.2JAS
8945: 3093:      ENDIF ELSE BEGIN                                                ! 1.2JAS
8946: 309b:         IF PH.DISP.AREA$ = "M" THEN BEGIN                            ! 1.2JAS
8947: 30b6:             PRINT.LINE$ = STRING$(5," ") + "COUNT TYPE"        +  \  ! 1.2JAS
8948: 3102:                           STRING$(20," ") + "BOOK IN MDS"            ! 1.2JAS
8949: 3102:         ENDIF ELSE BEGIN                                             ! 1.2JAS
8950: 310a:             PRINT.LINE$ = STRING$(5," ") + "COUNT TYPE"        +  \  ! 1.2JAS
8951: 3154:                           STRING$(20," ") + "BOOK IN DISPENSING"     ! 1.2JAS
8952: 3154:         ENDIF                                                        ! 1.2JAS
8953: 315c:      ENDIF                                                           ! 1.2JAS
8954: 3164: 
8955: 3164:      CALL WRITE.PRINT                                                ! 1.1JAS
8956: 3171: 
8957: 3171:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8958: 318c: 
8959: 318c:      CALL WRITE.PRINT                                                ! 1.1JAS
8960: 3199: 
8961: 3199:      PRINT.LINE$ = STRING$(5," ") + "NUMBER OF ITEMS COUNTED" +  \   ! 1.1JAS
8962: 3212:                    STRING$(7," ") + RIGHT$("0000" + STR$(COUNT.NUMBER%),4)  ! 1.1JAS
8963: 3212: 
8964: 3212:      CALL WRITE.PRINT                                                ! 1.1JAS
8965: 321f: 
8966: 321f:      PRINT.LINE$ = BLANK.LINE$                                       ! 1.1JAS
8967: 323a: 
8968: 323a:      CALL WRITE.PRINT                                                ! 1.1JAS
8969: 3247: 
8970: 3247:      PRINT.LINE$ = FOOTER.LINE$                                      ! 1.1JAS
8971: 3262: 
8972: 3262:      CALL WRITE.PRINT                                                ! 1.1JAS
8973: 326f: 
8974: 326f:      PRINT.LINE$ = PAGE.THROW$                                       ! 1.1JAS
8975: 328a: 
8976: 328a:      CALL WRITE.PRINT                                                ! 1.1JAS
8977: 3297: 
8978: 3297:   ENDIF                                                              ! 1.1JAS
8979: 329f: 
8980: 329f: NO.PRINT.FILE:                                                       ! 1.1JAS
8981: 32af: 
8982: 32af: RETURN                                                               ! 1.1JAS
8983: 32bf: 
8984: 32bf: 
8985: 32bf: \*****************************************************************************
8986: 32bf: \***
8987: 32bf: \*** RECEIVED.RECALLS.REQUEST
8988: 32bf: \***
8989: 32bf: \*****************************************************************************
8990: 32bf: 
8991: 32bf: RECEIVED.RECALLS.REQUEST:                                                           ! 1.5BG
8992: 32cf: 
8993: 32cf:    SB.MESSAGE$ = "PDT Support - RECALLS file request received"                      ! 1.5BG
8994: 32e4:    GOSUB SB.BG.MESSAGE                                                              ! 1.5BG
8995: 32f6:    IF FN.VALIDATE.DATA(DATA.IN$,55) = 0 THEN BEGIN                                  ! 1.5BG
8996: 3318:       RECEIVE.STATE$ = "*"                                                          ! 1.5BG
8997: 332f:       RETURN                                                                        ! 1.5BG
8998: 333f:    ENDIF                                                                            ! 1.5BG
8999: 3347:    
9000: 3347:    RECALLS.REFERENCE$ = MID$(DATA.IN$,3,8)                                          ! 1.5BG
9001: 336e:    CSR.AUDIT.DATA$ = "RECALLS Request for Recall " + RECALLS.REFERENCE$             ! 1.5BG
9002: 3393:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG
9003: 33a5:    
9004: 33a5:    MAX.RECALLS.ITEMS% = 500                                                         ! 1.5BG
9005: 33b3:    
9006: 33b3:    !Hold PDT                                                                        ! 1.5BG
9007: 33b3:    PIPE.OUT$ = "HY"                                                                 ! 1.5BG
9008: 33ca:    GOSUB SEND.TO.PSS38                                                              ! 1.5BG
9009: 33dc:    HOLD.FLAG$ = "Y"                                                                 ! 1.5BG
9010: 33f3:    
9011: 33f3:    IF END# IDF.SESS.NUM% THEN OPEN.ERROR                                            ! 1.5BG
9012: 340f:    CURRENT.REPORT.NUM% = IDF.REPORT.NUM%                                            ! 1.9SH
9013: 3425:    OPEN IDF.FILE.NAME$ KEYED RECL IDF.RECL% AS IDF.SESS.NUM% NOWRITE NODEL          ! 1.5BG
9014: 3452:    IDF.OPEN.FLAG$ = "Y"                                                             ! 1.5BG
9015: 3469:    
9016: 3469:    IF END #IMSTC.SESS.NUM% THEN OPEN.ERROR                                          ! 1.5BG
9017: 3485:    CURRENT.REPORT.NUM% = IMSTC.REPORT.NUM%                                          ! 1.9SH
9018: 349b:    OPEN IMSTC.FILE.NAME$ KEYED RECL IMSTC.RECL% AS IMSTC.SESS.NUM% NODEL            ! 1.5BG
9019: 34c8:    IMSTC.OPEN.FLAG$ = "Y"                                                           ! 1.5BG
9020: 34df:    
9021: 34df:    IF END #STOCK.SESS.NUM% THEN OPEN.ERROR                                          ! 1.5BG
9022: 34fb:    CURRENT.REPORT.NUM% = STOCK.REPORT.NUM%                                          ! 1.9SH
9023: 3511:    OPEN STOCK.FILE.NAME$ KEYED RECL STOCK.RECL% AS STOCK.SESS.NUM% NODEL            ! 1.5BG
9024: 3540:    STOCK.OPEN.FLAG$ = "Y"                                                           ! 1.5BG
9025: 3555: 
9026: 3555:    !Create REWKF locked                                                             ! 1.5BG
9027: 3555:    IF REWKF.OPEN.FLAG$ = "Y" THEN BEGIN                                             ! 1.5BG
9028: 3576:       REWKF.OPEN.FLAG$ = "N"                                                        ! 1.5BG
9029: 358d:       CLOSE REWKF.SESS.NUM%                                                         ! 1.5BG
9030: 35a1:       SB.ACTION$ = "C"                                                              ! 1.5BG
9031: 35b6:       SB.STRING$ = ""                                                               ! 1.5BG
9032: 35cb:       SB.INTEGER% = REWKF.SESS.NUM%                                                 ! 1.5BG
9033: 35dd:       GOSUB SB.FILE.UTILS                                                           ! 1.5BG
9034: 35ef:    ENDIF                                                                            ! 1.5BG
9035: 35f7:    SB.ACTION$ = "O"                                                                 ! 1.5BG
9036: 360c:    SB.INTEGER% = REWKF.REPORT.NUM%                                                  ! 1.5BG
9037: 361e:    SB.STRING$ = REWKF.FILE.NAME$                                                    ! 1.5BG
9038: 363a:    GOSUB SB.FILE.UTILS                                                              ! 1.5BG
9039: 364c:    REWKF.SESS.NUM% = SB.FILE.SESS.NUM%                                              ! 1.5BG
9040: 365f:    CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                                          ! 1.9SH
9041: 3675:    IF END #REWKF.SESS.NUM% THEN CREATE.ERROR                                        ! 1.5BG
9042: 3691:    CREATE POSFILE REWKF.FILE.NAME$ AS REWKF.SESS.NUM%               \               ! 1.5BG
9043: 36b8:           BUFFSIZE 512 LOCKED MIRRORED ATCLOSE                                      ! 1.5BG
9044: 36b8:    REWKF.OPEN.FLAG$ = "Y"                                                           ! 1.5BG
9045: 36cf:    
9046: 36cf:    !Open Recalls file and then read recall record for passed recall number          ! 1.5BG
9047: 36cf:    IF END #RECALLS.SESS.NUM% THEN OPEN.ERROR                                        ! 1.5BG
9048: 36eb:    CURRENT.REPORT.NUM% = RECALLS.REPORT.NUM%                                        ! 1.9SH
9049: 3701:    OPEN RECALLS.FILE.NAME$ KEYED RECL RECALLS.RECL% \                               ! 1.5BG
9050: 372e:         AS RECALLS.SESS.NUM% NOWRITE NODEL                                          ! 1.5BG
9051: 372e:    RECALLS.OPEN.FLAG$ = "Y"                                                         ! 1.5BG
9052: 3745:    RECALLS.CHAIN% = 0                                                               ! 1.5BG
9053: 3755:    IF END #RECALLS.SESS.NUM% THEN READ.ERROR                                        ! 1.5BG
9054: 3771:    FILE.RETURN.CODE% = READ.RECALLS                                                 ! 1.5BG
9055: 378e:    IF FILE.RETURN.CODE% NE 0 THEN BEGIN                                             ! 1.5BG
9056: 37ac:    
9057: 37ac:       !Recall record not found - write header and trailer                           ! 1.5BG
9058: 37ac:       CSR.AUDIT.DATA$ = "RECALLS Recall reference " + RECALLS.REFERENCE$ \          ! 1.5BG
9059: 37d5:                         + " not found"                                              ! 1.5BG
9060: 37d5:       GOSUB LOG.TO.AUDIT.FILE                                                       ! 1.5BG
9061: 37e7:       REWKF.REC.TYPE$ = "YH"                                                        ! 1.5BG
9062: 37fe:       REWKF.REFERENCE$ = "00000000"                                                 ! 1.5BG
9063: 3815:       REWKF.LABEL$ = ""                                                             ! 1.5BG
9064: 382c:       REWKF.BATCH.TYPE$ = " "                                                       ! 1.6BG
9065: 3843:       REWKF.MRQ$ = "  "                                                             ! 1.7BG
9066: 385a:       REWKF.DUE.BY.DATE$ = "        "                                               ! 1.6BG
9067: 3871:       FILE.RETURN.CODE% = WRITE.REWKF                                               ! 1.5BG
9068: 388a:       IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                               ! 1.5BG
9069: 38a8:       REWKF.REC.TYPE$ = "YT"                                                        ! 1.5BG
9070: 38bf:       REWKF.ITEM.COUNT$ = ""                                                        ! 1.5BG
9071: 38d6:       FILE.RETURN.CODE% = WRITE.REWKF                                               ! 1.5BG
9072: 38ef:       IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                               ! 1.5BG
9073: 3910:       
9074: 3910:    ENDIF ELSE BEGIN                                                                 ! 1.5BG
9075: 3918:    
9076: 3918:       IF RECALLS.STATUS$ = "A" THEN BEGIN                                           ! 1.5BG
9077: 3939:       
9078: 3939:          !Recall is actioned - write header and trailer                             ! 1.5BG
9079: 3939:          CSR.AUDIT.DATA$ = "RECALLS Recall reference " + RECALLS.REFERENCE$ \       ! 1.5BG
9080: 3962:                            + " actioned - no records to create"                     ! 1.5BG
9081: 3962:          GOSUB LOG.TO.AUDIT.FILE                                                    ! 1.5BG
9082: 3974:          REWKF.REC.TYPE$ = "YH"                                                     ! 1.5BG
9083: 398b:          REWKF.REFERENCE$ = "        "                                              ! 1.5BG
9084: 39a2:          REWKF.LABEL$ = ""                                                          ! 1.5BG
9085: 39b9:          REWKF.BATCH.TYPE$ = " "                                                    ! 1.6BG
9086: 39d0:          REWKF.MRQ$ = "  "                                                          ! 1.7BG
9087: 39e7:          REWKF.DUE.BY.DATE$ = "        "                                            ! 1.6BG
9088: 39fe:          FILE.RETURN.CODE% = WRITE.REWKF                                            ! 1.5BG
9089: 3a17:          IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                            ! 1.5BG
9090: 3a35:          REWKF.REC.TYPE$ = "YT"                                                     ! 1.5BG
9091: 3a4c:          REWKF.ITEM.COUNT$ = ""                                                     ! 1.5BG
9092: 3a63:          FILE.RETURN.CODE% = WRITE.REWKF                                            ! 1.5BG
9093: 3a7c:          IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                            ! 1.5BG
9094: 3a9d:          
9095: 3a9d:       ENDIF ELSE BEGIN
9096: 3aa5:       
9097: 3aa5:          IF (RECALLS.TYPE$ = "I" OR RECALLS.TYPE$ = "C") AND \                      ! 1.6BG
9098: 3b41:             DATE.GT(RIGHT$(DATE$,6), RIGHT$(RECALLS.DUE.BY.DATE$,6)) THEN BEGIN     ! 1.6BG ! 1.8CS
9099: 3b41:             
9100: 3b41:             !Recall is expired for recall types I or C                              ! 1.6BG
9101: 3b41:             CSR.AUDIT.DATA$ = "RECALLS Recall reference " + RECALLS.REFERENCE$ \    ! 1.6BG
9102: 3b6a:                               + " expired - no records to create"                   ! 1.6BG
9103: 3b6a:             GOSUB LOG.TO.AUDIT.FILE                                                 ! 1.6BG
9104: 3b7c:             REWKF.REC.TYPE$ = "YH"                                                  ! 1.6BG
9105: 3b93:             REWKF.REFERENCE$ = "XXXXXXXX"                                           ! 1.6BG
9106: 3baa:             REWKF.LABEL$ = ""                                                       ! 1.6BG
9107: 3bc1:             REWKF.BATCH.TYPE$ = " "                                                 ! 1.6BG
9108: 3bd8:             REWKF.MRQ$ = "  "                                                       ! 1.7BG
9109: 3bef:             REWKF.DUE.BY.DATE$ = "        "                                         ! 1.6BG
9110: 3c06:             FILE.RETURN.CODE% = WRITE.REWKF                                         ! 1.6BG
9111: 3c1f:             IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                         ! 1.6BG
9112: 3c3d:             REWKF.REC.TYPE$ = "YT"                                                  ! 1.6BG
9113: 3c54:             REWKF.ITEM.COUNT$ = ""                                                  ! 1.6BG
9114: 3c6b:             FILE.RETURN.CODE% = WRITE.REWKF                                         ! 1.6BG
9115: 3c84:             IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                         ! 1.6BG
9116: 3ca5:          
9117: 3ca5:          ENDIF ELSE BEGIN                                                           ! 1.5BG
9118: 3cad:    
9119: 3cad:             !Calculate the number of chains for this recall.                        ! 1.5BG
9120: 3cad:             RECALL.RECS% = INT%((VAL(RECALLS.ITEM.COUNT$)-1) / 50) + 1              ! 1.5BG
9121: 3d17:             !Calculate the number of items in the last record                       ! 1.5BG
9122: 3d17:             LAST.RECALL.REC% = (VAL(RECALLS.ITEM.COUNT$) - \                        ! 1.5BG
9123: 3d70:                                ((RECALL.RECS%-1) * 50))                             ! 1.5BG
9124: 3d70:          
9125: 3d70:             REWKF.ITEM.COUNT% = 0                                                   ! 1.5BG
9126: 3d7e:             !Have to start from zero to perform WHILE loop at least once            ! 1.5BG
9127: 3d7e:             CURRENT.RECALL.REC% = 0                                                 ! 1.5BG
9128: 3d8c:             WHILE CURRENT.RECALL.REC% <> RECALL.RECS% AND \                         ! 1.5BG
9129: 3d97:                   REWKF.ITEM.COUNT% < MAX.RECALLS.ITEMS%                            ! 1.5BG
9130: 3d97:          
9131: 3d97:                IF (CURRENT.RECALL.REC%) + 1 = RECALL.RECS% THEN BEGIN               ! 1.5BG
9132: 3db0:                   ITEMS.THIS.RECORD% = LAST.RECALL.REC%                             ! 1.5BG
9133: 3dc4:                ENDIF ELSE BEGIN                                                     ! 1.5BG
9134: 3dcc:                   ITEMS.THIS.RECORD% = 50                                           ! 1.5BG
9135: 3dda:                ENDIF                                                                ! 1.5BG
9136: 3de2:                ITEM.IN.PROGRESS% = 0                                                ! 1.5BG
9137: 3df0:          
9138: 3df0:                WHILE ITEM.IN.PROGRESS% < ITEMS.THIS.RECORD% AND \                   ! 1.5BG
9139: 3dfb:                      REWKF.ITEM.COUNT% < MAX.RECALLS.ITEMS%                         ! 1.5BG
9140: 3dfb:                   ! The field RECALLS.ITEM.STOCK$ contains packed F's if the item   ! 1.5BG
9141: 3dfb:                   ! has not been counted and this unpackes to ?'s so test for a ?.  ! 1.5BG
9142: 3dfb:                   ! However, if the recall type is an I or C, extract anyway.               ! 1.6BG
9143: 3dfb:                   IF LEFT$(UNPACK$(RECALLS.ITEM.STOCK$(ITEM.IN.PROGRESS%)),1) = "?" \ 1.5BG ! 1.6BG
9144: 3ead:                      OR (RECALLS.TYPE$ = "I" OR RECALLS.TYPE$ = "C") THEN BEGIN     ! 1.5BG ! 1.6BG
9145: 3ead:                      !If this is the first valid record, write the header out       ! 1.5BG
9146: 3ead:                      IF REWKF.ITEM.COUNT% = 0 THEN BEGIN                            ! 1.5BG
9147: 3ebf:                         CSR.AUDIT.DATA$ = "RECALLS Creating records for Recall " + \! 1.5BG
9148: 3ee4:                                           RECALLS.REFERENCE$                        ! 1.5BG
9149: 3ee4:                         GOSUB LOG.TO.AUDIT.FILE                                     ! 1.5BG
9150: 3ef6:                         REWKF.REC.TYPE$ = "YH"                                      ! 1.5BG
9151: 3f0d:                         REWKF.REFERENCE$ = RECALLS.REFERENCE$                       ! 1.5BG
9152: 3f2b:                         REWKF.LABEL$ = RECALLS.LABEL.TYPE$ + "000000"               ! 1.5BG
9153: 3f50:                         REWKF.BATCH.TYPE$ = RECALLS.TYPE$                           ! 1.6BG
9154: 3f6e:                         IF (RECALLS.TYPE$ = "I" OR RECALLS.TYPE$ = "C") THEN BEGIN  ! 1.7BG
9155: 3fc3:                            !Ensure ASCII digits passed in MRQ field and not zero's  ! 1.7BG
9156: 3fc3:                            !for types I and C recalls                               ! 1.7BG
9157: 3fc3:                            IF LEFT$(RECALLS.BATCH.NUM$,1) < "0" OR \                ! 1.7BG
9158: 40f4:                               LEFT$(RECALLS.BATCH.NUM$,1) > "9" OR \                ! 1.7BG
9159: 40f4:                               MID$(RECALLS.BATCH.NUM$,2,1) < "0" OR \               ! 1.7BG
9160: 40f4:                               MID$(RECALLS.BATCH.NUM$,2,1) > "9" OR \               ! 1.7BG
9161: 40f4:                               LEFT$(RECALLS.BATCH.NUM$,2) = "00" THEN BEGIN         ! 1.7BG
9162: 40f4:                               REWKF.MRQ$ = "  "                                     ! 1.7BG
9163: 410d:                            ENDIF ELSE REWKF.MRQ$ = LEFT$(RECALLS.BATCH.NUM$,2)      ! 1.7BG
9164: 4136:                         ENDIF ELSE REWKF.MRQ$ = "  "                                ! 1.7BG
9165: 414d:                         REWKF.DUE.BY.DATE$ = RECALLS.DUE.BY.DATE$                   ! 1.6BG
9166: 416b:                         FILE.RETURN.CODE% = WRITE.REWKF                             ! 1.5BG
9167: 4184:                         IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR             ! 1.5BG
9168: 41a2:                      ENDIF                                                          ! 1.5BG
9169: 41aa:                      REWKF.ITEM.COUNT% = REWKF.ITEM.COUNT% + 1                      ! 1.5BG
9170: 41b6:                   
9171: 41b6:                      REWKF.REC.TYPE$ = "YD"                                         ! 1.5BG
9172: 41cd:                      PACKED.ITEM.CODE$ = RECALLS.ITEM.CODE$(ITEM.IN.PROGRESS%)      ! 1.5BG
9173: 41f7:                      GOSUB GET.REWKF.ITEM.DETAILS                                   ! 1.5BG
9174: 4209:                      FILE.RETURN.CODE% = WRITE.REWKF                                ! 1.5BG
9175: 4222:                      IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                ! 1.5BG
9176: 4240:                   ENDIF                                                             ! 1.5BG
9177: 4248:                   ITEM.IN.PROGRESS% = ITEM.IN.PROGRESS% + 1                         ! 1.5BG
9178: 4254:             
9179: 4254:                WEND                                                                 ! 1.5BG
9180: 427e:             
9181: 427e:                CURRENT.RECALL.REC% = CURRENT.RECALL.REC% + 1                        ! 1.5BG
9182: 428a:                !If this is not the last chain, read the next RECALL record          ! 1.5BG
9183: 428a:                IF CURRENT.RECALL.REC% <> RECALL.RECS% THEN BEGIN                    ! 1.5BG
9184: 42a2:                   RECALLS.CHAIN% = RECALLS.CHAIN% +  1                              ! 1.5BG
9185: 42b1:                   FILE.RETURN.CODE% = READ.RECALLS                                  ! 1.5BG
9186: 42ce:                   IF FILE.RETURN.CODE% NE 0 THEN GOTO READ.ERROR                    ! 1.5BG
9187: 42ec:                ENDIF                                                                ! 1.5BG
9188: 42f4:             
9189: 42f4:             WEND                                                                    ! 1.5BG
9190: 4324:          
9191: 4324:             IF REWKF.ITEM.COUNT% = 0 THEN BEGIN                                     ! 1.5BG
9192: 4336:                !No un-actioned items were found even though the RECALL  is not A    ! 1.5BG
9193: 4336:                CSR.AUDIT.DATA$ = "RECALLS Recall reference " + RECALLS.REFERENCE$ \ ! 1.5BG
9194: 435f:                               + " - no records to create"                           ! 1.5BG
9195: 435f:                GOSUB LOG.TO.AUDIT.FILE                                              ! 1.5BG
9196: 4371:                REWKF.REC.TYPE$ = "YH"                                               ! 1.5BG
9197: 4388:                REWKF.REFERENCE$ = "        "                                        ! 1.5BG
9198: 439f:                REWKF.LABEL$ = ""                                                    ! 1.5BG
9199: 43b6:                REWKF.BATCH.TYPE$ = " "                                              ! 1.6BG
9200: 43cd:                REWKF.MRQ$ = "  "                                                    ! 1.7BG
9201: 43e4:                REWKF.DUE.BY.DATE$ = "        "                                      ! 1.6BG
9202: 43fb:                FILE.RETURN.CODE% = WRITE.REWKF                                      ! 1.5BG
9203: 4414:                IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                      ! 1.5BG
9204: 4432:                REWKF.REC.TYPE$ = "YT"                                               ! 1.5BG
9205: 4449:                REWKF.ITEM.COUNT$ = ""                                               ! 1.5BG
9206: 4460:                FILE.RETURN.CODE% = WRITE.REWKF                                      ! 1.5BG
9207: 4479:                IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                      ! 1.5BG
9208: 449a:             ENDIF ELSE BEGIN                                                        ! 1.5BG
9209: 44a2:                !Write valid trailer for items sent                                  ! 1.5BG
9210: 44a2:                REWKF.REC.TYPE$ = "YT"                                               ! 1.5BG
9211: 44b9:                REWKF.ITEM.COUNT$ = STR$(REWKF.ITEM.COUNT%)                          ! 1.5BG
9212: 44d7:                CSR.AUDIT.DATA$ = "RECALLS - " + REWKF.ITEM.COUNT$ + \               ! 1.5BG
9213: 450b:                                  " record(s) created for Recall " + RECALLS.REFERENCE$ ! 1.5BG
9214: 450b:                         GOSUB LOG.TO.AUDIT.FILE                                     ! 1.5BG
9215: 451d:                FILE.RETURN.CODE% = WRITE.REWKF                                      ! 1.5BG
9216: 4536:                IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                      ! 1.5BG
9217: 4554:             ENDIF                                                                   ! 1.5BG
9218: 455c:          ENDIF                                                                      ! 1.6BG
9219: 4564:       ENDIF                                                                         ! 1.5BG
9220: 456c:    ENDIF                                                                            ! 1.5BG
9221: 4574:    
9222: 4574:    CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                                          ! 1.9SH
9223: 458a:    IF REWKF.OPEN.FLAG$ = "Y" THEN BEGIN                                             ! 1.5BG
9224: 45a8:       CLOSE REWKF.SESS.NUM%                                                         ! 1.5BG
9225: 45bc:       REWKF.OPEN.FLAG$ = "N"                                                        ! 1.5BG
9226: 45d3:    ENDIF                                                                            ! 1.5BG
9227: 45db:    !De-allocate REWKF session number                                                ! 1.5BG
9228: 45db:    SB.ACTION$ = "C"                                                                 ! 1.5BG
9229: 45f0:    SB.STRING$ = ""                                                                  ! 1.5BG
9230: 4605:    SB.INTEGER% = REWKF.SESS.NUM%                                                    ! 1.5BG
9231: 4617:    GOSUB SB.FILE.UTILS                                                              ! 1.5BG
9232: 4629:       
9233: 4629:    IF IDF.OPEN.FLAG$="Y" THEN BEGIN                                                 ! 1.5BG
9234: 4647:       CLOSE IDF.SESS.NUM%                                                           ! 1.5BG
9235: 465b:       IDF.OPEN.FLAG$="N"                                                            ! 1.5BG
9236: 4672:    ENDIF                                                                            ! 1.5BG
9237: 467a:       
9238: 467a:    IF IMSTC.OPEN.FLAG$="Y" THEN BEGIN                                               ! 1.5BG
9239: 4698:       CLOSE IMSTC.SESS.NUM%                                                         ! 1.5BG
9240: 46ac:       IMSTC.OPEN.FLAG$="N"                                                          ! 1.5BG
9241: 46c3:    ENDIF                                                                            ! 1.5BG
9242: 46cb:       
9243: 46cb:    IF STOCK.OPEN.FLAG$="Y" THEN BEGIN                                               ! 1.5BG
9244: 46e6:       CLOSE STOCK.SESS.NUM%                                                         ! 1.5BG
9245: 46fa:       STOCK.OPEN.FLAG$="N"                                                          ! 1.5BG
9246: 470f:    ENDIF                                                                            ! 1.5BG
9247: 4717:       
9248: 4717:    !Release PDT                                                                     ! 1.5BG
9249: 4717:    PIPE.OUT$ = "HN"                                                                 ! 1.5BG
9250: 472e:    GOSUB SEND.TO.PSS38                                                              ! 1.5BG
9251: 4740:    HOLD.FLAG$ = "N"                                                                 ! 1.5BG
9252: 4757:    
9253: 4757:    !Get PSS38 to send REWKF                                                         ! 1.5BG
9254: 4757:    PIPE.OUT$ = "A"                                                                  ! 1.5BG
9255: 476e:    GOSUB SEND.TO.PSS38                                                              ! 1.5BG
9256: 4780: 
9257: 4780: RETURN                                                                              ! 1.5BG
9258: 4790: 
9259: 4790: 
9260: 4790: \*****************************************************************************
9261: 4790: \***
9262: 4790: \*** GET.REWKF.ITEM.DETAILS
9263: 4790: \***
9264: 4790: \*****************************************************************************
9265: 4790: 
9266: 4790: GET.REWKF.ITEM.DETAILS:                                                             ! 1.5BG
9267: 47a0: 
9268: 47a0:    !Calculate check digit to give 7 digit Boots code                                ! 1.5BG
9269: 47a0:    RC% = CALC.BOOTS.CODE.CHECK.DIGIT(UNPACK$(PACKED.ITEM.CODE$))                    ! 1.5BG
9270: 47c7:    IF RC% <> 0 THEN F18.CHECK.DIGIT$ = ""                                           ! 1.5BG
9271: 47e8:    REWKF.ITEM.CODE$ = UNPACK$(PACKED.ITEM.CODE$) + F18.CHECK.DIGIT$                 ! 1.5BG
9272: 4821:    
9273: 4821:    !Now read the IDF                                                                ! 1.5BG
9274: 4821:    IDF.BOOTS.CODE$ = PACK$("0" + REWKF.ITEM.CODE$)                                  ! 1.5BG
9275: 4850:    FILE.RETURN.CODE% = READ.IDF                                                     ! 1.5BG
9276: 4869:    IF FILE.RETURN.CODE% NE 0 THEN BEGIN                                             ! 1.5BG
9277: 4884:       REWKF.BARCODE$ = "0000000000000"                                              ! 1.5BG
9278: 489b:       REWKF.DESCRIPTION$ = "* ITEM NOT ON FILE *"                                   ! 1.5BG
9279: 48b2:       REWKF.TSF$ = "0000"                                                           ! 1.5BG
9280: 48cc:    ENDIF ELSE BEGIN                                                                 ! 1.5BG
9281: 48d4:       REWKF.DESCRIPTION$ = LEFT$(IDF.STNDRD.DESC$,20)                               ! 1.5BG
9282: 48fb:       IF IDF.BIT.FLAGS.2% AND 10000000b THEN BEGIN                                  ! 1.5BG
9283: 490e:          !Boots item so pass Boots barcode                                          ! 1.5BG
9284: 490e:          REWKF.BARCODE$ = PACK$("000000") + PACKED.ITEM.CODE$                       ! 1.5BG
9285: 4943:       ENDIF ELSE BEGIN                                                              ! 1.5BG
9286: 494b:          IF IDF.FIRST.BAR.CODE$ <> PACK$("000000") + PACKED.ITEM.CODE$ AND \        ! 1.5BG
9287: 49c5:             IDF.FIRST.BAR.CODE$ <> PACK$("000000000000") THEN BEGIN                 ! 1.5BG
9288: 49c5:             REWKF.BARCODE$ = IDF.FIRST.BAR.CODE$                                    ! 1.5BG
9289: 49e6:          ENDIF ELSE BEGIN                                                           ! 1.5BG
9290: 49ee:             IF IDF.SECOND.BAR.CODE$ <> PACK$("000000000000") THEN BEGIN             ! 1.5BG
9291: 4a14:                REWKF.BARCODE$ = IDF.SECOND.BAR.CODE$                                ! 1.5BG
9292: 4a34:             ENDIF ELSE BEGIN                                                        ! 1.5BG
9293: 4a3c:                REWKF.BARCODE$ = PACK$("000000") + PACKED.ITEM.CODE$                 ! 1.5BG
9294: 4a6e:             ENDIF                                                                   ! 1.5BG
9295: 4a76:          ENDIF                                                                      ! 1.5BG
9296: 4a7e:       ENDIF                                                                         ! 1.5BG
9297: 4a86:       !Now add check digit to barcode                                               ! 1.5BG
9298: 4a86:       REWKF.BARCODE$ = UNPACK$(REWKF.BARCODE$)                                      ! 1.5BG
9299: 4aa9:       RC% = CALC.BAR.CODE.CHECK.DIGIT(REWKF.BARCODE$)                               ! 1.5BG
9300: 4acb:       IF RC% <> 0 THEN F06.CHECK.DIGIT$ = ""                                        ! 1.5BG
9301: 4aec:       REWKF.BARCODE$ = REWKF.BARCODE$ + F06.CHECK.DIGIT$                            ! 1.5BG
9302: 4b18:    ENDIF                                                                            ! 1.5BG
9303: 4b20:    
9304: 4b20:    !Now get TSF only when the Recall type is not F, S, or X                         ! 1.5BG
9305: 4b20:    IF RECALLS.TYPE$ = "F" OR RECALLS.TYPE$ = "S" OR RECALLS.TYPE$ = "X" THEN BEGIN  ! 1.5BG
9306: 4b9a:       REWKF.TSF$ = "    "                                                           ! 1.5BG
9307: 4bb4:    ENDIF ELSE BEGIN                                                                 ! 1.5BG
9308: 4bbc:       !Check for IMSTC record for most recent TSF                                   ! 1.5BG
9309: 4bbc:       IMSTC.BAR.CODE$ = PACK$(STRING$(16, "0")) + PACKED.ITEM.CODE$                 ! 1.5BG
9310: 4c00:       FILE.RETURN.CODE% = READ.IMSTC                                                ! 1.5BG
9311: 4c19:       IF FILE.RETURN.CODE% = 0 THEN BEGIN                                           ! 1.5BG
9312: 4c34:          !NOTE: REWKF.TSF$ truncated to 4 digits for PDT.                           ! 1.5BG
9313: 4c34:          !NOTE: Negative TSF's forced to zero - shoudl never happen though!         ! 1.5BG
9314: 4c34:          IF IMSTC.STOCK.FIGURE% < 0 THEN IMSTC.STOCK.FIGURE% = 0                    ! 1.5BG
9315: 4c4f:          REWKF.TSF$ = RIGHT$("0000" + STR$(IMSTC.STOCK.FIGURE%), 4)                 ! 1.5BG
9316: 4c9c:       ENDIF ELSE BEGIN                                                              ! 1.5BG
9317: 4ca4:          !No IMSTC record so get off STOCK file                                     ! 1.5BG
9318: 4ca4:          STOCK.BOOTS.CODE$ = PACK$("0" + REWKF.ITEM.CODE$)                          ! 1.5BG
9319: 4cd3:          FILE.RETURN.CODE% = READ.STOCK                                             ! 1.5BG
9320: 4cec:          IF FILE.RETURN.CODE% = 0 THEN BEGIN                                        ! 1.5BG
9321: 4d07:             IF STOCK.STOCK.FIG% < 0 THEN STOCK.STOCK.FIG% = 0                       ! 1.5BG
9322: 4d22:             REWKF.TSF$ = RIGHT$("0000" + STR$(STOCK.STOCK.FIG%), 4)                 ! 1.5BG
9323: 4d6e:          ENDIF ELSE BEGIN                                                           ! 1.5BG
9324: 4d76:             REWKF.TSF$ = "0000"                                                     ! 1.5BG
9325: 4d8d:          ENDIF                                                                      ! 1.5BG
9326: 4d95:       ENDIF                                                                         ! 1.5BG
9327: 4d9d:    ENDIF                                                                            ! 1.5BG
9328: 4da5: 
9329: 4da5: RETURN                                                                              ! 1.5BG
9330: 4db5: 
9331: 4db5: 
9332: 4db5: \*****************************************************************************
9333: 4db5: \***
9334: 4db5: \*** RECEIVED.RECALLS.RECEIVED.OK
9335: 4db5: \***
9336: 4db5: \*****************************************************************************
9337: 4db5: 
9338: 4db5: RECEIVED.RECALLS.RECEIVED.OK:                                                       ! 1.5BG
9339: 4dc5: 
9340: 4dc5:    SB.MESSAGE$ = "PDT Support - RECALLS file received OK"                           ! 1.5BG
9341: 4dda:    GOSUB SB.BG.MESSAGE                                                              ! 1.5BG
9342: 4dec:    
9343: 4dec:    IF FN.VALIDATE.DATA(DATA.IN$,56) = 0 THEN BEGIN                                  ! 1.5BG
9344: 4e0e:      RECEIVE.STATE$ = "*"                                                           ! 1.5BG
9345: 4e25:      RETURN                                                                         ! 1.5BG
9346: 4e35:    ENDIF                                                                            ! 1.5BG
9347: 4e3d:    
9348: 4e3d:    CSR.AUDIT.DATA$ = "RECALLS File Received to PDT OK for Recall " + \              ! 1.5BG
9349: 4e62:                      RECALLS.REFERENCE$                                             ! 1.5BG
9350: 4e62:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG                  
9351: 4e74:    
9352: 4e74:    TEMP.TIME$ = TIME$                                                               ! 1.5BG
9353: 4e8c:    CSR.AUDIT.DATA$ = "RECALLS REQUEST session complete at " +        \              ! 1.5BG
9354: 4efe:                       LEFT$(TEMP.TIME$,2) + ":" +                    \              ! 1.5BG
9355: 4efe:                       MID$(TEMP.TIME$,3,2) + ":" +                   \              ! 1.5BG
9356: 4efe:                       RIGHT$(TEMP.TIME$,2)                                          ! 1.5BG
9357: 4efe:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG
9358: 4f10:    
9359: 4f10: RETURN                                                                              ! 1.5BG
9360: 4f20: 
9361: 4f20: 
9362: 4f20: \*****************************************************************************
9363: 4f20: \***
9364: 4f20: \*** RECEIVED.RECALLS.HEADER 
9365: 4f20: \***
9366: 4f20: \*****************************************************************************
9367: 4f20: 
9368: 4f20: RECEIVED.RECALLS.HEADER:                                                            ! 1.5BG
9369: 4f30: 
9370: 4f30:    SB.MESSAGE$ = "PDT Support - RECALLS file header received"                       ! 1.5BG
9371: 4f45:    GOSUB SB.BG.MESSAGE                                                              ! 1.5BG
9372: 4f57: 
9373: 4f57:    IF FN.VALIDATE.DATA(DATA.IN$,57) = 0 THEN BEGIN                                  ! 1.5BG
9374: 4f79:      RECEIVE.STATE$ = "*"                                                           ! 1.5BG
9375: 4f90:      RETURN                                                                         ! 1.5BG
9376: 4fa0:    ENDIF                                                                            ! 1.5BG
9377: 4fa8:    
9378: 4fa8:    CSR.AUDIT.DATA$ = "RECALLS File Header for Recall " + MID$(DATA.IN$,3,8) + \     ! 1.5BG
9379: 4ff9:                      " Label " + MID$(DATA.IN$,11,14)                               ! 1.5BG
9380: 4ff9:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG                  
9381: 500b:    
9382: 500b:    IF MID$(DATA.IN$,25,1) = "Y" THEN BEGIN !First Header Record                     ! 1.5BG
9383: 5043:       !Create RECALLBF locked                                                       ! 1.5BG
9384: 5043:       IF RB.OPEN.FLAG$ = "Y" THEN BEGIN                                             ! 1.5BG
9385: 5061:          CLOSE RB.SESS.NUM%                                                         ! 1.5BG
9386: 5075:          RB.OPEN.FLAG$ = "N"                                                        ! 1.5BG
9387: 508c:       ENDIF                                                                         ! 1.5BG
9388: 5094:       !Deallocate session number                                                    ! 1.5BG
9389: 5094:       SB.ACTION$ = "C"                                                              ! 1.5BG
9390: 50a9:       SB.STRING$ = ""                                                               ! 1.5BG
9391: 50be:       SB.INTEGER% = RB.SESS.NUM%                                                    ! 1.5BG
9392: 50d0:       GOSUB SB.FILE.UTILS                                                           ! 1.5BG
9393: 50e2:       SB.ACTION$ = "O"                                                              ! 1.5BG
9394: 50f7:       SB.INTEGER% = RB.REPORT.NUM%                                                  ! 1.5BG
9395: 5109:       RB.FILE.NAME$ = "RB:" + TIME$                                                 ! 1.5BG
9396: 5128:       SB.STRING$ = RB.FILE.NAME$                                                    ! 1.5BG
9397: 5144:       GOSUB SB.FILE.UTILS                                                           ! 1.5BG
9398: 5156:       RB.SESS.NUM% = SB.FILE.SESS.NUM%                                              ! 1.5BG
9399: 5169:       CURRENT.REPORT.NUM% = RB.REPORT.NUM%                                          ! 1.9SH
9400: 517f:       IF END #RB.SESS.NUM% THEN CREATE.ERROR                                        ! 1.5BG
9401: 519b:       CREATE POSFILE RB.FILE.NAME$ AS RB.SESS.NUM%               \                  ! 1.5BG
9402: 51c2:              BUFFSIZE 512 LOCKED MIRRORED ATCLOSE                                   ! 1.5BG
9403: 51c2:       RB.OPEN.FLAG$ = "Y"                                                           ! 1.5BG
9404: 51d9:    ENDIF                                                                            ! 1.5BG
9405: 51e1:    
9406: 51e1:    RB.REC.TYPE$= "H"                                                                ! 1.5BG
9407: 51f8:    RB.REFERENCE$ = MID$(DATA.IN$,3,8)                                               ! 1.5BG
9408: 521f:    RB.LABEL$ = MID$(DATA.IN$,11,14)                                                 ! 1.5BG
9409: 5246:    FILE.RETURN.CODE% = WRITE.RB                                                     ! 1.5BG
9410: 525f:    IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                                  ! 1.5BG
9411: 527d:    RECALLS.RECORD.COUNT% = 1                                                        ! 1.5BG
9412: 528b: 
9413: 528b: RETURN                                                                              ! 1.5BG
9414: 529b: 
9415: 529b: 
9416: 529b: \*****************************************************************************
9417: 529b: \***
9418: 529b: \*** RECEIVED.RECALLS.DETAIL
9419: 529b: \***
9420: 529b: \*****************************************************************************
9421: 529b: 
9422: 529b: RECEIVED.RECALLS.DETAIL:                                                            ! 1.5BG
9423: 52ab: 
9424: 52ab:    IF FN.VALIDATE.DATA(DATA.IN$,58) = 0 THEN BEGIN                                  ! 1.5BG
9425: 52cd:      RECEIVE.STATE$ = "*"                                                           ! 1.5BG
9426: 52e4:      RETURN                                                                         ! 1.5BG
9427: 52f4:    ENDIF                                                                            ! 1.5BG
9428: 52fc:    
9429: 52fc:    CSR.AUDIT.DATA$ = "RECALLS File Detail Item " + MID$(DATA.IN$,3,7)               ! 1.5BG
9430: 532a:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG
9431: 533c:    
9432: 533c:    RB.REC.TYPE$= "D"                                                                ! 1.5BG
9433: 5353:    RB.ITEM.CODE$ = MID$(DATA.IN$,3,7)                                               ! 1.5BG
9434: 537a:    RB.STOCK.COUNT$ = MID$(DATA.IN$,10,4)                                            ! 1.5BG
9435: 53a1:    FILE.RETURN.CODE% = WRITE.RB                                                     ! 1.5BG
9436: 53ba:    IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                                  ! 1.5BG
9437: 53d8:    RECALLS.RECORD.COUNT% = RECALLS.RECORD.COUNT% + 1                                ! 1.5BG
9438: 53e4:    
9439: 53e4: RETURN                                                                              ! 1.5BG
9440: 53f4: 
9441: 53f4: 
9442: 53f4: \*****************************************************************************
9443: 53f4: \***
9444: 53f4: \*** RECEIVED.RECALLS.TRAILER
9445: 53f4: \***
9446: 53f4: \*****************************************************************************
9447: 53f4: 
9448: 53f4: RECEIVED.RECALLS.TRAILER:                                                           ! 1.5BG
9449: 5404: 
9450: 5404:    SB.MESSAGE$ = "PDT Support - RECALLS file trailer received"                      ! 1.5BG
9451: 5419:    GOSUB SB.BG.MESSAGE                                                              ! 1.5BG
9452: 542b: 
9453: 542b:    IF FN.VALIDATE.DATA(DATA.IN$,59) = 0 THEN BEGIN                                  ! 1.5BG
9454: 544d:      RECEIVE.STATE$ = "*"                                                           ! 1.5BG
9455: 5464:      RETURN                                                                         ! 1.5BG
9456: 5474:    ENDIF                                                                            ! 1.5BG
9457: 547c:    
9458: 547c:    CSR.AUDIT.DATA$ = "RECALLS File Trailer "                                        ! 1.5BG
9459: 5493:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG
9460: 54a5:    
9461: 54a5:    RB.REC.TYPE$= "T"                                                                ! 1.5BG
9462: 54bc:    RB.ITEM.COUNT$ = MID$(DATA.IN$,3,5)                                              ! 1.5BG
9463: 54e3:    RB.RECORD.COUNT$ = MID$(DATA.IN$,8,4)                                            ! 1.5BG
9464: 550a:    FILE.RETURN.CODE% = WRITE.RB                                                     ! 1.5BG
9465: 5523:    IF FILE.RETURN.CODE% NE 0 THEN GOTO WRITE.ERROR                                  ! 1.5BG
9466: 5541:    
9467: 5541:    RECALLS.RECORD.COUNT% = RECALLS.RECORD.COUNT% + 1                                ! 1.5BG
9468: 554d:    
9469: 554d:    !Send an acknowledgement to the PDT                                              ! 1.5BG
9470: 554d:    !Needs to be in the following format to work with the PDT                        ! 1.5BG
9471: 554d:    PIPE.OUT$ = "L" + "YT00000" + CHR$(0Dh) + CHR$(0Ah)                              ! 1.5BG
9472: 5584:    IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR                                         ! 1.5BG
9473: 55a2:    CURRENT.REPORT.NUM% = PIPEI.REPORT.NUM%                                          ! 1.9SH
9474: 55b9:    WRITE #PIPEI.SESS.NUM%; PIPE.OUT$                                                ! 1.5BG
9475: 55e1:    
9476: 55e1:    IF RECALLS.RECORD.COUNT% <> VAL(MID$(DATA.IN$,8,4)) THEN BEGIN                   ! 1.5BG
9477: 562c:       CSR.AUDIT.DATA$ = "RECALLS File Trailer RECORD COUNT MISMATCH!"               ! 1.5BG
9478: 5643:       GOSUB LOG.TO.AUDIT.FILE                                                       ! 1.5BG
9479: 5655:       CSR.AUDIT.DATA$ = "RECALLS File Trailer - Expected " + \                      ! 1.5BG
9480: 56ac:                         MID$(DATA.IN$,8,4) + " records but got " + \                ! 1.5BG
9481: 56ac:                         STR$(RECALLS.RECORD.COUNT%) + " records"                    ! 1.5BG
9482: 56ac:       GOSUB LOG.TO.AUDIT.FILE                                                       ! 1.5BG
9483: 56be:    ENDIF                                                                            ! 1.5BG
9484: 56c6:    
9485: 56c6: RETURN                                                                              ! 1.5BG
9486: 56d6: 
9487: 56d6: 
9488: 56d6: \*****************************************************************************
9489: 56d6: \***
9490: 56d6: \*** RECEIVED.RECALLS.EOT    
9491: 56d6: \***
9492: 56d6: \*****************************************************************************
9493: 56d6: 
9494: 56d6: RECEIVED.RECALLS.EOT:                                                               ! 1.5BG
9495: 56e6: 
9496: 56e6:    SB.MESSAGE$ = "PDT Support - RECALLS EOT received"                               ! 1.5BG
9497: 56fb:    GOSUB SB.BG.MESSAGE                                                              ! 1.5BG
9498: 570d:                                                                           
9499: 570d:    IF FN.VALIDATE.DATA(DATA.IN$,60) = 0 THEN BEGIN                                  ! 1.5BG
9500: 572f:      RECEIVE.STATE$ = "*"                                                           ! 1.5BG
9501: 5746:      RETURN                                                                         ! 1.5BG
9502: 5756:    ENDIF                                                                            ! 1.5BG
9503: 575e:    
9504: 575e:    CSR.AUDIT.DATA$ = "RECALLS File EOT"                                             ! 1.5BG
9505: 5775:    GOSUB LOG.TO.AUDIT.FILE                                                          ! 1.5BG
9506: 5787:    
9507: 5787:    IF MID$(DATA.IN$,3,1) = "T" THEN BEGIN                                           ! 1.5BG
9508: 57bf:    
9509: 57bf:       !If the EOT is for data in from the PDT, now close the RB: file               ! 1.5BG
9510: 57bf:       !and start PSD72.                                                             ! 1.5BG
9511: 57bf:    
9512: 57bf:       CURRENT.REPORT.NUM% = RB.REPORT.NUM%                                          ! 1.5BG
9513: 57d5:       IF RB.OPEN.FLAG$ = "Y" THEN BEGIN                                             ! 1.5BG
9514: 57f3:          CLOSE RB.SESS.NUM%                                                         ! 1.5BG
9515: 5807:          RB.OPEN.FLAG$ = "N"                                                        ! 1.5BG
9516: 581e:       ENDIF                                                                         ! 1.5BG
9517: 5826:       !De-allocate RB session number                                                ! 1.5BG
9518: 5826:       SB.ACTION$ = "C"                                                              ! 1.5BG
9519: 583b:       SB.STRING$ = ""                                                               ! 1.5BG
9520: 5850:       SB.INTEGER% = RB.SESS.NUM%                                                    ! 1.5BG
9521: 5862:       GOSUB SB.FILE.UTILS                                                           ! 1.5BG
9522: 5874:       
9523: 5874:       ADX.RET.CODE% = ADXSTART("ADX_UPGM:PSD72.286", RB.FILE.NAME$, \               ! 1.5BG
9524: 58a3:                       "PSD72 - Recall Batch Processing")                            ! 1.5BG
9525: 58a3:       
9526: 58a3:       TEMP.TIME$ = TIME$                                                            ! 1.5BG
9527: 58bb:       CSR.AUDIT.DATA$ = "RECALLS session complete at " +                \           ! 1.5BG
9528: 592d:                          LEFT$(TEMP.TIME$,2) + ":" +                    \           ! 1.5BG
9529: 592d:                          MID$(TEMP.TIME$,3,2) + ":" +                   \           ! 1.5BG
9530: 592d:                          RIGHT$(TEMP.TIME$,2)                                       ! 1.5BG
9531: 592d:       GOSUB LOG.TO.AUDIT.FILE                                                       ! 1.5BG
9532: 593f:    
9533: 593f:    ENDIF                                                                            ! 1.5BG
9534: 5947:    
9535: 5947:    IF CSR.AUDIT.OPEN.FLAG$ = "Y" THEN BEGIN                                         ! 1.5BG
9536: 5965:      CLOSE CSR.AUDIT.SESS.NUM%                                                      ! 1.5BG
9537: 5979:      CSR.AUDIT.OPEN.FLAG$ = "N"                                                     ! 1.5BG
9538: 5990:    ENDIF                                                                            ! 1.5BG
9539: 5998: 
9540: 5998:    RE.CHAIN = TRUE                                                                  ! 1.5BG
9541: 59aa:    RECEIVE.STATE$ = "?"                                                             ! 1.5BG
9542: 59c1: 
9543: 59c1: RETURN                                                                              ! 1.5BG
9544: 59d1: 
9545: 59d1: \*****************************************************************************
9546: 59d1: \***
9547: 59d1: \*** RECEIVED.PUOD.SIGN.ON
9548: 59d1: \***
9549: 59d1: \*****************************************************************************
9550: 59d1: 
9551: 59d1: RECEIVED.PUOD.SIGN.ON:                                                           
9552: 59e1: 
9553: 59e1:    SB.MESSAGE$ = "PDT Support - +UOD sign on request received"              !1.9SH                   
9554: 59f6:    GOSUB SB.BG.MESSAGE                                                      !1.9SH     
9555: 5a08:    IF FN.VALIDATE.DATA(DATA.IN$,61) = 0 THEN BEGIN                          !1.9SH     
9556: 5a2a:       RECEIVE.STATE$ = "*"                                                  !1.9SH     
9557: 5a41:       RETURN                                                                !1.9SH     
9558: 5a51:    ENDIF                                                                    !1.9SH     
9559: 5a59: 
9560: 5a59:    !Hold PDT                                                                !1.9SH     
9561: 5a59:    PIPE.OUT$ = "HY"                                                         !1.9SH     
9562: 5a70:    GOSUB SEND.TO.PSS38                                                      !1.9SH     
9563: 5a82:    HOLD.FLAG$ = "Y"                                                         !1.9SH     
9564: 5a99: 
9565: 5a99:    !Hijack the REWKF file                                                   !1.9SH
9566: 5a99:    CLOSE REWKF.SESS.NUM%                                                    !1.9SH       
9567: 5aad:    REWKF.OPEN.FLAG$ = "N"                                                   !1.9SH
9568: 5ac4:    CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                                  !1.9SH              
9569: 5ada:    IF END #REWKF.SESS.NUM% THEN CREATE.ERROR                                !1.9SH       
9570: 5af6:    CREATE POSFILE REWKF.FILE.NAME$ AS REWKF.SESS.NUM% \                     !1.9SH
9571: 5b1d:      BUFFSIZE 32767 LOCKED MIRRORED ATCLOSE                                 !1.9SH
9572: 5b1d:    REWKF.OPEN.FLAG$ = "Y"                                                   !1.9SH       
9573: 5b34:    
9574: 5b34:    !Default bad response                                                    !1.9SH
9575: 5b34:    PIPE.OUT$ = "TBNN000"                                                    !1.9SH
9576: 5b4b:    AUTHORISED = FALSE                                                       !1.9SH
9577: 5b59:    
9578: 5b59:    !Open authorisation file                                                 !1.9SH
9579: 5b59:    IF AF.OPEN.FLAG$ = "N" THEN BEGIN                                        !1.9SH
9580: 5b77:        IF END #AF.SESS.NUM% THEN OPEN.ERROR                                 !1.9SH        
9581: 5b93:        CURRENT.REPORT.NUM% = AF.REPORT.NUM%                                 !1.9SH
9582: 5baa:        OPEN AF.FILE.NAME$ KEYED RECL AF.RECL% AS AF.SESS.NUM% NOWRITE NODEL !1.9SH
9583: 5bd7:        AF.OPEN.FLAG$ = "Y"                                                  !1.9SH        
9584: 5bee:    ENDIF                                                                    !1.9SH
9585: 5bf6: 
9586: 5bf6:    !Attempt read on authorisation file                                      !1.9SH
9587: 5bf6:    AF.OPERATOR.NO$ = PACK$(RIGHT$("00000000" + MID$(DATA.IN$, 3, 3), 8))    !1.9SH
9588: 5c4a:    IF READ.AF = 0 THEN BEGIN                                                !1.9SH
9589: 5c5f:       IF AF.PASSWORD$ = PACK$(RIGHT$("00000000" + MID$(DATA.IN$, 6, 3), 8)) THEN BEGIN !1.9SH
9590: 5cc0: 
9591: 5cc0:          !Set authorised flag                                               !1.9SH
9592: 5cc0:          AUTHORISED = TRUE                                                  !1.9SH
9593: 5cce: 
9594: 5cce:          !Get SOFTS options                                                 !1.9SH
9595: 5cce:          GOSUB PROCESS.SOFTS                                                !1.9SH
9596: 5ce0:          IF ONIGHT THEN BEGIN                                               !1.9SH
9597: 5cef:             PIPE.OUT$ = "TBYY"                                              !1.9SH
9598: 5d08:          ENDIF ELSE BEGIN                                                   !1.9SH
9599: 5d10:             PIPE.OUT$ = "TBYN"                                              !1.9SH
9600: 5d27:          ENDIF                                                              !1.9SH
9601: 5d2f:          PIPE.OUT$ = PIPE.OUT$ + BATCH.SIZE$                                !1.9SH
9602: 5d58: 
9603: 5d58:       ENDIF                                                                 !1.9SH
9604: 5d60:    ENDIF                                                                    !1.9SH
9605: 5d68:    
9606: 5d68:    !Close auth file                                                         !1.9SH
9607: 5d68:    CLOSE AF.SESS.NUM%                                                       !1.9SH
9608: 5d7c:    AF.OPEN.FLAG$ = "N"                                                      !1.9SH
9609: 5d93:                                 
9610: 5d93:    !Send auth response and config to the PDT                                !1.9SH
9611: 5d93:    IF END# REWKF.SESS.NUM% THEN WRITE.ERROR                                 !1.9SH
9612: 5daf:    CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                                  !1.9SH
9613: 5dc5:    WRITE #REWKF.SESS.NUM%; PIPE.OUT$                                        !1.9SH
9614: 5deb: 
9615: 5deb:    NUM.RECS% = 1                                                            !1.9SH
9616: 5df9: 
9617: 5df9:    IF AUTHORISED THEN BEGIN                                                 !1.9SH
9618: 5e0b:    
9619: 5e0b:       !Get summary records from the UOD outers                              !1.9SH
9620: 5e0b:       IF UODOT.OPEN.FLAG$ = "N" THEN BEGIN                                  !1.9SH
9621: 5e29:          OPEN UODOT.FILE.NAME$ KEYED RECL UODOT.RECL% AS UODOT.SESS.NUM% NOWRITE NODEL!1.9SH
9622: 5e56:          UODOT.OPEN.FLAG$ = "Y"                                             !1.9SH
9623: 5e6d:       ENDIF                                                                 !1.9SH
9624: 5e75:       UODOT.LICENCE$ = STRING$(5, CHR$(0FFH))                               !1.9SH
9625: 5e97:       UODOT.SEQ% = 0FFFFh                                                   !1.9SH
9626: 5ea8:       IF READ.UODOT THEN BEGIN                                              !1.9SH
9627: 5eb9:          GOSUB READ.ERROR.SUB                                               !1.9SH
9628: 5ece:       ENDIF ELSE BEGIN                                                      !1.9SH
9629: 5ed6:          WHILE LEN(UODOT.SUMMARY.STATUS$)                                   !1.9SH
9630: 5ee1:              PIPE.OUT$ = "TC"                              +                \1.9SH
9631: 5f6f:                          LEFT$(UODOT.SUMMARY.STATUS$, 1)   +                \1.9SH
9632: 5f6f:                          MID$(UODOT.SUMMARY.STATUS$, 2, 1) +                \1.9SH
9633: 5f6f:                          RIGHT$(UNPACK$(MID$(UODOT.SUMMARY.STATUS$,3,3)),5) !1.9SH
9634: 5f6f:              CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                        !1.9SH
9635: 5f85:              WRITE #REWKF.SESS.NUM%; PIPE.OUT$                              !1.9SH
9636: 5fab:              NUM.RECS% = NUM.RECS% + 1                                      !1.9SH
9637: 5fb7:              UODOT.SUMMARY.STATUS$ = MID$(UODOT.SUMMARY.STATUS$, 6, 32767)  !1.9SH
9638: 5fdf:          WEND                                                               !1.9SH
9639: 5fff:       ENDIF                                                                 !1.9SH
9640: 6007:       
9641: 6007:       !Initialise the UOD array                                             !1.9SH
9642: 6007:       DIM UOD$(16000)                                                       !1.9SH
9643: 6031:       NUM.UODS% = 0                                                         !1.9SH
9644: 603f:       
9645: 603f:       !Open DELVINDX                                                        !1.9SH
9646: 603f:       IF END# DELVINDX.SESS.NUM% THEN OPEN.ERROR                            !1.9SH             
9647: 605b:       CURRENT.REPORT.NUM% = DELVINDX.REPORT.NUM%                            !1.9SH                    
9648: 6071:       OPEN DELVINDX.FILE.NAME$ AS DELVINDX.SESS.NUM% BUFFSIZE 2048 NOWRITE NODEL!1.9SH
9649: 609a:       DELVINDX.OPEN.FLAG$ = "Y"                                             !1.9SH             
9650: 60b1:       
9651: 60b1:       !Send DELVINDX recs that have not been booked in to the PDT           !1.9SH
9652: 60b1:       PIPE.OUT$ = ""                                                        !1.9SH
9653: 60c8:       WHILE READ.DELVINDX = 0                                               !1.9SH
9654: 60d3:          UODOT.LICENCE$ = PACK$(DELVINDX.UOD.LICENCE$)                      !1.9SH
9655: 60f6:          UODOT.SEQ% = VALUE%(DELVINDX.UOD.SEQ$)                             !1.9SH
9656: 6119:          IF READ.UODOT THEN BEGIN                                           !1.9SH
9657: 612a:             GOSUB READ.ERROR.SUB                                            !1.9SH
9658: 613f:          ENDIF ELSE BEGIN                                                   !1.9SH
9659: 6147:             IF NOT UODOT.BOOKED THEN BEGIN                                  !1.9SH
9660: 615d:                IF UODOT.EST.DEL.DATE$ = PACK$(DATE$) THEN BEGIN             !1.9SH
9661: 6184:                   STATUS$ = "E"                                             !1.9SH
9662: 619b:                ENDIF ELSE IF UODOT.EST.DEL.DATE$ < PACK$(DATE$) THEN BEGIN  !1.9SH
9663: 61c2:                   STATUS$ = "O"                                             !1.9SH
9664: 61d9:                ENDIF ELSE BEGIN                                             !1.9SH
9665: 61e1:                   STATUS$ = "F"                                             !1.9SH
9666: 61f6:                ENDIF                                                        !1.9SH
9667: 6200:             ENDIF ELSE BEGIN                                                !1.9SH
9668: 6208:                STATUS$ = "Y"                                                !1.9SH
9669: 621d:             ENDIF                                                           !1.9SH
9670: 6225:             
9671: 6225:             IF UODOT.BOL THEN BEGIN                                         !1.10SH
9672: 6237:                 BOL$ = "Y"                                                  !1.10SH
9673: 624e:             ENDIF ELSE BEGIN                                                !1.10SH
9674: 6256:                 BOL$ = "N"                                                  !1.10SH
9675: 626b:             ENDIF                                                           !1.10SH
9676: 6273:             
9677: 6273:             !Don't send UODs marked for deletion                            !1.9SH
9678: 6273:             IF UODOT.REASON$ <> "X" THEN BEGIN                              !1.9SH
9679: 6294:             
9680: 6294:                !Don't send already booked UODs that weren't booked in today,!1.9SH
9681: 6294:                !to reduce transmission volumes                              !1.9SH
9682: 6294:                IF NOT UODOT.BOOKED OR UODOT.BOOKED.DATE$ = PACK$(DATE$) THEN BEGIN!1.9SH
9683: 62d6:                   IF PIPE.OUT$ = "" THEN BEGIN                              !1.9SH
9684: 62f4:                      PIPE.OUT$ = "TD" + DELVINDX.UOD.LICENCE$       + \     !1.9SH
9685: 634d:                                         DELVINDX.UOD.DESPATCH.DATE$ + \     !1.9SH
9686: 634d:                                         DELVINDX.UOD.PARENT$        + \     !1.9SH
9687: 634d:                                         UODOT.TYPE$                 + \     !1.9SH
9688: 634d:                                         STATUS$                     + \     !1.10SH
9689: 634d:                                         BOL$                                !1.10SH
9690: 634d:                   ENDIF ELSE BEGIN                                          !1.9SH
9691: 6355:                      PIPE.OUT$ = PIPE.OUT$ + DELVINDX.UOD.LICENCE$       + \!1.9SH
9692: 63b2:                                              DELVINDX.UOD.DESPATCH.DATE$ + \!1.9SH
9693: 63b2:                                              DELVINDX.UOD.PARENT$        + \!1.9SH
9694: 63b2:                                              UODOT.TYPE$                 + \!1.9SH
9695: 63b2:                                              STATUS$                     + \!1.10SH
9696: 63b2:                                              BOL$                           !1.10SH
9697: 63b2:                      CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                !1.9SH
9698: 63c8:                      WRITE #REWKF.SESS.NUM%; PIPE.OUT$                      !1.9SH
9699: 63ee:                      NUM.RECS% = NUM.RECS% + 1                              !1.9SH
9700: 63fa:                      PIPE.OUT$ = ""                                         !1.9SH
9701: 6411:                   ENDIF                                                     !1.9SH
9702: 6419:                ENDIF                                                        !1.9SH
9703: 6421:             
9704: 6421:             ENDIF                                                           !1.9SH
9705: 6429:             
9706: 6429:          ENDIF                                                              !1.9SH
9707: 6431:       WEND                                                                  !1.9SH
9708: 6446: 
9709: 6446:       !Mop up if there were an odd number of UODs                           !1.9SH
9710: 6446:       IF LEN(PIPE.OUT$) THEN BEGIN                                          !1.9SH
9711: 6466:          PIPE.OUT$ = PIPE.OUT$ + STRING$(28, "0")                           !1.9SH
9712: 6492:          CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                            !1.9SH
9713: 64a8:          WRITE #REWKF.SESS.NUM%; PIPE.OUT$                                  !1.9SH
9714: 64ce:          NUM.RECS% = NUM.RECS% + 1                                          !1.9SH
9715: 64da:          PIPE.OUT$ = ""                                                     !1.9SH
9716: 64f1:       ENDIF                                                                 !1.9SH
9717: 64f9:       
9718: 64f9:    ENDIF                                                                    !1.9SH
9719: 6501:    
9720: 6501:    !Send trailer                                                            !1.9SH
9721: 6501:    PIPE.OUT$ = "TE" + PADNUM$(NUM.RECS% + 1, 5)                             !1.9SH
9722: 6528:    CURRENT.REPORT.NUM% = REWKF.REPORT.NUM%                                  !1.9SH
9723: 653e:    WRITE #REWKF.SESS.NUM%; PIPE.OUT$                                        !1.9SH
9724: 6564: 
9725: 6564:    !Close REWKF                                                             !1.9SH
9726: 6564:    CLOSE REWKF.SESS.NUM%                                                    !1.9SH     
9727: 6578:    REWKF.OPEN.FLAG$ = "N"                                                   !1.9SH     
9728: 658f:    
9729: 658f:    !Release PDT                                                             !1.9SH     
9730: 658f:    PIPE.OUT$ = "HN"                                                         !1.9SH     
9731: 65a6:    GOSUB SEND.TO.PSS38                                                      !1.9SH     
9732: 65b8:    HOLD.FLAG$ = "N"                                                         !1.9SH     
9733: 65cf:    
9734: 65cf:    !Get PSS38 to send REWKF                                                 !1.9SH     
9735: 65cf:    PIPE.OUT$ = "A"                                                          !1.9SH     
9736: 65e6:    GOSUB SEND.TO.PSS38                                                      !1.9SH     
9737: 65f8:    
9738: 65f8:    !Close files                                                             !1.9SH
9739: 65f8:    CLOSE DELVINDX.SESS.NUM%                                                 !1.9SH
9740: 660c:    DELVINDX.OPEN.FLAG$ = "N"                                                !1.9SH
9741: 6623:    CLOSE UODOT.SESS.NUM%                                                    !1.9SH
9742: 6637:    UODOT.OPEN.FLAG$ = "N"                                                   !1.9SH
9743: 664e: 
9744: 664e: RETURN                                                                      !1.9SH
9745: 665e: 
9746: 665e: 
9747: 665e: \*****************************************************************************
9748: 665e: \***
9749: 665e: \*** RECEIVED.PUOD.RECEIVED.OK
9750: 665e: \***
9751: 665e: \*****************************************************************************
9752: 665e: 
9753: 665e: RECEIVED.PUOD.RECEIVED.OK:                                                  !1.9SH
9754: 666e: 
9755: 666e:    SB.MESSAGE$ = "PDT Support - +UOD received OK"                           !1.9SH
9756: 6683:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9757: 6695:    
9758: 6695:    IF FN.VALIDATE.DATA(DATA.IN$,62) = 0 THEN BEGIN                          !1.9SH
9759: 66b7:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9760: 66ce:      RETURN                                                                 !1.9SH
9761: 66de:    ENDIF                                                                    !1.9SH
9762: 66e6:    
9763: 66e6:    TEMP.TIME$ = TIME$                                                       !1.9SH
9764: 66fe:    CSR.AUDIT.DATA$ = "+UOD send complete at " + \                           !1.9SH
9765: 6770:                       LEFT$(TEMP.TIME$,2)  + ":" + \                        !1.9SH
9766: 6770:                       MID$(TEMP.TIME$,3,2) + ":" + \                        !1.9SH
9767: 6770:                       RIGHT$(TEMP.TIME$,2)                                  !1.9SH
9768: 6770:    GOSUB LOG.TO.AUDIT.FILE                                                  !1.9SH
9769: 6782: 
9770: 6782:    CLOSE CSR.AUDIT.SESS.NUM%                                                !1.9SH
9771: 6796:    CSR.AUDIT.OPEN.FLAG$ = "N"                                               !1.9SH
9772: 67ad: 
9773: 67ad:    RE.CHAIN = TRUE                                                          !1.9SH
9774: 67bf:    RECEIVE.STATE$ = "?"                                                     !1.9SH
9775: 67d6: 
9776: 67d6: RETURN                                                                      !1.9SH
9777: 67e6: 
9778: 67e6: 
9779: 67e6: \*****************************************************************************
9780: 67e6: \***
9781: 67e6: \*** RECEIVED.PUOD.HEADER
9782: 67e6: \***
9783: 67e6: \*****************************************************************************
9784: 67e6: 
9785: 67e6: RECEIVED.PUOD.HEADER:                                                       !1.9SH
9786: 67f6: 
9787: 67f6:    SB.MESSAGE$ = "PDT Support - +UOD header received"                       !1.9SH
9788: 680b:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9789: 681d:    
9790: 681d:    IF FN.VALIDATE.DATA(DATA.IN$,63) = 0 THEN BEGIN                          !1.9SH
9791: 683f:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9792: 6856:      RETURN                                                                 !1.9SH
9793: 6866:    ENDIF                                                                    !1.9SH
9794: 686e: 
9795: 686e:    !Read SOFTS to get overnight config                                      !1.9SH
9796: 686e:    GOSUB PROCESS.SOFTS                                                      !1.9SH
9797: 6880:    
9798: 6880:    FILE.SUFFIX$ = TIME$ + ".PDT"                                            !1.9SH
9799: 68a8:    RETRIES% = 10                                                            !1.9SH
9800: 68b6: UB.RETRY:                                                                   !1.9SH
9801: 68c6:    IF END # UB.SESS.NUM% THEN CREATE.ERROR                                  !1.9SH
9802: 68e2:    CURRENT.REPORT.NUM% = UB.REPORT.NUM%                                     !1.9SH
9803: 68f8:    CREATE POSFILE UB.TEMP.NAME$ + FILE.SUFFIX$ AS UB.SESS.NUM% \            !1.9SH
9804: 693c:                                           BUFFSIZE 32767 LOCKED MIRRORED ATCLOSE!1.9SH
9805: 693c:    UB.OPEN.FLAG$ = "Y"                                                      !1.9SH
9806: 6951:    UB.REC.TYPE$   = "H"                                                     !1.9SH
9807: 6968:    UB.OP.ID$      = "00000" + MID$(DATA.IN$, 3, 3)                          !1.9SH
9808: 6996:    UB.METHOD$     = "P"                                                     !1.9SH
9809: 69ad:    UB.REPORT.RQD$ = "Y"                                                     !1.9SH
9810: 69c4:    IF ONIGHT THEN BEGIN                                                     !1.9SH
9811: 69d3:       UB.ONIGHT.DELIVERY.TYPE$ = "Y"                                        !1.9SH
9812: 69ec:    ENDIF ELSE BEGIN                                                         !1.9SH
9813: 69f4:       UB.ONIGHT.DELIVERY.TYPE$ = "N"                                        !1.9SH
9814: 6a0b:    ENDIF                                                                    !1.9SH
9815: 6a13:    UB.DRIVER.CHECKIN.REQD$ = "N"                                            !1.9SH
9816: 6a2a:    IF WRITE.UB THEN GOTO WRITE.ERROR                                        !1.9SH
9817: 6a3e: 
9818: 6a3e: RETURN                                                                      !1.9SH
9819: 6a4e: 
9820: 6a4e: 
9821: 6a4e: \*****************************************************************************
9822: 6a4e: \***
9823: 6a4e: \*** RECEIVED.PUOD.DETAIL
9824: 6a4e: \***
9825: 6a4e: \*****************************************************************************
9826: 6a4e: 
9827: 6a4e: RECEIVED.PUOD.DETAIL:                                                       !1.9SH
9828: 6a5e: 
9829: 6a5e:    SB.MESSAGE$ = "PDT Support - +UOD detail received"                       !1.9SH
9830: 6a73:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9831: 6a85:    
9832: 6a85:    IF FN.VALIDATE.DATA(DATA.IN$,64) = 0 THEN BEGIN                          !1.9SH
9833: 6aa7:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9834: 6abe:      RETURN                                                                 !1.9SH
9835: 6ace:    ENDIF                                                                    !1.9SH
9836: 6ad6: 
9837: 6ad6:    UB.REC.TYPE$      = "B"                                                  !1.9SH
9838: 6aed:    UB.LICENCE$       = MID$(DATA.IN$, 3, 10)                                !1.9SH
9839: 6b14:    UB.DESPATCH.DATE$ = MID$(DATA.IN$, 13, 6)                                !1.9SH
9840: 6b3b:    UB.BOOKED.DATE$   = MID$(DATA.IN$, 19, 6)                                !1.9SH
9841: 6b62:    UB.BOOKED.TIME$   = MID$(DATA.IN$, 25, 6)                                !1.9SH
9842: 6b89:    UB.BOOK.TYPE$     = MID$(DATA.IN$, 31, 1)                                !1.9SH
9843: 6bb0:    IF WRITE.UB THEN GOTO WRITE.ERROR                                        !1.9SH
9844: 6bc4: 
9845: 6bc4: RETURN                                                                      !1.9SH
9846: 6bd4: 
9847: 6bd4: 
9848: 6bd4: \*****************************************************************************
9849: 6bd4: \***
9850: 6bd4: \*** RECEIVED.PUOD.BATCH.TRAILER
9851: 6bd4: \***
9852: 6bd4: \*****************************************************************************
9853: 6bd4: 
9854: 6bd4: RECEIVED.PUOD.BATCH.TRAILER:                                                !1.9SH
9855: 6be4: 
9856: 6be4:    SB.MESSAGE$ = "PDT Support - +UOD batch trailer received"                !1.9SH
9857: 6bf9:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9858: 6c0b:    
9859: 6c0b:    IF FN.VALIDATE.DATA(DATA.IN$,65) = 0 THEN BEGIN                          !1.9SH
9860: 6c2d:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9861: 6c44:      RETURN                                                                 !1.9SH
9862: 6c54:    ENDIF                                                                    !1.9SH
9863: 6c5c: 
9864: 6c5c:    UB.REC.TYPE$          = "C"                                              !1.9SH
9865: 6c73:    UB.DRVR.ID$           = MID$(DATA.IN$, 3, 8)                             !1.9SH
9866: 6c9a:    UB.DRVR.REJECTED$     = MID$(DATA.IN$, 11, 1)                            !1.9SH
9867: 6cc1:    UB.DRVR.CHCK.DATE$    = MID$(DATA.IN$, 12, 6)                            !1.9SH
9868: 6ce8:    UB.DRVR.CHCK.TIME$    = MID$(DATA.IN$, 18, 6)                            !1.9SH
9869: 6d0f:    UB.DRVR.GIT.MATCH$    = " "                                              !1.9SH
9870: 6d26:    UB.DRVR.CONFIRM.SCAN$ = "C"                                              !1.9SH
9871: 6d3d:    IF WRITE.UB THEN GOTO WRITE.ERROR                                        !1.9SH
9872: 6d51: 
9873: 6d51: RETURN                                                                      !1.9SH
9874: 6d61: 
9875: 6d61: 
9876: 6d61: \*****************************************************************************
9877: 6d61: \***
9878: 6d61: \*** RECEIVED.PUOD.SESSION.TRAILER
9879: 6d61: \***
9880: 6d61: \*****************************************************************************
9881: 6d61: 
9882: 6d61: RECEIVED.PUOD.SESSION.TRAILER:                                              !1.9SH
9883: 6d71: 
9884: 6d71:    SB.MESSAGE$ = "PDT Support - +UOD session trailer received"              !1.9SH
9885: 6d86:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9886: 6d98:    
9887: 6d98:    IF FN.VALIDATE.DATA(DATA.IN$,66) = 0 THEN BEGIN                          !1.9SH
9888: 6dba:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9889: 6dd1:      RETURN                                                                 !1.9SH
9890: 6de1:    ENDIF                                                                    !1.9SH
9891: 6de9: 
9892: 6de9:    UB.REC.TYPE$ = "C"                                                       !1.9SH
9893: 6e00:    UB.DRVR.ID$ = MID$(DATA.IN$, 3, 8)                                       !1.9SH
9894: 6e27:    UB.DRVR.GIT.MATCH$ = MID$(DATA.IN$, 11, 1)                               !1.9SH
9895: 6e4e:    UB.DRVR.CHCK.DATE$ = MID$(DATA.IN$, 12, 6)                               !1.9SH
9896: 6e75:    UB.DRVR.CHCK.TIME$ = MID$(DATA.IN$, 18, 6)                               !1.9SH
9897: 6e9c:    UB.DRVR.CONFIRM.SCAN$ = "S"                                              !1.9SH
9898: 6eb3:    UB.DRVR.REJECTED$ = " "                                                  !1.9SH
9899: 6eca:    IF WRITE.UB THEN GOTO WRITE.ERROR                                        !1.9SH
9900: 6ede: 
9901: 6ede:    UB.REC.TYPE$ = "T"                                                       !1.9SH
9902: 6ef5:    UB.REC.COUNT$ = PADNUM$(VALUE%(MID$(DATA.IN$, 24, 5)) + 1, 5)            !1.9SH
9903: 6f43:    IF WRITE.UB THEN GOTO WRITE.ERROR                                        !1.9SH
9904: 6f57: 
9905: 6f57:    !Send acknowledgement to the PDT                                         !1.9SH
9906: 6f57:    PIPE.OUT$ = "L" + "TM"                                                   !1.9SH
9907: 6f75:    GOSUB SEND.TO.PSS38                                                      !1.9SH
9908: 6f87:           
9909: 6f87: RETURN                                                                      !1.9SH
9910: 6f97: 
9911: 6f97: 
9912: 6f97: \*****************************************************************************
9913: 6f97: \***
9914: 6f97: \*** RECEIVED.PUOD.EOT
9915: 6f97: \***
9916: 6f97: \*****************************************************************************
9917: 6f97: 
9918: 6f97: RECEIVED.PUOD.EOT:                                                          !1.9SH
9919: 6fa7: 
9920: 6fa7:    SB.MESSAGE$ = "PDT Support - +UOD EOT received"                          !1.9SH
9921: 6fbc:    GOSUB SB.BG.MESSAGE                                                      !1.9SH
9922: 6fce:                                                                           
9923: 6fce:    IF FN.VALIDATE.DATA(DATA.IN$,67) = 0 THEN BEGIN                          !1.9SH
9924: 6ff0:      RECEIVE.STATE$ = "*"                                                   !1.9SH
9925: 7007:      RETURN                                                                 !1.9SH
9926: 7017:    ENDIF                                                                    !1.9SH
9927: 701f:    
9928: 701f:    IF UB.OPEN.FLAG$ = "Y" THEN BEGIN                                        !1.9SH
9929: 703a:      CLOSE UB.SESS.NUM%                                                     !1.9SH
9930: 704e:    ENDIF                                                                    !1.9SH
9931: 7056: 
9932: 7056:    RETRIES% = 10                                                            !1.9SH
9933: 7064:    NEW.SUFFIX$ = FILE.SUFFIX$                                               !1.9SH
9934: 707d:    RC% = RENAME(UB.FILE.NAME$ + NEW.SUFFIX$, \                              !1.9SH
9935: 70d4:                 UB.TEMP.NAME$ + FILE.SUFFIX$)                               !1.9SH
9936: 70d4:    WHILE RC% = 0 AND RETRIES% > 0                                           !1.9SH
9937: 70de:      RETRIES% = RETRIES% - 1                                                !1.9SH
9938: 70ea:      CALL INCREMENT.SUFFIX(NEW.SUFFIX$)                                     !1.9SH
9939: 70fd:      RC% = RENAME(UB.FILE.NAME$ + NEW.SUFFIX$, \                            !1.9SH
9940: 7154:                   UB.TEMP.NAME$ + FILE.SUFFIX$)                             !1.9SH
9941: 7154:    WEND                                                                     !1.9SH
9942: 717f: 
9943: 717f:    !If rename fails then log error, else start SSC01                        !1.9SH
9944: 717f:    IF RC% = 0 THEN BEGIN                                                    !1.9SH
9945: 7191:      CALL APPLICATION.LOG(221, UB.FILE.NAME$ + FILE.SUFFIX$, \              !1.9SH
9946: 71d6:                             "Error booking in, check event log", 14)        !1.9SH
9947: 71d6:    ENDIF ELSE BEGIN                                                         !1.9SH
9948: 71de:      CALL ADXSTART("ADX_UPGM:SSC01.286", UB.FILE.NAME$ + NEW.SUFFIX$, \     !1.9SH
9949: 721e:                    "PSS37 is attempting to start SSC01")                    !1.9SH
9950: 721e:    ENDIF                                                                    !1.9SH
9951: 7226: 
9952: 7226:    CSR.AUDIT.DATA$ = "+UOD EOT"                                             !1.9SH
9953: 723d:    GOSUB LOG.TO.AUDIT.FILE                                                  !1.9SH
9954: 724f:    IF CSR.AUDIT.OPEN.FLAG$ = "Y" THEN BEGIN                                 !1.9SH
9955: 726d:      CLOSE CSR.AUDIT.SESS.NUM%                                              !1.9SH
9956: 7281:      CSR.AUDIT.OPEN.FLAG$ = "N"                                             !1.9SH
9957: 7298:    ENDIF                                                                    !1.9SH
9958: 72a0: 
9959: 72a0:    RE.CHAIN = TRUE                                                          !1.9SH
9960: 72b2:    RECEIVE.STATE$ = "?"                                                     !1.9SH
9961: 72c9: 
9962: 72c9: RETURN                                                                      !1.9SH
9963: 72d9: 
9964: 72d9: 
9965: 72d9: \*****************************************************************************
9966: 72d9: \***
9967: 72d9: \*** PROCESS.SOFTS
9968: 72d9: \***
9969: 72d9: \*****************************************************************************
9970: 72d9: 
9971: 72d9: PROCESS.SOFTS:                                                              !1.9SH
9972: 72e9: 
9973: 72e9:    !Open, read, close Software Status File                                  !1.9SH
9974: 72e9:    IF SOFTS.OPEN.FLAG$ = "N" THEN BEGIN                                     !1.9SH
9975: 7307:       IF END #SOFTS.SESS.NUM% THEN OPEN.ERROR                               !1.9SH          
9976: 7323:       CURRENT.REPORT.NUM% = SOFTS.REPORT.NUM%                               !1.9SH                 
9977: 7339:       OPEN SOFTS.FILE.NAME$ DIRECT RECL SOFTS.RECL% AS SOFTS.SESS.NUM% NOWRITE NODEL !1.9SH
9978: 7366:       SOFTS.OPEN.FLAG$ = "Y"                                                !1.9SH          
9979: 737d:    ENDIF                                                                    !1.9SH
9980: 7385:    SOFTS.REC.NUM% = 57                                                      !1.9SH
9981: 739c:    IF READ.SOFTS THEN GOTO READ.ERROR                                       !1.9SH
9982: 73b0:    CLOSE SOFTS.SESS.NUM%                                                    !1.9SH
9983: 73c4:    SOFTS.OPEN.FLAG$ = "N"                                                   !1.9SH
9984: 73db:    
9985: 73db:    IF MATCH("ONIGHT STORE=Y", SOFTS.RECORD$, 1) THEN BEGIN                  !1.9SH
9986: 73fd:       ONIGHT = TRUE                                                         !1.9SH
9987: 740d:    ENDIF ELSE BEGIN                                                         !1.9SH
9988: 7415:       ONIGHT = FALSE                                                        !1.9SH
9989: 7423:    ENDIF                                                                    !1.9SH
9990: 742b:    
9991: 742b:    FILE.RETURN.CODE% = MATCH("BATCH SIZE=", SOFTS.RECORD$, 1)               !1.9SH
9992: 7455:    IF FILE.RETURN.CODE% > 0 THEN BEGIN                                      !1.9SH
9993: 746e:       BATCH.SIZE$ = MID$(SOFTS.RECORD$, FILE.RETURN.CODE% + 11, 3)          !1.9SH
9994: 74a1:    ENDIF ELSE BEGIN                                                         !1.9SH
9995: 74a9:       BATCH.SIZE$ = "000"                                                   !1.9SH
9996: 74be:    ENDIF                                                                    !1.9SH
9997: 74c6: 
9998: 74c6: RETURN                                                                      !1.9SH
9999: 74d6: 
10000: 74d6: 
10001: 74d6: \******************************************************************************
10002: 74d6: \***
10003: 74d6: \***   SEND.TO.PSS38:
10004: 74d6: \***
10005: 74d6: \***      transmit data to PSS38 (data contained in PIPE.OUT$)
10006: 74d6: \***
10007: 74d6: \******************************************************************************
10008: 74d6: 
10009: 74d6: SEND.TO.PSS38:                                                              ! 1.5BG
10010: 74e6: 
10011: 74e6:    IF END # PIPEI.SESS.NUM% THEN WRITE.ERROR                                ! 1.5BG
10012: 7504:    CURRENT.REPORT.NUM% = PIPEI.REPORT.NUM%                                  ! 1.9SH
10013: 751b:    WRITE # PIPEI.SESS.NUM%; PIPE.OUT$                                       ! 1.5BG
10014: 7543: 
10015: 7543: RETURN                                                                      ! 1.5BG
10016: 7553: 
10017: 7553: 
10018: 7553: \******************************************************************************
10019: 7553: \***
10020: 7553: \***   LOG.TO.AUDIT.FILE
10021: 7553: \***
10022: 7553: \***   RETURN
10023: 7553: \***
10024: 7553: \******************************************************************************
10025: 7553: 
10026: 7553: LOG.TO.AUDIT.FILE:                                                                  ! 1.5BG
10027: 7563: 
10028: 7563:    IF CSR.AUDIT.OPEN.FLAG$ = "N" THEN BEGIN                                         ! 1.5BG
10029: 7581:       IF END #CSR.AUDIT.SESS.NUM% THEN AUDIT.FAIL                                   ! 1.5BG
10030: 759d:       OPEN CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM% APPEND                            ! 1.5BG
10031: 75c4:       CSR.AUDIT.OPEN.FLAG$ = "Y"                                                    ! 1.5BG
10032: 75db:    ENDIF                                                                            ! 1.5BG
10033: 75e3: 
10034: 75e3:    CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " + \                          ! 1.5BG
10035: 7617:                         CSR.AUDIT.DATA$                                             ! 1.5BG  
10036: 7617:    PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$                            ! 1.5BG
10037: 7646: 
10038: 7646: AUDIT.FAIL:                                                                         ! 1.5BG
10039: 7656: 
10040: 7656:    RETURN                                                                           ! 1.5BG
10041: 7666: 
10042: 7666: 
10043: 7666: \******************************************************************************
10044: 7666: \***
10045: 7666: \***   OPEN.FILES
10046: 7666: \***
10047: 7666: \******************************************************************************
10048: 7666: 
10049: 7666: OPEN.FILES:
10050: 7676: 
10051: 7676:     SB.ACTION$ = "O"                                                        ! 1.4CS
10052: 768b:                                                                             ! 1.4CS
10053: 768b:     BUFFER.FILE$ = "ADXLXACN::D:\ADX_UDT1\SCBUF" + MONITORED.PORT$ + ".PDT" ! 1.4CS                                      
10054: 76b2:                                                                             ! 1.4CS
10055: 76b2:     IF MONITORED.PORT$ = "A" THEN BEGIN                                     ! 1.4CS
10056: 76d0:         BUFFER.REPORT.NUM% = 210         ! Port A                           ! 1.4CS
10057: 76e0:     ENDIF ELSE BEGIN                                                        ! 1.4CS
10058: 76e8:         BUFFER.REPORT.NUM% = 211         ! Port B                           ! 1.4CS          
10059: 76f6:     ENDIF                                                                   ! 1.4CS
10060: 76fe: 
10061: 76fe:     SB.INTEGER% = BUFFER.REPORT.NUM%                                        ! 1.4CS
10062: 770c:     SB.STRING$ = BUFFER.FILE$                                               ! 1.4CS
10063: 7725:     GOSUB SB.FILE.UTILS                                                     ! 1.4CS 
10064: 7737:     BUFFER.SESS.NUM% = SB.FILE.SESS.NUM%                                    ! 1.4CS
10065: 7745:     IF END #BUFFER.SESS.NUM% THEN CREATE.BUFFER.FILE                        ! 1.4CS
10066: 775f:     OPEN BUFFER.FILE$ AS BUFFER.SESS.NUM% APPEND                            ! 1.4CS
10067: 7781:     GOTO BUFFER.OK                                                          ! 1.4CS
10068: 778b:                                                                             ! 1.4CS
10069: 778b:   CREATE.BUFFER.FILE:                                                       ! 1.4CS
10070: 779b:                                                                             ! 1.4CS
10071: 779b:     IF END #BUFFER.SESS.NUM% THEN CREATE.ERROR                              ! 1.4CS
10072: 77b5:     CREATE BUFFER.FILE$ AS BUFFER.SESS.NUM%                                 ! 1.4CS
10073: 77d7:                                                                             ! 1.4CS
10074: 77d7:   BUFFER.OK:                                                                ! 1.4CS
10075: 77e7:   
10076: 77e7:     BUFFER.OPEN.FLAG$ = "Y"                                                 ! 1.5BG
10077: 77fc: 
10078: 77fc: RETURN
10079: 780c: 
10080: 780c: 
10081: 780c: \******************************************************************************
10082: 780c: \***
10083: 780c: \***   CLOSE.FILES
10084: 780c: \***
10085: 780c: \******************************************************************************
10086: 780c: 
10087: 780c: CLOSE.FILES:
10088: 781c: 
10089: 781c:    CLOSE SOFTS.SESS.NUM%                                            !1.9SH
10090: 7830:    SOFTS.OPEN.FLAG$ = ""                                            !1.9SH
10091: 7847:    CLOSE DELVINDX.SESS.NUM%                                         !1.9SH
10092: 785b:    DELVINDX.OPEN.FLAG$ = ""                                         !1.9SH
10093: 7872:    CLOSE UODOT.SESS.NUM%                                            !1.9SH
10094: 7886:    UODOT.OPEN.FLAG$ = ""                                            !1.9SH
10095: 789d:    CLOSE AF.SESS.NUM%                                               !1.9SH
10096: 78b1:    AF.OPEN.FLAG$ = ""                                               !1.9SH
10097: 78c8:    
10098: 78c8:    IF SSPSCTRL.OPEN.FLAG$ = "Y" THEN BEGIN                           ! 1.1JAS
10099: 78e3:       SSPSCTRL.OPEN.FLAG$ = "N"                                      ! 1.1JAS
10100: 78f8:       CLOSE SSPSCTRL.SESS.NUM%                                       ! 1.1JAS
10101: 790c:    ENDIF                                                             ! 1.1JAS
10102: 7914:    IF BTCS.OPEN.FLAG$ = "Y" THEN BEGIN                               ! 1.1JAS
10103: 792f:       BTCS.OPEN.FLAG$ = "N"                                          ! 1.1JAS
10104: 7944:       CLOSE BTCS.SESS.NUM%                                           ! 1.1JAS
10105: 7958:    ENDIF                                                             ! 1.1JAS
10106: 7960:    IF PRINTER.OPEN THEN BEGIN                                        ! 1.1JAS
10107: 796f:       PRINTER.OPEN = FALSE                                           ! 1.1JAS
10108: 797d:       CLOSE PRINT.SESS.NUM%                                          ! 1.1JAS
10109: 7991:    ENDIF                                                             ! 1.1JAS
10110: 7999:    
10111: 7999:    IF REWKF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.5BG
10112: 79b7:       REWKF.OPEN.FLAG$ = "N"                                         ! 1.5BG
10113: 79ce:       CLOSE REWKF.SESS.NUM%                                          ! 1.5BG
10114: 79e2:    ENDIF                                                             ! 1.5BG
10115: 79ea:    
10116: 79ea:    IF IDF.OPEN.FLAG$="Y" THEN BEGIN                                  ! 1.5BG
10117: 7a08:       CLOSE IDF.SESS.NUM%                                            ! 1.5BG
10118: 7a1c:       IDF.OPEN.FLAG$="N"                                             ! 1.5BG
10119: 7a33:    ENDIF                                                             ! 1.5BG
10120: 7a3b:       
10121: 7a3b:    IF IMSTC.OPEN.FLAG$="Y" THEN BEGIN                                ! 1.5BG
10122: 7a59:       CLOSE IMSTC.SESS.NUM%                                          ! 1.5BG
10123: 7a6d:       IMSTC.OPEN.FLAG$="N"                                           ! 1.5BG
10124: 7a84:    ENDIF                                                             ! 1.5BG
10125: 7a8c:       
10126: 7a8c:    IF STOCK.OPEN.FLAG$="Y" THEN BEGIN                                ! 1.5BG
10127: 7aa7:       CLOSE STOCK.SESS.NUM%                                          ! 1.5BG
10128: 7abb:       STOCK.OPEN.FLAG$="N"                                           ! 1.5BG
10129: 7ad0:    ENDIF                                                             ! 1.5BG
10130: 7ad8:    
10131: 7ad8:    IF RB.OPEN.FLAG$ = "Y" THEN BEGIN                                 ! 1.5BG
10132: 7af6:       CLOSE RB.SESS.NUM%                                             ! 1.5BG
10133: 7b0a:       RB.OPEN.FLAG$ = "N"                                            ! 1.5BG
10134: 7b21:    ENDIF                                                             ! 1.5BG
10135: 7b29: 
10136: 7b29:    SB.ACTION$ = "C"
10137: 7b3e:    SB.STRING$ = ""
10138: 7b53:    IF MATCH(RECEIVE.STATE$,"wxyz",1) > 0 THEN BEGIN              ! 1.1JAS
10139: 7b76:       SB.INTEGER% = SSPSCTRL.SESS.NUM%                           ! 1.1JAS
10140: 7b88:       GOSUB SB.FILE.UTILS                                        ! 1.1JAS
10141: 7b9a:       SB.INTEGER% = BTCS.SESS.NUM%                               ! 1.1JAS
10142: 7bac:       GOSUB SB.FILE.UTILS                                        ! 1.1JAS
10143: 7bbe:    ENDIF                                                         ! 1.1JAS
10144: 7bc6:    
10145: 7bc6:    IF MATCH(RECEIVE.STATE$,"12",1) > 0 THEN BEGIN                ! 1.5BG
10146: 7be9:       SB.INTEGER% = REWKF.SESS.NUM%                              ! 1.5BG
10147: 7bfb:       GOSUB SB.FILE.UTILS                                        ! 1.5BG
10148: 7c0d:    ENDIF                                                         ! 1.5BG
10149: 7c15:    
10150: 7c15:    IF MATCH(RECEIVE.STATE$,"345",1) > 0 THEN BEGIN               ! 1.5BG
10151: 7c38:       SB.INTEGER% = RB.SESS.NUM%                                 ! 1.5BG
10152: 7c4a:       GOSUB SB.FILE.UTILS                                        ! 1.5BG
10153: 7c5c:    ENDIF                                                         ! 1.5BG
10154: 7c64: 
10155: 7c64:     IF RECEIVE.STATE$ = "s" OR RECEIVE.STATE$ = "w" THEN BEGIN       ! 1.1JAS
10156: 7cb6:        GOSUB INITIALISE
10157: 7cc8:        COUNT.IN.PROGRESS% = TRUE                                     
10158: 7cd6:        GOSUB OPEN.FILES
10159: 7ce8:     ENDIF
10160: 7cf0: 
10161: 7cf0:    IF BUFFER.OPEN.FLAG$ = "Y" THEN BEGIN                            ! 1.5BG
10162: 7d0b:       CLOSE BUFFER.SESS.NUM%                                        ! 1.4CS
10163: 7d1d:       SB.INTEGER% = BUFFER.SESS.NUM%                                ! 1.4CS
10164: 7d2c:       GOSUB SB.FILE.UTILS                                           ! 1.4CS
10165: 7d3e:       BUFFER.OPEN.FLAG$ = "N"                                       ! 1.5BG
10166: 7d53:    ENDIF                                                            ! 1.5BG
10167: 7d5b:       
10168: 7d5b: RETURN
10169: 7d6b: 
10170: 7d6b: 
10171: 7d6b: \******************************************************************************
10172: 7d6b: \******************************************************************************
10173: 7d6b: \***                                                                        ***
10174: 7d6b: \***                                                                        ***
10175: 7d6b: \***   L O W   L E V E L   S U B R O U T I N E S                            ***
10176: 7d6b: \***                                                                        ***
10177: 7d6b: \***                                                                        ***
10178: 7d6b: \******************************************************************************
10179: 7d6b: \******************************************************************************
10180: 7d6b: 
10181: 7d6b: \******************************************************************************
10182: 7d6b: \***
10183: 7d6b: \***   Subroutine : SB.FILE.UTILS
10184: 7d6b: \***
10185: 7d6b: \***   Purpose    : Allocate / report / de-allocate a file session number
10186: 7d6b: \***
10187: 7d6b: \***   Parameters : 2 or 3 (depending on action)
10188: 7d6b: \***
10189: 7d6b: \***      SB.ACTION$  = "O" for allocate file session number
10190: 7d6b: \***                    "R" for report file session number
10191: 7d6b: \***                    "C" for de-allocate file session number
10192: 7d6b: \***      SB.INTEGER% = file reporting number for action "O" or
10193: 7d6b: \***                  = file session number for actions "R" or "C"
10194: 7d6b: \***
10195: 7d6b: \***      SB.STRING$  = logical file name for action "O" or
10196: 7d6b: \***                    null ("") for actions "R" and "C"
10197: 7d6b: \***
10198: 7d6b: \***   Output     : 1 or 2 (depending on action)
10199: 7d6b: \***      SB.FILE.SESS.NUM% = file session number for action "O" or
10200: 7d6b: \***                          undefined for action "C"
10201: 7d6b: \***      or
10202: 7d6b: \***      SB.FILE.REP.NUM%  = file reporting number for action "R" or
10203: 7d6b: \***                          undefined for action "C"
10204: 7d6b: \***
10205: 7d6b: \***   Error action : log event 48 and end program
10206: 7d6b: \***
10207: 7d6b: \******************************************************************************
10208: 7d6b: 
10209: 7d6b: SB.FILE.UTILS:
10210: 7d7b: 
10211: 7d7b:     RC% = SESS.NUM.UTILITY(SB.ACTION$,SB.INTEGER%,SB.STRING$ )
10212: 7da6: 
10213: 7da6:     IF RC% <> 0 THEN BEGIN
10214: 7db8:        SB.EVENT.NO% = 48
10215: 7dc5:        SB.UNIQUE$ = FN.Z.PACK(STR$(SB.FILE.SESS.NUM%), 10)
10216: 7df3:        SB.MESSAGE$ = "SESSION NUMBER ALLOCATION ROUTINE FAILED"
10217: 7e08:        GOSUB SB.LOG.AN.EVENT
10218: 7e1a:        GOTO MODULE.EXIT
10219: 7e25:     ENDIF
10220: 7e2d: 
10221: 7e2d:     IF SB.ACTION$ = "O" THEN \
10222: 7e48:        SB.FILE.SESS.NUM% = F20.INTEGER.FILE.NO%
10223: 7e5a:     IF SB.ACTION$ = "R" OR SB.ACTION$ = "C" THEN BEGIN
10224: 7ea6:        SB.FILE.REP.NUM% = F20.INTEGER.FILE.NO%
10225: 7eb8:        SB.ERRF$ = CHR$(SHIFT(SB.FILE.REP.NUM%,8)) + \
10226: 7f01:                   CHR$(SHIFT(SB.FILE.REP.NUM%,0))
10227: 7f01:     ENDIF
10228: 7f09: 
10229: 7f09: RETURN
10230: 7f19: 
10231: 7f19: 
10232: 7f19: \******************************************************************************
10233: 7f19: \***
10234: 7f19: \***   Subroutine : SB.BG.MESSAGE
10235: 7f19: \***
10236: 7f19: \***   Purpose    : Display a message to the background screen
10237: 7f19: \***
10238: 7f19: \***   Parameters : 1
10239: 7f19: \***
10240: 7f19: \***      SB.MESSAGE$ = message to be displayed (message will be truncated to
10241: 7f19: \***                    46 characters if the message is longer than 46 chars)
10242: 7f19: \***                    Minus the port letter.
10243: 7f19: \***
10244: 7f19: \***   Output     : 1
10245: 7f19: \***      SB.MESSAGE$ = null
10246: 7f19: \***
10247: 7f19: \***   Error action : log an event 23 and end program
10248: 7f19: \***
10249: 7f19: \******************************************************************************
10250: 7f19: 
10251: 7f19: SB.BG.MESSAGE:
10252: 7f29: 
10253: 7f29:     IF SB.MESSAGE$ = LAST.MESSAGE$ THEN RETURN
10254: 7f53:     LAST.MESSAGE$ = SB.MESSAGE$
10255: 7f6e: 
10256: 7f6e:     SB.MESSAGE$ = MONITORED.PORT$ + ": " + SB.MESSAGE$
10257: 7f99:     SB.MESSAGE$ = LEFT$(SB.MESSAGE$ + STRING$(46, " "), 46)
10258: 7fe3:     CALL ADXSERVE( ADX.RET.CODE%, 26, 0, SB.MESSAGE$)
10259: 801b: 
10260: 801b:     IF ADX.RET.CODE% <> 0 THEN BEGIN
10261: 8036:        SB.EVENT.NO% = 23
10262: 8043:        SB.UNIQUE$ = FN.Z.PACK(STR$(ADX.RET.CODE%),5) + "04   "
10263: 8084:        SB.MESSAGE$ = ""
10264: 8099:        GOSUB SB.LOG.AN.EVENT
10265: 80ab:     ENDIF
10266: 80b3: 
10267: 80b3:     SB.MESSAGE$ = ""
10268: 80c8: 
10269: 80c8: RETURN
10270: 80d8: 
10271: 80d8: 
10272: 80d8: \******************************************************************************
10273: 80d8: \***
10274: 80d8: \***   Subroutine : SB.LOG.AN.EVENT
10275: 80d8: \***
10276: 80d8: \***   Purpose    : General routine to log an event using passed data. If
10277: 80d8: \***                program has been started manually for a re-run then also
10278: 80d8: \***                display a message on the background screen.
10279: 80d8: \***                The event will be preceded by one indicating the port
10280: 80d8: \***                being monitored by the program in error.
10281: 80d8: \***
10282: 80d8: \***   Parameters : 2
10283: 80d8: \***
10284: 80d8: \***      SB.EVENT.NO% = number of event to be logged
10285: 80d8: \***      SB.UNIQUE$   = 10 byte block of data unique to event
10286: 80d8: \***
10287: 80d8: \***   Output     : none
10288: 80d8: \***
10289: 80d8: \***   Error action : none
10290: 80d8: \***
10291: 80d8: \******************************************************************************
10292: 80d8: 
10293: 80d8: SB.LOG.AN.EVENT:
10294: 80e8: 
10295: 80e8:     MESSAGE.NO% = 0
10296: 80f6: 
10297: 80f6:     PORT.STRING$ = "PORT : " + MONITORED.PORT$ + "  "
10298: 811f:     PORT.EVENT% = 75
10299: 812f: 
10300: 812f:     RC% = APPLICATION.LOG(MESSAGE.NO%, PORT.STRING$, "", PORT.EVENT%)
10301: 8162: 
10302: 8162:     RC% = APPLICATION.LOG(MESSAGE.NO%, SB.UNIQUE$, "", SB.EVENT.NO%)
10303: 818e: 
10304: 818e: RETURN
10305: 819e: 
10306: 819e: 
10307: 819e: \******************************************************************************
10308: 819e: \******************************************************************************
10309: 819e: \***                                                                        ***
10310: 819e: \***                                                                        ***
10311: 819e: \***   E R R O R   H A N D L I N G                                          ***
10312: 819e: \***                                                                        ***
10313: 819e: \***                                                                        ***
10314: 819e: \******************************************************************************
10315: 819e: \******************************************************************************
10316: 819e: 
10317: 819e: 
10318: 819e: \******************************************************************************
10319: 819e: \***
10320: 819e: \*** FILE.NOT.FOUND:
10321: 819e: \***
10322: 819e: \******************************************************************************
10323: 819e: 
10324: 819e: FILE.NOT.FOUND:
10325: 81ae: 
10326: 81ae:     IF SB.INTEGER% EQ PRINT.REPORT.NUM% THEN BEGIN                   ! 1.1JAS
10327: 81c3:        GOTO NO.PRINT.FILE                                            ! 1.1JAS
10328: 81ce:     ENDIF                                                            ! 1.1JAS
10329: 81d6: 
10330: 81d6:     MESSAGE.NO% = 501
10331: 81e4:     EVENT.NO% = 106
10332: 81f1:     VAR.STRING.1$ EQ FILE.OPERATION$ + \
10333: 825f:        "O" + CHR$(SHIFT(SB.INTEGER%,8)) + \ ! Two byte integer     ! 1.1JAS
10334: 825f:        CHR$(SHIFT(SB.INTEGER%,0)) + \ ! byte order reversed
10335: 825f:        CURRENT.CODE$
10336: 825f:     VAR.STRING.2$ EQ RIGHT$("000" + STR$(SB.INTEGER%),3)
10337: 82a3:     CALL APPLICATION.LOG (MESSAGE.NO%, VAR.STRING.1$,VAR.STRING.2$, EVENT.NO%)
10338: 82cc: 
10339: 82cc:     GOTO MODULE.EXIT
10340: 82d7: 
10341: 82d7: RETURN
10342: 82e7: 
10343: 82e7: 
10344: 82e7: 
10345: 82e7: \******************************************************************************
10346: 82e7: \***
10347: 82e7: \***  READ.SSPSCTRL.ERROR:
10348: 82e7: \***
10349: 82e7: \******************************************************************************
10350: 82e7: 
10351: 82e7: READ.SSPSCTRL.ERROR:                                                 ! 1.1JAS
10352: 82f7: 
10353: 82f7:     MESSAGE.NO% = 514                                                ! 1.1JAS
10354: 8305:     EVENT.NO% = 106                                                  ! 1.1JAS
10355: 8312: 
10356: 8312:     VAR.STRING.1$ EQ FILE.OPERATION$ + \                             ! 1.1JAS
10357: 8386:        "R" + CHR$(SHIFT(SSPSCTRL.REPORT.NUM%,8)) + \ ! Two byte integer ! 1.1JAS
10358: 8386:        CHR$(SHIFT(SSPSCTRL.REPORT.NUM%,0)) + \ ! byte order reversed ! 1.1JAS
10359: 8386:        PACK$("000000")                        ! to give hex number   ! 1.1JAS
10360: 8386: 
10361: 8386:     VAR.STRING.2$ EQ \                                               ! 1.1JAS
10362: 83e0:        RIGHT$("000" + STR$(SSPSCTRL.REPORT.NUM%),3) + \              ! 1.1JAS
10363: 83e0:       " read SSPSCTRL"                                               ! 1.1JAS
10364: 83e0:     CALL APPLICATION.LOG(MESSAGE.NO%, VAR.STRING.1$, VAR.STRING.2$, EVENT.NO%) ! 1.1JAS
10365: 8409: 
10366: 8409: RETURN                                                               ! 1.1JAS
10367: 8419: 
10368: 8419: \******************************************************************************
10369: 8419: \***
10370: 8419: \***   CREATE.ERROR:
10371: 8419: \***
10372: 8419: \***      log an event 6 (create error)
10373: 8419: \***
10374: 8419: \******************************************************************************
10375: 8419: 
10376: 8419: CREATE.ERROR:
10377: 8429: 
10378: 8429:     SB.EVENT.NO% = 106                                                  ! 1.5BG
10379: 8436:     SB.UNIQUE$ = "C" + CHR$(SHIFT(CURRENT.REPORT.NUM%,8)) +             \ 1.9SH
10380: 84a4:                        CHR$(SHIFT(CURRENT.REPORT.NUM%,0)) +             \ 1.9SH
10381: 84a4:                        STRING$(7,CHR$(0))                               ! 1.9SH
10382: 84a4:     GOSUB SB.LOG.AN.EVENT                                               ! 1.5BG
10383: 84b6: 
10384: 84b6:     GOTO MODULE.EXIT
10385: 84c1:     
10386: 84c1:     
10387: 84c1: \******************************************************************************
10388: 84c1: \***
10389: 84c1: \***   OPEN.ERROR:
10390: 84c1: \***
10391: 84c1: \***      Log an event 6 (open error)
10392: 84c1: \***
10393: 84c1: \******************************************************************************
10394: 84c1: 
10395: 84c1: OPEN.ERROR:                                                             ! 1.5BG
10396: 84d1: 
10397: 84d1:     SB.EVENT.NO% = 106                                                  ! 1.5BG
10398: 84de:     SB.UNIQUE$ = "O" + CHR$(SHIFT(CURRENT.REPORT.NUM%,8)) +             \ 1.9SH
10399: 854c:                        CHR$(SHIFT(CURRENT.REPORT.NUM%,0)) +             \ 1.9SH
10400: 854c:                        STRING$(7,CHR$(0))                               ! 1.9SH
10401: 854c:     GOSUB SB.LOG.AN.EVENT                                               ! 1.5BG
10402: 855e: 
10403: 855e:     GOTO MODULE.EXIT                                                    ! 1.5BG
10404: 8569: 
10405: 8569: 
10406: 8569: \******************************************************************************
10407: 8569: \***
10408: 8569: \***   WRITE.ERROR:
10409: 8569: \***
10410: 8569: \***      log an event 6 (write error)
10411: 8569: \***
10412: 8569: \******************************************************************************
10413: 8569: 
10414: 8569: WRITE.ERROR:
10415: 8579: 
10416: 8579:     SB.EVENT.NO% = 106                                                  ! 1.5BG
10417: 8586:     SB.UNIQUE$ = "W" + CHR$(SHIFT(CURRENT.REPORT.NUM%,8)) +             \ 1.9SH
10418: 862e:                        CHR$(SHIFT(CURRENT.REPORT.NUM%,0)) +             \ 1.9SH
10419: 862e:                        RIGHT$(STRING$(7,CHR$(0)) + CURRENT.CODE$,7)     ! 1.9SH
10420: 862e:     GOSUB SB.LOG.AN.EVENT                                               ! 1.5BG
10421: 8640: 
10422: 8640:     GOTO MODULE.EXIT
10423: 864b: 
10424: 864b: 
10425: 864b: \******************************************************************************
10426: 864b: \***
10427: 864b: \***   READ.ERROR:
10428: 864b: \***
10429: 864b: \***      Log an event 6 (read error)
10430: 864b: \***
10431: 864b: \******************************************************************************
10432: 864b: 
10433: 864b: READ.ERROR:                                                             ! 1.5BG
10434: 865b:     GOSUB READ.ERROR.SUB                                                ! 1.9SH
10435: 866d: GOTO MODULE.EXIT                                                        ! 1.5BG
10436: 8678:     
10437: 8678: READ.ERROR.SUB:                                                         ! 1.9SH
10438: 8688: 
10439: 8688:     SB.EVENT.NO% = 106                                                  ! 1.5BG
10440: 8695:     SB.UNIQUE$ = "R" + CHR$(SHIFT(CURRENT.REPORT.NUM%,8)) +             \ 1.9SH
10441: 873d:                        CHR$(SHIFT(CURRENT.REPORT.NUM%,0)) +             \ 1.9SH
10442: 873d:                        RIGHT$(STRING$(7,CHR$(0)) + CURRENT.CODE$,7)     ! 1.9SH
10443: 873d:     GOSUB SB.LOG.AN.EVENT                                               ! 1.5BG
10444: 874f: 
10445: 874f: RETURN                                                                  ! 1.9SH
10446: 875f: 
10447: 875f:                                                                                
10448: 875f: \******************************************************************************
10449: 875f: \***
10450: 875f: \***   ERROR.DETECTED:
10451: 875f: \***
10452: 875f: \***      obtain file report number and file name from session number ERRF%
10453: 875f: \***
10454: 875f: \***      set-up common error reporting information
10455: 875f: \***
10456: 875f: \***      if an access conflict occurs on a session then retry
10457: 875f: \***
10458: 875f: \***      if error is out of memory then log an event, using ADXERROR and
10459: 875f: \***      quit program
10460: 875f: \***
10461: 875f: \***      log an event 1
10462: 875f: \***
10463: 875f: \***   resume MODULE.EXIT
10464: 875f: \***
10465: 875f: \******************************************************************************
10466: 875f: 
10467: 875f: ERROR.DETECTED:
10468: 876f: 
10469: 876f:     IF ERR = "CU" THEN RESUME                                           ! 1.9SH
10470: 87a4:     
10471: 87a4:     !Simply resume if the error is against these because                ! 1.6BG
10472: 87a4:     !it is handled in the code                                          ! 1.5BG
10473: 87a4:     IF ERRF% = IMSTC.SESS.NUM% OR \                                     ! 1.9SH
10474: 8806:        ERRF% = STOCK.SESS.NUM% OR \                                     ! 1.9SH
10475: 8806:        ERRF% = IDF.SESS.NUM% THEN RESUME                                ! 1.9SH
10476: 881d:        
10477: 881d:     IF ERRN = 80F3400CH AND ERRF% = UB.SESS.NUM% THEN BEGIN             ! 1.9SH
10478: 885c:         IF RETRIES% > 0 THEN BEGIN                                      ! 1.9SH
10479: 886b:             RETRIES% = RETRIES% - 1                                     ! 1.9SH
10480: 8877:             CALL INCREMENT.SUFFIX(FILE.SUFFIX$)                         ! 1.9SH
10481: 888a:             RESUME UB.RETRY                                             ! 1.9SH
10482: 88a1:         ENDIF                                                           ! 1.9SH
10483: 88a9:     ENDIF                                                               ! 1.9SH
10484: 88b1: 
10485: 88b1:     !Make pretend that RENAME simply returned a bad rc                  ! 1.9SH
10486: 88b1:     IF ERR = "FR" THEN BEGIN                                            ! 1.9SH
10487: 88d7:         RC% = 0                                                         ! 1.9SH
10488: 88e8:         RESUME                                                          ! 1.9SH
10489: 88ff:     ENDIF                                                               ! 1.9SH
10490: 8907: 
10491: 8907:     RC% = CONV.TO.HEX( ERRN )
10492: 8927:     IF RC% <> 0 THEN GOTO MODULE.EXIT
10493: 893c:     RC% = CONV.TO.STRING(0, ERRN )
10494: 8960:     IF RC% <> 0 THEN GOTO MODULE.EXIT
10495: 8975:     SB.ERRS$ = F17.RETURNED.STRING$
10496: 8991:     SB.ERRL$ = FN.Z.PACK(STR$(ERRL), 6)
10497: 89c0:     SB.ACTION$ = "R" : SB.INTEGER% = ERRF% : SB.STRING$ = ""
10498: 89ea:     GOSUB SB.FILE.UTILS
10499: 89fc: 
10500: 89fc: 
10501: 89fc:     IF (ERRN AND 0000FFFFh) = 0000400Ch THEN BEGIN
10502: 8a36:        REP% = SB.FILE.REP.NUM%
10503: 8a44:     ENDIF
10504: 8a4c: 
10505: 8a4c:     IF ERR = "OM" THEN BEGIN
10506: 8a75:        SB.UNIQUE$ = SB.ERRS$ + SB.ERRF$ + PACK$(RIGHT$(STRING$(8,"0")+SB.ERRL$,8))
10507: 8ad5:        CALL ADXERROR(0, 74, 0, 3, 101, SB.UNIQUE$ )
10508: 8afd:        RESUME MODULE.EXIT
10509: 8b14:     ENDIF
10510: 8b1c: 
10511: 8b1c:     SB.EVENT.NO% = 101
10512: 8b29:     SB.UNIQUE$ = SB.ERRS$ + SB.ERRF$ + PACK$(RIGHT$(STRING$(8,"0")+SB.ERRL$,8))
10513: 8b89:     GOSUB SB.LOG.AN.EVENT
10514: 8b9b: 
10515: 8b9b:     RESUME MODULE.EXIT
10516: 8bb2: 
10517: 8bb2: END SUB
10518: 8bc6: End of Compilation
