   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   STKEXFUN.BAS  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.3  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************\******************************************************************************
  10: 0000: \******************************************************************************
  11: 0000: \***
  12: 0000: \***              STOCKTAKE EXCEPTIONS FILE FUNCTIONS
  13: 0000: \***
  14: 0000: \***               REFERENCE    : STKEXFUN.BAS
  15: 0000: \***
  16: 0000: \***         VERSION A            Nik Sen         19th June 1997
  17: 0000: \***
  18: 0000: \***         VERSION B         Nik Sen            5th August 1997
  19: 0000: \***         Added Reason Code.
  20: 0000: \***
  21: 0000: \***         VERSION C            Johnnie Chan    11th December 1997
  22: 0000: \***         Added extra digit to location code.
  23: 0000: \***
  24: 0000: \*******************************************************************************
  25: 0000: \*******************************************************************************
  26: 0000: 
  27: 0000:     INTEGER*2 GLOBAL                \
  28: 0000:        CURRENT.REPORT.NUM%
  29: 0000:        
  30: 0000:     STRING GLOBAL                    \
  31: 0000:        CURRENT.CODE$,                \
  32: 0000:        FILE.OPERATION$
  33: 0000:     
  34: 0000:     %INCLUDE STKEXDEC.J86                                              
  35: 0000: \******************************************************************************
  36: 0000: \******************************************************************************
  37: 0000: \***
  38: 0000: \***   $Workfile:   STKEXDEC.J86  $
  39: 0000: \***
  40: 0000: \***   $Revision:   1.1  $
  41: 0000: \***
  42: 0000: \******************************************************************************
  43: 0000: \******************************************************************************
  44: 0000: \***
  45: 0000: \***   $Log:   V:\archive\j86\stkexdec.j8v  $
  46: 0000: \***   
  47: 0000: \***      Rev 1.1   05 Aug 1997 13:49:18   DEV45PS
  48: 0000: \***   Added Reason Code
  49: 0000: \***   
  50: 0000: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
  51: 0000: \***    
  52: 0000: \***   
  53: 0000: \***      Rev 1.0   09 Jul 1997 11:05:04   DEV45PS
  54: 0000: \***   Stocktake System New Files
  55: 0000: \***   
  56: 0000: \******************************************************************************
  57: 0000: \******************************************************************************\******************************************************************************
  58: 0000: \******************************************************************************
  59: 0000: \***
  60: 0000: \***         %INCLUDE FOR STOCKTAKE EXCEPTIONS FILE FIELD DECLARATIONS
  61: 0000: \***
  62: 0000: \***               FILE TYPE    : DIRECT
  63: 0000: \***
  64: 0000: \***               REFERENCE    : STKEXDEC.J86
  65: 0000: \***
  66: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
  67: 0000: \***    New file for stocktaking system. Holds all counted items which  
  68: 0000: \***    are not on the IDF.
  69: 0000: \***
  70: 0000: \***    VERSION B              Nik Sen                 5th August 1997
  71: 0000: \***    Added reason code.
  72: 0000: \***
  73: 0000: \*******************************************************************************
  74: 0000: \*******************************************************************************
  75: 0000: 
  76: 0000: STRING GLOBAL                                                  \
  77: 0000:    STKEX.FILE.NAME$,            \
  78: 0000:    STKEX.ITEM.CODE$,           \
  79: 0000:    STKEX.QUANTITY$,            \
  80: 0000:    STKEX.LOCATION$,            \
  81: 0000:    STKEX.STOCKTAKER.NUM$,      \
  82: 0000:    STKEX.REASON.CODE$
  83: 0000: 
  84: 0000: 
  85: 0000: INTEGER*4 GLOBAL               \
  86: 0000:        STKEX.RECORD.NUM%
  87: 0000: 
  88: 0000: INTEGER*2 GLOBAL                \
  89: 0000:    STKEX.REPORT.NUM%,           \
  90: 0000:    STKEX.SESS.NUM%             
  91: 0000: 
  92: 0000: 
  93: 0000: INTEGER*1 GLOBAL                \
  94: 0000:    STKEX.RECL%         
  95: 0000: 
  96: 0000: 
  97: 0000: 
  98: 0000:   FUNCTION STKEX.SET PUBLIC
  99: 0014: \***************************
 100: 0014: 
 101: 0014:     STKEX.REPORT.NUM% = 527
 102: 001d:     STKEX.RECL%       = 18                     !*Ver C*
 103: 0025:     STKEX.FILE.NAME$  = "STKEX"
 104: 0034:     
 105: 0034:   END FUNCTION
 106: 0040:     
 107: 0040: \-----------------------------------------------------------------------------
 108: 0040: 
 109: 0040: FUNCTION READ.STKEX PUBLIC
 110: 0054: \****************************
 111: 0054: 
 112: 0054:     INTEGER*2 READ.STKEX
 113: 0054:     
 114: 0054:     READ.STKEX = 1
 115: 0059:     
 116: 0059:     IF END #STKEX.SESS.NUM% THEN READ.STKEX.ERROR
 117: 006d:     READ FORM "C7,C3,C5,C2,C1"; #STKEX.SESS.NUM%, STKEX.RECORD.NUM%;  \*Ver C*
 118: 00cb:        STKEX.ITEM.CODE$,                       \
 119: 00cb:        STKEX.QUANTITY$,                        \
 120: 00cb:        STKEX.LOCATION$,                        \
 121: 00cb:        STKEX.STOCKTAKER.NUM$,                  \
 122: 00cb:        STKEX.REASON.CODE$
 123: 00cb: 
 124: 00cb:     READ.STKEX = 0
 125: 00d0:     EXIT FUNCTION
 126: 00d2:     
 127: 00d2: READ.STKEX.ERROR:
 128: 00d2:     
 129: 00d2: 
 130: 00d2:        FILE.OPERATION$ = "R"
 131: 00e1:        CURRENT.REPORT.NUM% = STKEX.REPORT.NUM%
 132: 00ef:        
 133: 00ef:        EXIT FUNCTION
 134: 00f1: 
 135: 00f1: END FUNCTION
 136: 0100: 
 137: 0100: \-----------------------------------------------------------------------------
 138: 0100:   
 139: 0100: 
 140: 0100: FUNCTION WRITE.STKEX PUBLIC
 141: 0114: \****************************
 142: 0114: 
 143: 0114:     INTEGER*2 WRITE.STKEX
 144: 0114:     
 145: 0114:     WRITE.STKEX = 1
 146: 0119:     
 147: 0119:     IF END #STKEX.SESS.NUM% THEN WRITE.STKEX.ERROR
 148: 012d:     WRITE FORM "C7,C3,C5,C2,C1"; #STKEX.SESS.NUM%, STKEX.RECORD.NUM%; \*Ver C*
 149: 019f:        STKEX.ITEM.CODE$,                       \
 150: 019f:        STKEX.QUANTITY$,                        \
 151: 019f:        STKEX.LOCATION$,                        \
 152: 019f:        STKEX.STOCKTAKER.NUM$,                  \
 153: 019f:        STKEX.REASON.CODE$
 154: 019f: 
 155: 019f:     WRITE.STKEX = 0
 156: 01a4:     EXIT FUNCTION
 157: 01a6:     
 158: 01a6: WRITE.STKEX.ERROR:
 159: 01a6:     
 160: 01a6: 
 161: 01a6:        FILE.OPERATION$ = "R"
 162: 01b5:        CURRENT.REPORT.NUM% = STKEX.REPORT.NUM%
 163: 01c3:        
 164: 01c3:        EXIT FUNCTION
 165: 01c5: 
 166: 01c5: END FUNCTION
 167: 01d4: 
 168: 01d4: End of Compilation
