   1: 0000: \******************************************************************************
   2: 0000: \******************************************************************************
   3: 0000: \***
   4: 0000: \***   $Workfile:   PSS3703.bas  $
   5: 0000: \***
   6: 0000: \***   $Revision:   1.6  $
   7: 0000: \***
   8: 0000: \******************************************************************************
   9: 0000: \******************************************************************************
  10: 0000: \***
  11: 0000: \***   $Log:   V:/Archive/Basarch/PSS3703.bav  $
  12: 0000: \***   
  13: 0000: \***      Rev 1.6   17 Jul 2003 10:09:04   dev38ps
  14: 0000: \***   Commented out IRF which is now in the global definitions file
  15: 0000: \***   
  16: 0000: \***      Rev 1.5   Apr 14 2000 17:29:12   dev26ps
  17: 0000: \***   Removed references to INDICAT2 pricing
  18: 0000: \***   method and relinked with new PSBF19.
  19: 0000: \***   Stuart William McConnachie.
  20: 0000: \***   
  21: 0000: \***      Rev 1.4   08 Apr 1998 11:08:04   DEV45PS
  22: 0000: \***   Changes to cope with dates of '000000' and '999999' and to include revised CMPDATE
  23: 0000: \***   
  24: 0000: \***      Rev 1.3   05 Feb 1998 11:58:14   DEV45PS
  25: 0000: \***    
  26: 0000: \***   
  27: 0000: \***      Rev 1.2   14 Feb 1995 11:44:20   NIK
  28: 0000: \***   Fixes to Boots Problems 1248, 1245, 1246, 1318, 1105
  29: 0000: \***   
  30: 0000: \***      Rev 1.1   07 Oct 1994 15:51:38   DEVSPPS
  31: 0000: \***   Fixed PDT Support hang
  32: 0000: \***   
  33: 0000: \******************************************************************************
  34: 0000: \******************************************************************************
  35: 0000: 
  36: 0000: REM
  37: 0000: \******************************************************************************
  38: 0000: \******************************************************************************
  39: 0000: \***                                                                        ***
  40: 0000: \***                                                                        ***
  41: 0000: \***                                                                        ***
  42: 0000: \***           PROGRAM  :  PSS3703                                          ***
  43: 0000: \***                                                                        ***
  44: 0000: \***           AUTHOR   :  Les Cook                                         ***
  45: 0000: \***                                                                        ***
  46: 0000: \***           DATE     :  16th March 1993                                  ***
  47: 0000: \***                                                                        ***
  48: 0000: \***                                                                        ***
  49: 0000: \***           Current version letter : D                                   ***
  50: 0000: \***                                                                        ***
  51: 0000: \***    Date of last change;  2nd February 1994            Nik Sen          ***
  52: 0000: \***                                                                        ***
  53: 0000: \******************************************************************************
  54: 0000: \******************************************************************************
  55: 0000: 
  56: 0000: \******************************************************************************
  57: 0000: \******************************************************************************
  58: 0000: \***                                                                        ***
  59: 0000: \***   O V E R V I E W                                                      ***
  60: 0000: \***                                                                        ***
  61: 0000: \***                                                                        ***
  62: 0000: \***   PSS37 - P.D.T Support Program.                                       ***
  63: 0000: \***                                                                        ***
  64: 0000: \***                                                                        ***
  65: 0000: \***   PSS37 is designed to run concurrently with PSS38. PSS38 handles      ***
  66: 0000: \***   all asyncronous communications with a connected PDT. All data        ***
  67: 0000: \***   sent by the PDT is passed to PSS37 via PSS38 by means of a 'pipe'.   ***
  68: 0000: \***   PSS37 validates the data sent to ensure the data has been sent in    ***
  69: 0000: \***   the correct sequence, has a valid format and is meaningful.          ***
  70: 0000: \***   the correct sequence, has a valid format and is meaningful.          ***
  71: 0000: \***   There are basically two processes PSS37 performs ;                   ***
  72: 0000: \***   i)  takes counts from a PDT and puts them in the stock movement,     ***
  73: 0000: \***   ii) creates a file of lists requested by a PDT.                      ***
  74: 0000: \***                                                                   ***       
  75: 0000: \***   This module was created to contain the bulk of the processing for    ***       
  76: 0000: \***   the EPSOM PDT application. This has been moved from module 0 to      ***
  77: 0000: \***   allow for future applications.                                        ***
  78: 0000: \***                                                                        ***
  79: 0000: \***   Version B.       Michael J. Kelsall           12th October 1993      ***
  80: 0000: \***   Changes to include processing of LDTAF records.                      ***
  81: 0000: \***                                                                        ***
  82: 0000: \***   Version C.       Michael J. Kelsall           23rd March 1994        ***
  83: 0000: \***   Change to LDTAF duration to record in seconds as opposed to minutes  ***
  84: 0000: \***                                                                        ***
  85: 0000: \***   REVISION 1.1     ROBERT COWEY / STEVE WRIGHT      6TH OCTOBER 1994 
  86: 0000: \***   Removed version letters from included code (not commented).
  87: 0000: \***
  88: 0000: \***   Version D (1.2)         Nik Sen                 26th January 1995
  89: 0000: \***   Amendments to Error.Detected to handle STKMQ access conflict errors.
  90: 0000: \***   Also now logs event 101 instead of event 1.                      
  91: 0000: \***   Error trap introduced to detect 'File cannot be accessed due to current
  92: 0000: \***   usage' error against PDTWF when a create is attempted. The create fails
  93: 0000: \***   as PSS38 is holding the file open. Program now returns to data state 'A'. 
  94: 0000: \***   Amendment to RECEIVED.EPSOM.LIST.COUNT to trap invalid time from PDT.
  95: 0000: \***   Changed SB.FILE.REP.NUM% to 2 byte integer.
  96: 0000: \***
  97: 0000: \***   Version E (1.3)         Nik Sen                 19th November 1997
  98: 0000: \***   Y2000 changes. Comparisons in PROCESS.AN.EPSOM.LIST. Sort in 
  99: 0000: \***   SORT.EPSOM.TRANSMISSION.LIST.
 100: 0000: \***
 101: 0000: \***   Version F (1.4)         Nik Sen                 1st April 1998
 102: 0000: \***   Changed so Y2000 code copes with dates of '000000' or '999999'. 
 103: 0000: \***   (No joke - despite todays date). 
 104: 0000: \***
 105: 0000: \***   Version G        Stuart William McConnachie      3rd March 2000
 106: 0000: \***   Updated IRF fields for meal deal.
 107: 0000: \***
 108: 0000: \******************************************************************************
 109: 0000: \******************************************************************************
 110: 0000: 
 111: 0000: 
 112: 0000: \******************************************************************************
 113: 0000: \******************************************************************************
 114: 0000: \***                                                                        ***
 115: 0000: \***   I N C L U D E S   A N D   V A R I A B L E S                          ***
 116: 0000: \***                                                                        ***
 117: 0000: \******************************************************************************
 118: 0000: \******************************************************************************
 119: 0000: 
 120: 0000:    %INCLUDE PSBF06G.J86
 121: 0000: REM\
 122: 0000: \*******************************************************************************
 123: 0000: \*******************************************************************************
 124: 0000: \***
 125: 0000: \***        INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT globals
 126: 0000: \***
 127: 0000: \***        REFERENCE     : PSBF06G.J86
 128: 0000: \***
 129: 0000: \***        Version A     Bruce Scriver                 24th February 1986 
 130: 0000: \***
 131: 0000: \***        Version B     Andrew Wedgeworth                 15th July 1992
 132: 0000: \***        Removal of return code field which no longer required.
 133: 0000: \***
 134: 0000: \*******************************************************************************
 135: 0000: \*******************************************************************************
 136: 0000: 
 137: 0000:       STRING   GLOBAL F06.CHECK.DIGIT$
 138: 0000: 
 139: 0000: 
 140: 0000:    %INCLUDE ASYNCNUB.J86
 141: 0000: 
 142: 0000: \******************************************************************************
 143: 0000: \******************************************************************************
 144: 0000: \***
 145: 0000: \***          %INCLUDE FOR ASYNC PDT LINK (STOCK COUTING - PSS37)
 146: 0000: \***
 147: 0000: \***                         LINK TYPE : ASYNC
 148: 0000: \***
 149: 0000: \***                     REFERENCE : ASYNCNUM.J86
 150: 0000: \***
 151: 0000: \******************************************************************************
 152: 0000: \******************************************************************************
 153: 0000: 
 154: 0000:    STRING GLOBAL							\
 155: 0000: 	ASYNC.FILE.NAME$,						\
 156: 0000: 	ASYNC.OPEN.FLAG$
 157: 0000: 	
 158: 0000:    INTEGER*1 GLOBAL							\
 159: 0000: 	ASYNC.REPORT.NUM%,						\
 160: 0000: 	ASYNC.SESS.NUM%
 161: 0000:    %INCLUDE EPSOMDEC.J86
 162: 0000: REM \
 163: 0000: \******************************************************************************
 164: 0000: \******************************************************************************
 165: 0000: \***
 166: 0000: \***         %INCLUDE FOR EPSOM DUMMY FILE - FILE REFERENCE PARAMETERS
 167: 0000: \***
 168: 0000: \***               REFERENCE    : EPSOMDEC.J86
 169: 0000: \***
 170: 0000: \******************************************************************************
 171: 0000: \*******************************************************************************
 172: 0000: 
 173: 0000:   STRING GLOBAL           \
 174: 0000:     EPSOM.FILE.NAME$
 175: 0000: 
 176: 0000:   INTEGER*2 GLOBAL        \
 177: 0000:     EPSOM.REPORT.NUM%,      \
 178: 0000:     EPSOM.SESS.NUM%
 179: 0000:    %INCLUDE PDTWFDEC.J86
 180: 0000: REM \
 181: 0000: \******************************************************************************
 182: 0000: \******************************************************************************
 183: 0000: \***
 184: 0000: \***            %INCLUDE FOR PDT WORK FILE - FIELD DECLARATIONS
 185: 0000: \***                                         FILE REFERENCE PARAMETERS
 186: 0000: \***
 187: 0000: \***                          8th October 1992
 188: 0000: \***
 189: 0000: \******************************************************************************
 190: 0000: \*******************************************************************************
 191: 0000: 
 192: 0000:   STRING GLOBAL								\
 193: 0000:         PDTWF.RECORD$,							\
 194: 0000: 	PDTWF.FILE.NAME$
 195: 0000: 
 196: 0000:   INTEGER*2 GLOBAL							\
 197: 0000: 	PDTWF.SESS.NUM%,						\
 198: 0000: 	PDTWF.REPORT.NUM%
 199: 0000:    %INCLUDE PIPEONUB.J86
 200: 0000: 
 201: 0000: \******************************************************************************
 202: 0000: \******************************************************************************
 203: 0000: \***
 204: 0000: \***                  %INCLUDE FOR PSS38 OUTPUT PIPE
 205: 0000: \***
 206: 0000: \***                         LINK TYPE : PIPEO
 207: 0000: \***
 208: 0000: \***                     REFERENCE : PIPEONUM.J86
 209: 0000: \***
 210: 0000: \******************************************************************************
 211: 0000: \******************************************************************************
 212: 0000: 
 213: 0000:    STRING GLOBAL							\
 214: 0000: 	PIPEO.FILE.NAME$
 215: 0000: 	
 216: 0000:    INTEGER*1 GLOBAL							\
 217: 0000: 	PIPEO.REPORT.NUM%,						\
 218: 0000: 	PIPEO.SESS.NUM%
 219: 0000: 
 220: 0000:    %INCLUDE PSS37G.J86                                                 \ CMJK
 221: 0000: \*****************************************************************************
 222: 0000: \*****************************************************************************
 223: 0000: \***                                                                       ***
 224: 0000: \***      G L O B A L   D E F I N I T I O N S   F O R   P S S 3 7          ***
 225: 0000: \***                                                                       ***
 226: 0000: \***           REFERENCE : PSS37G                                          ***
 227: 0000: \***                                                                       ***
 228: 0000: \***           VERSION E                                                   ***
 229: 0000: \***           5th November 1992                                           ***
 230: 0000: \***           Ver D.  Add support for ADXSERCL routine.                   ***
 231: 0000: \***           Ver E.  Add support for LDTBF                               ***
 232: 0000: \***                                                                       ***
 233: 0000: \***                                                                       ***
 234: 0000: \***           Version G                                                   ***
 235: 0000: \***           Add support for Returns/Automatic credit claiming           ***
 236: 0000: \***                                                                       ***
 237: 0000: \***           Version H  Michael J. Kelsall    24th March 1994.           ***
 238: 0000: \***           Add support for CCUPF                                       ***
 239: 0000: \***
 240: 0000: \***           REVISION 1.1  ROBERT COWEY / STEVE WRIGHT  6TH OCTOBER 1994
 241: 0000: \***           Removed version letters from included code (not commented).
 242: 0000: \***
 243: 0000: \***           REVISION 1.2  David Smallwood    26th May 1995
 244: 0000: \***           Add global variable ALLOW.CSR.PROCESSING.
 245: 0000: \***
 246: 0000: \***           REVISION 1.3  Stuart Highly      April 1996
 247: 0000: \***           Gap monitor changes
 248: 0000: \***
 249: 0000: \***           REVISION 1.4  David Smallwood    21st May 1996
 250: 0000: \***           Change global variable "NUM.OF.UODS%" to
 251: 0000: \***           "NUM.STATUS.O.C.X.UODS%".  Add variables "NUM.OF.CANCELLED.UODS%"
 252: 0000: \***           "NUM.OF.DESPATCHED.UODS%".  Add global variables for CCLAM.
 253: 0000: \***
 254: 0000: \***           REVISION 1.5  Nik Sen            30th June 1997
 255: 0000: \***           Add variables for SXTMP STKTK and STKBUF for stocktaking.
 256: 0000: \***
 257: 0000: \***           REVISION 1.6  David Artiss       23rd January 2001
 258: 0000: \***           Add new audit file STLDT
 259: 0000: \***
 260: 0000: \***           REVISION 1.7  Brian Greenfield   17th October 2002
 261: 0000: \***           Added LSSST and IMSTC for LSS stock counts.
 262: 0000: \***
 263: 0000: \***           REVISION 1.8  David Artiss       7th March 2003
 264: 0000: \***           Lots of file and field definitions added for BOL
 265: 0000: \***           stocktake changes.
 266: 0000: \***
 267: 0000: \***           REVISION 1.9  Brian Greenfield   18th July 2003
 268: 0000: \***           New file additions for Store Stock Counts
 269: 0000: \***
 270: 0000: \***           REVISION 2.0  Julia Stones      22nd October 2003
 271: 0000: \***           New file additions for SmartScript Pharmacy Stock system
 272: 0000: \***
 273: 0000: \***           REVISION 2.1  Julia Stones      12th November 2003
 274: 0000: \***           New file additions for Simplification of the credit claim system
 275: 0000: \***
 276: 0000: \***           REVISION 2.2 Julia Stones       12th March 2004
 277: 0000: \***           New file addition for Credit Claim rejection information
 278: 0000: \***
 279: 0000: \***           REVISION 2.3 Charles Skadorwa   10th November 2004
 280: 0000: \***           Shelf Monitor Project: add declarations for PLLOL & PLLDB files
 281: 0000: \***
 282: 0000: \***           REVISION 2.4 Brian Greenfield   11th January 2005
 283: 0000: \***           Fixes to allow old record type P and new record type P to both work.
 284: 0000: \***           The old record type P can be removed next time this module is
 285: 0000: \***           altered.
 286: 0000: \***
 287: 0000: \***           REVISION 2.5    Neil Bennett    22nd December 2006
 288: 0000: \***           Add ASN processing support.
 289: 0000: \***           Remove CSR processing support.
 290: 0000: \***
 291: 0000: \***           REVISION 2.6    Brian Greenfield 11th may 2007
 292: 0000: \***           Added recalls processing for A7C.
 293: 0000: \***
 294: 0000: \*****************************************************************************
 295: 0000: \*****************************************************************************
 296: 0000: 
 297: 0000: \*****************************************************************************
 298: 0000: \***   include global definitions for the following functions and procedures
 299: 0000: \***
 300: 0000: \***     APPLICATION.LOG              01
 301: 0000: \***     READ.NEXT.IEF                11
 302: 0000: \***     SORT.TABLE                   14
 303: 0000: \***     CONV.TO.HEX                  16
 304: 0000: \***     CONV.TO.STRING               17
 305: 0000: \***     SESS.NUM.UTILITY             20
 306: 0000: \***     CIMF
 307: 0000: \***     CITEM
 308: 0000: \***     CSR
 309: 0000: \***     CSRWF
 310: 0000: \***     CSRBF
 311: 0000: \***     FPF
 312: 0000: \***     IDF
 313: 0000: \***     IDSOF
 314: 0000: \***     INVOK
 315: 0000: \***     ONORD
 316: 0000: \***     PCHK
 317: 0000: \***     PIPEI
 318: 0000: \***     UNITS
 319: 0000: \***     STKMQ
 320: 0000: \***     BCSMF
 321: 0000: \***     IEF
 322: 0000: \***     DIRORD
 323: 0000: \***     DIRSUP
 324: 0000: \***     DIRWF
 325: 0000: \***     DIR
 326: 0000: \***     LDTBF
 327: 0000: \***     LDTCF
 328: 0000: \***     UOD
 329: 0000: \***     UODBF
 330: 0000: \***     UODTF
 331: 0000: \***     STKBF
 332: 0000: \***     SXTMP
 333: 0000: \***     STKTK
 334: 0000: \***     SSPSC
 335: 0000: \***     BTCS
 336: 0000: \***     PRINT
 337: 0000: \***     SOPTS
 338: 0000: \***     TSF
 339: 0000: \***     LOCAL
 340: 0000: \***
 341: 0000: \*****************************************************************************
 342: 0000: 
 343: 0000:  %INCLUDE PSBF01G.J86                     ! FLC
 344: 0000: REM \
 345: 0000: \*******************************************************************************
 346: 0000: \*******************************************************************************
 347: 0000: \***
 348: 0000: \***       %INCLUDE FOR GLOBAL DEFINITIONS FOR FUNCTION APPLICATION.LOG
 349: 0000: \***
 350: 0000: \***                FUNCTION NUMBER    : PSBF01
 351: 0000: \***
 352: 0000: \***                REFERENCE          : PSBF01G.J86
 353: 0000: \***
 354: 0000: \***                DATE OF LAST AMENDMENT  - 27/2/86
 355: 0000: \***
 356: 0000: \***
 357: 0000: \*******************************************************************************
 358: 0000: 
 359: 0000:       INTEGER GLOBAL  F01.RETURN.CODE%
 360: 0000: 
 361: 0000: 
 362: 0000:  %INCLUDE PSBF05G.J86                     ! 1.9BG
 363: 0000: REM\
 364: 0000: \*******************************************************************************
 365: 0000: \*******************************************************************************
 366: 0000: \***
 367: 0000: \***        INCLUDE       : CHECK.BOOTS.CODE globals
 368: 0000: \***
 369: 0000: \***        REFERENCE     : PSBF05G.J86
 370: 0000: \***
 371: 0000: \***        Version A      Bruce Scriver              25th February 1986
 372: 0000: \*** 
 373: 0000: \***        Version B      Andrew Wedgeworth              15th July 1992
 374: 0000: \***        Removal of return code field which no longer required.
 375: 0000: \***
 376: 0000: \*******************************************************************************
 377: 0000: \*******************************************************************************
 378: 0000: 
 379: 0000:       STRING   GLOBAL F05.VALID.CODE$
 380: 0000: 
 381: 0000: 
 382: 0000: !%INCLUDE PSBF06G.J86                     ! FLC
 383: 0000:  %INCLUDE PSBF11G.J86                     ! DLC
 384: 0000: REM \
 385: 0000: \*******************************************************************************
 386: 0000: \*******************************************************************************
 387: 0000: \***
 388: 0000: \***    %INCLUDE FOR GLOBALS DEFINITIONS FOR FUNCTION READ.NEXT.IEF
 389: 0000: \***
 390: 0000: \***            FUNCTION NUMBER    : PSBF11
 391: 0000: \***
 392: 0000: \***            REFERENCE          : PSBF11G.J86
 393: 0000: \***
 394: 0000: \***    Version B            Bruce Scriver             11th December 1986 
 395: 0000: \***
 396: 0000: \***    Version C            Andrew Wedgeworth             15th July 1992
 397: 0000: \***    Redundant return code field removed.
 398: 0000: \***
 399: 0000: \*******************************************************************************
 400: 0000: \*******************************************************************************
 401: 0000: 
 402: 0000:       STRING    GLOBAL  F11.ERROR.FLAG$,                               \ BBAAS
 403: 0000:                         F11.NEXT.BAR.CODE$                             ! BBAAS
 404: 0000: 
 405: 0000:       INTEGER*2 GLOBAL  F11.CURRENT.COUNT%
 406: 0000: 
 407: 0000: 
 408: 0000:  %INCLUDE PSBF14G.J86                     ! DLC
 409: 0000: REM\
 410: 0000: \*******************************************************************************
 411: 0000: \*******************************************************************************
 412: 0000: \***
 413: 0000: \***        INCLUDE       : SORT.TABLE globals
 414: 0000: \***
 415: 0000: \***        REFERENCE     : PSBF14G.J86
 416: 0000: \***
 417: 0000: \***        Version A     Bruce Scriver                3rd March 1986
 418: 0000: \*** 
 419: 0000: \***        Version B     Andrew Wedgeworth            17th July 1992
 420: 0000: \***        Removal of now redundant return code field.
 421: 0000: \***
 422: 0000: \*******************************************************************************
 423: 0000: \*******************************************************************************
 424: 0000: 
 425: 0000:       STRING   GLOBAL F14.TABLE$(1)
 426: 0000: 
 427: 0000: 
 428: 0000:  %INCLUDE PSBF16G.J86                     ! DLC
 429: 0000: REM\
 430: 0000: \*******************************************************************************
 431: 0000: \*******************************************************************************
 432: 0000: \***
 433: 0000: \***           %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.HEX FUNCTION
 434: 0000: \***
 435: 0000: \***                       REFERENCE     : PSBF16G.J86
 436: 0000: \*** 
 437: 0000: \***       Version A           Bruce Scriver            25th February 1986
 438: 0000: \***
 439: 0000: \***       Version B         Andrew Wedgeworth               2nd July 1992
 440: 0000: \***       Removal of now redundant F16.RETURN.CODE%.
 441: 0000: \***
 442: 0000: \*******************************************************************************
 443: 0000: \*******************************************************************************
 444: 0000: 
 445: 0000:       STRING   GLOBAL F16.HEX.STRING$
 446: 0000: 
 447: 0000:       ! 1 line deleted from here                                       ! BAW
 448: 0000:  %INCLUDE PSBF17G.J86                     ! DLC
 449: 0000: REM \
 450: 0000: \*******************************************************************************
 451: 0000: \*******************************************************************************
 452: 0000: \***
 453: 0000: \***
 454: 0000: \***        %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.STRING FUNCTION
 455: 0000: \***
 456: 0000: \***                    REFERENCE     : PSBF17G.J86
 457: 0000: \***
 458: 0000: \***        Version A         Bruce Scriver      24th February 1986
 459: 0000: \***
 460: 0000: \***        Version B       Andrew Wedgeworth         2nd July 1992
 461: 0000: \***        Removal of now redundant F17.RETURN.CODE%
 462: 0000: \***
 463: 0000: \*******************************************************************************
 464: 0000: \*******************************************************************************
 465: 0000: 
 466: 0000:       STRING   GLOBAL F17.RETURNED.STRING$
 467: 0000: 
 468: 0000:       ! 1 line deleted from here                                       ! BAW
 469: 0000: 
 470: 0000:  %INCLUDE PSBF18G.J86                     ! 1.8DA
 471: 0000: REM\
 472: 0000: \*******************************************************************************
 473: 0000: \*******************************************************************************
 474: 0000: \***
 475: 0000: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT globals
 476: 0000: \***
 477: 0000: \***        REFERENCE     : PSBF18G.J86
 478: 0000: \***
 479: 0000: \***        Version A     Stephen Kelsey                  23rd March 1987
 480: 0000: \***
 481: 0000: \***        Version B     Andrew Wedgeworth                 7th July 1992
 482: 0000: \***        Removal of return code field which no longer required.
 483: 0000: \***
 484: 0000: \*******************************************************************************
 485: 0000: \*******************************************************************************
 486: 0000: 
 487: 0000:       STRING   GLOBAL F18.CHECK.DIGIT$
 488: 0000:     
 489: 0000:       ! 1 line deleted from here                                       ! BAW    
 490: 0000: 
 491: 0000:  %INCLUDE PSBF20G.J86                     ! DLC
 492: 0000: REM\
 493: 0000: \*******************************************************************************
 494: 0000: \*******************************************************************************
 495: 0000: \***
 496: 0000: \***     %INCLUDE GLOBAL VARIABLE DEFINITIONS FOR SESS.NUM.UTILITY FUNCTION
 497: 0000: \***
 498: 0000: \***                       REFERENCE     : PSBF20G.J86
 499: 0000: \*** 
 500: 0000: \***     Version A              Bruce Scrive                   5th May 1988   
 501: 0000: \*** 
 502: 0000: \***     Version B              Robert Cowey                   7th May 1991
 503: 0000: \***     Global variable F20.INTEGER.FILE.NO% changed from one byte integer
 504: 0000: \***     to two byte integer.
 505: 0000: \***
 506: 0000: \***     Version D              Andrew Wedgeworth             1st July 1992
 507: 0000: \***     F20.RETURN.CODE% removed as it is no longer required.
 508: 0000: \***
 509: 0000: \*******************************************************************************
 510: 0000: \*******************************************************************************
 511: 0000: 
 512: 0000:       STRING    GLOBAL F20.FILE.NAME$,                                 \
 513: 0000:                        F20.STRING.FILE.NO$,                            \
 514: 0000:                        F20.TABLE.DIMENSIONED.FLAG$,                    \
 515: 0000:                        SESS.NUM.TABLE$(1)
 516: 0000: 
 517: 0000:       INTEGER*2 GLOBAL F20.INTEGER.FILE.NO%
 518: 0000: 
 519: 0000:       ! 1 line deleted from here                                       ! DAW 
 520: 0000: 
 521: 0000:  %INCLUDE PSBF21G.J86                     ! 1.9BG
 522: 0000: REM\
 523: 0000: \*******************************************************************************
 524: 0000: \*******************************************************************************
 525: 0000: \***
 526: 0000: \***        INCLUDE       : CHECK.BAR.CODE globals
 527: 0000: \***
 528: 0000: \***        REFERENCE     : PSBF21G.J86
 529: 0000: \***
 530: 0000: \***        Version A     Bruce Scriver                  13th May 1988
 531: 0000: \***
 532: 0000: \***        Version B     Andrew Wedgeworth             21st July 1992
 533: 0000: \***        Return code removed as no longer used.
 534: 0000: \***
 535: 0000: \*******************************************************************************
 536: 0000: \*******************************************************************************
 537: 0000: 
 538: 0000:       STRING    GLOBAL F21.VALID.CODE.FLAG$
 539: 0000: 
 540: 0000: 
 541: 0000: 
 542: 0000: !%INCLUDE ASYNCNUB.J86                    ! FLC
 543: 0000:  %INCLUDE CHKBFDEC.J86                    ! DLC
 544: 0000: \******************************************************************************
 545: 0000: \***
 546: 0000: \***           %INCLUDE FOR CHKBF - PRICE CHECK BUFFER FILE
 547: 0000: \***
 548: 0000: \***                    - FIELD DECLARATIONS   
 549: 0000: \***                    - FILE REFERENCE PARAMETERS  
 550: 0000: \***  
 551: 0000: \***                    REFERENCE: CHKBFDEC.J86
 552: 0000: \***
 553: 0000: \******************************************************************************
 554: 0000: 
 555: 0000:    INTEGER*1 GLOBAL				\
 556: 0000: 	CHKBF.SESS.NUM%
 557: 0000: 
 558: 0000:    INTEGER*2 GLOBAL				\
 559: 0000: 	CHKBF.RECL%,                            \
 560: 0000:         CHKBF.REPORT.NUM% 	
 561: 0000: 
 562: 0000:    INTEGER*4 GLOBAL				\ DLC
 563: 0000:         CHKBF.POINTER%
 564: 0000: 	
 565: 0000:    STRING GLOBAL			\
 566: 0000: 	CHKBF.ITEM.CODE$,	\ 13 byte ASC - bar code, as passed from PDT
 567: 0000: 	CHKBF.PRICE$,		\  6 byte ASC - price, as passed from PDT 
 568: 0000: 	CHKBF.FILLER$,		\  1 byte ASC - spare
 569: 0000: 	CHKBF.FILE.NAME$
 570: 0000:  %INCLUDE GAPBFDEC.J86                    ! SDH !2.3CS !2.4BG
 571: 0000: \*****************************************************************************
 572: 0000: \***                                                                         *
 573: 0000: \***           %INCLUDE FOR GAPBF - GAP BUFFER FILE                          *
 574: 0000: \***                                                                         *
 575: 0000: \***                    - FIELD DECLARATIONS                                 *
 576: 0000: \***                    - FILE REFERENCE PARAMETERS                          *
 577: 0000: \***                                                                         *
 578: 0000: \***                    REFERENCE: GAPBFDEC.J86                              *
 579: 0000: \***                                                                         *
 580: 0000: \*****************************************************************************
 581: 0000: 
 582: 0000:    INTEGER*1 GLOBAL            \
 583: 0000:    GAPBF.SESS.NUM%
 584: 0000: 
 585: 0000:    INTEGER*2 GLOBAL            \   
 586: 0000:    GAPBF.REPORT.NUM%    
 587: 0000: 
 588: 0000:    STRING GLOBAL               \
 589: 0000:    GAPBF.BOOTS.CODE$,          \ 7 bytes ASC - Item code
 590: 0000:    GAPBF.FILE.NAME$
 591: 0000:  %INCLUDE PLLOLDEC.J86                    ! 2.3CS
 592: 0000: 
 593: 0000: \******************************************************************************
 594: 0000: \******************************************************************************
 595: 0000: \***
 596: 0000: \***         %INCLUDE FOR RF PICKING LIST OF LISTS FILE FIELD DECLARATIONS
 597: 0000: \***
 598: 0000: \***               FILE TYPE    : DIRECT
 599: 0000: \***
 600: 0000: \***               REFERENCE    : PLLOLDEC.J86
 601: 0000: \***
 602: 0000: \***    VERSION A.           Julia Stones.               11 August 2004
 603: 0000: \***               New file for RF system. Holds list of picking lists.
 604: 0000: \***
 605: 0000: \***    VERSION B            Mark Goode                  17th January 2005
 606: 0000: \***    Additional field required to state the lists status ('S' - Shelf Monitor
 607: 0000: \***    'F' - Fast Fill, 'O' - OSSR or 'E' - excess stock.
 608: 0000: \*******************************************************************************
 609: 0000: \*******************************************************************************
 610: 0000: 
 611: 0000: STRING GLOBAL                                                  \
 612: 0000:    PLLOL.FILE.NAME$,           \
 613: 0000:    PLLOL.LISTID$,              \ 3 bytes unpacked list ID
 614: 0000:    PLLOL.CREATOR.ID$,          \ 3 bytes unpacked Creator user ID
 615: 0000:    PLLOL.PICKER.ID$,           \ 3 bytes unpacked Picker user ID
 616: 0000:    PLLOL.ITEM.STATUS$,         \ 1 byte item status " "
 617: 0000:                                \                    "P" = Picked
 618: 0000:                                \                    "U" = Unpicked
 619: 0000:                                \                    "A" = List is active (someone is picking it)
 620: 0000:                                \                    "X" = List is cancelled
 621: 0000:    PLLOL.CREATE.DATE$,         \ 6 bytes unpacked create date YYMMDD
 622: 0000:    PLLOL.CREATE.TIME$,         \ 4 bytes unpacked create time HH:MM
 623: 0000:    PLLOL.PICK.START.TIME$,     \ 4 bytes unpacked pick start time HH:MM
 624: 0000:    PLLOL.PICK.END.TIME$,       \ 4 bytes unpacked pick end time HH:MM
 625: 0000:    PLLOL.ITEM.COUNT$,          \ 4 bytes unpacked item count (max number of items in list
 626: 0000:                                \                              duplicates will cobine to 1 record
 627: 0000:                                \                              on the PLLDB file)
 628: 0000:    PLLOL.OSSR.PICKING$,        \ 1 byte Marked for OSSR picking "Y" = marked for OSSR picking
 629: 0000:                                \                                "N" = not marked for OSSR picking
 630: 0000:    PLLOL.OSSR.STATUS$          ! 1 byte mark the status of the list.         ! BMG         
 631: 0000: 
 632: 0000: 
 633: 0000: INTEGER*4 GLOBAL               \
 634: 0000:        PLLOL.RECORD.NUM%
 635: 0000: 
 636: 0000: INTEGER*2 GLOBAL                \
 637: 0000:    PLLOL.REPORT.NUM%,           \
 638: 0000:    PLLOL.SESS.NUM%
 639: 0000: 
 640: 0000: 
 641: 0000: INTEGER*1 GLOBAL                \
 642: 0000:    PLLOL.RECL%
 643: 0000: 
 644: 0000: 
 645: 0000:  %INCLUDE PLLDBDEC.J86                    ! 2.3CS
 646: 0000: 
 647: 0000: \******************************************************************************
 648: 0000: \******************************************************************************
 649: 0000: \***
 650: 0000: \***         %INCLUDE FOR RF PICKING LIST ITEMS IN LISTS FILE FIELD DECLARATIONS
 651: 0000: \***
 652: 0000: \***               FILE TYPE    : KEYED
 653: 0000: \***
 654: 0000: \***               REFERENCE    : PLLDBDEC.J86
 655: 0000: \***
 656: 0000: \***    VERSION A.              Julia Stones.                   11th August 2004
 657: 0000: \***    New file for RF system. Holds picking list items in lists information.
 658: 0000: \***
 659: 0000: \***    VERSION B.              Mark Goode                     17th january 2005
 660: 0000: \***    Changes for OSSR WAN
 661: 0000: \***
 662: 0000: \***    VERSION C.              Charlies Skadorwa
 663: 0000: \***    Add Stock fig to filler space for PST47
 664: 0000: \***
 665: 0000: \***    VERSION D.              Mark Goode                      29th August 2008
 666: 0000: \***    Add new fields for Multi-site project
 667: 0000: \***
 668: 0000: \***    VERSION E.              Wasim Abdulkalam              11th November 2011
 669: 0000: \***    Added new fields for backshop and OSSR pending sales plan for Stock
 670: 0000: \***    file accuracy project
 671: 0000: \*******************************************************************************
 672: 0000: \*******************************************************************************
 673: 0000: 
 674: 0000: STRING GLOBAL                          \
 675: 0000:        PLLDB.FILE.NAME$,               \
 676: 0000:        PLLDB.KEY$,                     \ 6 bytes unpacked LISTID + ITEMSEQ
 677: 0000:        PLLDB.LISTID$,                  \ 3 bytes unpacked List Number
 678: 0000:        PLLDB.ITEMSEQ$,                 \ 3 bytes unpacked Item Sequence Number
 679: 0000:        PLLDB.BOOTSCODE$,               \ 4 bytes packed Boots item code including check digit
 680: 0000:        PLLDB.QTY.ONSHELF$,             \ 4 bytes unpacked Quantity on shelf
 681: 0000:        PLLDB.FILL.QTY$,                \ 4 bytes unpacked Fill quantity
 682: 0000:        PLLDB.GAPFILL.MRK$,             \ 1 byte ASC Gap/Fill marker "Y" = Gap created from Shelf monitor
 683: 0000:                                        \                            "N" = Fast Fill no TSF update
 684: 0000:        PLLDB.ITEM.STATUS$,             \ 1 byte ASC Item Status "U" = Unpicked, "P" = picked
 685: 0000:        PLLDB.STOCKROOM.CNT$,           \ 4 bytes unpacked Stock Room Count
 686: 0000:        PLLDB.SHELFMON.SALE.FIG$,       \ 4 bytes unpacked Sales figure at Shelf Monitoring
 687: 0000:        PLLDB.OSSR.FLAG$,               \ 1 bytes item OSSR flag   ! BMG
 688: 0000:      \!PLLDB.FILLER$,                  \ 7 byte filler            ! BMG !EWA
 689: 0000:        PLLDB.CNT.PENDSALES.BACKSHOP$,  \ 2 bytes packed backshop pending sales plan count      ! EWA
 690: 0000:        PLLDB.TIME.PENDSALES.BACKSHOP$, \ 2 bytes packed backshop pending sales plan count time ! EWA
 691: 0000:        PLLDB.CNT.PENDSALES.OSSR$,      \ 2 bytes packed OSSR pending sales plan count          ! EWA
 692: 0000:        PLLDB.TIME.PENDSALES.OSSR$,     \ 2 bytes packed OSSR pending sales plan count time     ! EWA
 693: 0000:        PLLDB.STKFIG.STOCKROOM$,        \ 4 bytes unpacked Sales figure at Shelf Monitoring
 694: 0000:                                        \ progam submitted for pint out
 695: 0000:        PLLDB.OSSR.CNT$,                \ 4 bytes unpacked OSSR item stock count figure
 696: 0000:        PLLDB.TIME.SHELFMON$,           \ 2 bytes packed Time of stock floor count hh:mm
 697: 0000:        PLLDB.TIME.BACKSHOP$,           \ 2 bytes packed Time of back shop count hh:mm
 698: 0000:        PLLDB.TIME.OSSR$,               \ 2 bytes packed Time of OSSR count hh:mm
 699: 0000:        PLLDB.BACKSHOP.SALE$,           \ 4 bytes unpacked Sale at time of backshop count
 700: 0000:        PLLDB.OSSR.SALE$,               \ 4 bytes unpacked Sale at time of OSSR count
 701: 0000:        PLLDB.MS.TABLE$,                \                                           ! DMG
 702: 0000:        PLLDB.MS.LOCATION.CNT$(1),      \ 2 byte packed multi-site location count   ! DMG
 703: 0000:        PLLDB.MS.SALES.FIG$(1),         \ 2 byte packed multi-site sales figure     ! DMG                                             ! CMG
 704: 0000:        PLLDB.MS.TIME.CNT$(1),          \ 2 byte packed multi-site time of count    ! DMG                                             ! CMG
 705: 0000:        PLLDB.MS.FILL.QTY$(1),          \ 2 byte packed multi-site fill quantity    ! DMG                                                        ! CMG
 706: 0000:        PLLDB.FILLER2$(1)               ! 2 byte filler                             ! DMG
 707: 0000: 
 708: 0000: INTEGER*2 GLOBAL                       \
 709: 0000:    PLLDB.REPORT.NUM%,                  \
 710: 0000:    PLLDB.SESS.NUM%
 711: 0000: 
 712: 0000: INTEGER*2 GLOBAL                       \
 713: 0000:    PLLDB.RECL%
 714: 0000: 
 715: 0000: 
 716: 0000: 
 717: 0000: \%INCLUDE CIMFDEC.J86                     ! DLC !2.5NWB
 718: 0000: \%INCLUDE CITEMDEC.J86                    ! DLC !2.5NWB
 719: 0000: \%INCLUDE CSRDEC.J86                      ! DLC !2.5NWB
 720: 0000: \%INCLUDE CSRWFDEC.J86                    ! DLC !2.5NWB
 721: 0000: \%INCLUDE CSRBFDEC.J86                    ! DLC !2.5NWB
 722: 0000: !%INCLUDE EPSOMDEC.J86                    ! FLC TEST
 723: 0000:  %INCLUDE FPFDEC.J86                      ! DLC
 724: 0000:  REM \
 725: 0000: \******************************************************************************
 726: 0000: \******************************************************************************
 727: 0000: \***
 728: 0000: \***         %INCLUDE FOR FLASHPACK / PARENT FILE FIELD DECLARATIONS
 729: 0000: \***
 730: 0000: \***               FILE TYPE    : Keyed
 731: 0000: \***
 732: 0000: \***               REFERENCE    : FPFDEC.J86
 733: 0000: \***
 734: 0000: \***         VERSION A : LES COOK  - 21/8/92
 735: 0000: \***
 736: 0000: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
 737: 0000: \***    No changes to this file.
 738: 0000: \***
 739: 0000: \***    VERSION C.              CLIVE NORRIS.                       17 JAN 1994.
 740: 0000: \***    No changes to this file. Version updated to keep in line 
 741: 0000: \***    with changes in FPFFUNC.BAS.
 742: 0000: \***
 743: 0000: \*******************************************************************************
 744: 0000: \*******************************************************************************
 745: 0000: 
 746: 0000:   STRING GLOBAL                  \
 747: 0000:     FPF.FILE.NAME$,              \
 748: 0000:     FPF.PARENT.CODE$,            \ 4 byte UPD with a check digit
 749: 0000:     FPF.CODE$(1),                \ 4 bytes upd first flashpack code of 10                 ! Boots code with a check digit 
 750: 0000:                                  \ (99999999 if no code) 
 751: 0000:     FPF.MULT.FACTOR$(1)          \ 2 bytes UPD multiplication factor for
 752: 0000:                   		 ! first flashpack code.
 753: 0000: 
 754: 0000:   INTEGER*2 GLOBAL        \
 755: 0000:     FPF.RECL%,            \
 756: 0000:     FPF.REPORT.NUM%,      \
 757: 0000:     FPF.SESS.NUM%,        \
 758: 0000:     MAX.FPF.CODES%
 759: 0000: 
 760: 0000:  %INCLUDE IDFDEC.J86                      ! FLC
 761: 0000: REM \
 762: 0000: \******************************************************************************
 763: 0000: \******************************************************************************
 764: 0000: \***
 765: 0000: \***         %INCLUDE FOR ITEM DATA FILE - FIELD DECLARATIONS
 766: 0000: \***                                       FILE REFERENCE PARAMETERS
 767: 0000: \***
 768: 0000: \***                  FILE TYPE    : Keyed
 769: 0000: \***
 770: 0000: \***                  REFERENCE    : IDFDEC.J86
 771: 0000: \***
 772: 0000: \***         VERSION A : Andrew Wedgeworth  29th June 1992    
 773: 0000: \***
 774: 0000: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
 775: 0000: \***    Replaced un-used RANK$ with BSNS.CNTR$ and FILLER$.
 776: 0000: \***
 777: 0000: \***    VERSION D.              Andrew Wedgeworth               15th March 1995
 778: 0000: \***    Comments updated to reflect the fact that some bits on the file are
 779: 0000: \***    no longer used.
 780: 0000: \***
 781: 0000: \*******************************************************************************
 782: 0000: \*******************************************************************************
 783: 0000: 
 784: 0000:   STRING GLOBAL           \
 785: 0000:     IDF.FILE.NAME$,       \  
 786: 0000:     IDF.BOOTS.CODE$,      \ 4 byte UPD with check digit (key)
 787: 0000:     IDF.FIRST.BAR.CODE$,  \ 6 byte UPD without check digit
 788: 0000:     IDF.SECOND.BAR.CODE$, \ 6 byte UPD without check digit
 789: 0000:     IDF.NO.OF.BAR.CODES$, \ 2 byte UPD. Total number of bar codes for this item
 790: 0000:     IDF.PRODUCT.GRP$,     \ 3 byte UPD. The first two digits are the concept
 791: 0000:                           \ group and the last four the concept sequence
 792: 0000:     IDF.STNDRD.DESC$,     \ 24 bytes
 793: 0000:     IDF.STATUS.1$,        \ 1 byte, values B,C,D,P,X,Z and blank
 794: 0000:     IDF.INTRO.DATE$,      \ 3 byte UPD YYMMDD. Date first added to this file
 795: 0000:     IDF.BSNS.CNTR$,       \ 1 byte ASC. Business Centre ID letter      ! CRC
 796: 0000:     IDF.FILLER$,          \ 1 byte un-used                             ! CRC
 797: 0000:     IDF.PARENT.CODE$,     \ 4 byte UPD with check digit ; may be zero if no
 798: 0000:                           \ flashpacks, current IDF.BOOTS.CODE$ if parent line
 799: 0000:                           \ or Boots Code of parent line if a flashpack.
 800: 0000:     IDF.DATE.OF.LAST.SALE$! 3 byte UPD. Date of last sale.
 801: 0000: 
 802: 0000:   INTEGER*1 GLOBAL        \
 803: 0000:     IDF.BIT.FLAGS.1%,     \ 1 byte - bit values
 804: 0000:                           \ X"80"  - Group code flag
 805: 0000:                           \ X"40"  - Keylines flag
 806: 0000:                           \ X"20"  - Markdown flag
 807: 0000:                           \ X"10"  - Warehouse flag
 808: 0000:                           \ X"08"  - CSR flag
 809: 0000:                           \ X"04"  - Directs A flag
 810: 0000:                           \ X"02"  - Directs B flag
 811: 0000:                           \ X"01"  - Directs C flag
 812: 0000:     IDF.BIT.FLAGS.2%      \ 1 byte - bit values
 813: 0000:                           \ X"80"  - Own brand line flag
 814: 0000:                           \ X"40"  - Exclusive line flag
 815: 0000:                           \ X"20"  - Unused 
 816: 0000:                           \ X"10"  - Unused
 817: 0000:                           \ X"08"  - Stock system flag
 818: 0000:                           \ X"04"  - Pending count flag
 819: 0000:                           \ X"02"  - Reserved
 820: 0000:                           ! X"01"  - Reserved
 821: 0000: 
 822: 0000:   INTEGER*2 GLOBAL        \
 823: 0000:     IDF.RECL%,            \  
 824: 0000:     IDF.REPORT.NUM%,      \ 
 825: 0000:     IDF.SESS.NUM%
 826: 0000:  %INCLUDE INVOKDEC.J86                    ! FLC
 827: 0000: \******************************************************************************
 828: 0000: \******************************************************************************
 829: 0000: \***
 830: 0000: \***   $Workfile:   INVOKDEC.J86  $
 831: 0000: \***
 832: 0000: \***   $Revision:   1.4  $
 833: 0000: \***
 834: 0000: \******************************************************************************
 835: 0000: \******************************************************************************
 836: 0000: \***
 837: 0000: \***   $Log:   V:\archive\j86\invokdec.j8v  $
 838: 0000: \***   
 839: 0000: \***      Rev 1.4   10 Feb 1998 14:11:36   DEV45PS
 840: 0000: \***   Added RP Delivery Days field
 841: 0000: \***   
 842: 0000: \***      Rev 1.3   09 Apr 1997 09:22:06   DEVAWPS
 843: 0000: \***   Added date of successful processing of Points
 844: 0000: \***   Events details.
 845: 0000: \***   
 846: 0000: \***      Rev 1.2   20 Dec 1994 11:02:52   DEVMJPS
 847: 0000: \***   CSR/2 Amendments - new fields added are 
 848: 0000: \***   PSC14 flag and Conversion Status flag 
 849: 0000: \***   
 850: 0000: \******************************************************************************
 851: 0000: \******************************************************************************
 852: 0000: REM \
 853: 0000: \******************************************************************************
 854: 0000: \******************************************************************************
 855: 0000: \***
 856: 0000: \***    FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS FOR INVCE OK FILE 
 857: 0000: \***
 858: 0000: \***                     REFERENCE   : INVOKDEC.J86
 859: 0000: \***
 860: 0000: \***    Version A            Andrew Wedgeworth              3rd August 1992
 861: 0000: \***    
 862: 0000: \***    Version B            Stephen Kelsey                 12th October 1992
 863: 0000: \***    Include Direct Implementation Flag, PSC30 flag and date.
 864: 0000: \***
 865: 0000: \***    Version C            Les Cook                       15th February 1993
 866: 0000: \***    Include UOD Implementation Flag, UOD Booked in date, Previous serial
 867: 0000: \***    number and success flag.
 868: 0000: \***
 869: 0000: \***    Version D            David Smallwood                20th July 1994   
 870: 0000: \***    Include CSR PHASE1 transmission flag and CSR start method flag.
 871: 0000: \***    
 872: 0000: \***    Version E            Mick Bayliss                   19th Oct. 1994
 873: 0000: \***    New fields for CSR Phase 2 - PSC14 Flag and Conversion Status Flag.
 874: 0000: \***
 875: 0000: \***    Version F            Andrew Wedgeworth              27th March 1997
 876: 0000: \***    Added date of successful processing of Points Events details sent from 
 877: 0000: \***    the mainframe.
 878: 0000: \***
 879: 0000: \***    Version G            Nik Sen                        10th February 1998
 880: 0000: \***    Added parameter used by MINSITS RP to determine number of days to 
 881: 0000: \***    check for late delivery.
 882: 0000: \***
 883: 0000: \******************************************************************************
 884: 0000: \******************************************************************************
 885: 0000: 
 886: 0000: 
 887: 0000: \******************************************************************************
 888: 0000: \***
 889: 0000: \***   FILE REFERENCE PARAMETERS
 890: 0000: \***
 891: 0000: \******************************************************************************
 892: 0000: 
 893: 0000:   STRING GLOBAL           \
 894: 0000:     INVOK.FILE.NAME$
 895: 0000: 
 896: 0000:   INTEGER*2 GLOBAL        \
 897: 0000:     INVOK.SESS.NUM%,      \
 898: 0000:     INVOK.REPORT.NUM%
 899: 0000: 
 900: 0000: 
 901: 0000: \******************************************************************************
 902: 0000: \***
 903: 0000: \***   FIELD DECLARATIONS
 904: 0000: \***
 905: 0000: \******************************************************************************
 906: 0000: 
 907: 0000:   STRING GLOBAL                \
 908: 0000:     INVOK.SERIAL.NO$,          \ 5 bytes ASCII
 909: 0000:     INVOK.DATE$,               \ 3 bytes YYMMDD UPD
 910: 0000:     INVOK.SUCCESS.FLAG$,       \ 1 bytes ASCII
 911: 0000:     INVOK.STORE.NO$,           \ 4 bytes ASCII with leading zeroes
 912: 0000:     INVOK.INVENTORY.SRLNO$,    \ 5 bytes ASCII leading zeros
 913: 0000:     INVOK.INVENTORY.SUCCESS$,  \ 1 bytes ASCII 0=failed/1=success
 914: 0000:     INVOK.SALES.SRLNO$,        \ 5 bytes ASCII leading zeros
 915: 0000:     INVOK.SALES.SUCCESS$,      \ 1 bytes ASCII 0=failed/1=success
 916: 0000:     INVOK.NEW.LIST.SRLNO$,     \ 5 bytes ASCII
 917: 0000:     INVOK.NEW.LIST.SUCCESS$,   \ 1 bytes ASCII 0=failed/1=success
 918: 0000:     INVOK.CSR.DELIVERY.NO$,    \ 5 bytes ASCII				
 919: 0000:     INVOK.CSR.IDENT$,          \ 1 bytes ASCII value "Y" 		
 920: 0000:     INVOK.CSR.DELIVERY.DATE$,  \ 6 bytes ASCII YYMMDD			
 921: 0000:     INVOK.CSR.PSC11.FLAG$,     \ 1 bytes ASCII				
 922: 0000:     INVOK.CSR.PSC12.FLAG$,     \ 1 bytes ASCII				
 923: 0000:     INVOK.CSR.PSC13.FLAG$,     \ 1 bytes ASCII				
 924: 0000:     INVOK.CSR.PSC12.DAYS$,     \ 1 bytes UPD				
 925: 0000:     INVOK.PSS33.RUN.DATE$,     \ 3 bytes YYMMDD UPD                     
 926: 0000:     INVOK.PSS33.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success       
 927: 0000:     INVOK.DIR.IMPL.FLAG$,      \ 1 byte ASCII  1=phase 1 implemented   BSPK   
 928: 0000:                                \           blank=not yet implemented   BSPK 
 929: 0000:     INVOK.PSC30.RUN.DATE$,     \ 3 bytes YYMMDD UPD                    BSPK                     
 930: 0000:     INVOK.PSC30.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success      BSPK
 931: 0000:     INVOK.UOD.IMPL.FLAG$,      \ 1 byte ASCII 1=implemented            CLC
 932: 0000:     INVOK.LAST.UOD.DATE$,      \ 3 bytes UPD                           CLC
 933: 0000:     INVOK.PREV.SERIAL.NO$,     \ 5 bytes ASCII                         CLC
 934: 0000:     INVOK.PREV.SUCCESS.FLAG$,  \ 1 byte ASCII                          CLC
 935: 0000:     INVOK.SUPPRESS.EXCEP.REPORT$,     \ 1 byte ASCII Y/N               DDS
 936: 0000:     INVOK.CSR.STARTED.BY.SUP$,        \ 1 byte ASCII Y/N               DDS
 937: 0000:     INVOK.CSR.PSC14.FLAG$,            \ 1 byte ASCII S/E/X/Y           EMJB
 938: 0000:     INVOK.CSR.CONVERSION.STATUS.FLAG$,\ 1 byte ASCII P/S/X/C           EMJB
 939: 0000:     INVOK.PTS.EVENTS.OK.DATE$, \ 3 bytes UPD                           FAW
 940: 0000:     INVOK.RP.DAYS$,            \ 1 byte ASCII                          GNS
 941: 0000:     INVOK.FILLER$              ! 6 bytes spaces                        GNS
 942: 0000: 
 943: 0000:   INTEGER*2 GLOBAL        \
 944: 0000:     INVOK.RECL%
 945: 0000:  %INCLUDE ONORDDEC.J86                    ! DLC
 946: 0000: \******************************************************************************
 947: 0000: \******************************************************************************
 948: 0000: \***
 949: 0000: \***         %INCLUDE FOR CSR ON ORDER FILE - FIELD DECLARATIONS
 950: 0000: \***                                          FILE REFERENCE PARAMETERS
 951: 0000: \***
 952: 0000: \***               FILE TYPE    : Keyed     
 953: 0000: \***
 954: 0000: \***               REFERENCE    : ONORDDEC.J86
 955: 0000: \***
 956: 0000: \***               DATE OF LAST AMENDMENT -  09/10/92
 957: 0000: \***
 958: 0000: \******************************************************************************
 959: 0000: \*******************************************************************************
 960: 0000: 
 961: 0000:   STRING GLOBAL                  \
 962: 0000:     ONORD.FILE.NAME$,		 \
 963: 0000:     ONORD.KEY$,                  \ 12byte ASC
 964: 0000:     ONORD.ORDER.DATE$,           \ 6 byte ASC
 965: 0000:     ONORD.LIST.FREQ$,            \ 1 byte ASC
 966: 0000:     ONORD.UNIT.NO$,              \ 2 byte ASC 
 967: 0000:     ONORD.SEQ.NO$,               \ 3 byte ASC 
 968: 0000:     ONORD.HIGHEST.SEQ.NO$,       \ 3 byte ASC 
 969: 0000:     ONORD.FILLER$,               \
 970: 0000:     ONORD.ITEM.CODE$,            \ 7 byte ASC 
 971: 0000:     ONORD.QTY.1$,                \ 3 byte ASC
 972: 0000:     ONORD.QTY.2$,                \ 3 byte ASC 
 973: 0000:     ONORD.CSRITEM.UNDONE.FLAG$,  \ 1 byte ASC "Y" or "N"
 974: 0000:     ONORD.CSRIMF.UNDONE.FLAG$,   \ 1 byte ASC "Y" or "N" 
 975: 0000:     ONORD.DELETED.FLAG$          ! 1 byte ASC "Y" or "N" 
 976: 0000:     
 977: 0000:   INTEGER*2 GLOBAL		 \
 978: 0000:     ONORD.REPORT.NUM%,		 \
 979: 0000:     ONORD.RECL%,		 \
 980: 0000:     ONORD.SESS.NUM%  
 981: 0000:     
 982: 0000:  %INCLUDE PCHKDEC.J86                     ! DLC
 983: 0000: \******************************************************************************
 984: 0000: \******************************************************************************
 985: 0000: \***
 986: 0000: \***         %INCLUDE FOR PRICE CHECK FILE - FILE REFERENCE PARAMETERS
 987: 0000: \***
 988: 0000: \***               REFERENCE    : PCHKDEC.J86
 989: 0000: \***
 990: 0000: \******************************************************************************
 991: 0000: \*******************************************************************************
 992: 0000: 
 993: 0000:   STRING GLOBAL           \
 994: 0000:     PCHK.FILE.NAME$
 995: 0000: 
 996: 0000:   INTEGER*2 GLOBAL        \
 997: 0000:     PCHK.REPORT.NUM%,      \
 998: 0000:     PCHK.SESS.NUM%
 999: 0000:  %INCLUDE PIPEINUB.J86                    ! DLC
1000: 0000: 
1001: 0000: \******************************************************************************
1002: 0000: \******************************************************************************
1003: 0000: \***
1004: 0000: \***                   %INCLUDE FOR PSS38 INPUT PIPE
1005: 0000: \***
1006: 0000: \***                         LINK TYPE : PIPEI
1007: 0000: \***
1008: 0000: \***                     REFERENCE : PIPEINUM.J86
1009: 0000: \***
1010: 0000: \******************************************************************************
1011: 0000: \******************************************************************************
1012: 0000: 
1013: 0000:    STRING GLOBAL							\
1014: 0000: 	PIPEI.FILE.NAME$
1015: 0000: 	
1016: 0000:    INTEGER*1 GLOBAL							\
1017: 0000: 	PIPEI.REPORT.NUM%,						\
1018: 0000: 	PIPEI.SESS.NUM%
1019: 0000: !%INCLUDE PIPEONUB.J86                    ! FLC TEST
1020: 0000:  %INCLUDE UNITSDEC.J86                    ! DLC
1021: 0000: \******************************************************************************
1022: 0000: \******************************************************************************
1023: 0000: \***
1024: 0000: \***         %INCLUDE FOR UNITS - FILE REFERENCE PAREMETERS
1025: 0000: \***                              FIELD DECLARATIONS
1026: 0000: \***
1027: 0000: \***               REFERENCE    : UNITSDEC.J86
1028: 0000: \***
1029: 0000: \***
1030: 0000: \******************************************************************************
1031: 0000: \******************************************************************************
1032: 0000: 
1033: 0000:   STRING GLOBAL           \
1034: 0000:     UNITS.UNIT$,          \ 1  byte UPD (key)
1035: 0000:     UNITS.UNIT.NAME$,     \ 27 bytes ASCII
1036: 0000:     UNITS.BC.LETTER$,     \ 1  byte  ASCII
1037: 0000:     UNITS.FILLER$,        \ 6  bytes ASCII (spaces).
1038: 0000:     UNITS.FILE.NAME$
1039: 0000: 
1040: 0000:   INTEGER*2 GLOBAL        \
1041: 0000:     UNITS.REPORT.NUM%,    \ 
1042: 0000:     UNITS.RECL%,          \ 
1043: 0000:     UNITS.SESS.NUM%
1044: 0000:  %INCLUDE STKMQDEC.J86                    ! MMJK
1045: 0000: REM \
1046: 0000: \******************************************************************************
1047: 0000: \******************************************************************************
1048: 0000: \***
1049: 0000: \***      %INCLUDE FOR STOCK MOVEMENT QUEUE FILE FIELD DECLARATIONS
1050: 0000: \***                                             FILE REFERENCE PARAMETERS
1051: 0000: \***
1052: 0000: \***               FILE TYPE    : Sequential
1053: 0000: \***
1054: 0000: \***               REFERENCE    : STKMQDEC.J86
1055: 0000: \***
1056: 0000: \***      Version A.     L. Cook
1057: 0000: \***
1058: 0000: \***      Combined from STKMQNUE.J86 and STKMQFLE.J86
1059: 0000: \***
1060: 0000: \***      Version B.     S.P. Kelsey (CTG)            7th November
1061: 0000: \***      Include CSR Marker in the Type 1 and Type 18 transactions.
1062: 0000: \***
1063: 0000: \***      Version C.     S. Goulding                 8th March
1064: 0000: \***      Add fields for new tranctions types 21 & 23
1065: 0000: \***
1066: 0000: \***      Version D.     ???????????            ????????????
1067: 0000: \***      ????????????????????????????????????????????????????????
1068: 0000: \***
1069: 0000: \***      Version E.     Michael J. Kelsall           16th Dec 1993.
1070: 0000: \***      Addition of txn types, 24, 25, 26, 27 and 28. As part of the
1071: 0000: \***      RETURNS/AUTOMATIC CREDIT CLAIMING system.
1072: 0000: \***
1073: 0000: \***      Version 1.1    Michael J. Kelsall           10th Aug 1994.
1074: 0000: \***      Changes as part of R/ACC update to allow for zero price claim
1075: 0000: \***      processing. Addition of type 29 txn for this change.
1076: 0000: \***
1077: 0000: \***      Version 1.2    Nik Sen                       8th November 1994
1078: 0000: \***      Addition of transaction type 30 as oart of Epsom Life CSR Phase 2
1079: 0000: \***
1080: 0000: \***      Version 1.3    Neil Bennett                   2nd January 2007
1081: 0000: \***      Add ASN processing support. (Rec Type 17)
1082: 0000: \***
1083: 0000: \***      Version 1.4    Brian Greenfield               14th may 2007
1084: 0000: \***      Added STKMQ.RECALL.TYPE$ for use in A7C RECALLS - only type 26 records.
1085: 0000: \***
1086: 0000: \***      Version 1.5    Neil Bennett                  31st January 2008
1087: 0000: \***      Add STKMQ.FLAG$ for record type 11
1088: 0000: \***
1089: 0000: \***      Version 1.6    Dave Constable                5th September 2008
1090: 0000: \***      Add STKMQ.FLAG$ for record type 33
1091: 0000: \***
1092: 0000: \***      Version 1.7    Dave Constable                30th December 2008
1093: 0000: \***      Add STKMQ.RESCAN$ for record type 33
1094: 0000: \***
1095: 0000: \***      Version 1.8    Dave Constable                6th January 2009
1096: 0000: \***      Add Bookin date & time for record type 33
1097: 0000: \***
1098: 0000: \***      Version F      Mark Walker                      27th Mar 2014
1099: 0000: \***      F337 Centralised View of Stock
1100: 0000: \***      - Relocated STKMQ item processing variables to here.
1101: 0000: \***
1102: 0000: \******************************************************************************
1103: 0000: \*******************************************************************************
1104: 0000: \***
1105: 0000: \***  The length of the records on this file vary depending on the record
1106: 0000: \***  transaction type, but they all comprise combinations of the fields
1107: 0000: \***  defined below.
1108: 0000: \***
1109: 0000: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,
1110: 0000: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
1111: 0000: \***     END OF RECORD MARKER.
1112: 0000: \***
1113: 0000: \***  Transaction type 1 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1114: 0000: \***     TIME, FSI, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER, STORE SUFFIX,
1115: 0000: \***     COUNT OF ITEMS, INVOICE DAY,(FIELD DELIMITER, BOOTS CODE,
1116: 0000: \***     FIELD DELIMITER, QUANTITY, FIELD DELIMITER, CSR MARKER),
1117: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER.
1118: 0000: \***     The fields within brackets are repeated as many times as count of items.
1119: 0000: \***
1120: 0000: \***  Transaction type 2 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1121: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, RECORD DELIMITER,
1122: 0000: \***     END OF RECORD MARKER.
1123: 0000: \***
1124: 0000: \***  Transaction type 3 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1125: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER,
1126: 0000: \***     REASON CODE, STORE/RETURN CODE, RECORD DELIMITER, END OF RECORD MARKER
1127: 0000: \***
1128: 0000: \***  Transaction type 4 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1129: 0000: \***     TIME, BOOTS CODE, ON IDF FLAG, FIELD DELIMITER, QUANTITY,
1130: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1131: 0000: \***
1132: 0000: \***  Transaction type 5 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1133: 0000: \***     TIME, BOOTS CODE, COUNT FLAG, STOCK MOVEMENT DATE, FIELD DELIMITER,
1134: 0000: \***     QUANTITY, RECORD DELIMITER, END OF RECORD MARKER
1135: 0000: \***
1136: 0000: \***  Transaction type 6 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1137: 0000: \***     TIME, BOOTS CODE, REASON (1 byte ASCII)
1138: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1139: 0000: \***
1140: 0000: \***  Transaction type 7 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1141: 0000: \***     TIME, BOOTS CODE, CONCEPT SEQUENCE
1142: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1143: 0000: \***
1144: 0000: \***  Transaction type 8 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1145: 0000: \***     TIME, PRODUCT GROUP, RECORD DELIMITER, END OF RECORD
1146: 0000: \***     MARKER
1147: 0000: \***
1148: 0000: \***  Transaction type 9 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1149: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, LIST TYPE,
1150: 0000: \***     COUNT.BY.DATE, RECORD DELIMITER, END OF RECORD MARKER
1151: 0000: \***
1152: 0000: \***  Transaction type 10- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1153: 0000: \***     TIME, BOOTS CODE,
1154: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1155: 0000: \***
1156: 0000: \***  Transaction type 11- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1157: 0000: \***     TIME, BOOTS CODE, FIELD DELIMITER, COUNT QUANTITY, FIELD DELIMITER(opt),
1158: 0000: \***     SOURCE(opt), FLAG(opt), RECORD DELIMITER, END OF RECORD MARKER
1159: 0000: \***
1160: 0000: \***  Transaction type 12- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1161: 0000: \***     TIME, BOOTS CODE,
1162: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1163: 0000: \***
1164: 0000: \***  Transaction type 13- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1165: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1166: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1167: 0000: \***     FIELD DELIMITER, BACKROOM COUNT, RECORD DELIMITER, END OF REC MARKER
1168: 0000: \***
1169: 0000: \***  Transaction type 14- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1170: 0000: \***     TIME, LIST NUMBER, LIST STATUS, RECORD DELIMITER,
1171: 0000: \***     END OF RECORD MARKER
1172: 0000: \***
1173: 0000: \***  Transaction type 16- RECORD DELIMIER, TRANS TYPE, FIELD DELIMITER, DATE,
1174: 0000: \***     TIME, BC LETTER, FIELD DELIMITER, ORIGINAL RECOUNT
1175: 0000: \***     PERCENTAGE, FIELD DELIMITER, CHANGED RECOUNT PERCENTAGE,
1176: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1177: 0000: \***
1178: 0000: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1179: 0000: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
1180: 0000: \***     NUMBER, ITEM COUNT,
1181: 0000: \***     CARTON NUMBER, CARTON FLAG,                                        ! 1.3NWB
1182: 0000: \***     FIELD DELIMITER, ITEM CODE, BAR CODE,
1183: 0000: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
1184: 0000: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
1185: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1186: 0000: \***
1187: 0000: \***  Transaction type 18- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1188: 0000: \***     TIME, FOLIO IDENTIFIER, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER,
1189: 0000: \***     STORE SUFFIX, ITEM COUNT, INVOICE DAY, EXPECTED DATE OF DELIVERY,
1190: 0000: \***     DALLAS MARKER, FIELD DELIMITER, ITEM CODE, FIELD DELIMITER,
1191: 0000: \***     ORDER QUANTITY, FIELD DELIMITER, CSR MARKER,
1192: 0000: \***     (the last six fields repeat ITEM COUNT times),
1193: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1194: 0000: \***
1195: 0000: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1196: 0000: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
1197: 0000: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
1198: 0000: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
1199: 0000: \***
1200: 0000: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1201: 0000: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1202: 0000: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
1203: 0000: \***
1204: 0000: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1205: 0000: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1206: 0000: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, FIELD DELIMITER
1207: 0000: \***     FSI,FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, FOLIO NO, CSR MARKER
1208: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
1209: 0000: \***
1210: 0000: \***
1211: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
1212: 0000: \***
1213: 0000: \***  Transaction type 24 - Whole or Part consignment record
1214: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1215: 0000: \***     CREDIT CLAIM NUM, BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM,
1216: 0000: \***     FOLIO NUM, BATCH REF NUM, WHOLE/PART CONSIGNMENT, REPAIR CATEGORY,
1217: 0000: \***     REPAIR NUM, PLAN4 POLICY NUM, DDDA/DCDR NUM, DELIV NOTE NUM,
1218: 0000: \***     DELIV DATE, NUM OF CARTONS, ORDER NUM, COMMENT, NUM OF ITEMS,
1219: 0000: \***     ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, RECORD DELIMITER,
1220: 0000: \***     END OF RECORD MARKER
1221: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1222: 0000: \***
1223: 0000: \***  Transaction type 25 - Non-sales func 16 and Misc. txns from controller
1224: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1225: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS, AUTH CODE/CONTACT,
1226: 0000: \***     ADJUST STOCK FIGURE FLAG, REASON, ITEM/BAR CODE FLAG, BOOTS/BAR CODE,
1227: 0000: \***     QTY, PRICE, RECORD DELIMITER, END OF RECORD MARKER
1228: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1229: 0000: \***
1230: 0000: \***  Transaction type 26 - Data from LDT
1231: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME, UOD NUM,
1232: 0000: \***     UOD STATUS, CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD,
1233: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER,
1234: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
1235: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
1236: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD
1237: 0000: \***     DESPATCHED, RECALL TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.4BG
1238: 0000: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
1239: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
1240: 0000: \***
1241: 0000: \***  Transaction type 27 - End of LDT session
1242: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1243: 0000: \***     DATE SESSION ENDED, TIME SESSION ENDED, RECORD DELIMITER,
1244: 0000: \***     END OF RECORD MARKER
1245: 0000: \***
1246: 0000: \***  Transaction type 28 - Cancelled Credit Claim
1247: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1248: 0000: \***     CLAIM NUMBER, UOD NUM, NEW STATUS FLAG, RECORD DELIMITER,
1249: 0000: \***     END OF RECORD MARKER
1250: 0000: \***
1251: 0000: \***  Transaction type 29 - Zero price update
1252: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1253: 0000: \***     CLAIM NUMBER, ITEM NUMBER, CLAIM VALUE, RECORD DELIMITER,
1254: 0000: \***     END OF RECORD MARKER
1255: 0000: \***
1256: 0000: \***  Transaction type 30 - CSR Issues
1257: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1258: 0000: \***     BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER
1259: 0000: \***     EXPECTED DELIVERY DATE, RECORD DELIMITER, END OF RECORD MARKER
1260: 0000: \***
1261: 0000: \***  Transaction type 31 - Quasi Count
1262: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1263: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1264: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1265: 0000: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1266: 0000: \***      END OF REC MARKER
1267: 0000: \***
1268: 0000: \***  Transaction type 32 - Quasi Adjustment count
1269: 0000: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1270: 0000: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1271: 0000: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1272: 0000: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1273: 0000: \***     END OF REC MARKER
1274: 0000: \***
1275: 0000: \***  Transaction type 33 - +UOD Receiving
1276: 0000: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1277: 0000: \***     TIME, UOD LICENCE PLATE, DESPATCH DATE, ACTION, ITEM COUNT,
1278: 0000: \***     for audit type+(ITEM CODE, BARCODE, DESPATCHED QTY, VARIANCE )
1279: 0000: \***     END OF REC MARKER
1280: 0000: \***
1281: 0000: \******************************************************************************
1282: 0000: 
1283: 0000:   STRING GLOBAL              \
1284: 0000:     STKMQ.FILE.NAME$,        \
1285: 0000:     STKMQ.RECORD$,           \ Used to store the whole record which is unstrung
1286: 0000:                              \ into the fields below
1287: 0000:     STKMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
1288: 0000:     STKMQ.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
1289: 0000:                              \             01 = W'house invoice delivery record
1290: 0000:                              \             02 = Delivery without invoice record
1291: 0000:                              \             03 = Stock out record
1292: 0000:                              \             04 = Stock count record
1293: 0000:                              \             17 = Delivery without confirmation
1294: 0000:                              \                  of Direct Order detail
1295: 0000:                              \             18 = Confirmed Dallas invoice record
1296: 0000:                              \             19 = Delivery without confirmation
1297: 0000:                              \                  of Direct Order header
1298: 0000:                              \             21 = UOD record
1299: 0000:                              \             23 = Item Level UOD record
1300: 0000:                              \             24 = Whole/Part consignment (R/ACC)
1301: 0000:                              \             25 = NS16 / Misc cont txn (R/ACC)
1302: 0000:                              \             26 = Data from LDT (R/ACC)
1303: 0000:                              \             27 = End of LDT session (R/ACC)
1304: 0000:                              \             28 = Canc. Credit Claim (R/ACC)
1305: 0000:                              \             29 = Zero price update (R/ACC)
1306: 0000:     STKMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1307: 0000:     STKMQ.CREATION.DATE$,    \ 3 byte UPD set to current date
1308: 0000:     STKMQ.CREATION.TIME$,    \ 3 byte UPD set to current time
1309: 0000:     STKMQ.CSR.MARKER$,       \ 1 byte ASCII. "Y" - This is a CSR Item      BSPK
1310: 0000:                              \               " " - This is not a CSR Item  BSPK
1311: 0000:     STKMQ.DATE$,             \ 3 byte UPD set to current date
1312: 0000:     STKMQ.TIME$,             \ 3 byte UPD set to current time
1313: 0000:     STKMQ.FSI$,              \ 1 byte ASCII
1314: 0000:     STKMQ.FOLIO.YEAR$,       \ 1 byte UPD
1315: 0000:     STKMQ.FOLIO.MONTH$,      \ 1 byte UPD
1316: 0000:     STKMQ.FOLIO.NUMBER$,     \ 2 bytes UPD
1317: 0000:     STKMQ.STORE.SUFFIX$,     \ 1 byte ASCII
1318: 0000:     STKMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
1319: 0000:     STKMQ.BOOTS.CODE$,       \ 4 bytes UPD
1320: 0000:     STKMQ.ON.IDF.FLAG$,      \ 1 byte ASCII. Y = On IDF   N = Not on IDF
1321: 0000:     STKMQ.QUANTITY$,         \ variable length string equivalent to
1322: 0000:                              \ STR$(STKMQ.QUANTITY%)
1323: 0000:                              \ +ve indicates add to stock
1324: 0000:                              \ -ve indicates subtract from stock
1325: 0000:     STKMQ.REASON.CODE$,      \ 2 bytes UPD
1326: 0000:     STKMQ.STORE.RET.CODE$,   \ 2 bytes UPD
1327: 0000:     STKMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
1328: 0000:     STKMQ.REASON$,           \ 1 byte ASCII. "I" = ineligible,
1329: 0000:                              \               "U" = unsuppliable,
1330: 0000:                              \               "Z" = deleted,
1331: 0000:                              \               " " = not removed.
1332: 0000:     STKMQ.CONCEPT.SEQUENCE$, \ 3 byte UPD. Concept group / sequence
1333: 0000:     STKMQ.INVOICE.DAY$,      \ 1 byte UPD
1334: 0000:     STKMQ.LIST.NUMBER$,      \ 4 byte ASCII
1335: 0000:     STKMQ.ITEM.NUMBER$,      \ 2 byte ASCII
1336: 0000:     STKMQ.ITEM.STATUS$,      \ 1 byte ASCII
1337: 0000:     STKMQ.COUNT.DATE$,       \ 3 byte UPD - YYMMDD
1338: 0000:     STKMQ.COUNT.TIME$,       \ 2 byte UPD - HHMM
1339: 0000:     STKMQ.PRICE$,            \ 5 byte UPD
1340: 0000:     STKMQ.SHOP.COUNT$,       \ variable ASCII
1341: 0000:     STKMQ.BKRM.COUNT$,       \ variable ASCII
1342: 0000:     STKMQ.LIST.STATUS$,      \ 1 byte ASCII
1343: 0000:     STKMQ.LEFT.TO.COUNT$,    \ variable ASCII
1344: 0000:     STKMQ.COUNT.BY.DATE$,    \ 3 bytes UPD
1345: 0000:     STKMQ.PRODUCT.GROUP$,    \ 3 bytes UPD
1346: 0000:     STKMQ.BC.LETTER$,        \ 1 byte ASCII
1347: 0000:     STKMQ.ORG.RECOUNT$,      \ VARIABLE ASCII
1348: 0000:     STKMQ.NEW.RECOUNT$,      \ VARIABLE ASCII
1349: 0000:     STKMQ.LIST.TYPE$,        \ 1 byte ASCII
1350: 0000:     STKMQ.COUNT.FLAG$,       \ 1 byte ASC from corrections file
1351: 0000:     STKMQ.STMVT.DATE$,       \ 3 bytes UPD
1352: 0000:     STKMQ.SUPPLIER.NO$,      \ 4 bytes UPD
1353: 0000:     STKMQ.ORDER.NO$,         \ 2 bytes UPD
1354: 0000:     STKMQ.ORDER.SFX$,        \ 1 byte ASCII
1355: 0000:     STKMQ.PAGE.NO$,          \ 1 byte UPD
1356: 0000:     STKMQ.ORDER.DATE$,       \ 3 bytes UPD
1357: 0000:     STKMQ.EXP.DELV.DATE$,    \ 3 bytes UPD
1358: 0000:     STKMQ.DALLAS.MKR$,       \ 1 byte ASCII DALLAS system marker
1359: 0000:                              \ 'Y' - invoice is from DALLAS system,
1360: 0000:                              \ 'N' - invoice is not from DALLAS system
1361: 0000:                              \ 'Q' - invoice contains quantity alterations
1362: 0000:     STKMQ.SOURCE$,           \ 1 byte ASCII Source flag
1363: 0000:                              \ 'S' - PSS65, 'P' - PDT, PSS57
1364: 0000:                              \ Transaction type 11 'S' - Stocktake else ' '
1365: 0000:     STKMQ.FLAG$,             \ Transaction type 11 'F' - First 'L' - Last or ' '
1366: 0000:     STKMQ.BAR.CODE$,         \ 6 bytes UPD
1367: 0000:     STKMQ.CODE.FLAG$,        \ 1 BYTE ASCII
1368: 0000:     STKMQ.QTY.GOOD$,         \ VARIABLE ASCII
1369: 0000:                              \ Quantity of singles booked in in good condition
1370: 0000:     STKMQ.QTY.BAD$,          \ VARIABLE ASCII
1371: 0000:                              \ Quantity of singles booked in in bad condition
1372: 0000:     STKMQ.QTY.STOLEN$,       \ VARIABLE ASCII
1373: 0000:                              \ Quantity of singles recognised as stolen
1374: 0000:     STKMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
1375: 0000:                              \ 'C' - Order has been confirmed
1376: 0000:                              \ 'A' - Order has been amended
1377: 0000:                              \ ' ' - Nothing has been done to the order
1378: 0000:     STKMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
1379: 0000:                              \ processed
1380: 0000:     STKMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
1381: 0000:     STKMQ.SNGLS.ADDED$,      \ 2 byte UPD  Singles added to order
1382: 0000:     STKMQ.ITEMS.ADDED$,      \ 2 byte UPD  Items added to order
1383: 0000:     STKMQ.ITEMS.BOOKED$,     \ 2 byte UPD  Items booked in on the order
1384: 0000:     STKMQ.DIST.CENTRE$,      \ 1 byte UPD
1385: 0000:     STKMQ.WHSE.NUMBER$,      \ 1 byte UPD
1386: 0000:     STKMQ.STORE.NUMBER$,     \ 2 byte UPD
1387: 0000:     STKMQ.UOD.NUMBER$,       \ 3 byte UPD
1388: 0000:     STKMQ.STATUS$,           \ 1 byte ASCII
1389: 0000:                              \
1390: 0000:     STKMQ.CREDIT.CLAIM.NUM$, \ 4 byte UPD
1391: 0000:     STKMQ.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
1392: 0000:                              \              "E" = Excess,
1393: 0000:                              \              "R" = Repairs
1394: 0000:     STKMQ.SUPPLIER.NUM$,     \ 3 byte UPD
1395: 0000:     STKMQ.INVOICE.NUM$,      \*9 byte ASC
1396: 0000:     STKMQ.FOLIO.NUM$,        \ 3 byte UPD
1397: 0000:     STKMQ.BATCH.REF$,        \ 3 byte UPD
1398: 0000:     STKMQ.WHOLE.PART.CON$,   \ 1 byte ASC   "W" = Whole, "P" = Part
1399: 0000:     STKMQ.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
1400: 0000:                              \               2 = Estimate,
1401: 0000:                              \               3 = Boots guarantee,
1402: 0000:                              \               4 = Supplier guarantee,
1403: 0000:                              \               5 = Other guarantee,
1404: 0000:     STKMQ.REPAIR.NUM$,       \ 6 byte UPD
1405: 0000:     STKMQ.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
1406: 0000:     STKMQ.DDDA.DCDR.NUM$,    \ 4 byte UPD
1407: 0000:     STKMQ.DELIV.NOTE.NUM$,   \*9 byte ASC
1408: 0000:     STKMQ.NUM.CARTONS.RECEIV$,\1 byte UPD
1409: 0000:     STKMQ.ORDER.NUM$,        \*7 byte ASC
1410: 0000:     STKMQ.COMMENT$,          \*20 byte ASC
1411: 0000:     STKMQ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
1412: 0000:                              \               "B" = Barcode.
1413: 0000:     STKMQ.ITEM.BARCODE$,     \ 7 byte UPD
1414: 0000:     STKMQ.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
1415: 0000:     STKMQ.AUTHORISATION$,    \ 15 byte ASC
1416: 0000:     STKMQ.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
1417: 0000:     STKMQ.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
1418: 0000:     STKMQ.UOD.NUM$,          \ 7 byte UPD
1419: 0000:     STKMQ.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
1420: 0000:                              \              "C" = Closed,
1421: 0000:                              \              "D" = Despatched
1422: 0000:     STKMQ.SUPPLY.ROUTE$,     \ 1 byte ASC
1423: 0000:     STKMQ.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
1424: 0000:                              \              "D" = Dispensary
1425: 0000:     STKMQ.RECALL.NUM$,       \ 8 byte ASC
1426: 0000:     STKMQ.SUPPLIER$,         \ 15 byte ASC
1427: 0000:     STKMQ.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
1428: 0000:                              \               2 = BIRD,
1429: 0000:                              \               3 = Via D6,
1430: 0000:                              \               4 = Representative
1431: 0000:     STKMQ.CARRIER$,          \ 1 byte UPD;   1 = GPO,
1432: 0000:                              \               2 = Parcelforce,
1433: 0000:                              \               3 = Securicor,
1434: 0000:                              \               4 = Other
1435: 0000:     STKMQ.BIRD.NUM$,         \ 8 byte ASC
1436: 0000:     STKMQ.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
1437: 0000:                              \              "C" = CSR
1438: 0000:     STKMQ.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
1439: 0000:                              \               2 = Town Tray,
1440: 0000:                              \               3 = Roll cage,
1441: 0000:                              \               4 = Other
1442: 0000:     STKMQ.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
1443: 0000:                              \               2 = Poor handling
1444: 0000:     STKMQ.RECEIVING.STORE$,  \ 2 byte UPD
1445: 0000:     STKMQ.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
1446: 0000:                              \               2 = MTS,
1447: 0000:                              \               3 = Other
1448: 0000:     STKMQ.DATE.UOD.OPENED$,  \ 3 byte UPD
1449: 0000:     STKMQ.DATE.DESPATCHED$,  \ 3 byte UPD
1450: 0000:     STKMQ.TIME.DESPATCHED$,  \ 3 byte UPD
1451: 0000:     STKMQ.ITEM.UPDATED$,     \ 1 byte ASC
1452: 0000:     STKMQ.DATE.SESS.END$,    \ 3 byte UPD
1453: 0000:     STKMQ.TIME.SESS.END$,    \ 3 byte UPD
1454: 0000:     STKMQ.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
1455: 0000:                              \              "D" = Despatched,
1456: 0000:                              \              "X" = Cancelled
1457: 0000:     STKMQ.ITEM.NUM$,         \ 2 byte UPD   (CCITF key value)
1458: 0000:     STKMQ.CLAIM.VALUE$,      \ 3 byte UPD
1459: 0000:     STKMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.3NWB
1460: 0000:                              \                 'N' Normal Book In           ! 1.3NWB
1461: 0000:                              \                 'A' Carton Audit Process     ! 1.3NWB
1462: 0000:                              \                 'E' Exception Process (nof)  ! 1.3NWB
1463: 0000:     STKMQ.CARTON.NO$,        \ 4 bytes UPD (0-9999)                         ! 1.3NWB
1464: 0000:     STKMQ.RECALL.TYPE$       ! 1 byte ASC   "B" = Batch Recall              ! 1.4BG
1465: 0000:                              !              "N" = Non-batch Recall          ! 1.4BG
1466: 0000:                              !              " " = Old Credit Claim          ! 1.4BG
1467: 0000: 
1468: 0000: !***********************************************************!* DC 1.6
1469: 0000: !* Added for +UOD Development                               !* DC 1.6
1470: 0000: !***********************************************************!* DC 1.6
1471: 0000:   STRING GLOBAL \                                           !* DC 1.6 
1472: 0000:     STKMQ.LICENCE.PLATE$, \                                 !* DC 1.6 
1473: 0000:     STKMQ.DESPATCH.DATE$, \                                 !* DC 1.6 
1474: 0000:     STKMQ.ACTION$, \                                        !* DC 1.6 
1475: 0000:     STKMQ.DELIVERY.DATE$, \                                 !* DC 1.6 
1476: 0000:     STKMQ.DELIVERY.TIME$, \                                 !* DC 1.6 
1477: 0000:     STKMQ.DRIVER.ID$, \                                     !* DC 1.6 
1478: 0000:     STKMQ.BOOKIN.DATE$, \                                   !* DC 1.8
1479: 0000:     STKMQ.BOOKIN.TIME$, \                                   !* DC 1.8 
1480: 0000:     STKMQ.OP.ID$, \                                         !* DC 1.6 
1481: 0000:     STKMQ.BOOKIN.METHOD$, \                                 !* DC 1.6 
1482: 0000:     STKMQ.BOOKIN.LEVEL$, \                                  !* DC 1.6 
1483: 0000:     STKMQ.GIT$, \                                           !* DC 1.6 
1484: 0000:     STKMQ.RESCAN$, \                                        !* DC 1.7
1485: 0000:     STKMQ.FILLER$                                           !* DC 1.6 
1486: 0000: 
1487: 0000:   INTEGER*2 GLOBAL           \                              !* DC 1.6 
1488: 0000:     STKMQ.SESS.NUM%,         \                              !* DC 1.6 
1489: 0000:     STKMQ.REPORT.NUM%                                       !* DC 1.6 
1490: 0000: !***********************************************************!* DC 1.6
1491: 0000: 
1492: 0000:     STRING GLOBAL                                                       \   !FMW
1493: 0000:         STKMQ.UOD.QTY$,         \                                       \   !FMW
1494: 0000:         STKMQ.CODE$(1),         \ Item Code                             \   !FMW
1495: 0000:         STKMQ.TYPE$(1),         \ Code type I = Item code               \   !FMW
1496: 0000:                                 \           B = Barcode                 \   !FMW
1497: 0000:         STKMQ.CSR.FLAG$(1),     \ CSR Flag                              \   !FMW
1498: 0000:         STKMQ.EAN.CODE$(1),     \ Barcode                               \   !FMW
1499: 0000:         STKMQ.QTY$(1),          \ Quantity                              \   !FMW
1500: 0000:         STKMQ.GOOD.QUAN$(1),    \ Good Quantity                         \   !FMW
1501: 0000:         STKMQ.DAM.QUAN$(1),     \ Damaged Quantity                      \   !FMW
1502: 0000:         STKMQ.STOL.QUAN$(1),    \ Stolen Quantity                       \   !FMW
1503: 0000:         STKMQ.PRICE.ARRAY$(1)   ! Retail Price                              !FMW
1504: 0000:                                                                             !FMW
1505: 0000:     INTEGER*2 GLOBAL                                                    \   !FMW
1506: 0000:         STKMQ.ITEM%             ! Count of items in a transaction           !FMW
1507: 0000: 
1508: 0000:  %INCLUDE BCSMFDEC.J86                    ! FLC
1509: 0000: REM \
1510: 0000: \******************************************************************************
1511: 0000: \******************************************************************************
1512: 0000: \***
1513: 0000: \***   %INCLUDE FOR BUSINESS CENTRE SUPPLY METHOD FILE REFERENCE PARAMETERS
1514: 0000: \***                                              FIELD DECLARATIONS
1515: 0000: \***
1516: 0000: \***               REFERENCE    : BCSMFDEC.J86
1517: 0000: \***
1518: 0000: \***  Version A - L Cook
1519: 0000: \***  Copied from bcsmfnue.j86 and bcsmffle.j86
1520: 0000: \***
1521: 0000: \***  Version B - Les Cook
1522: 0000: \***  to include integer missed from bcsmfflf.j86 in error
1523: 0000: \***
1524: 0000: \******************************************************************************
1525: 0000: \*******************************************************************************
1526: 0000: 
1527: 0000:   STRING GLOBAL           \
1528: 0000:     BCSMF.FILE.NAME$,              \ 
1529: 0000:     BCSMF.FSI$,                    \ 1 byte ASCII folio series identifier (key)
1530: 0000:     BCSMF.NAME$,                   \ 14 bytes ASCII business centre name
1531: 0000:     BCSMF.PSEUDO.BUSINESS.CENTRE$, \ 1 byte flag "Y" = pseudo bc
1532: 0000:     BCSMF.FILLER$                  ! 3 bytes spaces
1533: 0000: 
1534: 0000:   INTEGER*1 GLOBAL          \
1535: 0000:     BCSMF.RECNT.LIMIT%,     \ percentage of recounts that may be generated
1536: 0000:     BCSMF.MIN.RECNT.LIMIT%, \ minimum limit
1537: 0000:     BCSMF.MAX.RECNT.LIMIT%, \ maximum limit
1538: 0000:     BCSMF.DISCRPNCY.CNT%,   \ used to calculate   
1539: 0000:     BCSMF.DISCRPNCY.PERCNT%,\ if recount
1540: 0000:     BCSMF.STK.CNT.LIMIT%,   \ is necessary
1541: 0000:     BCSMF.SEQUENCE.NO%,     \ used for displaying
1542: 0000:     BCSMF.NO.REPEAT.TICKETS% ! Number of repeat FALCONCRAFT tickets	! CLC
1543: 0000: 
1544: 0000:   INTEGER*2 GLOBAL        \
1545: 0000:     BCSMF.DISCRPNCY.VAL%,   \ (in pounds) used for determining recounts
1546: 0000:     BCSMF.MIN.LIST.NO%,     \ allowable range of 
1547: 0000:     BCSMF.MAX.LIST.NO%,     \ spare list numbers
1548: 0000:     BCSMF.RECL%,          \
1549: 0000:     BCSMF.SESS.NUM%,      \
1550: 0000:     BCSMF.REPORT.NUM%
1551: 0000:  %INCLUDE IEFDEC.J86                      ! DLC
1552: 0000: REM \
1553: 0000: \******************************************************************************
1554: 0000: \******************************************************************************
1555: 0000: \***
1556: 0000: \***         %INCLUDE FOR ITEM EAN CODES FILE - FIELD DECLARATIONS
1557: 0000: \***                                            FILE REFERENCE PARAMETERS
1558: 0000: \***
1559: 0000: \***               FILE TYPE    : Keyed
1560: 0000: \***
1561: 0000: \***               REFERENCE    : IEFDEC.J86
1562: 0000: \***
1563: 0000: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
1564: 0000: \***    No changes to this file.
1565: 0000: \***
1566: 0000: \*******************************************************************************
1567: 0000: \*******************************************************************************
1568: 0000: 
1569: 0000:   STRING GLOBAL                      \
1570: 0000:     IEF.FILE.NAME$,		     \
1571: 0000:     IEF.BOOTS.CODE.BAR.CODE$,        \ 9 byte UPD -                        BBAAS
1572: 0000:                                      \ 3 bytes UPD boots code              BBAAS   
1573: 0000:                                      \ + 6 UPD bar code,                   BBAAS
1574: 0000:                                      \ no check digits. (key)              BBAAS
1575: 0000:     IEF.NEXT.BAR.CODE$               ! 6 byte UPD without check digit
1576: 0000: 
1577: 0000:   INTEGER*2 GLOBAL        \
1578: 0000:     IEF.REPORT.NUM%,	  \
1579: 0000:     IEF.SESS.NUM%,	  \ 
1580: 0000:     IEF.RECL%
1581: 0000:  %INCLUDE DIRORDEC.J86                    ! DLC
1582: 0000: REM \
1583: 0000: \******************************************************************************
1584: 0000: \******************************************************************************
1585: 0000: \***
1586: 0000: \***     %INCLUDE FOR STORE DIRECT ORDERS FILE  - FIELD DECLARATIONS
1587: 0000: \***                                              FILE REFERENCE PARAMETERS
1588: 0000: \***
1589: 0000: \***               FILE TYPE    : Keyed
1590: 0000: \***
1591: 0000: \***               REFERENCE    : DIRORDEC.J86
1592: 0000: \***
1593: 0000: \***               DATE OF LAST AMENDMENT - 14/08/1992
1594: 0000: \***
1595: 0000: \***               VERSION A    : Les Cook    14th August 1992
1596: 0000: \***
1597: 0000: \***  VERSION B                 Neil Bennett                21st December 2006
1598: 0000: \***  New variable added to hold superceded flag for ASN Carton Support.
1599: 0000: \***
1600: 0000: \******************************************************************************
1601: 0000: \******************************************************************************
1602: 0000: 
1603: 0000:   STRING GLOBAL               \
1604: 0000:       DIRORD.FILE.NAME$,      \
1605: 0000:     DIRORD.RECKEY$,           \ 9 byte key which comprises the following fields
1606: 0000:     DIRORD.SUPPLIER$,         \ 3 bytes UPD (key)
1607: 0000:     DIRORD.ORDER.NO$,         \ 2 bytes UPD (key)
1608: 0000:     DIRORD.ORDER.SUF$,        \ 1 byte ASCII (key)
1609: 0000:     DIRORD.BUS.CENTRE$,       \ 1 byte ASCII (key)
1610: 0000:     DIRORD.SOURCE$,           \ 1 byte ASCII (key), 'D' if from PSS57
1611: 0000:                               \                     ' ' for head office order
1612: 0000:     DIRORD.PAGE.NO$,          \ 1 byte UPD (key)
1613: 0000:                               \
1614: 0000:     DIRORD.CONF.END.TIME$,    \ 2 bytes UPD - Ending time of last update
1615: 0000:     DIRORD.CONF.STRT.TIME$,   \ 2 bytes UPD - Starting time of last update
1616: 0000:     DIRORD.CONFIRM.DATE$,     \ 3 bytes UPD. YYMMDD - set to low values if
1617: 0000:                               \                       confirm flag is blank
1618: 0000:     DIRORD.CONFIRM.FLAG$,     \ 1 byte ASCII. C=Complete, A=Amended,
1619: 0000:                               \               blank = not confirmed
1620: 0000:     DIRORD.DRRF.LAST.DATE$,   \ 3 bytes UPD Date of last run
1621: 0000:     DIRORD.DRRF.LAST.TIME$,   \ 2 bytes UPD Time of last run
1622: 0000:     DIRORD.EXP.DELV.DATE$,    \ 3 bytes UPD. YYMMDD - Expected date of order's
1623: 0000:                               \                       delivery
1624: 0000:     DIRORD.FILLER1$,          \ 494 bytes ASCII set to spaces
1625: 0000:     DIRORD.FILLER2$,          \ 474 bytes ASCII set to spaces
1626: 0000:     DIRORD.FILLER3$,          \ 15 bytes ASCII set to spaces
1627: 0000:     DIRORD.ITEM.COUNT$,       \ 1 byte UPD  - Number of items on record
1628: 0000:     DIRORD.ITEM.DETAILS$(2),  \ 256 bytes containing the repeated item string
1629: 0000:                               \ details. The first dimension has 16 elements
1630: 0000:                               \ corresponding to lines on the invoice.  The
1631: 0000:                               \ second dimension has 4 elements:-
1632: 0000:                               \   1. Boots Code - 4 bytes UPD (0 if bar code
1633: 0000:                               \                                has no matching
1634: 0000:                               \                                Boots code on
1635: 0000:                               \                                file)
1636: 0000:                               \   2. Bar Code   - 6 bytes UPD
1637: 0000:                               \   2. Price      - 4 bytes UPD
1638: 0000:                               \   3. Filler     - 2 bytes ASCII spaces
1639: 0000:                               \ Any unused entries are set to spaces
1640: 0000:     DIRORD.NO.ITEMS.BOOKED$,  \ 2 bytes UPD - Total number of items booked in
1641: 0000:     DIRORD.NO.ITEMS.LST.BKD$, \ 2 bytes UPD - Number of items booked in during
1642: 0000:                               \               last date of update
1643: 0000:     DIRORD.NO.ORDER.ITEM$,    \ 2 bytes UPD - Total number of items in order
1644: 0000:     DIRORD.NO.ORDER.SNGL$,    \ 2 bytes UPD - Total single quantity in order
1645: 0000:     DIRORD.ON.SALE.DATE$,     \ 3 bytes UPD. YYMMDD - Date stock should be on
1646: 0000:                               \                       sale
1647: 0000:     DIRORD.ORDER.DATE$,       \ 3 bytes UPD. YYMMDD Date of order
1648: 0000:     DIRORD.SUPERCEDED$        ! 1 byte ASCII (Y/N) default to N             !BNWB
1649: 0000: 
1650: 0000:     INTEGER*2 GLOBAL       \
1651: 0000:       DIRORD.ITEM.QTY%(2), \ contains the repeated item integer details. The
1652: 0000:                            \ first dimension has 16 elements corresponding to
1653: 0000:                            \ lines on the invoice.  The second dimension has 7
1654: 0000:                            \ elements:-
1655: 0000:                            \   1. Quantity expected from order
1656: 0000:                            \   2. Quantity booked in in good condition
1657: 0000:                            \   3. Quantity booked in in damaged condition
1658: 0000:                            \   4. Quantity booked in as stolen
1659: 0000:                            \   5. Quantity last booked in in good condition
1660: 0000:                            \   6. Quantity last booked in in damaged condition
1661: 0000:                            \   7. Quantity last booked in as stolen
1662: 0000:                            \   Fields 2 to 4 are running totals, fields 5 to 7
1663: 0000:                            \   are the values associated with the confirm/amend
1664: 0000:                            \   date.
1665: 0000:       DIRORD.RECL%,        \
1666: 0000:       DIRORD.SESS.NUM%,    \
1667: 0000:       DIRORD.REPORT.NUM%
1668: 0000: 
1669: 0000:     INTEGER*4 GLOBAL       \
1670: 0000:       DIRORD.NO.RECS%
1671: 0000:  %INCLUDE DIRSUDEC.J86                    ! DLC
1672: 0000: REM \
1673: 0000: \******************************************************************************
1674: 0000: \******************************************************************************
1675: 0000: \***
1676: 0000: \***     %INCLUDE FOR STORE DIRECT SUPPLIER FILE FIELD DECLARATIONS
1677: 0000: \***                                             FILE REFERENCE PARAMETERS
1678: 0000: \***      
1679: 0000: \***               FILE TYPE    : Keyed
1680: 0000: \***
1681: 0000: \***               REFERENCE    : DIRSUDEC.J86
1682: 0000: \***
1683: 0000: \***     Version A - L Cook
1684: 0000: \***
1685: 0000: \***     Combined DIRSUFLA.J86 and DIRSUNUA.J86
1686: 0000: \***
1687: 0000: \***   Version B           Mark Goode          3rd December 2008
1688: 0000: \***   Add new fields for the +ve UOD project
1689: 0000: \***
1690: 0000: \******************************************************************************
1691: 0000: \******************************************************************************
1692: 0000: 
1693: 0000:   STRING GLOBAL            \
1694: 0000:     DIRSUP.FILE.NAME$,     \
1695: 0000:     DIRSUP.RECKEY$,        \ 4 byte key which comprises the following fields
1696: 0000:       DIRSUP.BUS.CENTRE$,  \ 1 byte ASCII (key)
1697: 0000:       DIRSUP.SUPPLIER.NO$, \ 3 bytes UPD (key)
1698: 0000:                            \
1699: 0000:     DIRSUP.SUPPLIER.NAME$, \ 10 byte ASCII
1700: 0000:     DIRSUP.LEAD.TIME.MON$, \ 2 bytes UPD. Lead time for MONDAY in days
1701: 0000:     DIRSUP.LEAD.TIME.TUE$, \ 2 bytes UPD. Lead time for TUESDAY in days
1702: 0000:     DIRSUP.LEAD.TIME.WED$, \ 2 bytes UPD. Lead time for WEDNESDAY in days
1703: 0000:     DIRSUP.LEAD.TIME.THU$, \ 2 bytes UPD. Lead time for THURSDAY in days
1704: 0000:     DIRSUP.LEAD.TIME.FRI$, \ 2 bytes UPD. Lead time for FRIDAY in days
1705: 0000:     DIRSUP.LAPSING.DAYS$,  \ 2 bytes UPD. Number of days before order lapses
1706: 0000:     DIRSUP.PART.ORDER.RULES$, \ 1 byte ASCII. A=Rest of order supplied, 
1707: 0000:                               \               N,Z=not supplied 
1708: 0000:     DIRSUP.MAX.CHECK.QTY$,    \ 2 bytes UPD.
1709: 0000:     DIRSUP.CHECK.QTY$,        \ 2 bytes UPD.
1710: 0000:     DIRSUP.DISCREPANCY.QTY$,  \ 2 bytes UPD.
1711: 0000:     DIRSUP.DISCREPANCY.PERC$, \ 2 bytes UPD. Discrepancy percentage
1712: 0000:     DIRSUP.ASN.FLAG$,         \ 1 byte ASCII. Identifies supplier as ASN or Directs   ! BMG
1713: 0000:     DIRSUP.STATIC.SUPPLIER$,  \ 1 byte ASCII. Identifies supplier as being static     ! BMG
1714: 0000:     DIRSUP.FILLER$          ! 3 bytes ASCII set to low values                         ! BMG
1715: 0000: 
1716: 0000:   INTEGER*2 GLOBAL        \
1717: 0000:     DIRSUP.RECL%,         \
1718: 0000:     DIRSUP.SESS.NUM%,     \
1719: 0000:     DIRSUP.REPORT.NUM%
1720: 0000:     
1721: 0000:   INTEGER*4 GLOBAL        \
1722: 0000:     DIRSUP.NO.RECS%  
1723: 0000:  %INCLUDE DIRWFDEC.J86                    ! DLC
1724: 0000: \******************************************************************************
1725: 0000: \******************************************************************************
1726: 0000: \***
1727: 0000: \***      %INCLUDE FOR DIRWF - DIRECT WORK FILE - FIELD DEFINITIONS
1728: 0000: \***                                              FILE REFERENCE PARAMETERS
1729: 0000: \***
1730: 0000: \***
1731: 0000: \***       REFERENCE: DIRWFDEC.J86
1732: 0000: \***
1733: 0000: \******************************************************************************
1734: 0000: \*******************************************************************************
1735: 0000: 
1736: 0000:   STRING GLOBAL								\
1737: 0000: 	DIRWF.FILE.NAME$,						\
1738: 0000: 	DIRWF.RECORD$
1739: 0000: 
1740: 0000:   INTEGER*2 GLOBAL							\
1741: 0000: 	DIRWF.RECL%,	          					\
1742: 0000: 	DIRWF.SESS.NUM%,						\
1743: 0000: 	DIRWF.REPORT.NUM%
1744: 0000:  %INCLUDE DIRECDEC.J86                    ! DLC
1745: 0000: \******************************************************************************
1746: 0000: \******************************************************************************
1747: 0000: \***
1748: 0000: \***         %INCLUDE FOR DIREC DUMMY FILE I/O SESSION NUMBER
1749: 0000: \***
1750: 0000: \***               REFERENCE    : DIRECDEC.J86
1751: 0000: \***
1752: 0000: \******************************************************************************
1753: 0000: \*******************************************************************************
1754: 0000: 
1755: 0000:   STRING GLOBAL           \
1756: 0000:     DIREC.FILE.NAME$
1757: 0000: 
1758: 0000:   INTEGER*2 GLOBAL        \
1759: 0000:     DIREC.REPORT.NUM%,      \
1760: 0000:     DIREC.SESS.NUM%
1761: 0000:  %INCLUDE LDTCFDEC.J86                    ! DLC
1762: 0000: \******************************************************************************
1763: 0000: \******************************************************************************
1764: 0000: \***
1765: 0000: \***      %INCLUDE FOR LDTCF - LDT CHECK FILE - FILE REFERENCE PARAMETERS
1766: 0000: \***                                            FIELD DEFINITIONS
1767: 0000: \***
1768: 0000: \***       REFERENCE: LDTCFDEC.J86
1769: 0000: \***
1770: 0000: \***
1771: 0000: \******************************************************************************
1772: 0000: \*******************************************************************************
1773: 0000: 
1774: 0000:    STRING GLOBAL							\
1775: 0000: 	LDTCF.FILE.NAME$,						\
1776: 0000: 	LDTCF.VERSION.NO$,                                              \
1777: 0000: 	LDTCF.VERSION.DATE$
1778: 0000: 	
1779: 0000:    INTEGER*2 GLOBAL							\
1780: 0000:         LDTCF.SESS.NUM%,						\
1781: 0000: 	LDTCF.REPORT.NUM%
1782: 0000:  %INCLUDE DRSMQDEC.J86                    ! DLC
1783: 0000: \******************************************************************************
1784: 0000: \******************************************************************************
1785: 0000: \***
1786: 0000: \***      %INCLUDE FOR DIRECTS TEMPORARY STOCK MOVEMENT QUEUE
1787: 0000: \***       FILE FIELD DECLARATIONS
1788: 0000: \***       FILE REFERENCE PARAMETERS
1789: 0000: \***
1790: 0000: \***               FILE TYPE    : Sequential
1791: 0000: \***
1792: 0000: \***               REFERENCE    : DRSMQDEC.J86
1793: 0000: \***
1794: 0000: \***
1795: 0000: \******************************************************************************
1796: 0000: \*******************************************************************************
1797: 0000: \***
1798: 0000: \***  The length of the records on this file vary depending on the record
1799: 0000: \***  transaction type, but they all comprise combinations of the fields
1800: 0000: \***  defined below.
1801: 0000: \***
1802: 0000: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1803: 0000: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
1804: 0000: \***     NUMBER, ITEM COUNT, FIELD DELIMITER, ITEM CODE, BAR CODE,
1805: 0000: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
1806: 0000: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
1807: 0000: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1808: 0000: \***
1809: 0000: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1810: 0000: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
1811: 0000: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
1812: 0000: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
1813: 0000: \***
1814: 0000: \*******************************************************************************
1815: 0000: \***
1816: 0000: \***   REVISION 1.0     Neil Bennett                 2nd January 2007
1817: 0000: \***   Add ASN processing support.
1818: 0000: \***
1819: 0000: \*******************************************************************************
1820: 0000: 
1821: 0000:   STRING GLOBAL              \
1822: 0000:     DRSMQ.FILE.NAME$,        \
1823: 0000:     DRSMQ.RECORD$,           \ Used to store the whole record which is unstrung
1824: 0000:                              \ into the fields below
1825: 0000:     DRSMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
1826: 0000:     DRSMQ.TRANS.TYPE$,       \ 1 byte UPD.
1827: 0000:                              \             17 = Delivery without confirmation
1828: 0000:                              \                  of Direct Order detail
1829: 0000:                              \             19 = Delivery without confirmation
1830: 0000:                              \                  of Direct Order header
1831: 0000:     DRSMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1832: 0000:     DRSMQ.DATE$,             \ 3 byte UPD set to current date
1833: 0000:     DRSMQ.TIME$,             \ 3 byte UPD set to current time
1834: 0000:     DRSMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
1835: 0000:     DRSMQ.BOOTS.CODE$,       \ 4 bytes UPD
1836: 0000:     DRSMQ.QUANTITY$,         \ variable length string equivalent to
1837: 0000:                              \ STR$(DRSMQ.QUANTITY%)
1838: 0000:                              \ +ve indicates add to stock
1839: 0000:                              \ -ve indicates subtract from stock
1840: 0000:     DRSMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
1841: 0000:     DRSMQ.SUPPLIER.NO$,      \ 4 bytes UPD
1842: 0000:     DRSMQ.ORDER.NO$,         \ 2 bytes UPD
1843: 0000:     DRSMQ.ORDER.SFX$,        \ 1 byte ASCII
1844: 0000:     DRSMQ.PAGE.NO$,          \ 1 byte UPD
1845: 0000:     DRSMQ.ORDER.DATE$,       \ 3 bytes UPD
1846: 0000:     DRSMQ.SOURCE$,           \ 1 byte ASCII Source flag
1847: 0000:                              \ 'S' - PSS65, 'P' - PDT, PSS57
1848: 0000:     DRSMQ.BAR.CODE$,         \ 6 bytes UPD
1849: 0000:     DRSMQ.QTY.GOOD$,         \ VARIABLE ASCII
1850: 0000:                              \ Quantity of singles booked in in good condition
1851: 0000:     DRSMQ.QTY.BAD$,          \ VARIABLE ASCII
1852: 0000:                              \ Quantity of singles booked in in bad condition
1853: 0000:     DRSMQ.QTY.STOLEN$,       \ VARIABLE ASCII
1854: 0000:                              \ Quantity of singles recognised as stolen
1855: 0000:     DRSMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
1856: 0000:                              \ 'C' - Order has been confirmed
1857: 0000:                              \ 'A' - Order has been amended
1858: 0000:                              \ ' ' - Nothing has been done to the order
1859: 0000:     DRSMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
1860: 0000:                              \ processed
1861: 0000:     DRSMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
1862: 0000:     DRSMQ.SNGLS.ADDED$,      \ 5 bytes ASCII Singles added to order
1863: 0000:     DRSMQ.ITEMS.ADDED$,      \ 5 bytes ASCII Items added to order
1864: 0000:     DRSMQ.ITEMS.BOOKED$,     \ 5 bytes ASCII Items booked in on the order
1865: 0000:     DRSMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.0NWB
1866: 0000:                              \                 'N' Normal Book In           ! 1.0NWB
1867: 0000:                              \                 'A' Carton Audit Process     ! 1.0NWB
1868: 0000:                              \                 'E' Exception Process (nof)  ! 1.0NWB
1869: 0000:     DRSMQ.CARTON.NO$         ! 4 bytes UPD (0-9999)                         ! 1.0NWB
1870: 0000: 
1871: 0000: 
1872: 0000:   INTEGER*2 GLOBAL           \
1873: 0000:     DRSMQ.SESS.NUM%,         \
1874: 0000:     DRSMQ.REPORT.NUM%
1875: 0000:  %INCLUDE LDTBFDEC.J86                    ! ELC
1876: 0000: \******************************************************************************
1877: 0000: \***
1878: 0000: \***           %INCLUDE FOR LDTBF - LDT STOCK BUFFER FILE
1879: 0000: \***
1880: 0000: \***                    - FIELD DECLARATIONS   
1881: 0000: \***                    - FILE REFERENCE PARAMETERS  
1882: 0000: \***  
1883: 0000: \***                    REFERENCE: LDTBFDEC.J86
1884: 0000: \***      
1885: 0000: \******************************************************************************
1886: 0000: \***
1887: 0000: \***     Version A:      Mike Kelsall      12th October 1992
1888: 0000: \***
1889: 0000: \***     Each order in the LDTBF is recorded in the following format:
1890: 0000: \***
1891: 0000: \***         Order Header  -  Record Identifier   2  ASC  "OH"
1892: 0000: \***                          Supplier Number     3  UPD
1893: 0000: \***                          Order Number        2  UPD
1894: 0000: \***                          Order Suffix        1  ASC   
1895: 0000: \*** 
1896: 0000: \***  (N x)  Order Record  -  Record Identifier   2  ASC  "OD"
1897: 0000: \***                          Boots/Bar code      6  UPD
1898: 0000: \***                          Damaged Quantity    2  INT
1899: 0000: \***                          Stolen Quantity     2  INT
1900: 0000: \*** 
1901: 0000: \***         Order Trailer -  Record Identifier   2  ASC  "OT"
1902: 0000: \***                          Number of items     2  INT 
1903: 0000: \***
1904: 0000: \***
1905: 0000: \***     Version B.          Stuart Highley            8th August 1997
1906: 0000: \***     Added fields: LDTBF.DATE$, LDTBF.START.TIME$, LDTBF.END.TIME$,
1907: 0000: \***                   LDTBF.LOGGED.QTY%
1908: 0000: \***
1909: 0000: \******************************************************************************
1910: 0000: 
1911: 0000: INTEGER*1 GLOBAL                 \
1912: 0000:                                  \
1913: 0000:            LDTBF.SESS.NUM% 
1914: 0000: 
1915: 0000: 
1916: 0000: INTEGER*2 GLOBAL                 \
1917: 0000:                                  \
1918: 0000:            LDTBF.RECL%,          \
1919: 0000:            LDTBF.REPORT.NUM%,    \
1920: 0000:                                  \
1921: 0000:            LDTBF.LOGGED.QTY%,    \  2 byte INT - Already logged qty    ! BSH
1922: 0000:            LDTBF.DAMAGED.QTY%,   \  2 byte INT - Damaged quantity, from LDT
1923: 0000:            LDTBF.STOLEN.QTY%,    \  2 byte INT - Stolen quantity, from LDT
1924: 0000:            LDTBF.GOOD.QTY%,      \  2 byte INT - Good quantity, from LDT
1925: 0000:            LDTBF.ORDERED.QTY%,   \  2 byte INT - Ordered quantity
1926: 0000:            LDTBF.NUM.OF.ITEMS%   !  2 byte INT - Number of items in order
1927: 0000:      
1928: 0000: 
1929: 0000: STRING GLOBAL                    \
1930: 0000:                                  \
1931: 0000:            LDTBF.FILE.NAME$,     \
1932: 0000:                                  \
1933: 0000:            LDTBF.RECORD.ID$,     \  2 byte ASC - Record Identifier
1934: 0000:            LDTBF.SUPPLIER.NUM$,  \  3 byte UPD - Supplier number, from LDT
1935: 0000:            LDTBF.ORDER.NUM$,     \  2 byte UPD - Order number, from LDT 
1936: 0000:            LDTBF.ORDER.SUFFIX$,  \  1 byte ASC - Order suffix, from LDT
1937: 0000:            LDTBF.DATE$,          \  3 byte UPD - Date booked in        ! BSH
1938: 0000:            LDTBF.START.TIME$,    \  2 byte UPD - Time started booking  ! BSH
1939: 0000:            LDTBF.END.TIME$,      \  2 byte UPD - Time ended booking    ! BSH
1940: 0000:            LDTBF.REF.CODE$       !  6 byte UPD - Boots/Bar code, from LDT
1941: 0000:  %INCLUDE IDSOFDEC.J86                    ! ELC
1942: 0000: REM \
1943: 0000: \******************************************************************************
1944: 0000: \******************************************************************************
1945: 0000: \***
1946: 0000: \***      %INCLUDE FOR CSR OUTSTANDING INITIAL STOCK QUANTITIES FILE
1947: 0000: \***                                             FIELD DECLARATIONS
1948: 0000: \***                                             FILE REFERENCE PARAMETERS
1949: 0000: \***
1950: 0000: \***               FILE TYPE    : Keyed
1951: 0000: \***
1952: 0000: \***               REFERENCE    : IDSOFFLD.J86
1953: 0000: \***
1954: 0000: \***      Version A.     Stephen Kelsey (CTG)               21st October 1992
1955: 0000: \***
1956: 0000: \******************************************************************************
1957: 0000: \*******************************************************************************
1958: 0000: 
1959: 0000:   STRING GLOBAL                  \
1960: 0000:     IDSOF.BC.LETTER$,            \ 1 byte UPD
1961: 0000:     IDSOF.EXP.DELV.DATE$,        \ 3 byte UPD YYMMDD
1962: 0000:     IDSOF.FILE.NAME$,            \
1963: 0000:     IDSOF.FILLER$,               \ 10 bytes ASC
1964: 0000:     IDSOF.ITEM.CODE$             ! 4 byte UPD
1965: 0000: 
1966: 0000:   INTEGER*2 GLOBAL               \
1967: 0000:     IDSOF.QUANTITY%,             \ Outstanding Stock Quantity
1968: 0000:     IDSOF.RECL%,                 \     
1969: 0000:     IDSOF.REPORT.NUM%,           \     
1970: 0000:     IDSOF.SESS.NUM% 
1971: 0000:     
1972: 0000:  %INCLUDE UODDEC.J86                      ! FLC
1973: 0000: \******************************************************************************
1974: 0000: \******************************************************************************
1975: 0000: \***
1976: 0000: \***         %INCLUDE FOR UOD DUMMY FILE I/O SESSION NUMBER
1977: 0000: \***
1978: 0000: \***               REFERENCE    : UODDEC.J86
1979: 0000: \***
1980: 0000: \******************************************************************************
1981: 0000: \*******************************************************************************
1982: 0000: 
1983: 0000:   STRING GLOBAL           \
1984: 0000:     UOD.FILE.NAME$
1985: 0000: 
1986: 0000:   INTEGER*2 GLOBAL        \
1987: 0000:     UOD.REPORT.NUM%,      \
1988: 0000:     UOD.SESS.NUM%
1989: 0000:  %INCLUDE UODBFDEC.J86                    ! FLC
1990: 0000: REM \
1991: 0000: \******************************************************************************
1992: 0000: \******************************************************************************
1993: 0000: \***
1994: 0000: \***      %INCLUDE FOR UOD BUFFER FILE FIELD DECLARATIONS
1995: 0000: \***                              FILE REFERENCE PARAMETERS
1996: 0000: \***
1997: 0000: \***               FILE TYPE    : Sequential
1998: 0000: \***
1999: 0000: \***               REFERENCE    : UODBFDEC.J86
2000: 0000: \***
2001: 0000: \***      Version A.     Michael Kelsall             8th February 1993
2002: 0000: \***
2003: 0000: \******************************************************************************
2004: 0000: \*******************************************************************************
2005: 0000: \***
2006: 0000: \***  The length of the records on this file vary depending on the record
2007: 0000: \***  transaction type, but they all comprise combinations of the fields
2008: 0000: \***  defined below.
2009: 0000: \***
2010: 0000: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,       
2011: 0000: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
2012: 0000: \***     END OF RECORD MARKER.
2013: 0000: \***
2014: 0000: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, DATE, TIME, 
2015: 0000: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
2016: 0000: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
2017: 0000: \***
2018: 0000: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, DATE, TIME,
2019: 0000: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
2020: 0000: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, 
2021: 0000: \***     FIELD DELIMITER, FSI, FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, 
2022: 0000: \***     FOLIO NO, RECORD DELIMITER, END OF RECORD MARKER
2023: 0000: \***
2024: 0000: \******************************************************************************
2025: 0000: 
2026: 0000:   STRING GLOBAL              \
2027: 0000:     UODBF.FILE.NAME$,	     \
2028: 0000:     UODBF.RECORD$,           \ Used to store the whole record which is unstrung
2029: 0000:                              \ into the fields below
2030: 0000:     UODBF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2031: 0000:     UODBF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2032: 0000:     UODBF.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0Ah
2033: 0000:     UODBF.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
2034: 0000: 			     \             21 = UOD record
2035: 0000: 			     \             23 = Item Level UOD record
2036: 0000:     UODBF.CREATION.DATE$,    \ 3 byte UPD set to current date
2037: 0000:     UODBF.CREATION.TIME$,    \ 3 byte UPD set to current time
2038: 0000:     UODBF.DATE$,             \ 3 byte UPD set to current date
2039: 0000:     UODBF.TIME$,             \ 3 byte UPD set to current time
2040: 0000:     UODBF.DIST.CENTRE$,      \ 1 byte UPD   
2041: 0000:     UODBF.WAREHOUSE.NUM$,    \ 1 byte UPD   
2042: 0000:     UODBF.STORE.NUM$,        \ 2 byte UPD
2043: 0000:     UODBF.UOD.NUMBER$,       \ 2 byte UPD
2044: 0000:     UODBF.STATUS$,           \ 1 byte ASC.  "B" = Booked in
2045: 0000:     			     \		    "M" = Missing
2046: 0000: 			     \		    "O" = Opened
2047: 0000: 			     \		    "P" = Picking checked
2048: 0000: 			     \		    "R" = Retro booked in
2049: 0000: 			     \		    "D" = Retrospective opened
2050: 0000: 			     \		    "G" = Retrospective checked
2051: 0000: 			     \		    "A" = Automatically booked in
2052: 0000:     UODBF.BOOTS.BAR.CODE$,   \ 6 byte UPD    
2053: 0000:     UODBF.BOOTS.BAR.CODE.FLAG$, \ 1 byte ASC
2054: 0000:     UODBF.FSI$,              \ 1 byte ASCII
2055: 0000:     UODBF.FOLIO.YEAR$,       \ 1 byte UPD
2056: 0000:     UODBF.FOLIO.MONTH$,      \ 1 byte UPD
2057: 0000:     UODBF.FOLIO.NUMBER$,     \ 2 bytes UPD
2058: 0000:     UODBF.STORE.SUFFIX$      ! 1 byte ASCII
2059: 0000: 
2060: 0000: 			     			     			     
2061: 0000:   INTEGER*2 GLOBAL	     \
2062: 0000:     UODBF.SESS.NUM%,         \
2063: 0000:     UODBF.REPORT.NUM%,	     \
2064: 0000:     UODBF.QUANTITY%
2065: 0000: 			     
2066: 0000:  %INCLUDE UODTFDEC.J86                    ! FLC
2067: 0000: \******************************************************************************
2068: 0000: \******************************************************************************
2069: 0000: \***
2070: 0000: \***      %INCLUDE FOR UODS TEMPORARY FILE
2071: 0000: \***       FILE FIELD DECLARATIONS
2072: 0000: \***       FILE REFERENCE PARAMETERS
2073: 0000: \***
2074: 0000: \***               FILE TYPE    : Sequential
2075: 0000: \***
2076: 0000: \***               REFERENCE    : UODTFDEC.J86
2077: 0000: \***
2078: 0000: \***
2079: 0000: \******************************************************************************
2080: 0000: \*******************************************************************************
2081: 0000: 
2082: 0000:   STRING GLOBAL              \
2083: 0000:     UODTF.FILE.NAME$,	     \
2084: 0000:     UODTF.RECORD$            ! Used to store the whole record 
2085: 0000: 			     			     			     
2086: 0000:   INTEGER*2 GLOBAL	     \
2087: 0000:     UODTF.SESS.NUM%,	     \
2088: 0000:     UODTF.REPORT.NUM%			     
2089: 0000: 			     
2090: 0000:  %INCLUDE PILSTDEC.J86                    ! FLC
2091: 0000: 
2092: 0000: \******************************************************************************
2093: 0000: \***
2094: 0000: \***      %INCLUDE FOR PILST - LIST OF LISTS FILE - FIELD DECLARATIONS
2095: 0000: \***                                                FILE REFERENCE PARAMETERS
2096: 0000: \***
2097: 0000: \***                           8th October 1992
2098: 0000: \***
2099: 0000: \******************************************************************************
2100: 0000: 
2101: 0000:    INTEGER*1 GLOBAL             	\
2102: 0000:         PILST.REPORT.NUM%,		\
2103: 0000: 	PILST.SESS.NUM%,		\
2104: 0000: 	PILST.ITEMS.IN.LIST%,		\ No of items in list
2105: 0000: 	PILST.TO.BE.COUNTED%		! No of items left to be counted
2106: 0000: 
2107: 0000:    INTEGER*2 GLOBAL			\
2108: 0000:         PILST.RECL%
2109: 0000: 
2110: 0000:    STRING GLOBAL			\
2111: 0000: 	PILST.FILE.NAME$,		\
2112: 0000: 	PILST.LIST.NUMBER$,		\ 4 byte - list number
2113: 0000: 	PILST.SPARE.LIST.NUMBER$,	\ 4 byte - spare list number
2114: 0000: 	PILST.LIST.NAME$,		\12 byte - list name
2115: 0000: 	PILST.BC.LETTER$,		\ 1 byte - business centre letter
2116: 0000: 	PILST.LIST.TYPE$,		\ 1 byte - list type :
2117: 0000: 					\    "R" = regular,
2118: 0000: 					\    "C" = CSR,
2119: 0000: 					\    "E" = exceptions.
2120: 0000: 	PILST.COUNT.BY.DATE$,		\ 3 byte UPD - count by date
2121: 0000: 	PILST.PRODUCT.GROUP$,		\ 3 byte UPD - product group
2122: 0000: 	PILST.COUNT.DATE$,		\ 3 byte UPD - scheduled count date
2123: 0000: 	PILST.LIST.STATUS$,		\ 1 byte - list status :
2124: 0000: 					\    "C" = to be counted,
2125: 0000: 					\    "R" = to be re-counted,
2126: 0000: 					\    "X" = cancelled,
2127: 0000: 					\    "F" = completed.
2128: 0000: 	PILST.RECOUNT.DATE$,		\ 3 byte UPD - scheduled re-count date
2129: 0000: 	PILST.RECOUNT.ALLOWED$,		\ 1 byte UPD - re-count allowed flag
2130: 0000: 	PILST.CPM.RUN.DATE$,		\ 3 byte UPD - cpm. run date
2131: 0000: 	PILST.PIPLN.RUN.OK$,	        \ 1 byte - PIPLN run ok flag "Y" / "N"
2132: 0000: 	PILST.HIGHEST.LIST.NO$,	        \ 4 byte - highest transmitted list no
2133: 0000:         PILST.DET.FILLER$,              \ 6 bytes
2134: 0000:         PILST.HDR.FILLER$               ! 24 bytes
2135: 0000: 	
2136: 0000:  %INCLUDE PIITMDEC.J86                    ! FLC
2137: 0000: 
2138: 0000: \******************************************************************************
2139: 0000: \***
2140: 0000: \***     %INCLUDE FOR PIITM - ITEM LIST FILE - FIELD DECLARATIONS
2141: 0000: \***                                           FILE REFERENCE PARAMETERS
2142: 0000: \***
2143: 0000: \***     REFERENCE: PIITMDEC.J86
2144: 0000: \***        
2145: 0000: \***                           8TH OCTOBER 1992
2146: 0000: \***
2147: 0000: \******************************************************************************
2148: 0000: 
2149: 0000:    INTEGER*1 GLOBAL							\
2150: 0000: 	PIITM.REPORT.NUM%,						\
2151: 0000: 	PIITM.SESS.NUM%
2152: 0000: 
2153: 0000:    INTEGER*2 GLOBAL			\
2154: 0000: 	PIITM.RECL%,			\
2155: 0000: 	PIITM.DISCREPANCY%,		\ discrepancy
2156: 0000: 	PIITM.DISCREPANCY.AMT%		! discrepancy amount
2157: 0000: 	
2158: 0000:    STRING GLOBAL			\
2159: 0000: 	PIITM.FILE.NAME$,		\
2160: 0000: 	PIITM.LIST.ITEM.KEY$,		\ 4 + 1 bytes - list no. & item no
2161: 0000: 	PIITM.LIST.NUMBER$,		\ 4 byte - list number
2162: 0000: 	PIITM.ITEM.NUMBER$,		\ 2 byte - item number
2163: 0000: 	PIITM.ITEM.CODE$,		\ 4 byte UPD - item code
2164: 0000: 	PIITM.ON.IDF$,			\ 1 byte - on IDF flag "Y" / "N"
2165: 0000: 	PIITM.ACTIVITY.FLAG$,		\ 1 byte - activity flag
2166: 0000: 	PIITM.CYCLE.LENGTH$,		\ 2 byte - count cycle length (weeks)
2167: 0000: 	PIITM.FAMILY.MARKER$,		\ 2 byte - family marker
2168: 0000: 	PIITM.MEMBERS$,			\ 2 byte - number of members
2169: 0000: 	PIITM.ELIGIBILITY.FLAG$,	\ 1 byte - eligibility flag
2170: 0000: 	PIITM.LIST.STATUS$,		\ 1 byte - list status :
2171: 0000: 					\    "C" = to be counted,
2172: 0000: 					\    "R" = to be re-counted,
2173: 0000: 					\    "D" = counted,
2174: 0000: 					\    "F" = completed,
2175: 0000: 					\    "X" = cancelled.
2176: 0000: 	PIITM.POTENTIAL.RECOUNT$,	\ 1 byte - potential recount flag :
2177: 0000: 					\    "0" = not a potential re-count,
2178: 0000: 					\    "1" = failed value test,
2179: 0000: 					\    "2" = failed percentage test.
2180: 0000:         PIITM.FILLER$                   ! 5 bytes
2181: 0000: 					
2182: 0000: !%INCLUDE PDTWFDEC.J86                    ! FLC
2183: 0000: !%INCLUDE IRFDEC.J86                      ! FLC TEST
2184: 0000: 
2185: 0000:  %INCLUDE CCUODDEC.J86                    ! GMJK
2186: 0000: 
2187: 0000: \*****************************************************************************
2188: 0000: \*****************************************************************************
2189: 0000: \***
2190: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2191: 0000: \***
2192: 0000: \***                   FILE TYPE:  KEYED
2193: 0000: \***
2194: 0000: \***                   REFERENCE:  CCUODDEC.J86
2195: 0000: \***
2196: 0000: \***                 DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2197: 0000: \***                   FILE OF OPEN/CLOSED UODS
2198: 0000: \***
2199: 0000: \***
2200: 0000: \***    VERSION A : Michael J. Kelsall      13th September 1993
2201: 0000: \***      
2202: 0000: \***    VERSION B : Mark Walker                   18th Jul 2015
2203: 0000: \***    F392 Retail Stock 5
2204: 0000: \***    Added CCUOD.RETRIEVAL.FLAG$ field to allow record to be
2205: 0000: \***    marked as processed.
2206: 0000: \***
2207: 0000: \*****************************************************************************
2208: 0000: \*****************************************************************************
2209: 0000: 
2210: 0000: STRING GLOBAL           \
2211: 0000:    CCUOD.FILE.NAME$,        \
2212: 0000:    CCUOD.UOD.NUM$,      \  7 byte UPD;  Record key
2213: 0000:    CCUOD.STATUS$,       \  1 byte ASC;  "O" = Open,
2214: 0000:                 \           "C" = Closed,
2215: 0000:                 \           "D" = Despatched,       
2216: 0000:                 \           "X" = Cancelled.
2217: 0000:    CCUOD.CREDIT.CLAIM.NUM$, \  4 byte UPD
2218: 0000:                 \  CCUOD.NUM.OF.ITEMS% here (I2)
2219: 0000:    CCUOD.SUPPLY.ROUTE$,     \  1 byte ASC;  "W" = Warehouse,
2220: 0000:                 \           "E" = EPSOM,
2221: 0000:                 \           "O" = Other Directs,
2222: 0000:                 \               "D" = Dispensary.
2223: 0000:    CCUOD.DISP.LOCATION$,    \  1 byte ASC   "M" = MDS, "D" = Dispensary.
2224: 0000:    CCUOD.BC.LETTER$,        \  1 byte ASC    
2225: 0000:    CCUOD.RECALL.NUM$,       \  8 byte ASC
2226: 0000:    CCUOD.AUTHORISATION$,    \ 15 byte ASC
2227: 0000:    CCUOD.SUPPLIER$,     \ 15 byte ASC
2228: 0000:    CCUOD.METHOD.OF.RETURN$, \  1 byte UPD;   1 = Carrier,
2229: 0000:                 \                2 = BIRD,
2230: 0000:                 \        3 = Via D6,
2231: 0000:                 \        4 = Representative.
2232: 0000:    CCUOD.CARRIER$,      \  1 byte UPD;   1 = GPO,
2233: 0000:                 \                2 = Parcelforce,
2234: 0000:                 \        3 = Securicor,
2235: 0000:                 \        4 = Other.
2236: 0000:    CCUOD.BIRD.NUM$,     \  8 byte ASC                   
2237: 0000:    CCUOD.REASON.NUM$,       \  1 byte UPD     (See CSRNS declaration)
2238: 0000:    CCUOD.RECEIVING.STORE$,  \  2 byte UPD    
2239: 0000:    CCUOD.DESTINATION$,      \  1 byte UPD    1 = Business Centre, 
2240: 0000:                 \            2 = MTS,
2241: 0000:                 \        3 = Pharmacy, 
2242: 0000:                 \        4 = Other.
2243: 0000:    CCUOD.WAREHOUSE.ROUTE$,  \  1 byte ASC   "R" = RDC, "C" = CSR.
2244: 0000:    CCUOD.UOD.TYPE$,     \  1 byte UPD    1 = Travel Outer,
2245: 0000:                 \        2 = Town tray,
2246: 0000:                 \        3 = Roll cage,
2247: 0000:                 \                4 = Other.
2248: 0000:    CCUOD.DAMAGE.REASON$,         \  1 byte UPD    1 = Bad packaging,    
2249: 0000:                 \        2 = Poor handling.
2250: 0000:    CCUOD.DATE.UOD.OPENED$,  \  3 byte UPD 
2251: 0000:    CCUOD.DATE.UOD.DESPATCHED$,  \  3 byte UPD
2252: 0000:    CCUOD.TIME.UOD.DESPATCHED$,  \  3 byte UPD
2253: 0000:    CCUOD.RETRIEVAL.FLAG$, \  1 byte ASC;  " " = to be retrieved             !BMW
2254: 0000:                           \               "N" = marked as processed         !BMW
2255: 0000:    CCUOD.FILLER$,       \ 19 byte ASC;   Spaces.
2256: 0000:                 \
2257: 0000:                 \
2258: 0000:                 \
2259: 0000:    CCUOD.HEADER$,       \   Hdr rec layout; (key of High values)
2260: 0000:    CCUOD.DATE.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2261: 0000:    CCUOD.TIME.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2262: 0000:    CCUOD.LDT.NUM$,      \  3 byte UPD (Zeros if no outstanding data
2263: 0000:                 \              to be processed by PSS35)
2264: 0000:    CCUOD.HEADER.FILLER$     ! 84 byte ASC;  Spaces.
2265: 0000: 
2266: 0000: 
2267: 0000: INTEGER*2 GLOBAL        \
2268: 0000:    CCUOD.RECL%,         \
2269: 0000:    CCUOD.REPORT.NUM%,       \
2270: 0000:    CCUOD.SESS.NUM%,     \
2271: 0000:                 \
2272: 0000:    CCUOD.NUM.OF.ITEMS%      ! 2 byte INT
2273: 0000: 
2274: 0000:  %INCLUDE CCLAMDEC.J86                    ! 1.4
2275: 0000: 
2276: 0000: \*****************************************************************************
2277: 0000: \*****************************************************************************
2278: 0000: \***
2279: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2280: 0000: \***
2281: 0000: \***                   FILE TYPE:  KEYED
2282: 0000: \***
2283: 0000: \***                   REFERENCE:  CCLAMDEC.J86
2284: 0000: \***
2285: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2286: 0000: \***				   FILE OF CURRENT CREDIT CLAIMS
2287: 0000: \***
2288: 0000: \***
2289: 0000: \***      VERSION A : Michael J. Kelsall      16th December 1993
2290: 0000: \***      
2291: 0000: \*****************************************************************************
2292: 0000: \*****************************************************************************
2293: 0000: 
2294: 0000: STRING GLOBAL			\
2295: 0000:    CCLAM.FILE.NAME$,		\
2296: 0000:    CCLAM.CREDIT.CLAIM.NUM$,	\  4 byte UPD;   Record Key
2297: 0000:    CCLAM.UOD.NUM$,		\  7 byte UPD
2298: 0000:    				\  CCLAM.NUM.OF.ITEMS% here (I2)
2299: 0000:    CCLAM.SUPPLY.ROUTE$,		\  1 byte ASC;  "W" = Warehouse,
2300: 0000:    				\ 	        "E" = EPSOM,
2301: 0000: 				\	        "O" = Other Directs,
2302: 0000: 				\               "D" = Dispensary.
2303: 0000:    CCLAM.DISP.LOCATION$,	\  1 byte ASC   "M" = MDS, "D" = Dispensary.
2304: 0000:    CCLAM.BC.LETTER$,		\  1 byte ASC    
2305: 0000:    CCLAM.RECALL.NUM$,		\  8 byte ASC
2306: 0000:    CCLAM.AUTHORISATION$,	\ 15 byte ASC
2307: 0000:    CCLAM.SUPPLIER$,		\ 15 byte ASC
2308: 0000:    CCLAM.METHOD.OF.RETURN$,	\  1 byte UPD;   1 = Carrier,
2309: 0000:    				\                2 = BIRD,
2310: 0000: 				\	 	 3 = Via D6,
2311: 0000: 				\		 4 = Representative.
2312: 0000:    CCLAM.CARRIER$,		\  1 byte UPD;   1 = GPO,
2313: 0000:    				\                2 = Parcelforce,
2314: 0000: 				\	 	 3 = Securicor,
2315: 0000: 				\ 		 4 = Other.
2316: 0000:    CCLAM.BIRD.NUM$,		\  8 byte ASC					
2317: 0000:    CCLAM.REASON.NUM$,		\  1 byte UPD     (See CSRNS declaration)
2318: 0000:    CCLAM.RECEIVING.STORE$,	\  2 byte UPD    
2319: 0000:    CCLAM.DESTINATION$,		\  1 byte UPD    1 = Business Centre, 
2320: 0000:    				\	         2 = MTS,
2321: 0000:    				\		 3 = Pharmacy, 
2322: 0000: 				\		 4 = Other.
2323: 0000:    CCLAM.WAREHOUSE.ROUTE$,	\  1 byte ASC   "R" = RDC, "C" = CSR.
2324: 0000:    CCLAM.UOD.TYPE$,		\  1 byte UPD    1 = Travel Outer,
2325: 0000:    				\		 2 = Town tray,
2326: 0000: 				\		 3 = Roll cage,
2327: 0000: 				\     	         4 = Other.
2328: 0000:    CCLAM.DAMAGE.REASON$,        \  1 byte UPD    1 = Bad packaging,	
2329: 0000:    				\		 2 = Poor handling.
2330: 0000:    CCLAM.INVOICE.NUM$,		\* 9 byte ASC 
2331: 0000:    CCLAM.FOLIO.NUM$,		\  3 byte UPD
2332: 0000:    CCLAM.BATCH.REF$,		\  3 byte UPD
2333: 0000:    CCLAM.WHOLE.PART.CON$,       \  1 byte ASC   "W" = Whole, "P" = Part
2334: 0000:    CCLAM.REPAIR.CATEGORY$, 	\  1 byte UPD;   1 = Plan4,
2335: 0000:    				\   		 2 = Estimate,
2336: 0000: 				\		 3 = Boots guarantee,
2337: 0000: 				\		 4 = Supplier guarantee,
2338: 0000: 				\		 5 = Other guarantee,
2339: 0000:    CCLAM.REPAIR.NUM$,		\  6 byte UPD
2340: 0000:    CCLAM.PLAN4.POLICY.NUM$,	\  6 byte UPD 
2341: 0000:    CCLAM.DDDA.DCDR.NUM$,	\  4 byte UPD
2342: 0000:    CCLAM.DELIV.NOTE.NUM$,	\* 9 byte ASC
2343: 0000:    CCLAM.DELIV.DATE$,		\  3 byte UPD
2344: 0000:    CCLAM.NUM.CARTONS.RECEIV$,	\  1 byte UPD
2345: 0000:    CCLAM.ORDER.NUM$,		\  7 byte ASC
2346: 0000:    CCLAM.COMMENT$,  		\*20 byte ASC
2347: 0000:    CCLAM.DATE.OF.CLAIM$,	\  3 byte UPD;  Date of UOD despatch
2348: 0000:    CCLAM.TIME.OF.CLAIM$,	\  3 byte UPD;  Time of UOD despatch
2349: 0000:    CCLAM.RETRIEVAL.FLAG$,	\  1 byte ASC;  "Y", "N"  PSS35 sets to Y
2350: 0000:    				\                         PSB30 sets to N
2351: 0000:    CCLAM.CF.RPT.MARKER$,	\  1 byte ASC;  "Y"       PSS35 sets to Y
2352: 0000:    				\               "N"       PSS20 sets to N
2353: 0000:    CCLAM.CANC.MARKER$,		\  1 byte ASC;  Y or N
2354: 0000:    CCLAM.FILLER$		!  7 byte ASC;  Spaces.
2355: 0000: 
2356: 0000: 
2357: 0000: INTEGER*2 GLOBAL		\
2358: 0000:    CCLAM.RECL%,			\
2359: 0000:    CCLAM.REPORT.NUM%,		\
2360: 0000:    CCLAM.SESS.NUM%,		\
2361: 0000: 				\
2362: 0000:    CCLAM.NUM.OF.ITEMS%		!  2 byte INT
2363: 0000: 
2364: 0000:  %INCLUDE CCITMDEC.J86                    ! GMJK
2365: 0000: 
2366: 0000: \*****************************************************************************
2367: 0000: \*****************************************************************************
2368: 0000: \***
2369: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2370: 0000: \***
2371: 0000: \***                   FILE TYPE:  KEYED
2372: 0000: \***
2373: 0000: \***                   REFERENCE:  CCUODITM.J86
2374: 0000: \***
2375: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2376: 0000: \***				   FILE OF ITEMS PER OPEN/CLOSED UOD
2377: 0000: \***
2378: 0000: \***
2379: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
2380: 0000: \***      
2381: 0000: \*****************************************************************************
2382: 0000: \*****************************************************************************
2383: 0000: 
2384: 0000: STRING GLOBAL			\
2385: 0000:    CCITM.FILE.NAME$,		\
2386: 0000:    CCITM.KEY$,			\  Consists of next two fields;
2387: 0000:    CCITM.UOD.NUM$,		\  7 byte UPD
2388: 0000:    CCITM.ITEM.NUM$,		\  2 byte UPD
2389: 0000:    				\
2390: 0000:    CCITM.BOOTS.BAR.CODE.FLAG$,	\  1 byte ASC;  "I" = Boots code,
2391: 0000:    				\		"B" = Bar code.
2392: 0000:    CCITM.BOOTS.BAR.CODE$,	\  7 byte UPD
2393: 0000:    				\  CCITM.QTY% here (I2)
2394: 0000:    CCITM.FILLER$                !  4 byte ASC;  Spaces
2395: 0000:       				
2396: 0000: 
2397: 0000: INTEGER*2 GLOBAL		\
2398: 0000:    CCITM.RECL%,			\
2399: 0000:    CCITM.REPORT.NUM%,		\
2400: 0000:    CCITM.SESS.NUM%,		\
2401: 0000: 				\
2402: 0000:    CCITM.QTY%			!  2 byte INT
2403: 0000: 
2404: 0000:  %INCLUDE CCTRLDEC.J86                    ! GMJK
2405: 0000: 
2406: 0000: \*****************************************************************************
2407: 0000: \*****************************************************************************
2408: 0000: \***
2409: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2410: 0000: \***
2411: 0000: \***                   FILE TYPE:  DIRECT
2412: 0000: \***
2413: 0000: \***                   REFERENCE:  CCTRLDEC.J86
2414: 0000: \***
2415: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2416: 0000: \***				   CREDIT CLAIMS CONTROL FILE
2417: 0000: \***
2418: 0000: \***
2419: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
2420: 0000: \***      
2421: 0000: \*****************************************************************************
2422: 0000: \*****************************************************************************
2423: 0000: 
2424: 0000: STRING GLOBAL			\
2425: 0000:    CCTRL.FILE.NAME$,		\
2426: 0000:    CCTRL.RECORD$,		\
2427: 0000:    CCTRL.CREDIT.CLAIM.NUM$,	\  4 byte UPD
2428: 0000:    CCTRL.CREDIT.RPT.RUN.DATE$,	\  3 byte UPD
2429: 0000:    CCTRL.UOD.RPT.RUN.DATE$,	\  3 byte UPD
2430: 0000:    CCTRL.FILLER$		! 65 byte ASC;  Spaces
2431: 0000:    
2432: 0000: 
2433: 0000: INTEGER*2 GLOBAL		\
2434: 0000:    CCTRL.RECL%,			\
2435: 0000:    CCTRL.REPORT.NUM%,		\
2436: 0000:    CCTRL.SESS.NUM%,		\
2437: 0000:    CCTRL.REC.NUM%
2438: 0000: 
2439: 0000: INTEGER*4 GLOBAL		\
2440: 0000:    CCTRL.STAFF.SALES%		!  4 INT, total sales to store staff,
2441: 0000:    				!  stored as 5 byte UPD on file
2442: 0000: 
2443: 0000:  %INCLUDE CCTMPDEC.J86                    ! GMJK
2444: 0000: REM \
2445: 0000: \******************************************************************************
2446: 0000: \******************************************************************************
2447: 0000: \***
2448: 0000: \***      %INCLUDE FOR CREDIT CLAIMING TEMPORARY FILE FIELD DECLARATIONS
2449: 0000: \***                                             FILE REFERENCE PARAMETERS
2450: 0000: \***
2451: 0000: \***               FILE TYPE    : Sequential
2452: 0000: \***
2453: 0000: \***               REFERENCE    : CCTMPDEC.J86
2454: 0000: \***
2455: 0000: \***      Version A.     Michael J. Kelsall           30th September 1993.
2456: 0000: \***
2457: 0000: \***      Version 1.1    Brian Greenfield             14th May 2007
2458: 0000: \***      Added new variable CCTMP.RECALL.TYPE$ for A7C Recalls.
2459: 0000: \***
2460: 0000: \******************************************************************************
2461: 0000: \*******************************************************************************
2462: 0000: \***
2463: 0000: \***  The length of the records on this file vary depending on the record
2464: 0000: \***  transaction type, but they all comprise combinations of the fields
2465: 0000: \***  defined below.
2466: 0000: \***
2467: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
2468: 0000: \***
2469: 0000: \***  Transaction type 24 - Whole or Part consignment record
2470: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
2471: 0000: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
2472: 0000: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
2473: 0000: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
2474: 0000: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
2475: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
2476: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
2477: 0000: \***
2478: 0000: \***  Transaction type 26 - Data from LDT
2479: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
2480: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
2481: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
2482: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
2483: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
2484: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
2485: 0000: \***     DESPATCHED, RECALL.TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.1BG
2486: 0000: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
2487: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
2488: 0000: \***
2489: 0000: \***  Transaction type 28 - Cancelled Credit Claim
2490: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
2491: 0000: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
2492: 0000: \***
2493: 0000: \******************************************************************************
2494: 0000: 
2495: 0000:   STRING GLOBAL              \
2496: 0000:     CCTMP.FILE.NAME$,        \
2497: 0000:     CCTMP.RECORD$,           \ Used to store the whole record which is unstrung
2498: 0000:                              \ into the fields below
2499: 0000:     CCTMP.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2500: 0000:     CCTMP.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
2501: 0000:                  \             25 = NS16 / Misc cont txn (R/ACC)
2502: 0000:                  \             26 = Data from LDT (R/ACC)
2503: 0000:                  \             27 = End of LDT session (R/ACC)
2504: 0000:                  \         28 = Canc. Credit Claim (R/ACC)
2505: 0000:     CCTMP.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2506: 0000:     CCTMP.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0AH
2507: 0000:     CCTMP.BC.LETTER$,        \ 1 byte ASCII
2508: 0000:     CCTMP.CREDIT.CLAIM.NUM$, \ 4 byte UPD
2509: 0000:     CCTMP.NUM.ITEMS.UPDATED$,\ 4 byte ASCII
2510: 0000:     CCTMP.TOTAL.QTY.IN.UOD$, \ 4 byte ASCII
2511: 0000:     CCTMP.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
2512: 0000:                      \          "E" = Excess,
2513: 0000:                  \              "R" = Repairs
2514: 0000:     CCTMP.SUPPLIER.NUM$,     \ 3 byte UPD
2515: 0000:     CCTMP.INVOICE.NUM$,      \ 3 byte UPD 
2516: 0000:     CCTMP.FOLIO.NUM$,        \ 3 byte UPD
2517: 0000:     CCTMP.BATCH.REF$,        \ 3 byte UPD
2518: 0000:     CCTMP.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
2519: 0000:                  \           2 = Estimate,
2520: 0000:                  \           3 = Boots guarantee,
2521: 0000:                  \           4 = Supplier guarantee,
2522: 0000:                  \           5 = Other guarantee,
2523: 0000:     CCTMP.REPAIR.NUM$,       \ 4 byte UPD
2524: 0000:     CCTMP.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
2525: 0000:     CCTMP.DDDA.DCDR.NUM$,    \ 3 byte UPD
2526: 0000:     CCTMP.DELIV.NOTE.NUM$,   \ 3 byte UPD
2527: 0000:     CCTMP.NUM.CARTONS.RECEIV$,\1 byte UPD
2528: 0000:     CCTMP.ORDER.NUM$,        \ 3 byte UPD
2529: 0000:     CCTMP.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
2530: 0000:                  \              "B" = Barcode.
2531: 0000:     CCTMP.ITEM.BARCODE$,     \ 7 byte UPD
2532: 0000:     CCTMP.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
2533: 0000:     CCTMP.AUTHORISATION$,    \ 15 byte ASC
2534: 0000:     CCTMP.ADJ.STOCK.FIGURE$, \ 1 byte ASC  "Y" or "N"
2535: 0000:     CCTMP.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
2536: 0000:     CCTMP.UOD.NUM$,      \ 7 byte UPD
2537: 0000:     CCTMP.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
2538: 0000:                      \              "C" = Closed,
2539: 0000:                  \              "D" = Despatched
2540: 0000:     CCTMP.PREVIOUS.STATUS$,  \ 1 byte ASC   "O" = Open,
2541: 0000:                      \              "C" = Closed
2542: 0000:     CCTMP.SUPPLY.ROUTE$,     \ 1 byte ASC
2543: 0000:     CCTMP.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
2544: 0000:                      \              "D" = Dispensary
2545: 0000:     CCTMP.RECALL.NUM$,       \ 9 byte ASC 
2546: 0000:     CCTMP.SUPPLIER$,         \ 15 byte ASC
2547: 0000:     CCTMP.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
2548: 0000:                      \           2 = BIRD,
2549: 0000:                  \               3 = Via D6,
2550: 0000:                  \               4 = Representative
2551: 0000:     CCTMP.CARRIER$,      \ 1 byte UPD;   1 = GPO,
2552: 0000:                      \               2 = Parcelforce,
2553: 0000:                  \               3 = Securicor,
2554: 0000:                  \               4 = Other
2555: 0000:     CCTMP.BIRD.NUM$,         \ 8 byte ASC
2556: 0000:     CCTMP.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
2557: 0000:                      \          "C" = CSR
2558: 0000:     CCTMP.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
2559: 0000:                      \               2 = Town Tray,
2560: 0000:                  \               3 = Roll cage,
2561: 0000:                  \               4 = Other
2562: 0000:     CCTMP.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
2563: 0000:                      \               2 = Poor handling
2564: 0000:     CCTMP.RECEIVING.STORE$,  \ 2 byte UPD
2565: 0000:     CCTMP.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
2566: 0000:                      \               2 = MTS,
2567: 0000:                  \               3 = Other
2568: 0000:     CCTMP.DATE.UOD.OPENED$,  \ 3 byte UPD
2569: 0000:     CCTMP.DATE.DESPATCHED$,  \ 3 byte UPD
2570: 0000:     CCTMP.TIME.DESPATCHED$,  \ 3 byte UPD
2571: 0000:     CCTMP.ITEM.UPDATED$,     \ 1 byte ASC
2572: 0000:     CCTMP.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
2573: 0000:                      \          "D" = Despatched,
2574: 0000:                  \          "X" = Cancelled
2575: 0000:     CCTMP.ITEM.QTY$,         \ 3 byte ASCII              
2576: 0000:     CCTMP.RECALL.TYPE$       ! 1 byte ASCII "B" = Batch Recall              ! 1.1BG
2577: 0000:                              !              "N" = Non-batch Recall          ! 1.1BG
2578: 0000:                              !              " " = Old Credit Claim          ! 1.1BG
2579: 0000:     
2580: 0000:                                                  
2581: 0000:   INTEGER*2 GLOBAL           \
2582: 0000:     CCTMP.SESS.NUM%,         \
2583: 0000:     CCTMP.REPORT.NUM%,       \
2584: 0000:                      \
2585: 0000:     CCTMP.NUM.OF.ITEMS%,     \
2586: 0000:     CCTMP.NUM.ITEMS.UPDATED%,\ 
2587: 0000:     CCTMP.TOTAL.QTY.IN.UOD%  !
2588: 0000:                          
2589: 0000:                  
2590: 0000:  %INCLUDE CCBUFDEC.J86                    ! GMJK
2591: 0000: REM \
2592: 0000: \******************************************************************************
2593: 0000: \******************************************************************************
2594: 0000: \***
2595: 0000: \***      %INCLUDE FOR CREDIT CLAIMING BUFFER FILE FIELD DECLARATIONS
2596: 0000: \***                                          FILE REFERENCE PARAMETERS
2597: 0000: \***
2598: 0000: \***               FILE TYPE    : Sequential
2599: 0000: \***
2600: 0000: \***               REFERENCE    : CCBUFDEC.J86
2601: 0000: \***
2602: 0000: \***      Version A.     Michael J. Kelsall           30th September 1993.
2603: 0000: \***
2604: 0000: \******************************************************************************
2605: 0000: \*******************************************************************************
2606: 0000: \***
2607: 0000: \***  The length of the records on this file vary depending on the record
2608: 0000: \***  transaction type, but they all comprise combinations of the fields
2609: 0000: \***  defined below.
2610: 0000: \***
2611: 0000: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
2612: 0000: \***
2613: 0000: \***  Transaction type 24 - Whole or Part consignment record
2614: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
2615: 0000: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
2616: 0000: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
2617: 0000: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
2618: 0000: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
2619: 0000: \***     RECORD DELIMITER, END OF RECORD MARKER
2620: 0000: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
2621: 0000: \***
2622: 0000: \***  Transaction type 26 - Data from LDT
2623: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
2624: 0000: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
2625: 0000: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
2626: 0000: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
2627: 0000: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
2628: 0000: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
2629: 0000: \***     DESPATCHED, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY, ITEM UPDATED 
2630: 0000: \***     FLAG, RECORD DELIMITER, END OF RECORD MARKER
2631: 0000: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
2632: 0000: \***
2633: 0000: \***  Transaction type 28 - Cancelled Credit Claim
2634: 0000: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
2635: 0000: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
2636: 0000: \***
2637: 0000: \******************************************************************************
2638: 0000: 
2639: 0000:   STRING GLOBAL              \
2640: 0000:     CCBUF.FILE.NAME$,        \
2641: 0000:     CCBUF.RECORD$,           \ Used to store the whole record which is unstrung
2642: 0000:                              \ into the fields below
2643: 0000:     CCBUF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2644: 0000:     CCBUF.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
2645: 0000: 			     \             25 = NS16 / Misc cont txn (R/ACC)
2646: 0000: 			     \	           26 = Data from LDT (R/ACC)
2647: 0000: 			     \             27 = End of LDT session (R/ACC)
2648: 0000: 			     \		   28 = Canc. Credit Claim (R/ACC)
2649: 0000:     CCBUF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2650: 0000:     CCBUF.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
2651: 0000:     CCBUF.BC.LETTER$,        \ 1 byte ASCII
2652: 0000:     CCBUF.CREDIT.CLAIM.NUM$, \ 4 byte UPD
2653: 0000:     CCBUF.CLAIM.TYPE$,	     \ 1 byte ASC;  "M" = Missing,
2654: 0000:     			     \		    "E" = Excess,
2655: 0000: 			     \              "R" = Repairs
2656: 0000:     CCBUF.SUPPLIER.NUM$,     \ 3 byte UPD
2657: 0000:     CCBUF.INVOICE.NUM$,	     \ 3 byte UPD 
2658: 0000:     CCBUF.FOLIO.NUM$,	     \ 3 byte UPD
2659: 0000:     CCBUF.BATCH.REF$,	     \ 3 byte UPD
2660: 0000:     CCBUF.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
2661: 0000:    			     \ 		     2 = Estimate,
2662: 0000: 			     \		     3 = Boots guarantee,
2663: 0000: 			     \		     4 = Supplier guarantee,
2664: 0000: 			     \		     5 = Other guarantee,
2665: 0000:     CCBUF.REPAIR.NUM$,       \ 4 byte UPD
2666: 0000:     CCBUF.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
2667: 0000:     CCBUF.DDDA.DCDR.NUM$,    \ 3 byte UPD
2668: 0000:     CCBUF.DELIV.NOTE.NUM$,   \ 3 byte UPD
2669: 0000:     CCBUF.NUM.CARTONS.RECEIV$,\1 byte UPD
2670: 0000:     CCBUF.ORDER.NUM$,	     \ 3 byte UPD
2671: 0000:     CCBUF.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
2672: 0000:   			     \              "B" = Barcode.
2673: 0000:     CCBUF.ITEM.BARCODE$,     \ 7 byte UPD
2674: 0000:     CCBUF.ITEM.PRICE$,	     \ 3 byte UPD;  Spaces.
2675: 0000:     CCBUF.AUTHORISATION$,    \ 15 byte ASC
2676: 0000:     CCBUF.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
2677: 0000:     CCBUF.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
2678: 0000:     CCBUF.UOD.NUM$,	     \ 7 byte UPD
2679: 0000:     CCBUF.UOD.STATUS$,	     \ 1 byte ASC;  "O" = Open,
2680: 0000:     			     \              "C" = Closed,
2681: 0000: 			     \              "D" = Despatched
2682: 0000:     CCBUF.SUPPLY.ROUTE$,     \ 1 byte ASC
2683: 0000:     CCBUF.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
2684: 0000:     			     \              "D" = Dispensary
2685: 0000:     CCBUF.RECALL.NUM$,       \ 9 byte ASC 
2686: 0000:     CCBUF.SUPPLIER$,	     \ 15 byte ASC
2687: 0000:     CCBUF.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
2688: 0000:     			     \		     2 = BIRD,
2689: 0000: 			     \               3 = Via D6,
2690: 0000: 			     \               4 = Representative
2691: 0000:     CCBUF.CARRIER$,	     \ 1 byte UPD;   1 = GPO,
2692: 0000:     			     \               2 = Parcelforce,
2693: 0000: 			     \               3 = Securicor,
2694: 0000: 			     \               4 = Other
2695: 0000:     CCBUF.BIRD.NUM$,	     \ 8 byte ASC
2696: 0000:     CCBUF.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
2697: 0000:     			     \  	    "C" = CSR
2698: 0000:     CCBUF.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
2699: 0000:     			     \               2 = Town Tray,
2700: 0000: 			     \               3 = Roll cage,
2701: 0000: 			     \               4 = Other
2702: 0000:     CCBUF.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
2703: 0000:      			     \               2 = Poor handling
2704: 0000:     CCBUF.RECEIVING.STORE$,  \ 2 byte UPD
2705: 0000:     CCBUF.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
2706: 0000:     			     \               2 = MTS,
2707: 0000: 			     \               3 = Other
2708: 0000:     CCBUF.DATE.UOD.OPENED$,  \ 3 byte UPD
2709: 0000:     CCBUF.DATE.DESPATCHED$,  \ 3 byte UPD
2710: 0000:     CCBUF.TIME.DESPATCHED$,  \ 3 byte UPD
2711: 0000:     CCBUF.ITEM.UPDATED$,     \ 1 byte ASC
2712: 0000:     CCBUF.NEW.STATUS.FLAG$   \ 1 byte ASC   "C" = Closed,
2713: 0000:     			     \   	    "D" = Despatched,
2714: 0000: 			     !    	    "X" = Cancelled
2715: 0000:     
2716: 0000: 			     			     			     
2717: 0000:   INTEGER*2 GLOBAL           \
2718: 0000:     CCBUF.SESS.NUM%,         \
2719: 0000:     CCBUF.REPORT.NUM%,	     \
2720: 0000:     			     \
2721: 0000:     CCBUF.NUM.OF.ITEMS%,     \
2722: 0000:     CCBUF.NUM.ITEMS.UPDATED%,\
2723: 0000:     CCBUF.QTY%,		     \
2724: 0000:     CCBUF.TOTAL.QTY.IN.UOD%  !
2725: 0000:         			     
2726: 0000: 			     
2727: 0000:  %INCLUDE CCUPFDEC.J86                    ! HMJK
2728: 0000: 
2729: 0000: \*****************************************************************************
2730: 0000: \*****************************************************************************
2731: 0000: \***
2732: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2733: 0000: \***
2734: 0000: \***                   FILE TYPE:  KEYED
2735: 0000: \***
2736: 0000: \***                   REFERENCE:  CCUPFDEC.J86
2737: 0000: \***
2738: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2739: 0000: \***				   UOD PROCESSED FILE
2740: 0000: \***
2741: 0000: \***
2742: 0000: \***      VERSION A : Michael J. Kelsall      14th March 1994
2743: 0000: \***      
2744: 0000: \*****************************************************************************
2745: 0000: \*****************************************************************************
2746: 0000: 
2747: 0000: STRING GLOBAL			\
2748: 0000:    CCUPF.FILE.NAME$,		\
2749: 0000:    CCUPF.UOD.NUM$,		\  7 byte UPD
2750: 0000:    CCUPF.CURRENT.STATUS$	!  1 byte ASC;  "C" = Closed,
2751: 0000:    				!               "D" - Despatched,
2752: 0000:    				!               "X" - Cancelled.
2753: 0000:       				
2754: 0000: 
2755: 0000: INTEGER*2 GLOBAL		\
2756: 0000:    CCUPF.RECL%,			\
2757: 0000:    CCUPF.REPORT.NUM%,		\
2758: 0000:    CCUPF.SESS.NUM%
2759: 0000: 
2760: 0000:  %INCLUDE CCWKFDEC.J86                    ! GMJK
2761: 0000: \******************************************************************************
2762: 0000: \******************************************************************************
2763: 0000: \***
2764: 0000: \***      %INCLUDE FOR RETURNS WORK FILE - FIELD DEFINITIONS
2765: 0000: \***                                       FILE REFERENCE PARAMETERS
2766: 0000: \***
2767: 0000: \***                  REFERENCE: CCWKFDEC.J86
2768: 0000: \***
2769: 0000: \***  Version A          Michael J. Kelsall              30th September 1993
2770: 0000: \***
2771: 0000: \******************************************************************************
2772: 0000: \*******************************************************************************
2773: 0000: 
2774: 0000:   STRING GLOBAL								\
2775: 0000: 	CCWKF.FILE.NAME$,						\
2776: 0000: 	CCWKF.RECORD$
2777: 0000: 
2778: 0000:   INTEGER*2 GLOBAL							\
2779: 0000: 	CCWKF.RECL%,	          					\
2780: 0000: 	CCWKF.SESS.NUM%,						\
2781: 0000: 	CCWKF.REPORT.NUM%
2782: 0000:  %INCLUDE CCDMYDEC.J86                    ! GMJK
2783: 0000: \******************************************************************************
2784: 0000: \******************************************************************************
2785: 0000: \***
2786: 0000: \***         %INCLUDE FOR RETURNS DUMMY FILE I/O SESSION NUMBER
2787: 0000: \***
2788: 0000: \***               REFERENCE    : CCDMYDEC.J86
2789: 0000: \***
2790: 0000: \***    Version A           Michael J. Kelsall          30th September 1993
2791: 0000: \***
2792: 0000: \******************************************************************************
2793: 0000: \*******************************************************************************
2794: 0000: 
2795: 0000:   STRING GLOBAL           \
2796: 0000:     CCDMY.FILE.NAME$
2797: 0000: 
2798: 0000:   INTEGER*2 GLOBAL        \
2799: 0000:     CCDMY.REPORT.NUM%,    \
2800: 0000:     CCDMY.SESS.NUM%
2801: 0000:  %INCLUDE LDTAFDEC.J86                    ! HMJK
2802: 0000: 
2803: 0000: \*****************************************************************************
2804: 0000: \*****************************************************************************
2805: 0000: \***
2806: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2807: 0000: \***
2808: 0000: \***                   FILE TYPE:  DIRECT
2809: 0000: \***
2810: 0000: \***                   REFERENCE:  LDTAFDEC.J86
2811: 0000: \***
2812: 0000: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
2813: 0000: \***
2814: 0000: \***
2815: 0000: \***      VERSION A         Michael J. Kelsall       30th September 1993
2816: 0000: \***
2817: 0000: \***      VERSION B         Michael J. Kelsall       25th March 1994
2818: 0000: \***      Conversion of LDTAF link duration from minutes to seconds, requiring
2819: 0000: \***      4 byte integer to hold times >09:06:07 (= 32767 seconds)
2820: 0000: \***      
2821: 0000: \*****************************************************************************
2822: 0000: \*****************************************************************************
2823: 0000: 
2824: 0000:   STRING GLOBAL                 \
2825: 0000:     LDTAF.FILE.NAME$,		\
2826: 0000:     LDTAF.START.DATE$,		\ 3 byte UPD  (YYMMDD)
2827: 0000:     LDTAF.START.TIME$		! 3 byte UPD  (HHMMSS)
2828: 0000:     
2829: 0000: 
2830: 0000:   INTEGER*1 GLOBAL              \
2831: 0000:     LDTAF.LINK.TYPE%		!  1 - CSR file    (CSRWF size / num of UNITS)
2832: 0000: 				!  2 - PCHECK      (CHKBF size / null)
2833: 0000: 				!  3 - LDT PROG    (LDTPF size / null)
2834: 0000: 				!  4 - DIRECTS     (DRSMQ size / DIRWF size)
2835: 0000: 				!  5 - UOD         (UODTF size / null)
2836: 0000: 				!  6 - EPSOM req   (PDTWF size / null)
2837: 0000: 				!  7 - EPSOM lists (num of lists / null)
2838: 0000: 				!  8 - RETURNS UOD (CCTMP size / CCBUF size)
2839: 0000: 				!  9 - RETURNS req (CCWKF size / null)
2840: 0000: 				!  MSB ---> 0 = Port A , 1 = Port B. 
2841: 0000: 
2842: 0000:   INTEGER*2 GLOBAL              \
2843: 0000:     LDTAF.SESS.NUM%,            \
2844: 0000:     LDTAF.REPORT.NUM%,		\
2845: 0000:     LDTAF.RECL%
2846: 0000:     				
2847: 0000: 
2848: 0000:   INTEGER*4 GLOBAL              \
2849: 0000:     LDTAF.DATA.VOLUME.1%,	\
2850: 0000:     LDTAF.DATA.VOLUME.2%,	\
2851: 0000:     LDTAF.DURATION%    		! BMJK
2852: 0000:  %INCLUDE SOFTSDEC.J86                    ! GMJK
2853: 0000: REM \
2854: 0000: \******************************************************************************
2855: 0000: \******************************************************************************
2856: 0000: \***
2857: 0000: \***                 %INCLUDE FOR THE SOFTWARE STATUS FILE
2858: 0000: \***   
2859: 0000: \***                      FILE TYPE  :   Direct
2860: 0000: \***
2861: 0000: \***                      REFERENCE  :   SOFTSDEC.J86
2862: 0000: \***
2863: 0000: \***	Version A	       Andrew Wedgeworth	      24th June 1992
2864: 0000: \***
2865: 0000: \******************************************************************************
2866: 0000: \*******************************************************************************
2867: 0000: 
2868: 0000:   STRING GLOBAL           \
2869: 0000:     SOFTS.RECORD$,        \           
2870: 0000:     SOFTS.SPACE$,         \           
2871: 0000:     SOFTS.FILE.NAME$    
2872: 0000:     
2873: 0000:   INTEGER*2 GLOBAL        \
2874: 0000:     SOFTS.RECL%,          \            
2875: 0000:     SOFTS.REPORT.NUM%,	  \      
2876: 0000:     SOFTS.SESS.NUM%
2877: 0000: 
2878: 0000:   INTEGER*4 GLOBAL        \
2879: 0000:     SOFTS.REC.NUM% 	         
2880: 0000:  %INCLUDE STKBFDEC.J86                    ! 1.5
2881: 0000: \******************************************************************************
2882: 0000: \******************************************************************************
2883: 0000: \***
2884: 0000: \***   $Workfile:   STKBFDEC.J86  $
2885: 0000: \***
2886: 0000: \***   $Revision:   1.0  $
2887: 0000: \***
2888: 0000: \******************************************************************************
2889: 0000: \******************************************************************************
2890: 0000: \***
2891: 0000: \***   $Log:   V:\archive\j86\stkbfdec.j8v  $
2892: 0000: \***   
2893: 0000: \***      Rev 1.0   15 Jul 1997 14:20:36   DEV45PS
2894: 0000: \***    
2895: 0000: \***   
2896: 0000: \***      Rev 1.0   09 Jul 1997 11:04:52   DEV45PS
2897: 0000: \***   Stocktake System New Files
2898: 0000: \***   
2899: 0000: \******************************************************************************
2900: 0000: \******************************************************************************\******************************************************************************
2901: 0000: \******************************************************************************
2902: 0000: \***
2903: 0000: \***         %INCLUDE FOR STOCKTAKE BUFFER FILE FIELD DECLARATIONS
2904: 0000: \***
2905: 0000: \***               FILE TYPE    : DIRECT
2906: 0000: \***
2907: 0000: \***               REFERENCE    : STKBFDEC.J86
2908: 0000: \***
2909: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
2910: 0000: \***    New file for stocktaking system. Holds counts read from PDT.
2911: 0000: \***
2912: 0000: \*******************************************************************************
2913: 0000: \*******************************************************************************
2914: 0000: 
2915: 0000: STRING GLOBAL                                                  \
2916: 0000:    STKBF.FILE.NAME$,           \
2917: 0000:    STKBF.DATA$,                \
2918: 0000:    STKBF.STORE.NUMBER$,        \
2919: 0000:    STKBF.STOCKTAKER.NO$,       \
2920: 0000:    STKBF.DATE$,                \
2921: 0000:    STKBF.LOCATION$,            \
2922: 0000:    STKBF.ITEM.CODE$,           \
2923: 0000:    STKBF.QUANTITY$,            \
2924: 0000:    STKBF.PRICE$,               \
2925: 0000:    STKBF.RECORD.COUNT$,        \
2926: 0000:    STKBF.FILLER$
2927: 0000: 
2928: 0000: 
2929: 0000: INTEGER*4 GLOBAL               \
2930: 0000:    STKBF.RECORD.NUM%
2931: 0000: 
2932: 0000: INTEGER*2 GLOBAL                \
2933: 0000:    STKBF.REPORT.NUM%,           \
2934: 0000:    STKBF.SESS.NUM%             
2935: 0000: 
2936: 0000: 
2937: 0000: INTEGER*1 GLOBAL                \
2938: 0000:    STKBF.RECL%         
2939: 0000: 
2940: 0000: 
2941: 0000:  %INCLUDE SXTMPDEC.J86                    ! 1.5
2942: 0000: \******************************************************************************
2943: 0000: \******************************************************************************
2944: 0000: \***
2945: 0000: \***         %INCLUDE FOR TEMPORARY STOCKTAKE BUFFER FILE FIELD DECLARATIONS
2946: 0000: \***
2947: 0000: \***               FILE TYPE    : DIRECT
2948: 0000: \***
2949: 0000: \***               REFERENCE    : SXTMPDEC.J86
2950: 0000: \***
2951: 0000: \***    VERSION A.              Nik Sen.               30 Jun 1997.
2952: 0000: \***    New file for stocktaking system. Holds counts read from PDT.
2953: 0000: \***
2954: 0000: \***    VERSION B              Nik Sen                 23 September 1997
2955: 0000: \***    Removed record count as file converted from direct to sequential.
2956: 0000: \***
2957: 0000: \*******************************************************************************
2958: 0000: \*******************************************************************************
2959: 0000: 
2960: 0000: STRING GLOBAL                                                  \
2961: 0000:    SXTMP.FILE.NAME$,           \
2962: 0000:    SXTMP.DATA$,                \
2963: 0000:    SXTMP.STORE.NUMBER$,        \
2964: 0000:    SXTMP.STOCKTAKER.NO$,       \
2965: 0000:    SXTMP.DATE$,                \
2966: 0000:    SXTMP.LOCATION$,            \
2967: 0000:    SXTMP.ITEM.CODE$,           \
2968: 0000:    SXTMP.QUANTITY$,            \
2969: 0000:    SXTMP.PRICE$,               \
2970: 0000:    SXTMP.RECORD.COUNT$,        \
2971: 0000:    SXTMP.FILLER$
2972: 0000: 
2973: 0000: 
2974: 0000: INTEGER*2 GLOBAL                \
2975: 0000:    SXTMP.REPORT.NUM%,           \
2976: 0000:    SXTMP.SESS.NUM%             
2977: 0000: 
2978: 0000: 
2979: 0000: INTEGER*1 GLOBAL                \
2980: 0000:    SXTMP.RECL%         
2981: 0000: 
2982: 0000: 
2983: 0000:  %INCLUDE STKTKDEC.J86                    ! 1.5
2984: 0000: REM \
2985: 0000: \******************************************************************************
2986: 0000: \******************************************************************************
2987: 0000: \***
2988: 0000: \***         %INCLUDE FOR STOCKTAKE DUMMY FILE - FILE REFERENCE PARAMETERS
2989: 0000: \***
2990: 0000: \***               REFERENCE    : STKTKDEC.J86
2991: 0000: \***
2992: 0000: \******************************************************************************
2993: 0000: \*******************************************************************************
2994: 0000: 
2995: 0000:   STRING GLOBAL           \
2996: 0000:     STKTK.FILE.NAME$
2997: 0000: 
2998: 0000:   INTEGER*2 GLOBAL        \
2999: 0000:     STKTK.REPORT.NUM%,      \
3000: 0000:     STKTK.SESS.NUM%
3001: 0000:  %INCLUDE STLDTDEC.J86                    ! 1.6
3002: 0000: REM \
3003: 0000: \******************************************************************************
3004: 0000: \******************************************************************************
3005: 0000: \***
3006: 0000: \***            %INCLUDE FOR STLDT FILE VARIABLES
3007: 0000: \***
3008: 0000: \***                 FILE TYPE    : Direct
3009: 0000: \***
3010: 0000: \***                 REFERENCE    : STLDTDEC.J86
3011: 0000: \***
3012: 0000: \***       Version B          David Artiss      03/09/2002
3013: 0000: \***       Increase field from 2 to 2 bytes
3014: 0000: \***
3015: 0000: \******************************************************************************
3016: 0000: \*******************************************************************************
3017: 0000: 
3018: 0000:   STRING GLOBAL           \
3019: 0000:     STLDT.FILE.NAME$,     \
3020: 0000:     STLDT.RECORD$,        \ 25 bytes
3021: 0000:     STLDT.STORE$,         \ 4 bytes
3022: 0000:     STLDT.STOCKTAKER$,    \ 4 bytes
3023: 0000:     STLDT.LDT.SERIAL$,    \ 6 bytes
3024: 0000:     STLDT.DATE$,          \ 6 bytes DDMMYY
3025: 0000:     STLDT.TIME$,          \ 4 bytes HHMM
3026: 0000:     STLDT.CRLF$           \
3027: 0000: 
3028: 0000:   INTEGER*2 GLOBAL        \
3029: 0000:     STLDT.RECL%,          \
3030: 0000:     STLDT.SESS.NUM%,      \
3031: 0000:     STLDT.REPORT.NUM%     ! BDA
3032: 0000:      
3033: 0000:   INTEGER*4 GLOBAL        \
3034: 0000:     STLDT.RECORD.NUM%,    \
3035: 0000:     STLDT.COUNTS%,        \ BDA
3036: 0000:     STLDT.ITEMS%
3037: 0000:       
3038: 0000:  %INCLUDE STOCKDEC.J86                    ! 1.7BG
3039: 0000: \***********************************************************************
3040: 0000: \***********************************************************************
3041: 0000: \***
3042: 0000: \***    DESCRIPTION: Stock File
3043: 0000: \***                 Field Definitions         
3044: 0000: \***
3045: 0000: \***    FILE TYPE : Keyed
3046: 0000: \***
3047: 0000: \***********************************************************************
3048: 0000: \***
3049: 0000: \***    Version B.              Robert Cowey             21st Oct 1993
3050: 0000: \***    No changes to this file.
3051: 0000: \***
3052: 0000: \***    Version C.              Mark Walker              24th Jan 2014
3053: 0000: \***    F337 Centralised View of Stock
3054: 0000: \***    - Added sequence ID and item status fields.
3055: 0000: \***    - Minor formatting changes (uncommented).
3056: 0000: \***
3057: 0000: \***    Version D.              Mark Walker              15th Mar 2014
3058: 0000: \***    F337 Centralised View of Stock
3059: 0000: \***    Added next sequence ID field.
3060: 0000: \***
3061: 0000: \***    Version E.              Mark Walker               7th May 2014
3062: 0000: \***    F337 Centralised View of Stock
3063: 0000: \***    Added new 'stock flags' field for future use.
3064: 0000: \***
3065: 0000: \***********************************************************************
3066: 0000: \***********************************************************************
3067: 0000: 
3068: 0000: \***********************************************************************
3069: 0000: \***********************************************************************
3070: 0000: \***
3071: 0000: \***    File Record Layout
3072: 0000: \***
3073: 0000: \***    STOCK.BOOTS.CODE$            4 UPD  Item Code (Key)
3074: 0000: \***    STOCK.STOCK.FIG%             2 INT  Stock Figure
3075: 0000: \***    STOCK.LAST.COUNT%            2 INT  Last Count Quantity
3076: 0000: \***    STOCK.DATE.LAST.COUNT$       3 UPD  Date of Last Count
3077: 0000: \***    STOCK.DATE.LAST.MOVE$        3 UPD  Date of Last Movement
3078: 0000: \***    STOCK.LAST.REC%              2 INT  Last Receipt Quantity
3079: 0000: \***    STOCK.DATE.LAST.REC$         3 UPD  Date of Last Receipt
3080: 0000: \***    STOCK.DATE.LAST.GAP$         3 UPD  Date of Last Gap
3081: 0000: \***    STOCK.SID%                   4 INT  Sequence ID                     !CMW
3082: 0000: \***    STOCK.STATUS.1$              1 ASC  Item Status                     !CMW
3083: 0000: \***    STOCK.FLAGS%                 1 INT  Stock flags                     !EMW
3084: 0000: \***    STOCK.FILLER$                2 UPD  Filler                          !EMW
3085: 0000: \***
3086: 0000: \***********************************************************************
3087: 0000: \***********************************************************************
3088: 0000: 
3089: 0000:     INTEGER*1 GLOBAL                                                    \
3090: 0000:         STOCK.FLAGS%,                                                   \   !EMW
3091: 0000:         STOCK.RECL%
3092: 0000: 
3093: 0000:     INTEGER*2 GLOBAL                                                    \
3094: 0000:         STOCK.LAST.COUNT%,                                              \
3095: 0000:         STOCK.LAST.REC%,                                                \
3096: 0000:         STOCK.REPORT.NUM%,                                              \
3097: 0000:         STOCK.SESS.NUM%,                                                \
3098: 0000:         STOCK.STOCK.FIG%
3099: 0000: 
3100: 0000:     INTEGER*4 GLOBAL                                                    \   !CMW
3101: 0000:         STOCK.NEXT.SID%,                                                \   !DMW
3102: 0000:         STOCK.SID%                                                          !CMW
3103: 0000: 
3104: 0000:     STRING GLOBAL                                                       \
3105: 0000:         STOCK.BOOTS.CODE$,                                              \
3106: 0000:         STOCK.DATE.LAST.COUNT$,                                         \
3107: 0000:         STOCK.DATE.LAST.GAP$,                                           \
3108: 0000:         STOCK.DATE.LAST.MOVE$,                                          \
3109: 0000:         STOCK.DATE.LAST.REC$,                                           \
3110: 0000:         STOCK.FILE.NAME$,                                               \
3111: 0000:         STOCK.FILLER$,                                                  \
3112: 0000:         STOCK.STATUS.1$                                                     !CMW
3113: 0000: 
3114: 0000:  %INCLUDE IMSTCDEC.J86                    ! 1.7BG
3115: 0000: \***********************************************************************
3116: 0000: \***********************************************************************
3117: 0000: \***
3118: 0000: \***    DESCRIPTION: Item Movement & Stock File
3119: 0000: \***                 Field Definitions         
3120: 0000: \***
3121: 0000: \***    FILE TYPE : Keyed
3122: 0000: \***
3123: 0000: \***********************************************************************
3124: 0000: \***
3125: 0000: \***    Version A.          Les Cook                     21st Aug 1992
3126: 0000: \***    Initial version.
3127: 0000: \***
3128: 0000: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
3129: 0000: \***    Added new external functions for
3130: 0000: \***        MIMSTC - merged IMSTC
3131: 0000: \***        CIMSTC - Copy of IMSTC
3132: 0000: \***        BIMSTC - Backup of IMSTC
3133: 0000: \***
3134: 0000: \***    Version C.          Mark Walker                  23rd Jan 2014
3135: 0000: \***    F337 Centralised View of Stock
3136: 0000: \***    - Added sequence ID field definition.
3137: 0000: \***    - Moved BIMST, CIMST and MIMST field definitions to separate
3138: 0000: \***      modules.
3139: 0000: \***    - Moved TIMST record length to TIMSTDEC.J86.
3140: 0000: \***    - Minor formatting changes (uncommented).
3141: 0000: \***
3142: 0000: \***    Version D.          Mark Walker                  30th Apr 2014
3143: 0000: \***    F337 Centralised View of Stock
3144: 0000: \***    QC599: Introduced item level TSL restart pointer to allow
3145: 0000: \***           Sales Support restart/recovery to continue processing
3146: 0000: \***           correctly from the next unprocessed item.
3147: 0000: \***
3148: 0000: \***********************************************************************
3149: 0000: \***********************************************************************
3150: 0000: 
3151: 0000: \***********************************************************************
3152: 0000: \***********************************************************************
3153: 0000: \***
3154: 0000: \***    File Record Layout
3155: 0000: \***
3156: 0000: \***    IMSTC.BAR.CODE$             11 UPD  Barcode (Key)
3157: 0000: \***    IMSTC.RESTART%               4 INT  IMSTC Restart pointer
3158: 0000: \***    IMSTC.NUMITEMS%              4 INT  Number of items sold
3159: 0000: \***    IMSTC.AMTSALE%               4 INT  Amount of items sold
3160: 0000: \***    IMSTC.TSL.RESTART%           4 INT  TSL Restart pointer             !DMW
3161: 0000: \***    IMSTC.STKMQ.RESTART%         4 INT  STKMQ Restart pointer
3162: 0000: \***    IMSTC.STATUS.FLAG$           1 ASC  Status flags
3163: 0000: \***    IMSTC.STOCK.FIGURE%          2 INT  Stock Figure
3164: 0000: \***    IMSTC.REASON.ITEM.REMOVED$   1 ASC  Deletion Reason
3165: 0000: \***    IMSTC.SID%                   4 INT  Sequence ID
3166: 0000: \***    IMSTC.FILLER$                1 UPD  Filler
3167: 0000: \***
3168: 0000: \***********************************************************************
3169: 0000: \***********************************************************************
3170: 0000: 
3171: 0000:     INTEGER*2 GLOBAL                                                    \
3172: 0000:         IMSTC.SESS.NUM%,                                                \
3173: 0000:         IMSTC.RECL%,                                                    \
3174: 0000:         IMSTC.REPORT.NUM%,                                              \
3175: 0000:         IMSTC.STOCK.FIGURE%
3176: 0000: 
3177: 0000:     INTEGER*4 GLOBAL                                                    \
3178: 0000:         IMSTC.AMTSALE%,                                                 \
3179: 0000:         IMSTC.NEXT.SID%,                                                \   !CMW
3180: 0000:         IMSTC.NUMITEMS%,                                                \
3181: 0000:         IMSTC.RESERVED%,                                                \
3182: 0000:         IMSTC.RESTART%,                                                 \
3183: 0000:         IMSTC.SID%,                                                     \   !CMW
3184: 0000:         IMSTC.STKMQ.RESTART%,                                           \
3185: 0000:         IMSTC.TSL.RESTART%                                                  !DMW
3186: 0000: 
3187: 0000:     STRING GLOBAL                                                       \
3188: 0000:         IMSTC.BAR.CODE$,                                                \
3189: 0000:         IMSTC.FILE.NAME$,                                               \
3190: 0000:         IMSTC.FILLER$,                                                  \
3191: 0000:         IMSTC.HOLD.PENDING$,                                            \
3192: 0000:         IMSTC.REASON.ITEM.REMOVED$,                                     \
3193: 0000:         IMSTC.STATUS.FLAG$
3194: 0000: 
3195: 0000:  %INCLUDE LSSSTDEC.J86                    ! 1.7BG
3196: 0000: REM \
3197: 0000: \******************************************************************************
3198: 0000: \******************************************************************************
3199: 0000: \***
3200: 0000: \***                 %INCLUDE FOR THE LSS STOCK COUNT FILE
3201: 0000: \***   
3202: 0000: \***                      FILE TYPE  :   Direct
3203: 0000: \***
3204: 0000: \***                      REFERENCE  :   LSSSTDEC.J86
3205: 0000: \***
3206: 0000: \***    Version A          Brian Greenfield          16th October 2002
3207: 0000: \***
3208: 0000: \******************************************************************************
3209: 0000: \*******************************************************************************
3210: 0000: 
3211: 0000:   STRING GLOBAL              \ 
3212: 0000:     LSSST.FILE.NAME$,        \
3213: 0000:     LSSST.IRF.BAR.CODE$,     \
3214: 0000:     LSSST.STOCK.BOOTS.CODE$, \
3215: 0000:     LSSST.STOCK.COUNT$,      \
3216: 0000:     LSSST.TSF$
3217: 0000:         
3218: 0000:   INTEGER*2 GLOBAL        \
3219: 0000:     LSSST.RECL%,          \            
3220: 0000:     LSSST.REPORT.NUM%,    \      
3221: 0000:     LSSST.SESS.NUM%
3222: 0000: 
3223: 0000:          
3224: 0000:  %INCLUDE SXTCFDEC.J86                    ! 1.8DA
3225: 0000: \******************************************************************************
3226: 0000: \******************************************************************************
3227: 0000: \***
3228: 0000: \***   $Workfile:   SXTCFDEC.J86  $
3229: 0000: \***
3230: 0000: \***   $Revision:   1.1  $
3231: 0000: \***
3232: 0000: \******************************************************************************
3233: 0000: \******************************************************************************
3234: 0000: \***
3235: 0000: \***   $Log:   V:\archive\j86\sxtcfdec.j8v  $
3236: 0000: \***   
3237: 0000: \***      Rev 1.1   07 Jan 1998 10:26:30   DEV69PS
3238: 0000: \***    
3239: 0000: \***   
3240: 0000: \***      Rev 1.0   15 Jul 1997 14:21:06   DEV45PS
3241: 0000: \***    
3242: 0000: \***   
3243: 0000: \***      Rev 1.1   15 Jul 1997 13:44:06   DEV45PS
3244: 0000: \***    
3245: 0000: \***   
3246: 0000: \***      Rev 1.0   09 Jul 1997 11:05:28   DEV45PS
3247: 0000: \***   Stocktake System New Files
3248: 0000: \***   
3249: 0000: \*** 
3250: 0000: \***   
3251: 0000: \******************************************************************************
3252: 0000: \******************************************************************************\*****************************************************************************
3253: 0000: \*****************************************************************************
3254: 0000: \***
3255: 0000: \***               %INCLUDE FOR SXTCF - FIELD DECLARATIONS
3256: 0000: \***                                    FILE REFERENCE PARAMETERS
3257: 0000: \***
3258: 0000: \***                      FILE TYPE    : DIRECT
3259: 0000: \***
3260: 0000: \***                      REFERENCE    : SXTCFDEC
3261: 0000: \***
3262: 0000: \***           VERSION A : NIK SEN  3rd July 1997
3263: 0000: \***
3264: 0000: \***
3265: 0000: 
3266: 0000: \*****************************************************************************
3267: 0000: \*****************************************************************************
3268: 0000: 
3269: 0000: 
3270: 0000:   STRING GLOBAL           \
3271: 0000:     SXTCF.FILE.NAME$
3272: 0000: 
3273: 0000:   INTEGER*1 GLOBAL        \
3274: 0000:     SXTCF.HEADER.EXPECTED%
3275: 0000: 
3276: 0000:   INTEGER*2 GLOBAL        \
3277: 0000:     SXTCF.SESS.NUM%,      \
3278: 0000:     SXTCF.REPORT.NUM%,    \
3279: 0000:     SXTCF.RECL%
3280: 0000: 
3281: 0000:   INTEGER*4 GLOBAL        \
3282: 0000:     SXTCF.REC.NUM%
3283: 0000: 
3284: 0000: 
3285: 0000:   INTEGER*4 GLOBAL                                   \
3286: 0000:             SXTCF.STKBF.POINTER%,                    \ Pointer to STKBF
3287: 0000:             SXTCF.ITEM.COUNT%,                       \ No of items processed
3288: 0000:             SXTCF.CURRENT.COUNT%                     ! Items in current batch
3289: 0000: 
3290: 0000: 
3291: 0000:   STRING GLOBAL                                 \
3292: 0000:        SXTCF.START.DATE$,                       \
3293: 0000:        SXTCF.START.TIME$,                       \
3294: 0000:        SXTCF.END.DATE$,                         \
3295: 0000:        SXTCF.END.TIME$,                         \
3296: 0000:        SXTCF.STOCKTAKE.IN.PROGRESS$,            \ Y=Yes; N=No; S=Stop; C=Complete 1 BYTE
3297: 0000:        SXTCF.STOCKTAKER$,                       \ Current Stocktaker
3298: 0000:        SXTCF.CUR.LOCATION$,                     \ Location code currently be processed ! 1.1
3299: 0000:        SXTCF.FILLER$                            \ 
3300: 0000: 
3301: 0000: 
3302: 0000:  %INCLUDE STKCFDEC.J86                    ! 1.8DA
3303: 0000: \******************************************************************************
3304: 0000: \******************************************************************************
3305: 0000: \***
3306: 0000: \***   $Workfile:   STKCFDEC.J86  $
3307: 0000: \***
3308: 0000: \***   $Revision:   1.2  $
3309: 0000: \***
3310: 0000: \******************************************************************************
3311: 0000: \******************************************************************************
3312: 0000: \***
3313: 0000: \***   $Log:   V:\archive\j86\stkcfdec.j8v  $
3314: 0000: \***   
3315: 0000: \***      Rev 1.2   03 Jul 1997 14:18:38   DEV45PS
3316: 0000: \***   Stocktake In Progress Flag Removed
3317: 0000: \***   
3318: 0000: \***      Rev 1.1   30 Jun 1997 15:29:04   DEV45PS
3319: 0000: \***   Added Stocktake In Progress flag
3320: 0000: \***   
3321: 0000: \******************************************************************************
3322: 0000: \******************************************************************************\*****************************************************************************
3323: 0000: \*****************************************************************************
3324: 0000: \***
3325: 0000: \***               %INCLUDE FOR STKCF - FIELD DECLARATIONS
3326: 0000: \***                                    FILE REFERENCE PARAMETERS
3327: 0000: \***
3328: 0000: \***                      FILE TYPE    : DIRECT
3329: 0000: \***
3330: 0000: \***                      REFERENCE    : STKCFDEA
3331: 0000: \***
3332: 0000: \***           VERSION A : STEVEN GOULDING  11.01.93
3333: 0000: \***
3334: 0000: \***
3335: 0000: \***           VERSION B        NIK SEN        5th June 1997
3336: 0000: \***           Added Stocktake.In.Progress flag.
3337: 0000: \***           
3338: 0000: \***           VERSION C        NIK SEN        3rd July 1997
3339: 0000: \***           Removed Stocktake.In.Progress flag. Now moved to Stocktake
3340: 0000: \***           Control File to prevent conflicts when STKCF is locked.
3341: 0000: \***
3342: 0000: \*****************************************************************************
3343: 0000: \*****************************************************************************
3344: 0000: 
3345: 0000: REM \
3346: 0000: 
3347: 0000:   STRING GLOBAL           \
3348: 0000:     STKCF.FILE.NAME$
3349: 0000: 
3350: 0000:   INTEGER*2 GLOBAL        \
3351: 0000:     STKCF.SESS.NUM%,      \
3352: 0000:     STKCF.REPORT.NUM%,    \
3353: 0000:     STKCF.RECL%
3354: 0000: 
3355: 0000:   INTEGER*4 GLOBAL        \
3356: 0000:     STKCF.REC.NUM%
3357: 0000: REM \
3358: 0000: 
3359: 0000: 
3360: 0000:   INTEGER*4 GLOBAL                                   \
3361: 0000:             STKCF.STKMQ.POINTER%,                    \ Pointer to STKMQ
3362: 0000:             STKCF.ITEM.COUNT%                        \ No of items processed
3363: 0000: 
3364: 0000:   INTEGER*2 GLOBAL                                   \
3365: 0000:             STKCF.STMVT.REC.CNT%                     \ No of recs on STMVT file
3366: 0000: 
3367: 0000:   INTEGER*1 GLOBAL                                   \
3368: 0000:             STKCF.PREV.PITRL.UPDATE%                 \ The HOUR of update
3369: 0000: 
3370: 0000:   STRING    GLOBAL                                   \ 1 BYTE
3371: 0000:             STKCF.STOCK.SUPPORT.STATUS$              \ Y = enabled
3372: 0000:                                                      \ N = disabled
3373: 0000:                                                      \ C = Not available to
3374: 0000:                                                      \         Screens
3375: 0000:                                                      \ T = Trailer written
3376: 0000:                                                      \ 1 - 7 According to
3377: 0000:                                                      \       which STKMQ backup
3378: 0000:                                                      \       done.
3379: 0000: 
3380: 0000:   STRING    GLOBAL                                   \
3381: 0000:   	    STKCF.LAST.DIRORD.BC$,	 	     \ Last BC processed
3382: 0000: 	    					     \ in type 17 (1 byte)
3383: 0000:   	    STKCF.LAST.DIRORD.SUPPLIER$,	     \ Last supplier processed
3384: 0000: 	    					     \ in type 17 (3 bytes UPD)
3385: 0000: 	    STKCF.LAST.DIRORD.ORDER.NO$,	     \ last order no processed
3386: 0000: 	    					     \ in type 17 (2 bytes UPD)
3387: 0000: 	    STKCF.LAST.DIRORD.ORDER.SUFFIX$,	     \ last order sfx processed
3388: 0000: 	    					     \ in type 17 (1 byte)
3389: 0000:   	    STKCF.LAST.DIRORD.REC.SOURCE$, 	     \ Last record source
3390: 0000: 	    					     \ in type 17 (1 byte)
3391: 0000:        STKCF.STK.FILE.AVAIL$,                   \ Y=Yes; N=No; 1 BYTE
3392: 0000:        STKCF.STOCK.TAKE.PROCESSING.REQUIRED$,   \ Y=Yes; N=No; 1 BYTE
3393: 0000:        STKCF.FILLER$                            \ 
3394: 0000: 
3395: 0000: 
3396: 0000:  %INCLUDE STKMFDEC.J86                    ! 1.8DA
3397: 0000: \******************************************************************************
3398: 0000: \******************************************************************************
3399: 0000: \***
3400: 0000: \***   $Workfile:   STKMFDEC.J86  $
3401: 0000: \***
3402: 0000: \***   $Revision:   1.0  $
3403: 0000: \***
3404: 0000: \******************************************************************************
3405: 0000: \******************************************************************************
3406: 0000: \***
3407: 0000: \***   $Log:   V:\archive\j86\stkmfdec.j8v  $
3408: 0000: \***   
3409: 0000: \***      Rev 1.0   15 Jul 1997 14:20:54   DEV45PS
3410: 0000: \***    
3411: 0000: \***   
3412: 0000: \***      Rev 1.0   09 Jul 1997 11:05:16   DEV45PS
3413: 0000: \***   Stocktake System New Files
3414: 0000: \***   
3415: 0000: \******************************************************************************
3416: 0000: \******************************************************************************\******************************************************************************
3417: 0000: \******************************************************************************
3418: 0000: \***
3419: 0000: \***  %INCLUDES FOR STOCKTAKE MAONFRAME TRANSMISSION FILE FIELD DECLARATIONS
3420: 0000: \***
3421: 0000: \***               FILE TYPE    : DIRECT
3422: 0000: \***
3423: 0000: \***               REFERENCE    : STKMFDEC.J86
3424: 0000: \***
3425: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3426: 0000: \***    New file for stocktaking system. Holds stocktake data for 
3427: 0000: \***    transmission to the maonframe.
3428: 0000: \***
3429: 0000: \*******************************************************************************
3430: 0000: \*******************************************************************************
3431: 0000: 
3432: 0000: STRING GLOBAL                                                  \
3433: 0000:        STKMF.FILE.NAME$,               \
3434: 0000:        STKMF.DATA$,                    \
3435: 0000:        STKMF.STORE.NUMBER$,            \
3436: 0000:        STKMF.STOCKTAKER.NUM$,          \
3437: 0000:        STKMF.FILLER$,                  \
3438: 0000:        STKMF.DELIMITER$,               \
3439: 0000:        STKMF.DATE$,                    \
3440: 0000:        STKMF.LOCATION$,                \
3441: 0000:        STKMF.ITEM.CODE$,               \
3442: 0000:        STKMF.QUANTITY$,                \
3443: 0000:        STKMF.PRICE$,                   \
3444: 0000:        STKMF.RECORD.COUNT$
3445: 0000:                        
3446: 0000: INTEGER*4 GLOBAL               \
3447: 0000:        STKMF.RECORD.NUM%
3448: 0000: 
3449: 0000: INTEGER*2 GLOBAL                \
3450: 0000:    STKMF.REPORT.NUM%,           \
3451: 0000:    STKMF.SESS.NUM%             
3452: 0000: 
3453: 0000: 
3454: 0000: INTEGER*1 GLOBAL                \
3455: 0000:    STKMF.RECL%         
3456: 0000: 
3457: 0000: 
3458: 0000:  %INCLUDE STKRCDEC.J86                    ! 1.8DA
3459: 0000: \******************************************************************************
3460: 0000: \******************************************************************************
3461: 0000: \***
3462: 0000: \***   $Workfile:   STKRCDEC.J86  $
3463: 0000: \***
3464: 0000: \***   $Revision:   1.1  $
3465: 0000: \***
3466: 0000: \******************************************************************************
3467: 0000: \******************************************************************************
3468: 0000: \***
3469: 0000: \***   $Log:   V:\archive\j86\stkrcdec.j8v  $
3470: 0000: \***   
3471: 0000: \***      Rev 1.1   03 Feb 1998 10:06:02   DEV69PS
3472: 0000: \***    
3473: 0000: \***   
3474: 0000: \***      Rev 1.0   15 Jul 1997 14:20:58   DEV45PS
3475: 0000: \***    
3476: 0000: \***   
3477: 0000: \***      Rev 1.0   09 Jul 1997 11:05:22   DEV45PS
3478: 0000: \***   Stocktake System New Files
3479: 0000: \***   
3480: 0000: \******************************************************************************
3481: 0000: \******************************************************************************\******************************************************************************
3482: 0000: \******************************************************************************
3483: 0000: \***
3484: 0000: \***         %INCLUDE FOR STOCKTAKE RECOUNT FILE FIELD DECLARATIONS
3485: 0000: \***
3486: 0000: \***               FILE TYPE    : DIRECT
3487: 0000: \***
3488: 0000: \***               REFERENCE    : STKRCDEC.J86
3489: 0000: \***
3490: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3491: 0000: \***    New file for stocktaking system. Holds all items where a recount
3492: 0000: \***    has occurred.
3493: 0000: \***
3494: 0000: \*******************************************************************************
3495: 0000: \*******************************************************************************
3496: 0000: 
3497: 0000: STRING GLOBAL                                                  \
3498: 0000:        STKRC.FILE.NAME$,               \
3499: 0000:        STKRC.ITEM.CODE$,               \
3500: 0000:        STKRC.ITEM.DESCRIPTION$,        \
3501: 0000:        STKRC.LOCATION$,                \
3502: 0000:        STKRC.INITIAL.QUANTITY$,        \
3503: 0000:        STKRC.INITIAL.STOCKTAKER$,      \
3504: 0000:        STKRC.FINAL.QUANTITY$,          \
3505: 0000:        STKRC.FINAL.STOCKTAKER$
3506: 0000: 
3507: 0000: INTEGER*4 GLOBAL               \     !1.1
3508: 0000:        STKRC.RECORD.NUM%
3509: 0000: 
3510: 0000: 
3511: 0000: INTEGER*2 GLOBAL                \
3512: 0000:    STKRC.REPORT.NUM%,           \
3513: 0000:    STKRC.SESS.NUM%             
3514: 0000: 
3515: 0000: 
3516: 0000: INTEGER*1 GLOBAL                \
3517: 0000:    STKRC.LOC.CNT%,              \     
3518: 0000:    STKRC.RECL%         
3519: 0000: 
3520: 0000: 
3521: 0000:  %INCLUDE XGCFDEC.J86                     ! 1.8DA
3522: 0000: \******************************************************************************
3523: 0000: \******************************************************************************
3524: 0000: \***
3525: 0000: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
3526: 0000: \***
3527: 0000: \***                  FILE TYPE    : Keyed
3528: 0000: \***
3529: 0000: \***                  REFERENCE    : XGCFDEC.J86
3530: 0000: \***
3531: 0000: \***    VERSION A               Steve Wright                        24 Aug 1999
3532: 0000: \***
3533: 0000: \*******************************************************************************
3534: 0000: \*******************************************************************************
3535: 0000: 
3536: 0000: STRING GLOBAL           \
3537: 0000:    XGCF.FILE.NAME$,     \
3538: 0000:    XGCF.PRODUCT.GRP$,   \  Redundant - key changed from product group to BC
3539: 0000:    XGCF.BAR.CODE$,      \
3540: 0000:    XGCF.BSNS.CNTR$,     \  New key - 1 byte business centre
3541: 0000:    XGCF.RSRVD$          !  New key - 2 byte filler, must be 0x0000 (set by function)
3542: 0000: 
3543: 0000: INTEGER*2 GLOBAL        \
3544: 0000:    XGCF.RECL%,          \  
3545: 0000:    XGCF.REPORT.NUM%,    \ 
3546: 0000:    XGCF.SESS.NUM%
3547: 0000:  %INCLUDE STKEXDEC.J86                    ! 1.8DA
3548: 0000: \******************************************************************************
3549: 0000: \******************************************************************************
3550: 0000: \***
3551: 0000: \***   $Workfile:   STKEXDEC.J86  $
3552: 0000: \***
3553: 0000: \***   $Revision:   1.1  $
3554: 0000: \***
3555: 0000: \******************************************************************************
3556: 0000: \******************************************************************************
3557: 0000: \***
3558: 0000: \***   $Log:   V:\archive\j86\stkexdec.j8v  $
3559: 0000: \***   
3560: 0000: \***      Rev 1.1   05 Aug 1997 13:49:18   DEV45PS
3561: 0000: \***   Added Reason Code
3562: 0000: \***   
3563: 0000: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
3564: 0000: \***    
3565: 0000: \***   
3566: 0000: \***      Rev 1.0   09 Jul 1997 11:05:04   DEV45PS
3567: 0000: \***   Stocktake System New Files
3568: 0000: \***   
3569: 0000: \******************************************************************************
3570: 0000: \******************************************************************************\******************************************************************************
3571: 0000: \******************************************************************************
3572: 0000: \***
3573: 0000: \***         %INCLUDE FOR STOCKTAKE EXCEPTIONS FILE FIELD DECLARATIONS
3574: 0000: \***
3575: 0000: \***               FILE TYPE    : DIRECT
3576: 0000: \***
3577: 0000: \***               REFERENCE    : STKEXDEC.J86
3578: 0000: \***
3579: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3580: 0000: \***    New file for stocktaking system. Holds all counted items which  
3581: 0000: \***    are not on the IDF.
3582: 0000: \***
3583: 0000: \***    VERSION B              Nik Sen                 5th August 1997
3584: 0000: \***    Added reason code.
3585: 0000: \***
3586: 0000: \*******************************************************************************
3587: 0000: \*******************************************************************************
3588: 0000: 
3589: 0000: STRING GLOBAL                                                  \
3590: 0000:    STKEX.FILE.NAME$,            \
3591: 0000:    STKEX.ITEM.CODE$,           \
3592: 0000:    STKEX.QUANTITY$,            \
3593: 0000:    STKEX.LOCATION$,            \
3594: 0000:    STKEX.STOCKTAKER.NUM$,      \
3595: 0000:    STKEX.REASON.CODE$
3596: 0000: 
3597: 0000: 
3598: 0000: INTEGER*4 GLOBAL               \
3599: 0000:        STKEX.RECORD.NUM%
3600: 0000: 
3601: 0000: INTEGER*2 GLOBAL                \
3602: 0000:    STKEX.REPORT.NUM%,           \
3603: 0000:    STKEX.SESS.NUM%             
3604: 0000: 
3605: 0000: 
3606: 0000: INTEGER*1 GLOBAL                \
3607: 0000:    STKEX.RECL%         
3608: 0000: 
3609: 0000: 
3610: 0000:  %INCLUDE STKIFDEC.J86                    ! 1.8DA
3611: 0000: \******************************************************************************
3612: 0000: \******************************************************************************
3613: 0000: \***
3614: 0000: \***   $Workfile:   STKIFDEC.J86  $
3615: 0000: \***
3616: 0000: \***   $Revision:   1.2  $
3617: 0000: \***
3618: 0000: \******************************************************************************
3619: 0000: \******************************************************************************
3620: 0000: \***
3621: 0000: \***   $Log:   V:\archive\j86\stkifdec.j8v  $
3622: 0000: \***   
3623: 0000: \***      Rev 1.2   21 Aug 1997 11:20:56   DEV45PS
3624: 0000: \***    
3625: 0000: \***   
3626: 0000: \***      Rev 1.1   19 Aug 1997 11:06:14   DEV45PS
3627: 0000: \***   Added Stocktake Transmission File Record Number Field
3628: 0000: \***   
3629: 0000: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
3630: 0000: \***    
3631: 0000: \***   
3632: 0000: \***      Rev 1.0   09 Jul 1997 11:05:10   DEV45PS
3633: 0000: \***   Stocktake System New Files
3634: 0000: \***   
3635: 0000: \******************************************************************************
3636: 0000: \******************************************************************************\******************************************************************************
3637: 0000: \******************************************************************************
3638: 0000: \***
3639: 0000: \***         %INCLUDE FOR STOCKTAKE ITEM FILE FIELD DECLARATIONS
3640: 0000: \***
3641: 0000: \***               FILE TYPE    : KEYED
3642: 0000: \***
3643: 0000: \***               REFERENCE    : STKIFDEC.J86
3644: 0000: \***
3645: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3646: 0000: \***    New file for stocktaking system. Holds information about all counted
3647: 0000: \***    items found on the STOCK and IDF files. Key is Boots Code + Location 
3648: 0000: \***
3649: 0000: \***    VERSION B               Nik Sen                19 August 1997
3650: 0000: \***    Added STKMF Record Number field.
3651: 0000: \***
3652: 0000: \*******************************************************************************
3653: 0000: \*******************************************************************************
3654: 0000: 
3655: 0000: STRING GLOBAL                                                  \
3656: 0000:        STKIF.FILE.NAME$,               \
3657: 0000:        STKIF.KEY$,                     \
3658: 0000:        STKIF.ITEM.CODE$,               \
3659: 0000:        STKIF.LOCATION$,                \
3660: 0000:        STKIF.BUSINESS.CENTRE$,         \
3661: 0000:        STKIF.GROUP.SEQUENCE$,          \
3662: 0000:        STKIF.QUANTITY$,                \
3663: 0000:        STKIF.DESCRIPTION$,             \
3664: 0000:        STKIF.STOCKTAKER.NUM$
3665: 0000: 
3666: 0000: 
3667: 0000: 
3668: 0000: INTEGER*2 GLOBAL                \
3669: 0000:    STKIF.REPORT.NUM%,           \
3670: 0000:    STKIF.SESS.NUM%             
3671: 0000: 
3672: 0000: 
3673: 0000: INTEGER*1 GLOBAL                \
3674: 0000:    STKIF.RECL%         
3675: 0000: 
3676: 0000: INTEGER*4 GLOBAL                \
3677: 0000:    STKIF.STKMF.RECORD.NUM%
3678: 0000: 
3679: 0000: 
3680: 0000: 
3681: 0000:  %INCLUDE LOCNTDEC.J86                    ! 1.8DA
3682: 0000: \******************************************************************************
3683: 0000: \******************************************************************************
3684: 0000: \***
3685: 0000: \***   $Workfile:   LOCNTDEC.J86  $
3686: 0000: \***
3687: 0000: \***   $Revision:   1.0  $
3688: 0000: \***
3689: 0000: \******************************************************************************
3690: 0000: \******************************************************************************
3691: 0000: \***
3692: 0000: \***   $Log:   V:\archive\j86\locntdec.j8v  $
3693: 0000: \***   
3694: 0000: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
3695: 0000: \***    
3696: 0000: \***   
3697: 0000: \******************************************************************************
3698: 0000: \******************************************************************************
3699: 0000: \***
3700: 0000: \***         %INCLUDE FOR STOCKTAKE LOCATION COUNTERS (LOCCNT) DECLARATIONS
3701: 0000: \***
3702: 0000: \***               FILE TYPE    : DIRECT
3703: 0000: \***
3704: 0000: \***               REFERENCE    : LOCNTDEC.J86
3705: 0000: \***
3706: 0000: \***    VERSION A.              Johnnie Chan           6th Jan 1998
3707: 0000: \***    New file for stocktaking system. Holds all locations counted using
3708: 0000: \***    1st to 10000th record for S0000-S9999 and 10001st to 20000th record
3709: 0000: \***    for B0000-B9999.
3710: 0000: \***
3711: 0000: \*******************************************************************************
3712: 0000: \*******************************************************************************
3713: 0000: 
3714: 0000: STRING GLOBAL                           \
3715: 0000:        LOCCNT.FILE.NAME$
3716: 0000:        
3717: 0000: INTEGER*4 GLOBAL                        \
3718: 0000:        LOCCNT.RECORD.NUM%
3719: 0000: 
3720: 0000: 
3721: 0000: INTEGER*2 GLOBAL                        \
3722: 0000:        LOCCNT.REPORT.NUM%,              \
3723: 0000:        LOCCNT.SESS.NUM%             
3724: 0000: 
3725: 0000: 
3726: 0000: INTEGER*1 GLOBAL                        \
3727: 0000:        LOCCNT.LOCATION.COUNT%,          \
3728: 0000:        LOCCNT.RECL%         
3729: 0000: 
3730: 0000: 
3731: 0000:  %INCLUDE STKIGDEC.J86                    ! 1.8DA
3732: 0000: \******************************************************************************
3733: 0000: \******************************************************************************
3734: 0000: \***
3735: 0000: \***         %INCLUDE FOR STOCKTAKE ITEM GROUP FIELD DECLARATIONS
3736: 0000: \***
3737: 0000: \***               FILE TYPE    : DIRECT
3738: 0000: \***
3739: 0000: \***               REFERENCE    : STKIGDEC.J86
3740: 0000: \***
3741: 0000: \***    VERSION A.              Nik Sen.               17 Jun 1997.
3742: 0000: \***    New file for stocktaking system. Holds Business Centres, Concept
3743: 0000: \***    and product groups which define scope of stocktake.
3744: 0000: \***
3745: 0000: \*******************************************************************************
3746: 0000: \*******************************************************************************
3747: 0000: 
3748: 0000: STRING GLOBAL                                                  \
3749: 0000:    STKIG.FILE.NAME$,            \
3750: 0000:    STKIG.DATA$
3751: 0000: 
3752: 0000: INTEGER*4 GLOBAL               \
3753: 0000:    STKIG.RECORD.NUM%
3754: 0000: 
3755: 0000: INTEGER*2 GLOBAL                \
3756: 0000:    STKIG.REPORT.NUM%,           \
3757: 0000:    STKIG.SESS.NUM%             
3758: 0000: 
3759: 0000: 
3760: 0000: INTEGER*1 GLOBAL                \
3761: 0000:    STKIG.RECL%         
3762: 0000: 
3763: 0000: 
3764: 0000:  %INCLUDE STKTFDEC.J86                    ! 1.8DA
3765: 0000: \******************************************************************************
3766: 0000: \******************************************************************************
3767: 0000: \***
3768: 0000: \***   $Workfile:   STKTFDEC.J86  $
3769: 0000: \***
3770: 0000: \***   $Revision:   1.1  $
3771: 0000: \***
3772: 0000: \******************************************************************************
3773: 0000: \******************************************************************************
3774: 0000: \***
3775: 0000: \***   $Log:   V:\archive\j86\stktfdec.j8v  $
3776: 0000: \***   
3777: 0000: \***      Rev 1.1   15 Jul 1997 14:36:28   DEV45PS
3778: 0000: \***    
3779: 0000: \***   
3780: 0000: \***      Rev 1.0   15 Jul 1997 14:21:02   DEV45PS
3781: 0000: \***   Stocktake System New Files
3782: 0000: \***   
3783: 0000: \******************************************************************************
3784: 0000: \******************************************************************************\******************************************************************************
3785: 0000: \******************************************************************************
3786: 0000: \***
3787: 0000: \***         %INCLUDE FOR STOCKTAKE TOTALS FILE FIELD DECLARATIONS
3788: 0000: \***
3789: 0000: \***               FILE TYPE    : KEYED
3790: 0000: \***
3791: 0000: \***               REFERENCE    : STKTFDEC.J86
3792: 0000: \***
3793: 0000: \***    VERSION A.              Nik Sen.               15 July 1997.
3794: 0000: \***    New file for stocktaking system. Holds information about all counted
3795: 0000: \***    items found on the STOCK and IDF files. Key is Boots Code. 
3796: 0000: \***
3797: 0000: \*******************************************************************************
3798: 0000: \*******************************************************************************
3799: 0000: 
3800: 0000: STRING GLOBAL                                                  \
3801: 0000:        STKTF.FILE.NAME$,               \
3802: 0000:        STKTF.BOOTS.CODE$,              \
3803: 0000:        STKTF.BUSINESS.CENTRE$,         \
3804: 0000:        STKTF.GROUP.SEQUENCE$,          \
3805: 0000:        STKTF.QUANTITY$                
3806: 0000: 
3807: 0000: 
3808: 0000: 
3809: 0000: INTEGER*2 GLOBAL                \
3810: 0000:    STKTF.REPORT.NUM%,           \
3811: 0000:    STKTF.SESS.NUM%             
3812: 0000: 
3813: 0000: 
3814: 0000: INTEGER*1 GLOBAL                \
3815: 0000:    STKTF.RECL%         
3816: 0000: 
3817: 0000: 
3818: 0000:  %INCLUDE IRFDEC.J86                      ! 1.8DA
3819: 0000: 
3820: 0000: \**********************************************************************************
3821: 0000: \***
3822: 0000: \***       %INCLUDE FOR ITEM RECORD FILE - FIELD DECLARATIONS
3823: 0000: \***                                     - FILE REFERENCE PARAMETERS
3824: 0000: \***
3825: 0000: \***                      FILE TYPE    : Keyed
3826: 0000: \***
3827: 0000: \***                      REFERENCE    : IRFDEC.J86
3828: 0000: \***
3829: 0000: \***     Version A               Andrew Wedgeworth            29th June 1992
3830: 0000: \***
3831: 0000: \***     Version B               Andrew Wedgeworth        14th December 1992
3832: 0000: \***     Version letter incremented to match other IRF code.
3833: 0000: \***
3834: 0000: \***     Version C             Steve Windsor          12.02.93
3835: 0000: \***     Version letter incremented to match other IRF code.
3836: 0000: \***
3837: 0000: \***     Version D             Steve Windsor          12.05.93
3838: 0000: \***     Version letter incremented to match other IRF code.
3839: 0000: \***
3840: 0000: \***     Version E           Steve Perkins       20th September 1993
3841: 0000: \***     Deals project : Handling of Converted/Unconverted records
3842: 0000: \***     ++   Anything with 'Delete' after initials should be   ++
3843: 0000: \***     ++   deleted once the IRF has been converted in all    ++
3844: 0000: \***     ++   stores.                                           ++
3845: 0000: \***
3846: 0000: \***     Version F           Mark Walker            5th January 1994
3847: 0000: \***     Version letter incremented to match other IRF code.
3848: 0000: \***
3849: 0000: \***     Version 96A         Mark Walker               22nd May 1995
3850: 0000: \***     Definition for IRF.POINTS% added.
3851: 0000: \***
3852: 0000: \***                     Stuart McConnachie           12th June 1995
3853: 0000: \***     INDICAT3% comments added for discount/loyalty flags.
3854: 0000: \***
3855: 0000: \***     Version for 96C  Andrew Wedgeworth            22nd May 1996
3856: 0000: \***     Removed IRF.FILLER$ field, as this is now redundant.
3857: 0000: \***
3858: 0000: \***     Version G     Stuart William McConnachie      11th February 2000
3859: 0000: \***     Converted IRF.INDICAT2$ to integer flag byte.
3860: 0000: \***
3861: 0000: \***     REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
3862: 0000: \***     Major changes for 2002 Deals Rewrite project.
3863: 0000: \***     Incorporated up to date record layout to assist development work
3864: 0000: \***     (placed in the IRFDEC.J86 to make it visible from ...LST files).
3865: 0000: \***     Moved various comments against variables to record layout.
3866: 0000: \***     Relisted variables in alphabetical order.
3867: 0000: \***     Deleted redundant variables associated with the old deals system ...
3868: 0000: \***     DEAL.NUM$, DEAL.SAVING$
3869: 0000: \***     Retained variables that are otherwise redundant (to be set to null X'00'
3870: 0000: \***     within file functions) ...
3871: 0000: \***     INDICAT2%, INDICAT4%, SALEQUAN$, POINTS%
3872: 0000: \***     Defined variables to hold interpreted deals data for new deals system ...
3873: 0000: \***     DEAL.NUM$(n) and LIST.ID%(n) (where 'n' represents entry 0, 1 and 2).
3874: 0000: \***     These two variables are interpretations of DEAL.DATA% which is defined
3875: 0000: \***     locally within IRFFUN.BAS to keep underlying data invisible to programs.
3876: 0000: \***
3877: 0000: \***     REVISION 1.7                ROBERT COWEY.               5 AUG 2002.
3878: 0000: \***     Further changes for 2002 Deals Rewrite project (PSBF19 related).
3879: 0000: \***     Defined NEW.IRF.DATA$ as a global variable for use with new functions
3880: 0000: \***     CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
3881: 0000: \***
3882: 0000: \***     REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
3883: 0000: \***     Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
3884: 0000: \***     No changes to this file other than description.
3885: 0000: \***     No changes to IRF file functions.
3886: 0000: \***
3887: 0000: \***     REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
3888: 0000: \***     Changes to remove limit of 3 deals per item.
3889: 0000: \***     Declaration of new variables for IRF Deal Extension file (IRFDEX).
3890: 0000: \***
3891: 0000: \***     REVISION 2.0.            ALAN CARR                       9 FEB 2006.
3892: 0000: \***     Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
3893: 0000: \***
3894: 0000: \***     REVISION 2.1              TITTOO THOMAS                  01 July 2011
3895: 0000: \***     The IRF.UNUSED field is disintegrated to 2 new indicator fields
3896: 0000: \***                      IRF.INDICAT9%   1 INT
3897: 0000: \***                      IRF.INDICAT10%  1 INT
3898: 0000: \***...............................................................................
3899: 0000: 
3900: 0000: 
3901: 0000: \**********************************************************************************
3902: 0000: \***
3903: 0000: \***    IRF RECORD LAYOUT - REVISION 1.7 - CORRECT FOR 2011 CORE Stores PROJECT
3904: 0000: \***
3905: 0000: \***     1 11  UPD  BAR.CODE$   Without check digit - File KEY
3906: 0000: \***    12  1  INT  INDICAT0%
3907: 0000: \***                    X"01" - Contains statins                           ! 2.2 TT
3908: 0000: \***                    X"02" - Item not priced (giveaway)
3909: 0000: \***                    X"04" - Item not returnable
3910: 0000: \***                    X"08" - Item contains alcohol
3911: 0000: \***                    X"10" - Blocked from sale                          ! 2.2 TT
3912: 0000: \***                    X"20" - Enforced price entry
3913: 0000: \***                    X"40" - Enforced quantity entry
3914: 0000: \***                    X"80" - Movement kept
3915: 0000: \***    13  1  INT  INDICAT1%
3916: 0000: \***                    X"01" - Asprin
3917: 0000: \***                    X"02" - Paracetamol
3918: 0000: \***                    X"04" - TPLU inclusion flag
3919: 0000: \***                    X"08" - Giftcard item                              ! 2.2 TT
3920: 0000: \***                    X"10" - Withdrawn Block from sale                  ! 2.2 TT
3921: 0000: \***                    X"20" - Non-solid dose painkiller                  ! 2.2 TT
3922: 0000: \***                    X"40" - Insurance policy item                      ! 2.2 TT
3923: 0000: \***                    X"80" - Ibuprofen
3924: 0000: \***    14  2  INT  DEAL.DATA%(0)   Interpreted into sub-variables ...
3925: 0000: \***                    X'3F' - into DEAL.NUM$(0) "0000" to "9999" (2 byte UPD)
3926: 0000: \***                    X'C0' - into LIST.ID%(0) X'00' X
3927: 0000: \***                                             X'01' A
3928: 0000: \***                                             X'10' B
3929: 0000: \***                                             X'11' C                   ! 1.9 RC
3930: 0000: \***    16  1  INT  INDICAT8%                                              ! 2.0 AJC
3931: 0000: \***                    X"01" - Chlamydia NHS test kit                     ! 2.2 TT
3932: 0000: \***                    X"02" - Chlamydia open sell test kit               ! 2.2 TT
3933: 0000: \***                    X"04" - Unrestricted group code                    ! 2.2 TT
3934: 0000: \***                    X"08" - Nightingale Till prompt                    ! 2.2 TT
3935: 0000: \***                    X"10" - Contains Ephedrine                         ! 2.2 TT
3936: 0000: \***                    X"60" -  X'00' - If also Blocked From Sale Recall, ! 2.2 TT
3937: 0000: \***                                        Emergency                      ! 2.2 TT
3938: 0000: \***                             X'00' - If NOT Blocked From Sale Recall,  ! 2.2 TT
3939: 0000: \***                                        No recall                      ! 2.2 TT
3940: 0000: \***                             X'20' 100% returns                        ! 2.2 TT
3941: 0000: \***                             X'40' Withdrawn recall                    ! 2.2 TT
3942: 0000: \***                             X'60' Reverse Logistics                   ! 2.2 TT
3943: 0000: \***                    X"80" - WEEE item flag                             ! 2.0 AJC
3944: 0000: \***    17  1  INT  INDICAT9%
3945: 0000: \***                    X'3F' - Disposal special instruction (0-63)
3946: 0000: \***                    X"40" - Resaleable Indicator
3947: 0000: \***                    X"80" - Boots.com Extended Indicator
3948: 0000: \***    18  1  INT  INDICAT10%
3949: 0000: \***                    X'07' - Age restrictions
3950: 0000: \***                             X'00' - No Age restriction
3951: 0000: \***                             X'01' - Age 12 or over
3952: 0000: \***                             X'02' - Age 15 or over
3953: 0000: \***                             X'03' - Age 16 or over
3954: 0000: \***                             X'04' - Age 18 or over
3955: 0000: \***                             X'05' - Age 21 or over
3956: 0000: \***                             X'06' - Reserved
3957: 0000: \***                             X'07' - Reserved
3958: 0000: \***                    X'38' - Ethical classification
3959: 0000: \***                             X'00' - No ethical classification
3960: 0000: \***                             X'08' - Pharmacy medicine (P)
3961: 0000: \***                             X'10' - General Sale License (GSL)
3962: 0000: \***                             X'18' - Prescription Only Medicine (POM)
3963: 0000: \***                             X'20' - Reserved
3964: 0000: \***                             X'28' - Reserved
3965: 0000: \***                             X'30' - Reserved
3966: 0000: \***                             X'38' - Reserved
3967: 0000: \***                    X'C0' - Returns route
3968: 0000: \***                             X'00' - Not Returnable (Destroy)
3969: 0000: \***                             X'40' - Returns & Recovery
3970: 0000: \***                             X'80' - Direct
3971: 0000: \***                             X'C0' - Semi-centralised
3972: 0000: \***    19  5  UPD  SALEPRIC$   Current price in pence
3973: 0000: \***    24  1  INT  INDICAT5%   Guarantee duration
3974: 0000: \***                    X'3F' - Lowest 6 bits indicate duration (1-63)
3975: 0000: \***                    X'40' - Contains Pseudoephedrine                   ! 2.2 TT
3976: 0000: \***                    X'80' - Guarantee Duration Type                    ! 2.2 TT
3977: 0000: \***                              (1 = Months, 0 = Years)                  ! 2.2 TT
3978: 0000: \***    25 18  ASC  ITEMNAME$   Description used by till
3979: 0000: \***    43  3  UPD  BOOTS.CODE$ Without check digit
3980: 0000: \***    46  2  INT  DEAL.DATA%(1)   Similar structure to DEAL.DATA%(0)
3981: 0000: \***    48  2  INT  DEAL.DATA%(2)   Similar structure to DEAL.DATA%(0)
3982: 0000: \***    50  1  INT  INDICAT3%
3983: 0000: \***                    X"01" - Discountexempt (item exempt from discount)
3984: 0000: \***                    X"02" - Boots brand item
3985: 0000: \***                    X"04" - Item redeemable for loyalty
3986: 0000: \***                    X"08" - Loyalty exempt (item exempt from loyalty)
3987: 0000: \***                    X"10" - **Redundant                                ! 2.2 TT
3988: 0000: \***                    X"20" - Local Price active
3989: 0000: \***                    X"40" - Stock system item
3990: 0000: \***                    X"80" - **Redundant                                ! 2.2 TT
3991: 0000: \***
3992: 0000: \***    Record Length 50
3993: 0000: \***
3994: 0000: \***
3995: 0000: \***    IRF DEAL EXTENSION RECORD LAYOUT ! 1.9 RC
3996: 0000: \***
3997: 0000: \***     1  3  UPD  BOOTS.CODE$
3998: 0000: \***     4  2  INT  IRF.DEAL.DATA%(3)   Similar structure to DEAL.DATA%(0)
3999: 0000: \***     6  2  INT  IRF.DEAL.DATA%(4)   Similar structure to DEAL.DATA%(0)
4000: 0000: \***     8  2  INT  IRF.DEAL.DATA%(5)   Similar structure to DEAL.DATA%(0)
4001: 0000: \***    10  2  INT  IRF.DEAL.DATA%(6)   Similar structure to DEAL.DATA%(0)
4002: 0000: \***    12  2  INT  IRF.DEAL.DATA%(7)   Similar structure to DEAL.DATA%(0)
4003: 0000: \***    14  2  INT  IRF.DEAL.DATA%(8)   Similar structure to DEAL.DATA%(0)
4004: 0000: \***    16  2  INT  IRF.DEAL.DATA%(9)   Similar structure to DEAL.DATA%(0)
4005: 0000: \***
4006: 0000: \***    Record Length 17
4007: 0000: \***
4008: 0000: \**********************************************************************************
4009: 0000: 
4010: 0000: 
4011: 0000:     STRING GLOBAL            \
4012: 0000:         IRF.ALT.FILE.NAME$,  \
4013: 0000:         IRF.BAR.CODE$,       \
4014: 0000:         IRF.BOOTS.CODE$,     \
4015: 0000:         IRF.DEAL.SAVING$,    \ 2 byte - deal saving amount (0 - 99.99) ! ESP
4016: 0000:         IRF.DEPARTME$,       \ 3 byte UPD. Department number          ! ESP Delete
4017: 0000:         IRF.FILE.NAME$,      \
4018: 0000:         IRF.HOLDING.PRICE$,  \ 4 byte UPD. Current H.O. price in pence if a local
4019: 0000:                              \ price is in effect, zero otherwise.     ! ESP Delete
4020: 0000:         IRF.ITEMNAME$,       \
4021: 0000: \       IRF.MPGROUP$,        \ Removed SBH 31/1/96
4022: 0000:         IRF.RECORD$,         \                                         ! ESP Delete
4023: 0000:         IRF.SALEPRIC$,       \
4024: 0000:         IRF.SALEQUAN$,       \ Redundant (set to null within functions)    ! 1.6 RC
4025: 0000:         IRF.UNUSED$,         \                                                        ! 1.6 RC
4026: 0000:         NEW.IRF.DATA$        !                                             ! 1.7 RC
4027: 0000: 
4028: 0000:     STRING GLOBAL            \                                             ! 1.6 RC
4029: 0000:         IRF.DEAL.NUM$(1)                                                   ! 1.6 RC
4030: 0000: 
4031: 0000:     INTEGER*1 GLOBAL         \
4032: 0000:         IRF.DD.SUB%,         \ IRF.DEAL.DATA% subscript                    ! 1.6 RC
4033: 0000:         IRF.INDICAT0%,       \
4034: 0000:         IRF.INDICAT1%,       \
4035: 0000:         IRF.INDICAT2%,       \ Redundant (set to null within functions)    ! 1.6 RC
4036: 0000:         IRF.INDICAT3%,       \
4037: 0000:         IRF.INDICAT4%,       \ Redundant (set to null within functions)    ! 1.6 RC
4038: 0000:         IRF.INDICAT5%,       \                                             ! 2.0 AJC
4039: 0000:         IRF.INDICAT8%,       \                                             ! 2.0 AJC
4040: 0000:         IRF.INDICAT9%,       \                                             ! 2.2 TT
4041: 0000:         IRF.INDICAT10%                                                     ! 2.2 TT
4042: 0000: 
4043: 0000:     INTEGER*1 GLOBAL         \                                             ! 1.6 RC
4044: 0000:         IRF.LIST.ID%(1)                                                    ! 1.6 RC
4045: 0000: 
4046: 0000:     INTEGER*2 GLOBAL         \
4047: 0000:         IRF.ALT.REPORT.NUM%, \
4048: 0000:         IRF.ALT.SESS.NUM%,   \
4049: 0000:         IRF.POINTS%,         \ Redundant (set to null within functions)    ! 1.6 RC
4050: 0000:         IRF.RECL%,           \
4051: 0000:         IRF.REPORT.NUM%,     \
4052: 0000:         IRF.SESS.NUM%,       \
4053: 0000:         IRF.MAX.DEALS%       !                                             ! 1.9 SM
4054: 0000: 
4055: 0000:     STRING GLOBAL IRFDEX.FILE.NAME$                                        ! 1.9 SM
4056: 0000: 
4057: 0000:     INTEGER*2 GLOBAL IRFDEX.SESS.NUM%                                      ! 1.9 SM
4058: 0000:     INTEGER*2 GLOBAL IRFDEX.REPORT.NUM%                                    ! 1.9 SM
4059: 0000:     INTEGER*2 GLOBAL IRFDEX.RECL%                                          ! 1.9 SM
4060: 0000: 
4061: 0000: 
4062: 0000: !   INTEGER*2 GLOBAL      \ IRF.DEAL.DATA%(n) variables are defined locally  1.6 RC
4063: 0000: !       IRF.DEAL.DATA%(1) \ within IRFFUN.BAS to keep invisible to programs  1.6 RC
4064: 0000: 
4065: 0000:  %INCLUDE STKDCDEC.J86                    ! 1.8DA
4066: 0000: \******************************************************************************
4067: 0000: \******************************************************************************
4068: 0000: \***
4069: 0000: \***   $Workfile:   STKDCDEC.J86  $
4070: 0000: \***
4071: 0000: \***   $Revision:   1.0  $
4072: 0000: \***
4073: 0000: \******************************************************************************
4074: 0000: \******************************************************************************
4075: 0000: \***
4076: 0000: \***   $Log:   V:\archive\j86\stkdcdec.j8v  $
4077: 0000: \***   
4078: 0000: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
4079: 0000: \***    
4080: 0000: \***   
4081: 0000: \***      Rev 1.0   09 Jul 1997 11:04:58   DEV45PS
4082: 0000: \***   Stocktake System New Files
4083: 0000: \***   
4084: 0000: \******************************************************************************
4085: 0000: \******************************************************************************\******************************************************************************
4086: 0000: \******************************************************************************
4087: 0000: \***
4088: 0000: \***         %INCLUDE FOR STOCKTAKE DUMP CODEP FIELD DECLARATIONS
4089: 0000: \***
4090: 0000: \***               FILE TYPE    : DIRECT
4091: 0000: \***
4092: 0000: \***               REFERENCE    : STKDCDEC.J86
4093: 0000: \***
4094: 0000: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4095: 0000: \***    New file for stocktaking system. Holds all items counted using
4096: 0000: \***    dump codes during the stocktake.
4097: 0000: \***
4098: 0000: \*******************************************************************************
4099: 0000: \*******************************************************************************
4100: 0000: 
4101: 0000: STRING GLOBAL                                                  \
4102: 0000:        STKDC.FILE.NAME$,               \
4103: 0000:        STKDC.DUMP.CODE$,               \
4104: 0000:        STKDC.QUANTITY$,                \
4105: 0000:        STKDC.PRICE$,                   \
4106: 0000:        STKDC.LOCATION$,                \
4107: 0000:        STKDC.STOCKTAKER.NUM$
4108: 0000:         
4109: 0000: INTEGER*4 GLOBAL               \
4110: 0000:        STKDC.RECORD.NUM%
4111: 0000: 
4112: 0000: 
4113: 0000: INTEGER*2 GLOBAL                \
4114: 0000:    STKDC.REPORT.NUM%,           \
4115: 0000:    STKDC.SESS.NUM%             
4116: 0000: 
4117: 0000: 
4118: 0000: INTEGER*1 GLOBAL                \
4119: 0000:    STKDC.RECL%         
4120: 0000: 
4121: 0000: 
4122: 0000:  %INCLUDE MINLSDEC.J86                    ! 1.9BG
4123: 0000: 
4124: 0000: \*****************************************************************************
4125: 0000: \*****************************************************************************
4126: 0000: \***
4127: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4128: 0000: \***
4129: 0000: \***                   FILE TYPE:  KEYED
4130: 0000: \***
4131: 0000: \***                   REFERENCE:  MINLSDEC.J86
4132: 0000: \***
4133: 0000: \***              DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
4134: 0000: \***
4135: 0000: \***
4136: 0000: \***
4137: 0000: \***      VERSION 1 : Julia Stones             8th January 1998  
4138: 0000: \***      
4139: 0000: \*****************************************************************************
4140: 0000: \*****************************************************************************
4141: 0000: 
4142: 0000: STRING GLOBAL   \
4143: 0000:    MINLS.FILE.NAME$,  \
4144: 0000:    MINLS.ITEM.CODE$,     \  4 byte UPD;  Record key
4145: 0000:    MINLS.RECOUNT.DATE$,  \  3 byte UPD;  YYMMDD      
4146: 0000:    MINLS.DISCREPANCY$,    \  3 byte UPD        
4147: 0000:    MINLS.COUNT.STATUS$     ! 1 byte ASCII 
4148: 0000: 
4149: 0000: INTEGER*2 GLOBAL  \
4150: 0000:    MINLS.RECL%,   \
4151: 0000:    MINLS.REPORT.NUM%,  \
4152: 0000:    MINLS.SESS.NUM%   !
4153: 0000: 
4154: 0000: 
4155: 0000: 
4156: 0000:  %INCLUDE NEGSCDEC.J86                    ! 1.9BG
4157: 0000: 
4158: 0000: \*****************************************************************************
4159: 0000: \*****************************************************************************
4160: 0000: \***
4161: 0000: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4162: 0000: \***
4163: 0000: \***                   FILE TYPE:  KEYED
4164: 0000: \***
4165: 0000: \***                   REFERENCE:  NEGSCDEC.J86
4166: 0000: \***
4167: 0000: \***              DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
4168: 0000: \***
4169: 0000: \***
4170: 0000: \***
4171: 0000: \***      VERSION 1 : Julia Stones             15th July 1999  
4172: 0000: \***      
4173: 0000: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
4174: 0000: \***    Changes for RF trial.
4175: 0000: \***    Recompiled to prevent future automatic recompiles.
4176: 0000: \***    No changes to actual code.
4177: 0000: \***
4178: 0000: \*****************************************************************************
4179: 0000: \*****************************************************************************
4180: 0000: 
4181: 0000: STRING GLOBAL   \
4182: 0000:    NEGSC.FILE.NAME$,  \
4183: 0000:    NEGSC.KEY$,   \      !  5 bytes UPD; 1 byte Record type 
4184: 0000:                         \                 Record type 01 item record
4185: 0000:                         \                 Record type 02 total count record
4186: 0000:                         \               4 bytes item code (set to zero's if
4187: 0000:                         \                 record type 02)
4188: 0000:    NEGSC.STATUS.1$      !  1 byte ASC
4189: 0000:                         !            'B' - Discontinued but still on display
4190: 0000:                         !            'C' - Cancel outstanding orders
4191: 0000:                         !            'D' - Discontinued and no longer on display
4192: 0000:                         !            'P' - Suspended (orders to Store)
4193: 0000:                         !            'X' - Deleted
4194: 0000:                         !            ' ' - No special Status (default value)
4195: 0000:   
4196: 0000: INTEGER*2 GLOBAL  \
4197: 0000:    NEGSC.RECL%,   \
4198: 0000:    NEGSC.REPORT.NUM%,  \
4199: 0000:    NEGSC.SESS.NUM%,    \
4200: 0000:    NEGSC.ITEM.TSF%,    \
4201: 0000:    NEGSC.NUMBER.OF.DAYS%   !
4202: 0000: 
4203: 0000: 
4204: 0000: 
4205: 0000:  %INCLUDE SSPSCDEC.J86                    ! 2.0JAS
4206: 0000: \*****************************************************************************
4207: 0000: \*****************************************************************************
4208: 0000: \***
4209: 0000: \***               %INCLUDE FOR SSPSCTRL - FIELD DECLARATIONS
4210: 0000: \***                                          FILE REFERENCE PARAMETERS
4211: 0000: \***
4212: 0000: \***                      FILE TYPE    : DIRECT
4213: 0000: \***
4214: 0000: \***                      REFERENCE    : SSPSCdea.J86
4215: 0000: \***
4216: 0000: \***    Version A               Julia Stones          23 Oct 2003
4217: 0000: \***
4218: 0000: \***
4219: 0000: \*****************************************************************************
4220: 0000: \*****************************************************************************
4221: 0000: 
4222: 0000: REM \
4223: 0000: 
4224: 0000:   STRING GLOBAL           \
4225: 0000:     SSPSCTRL.FILE.NAME$
4226: 0000: 
4227: 0000:   INTEGER*2 GLOBAL        \
4228: 0000:     SSPSCTRL.REPORT.NUM%,   \
4229: 0000:     SSPSCTRL.SESS.NUM%
4230: 0000: REM \
4231: 0000: 
4232: 0000:   STRING GLOBAL           \
4233: 0000:     SSPS.BTCSK.NUM$,      \ 3 byte, file ext number (000 - 999)
4234: 0000:     SSPS.BTCSF.NUM$,      \ 3 byte, file ext number (000 - 999)
4235: 0000:     SSPS.BTCSK.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4236: 0000:     SSPS.BTCSF.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4237: 0000:     SSPS.FILLER$          ! 68 byte, spaces
4238: 0000: 
4239: 0000:   INTEGER*2 GLOBAL        \
4240: 0000:     SSPSCTRL.RECL%
4241: 0000:  %INCLUDE BTCSDEC.J86                     ! 2.0JAS
4242: 0000: \*****************************************************************************
4243: 0000: \*****************************************************************************
4244: 0000: \***
4245: 0000: \***      %INCLUDE FOR BTCS FILE - FIELD DECLARATIONS
4246: 0000: \***                               FILE REFERENCE PARAMETERS
4247: 0000: \***
4248: 0000: \***      FILE TYPE    : DIRECT
4249: 0000: \***
4250: 0000: \***      REFERENCE    : BTCSDEC
4251: 0000: \***
4252: 0000: \***      VERSION A    : Julia Stones 22/10/03
4253: 0000: \***
4254: 0000: \*****************************************************************************
4255: 0000: \*****************************************************************************
4256: 0000: 
4257: 0000:     STRING GLOBAL        BTCS.FILE.NAME$
4258: 0000: 
4259: 0000: 
4260: 0000:     INTEGER*2 GLOBAL     BTCS.SESS.NUM%,        \
4261: 0000:                          BTCS.RECL%,            \
4262: 0000:                          BTCS.REPORT.NUM%
4263: 0000: 
4264: 0000: 
4265: 0000:     INTEGER*4 GLOBAL     BTCS.REC.NUM%
4266: 0000: 
4267: 0000: 
4268: 0000:     STRING GLOBAL        BTCS.RECORD$,           \ Whole record form file:
4269: 0000:                          BTCS.RECORD.TYPE$,      \ 1 ASC Type of record:
4270: 0000:                                                  \       "H" = header
4271: 0000:                                                  \       "D" = detail
4272: 0000:                                                  \       "T" = trailer
4273: 0000:                          BTCS.STORE.NUMBER$,     \ 4 ASC 4 digit Store number
4274: 0000:                          BTCS.STKTAKE.NUM$,      \ 4 ASC 4 digit Stock take number
4275: 0000:                          BTCS.DATE$,             \ 6 ASC Date YYMMDD
4276: 0000:                          BTCS.TIME$,             \ 6 ASC Time HHMMSS
4277: 0000:                          BTCS.DISP.AREA$,        \ 1 ASC M = MDS
4278: 0000:                                                  \       D = Dispensing
4279: 0000:                          BTCS.FILLER$,           \   ASC Set to spaces
4280: 0000:                          BTCS.NUM.RECORD$,       \ 4 ASC Record sequence number starting at 0001
4281: 0000:                          BTCS.ITEM.CODE$,        \13 ASC Item Code/PIP code
4282: 0000:                          BTCS.CODE.TYPE$,        \ 1 ASC E = EAN item code
4283: 0000:                                                  \       P = PIP code
4284: 0000:                          BTCS.PACK.QTY$,         \ 6 ASC Number of packs, bottles etc
4285: 0000:                          BTCS.DIS.UNIT.QTY$,     \ 4 ASC Dispensed unit quantity
4286: 0000:                          BTCS.RECORD.COUNT$,     \ 4 ASC Amount of records in file (inc header and trailer)
4287: 0000:                          BTCS.ENDREC$            \ 2 ASC ODOA
4288: 0000: 
4289: 0000:  %INCLUDE PRINTDEC.J86                    ! 2.0JAS
4290: 0000: 
4291: 0000: REM \
4292: 0000: \*******************************************************************************
4293: 0000: \*******************************************************************************
4294: 0000: \***
4295: 0000: \***    %INCLUDE FOR PRINT FILE VARIABLE DECLARATIONS
4296: 0000: \***
4297: 0000: \***        REFERENCE   :   PRINTDE (J86)
4298: 0000: \***
4299: 0000: \***        FILE TYPE   :   Printer / Labeller
4300: 0000: \***
4301: 0000: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
4302: 0000: \***    Original version created by merging PRINTFLG and PRINTNUG.
4303: 0000: \***
4304: 0000: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
4305: 0000: \***    Changes unknown.             
4306: 0000: \***
4307: 0000: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
4308: 0000: \***    No changes made to this file.
4309: 0000: \***
4310: 0000: \***    Version D               Andrew Wedgeworth                 24th May 1992
4311: 0000: \***    Variable added to contain condensed print record length.
4312: 0000: \***
4313: 0000: \*******************************************************************************
4314: 0000: \*******************************************************************************
4315: 0000: 
4316: 0000: 
4317: 0000:     STRING GLOBAL \
4318: 0000:         PRINT.LINE$, \
4319: 0000:         PRINT.FILE.NAME$, \
4320: 0000:         SELF.LAN.NAME$, \
4321: 0000:         SELF.NOLAN.NAME$
4322: 0000: 
4323: 0000:     INTEGER*2 GLOBAL \
4324: 0000:         PRINT.CONDENSED.RECL%, \                                       ! DAW  
4325: 0000:         PRINT.SESS.NUM%, \
4326: 0000:         PRINT.REPORT.NUM%, \
4327: 0000:         PRINT.REPORT.RECL%, \
4328: 0000:         PRINT.SELF.RECL%
4329: 0000: 
4330: 0000:  %INCLUDE SOPTSDEC.J86                    ! 2.1JAS
4331: 0000: REM \
4332: 0000: \******************************************************************************
4333: 0000: \******************************************************************************
4334: 0000: \***
4335: 0000: \***                 %INCLUDE FOR THE STORE OPTIONS FILE
4336: 0000: \***   
4337: 0000: \***                      FILE TYPE  :   Direct
4338: 0000: \***
4339: 0000: \***                      REFERENCE  :   SOPTSDEC.J86
4340: 0000: \***
4341: 0000: \***    Version A         Stuart William McConnachie      19th June 1995
4342: 0000: \***
4343: 0000: \******************************************************************************
4344: 0000: \*******************************************************************************
4345: 0000: 
4346: 0000:   STRING GLOBAL           \
4347: 0000:     SOPTS.RECORD$,        \           
4348: 0000:     SOPTS.SPACE$,         \           
4349: 0000:     SOPTS.FILE.NAME$
4350: 0000:     
4351: 0000:   INTEGER*2 GLOBAL        \
4352: 0000:     SOPTS.RECL%,          \            
4353: 0000:     SOPTS.REPORT.NUM%,    \      
4354: 0000:     SOPTS.SESS.NUM%
4355: 0000: 
4356: 0000:   INTEGER*4 GLOBAL        \
4357: 0000:     SOPTS.REC.NUM%
4358: 0000: 
4359: 0000:  %INCLUDE TSFDEC.J86                      ! 2.1JAS
4360: 0000: \*****************************************************************************
4361: 0000: \*****************************************************************************
4362: 0000: \***
4363: 0000: \***      %INCLUDE FOR TERMINAL STATUS FILE - FIELD DECLARATIONS
4364: 0000: \***                                          FILE REFERENCE PARAMETERS
4365: 0000: \***
4366: 0000: \***                      FILE TYPE    : KEYED
4367: 0000: \***
4368: 0000: \***                      REFERENCE    : TSFDEC
4369: 0000: \***
4370: 0000: \***           VERSION A : STEVEN GOULDING              13.10.92
4371: 0000: \***
4372: 0000: \***           VERSION B : STEVE WINDSOR                15.09.93
4373: 0000: \***           Updated to keep in step.
4374: 0000: \***
4375: 0000: \***           VERSION C : STUART WILLIAM MCCONNACHIE   18.03.97
4376: 0000: \***           Added extra fields in user data.
4377: 0000: \*** 
4378: 0000: \***           VERSION D : REBECCA DAKIN                22.02.99
4379: 0000: \***           Added ACSALD.CUT.OFF, as part of Cash Accounting project.
4380: 0000: \***
4381: 0000: \***           VERSION E : AMY HOGGARD                  16.10.00
4382: 0000: \***           Added TILLBAG.CUT.OFF, as part of ECO project.
4383: 0000: \***
4384: 0000: \***           VERSION F : STUART WILLIAM MCCONNACHIE   20.05.05
4385: 0000: \***           Added "new" fields as no one else can be bothered.
4386: 0000: \***           Corrected offset bug of controller ID.
4387: 0000: \***
4388: 0000: \***           VERSION G : JAMIE THORPE                 05.10.05
4389: 0000: \***           Added new INVDUE.DATE record to the store record 
4390: 0000: \***           (for Zero TSF proj.)
4391: 0000: \***           This is the date that the most recent INVDUE file
4392: 0000: \***           was created.
4393: 0000: \***
4394: 0000: \***    VERSION H               Mark Walker                      3rd Nov 2014
4395: 0000: \***    F294 PCI Phase 1
4396: 0000: \***    Includes the following changes:
4397: 0000: \***    - Removed redundant 'smartcard software level' field.
4398: 0000: \***    - Extended TSF.INDICAT2% integer field from 1 to 2 bytes.
4399: 0000: \***
4400: 0000: \*****************************************************************************
4401: 0000: \*****************************************************************************
4402: 0000: 
4403: 0000:     STRING GLOBAL               \
4404: 0000:         TSF.FILE.NAME$,         \
4405: 0000:         TSF.REC$(1),            \ One dimensional array
4406: 0000:         TSF.SECTOR.FILLER$,     \
4407: 0000:         TSF.SECTOR.INFO$
4408: 0000:         
4409: 0000:     INTEGER*1 GLOBAL            \
4410: 0000:         TSF.REC.SUB%            ! Subscript used with TSF.REC array
4411: 0000: 
4412: 0000:     INTEGER*2 GLOBAL            \
4413: 0000:         TSF.SESS.NUM%,          \
4414: 0000:         TSF.RECL%,              \
4415: 0000:         TSF.REPORT.NUM%,        \
4416: 0000:         TSF.SECTOR.NUM%
4417: 0000: 
4418: 0000:     STRING GLOBAL               \
4419: 0000:         TSF.TERM.STORE$,        \ 2 byte UPD.Terminal number or 
4420: 0000:                                 \ 9999 for store (key)
4421: 0000:         TSF.TSL.NAME$,          \ 8 bytes. Most recent old TSL file
4422: 0000:         TSF.MONITOR$,           \ 2 byte UPD last monitoring terminal
4423: 0000:         TSF.TLOGFLAG$,          \ 1 byte, EALLGHC processed flag
4424: 0000:         TSF.OPERATOR$,          \ Operator number
4425: 0000:         TSF.TRANSNUM$,          \ Most recent transaction
4426: 0000:         TSF.RCPSTATUS$,         \ Store close requested through RCF                                                             
4427: 0000:         TSF.SIGN.OFF.DELAY$,    \ 1 byte PD counter to auto sign off    \  !CSWM
4428: 0000:         TSF.USER$,              \ User data
4429: 0000:         TSF.CONTROLLER$,        \ Controller ID
4430: 0000:         TSF.INVDUE.DATE$,       \ Creation date of the INVDUE
4431: 0000:                                 \ (Updated by PSS33)                    \   !GJT
4432: 0000:         TSF.SPACE$              ! 34 bytes or 14 bytes
4433: 0000: 
4434: 0000:     INTEGER*1 GLOBAL            \
4435: 0000:         TSF.INDICAT0%,          \ Indicator byte 0
4436: 0000:         TSF.INDICAT1%,          \ Indicator byte 1
4437: 0000: \       TSF.INDICAT2%,          \ Indicator byte 2                      \   !HMW
4438: 0000:         TSF.MTSL.CUT.OFF%,      \ MTSL cut-off required flag            \  !CSWM
4439: 0000:         TSF.CUSTD.CUT.OFF%,     \ CUSTD cut-off required flag           \  !CSWM
4440: 0000:         TSF.ACSAL.CUT.OFF%,     \ ACSAL cut-off required flag               !DRD
4441: 0000:         TSF.TILLBAG.CUT.OFF%    ! TILLBAG cut-off required flag             !EAH
4442: 0000:     
4443: 0000:     INTEGER*2 GLOBAL            \
4444: 0000: \       TSF.SC.LEVEL%           ! Smartcard software level              \   !HMW
4445: 0000:         TSF.INDICAT2%           ! Indicator flags 2                         !HMW
4446: 0000: 
4447: 0000:     INTEGER*4 GLOBAL            \
4448: 0000:         TSF.GROSSPOS,           \ Gross plus
4449: 0000:         TSF.GROSSNEG,           \ Gross minus
4450: 0000:         TSF.NETCASH,            \ Net cash
4451: 0000:         TSF.NETNCASH,           \ Net non-cash
4452: 0000:         TSF.AMTLOAN,            \ Loans
4453: 0000:         TSF.AMTPICKU,           \ Withdrawals
4454: 0000:         TSF.AMTCASHC,           \ Cash count
4455: 0000:         TSF.NETCCURR,           \ Net cash currency face value
4456: 0000:         TSF.NETCCCURR           ! Net cash count currency face value
4457: 0000: 
4458: 0000:  %INCLUDE LOCALDEC.J86                    ! 2.1JAS
4459: 0000: \***********************************************************************
4460: 0000: \***********************************************************************
4461: 0000: \***
4462: 0000: \***    DESCRIPTION: Local Price File
4463: 0000: \***                 Field Definitions
4464: 0000: \***
4465: 0000: \***    FILE TYPE : Keyed
4466: 0000: \***
4467: 0000: \***********************************************************************
4468: 0000: \***
4469: 0000: \***    Version A.          Paul Flanagan                1st Jul 1993
4470: 0000: \***    Initial version.
4471: 0000: \***
4472: 0000: \***    Version B.          Clive Norris                24th Nov 1993
4473: 0000: \***    AUTH.NUM$, STOCK.FIG$ and RETRIEVAL.FLAG$ replaced filler as
4474: 0000: \***    part of the RETURNS/AUTOMATIC CREDIT CLAIMING package.
4475: 0000: \***
4476: 0000: \***    Version C.          Mick Bayliss                 6th Dec 1994
4477: 0000: \***    Added missing field.
4478: 0000: \***
4479: 0000: \***    Version D.          Mark Walker                  1st Jul 2015
4480: 0000: \***    F392 Retail Stock 5
4481: 0000: \***    Added key length field.
4482: 0000: \***
4483: 0000: \***********************************************************************
4484: 0000: \***********************************************************************
4485: 0000: 
4486: 0000:     STRING GLOBAL             \
4487: 0000:         LOCAL.AUTH.NUM$,      \ 4 bytes UPD Auth'n number
4488: 0000:                               \             from Business Centre.
4489: 0000:         LOCAL.END.DATE$,      \ 3 bytes UPD yymmdd.
4490: 0000:         LOCAL.FILE.NAME$,     \
4491: 0000:         LOCAL.H.O.PRICE$,     \ 5 byte UPD.
4492: 0000:         LOCAL.HO.CHANGE$,     \ 3 bytes UPD. Date of HO price change
4493: 0000:                               \ (this will be zero if no change since
4494: 0000:                               \ local price was initiated).
4495: 0000:         LOCAL.ITEM.CODE$,     \ 4 bytes UPD (key) Boots code 
4496: 0000:                               \                   with check digit. 
4497: 0000:         LOCAL.OPERATOR$,      \ 4 bytes UPD operator id (when set up).
4498: 0000:         LOCAL.PRICE$,         \ 5 bytes UPD.
4499: 0000:         LOCAL.REASON$,        \ 4 byte ASCII 
4500: 0000:         LOCAL.RETRIEVAL.FLAG$,\ 1 byte ASC "Y" or "N"  
4501: 0000:         LOCAL.SPACE$,         \                                            !CMJB
4502: 0000:         LOCAL.START.DATE$,    \ 3 bytes UPD yymmdd. 
4503: 0000:         LOCAL.START.TIME$     ! 2 bytes UPD hhmm.
4504: 0000:         
4505: 0000:     INTEGER*2 GLOBAL          \
4506: 0000:         LOCAL.KEYL%,          \                                             !DMW
4507: 0000:         LOCAL.RECL%,          \
4508: 0000:         LOCAL.REPORT.NUM%,    \
4509: 0000:         LOCAL.SESS.NUM%,      \
4510: 0000:         LOCAL.STOCK.FIG%      !  No. of items authorised at the price.
4511: 0000: 
4512: 0000:  %INCLUDE CCREJDEC.J86                    ! 1.2JAS
4513: 0000: REM \
4514: 0000: \******************************************************************************
4515: 0000: \******************************************************************************
4516: 0000: \***
4517: 0000: \***      %INCLUDE FOR CREDIT CLAIMING REJECT FILE FIELD DECLARATIONS
4518: 0000: \***                                          FILE REFERENCE PARAMETERS
4519: 0000: \***
4520: 0000: \***               FILE TYPE    : Sequential
4521: 0000: \***
4522: 0000: \***               REFERENCE    : CCREJDEC.J86
4523: 0000: \***
4524: 0000: \***      Version A.     Julia Stones           11th March 2004.
4525: 0000: \***
4526: 0000: \******************************************************************************
4527: 0000: \*******************************************************************************
4528: 0000: \***
4529: 0000: \***
4530: 0000: \***
4531: 0000: \******************************************************************************
4532: 0000: 
4533: 0000:   STRING GLOBAL              \
4534: 0000:     CCREJ.FILE.NAME$,        \
4535: 0000:     CCREJC.FILE.NAME$,       \
4536: 0000:     CCREJP.FILE.NAME$,       \
4537: 0000:     CCREJ.RECORD$,           \ Used to store the whole record which is unstrung
4538: 0000:                              \ into the fields below
4539: 0000:     CCREJ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
4540: 0000:     CCREJ.DATE$,             \ 8 byte ASCII
4541: 0000:     CCREJ.RETURN.REASON$,    \ 2 byte ASCII
4542: 0000:     CCREJ.BC.LETTER$,        \ 1 byte ASCII
4543: 0000:     CCREJ.UOD.NUM$,          \ 14 byte ASCII
4544: 0000:     CCREJ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
4545: 0000:               \                             "B" = Barcode.
4546: 0000:     CCREJ.ITEM.BARCODE$,     \ 12 byte ASCII
4547: 0000:     CCREJ.DESC$,             \ 24 byte ASCII
4548: 0000:     CCREJ.ITEM.BC$,          \ 1 byte ASCII
4549: 0000:     CCREJ.ITEM.QTY$,         \ 4 byte ASCII
4550: 0000:     CCREJ.REJECT.REASON$     ! 1 byte ASCII "1" = Item not on file
4551: 0000:                              !              "2" = Credit Claim not allowed against this
4552: 0000:                              !                    Business Centre
4553: 0000:                              !              "3" = Item does not belong to Business Centre
4554: 0000:                              !                    being claimed against
4555: 0000: 
4556: 0000: 
4557: 0000:   INTEGER*2 GLOBAL           \
4558: 0000:     CCREJ.RECL%,             \
4559: 0000:     CCREJC.RECL%,            \
4560: 0000:     CCREJP.RECL%,            \
4561: 0000:     CCREJC.SESS.NUM%,        \
4562: 0000:     CCREJP.SESS.NUM%,        \
4563: 0000:     CCREJ.SESS.NUM%,         \
4564: 0000:     CCREJC.REPORT.NUM%,      \
4565: 0000:     CCREJP.REPORT.NUM%,      \
4566: 0000:     CCREJ.REPORT.NUM%
4567: 0000: 
4568: 0000: 
4569: 0000:  %INCLUDE RBDEC.J86                       ! 2.6BG
4570: 0000: \/******************************************************************/
4571: 0000: \/*                                                                */
4572: 0000: \/* Recalls Buffer FILE GLOBAL VARIABLE DECLARATIONS               */
4573: 0000: \/*                                                                */
4574: 0000: \/* REFERENCE   : RBDEC.J86                                        */
4575: 0000: \/*                                                                */
4576: 0000: \/* VERSION A.          Brian Greenfield        11th may 2007      */
4577: 0000: \/*                                                                */
4578: 0000: \/******************************************************************/
4579: 0000: 
4580: 0000:    STRING GLOBAL                \
4581: 0000:       RB.FILE.NAME$,            \
4582: 0000:                                 \
4583: 0000:       RB.RCD$,                  \  ? bytes  (25/14/12)
4584: 0000:       RB.REC.TYPE$,             \  1 byte   (H/D/T)
4585: 0000:       RB.REFERENCE$,            \  8 bytes
4586: 0000:       RB.LABEL$,                \ 14 bytes (8 bytes label type)
4587: 0000:                                 \          (6 bytes label number)
4588: 0000:       RB.ITEM.CODE$,            \  7 bytes (with check digit)
4589: 0000:       RB.STOCK.COUNT$,          \  4 bytes (1 - 9999)
4590: 0000:       RB.ITEM.COUNT$,           \  5 bytes (1 - 99999)
4591: 0000:       RB.RECORD.COUNT$          !  4 bytes (1 - 9999 inc header and trailer)
4592: 0000: 
4593: 0000:    INTEGER*2 GLOBAL             \
4594: 0000:       RB.REPORT.NUM%,           \
4595: 0000:       RB.SESS.NUM%              !
4596: 0000: 
4597: 0000: \/******************************************************************/
4598: 0000:  %INCLUDE REWKFDEC.J86                    ! 2.6BG
4599: 0000: \/******************************************************************/
4600: 0000: \/*                                                                */
4601: 0000: \/* Recalls Work FILE GLOBAL VARIABLE DECLARATIONS                 */
4602: 0000: \/*                                                                */
4603: 0000: \/* REFERENCE   : REWKFDEC.J86                                     */
4604: 0000: \/*                                                                */
4605: 0000: \/* VERSION A.          Brian Greenfield        11th may 2007      */
4606: 0000: \/*                                                                */
4607: 0000: \/* VERSION B.          Brian Greenfield        15th April 2008    */
4608: 0000: \/*                                                                */
4609: 0000: \/* VERSION C.          Brian Greenfield        6th May 2008       */
4610: 0000: \/*                                                                */
4611: 0000: \/******************************************************************/
4612: 0000: 
4613: 0000:    STRING GLOBAL                \
4614: 0000:       REWKF.FILE.NAME$,         \
4615: 0000:                                 \
4616: 0000:       REWKF.RCD$,               \  ? bytes  (25/47/8)
4617: 0000:       REWKF.REC.TYPE$,          \  1 byte   (H/D/T)
4618: 0000:       REWKF.REFERENCE$,         \  8 bytes
4619: 0000:       REWKF.LABEL$,             \ 14 bytes (8 bytes label type)
4620: 0000:                                 \          (6 bytes label number - zero's)
4621: 0000:       REWKF.BATCH.TYPE$,        \  1 byte  (E/F/R/S/W/X/I/C) !BBG
4622: 0000:       REWKF.MRQ$,               \  2 bytes ASCII !CBG
4623: 0000:       REWKF.DUE.BY.DATE$,       \  8 bytes (YYYYMMDD) !BBG
4624: 0000:       REWKF.BARCODE$,           \ 13 bytes (with check digit)
4625: 0000:       REWKF.ITEM.CODE$,         \  7 bytes (with check digit)
4626: 0000:       REWKF.DESCRIPTION$,       \ 20 bytes (truncated from the IDF)
4627: 0000:       REWKF.TSF$,               \  4 bytes (1 - 9999 or SPACES for recall types F, S, & X)
4628: 0000:       REWKF.ITEM.COUNT$         !  5 bytes (1 - 99999)
4629: 0000:       
4630: 0000:    INTEGER*2 GLOBAL             \
4631: 0000:       REWKF.REPORT.NUM%,        \
4632: 0000:       REWKF.SESS.NUM%           !
4633: 0000: 
4634: 0000: \/******************************************************************/
4635: 0000:  %INCLUDE RECALDEC.J86                    ! 2.6BG
4636: 0000: \******************************************************************************
4637: 0000: \******************************************************************************
4638: 0000: \***
4639: 0000: \***         INCLUDE FOR RECALLS.BIN DECLARATIONS
4640: 0000: \***
4641: 0000: \***               FILE TYPE    : Keyed
4642: 0000: \***
4643: 0000: \***               REFERENCE    : RECALDEC.J86
4644: 0000: \***
4645: 0000: \***    VERSION A               BRIAN GREENFIELD                    14th May 2007
4646: 0000: \***    Initial Version
4647: 0000: \***
4648: 0000: \***    Version B               BRIAN GREENFIELD                    20th June 2007
4649: 0000: \***    Altered due to a change in the file layout.
4650: 0000: \***
4651: 0000: \*******************************************************************************
4652: 0000: \*******************************************************************************
4653: 0000: 
4654: 0000:   STRING GLOBAL                \
4655: 0000:     RECALLS.FILE.NAME$,        \
4656: 0000:                                \
4657: 0000:     RECALLS.REFERENCE$,        \ 8 bytes UPD  - Key is reference + RECALLS.CHAIN%
4658: 0000:     RECALLS.TYPE$,             \ 1 byte  ASC  - E = Emergency
4659: 0000:                                \                F = Batch Emergency
4660: 0000:                                \                G = generic items not authorised for sale
4661: 0000:                                \                R = 100% Returns
4662: 0000:                                \                S = Batch 100% Returns
4663: 0000:                                \                W = Withdrawn
4664: 0000:                                \                X = batch Withdrawn
4665: 0000:     RECALLS.DESCRIPTION$,      \ 20 bytes ASC
4666: 0000:     RECALLS.LABEL.TYPE$,       \ 8 bytes ASC
4667: 0000:     RECALLS.SUPPLY.ROUTE$,     \ 1 byte ASC
4668: 0000:     RECALLS.REASON.CODE$,      \ 1 byte ASC
4669: 0000:     RECALLS.BC$,               \ 1 byte ASC
4670: 0000:     RECALLS.ACTIVE.DATE$,      \ 8 bytes ASC  - YYYYMMDD
4671: 0000:     RECALLS.DUE.BY.DATE$,      \ 8 bytes ASC  - YYYYMMDD
4672: 0000:     RECALLS.COMPLETION.DATE$,  \ 8 bytes ASC  - YYYYMMDD
4673: 0000:     RECALLS.STATUS$,           \ 1 byte ASC   - N = Not Actioned, A = Actioned, P = Partially Actioned
4674: 0000:     RECALLS.BATCH.NUM$,        \ 30 bytes ASC
4675: 0000:     RECALLS.ITEM.COUNT$,       \ 4 bytes ASC  - Total count of items in this recall
4676: 0000:                                \
4677: 0000:                                \ The following 8 bytes are repeated for the number of items in this part
4678: 0000:                                \ of the recall chain - up to 50 items per chain.
4679: 0000:     RECALLS.ITEM.CODE$(1),     \ 4 bytes PD   - 6 digit Item Code
4680: 0000:     RECALLS.ITEM.STOCK$(1),    \ 2 bytes PD   - SPACES if not yet actioned                         !BBG
4681: 0000:     RECALLS.SESS.STOCK$(1),    \ 2 bytes PD   - 4 digit session stock count - used only by the PPC !BBG
4682: 0000:     RECALLS.ITEM.UPT.FLAG$(1), \ 1 byte ASC   - used by the PPC only - Y = actioned, N - reset, space = unactioned
4683: 0000:                                \
4684: 0000:     RECALLS.FILLER$            !
4685: 0000:     
4686: 0000:   INTEGER*1 GLOBAL             \
4687: 0000:     RECALLS.CHAIN%
4688: 0000:     
4689: 0000:   INTEGER*2 GLOBAL             \
4690: 0000:     RECALLS.RECL%,             \
4691: 0000:     RECALLS.KEYL%,             \
4692: 0000:     RECALLS.REPORT.NUM%,       \
4693: 0000:     RECALLS.SESS.NUM%,         \
4694: 0000:     RECALLS.MAX.REC.ITEMS%
4695: 0000: 
4696: 0000: 
4697: 0000:  %INCLUDE DELVIDEC.J86                    ! 2.7SH
4698: 0000: \/******************************************************************/
4699: 0000: \/*                                                                */
4700: 0000: \/* DELVINDX FILE GLOBAl VARIABLE DECLARATIONS                     */
4701: 0000: \/*                                                                */
4702: 0000: \/* REFERENCE   : DELVIDEC.J86                                     */
4703: 0000: \/*                                                                */
4704: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
4705: 0000: \/*                                                                */
4706: 0000: \/* VERSION B.          Stuart Highley               18 Dec 2008   */
4707: 0000: \/* Make file fixed rec length.                                    */
4708: 0000: \/******************************************************************/
4709: 0000: 
4710: 0000:    STRING GLOBAL                    \
4711: 0000:       DELVINDX.FILE.NAME$,          \
4712: 0000:       DELVINDX.FILLER$,             \
4713: 0000:       DELVINDX.ASN.NUM$,            \
4714: 0000:       DELVINDX.ASN.CARTON.COUNT$,   \
4715: 0000:       DELVINDX.UOD.LICENCE$,        \
4716: 0000:       DELVINDX.UOD.DESPATCH.DATE$,  \
4717: 0000:       DELVINDX.UOD.BOL.FLAG$,       \
4718: 0000:       DELVINDX.UOD.SEQ$,            \
4719: 0000:       DELVINDX.UOD.PARENT$,         \
4720: 0000:       DELVINDX.UOD.TYPE$,           \
4721: 0000:       DELVINDX.UOD.EXP.DEL.DATE$
4722: 0000: 
4723: 0000:    INTEGER*2 GLOBAL             \
4724: 0000:       DELVINDX.REPORT.NUM%,     \
4725: 0000:       DELVINDX.SESS.NUM%
4726: 0000: 
4727: 0000: \/******************************************************************/
4728: 0000:  %INCLUDE UODOTDEC.J86                    ! 2.7SH
4729: 0000: \*******************************************************************************
4730: 0000: \***
4731: 0000: \***    UOD Outers FILE GLOBAl VARIABLE DECLARATIONS
4732: 0000: \***
4733: 0000: \***    REFERENCE   : UODOTDEC.J86
4734: 0000: \***
4735: 0000: \***    VERSION A.              Stuart Highley                  14th Jul 2008
4736: 0000: \***
4737: 0000: \***    VERSION B.              Mark Goode                      10th Dec 2008
4738: 0000: \***    Add summary record read/write functionality.
4739: 0000: \***
4740: 0000: \***    REVISION 1.8.           Robert Cowey                    14th Jan 2009
4741: 0000: \***    Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
4742: 0000: \***    No new variables but defined new function UODOT.REC$.
4743: 0000: \***
4744: 0000: \***    VERSION C.              Mark Walker                     18th Feb 2015
4745: 0000: \***    F391 HUMSS UOD Messaging
4746: 0000: \***    Includes the following changes:
4747: 0000: \***    - Defined UOD number field.
4748: 0000: \***    - Various coding standards related changes (uncommented).
4749: 0000: \***
4750: 0000: \*******************************************************************************
4751: 0000: 
4752: 0000:     STRING GLOBAL                                                       \
4753: 0000:         UODOT.AUDIT.OP.ID$,                                             \
4754: 0000:         UODOT.BOOKED.DATE$,                                             \
4755: 0000:         UODOT.BOOKED.TIME$,                                             \
4756: 0000:         UODOT.CHILD.LICENCE$(1),                                        \
4757: 0000:         UODOT.CHILD.TYPE$(1),                                           \
4758: 0000:         UODOT.DESPATCH.DATE$,                                           \
4759: 0000:         UODOT.DRVR.DEL.DATE$,                                           \
4760: 0000:         UODOT.DRVR.DEL.TIME$,                                           \
4761: 0000:         UODOT.DRVR.ID$,                                                 \
4762: 0000:         UODOT.EST.DEL.DATE$,                                            \
4763: 0000:         UODOT.FILE.NAME$,                                               \
4764: 0000:         UODOT.FILLER$,                                                  \
4765: 0000:         UODOT.IMMEDIATE.PARENT$,                                        \
4766: 0000:         UODOT.LEVEL$,                                                   \
4767: 0000:         UODOT.LICENCE$,                                                 \
4768: 0000:         UODOT.OPEN.FLAG$,                                               \
4769: 0000:         UODOT.REASON$,                                                  \
4770: 0000:         UODOT.STATUS$,                                                  \
4771: 0000:         UODOT.STORE.OP.ID$,                                             \
4772: 0000:         UODOT.SUMMARY.STATUS$,                                          \   !BMG
4773: 0000:         UODOT.TYPE$,                                                    \
4774: 0000:         UODOT.ULTIMATE.PARENT$,                                         \
4775: 0000:         UODOT.UOD.NUMBER$,                                              \   !CMW
4776: 0000:         UODOT.WAREHOUSE.AREA$
4777: 0000: 
4778: 0000:     INTEGER*1 GLOBAL                                                    \
4779: 0000:         UODOT.BOL,                                                      \
4780: 0000:         UODOT.SDPD
4781: 0000: 
4782: 0000:     INTEGER*2 GLOBAL                                                    \
4783: 0000:         UODOT.AUDITED,                                                  \
4784: 0000:         UODOT.AUTO,                                                     \
4785: 0000:         UODOT.BOOKED,                                                   \
4786: 0000:         UODOT.CONTROLLER,                                               \
4787: 0000:         UODOT.GIT.MISMATCH,                                             \
4788: 0000:         UODOT.KEYL%,                                                    \
4789: 0000:         UODOT.MAX.CHILDREN%,                                            \
4790: 0000:         UODOT.MC70,                                                     \
4791: 0000:         UODOT.NUM.CHILDREN%,                                            \
4792: 0000:         UODOT.NUM.ITEMS%,                                               \
4793: 0000:         UODOT.PARTIAL,                                                  \
4794: 0000:         UODOT.PDT,                                                      \
4795: 0000:         UODOT.RECL%,                                                    \
4796: 0000:         UODOT.REPORT.NUM%,                                              \
4797: 0000:         UODOT.RF,                                                       \
4798: 0000:         UODOT.SEQ%,                                                     \
4799: 0000:         UODOT.SESS.NUM%,                                                \
4800: 0000:         UODOT.STOCK.UPDATED
4801: 0000: 
4802: 0000:  %INCLUDE AFDEC.J86                       ! 2.7SH
4803: 0000: 
4804: 0000: \REM
4805: 0000: \*******************************************************************************
4806: 0000: \*******************************************************************************
4807: 0000: \***
4808: 0000: \***    %INCLUDE FOR GSA AUTHORISATION FILE VARIABLE DECLARATIONS
4809: 0000: \***
4810: 0000: \***        REFERENCE   :  AFDEC (J86)
4811: 0000: \***
4812: 0000: \***        FILE TYPE   :  Keyed
4813: 0000: \***
4814: 0000: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
4815: 0000: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
4816: 0000: \***
4817: 0000: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
4818: 0000: \***    Original version created by merging AFFLDD and AFNUMD.
4819: 0000: \***
4820: 0000: \***    VERSION B.              Steve Windsor                          Nov 1992.
4821: 0000: \***    Addition of new fields for the CASTLE project.
4822: 0000: \***    Supervisor flag and operator model.
4823: 0000: \***
4824: 0000: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
4825: 0000: \***    Defined fields DATE.PSWD.CHANGE$, and MODEL.FLAGS.1% and ...2%.
4826: 0000: \***
4827: 0000: \***    VERSION D.             Mike Bishop                          30 JUN 2004
4828: 0000: \***    Defined field AF.STAFF.NUM$ AF.EMPLOYEE.FLAG$
4829: 0000: \***
4830: 0000: \***    VERSION E.             Alan Carr  (AJC)                      4 Oct 2004
4831: 0000: \***    Defined field AF.RECEIPT.NAME$
4832: 0000: \***
4833: 0000: \***    VERSION F.             Alan Carr  (AJC)                     31 Jan 2005
4834: 0000: \***    Defined field AF.GROUP.CODE$
4835: 0000: \***
4836: 0000: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
4837: 0000: \***    Changes for A9C POS improvements project.
4838: 0000: \***    Used up last available three bytes of EALAUTH user data by redefining 
4839: 0000: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
4840: 0000: \***    See IBM manual "GSA Programming Guide" Appendix A-27 for file layout 
4841: 0000: \***    describing INDICAT flags (and position of original 20 bytes user data).
4842: 0000: \***
4843: 0000: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
4844: 0000: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
4845: 0000: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format as UPD-hex DDMCYY.
4846: 0000: \***    Description text change only - No code changes to this file.
4847: 0000: \***
4848: 0000: \*******************************************************************************
4849: 0000: \*******************************************************************************
4850: 0000: 
4851: 0000: 
4852: 0000:     STRING GLOBAL \
4853: 0000:         AF.BIRTH.DATE$,       \ ! 3 byte DDMCYY UPD/hex format         ! 1.7 RC
4854: 0000:                               \ ! M is month  A=Oct B=Nov C=Dec        ! 1.7 RC
4855: 0000:                               \ ! C is century  0=19xx 1=20xx          ! 1.7 RC
4856: 0000:         AF.DATE.PSWD.CHANGE$, \ ! 3 bytes UPD                          ! CRC
4857: 0000:         AF.FILE.NAME$, \
4858: 0000:         AF.FLAGS.01.12$, \      ! 15 bytes
4859: 0000:         AF.FLAGS.13.16$, \      ! 4 bytes
4860: 0000:         AF.OPERATOR.NAME$,\     ! 20 bytes
4861: 0000:         AF.OPERATOR.NO$, \      ! 4 byte UPD (key)
4862: 0000:         AF.OPTIONS.KEY$, \      ! 1 byte UPD
4863: 0000:         AF.PASSWORD$, \         ! 4 byte UPD
4864: 0000:         AF.RECEIPT.NAME$, \     ! 12 bytes                             ! AJC
4865: 0000:         AF.STAFF.NUM$, \         ! 4 byte UPD                          DMB
4866: 0000:         AF.EMPLOYEE.FLAG$, \     ! 1 byte UPD                          DMB
4867: 0000:         AF.GROUP.CODE$, \       ! 1  byte UPD                          AJC
4868: 0000: \       AF.USER$, \             ! 3  bytes                             ! 1.6 RC
4869: 0000:         AF.SUP.FLAG$, \         ! 1  byte                              BSJW
4870: 0000:         AF.OP.MODEL$            ! 3  bytes                             BSJW
4871: 0000: 
4872: 0000:     INTEGER*1 GLOBAL \
4873: 0000:         AF.INDICAT4%, \
4874: 0000:         AF.INDICAT5%, \
4875: 0000:         AF.INDICAT6%, \
4876: 0000:         AF.INDICAT7%, \
4877: 0000:         AF.INDICAT8%, \
4878: 0000:         AF.INDICAT9%, \
4879: 0000:         AF.INDICAT10%, \
4880: 0000:         AF.INDICAT11%, \
4881: 0000:         AF.INDICAT12%, \
4882: 0000:         AF.INDICAT13%, \
4883: 0000:         AF.INDICAT14%, \
4884: 0000:         AF.INDICAT15%, \
4885: 0000:         AF.INDICAT16%, \
4886: 0000:         AF.REPORT.NUM%
4887: 0000: 
4888: 0000:     INTEGER*2 GLOBAL \
4889: 0000:         AF.INDICAT1%, \
4890: 0000:         AF.INDICAT2%, \
4891: 0000:         AF.INDICAT3%, \
4892: 0000:         AF.MODEL.FLAGS.1%, \                                           ! CRC
4893: 0000:         AF.MODEL.FLAGS.2%, \                                           ! CRC
4894: 0000:         AF.RECL%, \
4895: 0000:         AF.SESS.NUM%
4896: 0000: 
4897: 0000:  %INCLUDE UBDEC.J86                       ! 2.7SH
4898: 0000: \/******************************************************************/
4899: 0000: \/*                                                                */
4900: 0000: \/* UOD Banked FILE GLOBAL VARIABLE DECLARATIONS                   */
4901: 0000: \/*                                                                */
4902: 0000: \/* REFERENCE   : UBDEC.J86                                        */
4903: 0000: \/*                                                                */
4904: 0000: \/* VERSION A.          Stuart Highley            14 August 2008   */
4905: 0000: \/                                                                 */
4906: 0000: \/* VERSION B.          Charles Skadorwa          9 October 2008   */
4907: 0000: \/*                                                                */
4908: 0000: \/* VERSION C.          Stuart Highley            16 December 2008 */
4909: 0000: \/* Look carefully below and ye shall find my change.              */
4910: 0000: \/*                                                                */
4911: 0000: \/* VERSION D.          Mark Goode                22nd December 08 */
4912: 0000: \/* Changes to the fields on the audit record                      */
4913: 0000: \/******************************************************************/
4914: 0000: 
4915: 0000:    STRING GLOBAL                \
4916: 0000:       UB.TEMP.NAME$,            \
4917: 0000:       UB.FILE.NAME$,            \
4918: 0000:       UB.REC$,                  \
4919: 0000:       UB.REC.TYPE$,             \
4920: 0000:       UB.OP.ID$,                \
4921: 0000:       UB.METHOD$,               \
4922: 0000:       UB.REPORT.RQD$,           \
4923: 0000:       UB.LICENCE$,              \
4924: 0000:       UB.DESPATCH.DATE$,        \
4925: 0000:       UB.BOOKED.DATE$,          \
4926: 0000:       UB.BOOKED.TIME$,          \
4927: 0000:       UB.BOOK.TYPE$,            \
4928: 0000:       UB.BAR.CODE$,             \
4929: 0000:       UB.QTY$,                  \
4930: 0000:       UB.DRVR.ID$,              \
4931: 0000:       UB.DRVR.CHCK.DATE$,       \
4932: 0000:       UB.DRVR.CHCK.TIME$,       \
4933: 0000:       UB.DRVR.GIT.MATCH$,       \
4934: 0000:       UB.REC.COUNT$,            \
4935: 0000:       UB.ONIGHT.DELIVERY.TYPE$, \                                !BCSk
4936: 0000:       UB.DRIVER.CHECKIN.REQD$,  \                                !BCSk
4937: 0000:       UB.DRVR.REJECTED$,        \ "Y" or "N" on batch rec,       !CSH
4938: 0000:                                 \ " " on session rec             !CSH
4939: 0000:       UB.DRVR.CONFIRM.SCAN$,    \                                !BCSk
4940: 0000:       UB.BOOKED.STATUS$                                          !DMG
4941: 0000:       
4942: 0000:    INTEGER*2 GLOBAL             \
4943: 0000:       UB.RECL%,                 \
4944: 0000:       UB.REPORT.NUM%,           \
4945: 0000:       UB.SESS.NUM%
4946: 0000: 
4947: 0000: \/******************************************************************/
4948: 0000:  
4949: 0000: \*****************************************************************************
4950: 0000: \*****************************************************************************
4951: 0000: \***                                                                       ***
4952: 0000: \***      V A R I A B L E   D E C L A R A T I O N S                        ***
4953: 0000: \***                                                                       ***
4954: 0000: \*****************************************************************************
4955: 0000: \*****************************************************************************
4956: 0000: 
4957: 0000: INTEGER*1 GLOBAL                          \
4958: 0000:         ASN.ACTIVE%,                      \ 2.5NWB
4959: 0000:         BC.CHECK%(1),                     \ FLC
4960: 0000:         ERROR.COUNT%,                     \
4961: 0000:         REC.MAX%,                         \
4962: 0000:         LDT.TRANSMIT,                     \ HDS
4963: 0000:         NESTING.LEVEL%,                   \ FLC
4964: 0000:         TRUE,                             \ HDS
4965: 0000:         FALSE,                            \ HDS
4966: 0000:         PORT.EVENT%,                      \ FLC
4967: 0000:         RE.CHAIN,                         \ DSW
4968: 0000:         WARM.START,                       \ DSW
4969: 0000:         GAP,                              \ GMJK
4970: 0000:         CCBUF.ENTRY.REQUIRED,             \ GMJK
4971: 0000:         CCBUF.RECS.PRESENT,               \ GMJK
4972: 0000:         CCREJ.RECS.PRESENT,               \ 2.2JAS
4973: 0000:         DETAIL.RECORDS.RECEIVED,          \ GMJK
4974: 0000:         END.OF.CCTMP,                     \ GMJK
4975: 0000:         END.OF.FILE,                      \ GMJK
4976: 0000:         TABLE.FULL,                       \ GMJK
4977: 0000:         REWKF.RECS.PRESENT,               \ 2.6BG
4978: 0000:         ALL.PRODUCTS                      ! 1.8DA
4979: 0000: \       ALLOW.CSR.PROCESSING              ! 1.2 !2.5NWB
4980: 0000: 
4981: 0000: INTEGER*2 GLOBAL                          \
4982: 0000:         ACTUAL.NUM.OF.UODS%,              \ FLC
4983: 0000:         BTSCNT%,                          \2.3CS
4984: 0000:         EANCNT%,                          \2.3CS
4985: 0000:         COUNTED.ITEMS%,                   \ FLC
4986: 0000: \       CSR.ITEMS.COUNT%,                 \     !2.5NWB
4987: 0000:         CSR.AUDIT.SESS.NUM%,              \ CDS
4988: 0000:         CURRENT.REPORT.NUM%,              \ DLC
4989: 0000:         EXPECTED.NUM.OF.UODS%,            \ FLC
4990: 0000:         FILE.HEADER.LISTS%,               \ FLC
4991: 0000:         FILE.TRAILER.LISTS%,              \ FLC
4992: 0000:         FIRST.TIME,                       \ CDS
4993: 0000:         ORDERS.EXPECTED%,                 \ CDS
4994: 0000:         INT.DELAY%,                       \ FLC
4995: 0000:         ITEMS.BOOKED.IN%,                 \ CDS
4996: 0000:         ITEM.COUNT%,                      \ FLC
4997: 0000:         LINES.BOOKED.IN%,                 \ CDS
4998: 0000:         LINES.ADDED%,                     \ CDS
4999: 0000:         LINE.TOTAL%,                      \ CDS
5000: 0000:         LIST.COUNT%,                      \ FLC
5001: 0000:         LIST.TRAILER.ITEMS%,              \ FLC
5002: 0000:         ONORD.COUNT%,                     \
5003: 0000:         ORDERS.FOUND%,                    \ CDS
5004: 0000:         RC%,                              \ DLC
5005: 0000:         SINGLES.ADDED%,                   \ CDS
5006: 0000:         TYPE.17.WRITTEN,                  \ CDS
5007: 0000:         UOD.NUM.ITEMS%,                   \ FLC
5008: 0000:         ACTUAL.NUM%,                      \ GMJK
5009: 0000:         ACTUAL.UOD.ITEMS%,                \ GMJK
5010: 0000:         CURR.ITEM%,                       \ GMJK
5011: 0000:         CURR.REC%,                        \ GMJK
5012: 0000:         CURR.SUBSCRIPT%,                  \ GMJK
5013: 0000:         EXPECTED.NUM%,                    \ GMJK
5014: 0000:         FILE.NUM%,                        \ GMJK
5015: 0000:         ITEM.POS%,                        \ GMJK
5016: 0000:         MAX.TABLE.SIZE%,                  \ GMJK
5017: 0000:         NUM.BARCODES%,                    \ GMJK
5018: 0000:         NUM.BC.EXTRACTED%,                \ GMJK
5019: 0000:         NUM.ITEMS%,                       \ GMJK
5020: 0000:         NUM.STATUS.O.C.X.UODS%,           \ 1.4
5021: 0000:         NUM.OF.CANCELLED.UODS%,           \ 1.4
5022: 0000:         NUM.OF.DESPATCHED.UODS%,          \ 1.4
5023: 0000:         NUM.RECORDS%,                     \ GMJK
5024: 0000:         RECORD$,                          \ GMJK
5025: 0000:         REC.NUM%,                         \ GMJK
5026: 0000:         RECS.PER.SECTOR%,                 \ GMJK
5027: 0000:         BC%,CG%,PG%,                      \ 1.8DA
5028: 0000:         SECTOR%                           ! GMJK
5029: 0000: 
5030: 0000: INTEGER*4 GLOBAL                          \
5031: 0000:         LAST.ACTIVE%,                     \
5032: 0000:         LAST.STOCKTAKE%,                  \ 1.5
5033: 0000:         TIMEOUT.VALUE%                    ! FLC
5034: 0000: 
5035: 0000: 
5036: 0000: STRING GLOBAL                             \ for modules 00, 01 , 02 , 03 and 04
5037: 0000:         ACK$,                             \ 1.5
5038: 0000:         ALL.FILES.CLOSED$,                \
5039: 0000:         APPL$,                            \ FLC
5040: 0000:         APPLICATION.NO$,                  \
5041: 0000:         BAR.CODES$(1),                    \ FLC
5042: 0000:         BCSMF.RECORD$,                    \ GMJK
5043: 0000:         BOOKING.STARTED$,                 \ CDS
5044: 0000:         BOOKING.ENDED$,                   \ CDS
5045: 0000:         CCUOD.OPEN.FLAG$,                 \ GMJK
5046: 0000:         CCLAM.OPEN.FLAG$,                 \ 1.4
5047: 0000:         CCITM.OPEN.FLAG$,                 \ GMJK
5048: 0000:         CCTRL.OPEN.FLAG$,                 \ GMJK
5049: 0000:         CCDMY.OPEN.FLAG$,                 \ GMJK
5050: 0000:         CCTMP.OPEN.FLAG$,                 \ GMJK
5051: 0000:         CCBUF.OPEN.FLAG$,                 \ GMJK
5052: 0000:         CCUPF.OPEN.FLAG$,                 \ HMJK
5053: 0000:         CCWKF.OPEN.FLAG$,                 \ GMJK
5054: 0000:         STKRC.OPEN.FLAG$,                 \ 1.8DA
5055: 0000:         XGCF.OPEN.FLAG$,                  \ 1.8DA
5056: 0000:         STKEX.OPEN.FLAG$,                 \ 1.8DA
5057: 0000:         STKIF.OPEN.FLAG$,                 \ 1.8DA
5058: 0000:         LOCCNT.OPEN.FLAG$,                \ 1.8DA
5059: 0000:         STKTF.OPEN.FLAG$,                 \ 1.8DA
5060: 0000:         STKDC.OPEN.FLAG$,                 \ 1.8DA
5061: 0000: \       CSR.LIST.ALREADY.PROCESSED.FLAG$, \ !2.5NWB
5062: 0000: \       CSR.OPEN.FLAG$,                   \ !2.5NWB
5063: 0000:         CHKBF.OPEN.FLAG$,                 \ DSW
5064: 0000:         GAPBF.OPEN.FLAG$,                 \ SDH  2.3CS !2.4BG
5065: 0000:         PLLOL.OPEN.FLAG$,                 \ 2.3CS
5066: 0000:         PLLDB.OPEN.FLAG$,                 \ 2.3CS
5067: 0000:         PLLDB.TABLE$(1),                  \ 2.3CS
5068: 0000:         EAN.TABLE$(1),                    \ 2.3CS
5069: 0000: \       CITEM.OPEN.FLAG$,                 \ !2.5NWB
5070: 0000: \       CIMF.OPEN.FLAG$,                  \ !2.5NWB
5071: 0000: \       CSRWF.OPEN.FLAG$,                 \ !2.5NWB
5072: 0000: \       CSRBF.OPEN.FLAG$,                 \ !2.5NWB
5073: 0000:         CSR.AUDIT.FILE$,                  \ CDS
5074: 0000:         CSR.AUDIT.DATA$,                  \ CDS
5075: 0000:         CSR.AUDIT.OPEN.FLAG$,             \ CDS
5076: 0000:         CURR.LIST$,                       \ FLC
5077: 0000:         CURR.TERMINAL$,                   \
5078: 0000:         CURRENT.CODE$,                    \ DLC
5079: 0000:         DATA.IN$,                         \
5080: 0000:         DATE.TODAY$,                      \ FLC
5081: 0000:         STKMQ.OPEN.FLAG$,                 \ CDS
5082: 0000:         STLDT.OPEN.FLAG$,                 \ 1.6
5083: 0000:         BCSMF.OPEN.FLAG$,                 \ CDS
5084: 0000:         IEF.OPEN.FLAG$,                   \ CDS
5085: 0000:         DATA.FILES.REQ$,                  \ GMJK
5086: 0000:         DETAIL.RECORDS.RECEIVED$,         \ FLC
5087: 0000:         DIREC.OPEN.FLAG$,                 \ CDS
5088: 0000:         DIRORD.OPEN.FLAG$,                \ CDS
5089: 0000:         DIRSUP.OPEN.FLAG$,                \ CDS
5090: 0000:         DIRWF.OPEN.FLAG$,                 \ CDS
5091: 0000:         EPSOM.OPEN.FLAG$,                 \ FLC
5092: 0000:         LDTAF.OPEN.FLAG$,                 \ GMJK
5093: 0000:         LDTCF.OPEN.FLAG$,                 \ CDS
5094: 0000:         DRSMQ.OPEN.FLAG$,                 \ CDS
5095: 0000:         FILE.OPERATION$,                  \ DLC
5096: 0000: \       FIRST.CSR.LIST.FOR.PDT$,          \ 2.5NWB
5097: 0000:         FIRST.EOT.FOR.THIS.PDT$,          \
5098: 0000:         FIRST.ITEM.TO.BE.PROCESSED$,      \
5099: 0000:         FIRST.RETURN$,                    \ FLC
5100: 0000:         FPF.OPEN.FLAG$,                   \
5101: 0000:         HOLD.FLAG$,                       \
5102: 0000:         IDF.OPEN.FLAG$,                   \
5103: 0000:         IDSOF.OPEN.FLAG$,                 \ ELC
5104: 0000:         IRF.OPEN.FLAG$,                   \ FLC
5105: 0000:         IMSTC.OPEN.FLAG$,                 \1.7BG
5106: 0000:         LAST.ACTIVE.DATE$,                \
5107: 0000:         LAST.STOCKTAKE.DATE$,             \ 1.5
5108: 0000:         LAST.MESSAGE$,                    \
5109: 0000:         LOG.ON.DATE$,                     \ GMJK
5110: 0000:         LOG.ON.TIME$,                     \ GMJK
5111: 0000:         LDTBF.HEADER.WRITTEN$,            \ ELC
5112: 0000:         LDTBF.OPEN.FLAG$,                 \ ELC
5113: 0000:         LIST.ABANDONED$,                  \
5114: 0000:         LIST.BC$,                         \ FLC
5115: 0000:         LIST.TRANSMIT$(1),                \ FLC
5116: 0000:         LSSST.OPEN.FLAG$,                 \1.7BG
5117: 0000:         MONITORED.PORT$,                  \ DLC
5118: 0000:         NUM.SECTOR$,                      \ GMJK
5119: 0000:         ONORD.OPEN.FLAG$,                 \
5120: 0000:         ONORD.DELETED$(1),                \
5121: 0000:         ORDER.LINE.TABLE$(1),             \ CDS
5122: 0000:         PCHK.OPEN.FLAG$,                  \
5123: 0000:         PDT.ACTION$,                      \ FLC
5124: 0000:         PIITM.OPEN.FLAG$,                 \ FLC
5125: 0000:         PILST.OPEN.FLAG$,                 \ FLC
5126: 0000:         PIPE.OUT$,                        \
5127: 0000:         PDTWF.OPEN.FLAG$,                 \ FLC
5128: 0000:         PK2$,                             \
5129: 0000:         PK4$,                             \
5130: 0000:         PORT.STRING$,                     \
5131: 0000:         PREV.LOGGED.STATE$,               \ ELC
5132: 0000: \       PROCESS.CSR.WORKFILE$,            \ !2.5NWB
5133: 0000:         PSS38.STATUS$,                    \ FLC
5134: 0000:         RB.OPEN.FLAG$,                    \ 2.6BG
5135: 0000:         REWKF.OPEN.FLAG$,                 \ 2.6BG
5136: 0000:         RECALLS.OPEN.FLAG$,               \ 2.6BG
5137: 0000:         DELVINDX.OPEN.FLAG$,              \ 2.7SH
5138: 0000:         AF.OPEN.FLAG$,                    \ 2.7SH
5139: 0000:         UB.OPEN.FLAG$,                    \ 2.7SH
5140: 0000:         RECEIVE.STATE$,                   \
5141: 0000:         REQ.LIST.STORE$(1),               \ FLC
5142: 0000:         REQ.LIST.DATA$(1),                \ FLC
5143: 0000:         SAVED.ORDER.NO$,                  \ CDS
5144: 0000:         SAVED.ORDER.SUFFIX$,              \ CDS
5145: 0000:         SAVED.PAGE.NO$,                   \ CDS
5146: 0000:         SAVED.STORE.NUMBER$,              \ 1.8DA
5147: 0000:         SAVED.SUPPLIER.NO$,               \ CDS
5148: 0000:         SECTOR$,                          \ GMJK
5149: 0000:         SOFTS.OPEN.FLAG$,                 \ GMJK
5150: 0000:         SOH$,                             \ 1.5
5151: 0000:         STORED.UOD.HEADER$,               \ FLC
5152: 0000:         STORE.NUMBER$,                    \ 1.5
5153: 0000:         STOCK.OPEN.FLAG$,                 \1.7BG
5154: 0000:         STX$,                             \ FLC
5155: 0000:         STKBF.OPEN.FLAG$,                 \ 1.5
5156: 0000:         SXTMP.OPEN.FLAG$,                 \ 1.5
5157: 0000:         T.DATE$,                          \ 1.5
5158: 0000:         T.TIME$,                          \ 1.5
5159: 0000:         TEMP.TIME$,                       \ GMJK
5160: 0000:         TRAILER.LIST$,                    \ FLC
5161: 0000:         UOD.NUMBER$,                      \ FLC
5162: 0000:         UOD.NUM.ITEMS$,                   \ FLC
5163: 0000:         UOD.OPEN.FLAG$,                   \ FLC
5164: 0000:         UOD.STATUS.FLAG$,                 \ FLC
5165: 0000:         UODBF.OPEN.FLAG$,                 \ FLC
5166: 0000:         UODTF.OPEN.FLAG$,                 \ FLC
5167: 0000:         UNITS.OPEN.FLAG$
5168: 0000: 
5169: 0000: STRING GLOBAL                             \ GMJK
5170: 0000:         ITEM.STORAGE$,                    \ GMJK
5171: 0000:         ITEM.DESC.STORAGE$,               \ GMJK
5172: 0000:         BARCODE.DATA$,                    \ GMJK
5173: 0000:         BARCODE.INDEX$,                   \ GMJK
5174: 0000:         BARCODE.INDEX.STORAGE$,           \ GMJK
5175: 0000:         BARCODE.STORAGE$,                 \ GMJK
5176: 0000:         ITEM.DATA$,                       \ GMJK
5177: 0000:         ITEM.DATA.DESC$,                  \ GMJK
5178: 0000:         ITEM.POS.TABLE$(1),               \ GMJK
5179: 0000:         CCUOD.TABLE$(1),                  \ GMJK
5180: 0000:         CCLAM.TABLE$(1),                  \ 1.4
5181: 0000:         DATA.FILES.REQUIRED$,             \ GMJK
5182: 0000:         FINISH.DATE$,                     \ GMJK
5183: 0000:         FINISH.TIME$,                     \ GMJK
5184: 0000:         LDT.CCUOD.UPDATE.DATE$,           \ GMJK
5185: 0000:         LDT.CCUOD.UPDATE.TIME$,           \ GMJK
5186: 0000:         LDT.DATE.TIME$,                   \ GMJK
5187: 0000:         LDT.LAST.CLAIM.NUM$,              \ GMJK
5188: 0000:         STKCF.OPEN.FLAG$,                 \ 1.8DA
5189: 0000:         STKMF.OPEN.FLAG$,                 \ 1.8DA
5190: 0000:         CONCEPT.GROUPS$(1),               \ 1.8DA
5191: 0000:         PRODUCT.GROUPS$(1),               \ 1.8DA
5192: 0000:         BUSINESS.CENTRES$(1),             \ ! 1.8DA 2.1JAS
5193: 0000:         SOPTS.OPEN.FLAG$,                 \ ! 2.1JAS
5194: 0000:         LOCAL.OPEN.FLAG$,                 \ ! 2.1JAS
5195: 0000:         TSF.OPEN.FLAG$,                   \ ! 2.1JAS 2.2JAS
5196: 0000:         CCREJ.OPEN.FLAG$,                 \ 2.2JAS
5197: 0000:         CREDIT.CLAIM.FLAG$                ! 2.2JAS
5198: 0000: 
5199: 0000: 
5200: 0000: STRING GLOBAL                             \
5201: 0000:         BATCH.SCREEN.FLAG$,               \
5202: 0000:         EXP.STATES$,                      \
5203: 0000:         MODULE.NUMBER$,                   \
5204: 0000:         OPERATOR.ID$,                     \
5205: 0000:         STATE$,                           \
5206: 0000:         TRANS.FROM$,                      \
5207: 0000:         TRANS.TO$
5208: 0000: 
5209: 0000:  STRING GLOBAL                            \
5210: 0000:         REC.CHECK$(1),                    \
5211: 0000:         V.TAB$(1)
5212: 0000: 
5213: 0000: \*****************************************************************************
5214: 0000: \*****************************************************************************
5215: 0000: \***                                                                       ***
5216: 0000: \*** E X T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
5217: 0000: \***                                                                       ***
5218: 0000: \*****************************************************************************
5219: 0000: \*****************************************************************************
5220: 0000: 
5221: 0000: \*****************************************************************************
5222: 0000: \***   include external definitions for the following functions
5223: 0000: \***
5224: 0000: \***     ADXERROR
5225: 0000: \***     ADXSERVE
5226: 0000: \***     ADXSERCL
5227: 0000: \***     APPLICATION.LOG             01
5228: 0000: \***     READ.NEXT.IEF               11
5229: 0000: \***     SORT.TABLE                  14
5230: 0000: \***     CONV.TO.HEX                 16
5231: 0000: \***     CONV.TO.STRING              17
5232: 0000: \***     SESS.NUM.UTILITY            20
5233: 0000: \***     STKMQ
5234: 0000: \***     BCSMF
5235: 0000: \***     IDF
5236: 0000: \***     INVOK
5237: 0000: \***     PCHK
5238: 0000: \***     UOD
5239: 0000: \***     UODBF
5240: 0000: \***     UODTF
5241: 0000: \***     STKBF
5242: 0000: \***     SXTMP
5243: 0000: \***     SSPSC
5244: 0000: \***     BTCS
5245: 0000: \***     PRINT
5246: 0000: \***     SOPTS
5247: 0000: \***     LOCAL
5248: 0000: \***
5249: 0000: \*****************************************************************************
5250: 0000: 
5251: 0000:  %INCLUDE ADXERROR.J86
5252: 0000: \******************************************************************************
5253: 0000: \******************************************************************************
5254: 0000: \***                                                                        ***
5255: 0000: \***    %INCLUDE FOR FUNCTION ADXERROR (an I.B.M. system function)          ***
5256: 0000: \***                                                                        ***
5257: 0000: \***         AUTHOR        :  Stephen Kelsey                                ***
5258: 0000: \***                                                                        ***
5259: 0000: \***         DATE WRITTEN  :  21st February 1986                            ***
5260: 0000: \***                                                                        ***
5261: 0000: \***         DATE OF LAST REVISION  - 21st February 1986                    ***
5262: 0000: \***                                                                        ***
5263: 0000: \***         VERSION B     :  Stuart William McConnachie  18th March 1997   ***
5264: 0000: \***    Define size of ADXERROR return value from function.  This change    ***
5265: 0000: \***    was introduced by IBM in the 4690 Programming Guide.  Not defining  ***
5266: 0000: \***    this variable can cause Memory Protection Violations at run time.   ***
5267: 0000: \***                                                                        ***
5268: 0000: \******************************************************************************
5269: 0000: \******************************************************************************
5270: 0000: 
5271: 0000:    FUNCTION ADXERROR (TERM%,                                                  \
5272: 0000:                       MSGGRP%,                                                \
5273: 0000:                       MSGNUM%,                                                \
5274: 0000:                       SEVERITY%,                                              \
5275: 0000:                       EVENT.NUM%,                                             \
5276: 0000:                       UNIQUE$) EXTERNAL
5277: 0000: 
5278: 0000:       INTEGER*2  MSGNUM%,                                                     \
5279: 0000:                  TERM%,                                                       \
5280: 0000:                  ADXERROR                                                     !BSWM
5281: 0000: 
5282: 0000:       INTEGER*1 EVENT.NUM%,                                                   \
5283: 0000:                 MSGGRP%,                                                      \
5284: 0000:                 SEVERITY%
5285: 0000: 
5286: 0000:       STRING  UNIQUE$
5287: 0000: 
5288: 0000:    END FUNCTION
5289: 0000: 
5290: 0000:  %INCLUDE ADXSERVE.J86
5291: 0000: \******************************************************************************
5292: 0000: \******************************************************************************
5293: 0000: \***                                                                        ***
5294: 0000: \***    %INCLUDE FOR FUNCTION ADXSERVE (an I.B.M. system function)          ***
5295: 0000: \***                                                                        ***
5296: 0000: \***         AUTHOR        :  Bruce Scriver                                 ***
5297: 0000: \***                                                                        ***
5298: 0000: \***         DATE WRITTEN  :  14th March 1986                               ***
5299: 0000: \***                                                                        ***
5300: 0000: \***         DATE OF LAST REVISION  - 14th March 1986                       ***
5301: 0000: \***                                                                        ***
5302: 0000: \***                                                                        ***
5303: 0000: \******************************************************************************
5304: 0000: \******************************************************************************
5305: 0000: 
5306: 0000:    SUB ADXSERVE (RETURN.CODE%,                                                \
5307: 0000:                  ADX.FUNCTION%,                                               \
5308: 0000:                  ADX.PARM.1%,                                                 \
5309: 0000:                  ADX.PARM.2$)                                                 \
5310: 0000:    EXTERNAL
5311: 0000:   
5312: 0000:       STRING     ADX.PARM.2$
5313: 0000: 
5314: 0000:       INTEGER*2  ADX.FUNCTION%,                                               \
5315: 0000:                  ADX.PARM.1%
5316: 0000: 
5317: 0000:       INTEGER*4  RETURN.CODE%                                                 \
5318: 0000: 
5319: 0000:    END SUB     
5320: 0000: 
5321: 0000:  %INCLUDE ADXSERCL.J86                    ! DSW
5322: 0000: SUB ADXSERCL EXTERNAL
5323: 0000: END SUB
5324: 0000:  %INCLUDE PSBF01E.J86                     ! DLC
5325: 0000: REM \
5326: 0000: \*******************************************************************************
5327: 0000: \*******************************************************************************
5328: 0000: \***
5329: 0000: \***      %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION APPLICATION.LOG
5330: 0000: \***
5331: 0000: \***                      FUNCTION NUMBER   : PSBF01
5332: 0000: \***
5333: 0000: \***                    INCLUDE REFERENCE : PSBF01E.J86
5334: 0000: \*** 
5335: 0000: \***      Version B           Andrew Wedgeworth          1st July 1992
5336: 0000: \***      Three parameters which passed to the function have been removed.
5337: 0000: \***      APPLICATION.LOG has been added as a variable name (this holds the
5338: 0000: \***      return code).
5339: 0000: \***
5340: 0000: \*******************************************************************************
5341: 0000: 
5342: 0000: 
5343: 0000:    FUNCTION APPLICATION.LOG (MESSAGE.NO%,                                     \
5344: 0000:                              VAR.STRING.1$,                                   \
5345: 0000:                              VAR.STRING.2$,                                   \
5346: 0000:                              EVENT.NO%)  EXTERNAL
5347: 0000: 
5348: 0000:       INTEGER*1 EVENT.NO%
5349: 0000: 
5350: 0000:       INTEGER*2 APPLICATION.LOG,                                       \ GAW
5351: 0000:                 MESSAGE.NO%
5352: 0000: 
5353: 0000:       STRING VAR.STRING.1$,                                            \
5354: 0000:              VAR.STRING.2$
5355: 0000: 
5356: 0000:    END FUNCTION
5357: 0000: 
5358: 0000: \*******************************************************************************
5359: 0000:  %INCLUDE PSBF05E.J86                     ! 1.9BG
5360: 0000: REM\
5361: 0000: \*******************************************************************************
5362: 0000: \*******************************************************************************
5363: 0000: \***
5364: 0000: \***        INCLUDE       : CHECK.BOOTS.CODE external definition
5365: 0000: \***
5366: 0000: \***        REFERENCE     : PSBF05E.J86
5367: 0000: \***
5368: 0000: \***        Version A       Bruce Scriver                  24th February 1986  
5369: 0000: \*** 
5370: 0000: \***        Version B       Andrew Wedgeworth                  15th July 1992 
5371: 0000: \***        Redundant parameters removed, and CHECK.BOOTS.CODE defined as a 
5372: 0000: \***        variable to hold the return code.  
5373: 0000: \***
5374: 0000: \*******************************************************************************
5375: 0000: \*******************************************************************************
5376: 0000: 
5377: 0000:    FUNCTION CHECK.BOOTS.CODE (BOOTS.CODE$)                                     \
5378: 0000:    EXTERNAL
5379: 0000:    ! 3 parameters removed from here                                    ! BAW   
5380: 0000: 
5381: 0000:       STRING BOOTS.CODE$
5382: 0000:    ! 3 variables removed from here                                     ! BAW
5383: 0000:    
5384: 0000:       INTEGER*2 CHECK.BOOTS.CODE                                       ! BAW
5385: 0000:    
5386: 0000: 
5387: 0000:    END FUNCTION
5388: 0000: 
5389: 0000: !%INCLUDE PSBF06E.J86                     ! FLC
5390: 0000:  %INCLUDE PSBF11E.J86                     ! DLC
5391: 0000: REM \
5392: 0000: \*******************************************************************************
5393: 0000: \*******************************************************************************
5394: 0000: \***
5395: 0000: \***    %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION READ.NEXT.IEF
5396: 0000: \***
5397: 0000: \***
5398: 0000: \***            FUNCTION NUMBER       : PSBF11
5399: 0000: \***
5400: 0000: \***            INCLUDE REFERENCE     : PSBF11E.J86
5401: 0000: \***
5402: 0000: \***            DATE OF LAST AMENDMENT -  3rd March 1986
5403: 0000: \***
5404: 0000: \***     Version B             Andrew Wedgeworth          15th July 1992
5405: 0000: \***     Removal of redundant function parameters.  READ.NEXT.IEF defined as
5406: 0000: \***     a variable to hold the return code.
5407: 0000: \***
5408: 0000: \*******************************************************************************
5409: 0000: \*******************************************************************************
5410: 0000: 
5411: 0000: REM \
5412: 0000: \*******************************************************************************
5413: 0000: \*******************************************************************************
5414: 0000: \***
5415: 0000: \***
5416: 0000: \***            FUNCTION OVERVIEW
5417: 0000: \***            -----------------
5418: 0000: \***
5419: 0000: \***   This function finds and retreives the next bar code in an IEF chain.
5420: 0000: \***   If the code found is the last code in the chain, the function checks that
5421: 0000: \***   the number of codes in the chain is equal to the expected number.  If it
5422: 0000: \***   is not, a message is displayed and logged.  If an error occurs in reading
5423: 0000: \***   the IEF, a message is displayed and logged, and the function returns to
5424: 0000: \***   the calling program with a return code of 1.
5425: 0000: \***
5426: 0000: \***
5427: 0000: \*******************************************************************************
5428: 0000: \*******************************************************************************
5429: 0000: 
5430: 0000:    FUNCTION READ.NEXT.IEF (LAST.BAR.CODE$,                             \
5431: 0000:                            TOTAL.COUNT%,                               \
5432: 0000:                            BOOTS.CODE$)  EXTERNAL
5433: 0000:    ! 3 parameters deleted from here                                    ! BAW			   
5434: 0000: 
5435: 0000:       STRING  BOOTS.CODE$,                                             \
5436: 0000:               LAST.BAR.CODE$
5437: 0000:       ! 3 variables removed from here                                  ! BAW
5438: 0000: 
5439: 0000:       INTEGER*2 READ.NEXT.IEF,                                         \ BAW
5440: 0000:                 TOTAL.COUNT%
5441: 0000:              
5442: 0000: 
5443: 0000: 
5444: 0000:    END FUNCTION
5445: 0000: 
5446: 0000: \*******************************************************************************
5447: 0000:  %INCLUDE PSBF14E.J86                     ! DLC
5448: 0000: REM\
5449: 0000: \*******************************************************************************
5450: 0000: \*******************************************************************************
5451: 0000: \***
5452: 0000: \***        INCLUDE       : SORT.TABLE external definition
5453: 0000: \***
5454: 0000: \***        REFERENCE     : PSBF14E.J86
5455: 0000: \***
5456: 0000: \***        Version A     Bruce Scriver                   3rd March 1986   
5457: 0000: \*** 
5458: 0000: \***        Version B     Andrew Wedgeworth               17th July 1992
5459: 0000: \***        Redundant function parameters removed.  SORT.TABLE defined as a
5460: 0000: \***        variable to hold the return code.
5461: 0000: \***
5462: 0000: \*******************************************************************************
5463: 0000: \*******************************************************************************
5464: 0000: 
5465: 0000:    FUNCTION SORT.TABLE (NUMBER.OF.ENTRIES%)                                    \
5466: 0000:    EXTERNAL
5467: 0000: 
5468: 0000:       INTEGER   NUMBER.OF.ENTRIES%,                                    \ BAW
5469: 0000:                 SORT.TABLE                 
5470: 0000: 
5471: 0000:    END FUNCTION
5472: 0000: 
5473: 0000:  %INCLUDE PSBF16E.J86                     ! DLC
5474: 0000: REM\
5475: 0000: \*******************************************************************************
5476: 0000: \*******************************************************************************
5477: 0000: \***
5478: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.HEX FUNCTION
5479: 0000: \***
5480: 0000: \***                  REFERENCE     : PSBF16E.J86
5481: 0000: \***
5482: 0000: \***       Version A            Bruce Scriver          25th February 1986
5483: 0000: \***
5484: 0000: \***       Version B           Andrew Wedgeworth            2nd July 1992
5485: 0000: \***       Removal of redundant parameters, and CONV.TO.HEX defined as a 
5486: 0000: \***       variable to hold the return code. 
5487: 0000: \***
5488: 0000: \*******************************************************************************
5489: 0000: \*******************************************************************************
5490: 0000: 
5491: 0000:    FUNCTION CONV.TO.HEX (INTEGER4%)                                            \
5492: 0000:    EXTERNAL
5493: 0000:    ! 3 parameters removed from here                                    ! BAW
5494: 0000: 
5495: 0000:    ! 3 lines deleted from here                                         ! BAW
5496: 0000:    
5497: 0000:       INTEGER*2 CONV.TO.HEX                                            ! BAW
5498: 0000: 
5499: 0000:       INTEGER*4 INTEGER4%
5500: 0000: 
5501: 0000:    END FUNCTION
5502: 0000: 
5503: 0000:  %INCLUDE PSBF17E.J86                     ! DLC
5504: 0000: REM \
5505: 0000: \*******************************************************************************
5506: 0000: \*******************************************************************************
5507: 0000: \***
5508: 0000: \***
5509: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.STRING FUNCTION
5510: 0000: \***
5511: 0000: \***                     REFERENCE     : PSBF17E.J86
5512: 0000: \***
5513: 0000: \***       Version A            Bruce Scriver       24th February 1986           
5514: 0000: \***
5515: 0000: \***       Version B          Andrew Wedgeworth          2nd July 1992
5516: 0000: \***       Redundant parameters removed, and the function's name is 
5517: 0000: \***       is defined as a variable to hold the return code. 
5518: 0000: \***
5519: 0000: \*******************************************************************************
5520: 0000: \*******************************************************************************
5521: 0000: 
5522: 0000:    FUNCTION CONV.TO.STRING (EVENT.NUMBER%,                                     \
5523: 0000:                             INTEGER4%)                                         \
5524: 0000:    EXTERNAL
5525: 0000: ! 3 parameters removed from here                                       ! BAW
5526: 0000: 
5527: 0000: ! 3 lines deleted from here                                            ! BAW
5528: 0000: 
5529: 0000:       INTEGER*1 EVENT.NUMBER%
5530: 0000: 
5531: 0000:       INTEGER*2 CONV.TO.STRING                                         ! BAW
5532: 0000: 
5533: 0000:       INTEGER*4 INTEGER4%
5534: 0000: 
5535: 0000:    END FUNCTION
5536: 0000: 
5537: 0000:  %INCLUDE PSBF18E.J86                     ! 1.8DA
5538: 0000: REM\
5539: 0000: \*******************************************************************************
5540: 0000: \*******************************************************************************
5541: 0000: \***
5542: 0000: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT external definition
5543: 0000: \***
5544: 0000: \***        REFERENCE     : PSBF18E.J86
5545: 0000: \***
5546: 0000: \***        Version A      Stephen Kelsey                   23rd March 1987 
5547: 0000: \***
5548: 0000: \***        Version B      Andrew Wedgeworth                  7th July 1992 
5549: 0000: \***        Removal of redundant parameters, and inclusion of function's 
5550: 0000: \***        name as a variable to hold the return code.
5551: 0000: \***
5552: 0000: \*******************************************************************************
5553: 0000: \*******************************************************************************
5554: 0000: 
5555: 0000:    FUNCTION CALC.BOOTS.CODE.CHECK.DIGIT (BOOTS.CODE.6.DIGIT$)          \ 
5556: 0000:    EXTERNAL
5557: 0000:    ! 3 parameters removed from here                                    ! BAW
5558: 0000: 
5559: 0000:    STRING BOOTS.CODE.6.DIGIT$
5560: 0000:    ! 3 variables deleted from here                                     ! BAW
5561: 0000:    
5562: 0000:    INTEGER* 2 CALC.BOOTS.CODE.CHECK.DIGIT                              ! BAW
5563: 0000:    
5564: 0000:    END FUNCTION
5565: 0000: 
5566: 0000:  %INCLUDE PSBF20E.J86                     ! DLC
5567: 0000: REM\
5568: 0000: \*******************************************************************************
5569: 0000: \*******************************************************************************
5570: 0000: \***
5571: 0000: \***       %INCLUDE FOR EXTERNAL DEFINITION OF SESS.NUM.UTILITY
5572: 0000: \***
5573: 0000: \***                  REFERENCE     : PSBF20E.J86
5574: 0000: \***
5575: 0000: \***     VERSION C            Janet Smith                13th May 1992
5576: 0000: \***     Increased PASSED.INTEGER to 2 bytes to cater for more than
5577: 0000: \***     128 files.
5578: 0000: \***
5579: 0000: \***     VERSION D.           Andrew Wedgeworth          1st July 1992
5580: 0000: \***     Removal of redundant parameters and addition of SESS.NUM.UTILITY
5581: 0000: \***     as a variable.  This new variable contains the function's return
5582: 0000: \***     code.
5583: 0000: \***
5584: 0000: \*******************************************************************************
5585: 0000: \*******************************************************************************
5586: 0000: 
5587: 0000:    FUNCTION SESS.NUM.UTILITY (FUNCTION.FLAG$,                          \
5588: 0000:                               PASSED.INTEGER%,                         \
5589: 0000:                               PASSED.STRING$)                          \
5590: 0000:    EXTERNAL
5591: 0000: 
5592: 0000:    STRING    FUNCTION.FLAG$,                                           \
5593: 0000:              PASSED.STRING$
5594: 0000:    ! 3 variables removed from here                                     ! CAW
5595: 0000: 
5596: 0000: 
5597: 0000:    INTEGER*2 SESS.NUM.UTILITY,                                         \ CAW
5598: 0000:              PASSED.INTEGER%				               ! CJAS
5599: 0000: 
5600: 0000:    END FUNCTION
5601: 0000: 
5602: 0000:  %INCLUDE PSBF21E.J86                     ! 1.9BG
5603: 0000: REM\
5604: 0000: \*******************************************************************************
5605: 0000: \*******************************************************************************
5606: 0000: \***
5607: 0000: \***        INCLUDE       : CHECK.BAR.CODE external definition
5608: 0000: \***
5609: 0000: \***        REFERENCE     : PSBF21E.J86
5610: 0000: \***
5611: 0000: \***        Version A     Bruce Scriver                  13th May 1988
5612: 0000: \***
5613: 0000: \***        Version B     Andrew Wedgeworth             21st July 1992
5614: 0000: \***        Redundant function parameters removed.  CHECK.BAR.CODE defined as
5615: 0000: \***        a variable to hold the return code.
5616: 0000: \***
5617: 0000: \*******************************************************************************
5618: 0000: \*******************************************************************************
5619: 0000: 
5620: 0000:    FUNCTION CHECK.BAR.CODE (BAR.CODE$)                                 \
5621: 0000:    EXTERNAL
5622: 0000: 
5623: 0000:    STRING    BAR.CODE$
5624: 0000: 
5625: 0000:    INTEGER*2 CHECK.BAR.CODE                                            ! BAW
5626: 0000: 
5627: 0000:    END FUNCTION
5628: 0000: 
5629: 0000: 
5630: 0000:  %INCLUDE IDFEXT.J86                      ! FLC
5631: 0000: \*******************************************************************************
5632: 0000: \***                                                                         ***
5633: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM DESCRIPTION FILE        ***
5634: 0000: \***                                                                         ***
5635: 0000: \***                       REFERENCE : IDFEXT.J86                            ***
5636: 0000: \***                                                                         ***
5637: 0000: \***      Version A           Andrew Wedgeworth         9th July 1992        ***
5638: 0000: \***
5639: 0000: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
5640: 0000: \***    No changes to this file.
5641: 0000: \***
5642: 0000: \***   VERSION D               Nik Sen                 22nd December 1994
5643: 0000: \***   WRITE.IDF.HOLD added
5644: 0000: \***
5645: 0000: \*******************************************************************************
5646: 0000: 
5647: 0000:        FUNCTION IDF.SET EXTERNAL                                      
5648: 0000:        END FUNCTION                                                   
5649: 0000: 
5650: 0000: 
5651: 0000:        FUNCTION READ.IDF EXTERNAL                                     
5652: 0000:           INTEGER*2 READ.IDF                                          
5653: 0000:        END FUNCTION                                                   
5654: 0000: 
5655: 0000: 
5656: 0000:        FUNCTION READ.IDF.LOCK EXTERNAL                                
5657: 0000:           INTEGER*2 READ.IDF.LOCK                                     
5658: 0000:        END FUNCTION                                                   
5659: 0000: 
5660: 0000:        FUNCTION WRITE.IDF EXTERNAL
5661: 0000:           INTEGER*2 WRITE.IDF
5662: 0000:        END FUNCTION	       
5663: 0000: 
5664: 0000:        FUNCTION WRITE.IDF.HOLD EXTERNAL
5665: 0000:           INTEGER*2 WRITE.IDF.HOLD
5666: 0000:        END FUNCTION
5667: 0000: 
5668: 0000:        FUNCTION WRITE.IDF.UNLOCK EXTERNAL                                  
5669: 0000:           INTEGER*2 WRITE.IDF.UNLOCK                                      
5670: 0000:        END FUNCTION                                                   
5671: 0000: !%INCLUDE IRFEXT.J86                      ! FLC TEST
5672: 0000:  %INCLUDE STKMQEXT.J86                    ! GMJK
5673: 0000: \*****************************************************************************
5674: 0000: \*****************************************************************************
5675: 0000: \***
5676: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCK MOVEMENT QUEUE FILE
5677: 0000: \***
5678: 0000: \***                      REFERENCE: STKMQEXT.J86
5679: 0000: \***
5680: 0000: \***       Version A            Les Cook                     8/9/92
5681: 0000: \***
5682: 0000: \***    VERSION F.              ROBERT COWEY.                       21 OCT 1993.
5683: 0000: \***    No changes to this file.
5684: 0000: \***
5685: 0000: \*******************************************************************************
5686: 0000: \*******************************************************************************
5687: 0000: 
5688: 0000:      FUNCTION STKMQ.SET EXTERNAL
5689: 0000:      END FUNCTION
5690: 0000:      
5691: 0000:      FUNCTION READ.STKMQ EXTERNAL
5692: 0000:         INTEGER*2 READ.STKMQ
5693: 0000:      END FUNCTION
5694: 0000:      
5695: 0000:      FUNCTION WRITE.STKMQ EXTERNAL
5696: 0000:         INTEGER*2 WRITE.STKMQ
5697: 0000:      END FUNCTION
5698: 0000:      
5699: 0000:      FUNCTION WRITE.HOLD.STKMQ EXTERNAL
5700: 0000:         INTEGER*2 WRITE.HOLD.STKMQ
5701: 0000:      END FUNCTION
5702: 0000:      
5703: 0000:      
5704: 0000:      
5705: 0000:  %INCLUDE BCSMFEXT.J86                    ! FLC
5706: 0000: \*****************************************************************************
5707: 0000: \*****************************************************************************
5708: 0000: \***
5709: 0000: \***   EXTERNAL FUNCTION DEFINITIONS FOR BUSINESS CENTRE SUPPLY METHOD FILE
5710: 0000: \***
5711: 0000: \***               REFERENCE: BCSMFFUN.BAS
5712: 0000: \***
5713: 0000: \***        Version B           Les Cook              11/1/93
5714: 0000: \***
5715: 0000: \*****************************************************************************
5716: 0000: \*****************************************************************************
5717: 0000: 
5718: 0000:     FUNCTION BCSMF.SET EXTERNAL
5719: 0000:     END FUNCTION
5720: 0000:     
5721: 0000:     FUNCTION READ.BCSMF EXTERNAL
5722: 0000:        INTEGER*2 READ.BCSMF
5723: 0000:     END FUNCTION
5724: 0000:     
5725: 0000:     FUNCTION READ.BCSMF.LOCK EXTERNAL
5726: 0000:        INTEGER*2 READ.BCSMF.LOCK
5727: 0000:     END FUNCTION
5728: 0000:     
5729: 0000:     FUNCTION WRITE.BCSMF EXTERNAL
5730: 0000:        INTEGER*2 WRITE.BCSMF
5731: 0000:     END FUNCTION
5732: 0000:     
5733: 0000:     FUNCTION WRITE.BCSMF.UNLOCK EXTERNAL
5734: 0000:        INTEGER*2 WRITE.BCSMF.UNLOCK
5735: 0000:     END FUNCTION
5736: 0000:     
5737: 0000:     
5738: 0000:  %INCLUDE INVOKEXT.J86                    ! FLC
5739: 0000: \*******************************************************************************
5740: 0000: \***                                                                         ***
5741: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE INVCE OK FILE                ***
5742: 0000: \***                                                                         ***
5743: 0000: \***                     REFERENCE : INVOKEXT.J86                            ***
5744: 0000: \***                                                                         ***
5745: 0000: \***      Version A         Andrew Wedgeworth       3rd August 1992          ***
5746: 0000: \***                                                                         ***
5747: 0000: \***      Version B         Stephen Kelsey (CTG)    9th October 1992         ***
5748: 0000: \***          Add functions READ.INVOK.LOCKED and WRITE.INVOK.UNLOCK         ***
5749: 0000: \***                                                                         ***
5750: 0000: \*******************************************************************************
5751: 0000: 
5752: 0000: 
5753: 0000:       FUNCTION INVOK.SET EXTERNAL 
5754: 0000:       END FUNCTION
5755: 0000:       
5756: 0000:       FUNCTION READ.INVOK EXTERNAL
5757: 0000:          INTEGER*2 READ.INVOK
5758: 0000:       END FUNCTION	             
5759: 0000:       
5760: 0000:       FUNCTION READ.INVOK.LOCKED EXTERNAL                              ! BSPK
5761: 0000:          INTEGER*2 READ.INVOK.LOCKED                                   ! BSPK
5762: 0000:       END FUNCTION	                                               ! BSPK
5763: 0000:       
5764: 0000:       FUNCTION WRITE.INVOK.UNLOCK EXTERNAL                             ! BSPK
5765: 0000:          INTEGER*2 WRITE.INVOK.UNLOCK                                  ! BSPK
5766: 0000:       END FUNCTION	                                               ! BSPK
5767: 0000:  %INCLUDE PCHKEXT.J86                     ! DLC
5768: 0000: \*****************************************************************************
5769: 0000: \*****************************************************************************
5770: 0000: \***
5771: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR PCHK
5772: 0000: \***
5773: 0000: \***        REFERENCE: PCHKEXT.J86
5774: 0000: \***
5775: 0000: \*****************************************************************************
5776: 0000: \*****************************************************************************
5777: 0000: 
5778: 0000: 
5779: 0000:    FUNCTION PCHK.SET EXTERNAL
5780: 0000:    END FUNCTION
5781: 0000:    
5782: 0000:    FUNCTION READ.PCHK EXTERNAL
5783: 0000:    END FUNCTION
5784: 0000:    
5785: 0000:    FUNCTION WRITE.PCHK EXTERNAL
5786: 0000:    END FUNCTION
5787: 0000:    
5788: 0000:    
5789: 0000: \%INCLUDE CSREXT.J86                      ! DLC !2.5NWB
5790: 0000:  %INCLUDE EPSOMEXT.J86                    ! DLC
5791: 0000: \*****************************************************************************
5792: 0000: \*****************************************************************************
5793: 0000: \***
5794: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR EPSOM
5795: 0000: \***
5796: 0000: \***      REFERENCE: EPSOMEXT.J86
5797: 0000: \***
5798: 0000: \*****************************************************************************
5799: 0000: \*****************************************************************************
5800: 0000: 
5801: 0000: 
5802: 0000:    FUNCTION EPSOM.SET EXTERNAL
5803: 0000:    END FUNCTION
5804: 0000:    
5805: 0000:  %INCLUDE UNITSEXT.J86                    ! DLC
5806: 0000: \*****************************************************************************
5807: 0000: \*****************************************************************************
5808: 0000: \*** 
5809: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR UNITS
5810: 0000: \***
5811: 0000: \***        REFERENCE:  UNITSEXT.J86
5812: 0000: \***
5813: 0000: \*****************************************************************************
5814: 0000: \*****************************************************************************
5815: 0000: 
5816: 0000:    FUNCTION UNITS.SET EXTERNAL
5817: 0000:    END FUNCTION
5818: 0000:    
5819: 0000:    FUNCTION READ.UNITS EXTERNAL
5820: 0000:       INTEGER*2 READ.UNITS
5821: 0000:    END FUNCTION
5822: 0000:    
5823: 0000:    FUNCTION READ.UNITS.LOCK EXTERNAL
5824: 0000:       INTEGER*2 READ.UNITS.LOCK
5825: 0000:    END FUNCTION
5826: 0000:    
5827: 0000:    FUNCTION WRITE.UNITS EXTERNAL
5828: 0000:       INTEGER*2 WRITE.UNITS
5829: 0000:    END FUNCTION
5830: 0000:    
5831: 0000:    FUNCTION WRITE.UNITS.UNLOCK EXTERNAL
5832: 0000:       INTEGER*2 WRITE.UNITS.UNLOCK
5833: 0000:    END FUNCTION
5834: 0000:    
5835: 0000:    
5836: 0000:    
5837: 0000:  %INCLUDE DIRECEXT.J86                    ! DLC
5838: 0000: \*****************************************************************************
5839: 0000: \*****************************************************************************
5840: 0000: \***
5841: 0000: \***       EXTERNAL FUNCTION DEFINITIONS FOR DIREC
5842: 0000: \***
5843: 0000: \***       REFERENCE: DIRECEXT.J86
5844: 0000: \***
5845: 0000: \*****************************************************************************
5846: 0000: \*****************************************************************************
5847: 0000: 
5848: 0000:    FUNCTION DIREC.SET EXTERNAL 
5849: 0000:    END FUNCTION
5850: 0000:    
5851: 0000:    
5852: 0000:  %INCLUDE LDTBFEXT.J86                    ! ELC
5853: 0000: \*******************************************************************************
5854: 0000: \***                                                                         
5855: 0000: \***         EXTERNAL FUNCTION DEFINITIONS FOR THE LDT BUFFER FILE          
5856: 0000: \***                                                                         
5857: 0000: \***                     REFERENCE : LDTBFEXT.J86                            
5858: 0000: \***                                                                         
5859: 0000: \***          Version B     Les Cook      4th November 1992               
5860: 0000: \***                                                                         
5861: 0000: \*******************************************************************************
5862: 0000: 
5863: 0000:        FUNCTION LDTBF.SET EXTERNAL                                      
5864: 0000:        END FUNCTION                                                   
5865: 0000: 
5866: 0000: 
5867: 0000:        FUNCTION READ.LDTBF EXTERNAL                                  
5868: 0000:           INTEGER*2 READ.LDTBF                                       
5869: 0000:        END FUNCTION                                                   
5870: 0000:        
5871: 0000:        FUNCTION WRITE.LDTBF EXTERNAL
5872: 0000:           INTEGER*2 WRITE.LDTBF
5873: 0000:        END FUNCTION
5874: 0000:  %INCLUDE UODEXT.J86                      ! FLC
5875: 0000: \*****************************************************************************
5876: 0000: \*****************************************************************************
5877: 0000: \***
5878: 0000: \***     EXTERNAL FUNCTION DEFINITIONS FOR UOD DUMMY FILE
5879: 0000: \***
5880: 0000: \***     REFERENCE: UODEXT.J86
5881: 0000: \***
5882: 0000: \*****************************************************************************
5883: 0000: \*****************************************************************************
5884: 0000: 
5885: 0000:    FUNCTION UOD.SET EXTERNAL
5886: 0000:    END FUNCTION
5887: 0000:    
5888: 0000:    
5889: 0000:  %INCLUDE UODBFEXT.J86                    ! FLC
5890: 0000: \*******************************************************************************
5891: 0000: \*******************************************************************************
5892: 0000: \***
5893: 0000: \***           UOD BUFFER FILE EXTERNAL FILE PUBLIC DEFINITIONS
5894: 0000: \***
5895: 0000: \***                    REFERENCE    : UODBFEXT.BAS
5896: 0000: \***
5897: 0000: \***    Version A.         Michael Kelsall              08th February 1993
5898: 0000: \***
5899: 0000: \*******************************************************************************
5900: 0000: \*******************************************************************************
5901: 0000: 
5902: 0000:  
5903: 0000:   FUNCTION UODBF.SET EXTERNAL
5904: 0000:       INTEGER*2 UODBF.SET
5905: 0000:   END FUNCTION
5906: 0000: 
5907: 0000: 
5908: 0000:   FUNCTION READ.UODBF EXTERNAL
5909: 0000:       INTEGER*2 READ.UODBF 
5910: 0000:   END FUNCTION
5911: 0000: 
5912: 0000:   
5913: 0000:   FUNCTION WRITE.UODBF EXTERNAL
5914: 0000:       INTEGER*2 WRITE.UODBF
5915: 0000:   END FUNCTION
5916: 0000: 
5917: 0000:   
5918: 0000:   FUNCTION WRITE.HOLD.UODBF EXTERNAL
5919: 0000:       INTEGER*2 WRITE.HOLD.UODBF						
5920: 0000:   END FUNCTION								
5921: 0000: 
5922: 0000:  %INCLUDE UODTFEXT.J86                    ! FLC
5923: 0000: \*****************************************************************************
5924: 0000: \*****************************************************************************
5925: 0000: \***
5926: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR UODTF
5927: 0000: \***
5928: 0000: \***        REFERENCE:  UODTFEXT.J86
5929: 0000: \***
5930: 0000: \***        Version A         Les Cook         22/2/1993
5931: 0000: \***
5932: 0000: \*****************************************************************************
5933: 0000: \*****************************************************************************
5934: 0000: 
5935: 0000:    FUNCTION UODTF.SET EXTERNAL
5936: 0000:    END FUNCTION
5937: 0000:    
5938: 0000:    FUNCTION READ.UODTF EXTERNAL
5939: 0000:       INTEGER*2 READ.UODTF
5940: 0000:    END FUNCTION
5941: 0000:    
5942: 0000:    FUNCTION WRITE.UODTF EXTERNAL
5943: 0000:       INTEGER*2 WRITE.UODTF
5944: 0000:    END FUNCTION
5945: 0000:    
5946: 0000:    
5947: 0000:  %INCLUDE PILSTEXT.J86                    ! FLC
5948: 0000: \*****************************************************************************
5949: 0000: \*****************************************************************************
5950: 0000: \***
5951: 0000: \***     EXTERNAL FUNCTION DEFINITIONS FOR PILST
5952: 0000: \***
5953: 0000: \***     REFERENCE: PILSTEXT.J86
5954: 0000: \***
5955: 0000: \***     9th October 1992
5956: 0000: \***
5957: 0000: \*****************************************************************************
5958: 0000: \*****************************************************************************
5959: 0000: 
5960: 0000:    FUNCTION PILST.SET EXTERNAL
5961: 0000:    END FUNCTION
5962: 0000:    
5963: 0000:    FUNCTION READ.PILST EXTERNAL
5964: 0000:       INTEGER*2 READ.PILST
5965: 0000:    END FUNCTION
5966: 0000:    
5967: 0000:    FUNCTION READ.PILST.LOCK EXTERNAL
5968: 0000:       INTEGER*2 READ.PILST.LOCK
5969: 0000:    END FUNCTION
5970: 0000:    
5971: 0000:    FUNCTION WRITE.PILST EXTERNAL
5972: 0000:       INTEGER*2 WRITE.PILST
5973: 0000:    END FUNCTION
5974: 0000:    
5975: 0000:    FUNCTION WRITE.PILST.HOLD EXTERNAL
5976: 0000:       INTEGER*2 WRITE.PILST.HOLD
5977: 0000:    END FUNCTION
5978: 0000:    
5979: 0000:    FUNCTION WRITE.PILST.UNLOCK EXTERNAL
5980: 0000:       INTEGER*2 WRITE.PILST.UNLOCK
5981: 0000:    END FUNCTION
5982: 0000:    
5983: 0000:    
5984: 0000:  %INCLUDE PIITMEXT.J86                    ! FLC
5985: 0000: \*****************************************************************************
5986: 0000: \*****************************************************************************
5987: 0000: \***
5988: 0000: \***            EXTERNAL FUNCTION DEFINITIONS FOR PIITM
5989: 0000: \***
5990: 0000: \***            REFERENCE: PIITMEXT.J86
5991: 0000: \***
5992: 0000: \***            Les Cook 9/10/1992
5993: 0000: \***
5994: 0000: \*****************************************************************************
5995: 0000: \*****************************************************************************
5996: 0000: 
5997: 0000:    FUNCTION PIITM.SET EXTERNAL
5998: 0000:    END FUNCTION
5999: 0000:    
6000: 0000:    FUNCTION READ.PIITM EXTERNAL
6001: 0000:       INTEGER*2 READ.PIITM
6002: 0000:    END FUNCTION
6003: 0000:    
6004: 0000:    FUNCTION READ.PIITM.LOCK EXTERNAL
6005: 0000:       INTEGER*2 READ.PIITM.LOCK
6006: 0000:    END FUNCTION
6007: 0000:    
6008: 0000:    FUNCTION WRITE.PIITM EXTERNAL
6009: 0000:       INTEGER*2 WRITE.PIITM
6010: 0000:    END FUNCTION
6011: 0000:    
6012: 0000:    FUNCTION WRITE.PIITM.UNLOCK EXTERNAL
6013: 0000:       INTEGER*2 WRITE.PIITM.UNLOCK
6014: 0000:    END FUNCTION
6015: 0000:    
6016: 0000:    FUNCTION WRITE.PIITM.HOLD.UNLOCK EXTERNAL
6017: 0000:       INTEGER*2 WRITE.PIITM.HOLD.UNLOCK
6018: 0000:    END FUNCTION
6019: 0000:    
6020: 0000:    FUNCTION WRITE.PIITM.HOLD EXTERNAL
6021: 0000:       INTEGER*2 WRITE.PIITM.HOLD
6022: 0000:    END FUNCTION
6023: 0000:    
6024: 0000: !%INCLUDE PDTWFEXT.J86                    ! FLC
6025: 0000: 
6026: 0000:  %INCLUDE CCUODEXT.J86                    ! GMJK
6027: 0000: 
6028: 0000: \*****************************************************************************
6029: 0000: \*****************************************************************************
6030: 0000: \***
6031: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6032: 0000: \***
6033: 0000: \***                   FILE TYPE:  KEYED
6034: 0000: \***
6035: 0000: \***                   REFERENCE:  CCUODEXT.J86
6036: 0000: \***
6037: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6038: 0000: \***				   FILE OF OPEN/CLOSED UODS
6039: 0000: \***
6040: 0000: \***
6041: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
6042: 0000: \***      
6043: 0000: \*****************************************************************************
6044: 0000: \*****************************************************************************
6045: 0000: 
6046: 0000: 
6047: 0000:   FUNCTION CCUOD.SET EXTERNAL
6048: 0000:      INTEGER*2 CCUOD.SET
6049: 0000:   END FUNCTION
6050: 0000: 
6051: 0000: 
6052: 0000:   FUNCTION READ.CCUOD EXTERNAL
6053: 0000:     INTEGER*2 READ.CCUOD
6054: 0000:   END FUNCTION
6055: 0000:   
6056: 0000: 
6057: 0000:   FUNCTION READ.CCUOD.LOCKED EXTERNAL
6058: 0000:     INTEGER*2 READ.CCUOD.LOCKED
6059: 0000:   END FUNCTION  
6060: 0000: 
6061: 0000: 
6062: 0000:   FUNCTION WRITE.HOLD.CCUOD EXTERNAL
6063: 0000:     INTEGER*2 WRITE.HOLD.CCUOD
6064: 0000:   END FUNCTION
6065: 0000: 
6066: 0000: 
6067: 0000:   FUNCTION WRITE.UNLOCK.CCUOD EXTERNAL
6068: 0000:     INTEGER*2 WRITE.UNLOCK.CCUOD
6069: 0000:   END FUNCTION
6070: 0000: 
6071: 0000: 
6072: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCUOD EXTERNAL
6073: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUOD
6074: 0000:   END FUNCTION
6075: 0000:   
6076: 0000: 
6077: 0000:   FUNCTION WRITE.CCUOD EXTERNAL
6078: 0000:     INTEGER*2 WRITE.CCUOD
6079: 0000:   END FUNCTION
6080: 0000: 
6081: 0000:  %INCLUDE CCLAMEXT.J86                    ! 1.4
6082: 0000: 
6083: 0000: \*****************************************************************************
6084: 0000: \*****************************************************************************
6085: 0000: \***
6086: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6087: 0000: \***
6088: 0000: \***                   FILE TYPE:  KEYED
6089: 0000: \***
6090: 0000: \***                   REFERENCE:  CCLAMEXT.J86
6091: 0000: \***
6092: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6093: 0000: \***				   FILE OF CURRENT CREDIT CLAIMS
6094: 0000: \***
6095: 0000: \***
6096: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
6097: 0000: \***      
6098: 0000: \*****************************************************************************
6099: 0000: \*****************************************************************************
6100: 0000: 
6101: 0000: 
6102: 0000:   FUNCTION CCLAM.SET EXTERNAL
6103: 0000:      INTEGER*2 CCLAM.SET
6104: 0000:   END FUNCTION
6105: 0000: 
6106: 0000: 
6107: 0000:   FUNCTION READ.CCLAM EXTERNAL
6108: 0000:     INTEGER*2 READ.CCLAM
6109: 0000:   END FUNCTION
6110: 0000:   
6111: 0000: 
6112: 0000:   FUNCTION READ.CCLAM.LOCKED EXTERNAL
6113: 0000:     INTEGER*2 READ.CCLAM.LOCKED
6114: 0000:   END FUNCTION  
6115: 0000: 
6116: 0000: 
6117: 0000:   FUNCTION WRITE.HOLD.CCLAM EXTERNAL
6118: 0000:     INTEGER*2 WRITE.HOLD.CCLAM
6119: 0000:   END FUNCTION
6120: 0000: 
6121: 0000: 
6122: 0000:   FUNCTION WRITE.UNLOCK.CCLAM EXTERNAL
6123: 0000:     INTEGER*2 WRITE.UNLOCK.CCLAM
6124: 0000:   END FUNCTION
6125: 0000: 
6126: 0000: 
6127: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCLAM EXTERNAL
6128: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCLAM
6129: 0000:   END FUNCTION
6130: 0000:   
6131: 0000: 
6132: 0000:   FUNCTION WRITE.CCLAM EXTERNAL
6133: 0000:     INTEGER*2 WRITE.CCLAM
6134: 0000:   END FUNCTION
6135: 0000: 
6136: 0000:  %INCLUDE CCITMEXT.J86                    ! GMJK
6137: 0000: 
6138: 0000: \*****************************************************************************
6139: 0000: \*****************************************************************************
6140: 0000: \***
6141: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6142: 0000: \***
6143: 0000: \***                   FILE TYPE:  KEYED
6144: 0000: \***
6145: 0000: \***                   REFERENCE:  CCITMEXT.J86
6146: 0000: \***
6147: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6148: 0000: \***				   FILE OF ITEMS PER OPEN/CLOSED UODS
6149: 0000: \***
6150: 0000: \***
6151: 0000: \***      VERSION A : Michael J. Kelsall      13th September 1993
6152: 0000: \***      
6153: 0000: \*****************************************************************************
6154: 0000: \*****************************************************************************
6155: 0000: 
6156: 0000: 
6157: 0000:   FUNCTION CCITM.SET EXTERNAL
6158: 0000:      INTEGER*2 CCITM.SET
6159: 0000:   END FUNCTION
6160: 0000: 
6161: 0000: 
6162: 0000:   FUNCTION READ.CCITM EXTERNAL
6163: 0000:     INTEGER*2 READ.CCITM
6164: 0000:   END FUNCTION
6165: 0000:   
6166: 0000: 
6167: 0000:   FUNCTION READ.CCITM.LOCKED EXTERNAL
6168: 0000:     INTEGER*2 READ.CCITM.LOCKED
6169: 0000:   END FUNCTION  
6170: 0000: 
6171: 0000: 
6172: 0000:   FUNCTION WRITE.HOLD.CCITM EXTERNAL
6173: 0000:     INTEGER*2 WRITE.HOLD.CCITM
6174: 0000:   END FUNCTION
6175: 0000: 
6176: 0000: 
6177: 0000:   FUNCTION WRITE.UNLOCK.CCITM EXTERNAL
6178: 0000:     INTEGER*2 WRITE.UNLOCK.CCITM
6179: 0000:   END FUNCTION
6180: 0000: 
6181: 0000: 
6182: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCITM EXTERNAL
6183: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCITM
6184: 0000:   END FUNCTION
6185: 0000: 
6186: 0000: 
6187: 0000:   FUNCTION WRITE.CCITM EXTERNAL
6188: 0000:     INTEGER*2 WRITE.CCITM
6189: 0000:   END FUNCTION
6190: 0000: 
6191: 0000:  %INCLUDE CCTRLEXT.J86                    ! GMJK
6192: 0000: 
6193: 0000: \*****************************************************************************
6194: 0000: \*****************************************************************************
6195: 0000: \***
6196: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6197: 0000: \***
6198: 0000: \***                   FILE TYPE:  DIRECT
6199: 0000: \***
6200: 0000: \***                   REFERENCE:  CCTRLEXT.J86
6201: 0000: \***
6202: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6203: 0000: \***				   CREDIT CLAIMS CONTROL FILE
6204: 0000: \***
6205: 0000: \***
6206: 0000: \***      VERSION A : Michael J. Kelsall      14th September 1993
6207: 0000: \***      
6208: 0000: \*****************************************************************************
6209: 0000: \*****************************************************************************
6210: 0000: 
6211: 0000: 
6212: 0000:   FUNCTION CCTRL.SET EXTERNAL
6213: 0000:      INTEGER*2 CCTRL.SET
6214: 0000:   END FUNCTION
6215: 0000: 
6216: 0000: 
6217: 0000:   FUNCTION READ.CCTRL EXTERNAL
6218: 0000:     INTEGER*2 READ.CCTRL
6219: 0000:   END FUNCTION
6220: 0000:   
6221: 0000: 
6222: 0000:   FUNCTION READ.CCTRL.LOCKED EXTERNAL
6223: 0000:     INTEGER*2 READ.CCTRL.LOCKED
6224: 0000:   END FUNCTION  
6225: 0000: 
6226: 0000: 
6227: 0000:   FUNCTION WRITE.HOLD.CCTRL EXTERNAL
6228: 0000:     INTEGER*2 WRITE.HOLD.CCTRL
6229: 0000:   END FUNCTION
6230: 0000: 
6231: 0000: 
6232: 0000:   FUNCTION WRITE.UNLOCK.CCTRL EXTERNAL
6233: 0000:     INTEGER*2 WRITE.UNLOCK.CCTRL
6234: 0000:   END FUNCTION
6235: 0000: 
6236: 0000: 
6237: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCTRL EXTERNAL
6238: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCTRL
6239: 0000:   END FUNCTION
6240: 0000:   
6241: 0000: 
6242: 0000:   FUNCTION WRITE.CCTRL EXTERNAL
6243: 0000:     INTEGER*2 WRITE.CCTRL
6244: 0000:   END FUNCTION
6245: 0000: 
6246: 0000:  %INCLUDE CCTMPEXT.J86                    ! GMJK
6247: 0000: \*******************************************************************************
6248: 0000: \*******************************************************************************
6249: 0000: \***
6250: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6251: 0000: \***
6252: 0000: \***                    REFERENCE    : CCTMPEXT.BAS
6253: 0000: \***
6254: 0000: \***    Version A.         Michael Kelsall              30th September 1993
6255: 0000: \***
6256: 0000: \*******************************************************************************
6257: 0000: \*******************************************************************************
6258: 0000: 
6259: 0000:  
6260: 0000:   FUNCTION CCTMP.SET EXTERNAL
6261: 0000:       INTEGER*2 CCTMP.SET
6262: 0000:   END FUNCTION
6263: 0000: 
6264: 0000: 
6265: 0000:   FUNCTION READ.CCTMP EXTERNAL
6266: 0000:       INTEGER*2 READ.CCTMP 
6267: 0000:   END FUNCTION
6268: 0000: 
6269: 0000:   
6270: 0000:   FUNCTION WRITE.CCTMP EXTERNAL
6271: 0000:       INTEGER*2 WRITE.CCTMP
6272: 0000:   END FUNCTION
6273: 0000: 
6274: 0000:   
6275: 0000:   FUNCTION WRITE.HOLD.CCTMP EXTERNAL
6276: 0000:       INTEGER*2 WRITE.HOLD.CCTMP						
6277: 0000:   END FUNCTION								
6278: 0000: 
6279: 0000:  %INCLUDE CCBUFEXT.J86                    ! GMJK
6280: 0000: \*******************************************************************************
6281: 0000: \*******************************************************************************
6282: 0000: \***
6283: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6284: 0000: \***
6285: 0000: \***                    REFERENCE    : CCBUFEXT.BAS
6286: 0000: \***
6287: 0000: \***    Version A.         Michael Kelsall              30th September 1993
6288: 0000: \***
6289: 0000: \*******************************************************************************
6290: 0000: \*******************************************************************************
6291: 0000: 
6292: 0000:  
6293: 0000:   FUNCTION CCBUF.SET EXTERNAL
6294: 0000:       INTEGER*2 CCBUF.SET
6295: 0000:   END FUNCTION
6296: 0000: 
6297: 0000: 
6298: 0000:   FUNCTION READ.CCBUF EXTERNAL
6299: 0000:       INTEGER*2 READ.CCBUF 
6300: 0000:   END FUNCTION
6301: 0000: 
6302: 0000:   
6303: 0000:   FUNCTION WRITE.CCBUF EXTERNAL
6304: 0000:       INTEGER*2 WRITE.CCBUF
6305: 0000:   END FUNCTION
6306: 0000: 
6307: 0000:   
6308: 0000:   FUNCTION WRITE.HOLD.CCBUF EXTERNAL
6309: 0000:       INTEGER*2 WRITE.HOLD.CCBUF						
6310: 0000:   END FUNCTION								
6311: 0000: 
6312: 0000:  %INCLUDE CCUPFEXT.J86                    ! HMJK
6313: 0000: 
6314: 0000: \*****************************************************************************
6315: 0000: \*****************************************************************************
6316: 0000: \***
6317: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6318: 0000: \***
6319: 0000: \***                   FILE TYPE:  KEYED
6320: 0000: \***
6321: 0000: \***                   REFERENCE:  CCUPFEXT.J86
6322: 0000: \***
6323: 0000: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6324: 0000: \***				   UOD PROCESSED FILE 
6325: 0000: \***
6326: 0000: \***      VERSION A : Michael J. Kelsall      14th March 1994
6327: 0000: \***      
6328: 0000: \*****************************************************************************
6329: 0000: \*****************************************************************************
6330: 0000: 
6331: 0000: 
6332: 0000:   FUNCTION CCUPF.SET EXTERNAL
6333: 0000:      INTEGER*2 CCUPF.SET
6334: 0000:   END FUNCTION
6335: 0000: 
6336: 0000: 
6337: 0000:   FUNCTION READ.CCUPF EXTERNAL
6338: 0000:     INTEGER*2 READ.CCUPF
6339: 0000:   END FUNCTION
6340: 0000:   
6341: 0000: 
6342: 0000:   FUNCTION READ.CCUPF.LOCKED EXTERNAL
6343: 0000:     INTEGER*2 READ.CCUPF.LOCKED
6344: 0000:   END FUNCTION  
6345: 0000: 
6346: 0000: 
6347: 0000:   FUNCTION WRITE.HOLD.CCUPF EXTERNAL
6348: 0000:     INTEGER*2 WRITE.HOLD.CCUPF
6349: 0000:   END FUNCTION
6350: 0000: 
6351: 0000: 
6352: 0000:   FUNCTION WRITE.UNLOCK.CCUPF EXTERNAL
6353: 0000:     INTEGER*2 WRITE.UNLOCK.CCUPF
6354: 0000:   END FUNCTION
6355: 0000: 
6356: 0000: 
6357: 0000:   FUNCTION WRITE.HOLD.UNLOCK.CCUPF EXTERNAL
6358: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUPF
6359: 0000:   END FUNCTION
6360: 0000: 
6361: 0000: 
6362: 0000:   FUNCTION WRITE.CCUPF EXTERNAL
6363: 0000:     INTEGER*2 WRITE.CCUPF
6364: 0000:   END FUNCTION
6365: 0000: 
6366: 0000:  %INCLUDE CCWKFEXT.J86                    ! GMJK
6367: 0000: \*****************************************************************************
6368: 0000: \*****************************************************************************
6369: 0000: \***
6370: 0000: \***       EXTERNAL FUNCTION DEFINTIONS FOR CCWKF - RETURNS WORK FILE
6371: 0000: \***
6372: 0000: \***                      REFERENCE: CCWKFEXT.J86
6373: 0000: \***
6374: 0000: \***    Version A          Michael J. Kelsall            30th September 1993
6375: 0000: \***
6376: 0000: \*****************************************************************************
6377: 0000: \*****************************************************************************
6378: 0000: 
6379: 0000:    FUNCTION CCWKF.SET EXTERNAL
6380: 0000:       INTEGER*2 CCWKF.SET
6381: 0000:    END FUNCTION
6382: 0000:    
6383: 0000:    FUNCTION READ.CCWKF EXTERNAL
6384: 0000:       INTEGER*2 READ.CCWKF
6385: 0000:    END FUNCTION
6386: 0000:    
6387: 0000:    FUNCTION WRITE.CCWKF EXTERNAL
6388: 0000:       INTEGER*2 WRITE.CCWKF
6389: 0000:    END FUNCTION
6390: 0000:    
6391: 0000:  %INCLUDE CCDMYEXT.J86                    ! GMJK
6392: 0000: \*****************************************************************************
6393: 0000: \*****************************************************************************
6394: 0000: \***
6395: 0000: \***        EXTERNAL FUNCTION DEFINITIONS FOR RETURNS DUMMY FILE
6396: 0000: \***
6397: 0000: \***                      REFERENCE: CCDMYEXT.J86
6398: 0000: \***
6399: 0000: \***    Version A       Michael J. Kelsall             30th September 1993
6400: 0000: \***
6401: 0000: \*****************************************************************************
6402: 0000: \*****************************************************************************
6403: 0000: 
6404: 0000:    FUNCTION CCDMY.SET EXTERNAL
6405: 0000:       INTEGER*2 CCDMY.SET
6406: 0000:    END FUNCTION
6407: 0000:    
6408: 0000:    
6409: 0000:  %INCLUDE LDTAFEXT.J86                    ! HMJK
6410: 0000: 
6411: 0000: \*****************************************************************************
6412: 0000: \*****************************************************************************
6413: 0000: \***
6414: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6415: 0000: \***
6416: 0000: \***                   FILE TYPE:  DIRECT
6417: 0000: \***
6418: 0000: \***                   REFERENCE:  LDTAFEXT.J86
6419: 0000: \***
6420: 0000: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
6421: 0000: \***
6422: 0000: \***
6423: 0000: \***      VERSION A        Michael J. Kelsall        30th September 1993
6424: 0000: \*** 
6425: 0000: \***      VERSION B        Michael J. Kelsall        25th March 1994
6426: 0000: \***      No change to external definitions.
6427: 0000: \***      
6428: 0000: \*****************************************************************************
6429: 0000: \*****************************************************************************
6430: 0000: 
6431: 0000: 
6432: 0000:   FUNCTION LDTAF.SET EXTERNAL
6433: 0000:      INTEGER*2 LDTAF.SET
6434: 0000:   END FUNCTION
6435: 0000: 
6436: 0000: 
6437: 0000:   FUNCTION READ.LDTAF EXTERNAL
6438: 0000:     INTEGER*2 READ.LDTAF
6439: 0000:   END FUNCTION
6440: 0000:   
6441: 0000: 
6442: 0000:   FUNCTION WRITE.HOLD.LDTAF EXTERNAL
6443: 0000:     INTEGER*2 WRITE.HOLD.LDTAF
6444: 0000:   END FUNCTION
6445: 0000: 
6446: 0000: 
6447: 0000:   FUNCTION WRITE.LDTAF EXTERNAL
6448: 0000:     INTEGER*2 WRITE.LDTAF
6449: 0000:   END FUNCTION
6450: 0000: 
6451: 0000:  %INCLUDE SOFTSEXT.J86                    ! GMJK
6452: 0000: \*******************************************************************************
6453: 0000: \***                                                                         ***
6454: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE SOFTWARE STATUS FILE         ***
6455: 0000: \***                                                                         ***
6456: 0000: \***                     REFERENCE : SOFTSEXT.J86                            ***
6457: 0000: \***                                                                         ***
6458: 0000: \***      Version A         Andrew Wedgeworth          1st July 1992         ***
6459: 0000: \***
6460: 0000: \***   Version B
6461: 0000: \***                                                                      ***
6462: 0000: \***      Version C         Steve Wright               3rd May 1996          ***
6463: 0000: \***      Synchronise with function source.                                  ***
6464: 0000: \*******************************************************************************
6465: 0000: 
6466: 0000:       FUNCTION SOFTS.SET EXTERNAL 
6467: 0000:       END FUNCTION
6468: 0000:       
6469: 0000:       FUNCTION READ.SOFTS EXTERNAL
6470: 0000:           INTEGER*2 I%, READ.SOFTS
6471: 0000:       END FUNCTION	                   
6472: 0000: 
6473: 0000:       FUNCTION WRITE.SOFTS EXTERNAL
6474: 0000:           INTEGER*2 I%, WRITE.SOFTS
6475: 0000:       END FUNCTION
6476: 0000: 
6477: 0000: 
6478: 0000:  %INCLUDE STKBFEXT.J86                    ! 1.5
6479: 0000: \******************************************************************************
6480: 0000: \******************************************************************************
6481: 0000: \***
6482: 0000: \***   $Workfile:   STKBFEXT.J86  $
6483: 0000: \***
6484: 0000: \***   $Revision:   1.0  $
6485: 0000: \***
6486: 0000: \******************************************************************************
6487: 0000: \******************************************************************************
6488: 0000: \***
6489: 0000: \***   $Log:   V:\archive\j86\stkbfext.j8v  $
6490: 0000: \***   
6491: 0000: \***      Rev 1.0   15 Jul 1997 14:20:38   DEV45PS
6492: 0000: \***    
6493: 0000: \***   
6494: 0000: \***      Rev 1.0   09 Jul 1997 11:04:54   DEV45PS
6495: 0000: \***   Stocktake System New Files
6496: 0000: \***   
6497: 0000: \******************************************************************************
6498: 0000: \******************************************************************************\*****************************************************************************
6499: 0000: \***
6500: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE BUFFER FILE
6501: 0000: \***
6502: 0000: \***           REFERENCE:   STKBFEXT.J86
6503: 0000: \***
6504: 0000: \***           VERSION A         Nik Sen         19th June 1997
6505: 0000: \***
6506: 0000: \***
6507: 0000: \*******************************************************************************
6508: 0000: \*******************************************************************************
6509: 0000: 
6510: 0000:    FUNCTION STKBF.SET EXTERNAL
6511: 0000:    END FUNCTION
6512: 0000:    
6513: 0000:    FUNCTION READ.STKBF EXTERNAL
6514: 0000:       INTEGER*2 READ.STKBF
6515: 0000:    END FUNCTION
6516: 0000:    
6517: 0000:    FUNCTION WRITE.STKBF EXTERNAL
6518: 0000:       INTEGER*2 WRITE.STKBF
6519: 0000:    END FUNCTION
6520: 0000:  
6521: 0000:  %INCLUDE SXTMPEXT.J86                    ! 1.5
6522: 0000: \*****************************************************************************
6523: 0000: \***
6524: 0000: \***           FUNCTION DEFINITIONS FOR THE TEMPORARY STOCKTAKE BUFFER FILE
6525: 0000: \***
6526: 0000: \***           REFERENCE:   STKBFEXT.J86
6527: 0000: \***
6528: 0000: \***           VERSION A         Nik Sen         30th June 1997
6529: 0000: \***
6530: 0000: \***
6531: 0000: \*******************************************************************************
6532: 0000: \*******************************************************************************
6533: 0000: 
6534: 0000:    FUNCTION SXTMP.SET EXTERNAL
6535: 0000:    END FUNCTION
6536: 0000:    
6537: 0000:    FUNCTION READ.SXTMP EXTERNAL
6538: 0000:       INTEGER*2 READ.SXTMP
6539: 0000:    END FUNCTION
6540: 0000:    
6541: 0000:    FUNCTION WRITE.SXTMP EXTERNAL
6542: 0000:       INTEGER*2 WRITE.SXTMP
6543: 0000:    END FUNCTION
6544: 0000:  
6545: 0000:  %INCLUDE STKTKEXT.J86                    ! 1.5
6546: 0000: \*****************************************************************************
6547: 0000: \*****************************************************************************
6548: 0000: \***
6549: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCKTAKE
6550: 0000: \***
6551: 0000: \***      REFERENCE: STKTKEXT.J86
6552: 0000: \***
6553: 0000: \*****************************************************************************
6554: 0000: \*****************************************************************************
6555: 0000: 
6556: 0000: 
6557: 0000:    FUNCTION STKTK.SET EXTERNAL
6558: 0000:    END FUNCTION
6559: 0000:    
6560: 0000:  %INCLUDE STLDTEXT.J86                    ! 1.6
6561: 0000: \*****************************************************************************
6562: 0000: \*****************************************************************************
6563: 0000: \***
6564: 0000: \***                   FUNCTION DEFINITIONS FOR THE STLDT
6565: 0000: \***
6566: 0000: \***           Version A           David Artiss         20th December 2000
6567: 0000: \***
6568: 0000: \*****************************************************************************
6569: 0000: \*****************************************************************************
6570: 0000: 
6571: 0000:    FUNCTION STLDT.SET EXTERNAL
6572: 0000:    END FUNCTION
6573: 0000: 
6574: 0000:   FUNCTION READ.STLDT EXTERNAL
6575: 0000:    INTEGER*2 READ.STLDT
6576: 0000:   END FUNCTION
6577: 0000: 
6578: 0000:   FUNCTION WRITE.STLDT EXTERNAL
6579: 0000:    INTEGER*2 WRITE.STLDT
6580: 0000:   END FUNCTION
6581: 0000:  %INCLUDE SXTCFEXT.J86                    ! 1.8DA
6582: 0000: \******************************************************************************
6583: 0000: \******************************************************************************
6584: 0000: \***
6585: 0000: \***   $Workfile:   SXTCFEXT.J86  $
6586: 0000: \***
6587: 0000: \***   $Revision:   1.0  $
6588: 0000: \***
6589: 0000: \******************************************************************************
6590: 0000: \******************************************************************************
6591: 0000: \***
6592: 0000: \***   $Log:   V:\archive\j86\sxtcfext.j8v  $
6593: 0000: \***   
6594: 0000: \***      Rev 1.0   15 Jul 1997 14:21:08   DEV45PS
6595: 0000: \***    
6596: 0000: \***   
6597: 0000: \***      Rev 1.0   09 Jul 1997 11:05:30   DEV45PS
6598: 0000: \***   Stocktake System New Files
6599: 0000: \***   
6600: 0000: \******************************************************************************
6601: 0000: \******************************************************************************\*****************************************************************************
6602: 0000: \*****************************************************************************
6603: 0000: \***
6604: 0000: \***                  FUNCTION DEFINITIONS FOR SXTCF
6605: 0000: \***
6606: 0000: \***                      REFERENCE    : SXTCFEXA
6607: 0000: \***
6608: 0000: \***           VERSION A : NIK SEN  3rd July 1997
6609: 0000: \***
6610: 0000: \*****************************************************************************
6611: 0000: \*****************************************************************************
6612: 0000: 
6613: 0000:    FUNCTION SXTCF.SET EXTERNAL
6614: 0000:    END FUNCTION
6615: 0000: 
6616: 0000:   FUNCTION READ.SXTCF.LOCK EXTERNAL
6617: 0000:    INTEGER*1 READ.SXTCF.LOCK
6618: 0000:   END FUNCTION
6619: 0000: 
6620: 0000:   FUNCTION WRITE.SXTCF.UNLOCK EXTERNAL
6621: 0000:    INTEGER*1 WRITE.SXTCF.UNLOCK
6622: 0000:   END FUNCTION
6623: 0000: 
6624: 0000:   FUNCTION WRITE.SXTCF.UNLOCK.HOLD EXTERNAL
6625: 0000:    INTEGER*1 WRITE.SXTCF.UNLOCK.HOLD
6626: 0000:   END FUNCTION
6627: 0000: 
6628: 0000:   FUNCTION READ.SXTCF EXTERNAL
6629: 0000:    INTEGER*1 READ.SXTCF
6630: 0000:   END FUNCTION
6631: 0000: 
6632: 0000:   FUNCTION WRITE.SXTCF         EXTERNAL
6633: 0000:    INTEGER*1 WRITE.SXTCF        
6634: 0000:   END FUNCTION
6635: 0000: 
6636: 0000:  %INCLUDE STKCFEXT.J86                    ! 1.8DA
6637: 0000: \*****************************************************************************
6638: 0000: \*****************************************************************************
6639: 0000: \***
6640: 0000: \***                  FUNCTION DEFINITIONS FOR STKCF
6641: 0000: \***
6642: 0000: \***                      REFERENCE    : STKCFEXA
6643: 0000: \***
6644: 0000: \***           VERSION A : STEVEN GOULDING  11.01.93
6645: 0000: \***
6646: 0000: \*****************************************************************************
6647: 0000: \*****************************************************************************
6648: 0000: 
6649: 0000:    FUNCTION STKCF.SET EXTERNAL
6650: 0000:    END FUNCTION
6651: 0000: 
6652: 0000:   FUNCTION READ.STKCF.LOCK EXTERNAL
6653: 0000:    INTEGER*1 READ.STKCF.LOCK
6654: 0000:   END FUNCTION
6655: 0000: 
6656: 0000:   FUNCTION WRITE.STKCF.UNLOCK EXTERNAL
6657: 0000:    INTEGER*1 WRITE.STKCF.UNLOCK
6658: 0000:   END FUNCTION
6659: 0000: 
6660: 0000:   FUNCTION WRITE.STKCF.UNLOCK.HOLD EXTERNAL
6661: 0000:    INTEGER*1 WRITE.STKCF.UNLOCK.HOLD
6662: 0000:   END FUNCTION
6663: 0000: 
6664: 0000:   FUNCTION READ.STKCF EXTERNAL
6665: 0000:    INTEGER*1 READ.STKCF
6666: 0000:   END FUNCTION
6667: 0000: 
6668: 0000:   FUNCTION WRITE.STKCF         EXTERNAL
6669: 0000:    INTEGER*1 WRITE.STKCF        
6670: 0000:   END FUNCTION
6671: 0000: 
6672: 0000:  %INCLUDE STKMFEXT.J86                    ! 1.8DA
6673: 0000: \******************************************************************************
6674: 0000: \******************************************************************************
6675: 0000: \***
6676: 0000: \***   $Workfile:   STKMFEXT.J86  $
6677: 0000: \***
6678: 0000: \***   $Revision:   1.0  $
6679: 0000: \***
6680: 0000: \******************************************************************************
6681: 0000: \******************************************************************************
6682: 0000: \***
6683: 0000: \***   $Log:   V:\archive\j86\stkmfext.j8v  $
6684: 0000: \***   
6685: 0000: \***      Rev 1.0   15 Jul 1997 14:20:56   DEV45PS
6686: 0000: \***    
6687: 0000: \***   
6688: 0000: \***      Rev 1.0   09 Jul 1997 11:05:18   DEV45PS
6689: 0000: \***   Stocktake System New Files
6690: 0000: \***   
6691: 0000: \******************************************************************************
6692: 0000: \******************************************************************************\*****************************************************************************
6693: 0000: \***
6694: 0000: \***  FUNCTION DEFINITIONS FOR THE STOCKTAKE MAINFRAME TRANSMISSION FILE
6695: 0000: \***
6696: 0000: \***           REFERENCE:   STKMFEXT.J86
6697: 0000: \***
6698: 0000: \***           VERSION A         Nik Sen         19th June 1997
6699: 0000: \***
6700: 0000: \***
6701: 0000: \*******************************************************************************
6702: 0000: \*******************************************************************************
6703: 0000: 
6704: 0000:    FUNCTION STKMF.SET EXTERNAL
6705: 0000:    END FUNCTION
6706: 0000:    
6707: 0000:    FUNCTION READ.STKMF EXTERNAL
6708: 0000:       INTEGER*2 READ.STKMF
6709: 0000:    END FUNCTION
6710: 0000:    
6711: 0000:    FUNCTION WRITE.STKMF EXTERNAL
6712: 0000:       INTEGER*2 WRITE.STKMF
6713: 0000:    END FUNCTION
6714: 0000:  
6715: 0000:  %INCLUDE STKRCEXT.J86                    ! 1.8DA
6716: 0000: \******************************************************************************
6717: 0000: \******************************************************************************
6718: 0000: \***
6719: 0000: \***   $Workfile:   STKRCEXT.J86  $
6720: 0000: \***
6721: 0000: \***   $Revision:   1.0  $
6722: 0000: \***
6723: 0000: \******************************************************************************
6724: 0000: \******************************************************************************
6725: 0000: \***
6726: 0000: \***   $Log:   V:\archive\j86\stkrcext.j8v  $
6727: 0000: \***   
6728: 0000: \***      Rev 1.0   15 Jul 1997 14:21:00   DEV45PS
6729: 0000: \***    
6730: 0000: \***   
6731: 0000: \***      Rev 1.0   09 Jul 1997 11:05:24   DEV45PS
6732: 0000: \***   Stocktake System New Files
6733: 0000: \***   
6734: 0000: \******************************************************************************
6735: 0000: \******************************************************************************\*****************************************************************************
6736: 0000: \***
6737: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE RECOUNT FILE
6738: 0000: \***
6739: 0000: \***           REFERENCE:   STKRCEXT.J86
6740: 0000: \***
6741: 0000: \***           VERSION A         Nik Sen         19th June 1997
6742: 0000: \***
6743: 0000: \***
6744: 0000: \*******************************************************************************
6745: 0000: \*******************************************************************************
6746: 0000: 
6747: 0000:    FUNCTION STKRC.SET EXTERNAL
6748: 0000:    END FUNCTION
6749: 0000:    
6750: 0000:    FUNCTION READ.STKRC EXTERNAL
6751: 0000:       INTEGER*2 READ.STKRC
6752: 0000:    END FUNCTION
6753: 0000:    
6754: 0000:    FUNCTION WRITE.STKRC EXTERNAL
6755: 0000:       INTEGER*2 WRITE.STKRC
6756: 0000:    END FUNCTION
6757: 0000:  
6758: 0000:  %INCLUDE XGCFEXT.J86                     ! 1.8DA
6759: 0000: \******************************************************************************
6760: 0000: \******************************************************************************
6761: 0000: \***
6762: 0000: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
6763: 0000: \***
6764: 0000: \***                  FILE TYPE    : Keyed
6765: 0000: \***
6766: 0000: \***                  REFERENCE    : XGCFEXT.J86
6767: 0000: \***
6768: 0000: \***    VERSION A               Steve Wright                        24 Aug 1999
6769: 0000: \***
6770: 0000: \*******************************************************************************
6771: 0000: \*******************************************************************************
6772: 0000: 
6773: 0000: FUNCTION XGCF.SET EXTERNAL
6774: 0000: END FUNCTION
6775: 0000: 
6776: 0000: FUNCTION READ.XGCF EXTERNAL
6777: 0000:    INTEGER*2 READ.XGCF
6778: 0000: END FUNCTION
6779: 0000: 
6780: 0000: FUNCTION READ.XGCF.LOCK EXTERNAL
6781: 0000:    INTEGER*2 READ.XGCF.LOCK
6782: 0000: END FUNCTION
6783: 0000: 
6784: 0000: FUNCTION WRITE.XGCF EXTERNAL
6785: 0000:    INTEGER*2 WRITE.XGCF
6786: 0000: END FUNCTION
6787: 0000: 
6788: 0000: FUNCTION WRITE.XGCF.HOLD EXTERNAL
6789: 0000:    INTEGER*2 WRITE.XGCF.HOLD
6790: 0000: END FUNCTION
6791: 0000: 
6792: 0000: FUNCTION WRITE.XGCF.UNLOCK EXTERNAL
6793: 0000:    INTEGER*2 WRITE.XGCF.UNLOCK
6794: 0000: END FUNCTION
6795: 0000: 
6796: 0000:  %INCLUDE STKEXEXT.J86                    ! 1.8DA
6797: 0000: \******************************************************************************
6798: 0000: \******************************************************************************
6799: 0000: \***
6800: 0000: \***   $Workfile:   STKEXEXT.J86  $
6801: 0000: \***
6802: 0000: \***   $Revision:   1.0  $
6803: 0000: \***
6804: 0000: \******************************************************************************
6805: 0000: \******************************************************************************
6806: 0000: \***
6807: 0000: \***   $Log:   V:\archive\j86\stkexext.j8v  $
6808: 0000: \***   
6809: 0000: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
6810: 0000: \***    
6811: 0000: \***   
6812: 0000: \***      Rev 1.0   09 Jul 1997 11:05:06   DEV45PS
6813: 0000: \***   Stocktake System New Files
6814: 0000: \***   
6815: 0000: \******************************************************************************
6816: 0000: \******************************************************************************\*****************************************************************************
6817: 0000: \***
6818: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE EXCEPTIONS FILE
6819: 0000: \***
6820: 0000: \***           REFERENCE:   STKEXEXT.J86
6821: 0000: \***
6822: 0000: \***           VERSION A         Nik Sen         19th June 1997
6823: 0000: \***
6824: 0000: \***
6825: 0000: \*******************************************************************************
6826: 0000: \*******************************************************************************
6827: 0000: 
6828: 0000:    FUNCTION STKEX.SET EXTERNAL
6829: 0000:    END FUNCTION
6830: 0000:    
6831: 0000:    FUNCTION READ.STKEX EXTERNAL
6832: 0000:       INTEGER*2 READ.STKEX
6833: 0000:    END FUNCTION
6834: 0000:    
6835: 0000:    FUNCTION WRITE.STKEX EXTERNAL
6836: 0000:       INTEGER*2 WRITE.STKEX
6837: 0000:    END FUNCTION
6838: 0000:  
6839: 0000:  %INCLUDE STKIFEXT.J86                    ! 1.8DA
6840: 0000: \******************************************************************************
6841: 0000: \******************************************************************************
6842: 0000: \***
6843: 0000: \***   $Workfile:   STKIFEXT.J86  $
6844: 0000: \***
6845: 0000: \***   $Revision:   1.0  $
6846: 0000: \***
6847: 0000: \******************************************************************************
6848: 0000: \******************************************************************************
6849: 0000: \***
6850: 0000: \***   $Log:   V:\archive\j86\stkifext.j8v  $
6851: 0000: \***   
6852: 0000: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
6853: 0000: \***    
6854: 0000: \***   
6855: 0000: \***      Rev 1.0   09 Jul 1997 11:05:12   DEV45PS
6856: 0000: \***   Stocktake System New Files
6857: 0000: \***   
6858: 0000: \******************************************************************************
6859: 0000: \******************************************************************************\*****************************************************************************
6860: 0000: \***
6861: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM FILE
6862: 0000: \***
6863: 0000: \***           REFERENCE:   STKIFEXT.J86
6864: 0000: \***
6865: 0000: \***           VERSION A         Nik Sen         19th June 1997
6866: 0000: \***
6867: 0000: \***
6868: 0000: \*******************************************************************************
6869: 0000: \*******************************************************************************
6870: 0000: 
6871: 0000:    FUNCTION STKIF.SET EXTERNAL
6872: 0000:    END FUNCTION
6873: 0000:    
6874: 0000:    FUNCTION READ.STKIF EXTERNAL
6875: 0000:       INTEGER*2 READ.STKIF
6876: 0000:    END FUNCTION
6877: 0000:    
6878: 0000:    FUNCTION WRITE.STKIF EXTERNAL
6879: 0000:       INTEGER*2 WRITE.STKIF
6880: 0000:    END FUNCTION
6881: 0000:  
6882: 0000:  %INCLUDE LOCNTEXT.J86                    ! 1.8DA
6883: 0000: \******************************************************************************
6884: 0000: \******************************************************************************
6885: 0000: \***
6886: 0000: \***   $Workfile:   LOCNTEXT.J86  $
6887: 0000: \***
6888: 0000: \***   $Revision:   1.0  $
6889: 0000: \***
6890: 0000: \******************************************************************************
6891: 0000: \******************************************************************************
6892: 0000: \***
6893: 0000: \***   $Log:   V:\archive\j86\locntext.j8v  $
6894: 0000: \***   
6895: 0000: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
6896: 0000: \***    
6897: 0000: \***   
6898: 0000: \******************************************************************************
6899: 0000: \******************************************************************************
6900: 0000: \***
6901: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE LOCATION COUNT FILE
6902: 0000: \***
6903: 0000: \***           REFERENCE:   LOCNTEXT.J86
6904: 0000: \***
6905: 0000: \***           VERSION A         Johnnie Chan    6th Jan 1998
6906: 0000: \***
6907: 0000: \***
6908: 0000: \*******************************************************************************
6909: 0000: \*******************************************************************************
6910: 0000: 
6911: 0000:    FUNCTION LOCCNT.SET EXTERNAL
6912: 0000:    END FUNCTION
6913: 0000:    
6914: 0000:    FUNCTION READ.LOCCNT EXTERNAL
6915: 0000:       INTEGER*2 READ.LOCCNT
6916: 0000:    END FUNCTION
6917: 0000:    
6918: 0000:    FUNCTION WRITE.LOCCNT EXTERNAL
6919: 0000:       INTEGER*2 WRITE.LOCCNT
6920: 0000:    END FUNCTION
6921: 0000: 
6922: 0000:    FUNCTION GET.LOCCNT.RECNUM(LOC.CODE$) EXTERNAL
6923: 0000:       INTEGER*4 GET.LOCCNT.RECNUM
6924: 0000:       STRING LOC.CODE$
6925: 0000:    END FUNCTION
6926: 0000:  
6927: 0000:  %INCLUDE STKIGEXT.J86                    ! 1.8DA
6928: 0000: \*****************************************************************************
6929: 0000: \***
6930: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM GROUP FILE
6931: 0000: \***
6932: 0000: \***           REFERENCE:   STKIGEXT.J86
6933: 0000: \***
6934: 0000: \***           VERSION A         Nik Sen         17th June 1997
6935: 0000: \***
6936: 0000: \***
6937: 0000: \*******************************************************************************
6938: 0000: \*******************************************************************************
6939: 0000: 
6940: 0000:    FUNCTION STKIG.SET EXTERNAL
6941: 0000:    END FUNCTION
6942: 0000:    
6943: 0000:    FUNCTION READ.STKIG EXTERNAL
6944: 0000:       INTEGER*2 READ.STKIG
6945: 0000:    END FUNCTION
6946: 0000:    
6947: 0000:    FUNCTION WRITE.STKIG EXTERNAL
6948: 0000:       INTEGER*2 WRITE.STKIG
6949: 0000:    END FUNCTION
6950: 0000:  
6951: 0000:  %INCLUDE STKTFEXT.J86                    ! 1.8DA
6952: 0000: \******************************************************************************
6953: 0000: \******************************************************************************
6954: 0000: \***
6955: 0000: \***   $Workfile:   STKTFEXT.J86  $
6956: 0000: \***
6957: 0000: \***   $Revision:   1.1  $
6958: 0000: \***
6959: 0000: \******************************************************************************
6960: 0000: \******************************************************************************
6961: 0000: \***
6962: 0000: \***   $Log:   V:\archive\j86\stktfext.j8v  $
6963: 0000: \***   
6964: 0000: \***      Rev 1.1   15 Jul 1997 14:36:30   DEV45PS
6965: 0000: \***    
6966: 0000: \***   
6967: 0000: \***      Rev 1.0   15 Jul 1997 14:21:04   DEV45PS
6968: 0000: \***   Stocktake System New Files
6969: 0000: \***   
6970: 0000: \******************************************************************************
6971: 0000: \******************************************************************************\*****************************************************************************
6972: 0000: \***
6973: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE TOTALS FILE
6974: 0000: \***
6975: 0000: \***           REFERENCE:   STKTFEXT.J86
6976: 0000: \***
6977: 0000: \***           VERSION A         Nik Sen         15th July 1997
6978: 0000: \***
6979: 0000: \***
6980: 0000: \*******************************************************************************
6981: 0000: \*******************************************************************************
6982: 0000: 
6983: 0000:    FUNCTION STKTF.SET EXTERNAL
6984: 0000:    END FUNCTION
6985: 0000:    
6986: 0000:    FUNCTION READ.STKTF EXTERNAL
6987: 0000:       INTEGER*2 READ.STKTF
6988: 0000:    END FUNCTION
6989: 0000:    
6990: 0000:    FUNCTION WRITE.STKTF EXTERNAL
6991: 0000:       INTEGER*2 WRITE.STKTF
6992: 0000:    END FUNCTION
6993: 0000:  
6994: 0000:  %INCLUDE IRFEXT.J86                      ! 1.8DA
6995: 0000: \*********************************************************************************
6996: 0000: \***
6997: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM REFERENCE FILE
6998: 0000: \***
6999: 0000: \***                    REFERENCE : IRFEXT.J86
7000: 0000: \***
7001: 0000: \***      Version A          Andrew Wedgeworth        9th July 1992
7002: 0000: \***
7003: 0000: \***      Version B          Andrew Wedgeworth        14th December 1992
7004: 0000: \***      Version letter incremented to match other IRF code.
7005: 0000: \***
7006: 0000: \***      Version C           Steve Windsor        12.02.93
7007: 0000: \***      Added external reference to read the alternate IRF.
7008: 0000: \***
7009: 0000: \***      Version D           Steve Windsor        12.05.93
7010: 0000: \***      Added all external references that wre in the original FNS.
7011: 0000: \***
7012: 0000: \***      Version E           Steve Perkins        21.09.93
7013: 0000: \***      Deals project: Fields changed for new deals project
7014: 0000: \*** 
7015: 0000: \***      Version F           Mark Walker          5th January 1994
7016: 0000: \***      Version letter incremented to match other IRF code.           
7017: 0000: \***                                                                    
7018: 0000: \***      Version G     Stuart William McConnachie      11th February 2000
7019: 0000: \***      Converted IRF.INDICAT2$ to integer flag byte.
7020: 0000: \***
7021: 0000: \***      REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
7022: 0000: \***      Major changes to IRF layout for 2002 Deals Rewrite project.
7023: 0000: \***      No changes to this particular file for this revision.
7024: 0000: \***
7025: 0000: \***      REVISION 1.7.               ROBERT COWEY.               5 AUG 2002.
7026: 0000: \***      Further changes for 2002 Deals Rewrite project (PSBF19 related).
7027: 0000: \***      Defined new functions CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
7028: 0000: \***
7029: 0000: \***      REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
7030: 0000: \***      Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
7031: 0000: \***      No changes to this file other than description.
7032: 0000: \***      No changes to IRF file functions.
7033: 0000: \***
7034: 0000: \***      REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
7035: 0000: \***      Changes to remove limit of 3 deals per item.
7036: 0000: \***      No changes to this file.
7037: 0000: \***
7038: 0000: \***      REVISION 2.0.             ALAN CARR                      9 FEB 2006.
7039: 0000: \***      Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
7040: 0000: \***      No changes to this file.
7041: 0000: \***
7042: 0000: \***..............................................................................
7043: 0000:    
7044: 0000:    FUNCTION IRF.SET EXTERNAL
7045: 0000:    END FUNCTION
7046: 0000: 
7047: 0000:   FUNCTION CONCAT.NEW.IRF.DATA$ EXTERNAL                                  ! 1.7 RC
7048: 0000:   END FUNCTION                                                            ! 1.7 RC
7049: 0000: 
7050: 0000:   FUNCTION SPLIT.NEW.IRF.DATA$ EXTERNAL                                   ! 1.7 RC
7051: 0000:   END FUNCTION                                                            ! 1.7 RC
7052: 0000:   
7053: 0000:   FUNCTION READ.IRF EXTERNAL
7054: 0000:    INTEGER*2 READ.IRF
7055: 0000:   END FUNCTION
7056: 0000: 
7057: 0000:   FUNCTION READ.IRF.ALT EXTERNAL
7058: 0000:    INTEGER*2 READ.IRF.ALT
7059: 0000:   END FUNCTION
7060: 0000: 
7061: 0000:   FUNCTION READ.IRF.LOCK EXTERNAL
7062: 0000:    INTEGER*2 READ.IRF.LOCK
7063: 0000:   END FUNCTION
7064: 0000: 
7065: 0000:   FUNCTION WRITE.IRF EXTERNAL
7066: 0000:    INTEGER*2 WRITE.IRF
7067: 0000:   END FUNCTION
7068: 0000: 
7069: 0000:   FUNCTION WRITE.IRF.UNLOCK EXTERNAL
7070: 0000:    INTEGER*2 WRITE.IRF.UNLOCK
7071: 0000:   END FUNCTION
7072: 0000: 
7073: 0000:   FUNCTION WRITE.IRF.HOLD EXTERNAL
7074: 0000:    INTEGER*2 WRITE.IRF.HOLD
7075: 0000:   END FUNCTION
7076: 0000: 
7077: 0000:   FUNCTION WRITE.IRF.HOLD.UNLOCK EXTERNAL
7078: 0000:    INTEGER*2 WRITE.IRF.HOLD.UNLOCK
7079: 0000:   END FUNCTION
7080: 0000: 
7081: 0000:   
7082: 0000:  %INCLUDE STKDCEXT.J86                    ! 1.8DA
7083: 0000: \******************************************************************************
7084: 0000: \******************************************************************************
7085: 0000: \***
7086: 0000: \***   $Workfile:   STKDCEXT.J86  $
7087: 0000: \***
7088: 0000: \***   $Revision:   1.0  $
7089: 0000: \***
7090: 0000: \******************************************************************************
7091: 0000: \******************************************************************************
7092: 0000: \***
7093: 0000: \***   $Log:   V:\archive\j86\stkdcext.j8v  $
7094: 0000: \***   
7095: 0000: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
7096: 0000: \***    
7097: 0000: \***   
7098: 0000: \***      Rev 1.0   09 Jul 1997 11:05:00   DEV45PS
7099: 0000: \***   Stocktake System New Files
7100: 0000: \***   
7101: 0000: \******************************************************************************
7102: 0000: \******************************************************************************\*****************************************************************************
7103: 0000: \***
7104: 0000: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE DUMP CODE FILE
7105: 0000: \***
7106: 0000: \***           REFERENCE:   STKDCEXT.J86
7107: 0000: \***
7108: 0000: \***           VERSION A         Nik Sen         19th June 1997
7109: 0000: \***
7110: 0000: \***
7111: 0000: \*******************************************************************************
7112: 0000: \*******************************************************************************
7113: 0000: 
7114: 0000:    FUNCTION STKDC.SET EXTERNAL
7115: 0000:    END FUNCTION
7116: 0000:    
7117: 0000:    FUNCTION READ.STKDC EXTERNAL
7118: 0000:       INTEGER*2 READ.STKDC
7119: 0000:    END FUNCTION
7120: 0000:    
7121: 0000:    FUNCTION WRITE.STKDC EXTERNAL
7122: 0000:       INTEGER*2 WRITE.STKDC
7123: 0000:    END FUNCTION
7124: 0000:  
7125: 0000:  %INCLUDE IMSTCEXT.J86                    ! 1.9BG
7126: 0000: \***********************************************************************
7127: 0000: \***********************************************************************
7128: 0000: \***
7129: 0000: \***    DESCRIPTION: Item Movement & Stock File
7130: 0000: \***                 External File Function Definitions
7131: 0000: \***
7132: 0000: \***    FILE TYPE : Keyed
7133: 0000: \***
7134: 0000: \***********************************************************************
7135: 0000: \***
7136: 0000: \***    Version A.          Les Cook                     21st Aug 1992
7137: 0000: \***    Initial version.
7138: 0000: \***
7139: 0000: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
7140: 0000: \***    Added new external functions for
7141: 0000: \***        MIMSTC - merged IMSTC
7142: 0000: \***        CIMSTC - Copy of IMSTC
7143: 0000: \***        BIMSTC - Backup of IMSTC
7144: 0000: \***
7145: 0000: \***    Version C.          Mark Walker                  23rd Jan 2014
7146: 0000: \***    F337 Centralised View of Stock
7147: 0000: \***    - Moved BIMST, CIMST and MIMST external function definitions
7148: 0000: \***      to separate modules.
7149: 0000: \***    - Minor formatting changes (uncommented).
7150: 0000: \***
7151: 0000: \***********************************************************************
7152: 0000: \***********************************************************************
7153: 0000: 
7154: 0000: FUNCTION IMSTC.SET EXTERNAL
7155: 0000: END FUNCTION
7156: 0000: 
7157: 0000: FUNCTION READ.IMSTC EXTERNAL
7158: 0000:     INTEGER*2 READ.IMSTC
7159: 0000: END FUNCTION
7160: 0000: 
7161: 0000: FUNCTION READ.IMSTC.LOCK EXTERNAL
7162: 0000:     INTEGER*2 READ.IMSTC.LOCK
7163: 0000: END FUNCTION
7164: 0000: 
7165: 0000: FUNCTION WRITE.IMSTC EXTERNAL
7166: 0000:    INTEGER*2 WRITE.IMSTC
7167: 0000: END FUNCTION
7168: 0000: 
7169: 0000: FUNCTION WRITE.IMSTC.UNLOCK.HOLD EXTERNAL
7170: 0000:     INTEGER*2 WRITE.IMSTC.UNLOCK.HOLD
7171: 0000: END FUNCTION
7172: 0000: 
7173: 0000: FUNCTION WRITE.IMSTC.UNLOCK EXTERNAL
7174: 0000:    INTEGER*2 WRITE.IMSTC.UNLOCK
7175: 0000: END FUNCTION
7176: 0000: 
7177: 0000: FUNCTION WRITE.IMSTC.HOLD EXTERNAL
7178: 0000:    INTEGER*2 WRITE.IMSTC.HOLD
7179: 0000: END FUNCTION
7180: 0000: 
7181: 0000:  %INCLUDE STOCKEXT.J86                    ! 1.9BG
7182: 0000: \***********************************************************************
7183: 0000: \***********************************************************************
7184: 0000: \***
7185: 0000: \***    DESCRIPTION: Stock File
7186: 0000: \***                 External File Function Definitions
7187: 0000: \***
7188: 0000: \***    FILE TYPE : Keyed
7189: 0000: \***
7190: 0000: \***********************************************************************
7191: 0000: \***
7192: 0000: \***    Version A.          Les Cook                     21st Aug 1992
7193: 0000: \***    Initial version.
7194: 0000: \***
7195: 0000: \***    Version B.          Robert Cowey                 21st Oct 1993
7196: 0000: \***    No changes to this file.
7197: 0000: \***
7198: 0000: \***    Version C.          Nik Sen                      22nd Dec 1994
7199: 0000: \***    WRITE.STOCK.HOLD added.
7200: 0000: \***
7201: 0000: \***    Version D.          Mark Walker                  23rd Jan 2014
7202: 0000: \***    F337 Centralised View of Stock
7203: 0000: \***    - Minor formatting changes (uncommented).
7204: 0000: \***
7205: 0000: \***********************************************************************
7206: 0000: \***********************************************************************
7207: 0000: 
7208: 0000: FUNCTION STOCK.SET EXTERNAL
7209: 0000: END FUNCTION
7210: 0000:    
7211: 0000: FUNCTION READ.STOCK EXTERNAL
7212: 0000:     INTEGER*2 READ.STOCK
7213: 0000: END FUNCTION
7214: 0000:    
7215: 0000: FUNCTION WRITE.STOCK EXTERNAL
7216: 0000:     INTEGER*2 WRITE.STOCK
7217: 0000: END FUNCTION
7218: 0000:    
7219: 0000: FUNCTION WRITE.STOCK.HOLD EXTERNAL
7220: 0000:     INTEGER*2 WRITE.STOCK.HOLD
7221: 0000: END FUNCTION
7222: 0000: 
7223: 0000: FUNCTION READ.STOCK.LOCK EXTERNAL
7224: 0000:     INTEGER*2 READ.STOCK.LOCK
7225: 0000: END FUNCTION
7226: 0000:    
7227: 0000: FUNCTION WRITE.STOCK.UNLOCK EXTERNAL
7228: 0000:     INTEGER*2 WRITE.STOCK.UNLOCK
7229: 0000: END FUNCTION
7230: 0000:    
7231: 0000: FUNCTION WRITE.STOCK.UNLOCK.HOLD EXTERNAL
7232: 0000:     INTEGER*2 WRITE.STOCK.UNLOCK.HOLD
7233: 0000: END FUNCTION
7234: 0000: 
7235: 0000:  %INCLUDE MINLSEXT.J86                    ! 1.9BG
7236: 0000: 
7237: 0000: \*****************************************************************************
7238: 0000: \*****************************************************************************
7239: 0000: \***
7240: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7241: 0000: \***
7242: 0000: \***                   FILE TYPE:  KEYED
7243: 0000: \***
7244: 0000: \***                   REFERENCE:  MINLSEXT.J86
7245: 0000: \***
7246: 0000: \***	             DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
7247: 0000: \***
7248: 0000: \***
7249: 0000: \***
7250: 0000: \***      VERSION 1 : Julia Stones             8th January 1998   
7251: 0000: \***      
7252: 0000: \*****************************************************************************
7253: 0000: \*****************************************************************************
7254: 0000: 
7255: 0000: 
7256: 0000:   FUNCTION MINLS.SET EXTERNAL
7257: 0000:      INTEGER*2 MINLS.SET
7258: 0000:   END FUNCTION
7259: 0000: 
7260: 0000: 
7261: 0000:   FUNCTION READ.MINLS EXTERNAL
7262: 0000:     INTEGER*2 READ.MINLS
7263: 0000:   END FUNCTION
7264: 0000:   
7265: 0000: 
7266: 0000:   FUNCTION READ.MINLS.LOCKED EXTERNAL
7267: 0000:     INTEGER*2 READ.MINLS.LOCKED
7268: 0000:   END FUNCTION  
7269: 0000: 
7270: 0000: 
7271: 0000:   FUNCTION WRITE.HOLD.MINLS EXTERNAL
7272: 0000:     INTEGER*2 WRITE.HOLD.MINLS
7273: 0000:   END FUNCTION
7274: 0000: 
7275: 0000: 
7276: 0000:   FUNCTION WRITE.UNLOCK.MINLS EXTERNAL
7277: 0000:     INTEGER*2 WRITE.UNLOCK.MINLS
7278: 0000:   END FUNCTION
7279: 0000: 
7280: 0000: 
7281: 0000:   FUNCTION WRITE.HOLD.UNLOCK.MINLS EXTERNAL
7282: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.MINLS
7283: 0000:   END FUNCTION
7284: 0000:   
7285: 0000: 
7286: 0000:   FUNCTION WRITE.MINLS EXTERNAL
7287: 0000:     INTEGER*2 WRITE.MINLS
7288: 0000:   END FUNCTION
7289: 0000: 
7290: 0000:  %INCLUDE NEGSCEXT.J86                    ! 1.9BG
7291: 0000: 
7292: 0000: \*****************************************************************************
7293: 0000: \*****************************************************************************
7294: 0000: \***
7295: 0000: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7296: 0000: \***
7297: 0000: \***                   FILE TYPE:  KEYED
7298: 0000: \***
7299: 0000: \***                   REFERENCE:  NEGSCEXT.J86
7300: 0000: \***
7301: 0000: \***                 DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
7302: 0000: \***
7303: 0000: \***
7304: 0000: \***
7305: 0000: \***      VERSION 1 : Julia Stones             15th July 1999   
7306: 0000: \***      
7307: 0000: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
7308: 0000: \***    Changes for RF trial.
7309: 0000: \***    Recompiled to prevent future automatic recompiles.
7310: 0000: \***    No changes to actual code.
7311: 0000: \***
7312: 0000: \*****************************************************************************
7313: 0000: \*****************************************************************************
7314: 0000: 
7315: 0000: 
7316: 0000:   FUNCTION NEGSC.SET EXTERNAL
7317: 0000:      INTEGER*2 NEGSC.SET
7318: 0000:   END FUNCTION
7319: 0000: 
7320: 0000: 
7321: 0000:   FUNCTION READ.NEGSC EXTERNAL
7322: 0000:     INTEGER*2 READ.NEGSC
7323: 0000:   END FUNCTION
7324: 0000:   
7325: 0000: 
7326: 0000:   FUNCTION READ.NEGSC.LOCKED EXTERNAL
7327: 0000:     INTEGER*2 READ.NEGSC.LOCKED
7328: 0000:   END FUNCTION  
7329: 0000: 
7330: 0000: 
7331: 0000:   FUNCTION WRITE.HOLD.NEGSC EXTERNAL
7332: 0000:     INTEGER*2 WRITE.HOLD.NEGSC
7333: 0000:   END FUNCTION
7334: 0000: 
7335: 0000: 
7336: 0000:   FUNCTION WRITE.UNLOCK.NEGSC EXTERNAL
7337: 0000:     INTEGER*2 WRITE.UNLOCK.NEGSC
7338: 0000:   END FUNCTION
7339: 0000: 
7340: 0000: 
7341: 0000:   FUNCTION WRITE.HOLD.UNLOCK.NEGSC EXTERNAL
7342: 0000:     INTEGER*2 WRITE.HOLD.UNLOCK.NEGSC
7343: 0000:   END FUNCTION
7344: 0000:   
7345: 0000: 
7346: 0000:   FUNCTION WRITE.NEGSC EXTERNAL
7347: 0000:     INTEGER*2 WRITE.NEGSC
7348: 0000:   END FUNCTION
7349: 0000: 
7350: 0000:  %INCLUDE SSPSCEXT.J86                    ! 2.0JAS
7351: 0000: \*****************************************************************************
7352: 0000: \*****************************************************************************
7353: 0000: \***
7354: 0000: \***         FUNCTION DEFINITIONS FOR SSPSCTRL
7355: 0000: \***
7356: 0000: \***                    REFERENCE : SSPSCexa.J86
7357: 0000: \***
7358: 0000: \***    Version A           Julia Stones         23.10.2003
7359: 0000: \***
7360: 0000: \*******************************************************************************
7361: 0000: \*******************************************************************************
7362: 0000: 
7363: 0000:   FUNCTION SSPSCTRL.SET EXTERNAL
7364: 0000:    INTEGER*2 SSPSCTRL.SET
7365: 0000:   END FUNCTION
7366: 0000: 
7367: 0000:   FUNCTION READ.SSPSCTRL EXTERNAL
7368: 0000:    INTEGER*2 READ.SSPSCTRL
7369: 0000:   END FUNCTION
7370: 0000: 
7371: 0000:   FUNCTION READ.SSPSCTRL.LOCKED EXTERNAL
7372: 0000:    INTEGER*2 READ.SSPSCTRL.LOCKED
7373: 0000:   END FUNCTION
7374: 0000: 
7375: 0000:   FUNCTION WRITE.SSPSCTRL EXTERNAL
7376: 0000:    INTEGER*2 WRITE.SSPSCTRL
7377: 0000:   END FUNCTION
7378: 0000: 
7379: 0000:   FUNCTION WRITE.SSPSCTRL.UNLOCK EXTERNAL
7380: 0000:    INTEGER*2 WRITE.SSPSCTRL.UNLOCK
7381: 0000:   END FUNCTION
7382: 0000: 
7383: 0000:  %INCLUDE BTCSEXT.J86                     ! 2.0JAS
7384: 0000: \*****************************************************************************
7385: 0000: \*****************************************************************************
7386: 0000: \***
7387: 0000: \***         FUNCTION DEFINITIONS FOR BTCS FILE
7388: 0000: \***
7389: 0000: \***         REFERENCE    : BTCSEXT
7390: 0000: \***
7391: 0000: \***         VERSION A    : JULIA STONES 23/10/03
7392: 0000: \***
7393: 0000: \*****************************************************************************
7394: 0000: \*****************************************************************************
7395: 0000: 
7396: 0000:     FUNCTION BTCS.SET EXTERNAL
7397: 0000:     END FUNCTION
7398: 0000: 
7399: 0000:     FUNCTION READ.BTCS EXTERNAL
7400: 0000:     INTEGER*1 READ.BTCS
7401: 0000:     END FUNCTION
7402: 0000: 
7403: 0000:     FUNCTION READ.BTCS.LOCK EXTERNAL
7404: 0000:     INTEGER*1 READ.BTCS.LOCK
7405: 0000:     END FUNCTION
7406: 0000: 
7407: 0000:     FUNCTION WRITE.BTCS EXTERNAL
7408: 0000:     INTEGER*1 WRITE.BTCS
7409: 0000:     END FUNCTION
7410: 0000: 
7411: 0000:     FUNCTION WRITE.BTCS.UNLOCK EXTERNAL
7412: 0000:     INTEGER*1 WRITE.BTCS.UNLOCK
7413: 0000:     END FUNCTION
7414: 0000: 
7415: 0000:     FUNCTION WRITE.BTCS.UNLOCK.HOLD EXTERNAL
7416: 0000:     INTEGER*1 WRITE.BTCS.UNLOCK.HOLD
7417: 0000:     END FUNCTION
7418: 0000: 
7419: 0000:  %INCLUDE PRINTEXT.J86                    ! 2.0JAS
7420: 0000: 
7421: 0000: REM \
7422: 0000: \*******************************************************************************
7423: 0000: \*******************************************************************************
7424: 0000: \***
7425: 0000: \***    %INCLUDE FOR PRINT FILE EXTERNAL FUNCTIONS
7426: 0000: \***
7427: 0000: \***        REFERENCE   :   PRINTEX (J86)
7428: 0000: \***
7429: 0000: \***        FILE TYPE   :   Printer / Labeller
7430: 0000: \***
7431: 0000: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
7432: 0000: \***    Original version created from PRINTEXG.
7433: 0000: \***
7434: 0000: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
7435: 0000: \***    Changes unknown.
7436: 0000: \***
7437: 0000: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
7438: 0000: \***    Defined function variables for use as return codes.
7439: 0000: \***
7440: 0000: \***    Version C               Andrew Wedgeworth                 24th May 1992
7441: 0000: \***    Condensed print function added.
7442: 0000: \***
7443: 0000: \***    Version D               Stuart WIlliam McConnachie       31st July 2000.
7444: 0000: \***    Added function for PCL printing to LaserJet.
7445: 0000: \***
7446: 0000: \***    Version E               Charles Skadorwa                   4th Apr 2008.
7447: 0000: \***    Added parameter to WRITE.CONDENSED.PRINT function to
7448: 0000: \***    enable Alliance Pharmacy Brother Laser printers to print
7449: 0000: \***    in condensed mode.
7450: 0000: \***
7451: 0000: \***    Version F           Charles Skadorwa                       2nd Mar 2016.
7452: 0000: \***    It was found that certain reports would not print when stores
7453: 0000: \***    were converted to LAN attached printing.
7454: 0000: \***
7455: 0000: \***    Added new function: WRITE.PRINT.PLUS.LF based on WRITE.PRINT.
7456: 0000: \***    This adds a Line-Feed characters to every print line.
7457: 0000: \***
7458: 0000: \*******************************************************************************
7459: 0000: \*******************************************************************************
7460: 0000: 
7461: 0000: 
7462: 0000:     FUNCTION PRINT.SET EXTERNAL
7463: 0000:         INTEGER*2 PRINT.SET
7464: 0000:     END FUNCTION
7465: 0000: 
7466: 0000: 
7467: 0000:     FUNCTION WRITE.PRINT EXTERNAL
7468: 0000:        INTEGER*2 WRITE.PRINT
7469: 0000:     END FUNCTION
7470: 0000: 
7471: 0000: 
7472: 0000:     FUNCTION WRITE.PRINT.PLUS.LF EXTERNAL                               !FCS
7473: 0000:        INTEGER*2 WRITE.PRINT.PLUS.LF                                    !FCS
7474: 0000:     END FUNCTION                                                        !FCS
7475: 0000: 
7476: 0000: 
7477: 0000:     FUNCTION WRITE.CONDENSED.PRINT (AP.STORE) EXTERNAL                 ! ECSk
7478: 0000:        INTEGER*2 WRITE.CONDENSED.PRINT
7479: 0000:     END FUNCTION
7480: 0000: 
7481: 0000: 
7482: 0000:     FUNCTION WRITE.PCL.PRINT EXTERNAL                                  ! DSWM
7483: 0000:        INTEGER*2 WRITE.PCL.PRINT                                       ! DSWM
7484: 0000:     END FUNCTION                                                       ! DSWM
7485: 0000: 
7486: 0000: 
7487: 0000:     FUNCTION WRITE.LABEL EXTERNAL
7488: 0000:         INTEGER*2 WRITE.LABEL
7489: 0000:     END FUNCTION
7490: 0000: 
7491: 0000:  %INCLUDE SOPTSEXT.J86                    ! 2.1JAS
7492: 0000: \*******************************************************************************
7493: 0000: \***                                                                         ***
7494: 0000: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE STORE OPTIONS FILE           ***
7495: 0000: \***                                                                         ***
7496: 0000: \***                     REFERENCE : SOPTSEXT.J86                            ***
7497: 0000: \***                                                                         ***
7498: 0000: \***      Version A      Stuart William McConnachie      19th June 1995      ***
7499: 0000: \***                                                                         ***
7500: 0000: \*******************************************************************************
7501: 0000: 
7502: 0000:       FUNCTION SOPTS.SET EXTERNAL
7503: 0000:       END FUNCTION
7504: 0000:       
7505: 0000:       FUNCTION READ.SOPTS EXTERNAL
7506: 0000:          INTEGER*2 READ.SOPTS
7507: 0000:       END FUNCTION
7508: 0000: 
7509: 0000:       FUNCTION WRITE.SOPTS EXTERNAL
7510: 0000:          INTEGER*2 WRITE.SOPTS
7511: 0000:       END FUNCTION
7512: 0000: 
7513: 0000:  %INCLUDE LOCALEXT.J86                    ! 2.1JAS
7514: 0000: \***********************************************************************
7515: 0000: \***********************************************************************
7516: 0000: \***
7517: 0000: \***    DESCRIPTION: Local Price File
7518: 0000: \***                 External File Function Definitions
7519: 0000: \***
7520: 0000: \***    FILE TYPE : Keyed
7521: 0000: \***
7522: 0000: \***********************************************************************
7523: 0000: \***
7524: 0000: \***    Version A.              Paul Flanagan            1st Jul 1993
7525: 0000: \***    Initial version.
7526: 0000: \***
7527: 0000: \***    Version B.              Clive Norris            30th Nov 1993
7528: 0000: \***    Renamed to keep the versions in line.
7529: 0000: \***
7530: 0000: \***    Version C.              Mark Walker             29th Jun 2015
7531: 0000: \***    F392 Retail Stock 5
7532: 0000: \***    Added function WRITE.LOCAL.UNLOCK.HOLD
7533: 0000: \***
7534: 0000: \***********************************************************************
7535: 0000: \***********************************************************************
7536: 0000: 
7537: 0000: FUNCTION LOCAL.SET EXTERNAL
7538: 0000: END FUNCTION
7539: 0000: 
7540: 0000: FUNCTION READ.LOCAL EXTERNAL
7541: 0000:     INTEGER*2 READ.LOCAL
7542: 0000: END FUNCTION
7543: 0000: 
7544: 0000: FUNCTION READ.LOCAL.LOCK EXTERNAL
7545: 0000:     INTEGER*2 READ.LOCAL.LOCK
7546: 0000: END FUNCTION
7547: 0000: 
7548: 0000: FUNCTION WRITE.LOCAL EXTERNAL
7549: 0000:     INTEGER*2 WRITE.LOCAL
7550: 0000: END FUNCTION
7551: 0000: 
7552: 0000: FUNCTION WRITE.LOCAL.UNLOCK EXTERNAL
7553: 0000:     INTEGER*2 WRITE.LOCAL.UNLOCK
7554: 0000: END FUNCTION
7555: 0000: 
7556: 0000: FUNCTION WRITE.LOCAL.UNLOCK.HOLD EXTERNAL                                   !CMW
7557: 0000:     INTEGER*2 WRITE.LOCAL.UNLOCK.HOLD                                       !CMW
7558: 0000: END FUNCTION                                                                !CMW
7559: 0000: 
7560: 0000:  %INCLUDE CCREJEXT.J86                    ! 2.2JAS
7561: 0000: \*******************************************************************************
7562: 0000: \*******************************************************************************
7563: 0000: \***
7564: 0000: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
7565: 0000: \***
7566: 0000: \***                    REFERENCE    : CCREJEXT.BAS
7567: 0000: \***
7568: 0000: \***    Version A.         Julia Stones              12th March 2004
7569: 0000: \***
7570: 0000: \*******************************************************************************
7571: 0000: \*******************************************************************************
7572: 0000: 
7573: 0000: 
7574: 0000:   FUNCTION CCREJ.SET EXTERNAL
7575: 0000:       INTEGER*2 CCREJ.SET
7576: 0000:   END FUNCTION
7577: 0000: 
7578: 0000:   FUNCTION CCREJC.SET EXTERNAL
7579: 0000:       INTEGER*2 CCREJC.SET
7580: 0000:   END FUNCTION
7581: 0000: 
7582: 0000:   FUNCTION CCREJP.SET EXTERNAL
7583: 0000:       INTEGER*2 CCREJP.SET
7584: 0000:   END FUNCTION
7585: 0000: 
7586: 0000:   FUNCTION READ.CCREJ EXTERNAL
7587: 0000:       INTEGER*2 READ.CCREJ
7588: 0000:   END FUNCTION
7589: 0000: 
7590: 0000:   FUNCTION READ.CCREJC EXTERNAL
7591: 0000:       INTEGER*2 READ.CCREJC
7592: 0000:   END FUNCTION
7593: 0000: 
7594: 0000:   FUNCTION READ.CCREJP EXTERNAL
7595: 0000:       INTEGER*2 READ.CCREJP
7596: 0000:   END FUNCTION
7597: 0000: 
7598: 0000:   FUNCTION WRITE.CCREJ EXTERNAL
7599: 0000:       INTEGER*2 WRITE.CCREJ
7600: 0000:   END FUNCTION
7601: 0000: 
7602: 0000:   FUNCTION WRITE.CCREJC EXTERNAL
7603: 0000:       INTEGER*2 WRITE.CCREJC
7604: 0000:   END FUNCTION
7605: 0000: 
7606: 0000:   FUNCTION WRITE.HOLD.CCREJ EXTERNAL
7607: 0000:       INTEGER*2 WRITE.HOLD.CCREJ
7608: 0000:   END FUNCTION
7609: 0000: 
7610: 0000:   FUNCTION WRITE.HOLD.CCREJC EXTERNAL
7611: 0000:       INTEGER*2 WRITE.HOLD.CCREJC
7612: 0000:   END FUNCTION
7613: 0000: 
7614: 0000:  %INCLUDE RBEXT.J86                       ! 2.6BG
7615: 0000: \/******************************************************************/
7616: 0000: \/*                                                                */
7617: 0000: \/* Recalls Buffer FILE EXTERNAL FUNCTION DEFNS                    */
7618: 0000: \/*                                                                */
7619: 0000: \/* REFERENCE   : RBEXT.J86                                        */
7620: 0000: \/*                                                                */
7621: 0000: \/* VERSION A.          Brian Greenield         11th May 2007      */
7622: 0000: \/*                                                                */
7623: 0000: \/******************************************************************/
7624: 0000: 
7625: 0000:    FUNCTION RB.SET EXTERNAL
7626: 0000:       INTEGER*1 RB.SET
7627: 0000:    END FUNCTION
7628: 0000: 
7629: 0000:    FUNCTION READ.RB EXTERNAL
7630: 0000:       INTEGER*2 READ.RB
7631: 0000:    END FUNCTION
7632: 0000: 
7633: 0000:    FUNCTION WRITE.RB EXTERNAL
7634: 0000:       INTEGER*2 WRITE.RB
7635: 0000:    END FUNCTION
7636: 0000: 
7637: 0000: \/******************************************************************/
7638: 0000:  %INCLUDE REWKFEXT.J86                    ! 2.6BG
7639: 0000: \/******************************************************************/
7640: 0000: \/*                                                                */
7641: 0000: \/* Recalls Work FILE EXTERNAL FUNCTION DEFNS                      */
7642: 0000: \/*                                                                */
7643: 0000: \/* REFERENCE   : REWKFEXT.J86                                     */
7644: 0000: \/*                                                                */
7645: 0000: \/* VERSION A.          Brian Greenield         11th May 2007      */
7646: 0000: \/*                                                                */
7647: 0000: \/******************************************************************/
7648: 0000: 
7649: 0000:    FUNCTION REWKF.SET EXTERNAL
7650: 0000:       INTEGER*1 REWKF.SET
7651: 0000:    END FUNCTION
7652: 0000: 
7653: 0000:    FUNCTION READ.REWKF EXTERNAL
7654: 0000:       INTEGER*2 READ.REWKF
7655: 0000:    END FUNCTION
7656: 0000: 
7657: 0000:    FUNCTION WRITE.REWKF EXTERNAL
7658: 0000:       INTEGER*2 WRITE.REWKF
7659: 0000:    END FUNCTION
7660: 0000: 
7661: 0000: \/******************************************************************/
7662: 0000:  %INCLUDE RECALEXT.J86                    ! 2.6BG
7663: 0000: \******************************************************************************
7664: 0000: \******************************************************************************
7665: 0000: \***
7666: 0000: \***                 FUNCTION DEFINITIONS FOR RECALLS.BIN
7667: 0000: \***
7668: 0000: \***                        REFERENCE: RECALFEXT.J86
7669: 0000: \***
7670: 0000: \***    VERSION A               BRIAN GREENFIELD                14th May 2007
7671: 0000: \***    Initial Version
7672: 0000: \***
7673: 0000: \***    Version B               CHARLES SKADORWA                26th June 2007
7674: 0000: \***    Added DELETE.RECALLS function.
7675: 0000: \***
7676: 0000: \*******************************************************************************
7677: 0000: \*******************************************************************************
7678: 0000: 
7679: 0000:    FUNCTION RECALLS.SET EXTERNAL
7680: 0000:       INTEGER*1 RECALLS.SET
7681: 0000:    END FUNCTION
7682: 0000:    
7683: 0000:    FUNCTION WRITE.RECALLS EXTERNAL
7684: 0000:       INTEGER*1 WRITE.RECALLS
7685: 0000:    END FUNCTION
7686: 0000:    
7687: 0000:    FUNCTION READ.RECALLS EXTERNAL
7688: 0000:       INTEGER*1 READ.RECALLS
7689: 0000:    END FUNCTION
7690: 0000:    
7691: 0000:   FUNCTION DELETE.RECALLS (KEY$) EXTERNAL
7692: 0000:       INTEGER*1 DELETE.RECALLS
7693: 0000:    END FUNCTION
7694: 0000:  %INCLUDE DELVIEXT.J86                    ! 2.7SH
7695: 0000: \/******************************************************************/
7696: 0000: \/*                                                                */
7697: 0000: \/* DELVINDX FILE EXTERNAL FUNCTION DEFNS                          */
7698: 0000: \/*                                                                */
7699: 0000: \/* REFERENCE   : DELVIEXT.J86                                     */
7700: 0000: \/*                                                                */
7701: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
7702: 0000: \/*                                                                */
7703: 0000: \/******************************************************************/
7704: 0000: 
7705: 0000:    FUNCTION DELVINDX.SET EXTERNAL
7706: 0000:       INTEGER*1 DELVINDX.SET
7707: 0000:    END FUNCTION
7708: 0000: 
7709: 0000:    FUNCTION READ.DELVINDX EXTERNAL
7710: 0000:       INTEGER*2 READ.DELVINDX
7711: 0000:    END FUNCTION
7712: 0000: 
7713: 0000:    FUNCTION WRITE.DELVINDX EXTERNAL
7714: 0000:       INTEGER*2 WRITE.DELVINDX
7715: 0000:    END FUNCTION
7716: 0000: 
7717: 0000: \/******************************************************************/
7718: 0000:  %INCLUDE UODOTEXT.J86                    ! 2.7SH
7719: 0000: \/******************************************************************/
7720: 0000: \/*                                                                */
7721: 0000: \/* UOD Outers FILE EXTERNAL FUNCTION DEFNS                        */
7722: 0000: \/*                                                                */
7723: 0000: \/* REFERENCE   : UODOTEXT.J86                                     */
7724: 0000: \/*                                                                */
7725: 0000: \/* VERSION A.          Stuart Highley              14 July 2008   */
7726: 0000: \/*                                                                
7727: 0000: \/* REVISION 1.8.            ROBERT COWEY.            14 JAN 2009.
7728: 0000: \/* Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
7729: 0000: \/* Defined new function UODOT.REC$.
7730: 0000: \/*
7731: 0000: \/******************************************************************/
7732: 0000: 
7733: 0000:     FUNCTION UODOT.KEY$ EXTERNAL
7734: 0000:         STRING    UODOT.KEY$
7735: 0000:         STRING    WORK$
7736: 0000:     END FUNCTION
7737: 0000: 
7738: 0000:     FUNCTION UODOT.SET EXTERNAL
7739: 0000:         INTEGER*1 UODOT.SET
7740: 0000:     END FUNCTION
7741: 0000: 
7742: 0000:     FUNCTION READ.UODOT EXTERNAL
7743: 0000:         STRING    CHILD.LIST$
7744: 0000:         INTEGER*1 UODOT.INDICAT1%
7745: 0000:         INTEGER*2 UODOT.STATUS%
7746: 0000:         INTEGER*2 READ.UODOT
7747: 0000:         INTEGER*2 I%
7748: 0000:     END FUNCTION
7749: 0000: 
7750: 0000: 
7751: 0000:     FUNCTION READ.UODOT.ON.DESPATCH EXTERNAL
7752: 0000:         STRING TEMP$
7753: 0000:         INTEGER*2 RC%
7754: 0000:         INTEGER*2 READ.UODOT.ON.DESPATCH
7755: 0000:     END FUNCTION
7756: 0000: 
7757: 0000:     FUNCTION READ.UODOT.LOCK EXTERNAL
7758: 0000:         INTEGER*1 UODOT.INDICAT1%
7759: 0000:         INTEGER*2 UODOT.STATUS%
7760: 0000:         INTEGER*2 READ.UODOT.LOCK
7761: 0000:         INTEGER*2 I%
7762: 0000:         STRING    CHILD.LIST$
7763: 0000:     END FUNCTION
7764: 0000: 
7765: 0000:     FUNCTION WRITE.UODOT EXTERNAL
7766: 0000:         INTEGER*1 UODOT.INDICAT1%
7767: 0000:         INTEGER*2 UODOT.STATUS%
7768: 0000:         INTEGER*2 WRITE.UODOT
7769: 0000:         INTEGER*2 I%
7770: 0000:         STRING    CHILD.LIST$
7771: 0000:     END FUNCTION
7772: 0000: 
7773: 0000:     FUNCTION WRITE.UODOT.UNLOCK EXTERNAL
7774: 0000:         INTEGER*1 UODOT.INDICAT1%
7775: 0000:         INTEGER*2 UODOT.STATUS%
7776: 0000:         INTEGER*2 WRITE.UODOT.UNLOCK
7777: 0000:         INTEGER*2 I%
7778: 0000:         STRING    CHILD.LIST$
7779: 0000:     END FUNCTION
7780: 0000: 
7781: 0000: \/******************************************************************/
7782: 0000: 
7783: 0000:     FUNCTION DELETE.UODOT EXTERNAL
7784: 0000:         INTEGER*2 DELETE.UODOT
7785: 0000:     END FUNCTION
7786: 0000: 
7787: 0000: \/******************************************************************/
7788: 0000: 
7789: 0000:     FUNCTION UODOT.REC$ EXTERNAL                                      ! 1.8 RC
7790: 0000:         STRING UODOT.REC$                                             ! 1.8 RC
7791: 0000:     END FUNCTION                                                      ! 1.8 RC
7792: 0000: 
7793: 0000: 
7794: 0000:  %INCLUDE AFEXT.J86                       ! 2.7SH
7795: 0000: 
7796: 0000: \REM
7797: 0000: \*******************************************************************************
7798: 0000: \*******************************************************************************
7799: 0000: \***
7800: 0000: \***    %INCLUDE FOR GSA AUTHORISATION FILE EXTERNAL FUNCTIONS
7801: 0000: \***
7802: 0000: \***        REFERENCE   :  AFEXT (J86)
7803: 0000: \***
7804: 0000: \***        FILE TYPE   :  Keyed
7805: 0000: \***
7806: 0000: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
7807: 0000: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
7808: 0000: \***
7809: 0000: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
7810: 0000: \***    Original version created from AFEXTA.
7811: 0000: \***
7812: 0000: \***    VERSION B.              Steve Windsor                       29 Dec 1992.
7813: 0000: \***    Version incremented to keep in line with other included code           
7814: 0000: \***
7815: 0000: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
7816: 0000: \***    No changes to this file.
7817: 0000: \***
7818: 0000: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
7819: 0000: \***    Changes for A9C POS improvements project.
7820: 0000: \***    Used up last available three bytes of EALAUTH user data by redefining 
7821: 0000: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
7822: 0000: \***    No changes to this file.
7823: 0000: \***
7824: 0000: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
7825: 0000: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
7826: 0000: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format within AFDEC.J86.
7827: 0000: \***    Description text change only - No code changes to this file.
7828: 0000: \***
7829: 0000: \*******************************************************************************
7830: 0000: \*******************************************************************************
7831: 0000: 
7832: 0000: 
7833: 0000: FUNCTION AF.SET EXTERNAL
7834: 0000:     INTEGER*2 AF.SET
7835: 0000: END FUNCTION
7836: 0000: 
7837: 0000: 
7838: 0000: FUNCTION READ.AF EXTERNAL
7839: 0000:     INTEGER*2 READ.AF
7840: 0000: END FUNCTION
7841: 0000: 
7842: 0000: 
7843: 0000: FUNCTION READ.AF.LOCKED EXTERNAL
7844: 0000:     INTEGER*2 READ.AF.LOCKED
7845: 0000: END FUNCTION
7846: 0000: 
7847: 0000:   
7848: 0000: FUNCTION READ.AF.ABREV EXTERNAL
7849: 0000:     INTEGER*2 READ.AF.ABREV
7850: 0000: END FUNCTION
7851: 0000: 
7852: 0000: 
7853: 0000: FUNCTION READ.AF.ABREV.LOCKED EXTERNAL
7854: 0000:     INTEGER*2 READ.AF.ABREV.LOCKED
7855: 0000: END FUNCTION
7856: 0000: 
7857: 0000:   
7858: 0000: FUNCTION WRITE.AF.UNLOCK EXTERNAL
7859: 0000:     INTEGER*2 WRITE.AF.UNLOCK
7860: 0000: END FUNCTION
7861: 0000: 
7862: 0000: 
7863: 0000: FUNCTION WRITE.AF.ABREV EXTERNAL
7864: 0000:     INTEGER*2 WRITE.AF.ABREV
7865: 0000: END FUNCTION
7866: 0000: 
7867: 0000: 
7868: 0000: FUNCTION WRITE.AF.ABREV.UNLOCK EXTERNAL
7869: 0000:     INTEGER*2 WRITE.AF.ABREV.UNLOCK
7870: 0000: END FUNCTION
7871: 0000: 
7872: 0000:  %INCLUDE UBEXT.J86                       ! 2.7SH
7873: 0000: \/******************************************************************/
7874: 0000: \/*                                                                */
7875: 0000: \/* UOD Bookin FILE EXTERNAL FUNCTION DEFNS                        */
7876: 0000: \/*                                                                */
7877: 0000: \/* REFERENCE   : UBEXT.J86                                        */
7878: 0000: \/*                                                                */
7879: 0000: \/* VERSION A.          Stuart Highley            14 August 2008   */
7880: 0000: \/*                                                                */
7881: 0000: \/******************************************************************/
7882: 0000: 
7883: 0000:    FUNCTION UB.SET EXTERNAL
7884: 0000:       INTEGER*1 UB.SET
7885: 0000:    END FUNCTION
7886: 0000: 
7887: 0000:    FUNCTION READ.UB EXTERNAL
7888: 0000:       INTEGER*2 READ.UB
7889: 0000:    END FUNCTION
7890: 0000: 
7891: 0000:    FUNCTION WRITE.UB EXTERNAL
7892: 0000:       INTEGER*2 WRITE.UB
7893: 0000:    END FUNCTION
7894: 0000: 
7895: 0000: \/******************************************************************/
7896: 0000:  
7897: 0000: \*****************************************************************************
7898: 0000: \*****************************************************************************
7899: 0000: \***                                                                       ***
7900: 0000: \*** I N T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
7901: 0000: \***                                                                       ***
7902: 0000: \***   - FN.SECONDS                                                        ***
7903: 0000: \***   - FN.Z.PACK                                                         ***
7904: 0000: \***   - FN.VALIDATE.DATA                                                  ***
7905: 0000: \***   - FN.CONV.TO.INTEGER (SIGNED)                                       ***
7906: 0000: \***                                                                       ***
7907: 0000: \*****************************************************************************
7908: 0000: \*****************************************************************************
7909: 0000: 
7910: 0000: \******************************************************************************
7911: 0000: \***
7912: 0000: \***   Function : FN.SECONDS( TIME.VALUE$ )
7913: 0000: \***
7914: 0000: \***   Purpose  : Convert passed TIME in format HHMMSS to seconds
7915: 0000: \***
7916: 0000: \***   Output   : = 4 byte integer
7917: 0000: \***
7918: 0000: \******************************************************************************
7919: 0000: 
7920: 0000:    FUNCTION FN.SECONDS( TIME.VALUE$ )
7921: 0029: 
7922: 0029:       STRING                                                                  \
7923: 0029:          TIME.VALUE$
7924: 0029:       INTEGER*4                                                               \
7925: 0029:          FN.SECONDS
7926: 0029: 
7927: 0029:       FN.SECONDS = VAL(MID$(TIME.VALUE$,1,2)) * 3600 +                        \
7928: 00fb:                    VAL(MID$(TIME.VALUE$,3,2)) * 60 +                          \
7929: 00fb:                    VAL(MID$(TIME.VALUE$,5,2))
7930: 00fb: 
7931: 00fb:    END FUNCTION
7932: 011a: 
7933: 011a: \******************************************************************************
7934: 011a: \***
7935: 011a: \***   Function : FN.Z.PACK( NUM.STRING$, LENGTH% )
7936: 011a: \***
7937: 011a: \***   Purpose  : Zero pack (to the left) NUM.STRING$ out to LENGTH%
7938: 011a: \***
7939: 011a: \******************************************************************************
7940: 011a: 
7941: 011a:    FUNCTION FN.Z.PACK(NUM.STRING$, LENGTH%)
7942: 0143: 
7943: 0143:       STRING                                                                 \
7944: 0143:          FN.Z.PACK,                                                          \
7945: 0143:          NUM.STRING$
7946: 0143:       INTEGER*2                                                              \
7947: 0143:          LENGTH%
7948: 0143: 
7949: 0143:       FN.Z.PACK = RIGHT$(STRING$(LENGTH%,"0")+NUM.STRING$,LENGTH%)
7950: 018c: 
7951: 018c:    END FUNCTION
7952: 01aa: 
7953: 01aa: \******************************************************************************
7954: 01aa: \***
7955: 01aa: \***   Function : FN.VALIDATE.DATA( RECORD$, FORMAT% )
7956: 01aa: \***
7957: 01aa: \***   Purpose  : Test received record RECORD$ is in correct format for
7958: 01aa: \***              data format FORMAT%
7959: 01aa: \***
7960: 01aa: \***   Output   : = 0 if RECORD$ does not conform to data format FORMAT%
7961: 01aa: \***              = 1 if RECORD$ does conform to data format FORMAT%
7962: 01aa: \***
7963: 01aa: \******************************************************************************
7964: 01aa: 
7965: 01aa:    FUNCTION FN.VALIDATE.DATA(RECORD$, FORMAT%)
7966: 01d3: 
7967: 01d3:       STRING                                                                  \
7968: 01d3:          CHECK$,                                                              \
7969: 01d3:          DATA$,                                                               \
7970: 01d3:          RECORD$,                                                             \
7971: 01d3:          TEST$,                                                               \
7972: 01d3:          TYPE$,                                                               \
7973: 01d3:          VALID.FLAG$
7974: 01d3:       INTEGER*1                                                               \
7975: 01d3:          FORMAT%,                                                             \
7976: 01d3:          FN.VALIDATE.DATA
7977: 01d3:       INTEGER*2                                                               \
7978: 01d3:          BYTE.PTR%,                                                           \
7979: 01d3:          CHECK.PTR%,                                                          \
7980: 01d3:          REC.LENGTH%
7981: 01d3: 
7982: 01d3:       REC.LENGTH% = LEN(RECORD$)
7983: 01eb:       IF REC.LENGTH% < 1                                                      \
7984: 0220:       OR FORMAT% < 1 OR FORMAT% > REC.MAX% THEN BEGIN                         \
7985: 0220:          FN.VALIDATE.DATA = 0
7986: 022c:          EXIT FUNCTION
7987: 0237:       ENDIF
7988: 023f: 
7989: 023f:       CHECK$ = REC.CHECK$(FORMAT%)
7990: 026a:       CHECK.PTR% = 1
7991: 0278:       BYTE.PTR% = 1
7992: 0286:       VALID.FLAG$ = "Y"
7993: 029b: 
7994: 029b:       WHILE BYTE.PTR% <= REC.LENGTH%                                          \
7995: 02a6:         AND CHECK.PTR% < LEN(CHECK$)
7996: 02a6: 
7997: 02a6:          TYPE$ = MID$(CHECK$, CHECK.PTR%, 1)
7998: 02ca:          DATA$ = MID$(CHECK$, CHECK.PTR%+1, 1)
7999: 02ef:          CHECK.PTR% = CHECK.PTR% + 2
8000: 02fc: 
8001: 02fc:          IF TYPE$ = "B" THEN BEGIN
8002: 0317:             IF MID$(RECORD$, BYTE.PTR%, 1) <> DATA$ THEN BEGIN
8003: 034d:                VALID.FLAG$ = "N"
8004: 0362:             ENDIF
8005: 036a:             BYTE.PTR% = BYTE.PTR% + 1
8006: 0376:          ENDIF
8007: 037e: 
8008: 037e:          IF TYPE$ = "N" THEN BEGIN
8009: 039c:             WHILE BYTE.PTR% <= REC.LENGTH% AND DATA$ <> CHR$(0)
8010: 03a7:                TEST$ = MID$(RECORD$, BYTE.PTR%, 1)
8011: 03c9:                IF (TEST$ < "0" OR TEST$ > "9")                               \
8012: 0484:               AND TEST$ <> "-" AND TEST$ <> "+"                              \
8013: 0484:               AND TEST$ <> "." THEN VALID.FLAG$ = "N"
8014: 0499:                BYTE.PTR% = BYTE.PTR% + 1
8015: 04a5:                DATA$ = CHR$(ASC(DATA$) - 1)
8016: 04ca:             WEND
8017: 050a:             IF BYTE.PTR% > REC.LENGTH%                                       \
8018: 0547:            AND DATA$ <> CHR$(0) THEN VALID.FLAG$ = "N"
8019: 055c:          ENDIF
8020: 0564: 
8021: 0564:          IF TYPE$ = "A" THEN BYTE.PTR% = BYTE.PTR% + ASC(DATA$)
8022: 0590: 
8023: 0590:       WEND
8024: 05c5: 
8025: 05c5:       IF CHECK.PTR% <= LEN(CHECK$) THEN VALID.FLAG$ = "N"
8026: 05ee: 
8027: 05ee:       IF VALID.FLAG$ = "Y" THEN BEGIN
8028: 0609:          FN.VALIDATE.DATA = 1
8029: 0615:          LAST.ACTIVE.DATE$ = DATE$
8030: 062d:          LAST.ACTIVE% = FN.SECONDS(TIME$)
8031: 0655:       ENDIF ELSE BEGIN
8032: 065d:          FN.VALIDATE.DATA = 0
8033: 0669:       ENDIF
8034: 0671: 
8035: 0671:    END FUNCTION
8036: 068d: 
8037: 068d: \******************************************************************************
8038: 068d: \***
8039: 068d: \***   Function : FN.CONV.TO.INTEGER( NUM.STRING$ )
8040: 068d: \***
8041: 068d: \***   Purpose  : Convert passed string to a 1, 2 or 4 byte (dependant on
8042: 068d: \***              length of passed string) signed integer.
8043: 068d: \***
8044: 068d: \***   Output   : = 1, 2 or 4 byte integer
8045: 068d: \***
8046: 068d: \******************************************************************************
8047: 068d: 
8048: 068d:    FUNCTION FN.CONV.TO.INTEGER( NUM.STRING$ )
8049: 06b6: 
8050: 06b6:       INTEGER*4                                                              \
8051: 06b6:          BYTE%,                                                              \
8052: 06b6:          BYTE.POS%,                                                          \
8053: 06b6:          BYTES%,                                                             \
8054: 06b6:          SIGN.BIT%
8055: 06b6:       REAL                                                                   \
8056: 06b6:          FN.CONV.TO.INTEGER,                                                 \
8057: 06b6:          NUMBER
8058: 06b6:       STRING                                                                 \
8059: 06b6:          NUM.STRING$
8060: 06b6: 
8061: 06b6:       BYTES% = LEN(NUM.STRING$)
8062: 06db:       NUMBER = 0
8063: 06f6:       FOR BYTE.POS% = 1 TO BYTES%
8064: 070e:          BYTE% = ASC(MID$(NUM.STRING$, BYTE.POS%, 1))
8065: 073f:          IF BYTE.POS% = BYTES% THEN BEGIN
8066: 075a:             SIGN.BIT% = BYTE% AND 80h
8067: 0773:             BYTE% = BYTE% AND (SIGN.BIT% XOR 0FFh)
8068: 079f:          ENDIF
8069: 07a7:          NUMBER = NUMBER + (100h ^ (BYTE.POS% - 1)) * BYTE%
8070: 07fd:       NEXT BYTE.POS%
8071: 082a:       IF SIGN.BIT% <> 0 THEN NUMBER = NUMBER - (80h * (100h ^ (BYTES% - 1)))
8072: 0893: 
8073: 0893:       FN.CONV.TO.INTEGER = NUMBER
8074: 08a9: 
8075: 08a9:    END FUNCTION
8076: 08c2: 
8077: 08c2: \******************************************************************************
8078: 08c2: \***
8079: 08c2: \***   Function : FN.ZERO.PL( TEXT$,
8080: 08c2: \***                          LENGTH% )
8081: 08c2: \***
8082: 08c2: \***   Purpose  : Zero pack, to the left, the passed string TEXT$ to the
8083: 08c2: \***              specified length.
8084: 08c2: \***
8085: 08c2: \******************************************************************************
8086: 08c2: 
8087: 08c2:    FUNCTION FN.ZERO.PL(TEXT$,LENGTH%)
8088: 08eb: 
8089: 08eb:       STRING    FN.ZERO.PL, TEXT$
8090: 08eb:       INTEGER*2 LENGTH%
8091: 08eb: 
8092: 08eb:       FN.ZERO.PL = RIGHT$( STRING$( LENGTH%, "0" ) + TEXT$ , LENGTH% )
8093: 0934: 
8094: 0934:    END FUNCTION
8095: 0952: 
8096: 0952: \*****************************************************************************
8097: 0952: \*****************************************************************************
8098: 0952: \***                                                                       ***
8099: 0952: \*** E N D   OF   G L O B A L   D E F N S   F O R   P S S 3 7              ***
8100: 0952: \***                                                                       ***
8101: 0952: \*****************************************************************************
8102: 0952: \*****************************************************************************
8103: 0952: 
8104: 0952:    %INCLUDE PSBF06E.J86
8105: 0952: rem\
8106: 0952: \*******************************************************************************
8107: 0952: \*******************************************************************************
8108: 0952: \***
8109: 0952: \***
8110: 0952: \***         INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT external definition
8111: 0952: \***
8112: 0952: \***         REFERENCE     : PSBF06E.J86
8113: 0952: \***
8114: 0952: \***         Version A     Bruce Scriver                  24th February 1986
8115: 0952: \***
8116: 0952: \***         Version B     Andrew Wedgeworth                  15th July 1992
8117: 0952: \***         Removal of redundant parameters, and inclusion of 
8118: 0952: \***         CALC.BAR.CODE.CHECK.DIGIT as a variable to hold the return code.
8119: 0952: \***
8120: 0952: \*******************************************************************************
8121: 0952: \*******************************************************************************
8122: 0952: 
8123: 0952:    FUNCTION CALC.BAR.CODE.CHECK.DIGIT (BAR.CODE.12$)                           \
8124: 0952:    EXTERNAL
8125: 0952:    ! 3 parameters removed from here                                    ! BAW
8126: 0952: 
8127: 0952:       STRING    BAR.CODE.12$
8128: 0952:    ! 3 variables removed from here                                     ! BAW
8129: 0952:    
8130: 0952:       INTEGER*2 CALC.BAR.CODE.CHECK.DIGIT                              ! BAW
8131: 0952:       
8132: 0952: 
8133: 0952:    END FUNCTION
8134: 0952: 
8135: 0952:    %INCLUDE PDTWFEXT.J86
8136: 0952: \*****************************************************************************
8137: 0952: \*****************************************************************************
8138: 0952: \***
8139: 0952: \***       EXTERNAL FILE DEFINITIONS FOR PDTWF
8140: 0952: \***
8141: 0952: \***       REFERENCE: PDTWFEXT.J86
8142: 0952: \***
8143: 0952: \*****************************************************************************
8144: 0952: \*****************************************************************************
8145: 0952: 
8146: 0952:    FUNCTION PDTWF.SET EXTERNAL
8147: 0952:    END FUNCTION
8148: 0952:    
8149: 0952:    FUNCTION READ.PDTWF EXTERNAL
8150: 0952:       INTEGER*2 READ.PDTWF
8151: 0952:    END FUNCTION
8152: 0952:    
8153: 0952:    FUNCTION WRITE.PDTWF EXTERNAL
8154: 0952:       INTEGER*2 WRITE.PDTWF
8155: 0952:    END FUNCTION
8156: 0952:    
8157: 0952:    
8158: 0952: 
8159: 0952:    %INCLUDE CMPDATE.J86                                                ! ENS
8160: 0952: !********************************************************************
8161: 0952: !***
8162: 0952: !***    INCLUDED CODE:  CMPDATE.J86
8163: 0952: !***    AUTHOR:         Stuart William McConnachie
8164: 0952: !***    DATE:           27th January 1997
8165: 0952: !***
8166: 0952: !********************************************************************
8167: 0952: !***   
8168: 0952: !***    Version B            Nik Sen                 30th March 1998
8169: 0952: !***    Changes to cope with a date of '000000' by replacing it with
8170: 0952: !***    '850101' before comparison. An all zero's date is valid in 
8171: 0952: !***    certain date fields and CMPDATE was returning the wrong result
8172: 0952: !***    when comparing with an actual date. Also change to cope with
8173: 0952: !***    dates of '999999' as some date fields are initialised to this
8174: 0952: !***    as a high value.
8175: 0952: !***
8176: 0952: !***    Version C    Stuart William McConnachie   20th December 1999
8177: 0952: !***    Improved function efficiency by changing tests for high and
8178: 0952: !***    low values, added above, to integers (rather than strings).
8179: 0952: !***    Also, using 850101 as a replacement for 000000, will not give
8180: 0952: !***    valid results after 350101 because of the 50 year wrap, so
8181: 0952: !***    corrected this.
8182: 0952: !***
8183: 0952: !***    Version D.  Stuart William McConnachie    26th February 2006
8184: 0952: !***    Place this code in it's own module in FUNLIB.  Make all
8185: 0952: !***    the functions herein EXTERNAL accordingly.
8186: 0952: !***
8187: 0952: !********************************************************************
8188: 0952: !***    
8189: 0952: !***    The following functions compare dates, checking for
8190: 0952: !***    century boundries.  Dates in the 50 years prior to the
8191: 0952: !***    compared date are less than the compared date, dates in
8192: 0952: !***    50 years after the compared date are greater than the
8193: 0952: !***    compared date.
8194: 0952: !***    Can handle dates in both packed and unpacked formats, or
8195: 0952: !***    a mixture of both.
8196: 0952: !***    In the case of a error, for example IH after detecting
8197: 0952: !***    illegal characters in VAL, the functions default to
8198: 0952: !***    comparing strings without testing for a change of century.
8199: 0952: !***
8200: 0952: !***    DATE.GT(DATE1$, DATE2$)  same as  DATE1$ >  DATE2$
8201: 0952: !***    DATE.GE(DATE1$, DATE2$)  same as  DATE1$ >= DATE2$
8202: 0952: !***    DATE.LT(DATE1$, DATE2$)  same as  DATE1$ <  DATE2$
8203: 0952: !***    DATE.LE(DATE1$, DATE2$)  same as  DATE1$ <= DATE2$
8204: 0952: !***
8205: 0952: !********************************************************************
8206: 0952: 
8207: 0952: FUNCTION DATE.GT(DATE1$, DATE2$) EXTERNAL                               !DSWM
8208: 0952:     STRING    DATE1$, DATE2$
8209: 0952:     INTEGER*1 DATE.GT
8210: 0952: END FUNCTION
8211: 0952: 
8212: 0952: 
8213: 0952: FUNCTION DATE.GE(DATE1$, DATE2$) EXTERNAL                               !DSWM
8214: 0952:     STRING    DATE1$, DATE2$
8215: 0952:     INTEGER*1 DATE.GE
8216: 0952: END FUNCTION
8217: 0952: 
8218: 0952: 
8219: 0952: FUNCTION DATE.LT(DATE1$, DATE2$) EXTERNAL                               !DSWM
8220: 0952:     STRING    DATE1$, DATE2$
8221: 0952:     INTEGER*1 DATE.LT
8222: 0952: END FUNCTION
8223: 0952: 
8224: 0952: 
8225: 0952: FUNCTION DATE.LE(DATE1$, DATE2$) EXTERNAL                               !DSWM
8226: 0952:     STRING    DATE1$, DATE2$
8227: 0952:     INTEGER*1 DATE.LE
8228: 0952: END FUNCTION
8229: 0952: 
8230: 0952: 
8231: 0952: 
8232: 0952:    FUNCTION ADXSTART(NAME$, PARM$, MESS$) EXTERNAL                     
8233: 0952:       INTEGER*2 ADXSTART                                          
8234: 0952:       STRING    NAME$, PARM$, MESS$                                   
8235: 0952:    END FUNCTION                                                        
8236: 0952:    
8237: 0952: \******************************************************************************
8238: 0952: \***
8239: 0952: \***   Function : FN.TRANSLATE.TEXT( TEXT$ )
8240: 0952: \***
8241: 0952: \***   Purpose  : Translate passed text from 4680 character set to PDT
8242: 0952: \***              character set
8243: 0952: \***
8244: 0952: \***   Output   : = string
8245: 0952: \***
8246: 0952: \******************************************************************************
8247: 0952: 
8248: 0952:    FUNCTION FN.TRANSLATE.TEXT( TEXT$ )                                  
8249: 097b: 
8250: 097b:       STRING                                                            \
8251: 097b:         FN.TRANSLATE.TEXT,                                              \
8252: 097b:         TEXT$                                                           
8253: 097b: 
8254: 097b:       FN.TRANSLATE.TEXT = TRANSLATE$(TEXT$, TRANS.FROM$, TRANS.TO$)     
8255: 09ae: 
8256: 09ae:    END FUNCTION                                                         
8257: 09cc:        
8258: 09cc: 
8259: 09cc:    SUB PSS3703 PUBLIC
8260: 09f0:           
8261: 09f0: REAL GAP
8262: 09f0: 
8263: 09f0: INTEGER*1                                                        \
8264: 09f0:           BAR.CODE.PTR%,                                                 \ 
8265: 09f0:        CURR.SESS.NUM%,                                                 \
8266: 09f0:        EVENT.NUMBER%,                                                 \
8267: 09f0:        RES.POS%,                                                 \
8268: 09f0:        SB.EVENT.NO%,                                                 \
8269: 09f0:        SB.FILE.SESS.NUM%,                                          \
8270: 09f0:        SB.INTEGER%,                                                    \
8271: 09f0:        FINISHED,                                                       \
8272: 09f0:        SWAPPED                                                         !
8273: 09f0:        
8274: 09f0: INTEGER*2                                                        \
8275: 09f0:        ADX.FUNCTION%,                                                 \ 
8276: 09f0:        ADX.PARM.1%,                                                 \ 
8277: 09f0:         BAR.CODES%,                                                     \
8278: 09f0:         BC%,                                                            \
8279: 09f0:         CD%,                                                            \ 
8280: 09f0:         DATA.LENGTH%,                                                   \
8281: 09f0:         FILE.HEADER.LISTS%,                                             \
8282: 09f0:         FILE.TRAILER.LISTS%,                                            \
8283: 09f0:         INACTIVITY.SHUTDOWN%,                                           \ 
8284: 09f0:         INDX%,                                                          \ 
8285: 09f0:         ITEM%,                                                          \
8286: 09f0:         ITEM.COUNT%,                                                    \
8287: 09f0:         ITEM.TRAILER.COUNT%,                                            \
8288: 09f0:         LAST.REC%,                                                      \
8289: 09f0:         LIST%,                                                          \
8290: 09f0:         LIST.COUNT%,                                                    \
8291: 09f0:         LIST.EXTRACTION%,                                               \
8292: 09f0:         LIST.TRAILER.ITEMS%,                                            \
8293: 09f0:         LIST.TRANSMIT.PTR%,                                             \
8294: 09f0:         LOG.ON.DISABLE%,                                          \ 
8295: 09f0:        MESSAGE.NO%,                                                 \
8296: 09f0:         MESSAGE.NUMBER%,                                          \ 
8297: 09f0:        NUMBER.OF.ITEMS%,                                               \
8298: 09f0:         NUMBER.OF.LISTS%,                                               \
8299: 09f0:         POSITION%,                                                      \
8300: 09f0:         REP%,                                                           \ 
8301: 09f0:        RETURN.CODE%,                                                 \ 
8302: 09f0:         REQ.LIST.PTR%,                                                  \
8303: 09f0:        SB.FILE.REP.NUM%,                                               \ DNS
8304: 09f0:         SECTOR.COUNT%,                                                  \
8305: 09f0:         SORT.PTR%,                                                      \
8306: 09f0:         START.TIME%,                                                    \ 
8307: 09f0:         TEMP.EVENT%,                                                    \
8308: 09f0:        TOTAL.WAIT.TIME%                                                ! ASMG
8309: 09f0:        
8310: 09f0:        
8311: 09f0:        
8312: 09f0: INTEGER*4                                                        \
8313: 09f0:           ADX.RET.CODE%,                                                  \
8314: 09f0:           A%,                                                        \
8315: 09f0:           B%,                                                        \
8316: 09f0:         CSRWF.EXISTS%,                                                  \
8317: 09f0:         I%,                                                             \
8318: 09f0:         LISTS.CANCELLED%,                                               \
8319: 09f0:           MAX%,                                                         \
8320: 09f0:         NOW%,                                                           \
8321: 09f0:         RECORDS.WRITTEN%,                                               \
8322: 09f0:         TIMEOUT.VALUE%       
8323: 09f0:        
8324: 09f0: REAL                                                               \
8325: 09f0:         TIME.DIFFERENCE       
8326: 09f0: 
8327: 09f0: STRING                                                               \
8328: 09f0:         ADX.PARM.2$,                                                 \
8329: 09f0:         APPL$,                                                          \
8330: 09f0:         PDT.ACTION$,                                                    \
8331: 09f0:         BC$,                                                            \
8332: 09f0:         CITEM.RECORD$,                                                  \
8333: 09f0:         CITEM.SECTOR.ALTERED$,                                          \
8334: 09f0:         CONTROL$,                                                       \
8335: 09f0:        COUNT.DATE$,                                                    \
8336: 09f0:         CURR.BKRM.COUNT$,                                               \
8337: 09f0:         CURR.BOOTS.CODE$,                                               \
8338: 09f0:         CURR.COUNT.DATE$,                                               \
8339: 09f0:         CURR.COUNT.TIME$,                                               \
8340: 09f0:         CURR.DETAIL.USER$,                                              \
8341: 09f0:         CURR.HEADER.USER$,                                              \
8342: 09f0:         CURR.LIST$,                                                     \
8343: 09f0:         CURR.PRICE$,                                                    \
8344: 09f0:         CURR.SHOP.COUNT$,                                               \
8345: 09f0:         CURR.TIME$,                                                     \
8346: 09f0:         DATA$,                                                          \
8347: 09f0:        END.OF.CITEM$,                                                  \
8348: 09f0:         ENQ$,                                                           \
8349: 09f0:         FILLER$,                                                        \
8350: 09f0: \       IRF.PRICE.TYPE$,                                                \ GSWM
8351: 09f0:         ITEM.ON.IDF.FLAG$,                                              \
8352: 09f0:         KEY.VALUE$,                                                     \
8353: 09f0:         LAST.TIME$,                                                     \
8354: 09f0:         LIST.BC$,                                                       \
8355: 09f0:         LIST.NAME$,                                                     \
8356: 09f0:         LIST.NUMBER$,                                                   \
8357: 09f0:         LIST.STATUS$,                                                   \
8358: 09f0:         LIST.TYPE$,                                                     \
8359: 09f0:         MORE.FLAG$,                                                     \
8360: 09f0:         NAK.LINE.1$,                                                    \
8361: 09f0:         NAK.LINE.2$,                                                    \
8362: 09f0:         NAK.LINE.3$,                                                    \
8363: 09f0:         PDTWF.HEADER.RECORD$,                                           \
8364: 09f0:         PILST.EOF.FLAG$,                                                \
8365: 09f0:         PILST.RECORD$,                                                  \
8366: 09f0:         PRICE$,                                                         \
8367: 09f0:         RECOUNT.DATE$,                                                  \
8368: 09f0:         REQ.BC$,                                                        \
8369: 09f0:         REQ.FLAG$,                                                      \
8370: 09f0:         REQ.LIST$,                                                      \
8371: 09f0:         SAVED.PIPE.OUT$,                                                \
8372: 09f0:        SB.ACTION$,                                                    \ 
8373: 09f0:        SB.ERRF$,                                                      \ 
8374: 09f0:        SB.ERRL$,                                                      \ 
8375: 09f0:        SB.ERRS$,                                                      \ 
8376: 09f0:        SB.MESSAGE$,                                                   \ 
8377: 09f0:        SB.UNIQUE$,                                                    \ 
8378: 09f0:        SB.STRING$,                                                    \
8379: 09f0:         SECTOR$,                                                        \
8380: 09f0:         SELECT.ALL.FLAG$,                                               \
8381: 09f0:         SORT.DATE$,                                                     \
8382: 09f0:         SORT.ORDER$,                                                    \
8383: 09f0:        TEMP$,                                                    \ 
8384: 09f0:        CURRENT.KEY$,                                             \ 
8385: 09f0:         TEMP.LIST$,                                                     \
8386: 09f0:         TEMP.PDTWF.RECORD$,                                             \ 
8387: 09f0:         TEMP.STATE$,                                                    \
8388: 09f0:         TEST.LIST$,                                                     \
8389: 09f0:         UNIQUE.2$,                                                      \
8390: 09f0:         USER.DATA$,                                                 \
8391: 09f0:        VAR.STRING.1$,                                                 \ 
8392: 09f0:        VAR.STRING.2$                                                 ! 
8393: 09f0:    
8394: 09f0:    
8395: 09f0: \******************************************************************************
8396: 09f0: \******************************************************************************
8397: 09f0: \***                                                                        ***
8398: 09f0: \***   M A I N L I N E   C O D E                                            ***
8399: 09f0: \***                                                                        ***
8400: 09f0: \******************************************************************************
8401: 09f0: \******************************************************************************
8402: 09f0: 
8403: 09f0: \******************************************************************************
8404: 09f0: \***
8405: 09f0: \***   for any errors, pass control to ERROR.DETECTED
8406: 09f0: \***
8407: 09f0: \***   pass control to the appropriate section of code, depending upon   
8408: 09f0: \***   the value of RECEIVE.STATE$
8409: 09f0: \***
8410: 09f0: \***   MODULE.EXIT:
8411: 09f0: \***     return to calling module
8412: 09f0: \***
8413: 09f0: \***   PROGRAM.EXIT:
8414: 09f0: \***     stop
8415: 09f0: \***
8416: 09f0: \******************************************************************************
8417: 09f0: 
8418: 09f0: ON ERROR GOTO ERROR.DETECTED
8419: 0a05: 
8420: 0a05:       IF MATCH(RECEIVE.STATE$,"CDEFGHI",1) > 0 THEN BEGIN ! ELC
8421: 0a2b:          ON (ASC(RECEIVE.STATE$) - ASC("B")) GOSUB                       \
8422: 0a70:                RECEIVED.EPSOM.FILE.HEADER,                            \
8423: 0a70:                RECEIVED.EPSOM.LIST.HEADER,                            \
8424: 0a70:                RECEIVED.EPSOM.LIST.COUNT,                            \
8425: 0a70:                RECEIVED.EPSOM.LIST.TRAILER,                            \
8426: 0a70:               RECEIVED.EPSOM.FILE.TRAILER,                            \
8427: 0a70:                RECEIVED.EPSOM.LIST.REQUEST,                            \
8428: 0a70:                RECEIVED.EPSOM.EOT
8429: 0a70:         GOTO MODULE.EXIT       
8430: 0a7a:       ENDIF
8431: 0a82:               
8432: 0a82: MODULE.EXIT:
8433: 0a92: 
8434: 0a92:    EXIT SUB    
8435: 0a9d:    
8436: 0a9d: PROGRAM.EXIT:
8437: 0aad: 
8438: 0aad:    STOP
8439: 0aba:    
8440: 0aba:                  
8441: 0aba: \******************************************************************************
8442: 0aba: \******************************************************************************
8443: 0aba: \***                                                                        ***
8444: 0aba: \***   S U B R O U T I N E S                                                ***
8445: 0aba: \***                                                                        ***
8446: 0aba: \******************************************************************************
8447: 0aba: \******************************************************************************
8448: 0aba: 
8449: 0aba: \******************************************************************************
8450: 0aba: \***
8451: 0aba: \***   RECEIVED.EPSOM.FILE.HEADER:                              STATE : C
8452: 0aba: \***
8453: 0aba: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8454: 0aba: \***      return
8455: 0aba: \***
8456: 0aba: \***      if received terminal number or application number is invalid then
8457: 0aba: \***      set RECEIVE.STATE$ to "*" and RETURN
8458: 0aba: \***
8459: 0aba: \***      set PDT action to "COUNTS"
8460: 0aba: \***      set FILE.HEADER.LISTS% to number of lists in file
8461: 0aba: \***      reset LIST.COUNT% counter to 0
8462: 0aba: \***
8463: 0aba: \***      open STKMQ file if not already open
8464: 0aba: \***
8465: 0aba: \***   EPSOM.FILE.HEADER.CONTINUE:
8466: 0aba: \***   RETURN
8467: 0aba: \***
8468: 0aba: \******************************************************************************
8469: 0aba: 
8470: 0aba:    RECEIVED.EPSOM.FILE.HEADER:                                          
8471: 0aca: 
8472: 0aca:       SB.MESSAGE$ = "PDT Support - EPSOM File header received"          
8473: 0adf:       GOSUB SB.BG.MESSAGE
8474: 0af1: 
8475: 0af1:       IF FN.VALIDATE.DATA(DATA.IN$, 2) = 0 THEN BEGIN
8476: 0b13:          RECEIVE.STATE$ = "*"
8477: 0b2a:          RETURN
8478: 0b3a:       ENDIF
8479: 0b42:       
8480: 0b42:       CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " +              \
8481: 0bd6:                         "EPSOM list count received at " +              \
8482: 0bd6:                      LEFT$(TIME$,2) + ":" +                            \
8483: 0bd6:                      MID$(TIME$,3,2) + ":" +                            \
8484: 0bd6:                      RIGHT$(TIME$,2)
8485: 0bd6:       GOSUB LOG.TO.AUDIT.FILE
8486: 0be8: 
8487: 0be8:       IF MID$(DATA.IN$, 7, 6) <> CURR.TERMINAL$                         \
8488: 0c73:       OR MID$(DATA.IN$, 3, 2) <> APPLICATION.NO$ THEN BEGIN             
8489: 0c73:          RECEIVE.STATE$ = "*"
8490: 0c8a:          RETURN
8491: 0c9a:       ENDIF
8492: 0ca2: 
8493: 0ca2:       PDT.ACTION$ = "COUNTS"
8494: 0cb7:       FILE.HEADER.LISTS% = VAL(MID$(DATA.IN$, 5, 2))
8495: 0ce0:       LIST.COUNT% = 0
8496: 0cee: 
8497: 0cee: ! 7 LINES Deleted from here                                            ! ASMG
8498: 0cee: 
8499: 0cee:    EPSOM.FILE.HEADER.CONTINUE:                                         
8500: 0cfe: 
8501: 0cfe:    RETURN
8502: 0d0e: 
8503: 0d0e: \******************************************************************************
8504: 0d0e: \***
8505: 0d0e: \***   RECEIVED.EPSOM.LIST.HEADER:                              STATE : D
8506: 0d0e: \***
8507: 0d0e: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8508: 0d0e: \***      return
8509: 0d0e: \***
8510: 0d0e: \***      set CURR.LIST$ to received list number
8511: 0d0e: \***      set HEADER.USER$ to received 'user data'
8512: 0d0e: \***
8513: 0d0e: \***   RETURN
8514: 0d0e: \***
8515: 0d0e: \******************************************************************************
8516: 0d0e: 
8517: 0d0e:    RECEIVED.EPSOM.LIST.HEADER:                       
8518: 0d1e:    
8519: 0d1e:       SB.MESSAGE$ = "PDT Support - EPSOM List header received"         
8520: 0d33:       GOSUB SB.BG.MESSAGE
8521: 0d45: 
8522: 0d45:       IF FN.VALIDATE.DATA(DATA.IN$, 3) = 0 THEN BEGIN
8523: 0d67:          RECEIVE.STATE$ = "*"
8524: 0d7e:          RETURN
8525: 0d8e:       ENDIF
8526: 0d96: 
8527: 0d96:       CURR.LIST$ = MID$(DATA.IN$, 3, 4)
8528: 0dbb:       CURR.HEADER.USER$ = MID$(DATA.IN$, 7, 5)
8529: 0de0:       LIST.BC$ = MID$(CURR.HEADER.USER$, 3, 1)
8530: 0e02:       ITEM.COUNT% = 0
8531: 0e10: 
8532: 0e10:       IF STKMQ.OPEN.FLAG$ <> "Y" THEN BEGIN                         ! ASMG
8533: 0e31:          IF END# STKMQ.SESS.NUM% THEN OPEN.ERROR                    ! ASMG
8534: 0e4d:          CURR.SESS.NUM% = STKMQ.SESS.NUM%                           ! ASMG
8535: 0e5f:          OPEN STKMQ.FILE.NAME$ AS STKMQ.SESS.NUM% BUFFSIZE 512 READONLY\ ASMG
8536: 0e88:          NODEL APPEND                                               ! ASMG
8537: 0e88:          STKMQ.OPEN.FLAG$ = "Y"                                     ! ASMG
8538: 0e9f:         TOTAL.WAIT.TIME% = 0                                       ! ASMG
8539: 0ead:       ENDIF                                                         ! ASMG
8540: 0eb5: 
8541: 0eb5:    RETURN
8542: 0ec5: 
8543: 0ec5: \******************************************************************************
8544: 0ec5: \***
8545: 0ec5: \***   RECEIVED.EPSOM.LIST.COUNT:                               STATE : E
8546: 0ec5: \***
8547: 0ec5: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8548: 0ec5: \***      return
8549: 0ec5: \***
8550: 0ec5: \***      set CURR.BOOTS.CODE$ to received boots code
8551: 0ec5: \***      set CURR.SHOP.COUNT$ to received shop count
8552: 0ec5: \***      set CURR.BKRM.COUNT$ to received back-room count
8553: 0ec5: \***      set CURR.COUNT.DATE$ to received date of count
8554: 0ec5: \***      set CURR.COUNT.TIME$ to received time of count
8555: 0ec5: \***      set CURR.PRICE$ to received price
8556: 0ec5: \***      set DETAIL.USER$ to received 'user data' (unused at present)
8557: 0ec5: \***
8558: 0ec5: \***      if any of the above values are invalid then set RECEIVE.STATE$ to
8559: 0ec5: \***      "*" and return
8560: 0ec5: \***
8561: 0ec5: \***      write a transaction type 13 to the STKMQ file if current list is
8562: 0ec5: \***      not a training list (i.e type "Z")
8563: 0ec5: \***
8564: 0ec5: \***      increment ITEM.COUNT% by 1
8565: 0ec5: \***
8566: 0ec5: \***   EPSOM.LIST.ITEM.CONTINUE:
8567: 0ec5: \***   RETURN
8568: 0ec5: \***
8569: 0ec5: \******************************************************************************
8570: 0ec5: 
8571: 0ec5: RECEIVED.EPSOM.LIST.COUNT:                          
8572: 0ed5:    
8573: 0ed5:       IF FN.VALIDATE.DATA(DATA.IN$, 4) = 0 THEN BEGIN
8574: 0ef7:          RECEIVE.STATE$ = "*"
8575: 0f0e:          RETURN
8576: 0f1e:       ENDIF
8577: 0f26: 
8578: 0f26:       CURR.BOOTS.CODE$ = FN.Z.PACK(STR$(VAL(MID$(DATA.IN$, 3, 7))), 8)
8579: 0f76:       CURR.SHOP.COUNT$ = MID$(DATA.IN$, 10, 4)
8580: 0f9b:       CURR.BKRM.COUNT$ = MID$(DATA.IN$, 14, 4)
8581: 0fc0:       CURR.COUNT.DATE$ = MID$(DATA.IN$, 18, 6)
8582: 0fe5:       CURR.COUNT.TIME$ = MID$(DATA.IN$, 24, 4)
8583: 100a:       CURR.PRICE$ = MID$(DATA.IN$, 28, 6)
8584: 102f:       CURR.DETAIL.USER$ = MID$(DATA.IN$, 34, 9)
8585: 1054:       IF CURR.COUNT.DATE$ = "202020" THEN CURR.COUNT.DATE$ = "000000"
8586: 107c:       IF CURR.COUNT.TIME$ = "2020" THEN CURR.COUNT.TIME$ = "0000"
8587: 10a4: 
8588: 10a4:       IF VAL(CURR.COUNT.DATE$) < 0 OR VAL(CURR.COUNT.TIME$) < 0        \ DNS
8589: 1166:       OR VAL(CURR.PRICE$) < 0 THEN BEGIN
8590: 1166:          RECEIVE.STATE$ = "*"
8591: 117d:          RETURN
8592: 118d:       ENDIF
8593: 1195: 
8594: 1195:       IF LIST.BC$ <> "Z" THEN BEGIN                                    
8595: 11b3:          STKMQ.TRANS.TYPE$ = PACK$("13")
8596: 11cf:          STKMQ.DATE$ = PACK$(DATE$)
8597: 11ec:          STKMQ.TIME$ = PACK$(TIME$)
8598: 1209:          STKMQ.LIST.NUMBER$ = FN.Z.PACK(CURR.LIST$, 4)
8599: 122a:          STKMQ.ITEM.NUMBER$ = FN.Z.PACK(MID$(CURR.DETAIL.USER$, 1, 2), 2)
8600: 125f:          STKMQ.ITEM.STATUS$ = FN.Z.PACK(MID$(CURR.DETAIL.USER$, 3, 1), 1)
8601: 1294:          STKMQ.BOOTS.CODE$ = PACK$(CURR.BOOTS.CODE$)
8602: 12b4:          STKMQ.COUNT.DATE$ = PACK$(FN.Z.PACK(CURR.COUNT.DATE$,6))
8603: 12da:          STKMQ.COUNT.TIME$ = PACK$(FN.Z.PACK(CURR.COUNT.TIME$,4))
8604: 1300:          STKMQ.PRICE$ = PACK$(FN.Z.PACK(CURR.PRICE$,10))
8605: 1326:          STKMQ.SHOP.COUNT$ = CURR.SHOP.COUNT$
8606: 1341:          STKMQ.BKRM.COUNT$ = CURR.BKRM.COUNT$
8607: 135c:          STKMQ.RECORD$ = STKMQ.RECORD.DELIMITER$ +                      \
8608: 1438:                          STKMQ.TRANS.TYPE$ +                            \
8609: 1438:                          STKMQ.FIELD.DELIMITER$ +                       \
8610: 1438:                          STKMQ.DATE$ +                                  \
8611: 1438:                          STKMQ.TIME$ +                                  \
8612: 1438:                          STKMQ.LIST.NUMBER$ +                           \
8613: 1438:                          STKMQ.ITEM.NUMBER$ +                           \
8614: 1438:                          STKMQ.ITEM.STATUS$ +                           \
8615: 1438:                          STKMQ.BOOTS.CODE$ +                            \
8616: 1438:                          STKMQ.COUNT.DATE$ +                            \
8617: 1438:                          STKMQ.COUNT.TIME$ +                            \
8618: 1438:                          STKMQ.PRICE$ +                                 \
8619: 1438:                          STKMQ.FIELD.DELIMITER$ +                       \
8620: 1438:                          STKMQ.SHOP.COUNT$ +                            \
8621: 1438:                          STKMQ.FIELD.DELIMITER$ +                       \
8622: 1438:                          STKMQ.BKRM.COUNT$ +                            \
8623: 1438:                          STKMQ.RECORD.DELIMITER$ +                      \
8624: 1438:                          STKMQ.ENDREC.MARKER$
8625: 1438:          CURR.SESS.NUM% = STKMQ.SESS.NUM%
8626: 144a:          CURRENT.KEY$ = ""
8627: 145f:          RC% = WRITE.STKMQ                                          
8628: 1473:         IF RC% = 1 THEN  GOTO WRITE.ERROR                            
8629: 1488:       ENDIF                                                             
8630: 1490: 
8631: 1490:       ITEM.COUNT% = ITEM.COUNT% + 1
8632: 149c: 
8633: 149c: EPSOM.LIST.ITEM.CONTINUE:                                           
8634: 14ac: 
8635: 14ac: RETURN
8636: 14bc: 
8637: 14bc: \******************************************************************************
8638: 14bc: \***
8639: 14bc: \***   RECEIVED.EPSOM.LIST.TRAILER:                             STATE : F
8640: 14bc: \***
8641: 14bc: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8642: 14bc: \***      return
8643: 14bc: \***
8644: 14bc: \***      set TRAILER.LIST$ to list number on list trailer record
8645: 14bc: \***      set LIST.TRAILER.ITEMS% to number of lists value on trailer record
8646: 14bc: \***
8647: 14bc: \***      if TRAILER.LIST$ does not equal CURR.LIST$ then set RECEIEVE.STATE$
8648: 14bc: \***      to "*" and return
8649: 14bc: \***
8650: 14bc: \***      if LIST.TRAILER.ITEMS% does not equal ITEM.COUNT% then
8651: 14bc: \***         log an event 5 (count discrepancy)
8652: 14bc: \***      endif
8653: 14bc: \***
8654: 14bc: \***      write a transaction type 14 to the STKMQ file if current list is
8655: 14bc: \***      a training list (i.e type "Z")
8656: 14bc: \***
8657: 14bc: \***      increment LIST.COUNT% by 1
8658: 14bc: \***
8659: 14bc: \***   EPSOM.LIST.TRAILER.CONTINUE:
8660: 14bc: \***   RETURN
8661: 14bc: \***
8662: 14bc: \******************************************************************************
8663: 14bc: 
8664: 14bc:    RECEIVED.EPSOM.LIST.TRAILER:                         
8665: 14cc:    
8666: 14cc:       SB.MESSAGE$ = "PDT Support - EPSOM List trailer received"        
8667: 14e1:       GOSUB SB.BG.MESSAGE
8668: 14f3: 
8669: 14f3:       IF FN.VALIDATE.DATA(DATA.IN$, 5) = 0 THEN BEGIN
8670: 1515:          RECEIVE.STATE$ = "*"
8671: 152c:          RETURN
8672: 153c:       ENDIF
8673: 1544: 
8674: 1544:       TRAILER.LIST$ = MID$(DATA.IN$, 3, 4)
8675: 156b:       LIST.TRAILER.ITEMS% = VAL(MID$(DATA.IN$, 7, 3))
8676: 1594: 
8677: 1594:       IF TRAILER.LIST$ <> CURR.LIST$ THEN BEGIN
8678: 15b6:          RECEIVE.STATE$ = "*"
8679: 15cd:          RETURN
8680: 15dd:       ENDIF
8681: 15e5:       IF LIST.TRAILER.ITEMS% <> ITEM.COUNT% THEN BEGIN
8682: 15f9:          SB.EVENT.NO% = 5
8683: 1606:          SB.UNIQUE$ = "I" + CHR$(ASYNC.REPORT.NUM%) +                   \
8684: 16b0:                       PACK$(FN.Z.PACK(STR$(ITEM.COUNT%), 4)) +          \
8685: 16b0:                       PACK$(FN.Z.PACK(STR$(LIST.TRAILER.ITEMS%), 4)) +  \
8686: 16b0:                       PK4$
8687: 16b0:          GOSUB SB.LOG.AN.EVENT
8688: 16c2:       ENDIF
8689: 16ca: 
8690: 16ca:       IF LIST.BC$ <> "Z" THEN BEGIN                                    
8691: 16e8:          STKMQ.TRANS.TYPE$ = PACK$("14")
8692: 1704:          STKMQ.DATE$ = PACK$(DATE$)
8693: 1721:          STKMQ.TIME$ = PACK$(TIME$)
8694: 173e:          STKMQ.LIST.NUMBER$ = CURR.LIST$
8695: 1759:          STKMQ.LIST.STATUS$ = MID$(CURR.HEADER.USER$, 1, 1)
8696: 177d:          STKMQ.RECORD$ = STKMQ.RECORD.DELIMITER$ +                      \
8697: 17f6:                          STKMQ.TRANS.TYPE$ +                            \
8698: 17f6:                          STKMQ.FIELD.DELIMITER$ +                       \
8699: 17f6:                          STKMQ.DATE$ +                                  \
8700: 17f6:                          STKMQ.TIME$ +                                  \
8701: 17f6:                          STKMQ.LIST.NUMBER$ +                           \
8702: 17f6:                          STKMQ.LIST.STATUS$ +                           \
8703: 17f6:                          STKMQ.RECORD.DELIMITER$ +                      \
8704: 17f6:                          STKMQ.ENDREC.MARKER$
8705: 17f6:          CURR.SESS.NUM% = STKMQ.SESS.NUM%
8706: 1808:          CURRENT.KEY$ = ""
8707: 181d:          RC% = WRITE.STKMQ                                          
8708: 1831:         IF RC% = 1 THEN GOTO WRITE.ERROR                            
8709: 1846:       ENDIF                                                             
8710: 184e: 
8711: 184e:       LIST.COUNT% = LIST.COUNT% + 1
8712: 185a: 
8713: 185a:    EPSOM.LIST.TRAILER.CONTINUE:                                        
8714: 186a: 
8715: 186a:       IF STKMQ.OPEN.FLAG$ = "Y" THEN BEGIN                           ! KSMG
8716: 1888:         CLOSE STKMQ.SESS.NUM%                                        ! KSMG
8717: 189c:         STKMQ.OPEN.FLAG$ = "N"                                       ! KSMG
8718: 18b3:       ENDIF                                                          ! KSMG
8719: 18bb: 
8720: 18bb:    RETURN
8721: 18cb: 
8722: 18cb: \******************************************************************************
8723: 18cb: \***
8724: 18cb: \***   RECEIVED.EPSOM.FILE.TRAILER:                             STATE : G
8725: 18cb: \***
8726: 18cb: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8727: 18cb: \***      return
8728: 18cb: \***
8729: 18cb: \***      if received PDT number or application number are invalid then set
8730: 18cb: \***      RECEIVE.STATE$ to "*" and return
8731: 18cb: \***
8732: 18cb: \***      close STKMQ file if open
8733: 18cb: \***
8734: 18cb: \***      set FILE.TRAILER.LISTS% to numbers of lists on trailer record
8735: 18cb: \***
8736: 18cb: \***      if the received file trailer is for COUNTS processing then
8737: 18cb: \***         if received list count does not equal actual list count then
8738: 18cb: \***            log an event 5 (count discrepancy)
8739: 18cb: \***         endif
8740: 18cb: \***         transmit a file header back to the PDT
8741: 18cb: \***      endif
8742: 18cb: \***
8743: 18cb: \***      if the received file trailer is for LISTS (i.e successful xmission)
8744: 18cb: \***         open and delete PDTWF
8745: 18cb: \***      endif
8746: 18cb: \***
8747: 18cb: \***   EPSOM.FILE.TRAILER.CONTINUE:
8748: 18cb: \***   RETURN
8749: 18cb: \***
8750: 18cb: \******************************************************************************
8751: 18cb: 
8752: 18cb:    RECEIVED.EPSOM.FILE.TRAILER:            
8753: 18db:    
8754: 18db:       SB.MESSAGE$ = "PDT Support - EPSOM File trailer received"        
8755: 18f0:       GOSUB SB.BG.MESSAGE
8756: 1902: 
8757: 1902:       IF FN.VALIDATE.DATA(DATA.IN$, 6) = 0 THEN BEGIN
8758: 1924:          RECEIVE.STATE$ = "*"
8759: 193b:          RETURN
8760: 194b:       ENDIF
8761: 1953: 
8762: 1953:       IF MID$(DATA.IN$, 3, 2) <> APPLICATION.NO$                        \
8763: 19de:       OR MID$(DATA.IN$, 5, 6) <> CURR.TERMINAL$ THEN BEGIN
8764: 19de:          RECEIVE.STATE$ = "*"
8765: 19f5:          RETURN
8766: 1a05:       ENDIF
8767: 1a0d: 
8768: 1a0d: ! 4 lines deleted from here                                             ! ASMG    
8769: 1a0d: 
8770: 1a0d:       FILE.TRAILER.LISTS% = VAL(MID$(DATA.IN$, 11, 2))
8771: 1a36: 
8772: 1a36:       IF PDT.ACTION$ = "COUNTS" THEN BEGIN
8773: 1a54:          IF FILE.TRAILER.LISTS% <> LIST.COUNT% THEN BEGIN
8774: 1a68:             SB.EVENT.NO% = 5
8775: 1a75:             SB.UNIQUE$ = "I" + CHR$(ASYNC.REPORT.NUM%) +                \
8776: 1b1f:                          PACK$(FN.Z.PACK(STR$(LIST.COUNT%), 4)) +       \
8777: 1b1f:                          PACK$(FN.Z.PACK(STR$(FILE.TRAILER.LISTS%),4)) +\
8778: 1b1f:                          PK4$
8779: 1b1f:             GOSUB SB.LOG.AN.EVENT
8780: 1b31:          ENDIF
8781: 1b39:          NUMBER.OF.LISTS% = FILE.TRAILER.LISTS%
8782: 1b47:          GOSUB TRANSMIT.EPSOM.FILE.TRAILER                            
8783: 1b59:       ENDIF
8784: 1b61: 
8785: 1b61:       LDTAF.LINK.TYPE% = 7                                          ! BMJK
8786: 1b71:       IF MONITORED.PORT$ = "B" THEN LDTAF.LINK.TYPE% =                      \ BMJK
8787: 1b9f:         (LDTAF.LINK.TYPE% OR 80H)                                   ! BMJK
8788: 1ba7:       LDTAF.START.DATE$ = PACK$(LOG.ON.DATE$)                            ! BMJK
8789: 1bca:       LDTAF.START.TIME$ = PACK$(LOG.ON.TIME$)                            ! BMJK
8790: 1bed:       TEMP.TIME$ = TIME$                                                ! CMJK
8791: 1c05:       LDTAF.DURATION% = ( (VAL(LEFT$(TEMP.TIME$,2))*3600) +              \ CMJK
8792: 1df1:                           (VAL(MID$(TEMP.TIME$,3,2))*60) +               \ CMJK
8793: 1df1:                            VAL(RIGHT$(TEMP.TIME$,2)) ) -                \ CMJK
8794: 1df1:                       ( (VAL(UNPACK$(LEFT$(LDTAF.START.TIME$,1)))*3600)+\ CMJK
8795: 1df1:                         (VAL(UNPACK$(MID$(LDTAF.START.TIME$,2,1)))*60)+       \ CMJK
8796: 1df1:                          VAL(UNPACK$(RIGHT$(LDTAF.START.TIME$,1))) )       ! CMJK
8797: 1df1:       LDTAF.DATA.VOLUME.1% = 0                                          ! BMJK
8798: 1e08:       LDTAF.DATA.VOLUME.1% = NUMBER.OF.LISTS%                            ! BMJK
8799: 1e21:       LDTAF.DATA.VOLUME.2% = 0                                          ! BMJK
8800: 1e38:       GOSUB LOG.TO.LDTAF.FILE                                          ! BMJK
8801: 1e4a: 
8802: 1e4a:    EPSOM.FILE.TRAILER.CONTINUE:                                       
8803: 1e5a: 
8804: 1e5a:    RETURN
8805: 1e6a: 
8806: 1e6a: \******************************************************************************
8807: 1e6a: \***
8808: 1e6a: \***   RECEIVED.EPSOM.LIST.REQUEST:                             STATE : H
8809: 1e6a: \***
8810: 1e6a: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8811: 1e6a: \***      return
8812: 1e6a: \***
8813: 1e6a: \***      set PDT action to "LISTS"
8814: 1e6a: \***
8815: 1e6a: \***      command PSS38 to 'hold' the PDT
8816: 1e6a: \***
8817: 1e6a: \***      open all files required
8818: 1e6a: \***      create a new PDTWF
8819: 1e6a: \***      GOSUB CREATE.EPSOM.TRANSMISSION.LIST
8820: 1e6a: \***      GOSUB CREATE.EPSOM.TRANSMISSION.FILE
8821: 1e6a: \***      close PDTWF
8822: 1e6a: \***
8823: 1e6a: \***      command PSS38 to 'release' the PDT
8824: 1e6a: \***      command PSS38 to transmit PDTWF if receive state is not "*"
8825: 1e6a: \***
8826: 1e6a: \***      close all used files
8827: 1e6a: \***
8828: 1e6a: \***   EPSOM.LIST.REQUEST.CONTINUE:
8829: 1e6a: \***
8830: 1e6a: \***   RETURN
8831: 1e6a: \***
8832: 1e6a: \******************************************************************************
8833: 1e6a: 
8834: 1e6a:    RECEIVED.EPSOM.LIST.REQUEST:                        
8835: 1e7a:    
8836: 1e7a:       SB.MESSAGE$ = "PDT Support - EPSOM List request received"       
8837: 1e8f:       GOSUB SB.BG.MESSAGE
8838: 1ea1: 
8839: 1ea1:       IF FN.VALIDATE.DATA(DATA.IN$, 7) = 0 THEN BEGIN
8840: 1ec3:          RECEIVE.STATE$ = "*"
8841: 1eda:          RETURN
8842: 1eea:       ENDIF
8843: 1ef2: 
8844: 1ef2:       PDT.ACTION$ = "LISTS"
8845: 1f07:       GOSUB HOLD.PDT
8846: 1f19: 
8847: 1f19:       CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " +              \
8848: 1fad:                         "EPSOM list request at " +                     \
8849: 1fad:                      LEFT$(TIME$,2) + ":" +                            \
8850: 1fad:                      MID$(TIME$,3,2) + ":" +                            \
8851: 1fad:                      RIGHT$(TIME$,2)
8852: 1fad:       GOSUB LOG.TO.AUDIT.FILE
8853: 1fbf: 
8854: 1fbf:       IF END# BCSMF.SESS.NUM% THEN OPEN.ERROR
8855: 1fdb:       CURR.SESS.NUM% = BCSMF.SESS.NUM%
8856: 1fed:       OPEN BCSMF.FILE.NAME$ KEYED RECL BCSMF.RECL% AS BCSMF.SESS.NUM%   \
8857: 201a:            NOWRITE NODEL
8858: 201a:       BCSMF.OPEN.FLAG$ = "Y"
8859: 2031: 
8860: 2031:       IF END# IDF.SESS.NUM% THEN OPEN.ERROR
8861: 204d:       CURR.SESS.NUM% = IDF.SESS.NUM%
8862: 205f:       OPEN IDF.FILE.NAME$ KEYED RECL IDF.RECL% AS IDF.SESS.NUM%         \
8863: 208c:            NOWRITE NODEL
8864: 208c:       IDF.OPEN.FLAG$ = "Y"
8865: 20a3: 
8866: 20a3:       IF END# IEF.SESS.NUM% THEN OPEN.ERROR
8867: 20bf:       CURR.SESS.NUM% = IEF.SESS.NUM%
8868: 20d1:       OPEN IEF.FILE.NAME$ KEYED RECL IEF.RECL% AS IEF.SESS.NUM%         \
8869: 20fe:            NOWRITE NODEL
8870: 20fe:       IEF.OPEN.FLAG$ = "Y"
8871: 2115: 
8872: 2115:       IF END# IRF.SESS.NUM% THEN OPEN.ERROR
8873: 2131:       CURR.SESS.NUM% = IRF.SESS.NUM%
8874: 2143:       OPEN IRF.FILE.NAME$ KEYED RECL IRF.RECL% AS IRF.SESS.NUM%         \
8875: 2170:            NOWRITE NODEL
8876: 2170:       IRF.OPEN.FLAG$ = "Y"
8877: 2187: 
8878: 2187:       IF END# PDTWF.SESS.NUM% THEN CREATE.ERROR
8879: 21a3:       CURR.SESS.NUM% = PDTWF.SESS.NUM%
8880: 21b5:       CREATE POSFILE PDTWF.FILE.NAME$ AS PDTWF.SESS.NUM%                \
8881: 21dc:              BUFFSIZE 10240 LOCKED
8882: 21dc:       PDTWF.OPEN.FLAG$ = "Y"
8883: 21f3: 
8884: 21f3:       IF END# PIITM.SESS.NUM% THEN OPEN.ERROR
8885: 2211:       CURR.SESS.NUM% = PIITM.SESS.NUM%
8886: 2223:       OPEN PIITM.FILE.NAME$ KEYED RECL PIITM.RECL% AS PIITM.SESS.NUM%   \
8887: 2252:            NODEL
8888: 2252:       PIITM.OPEN.FLAG$ = "Y"
8889: 2269: 
8890: 2269:       IF END# PILST.SESS.NUM% THEN OPEN.ERROR
8891: 2287:       CURR.SESS.NUM% = PILST.SESS.NUM%
8892: 2299:       OPEN PILST.FILE.NAME$ DIRECT RECL 512 AS PILST.SESS.NUM%          \
8893: 22c4:            NOWRITE NODEL
8894: 22c4:       PILST.OPEN.FLAG$ = "Y"
8895: 22db: 
8896: 22db: ! 5 Lines deleted from here                                            ! ASMG
8897: 22db: 
8898: 22db:       GOSUB CREATE.EPSOM.TRANSMISSION.LIST                      
8899: 22ed:       IF PILST.OPEN.FLAG$ = "Y" THEN BEGIN                              
8900: 230b:          CLOSE PILST.SESS.NUM%                                          
8901: 2321:          PILST.OPEN.FLAG$ = "N"                                         
8902: 2338:       ENDIF                                                             
8903: 2340:       IF RECEIVE.STATE$ = "*" THEN GOTO SKIP.CREATE.EPSOM.FILE          
8904: 2361:       IF END# PILST.SESS.NUM% THEN OPEN.ERROR                           
8905: 237f:       CURR.SESS.NUM% = PILST.SESS.NUM%                                  
8906: 2391:       OPEN PILST.FILE.NAME$ KEYED RECL PILST.RECL% AS PILST.SESS.NUM%   \
8907: 23c0:            NODEL                                                        
8908: 23c0:       PILST.OPEN.FLAG$ = "Y"                                            
8909: 23d7:       GOSUB CREATE.EPSOM.TRANSMISSION.FILE                              
8910: 23e9: 
8911: 23e9:    SKIP.CREATE.EPSOM.FILE:                                              
8912: 23f9:       IF PDTWF.OPEN.FLAG$ = "Y" THEN BEGIN                              
8913: 2417:          CLOSE PDTWF.SESS.NUM%                                          
8914: 242b:          PDTWF.OPEN.FLAG$ = "N"                                         
8915: 2442:       ENDIF                                                             
8916: 244a: 
8917: 244a:       IF RECEIVE.STATE$ <> "*" THEN BEGIN         
8918: 246b:         LDTAF.LINK.TYPE% = 6                                          ! BMJK
8919: 247b:         IF MONITORED.PORT$ = "B" THEN LDTAF.LINK.TYPE% =               \ BMJK
8920: 24a9:           (LDTAF.LINK.TYPE% OR 80H)                                   ! BMJK
8921: 24b1:         LDTAF.START.DATE$ = PACK$(LOG.ON.DATE$)                            ! BMJK
8922: 24d4:         LDTAF.START.TIME$ = PACK$(LOG.ON.TIME$)                            ! BMJK
8923: 24f7:         TEMP.TIME$ = TIME$                                              ! CMJK
8924: 250f:         LDTAF.DURATION% = ( (VAL(LEFT$(TEMP.TIME$,2))*3600) +              \ CMJK
8925: 26fb:                           (VAL(MID$(TEMP.TIME$,3,2))*60) +               \ CMJK
8926: 26fb:                            VAL(RIGHT$(TEMP.TIME$,2)) ) -                \ CMJK
8927: 26fb:                       ( (VAL(UNPACK$(LEFT$(LDTAF.START.TIME$,1)))*3600)+\ CMJK
8928: 26fb:                         (VAL(UNPACK$(MID$(LDTAF.START.TIME$,2,1)))*60)+       \ CMJK
8929: 26fb:                          VAL(UNPACK$(RIGHT$(LDTAF.START.TIME$,1))) )       ! CMJK
8930: 26fb:         LDTAF.DATA.VOLUME.1% = 0                                   ! BMJK
8931: 2712:         LDTAF.DATA.VOLUME.1% = SIZE (PDTWF.FILE.NAME$)                     ! BMJK
8932: 2739:         LDTAF.DATA.VOLUME.2% = 0                                   ! BMJK
8933: 2750:         GOSUB LOG.TO.LDTAF.FILE                                          ! BMJK
8934: 2762:         GOSUB RELEASE.PDT
8935: 2774:         GOSUB TRANSMIT.EPSOM.FILE                                      
8936: 2786:       ENDIF                                                             
8937: 278e: 
8938: 278e:       CLOSE BCSMF.SESS.NUM%
8939: 27a2:       BCSMF.OPEN.FLAG$ = "N"
8940: 27b9: 
8941: 27b9:       CLOSE IDF.SESS.NUM%
8942: 27cd:       IDF.OPEN.FLAG$ = "N"
8943: 27e4: 
8944: 27e4:       CLOSE IEF.SESS.NUM%
8945: 27f8:       IEF.OPEN.FLAG$ = "N"
8946: 280f: 
8947: 280f:       CLOSE IRF.SESS.NUM%
8948: 2823:       IRF.OPEN.FLAG$ = "N"
8949: 283a: 
8950: 283a:       CLOSE PIITM.SESS.NUM%
8951: 2850:       PIITM.OPEN.FLAG$ = "N"
8952: 2867: 
8953: 2867:       IF PILST.OPEN.FLAG$ = "Y" THEN BEGIN                              
8954: 2885:          CLOSE PILST.SESS.NUM%
8955: 289b:          PILST.OPEN.FLAG$ = "N"
8956: 28b2:       ENDIF                                                             
8957: 28ba: 
8958: 28ba: ! 2 Lines deleted from here                                            ! ASMG
8959: 28ba: 
8960: 28ba:    EPSOM.LIST.REQUEST.CONTINUE:                                        
8961: 28ca: 
8962: 28ca:    RETURN
8963: 28da: 
8964: 28da: \******************************************************************************
8965: 28da: \***
8966: 28da: \***   RECEIVED.EPSOM.EOT:                                      STATE : I
8967: 28da: \***
8968: 28da: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
8969: 28da: \***      return
8970: 28da: \***
8971: 28da: \***      close the EPSOM file ( PDT has finished )
8972: 28da: \***
8973: 28da: \***      gosub warm.start to resolve memory problems.
8974: 28da: \***
8975: 28da: \***   RETURN
8976: 28da: \***
8977: 28da: \******************************************************************************
8978: 28da: 
8979: 28da:    RECEIVED.EPSOM.EOT:                                                 
8980: 28ea: 
8981: 28ea:       SB.MESSAGE$ = "PDT Support - EPSOM E.O.T. received"              
8982: 28ff:       GOSUB SB.BG.MESSAGE                                              
8983: 2911: 
8984: 2911:       IF FN.VALIDATE.DATA(DATA.IN$, 8) = 0 THEN BEGIN                  
8985: 2933:          RECEIVE.STATE$ = "*"                                          
8986: 294a:          RETURN                                                        
8987: 295a:       ENDIF                                                            
8988: 2962: 
8989: 2962:       IF EPSOM.OPEN.FLAG$ = "Y" THEN BEGIN                             
8990: 2980:          CLOSE EPSOM.SESS.NUM%                                         
8991: 2994:          EPSOM.OPEN.FLAG$ = "N"                                        
8992: 29ab:       ENDIF                                                            
8993: 29b3: 
8994: 29b3:       CSR.AUDIT.DATA$ = "EPSOM session complete at " +                     \
8995: 2a34:                         LEFT$(TIME$,2) + ":" +                            \
8996: 2a34:                      MID$(TIME$,3,2) + ":" +                            \
8997: 2a34:                      RIGHT$(TIME$,2)
8998: 2a34:       CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " +              \
8999: 2a68:                         CSR.AUDIT.DATA$
9000: 2a68:       GOSUB LOG.TO.AUDIT.FILE
9001: 2a7a:       
9002: 2a7a:       IF CSR.AUDIT.OPEN.FLAG$ = "Y" THEN BEGIN
9003: 2a98:          CLOSE CSR.AUDIT.SESS.NUM%
9004: 2aac:         CSR.AUDIT.OPEN.FLAG$ = "N"
9005: 2ac3:       ENDIF
9006: 2acb: 
9007: 2acb:       RE.CHAIN = TRUE                                                 
9008: 2ae1:       RECEIVE.STATE$ = "?"                                              
9009: 2af8:       
9010: 2af8:    RETURN
9011: 2b08: 
9012: 2b08: 
9013: 2b08: \******************************************************************************
9014: 2b08: \******************************************************************************
9015: 2b08: \***
9016: 2b08: \***   E P S O M   S U B R O U T I N E S
9017: 2b08: \***
9018: 2b08: \******************************************************************************
9019: 2b08: \******************************************************************************
9020: 2b08: 
9021: 2b08: \******************************************************************************
9022: 2b08: \***
9023: 2b08: \***   TRANSMIT.EPSOM.FILE.TRAILER:
9024: 2b08: \***
9025: 2b08: \***      send a file trailer to the PSS38
9026: 2b08: \***
9027: 2b08: \***   RETURN
9028: 2b08: \***
9029: 2b08: \******************************************************************************
9030: 2b08: 
9031: 2b08:    TRANSMIT.EPSOM.FILE.TRAILER:                 
9032: 2b18: 
9033: 2b18:       PIPE.OUT$ = "L" +                                                 \
9034: 2b95:                   STX$ +                                                \
9035: 2b95:                   "CT" +                                                \
9036: 2b95:                   FN.Z.PACK(APPLICATION.NO$,2) +                        \
9037: 2b95:                   FN.Z.PACK(CURR.TERMINAL$,6) +                         \
9038: 2b95:                   FN.Z.PACK(STR$(NUMBER.OF.LISTS%),2)
9039: 2b95: 
9040: 2b95:       GOSUB SEND.TO.PSS38
9041: 2ba7: 
9042: 2ba7:    RETURN
9043: 2bb7: 
9044: 2bb7: \******************************************************************************
9045: 2bb7: \***
9046: 2bb7: \***   CREATE.EPSOM.TRANSMISSION.LIST:
9047: 2bb7: \***
9048: 2bb7: \***      from the requested lists data sent from the PDT create the
9049: 2bb7: \***      array REQ.LIST.STORE$() with REQ.LIST.DATA$() containing the
9050: 2bb7: \***      letter "C" to indicate a count. Also create the string REQ.BC$
9051: 2bb7: \***      containing a list of requested business centre letters.
9052: 2bb7: \***
9053: 2bb7: \***      for each list contained on the PILST (list of lists) file GOSUB ...
9054: 2bb7: \***      ... PROCESS.AN.EPSOM.LIST
9055: 2bb7: \***
9056: 2bb7: \***      GOSUB ADD.EXCEPTIONS.TO.EPSOM.LIST
9057: 2bb7: \***
9058: 2bb7: \***   RETURN
9059: 2bb7: \***
9060: 2bb7: \******************************************************************************
9061: 2bb7: 
9062: 2bb7:    CREATE.EPSOM.TRANSMISSION.LIST:                  
9063: 2bc7:    
9064: 2bc7:       REQ.LIST.PTR% = 0
9065: 2bd5:       LIST.EXTRACTION% = 0
9066: 2be3:       REQ.BC$ = ""
9067: 2bf8:       SELECT.ALL.FLAG$ = "N"
9068: 2c0d:       WHILE ((LIST.EXTRACTION% * 4) + 10) < LEN(DATA.IN$)
9069: 2c18:          REQ.LIST$ = MID$(DATA.IN$, (LIST.EXTRACTION% * 4) + 10, 4)
9070: 2c45:          BC$ = RIGHT$(REQ.LIST$, 1)
9071: 2c65:          IF BC$ >= "A" AND BC$ <= "Z" THEN BEGIN
9072: 2cb1:             REQ.BC$ = REQ.BC$ + BC$
9073: 2cd5:             IF BC$ = "X" THEN SELECT.ALL.FLAG$ = "Y"
9074: 2cff:          ENDIF ELSE BEGIN
9075: 2d07:             REQ.LIST.PTR% = REQ.LIST.PTR% + 1
9076: 2d13:             REQ.LIST.STORE$(REQ.LIST.PTR%) = REQ.LIST$
9077: 2d3c:             REQ.LIST.DATA$(REQ.LIST.PTR%)  = "C"
9078: 2d61:          ENDIF
9079: 2d69:          LIST.EXTRACTION% = LIST.EXTRACTION% + 1
9080: 2d75:       WEND
9081: 2da2: 
9082: 2da2: 
9083: 2da2:       LIST.TRANSMIT.PTR% = 0
9084: 2db0: 
9085: 2db0:       SECTOR.COUNT% = 2
9086: 2dbe:       LAST.REC% = ((INT(508 / PILST.RECL%) - 1) * PILST.RECL%) + 1
9087: 2e48:       PILST.EOF.FLAG$ = "N"
9088: 2e5d:       CURR.SESS.NUM% = PILST.SESS.NUM%
9089: 2e6f:       IF END# PILST.SESS.NUM% THEN PILST.READ.FAIL
9090: 2e8d:       WHILE PILST.EOF.FLAG$ <> "Y" AND RECEIVE.STATE$ <> "*"            
9091: 2e98: 
9092: 2e98:          CURR.TIME$ = TIME$                                             
9093: 2eae:          IF MOD(VAL(CURR.TIME$), INT.DELAY%) = 0                        \
9094: 2f14:          AND LAST.TIME$ <> CURR.TIME$ THEN BEGIN                        
9095: 2f14:             GOSUB INTERROGATE.PSS38                                     
9096: 2f26:             LAST.TIME$ = CURR.TIME$                                     
9097: 2f3f:             IF LEFT$(PSS38.STATUS$,2) = "I" + "N" THEN BEGIN            
9098: 2f80:                RECEIVE.STATE$ = "*"                                     
9099: 2f97:                GOTO RETURN.PILST.EOF                                    
9100: 2fa2:             ENDIF                                                       
9101: 2faa:          ENDIF                                                          
9102: 2fb2: 
9103: 2fb2:          READ FORM "C4,C508";# PILST.SESS.NUM%, SECTOR.COUNT%;          \
9104: 2ff0:               CONTROL$, SECTOR$
9105: 2ff0:          IF LEFT$(SECTOR$, 4) <> PK4$ THEN BEGIN                        
9106: 302c:             FOR POSITION% = 1 TO LAST.REC% STEP PILST.RECL%
9107: 3047:                PILST.RECORD$ = MID$(SECTOR$, POSITION%, PILST.RECL%)
9108: 3070:                KEY.VALUE$ = LEFT$(PILST.RECORD$, 4)
9109: 3092:                IF VAL(UNPACK$(KEY.VALUE$)) <> 0                         \
9110: 310a:                AND KEY.VALUE$ <> "0000" THEN BEGIN
9111: 310a:                   GOSUB PROCESS.AN.EPSOM.LIST                           
9112: 311c:                ENDIF
9113: 3124:             NEXT POSITION%
9114: 315f:          ENDIF                                                          
9115: 3167:          SECTOR.COUNT% = SECTOR.COUNT% + 1
9116: 3173: 
9117: 3173:       RETURN.PILST.EOF:
9118: 3183:       WEND
9119: 31d3: 
9120: 31d3:       IF RECEIVE.STATE$ <> "*" THEN BEGIN                               
9121: 31f1:          GOSUB ADD.EXCEPTIONS.TO.EPSOM.LIST                             
9122: 3203:       ENDIF                                                             
9123: 320b: 
9124: 320b:    RETURN
9125: 321b: 
9126: 321b: \******************************************************************************
9127: 321b: \***
9128: 321b: \***   PROCESS.AN.EPSOM.LIST:
9129: 321b: \***
9130: 321b: \***      GOSUB WAS.EPSOM.LIST.REQUESTED to find out whether current list is a
9131: 321b: \***      requested list
9132: 321b: \***
9133: 321b: \***      if the list status is "X" (cancelled) or "F" (counted) then
9134: 321b: \***         if the list is a requested list then
9135: 321b: \***            set the list's REQ.LIST.DATA$() to the list status
9136: 321b: \***         endif
9137: 321b: \***         return
9138: 321b: \***      endif
9139: 321b: \***
9140: 321b: \***      if the lists status is "C" (count) and its count date is valid
9141: 321b: \***      and greater than today's date then return
9142: 321b: \***
9143: 321b: \***      if the lists status is "R" (recount) and its recount date is valid
9144: 321b: \***      and greater than today's date then return
9145: 321b: \***
9146: 321b: \***      if the list number is a requested list then
9147: 321b: \***         GOSUB STORE.EPSOM.LIST.INFO
9148: 321b: \***         set the list's REQ.LIST.DATA$() to "D" (delete request)
9149: 321b: \***      endif
9150: 321b: \***
9151: 321b: \***      if all business centres were requested or the current business
9152: 321b: \***      centre is a requested business centre letter then
9153: 321b: \***         GOSUB STORE.EPSOM.LIST.INFO
9154: 321b: \***         set the "X" entry within BC.CHECK%() to 1
9155: 321b: \***      endif
9156: 321b: \***
9157: 321b: \***   RETURN
9158: 321b: \***
9159: 321b: \******************************************************************************
9160: 321b: 
9161: 321b:    PROCESS.AN.EPSOM.LIST:                              
9162: 322b:    
9163: 322b:       PILST.LIST.NUMBER$ = KEY.VALUE$
9164: 3246:       PILST.LIST.NAME$ = MID$(PILST.RECORD$, 5, 12)
9165: 326a:       PILST.BC.LETTER$ = MID$(PILST.RECORD$, 17, 1)
9166: 328e:       PILST.LIST.TYPE$ = MID$(PILST.RECORD$, 18, 1)
9167: 32b2:       PILST.COUNT.BY.DATE$ = MID$(PILST.RECORD$, 19, 3)
9168: 32d6:       PILST.PRODUCT.GROUP$ = MID$(PILST.RECORD$, 22, 3)
9169: 32fa:       PILST.ITEMS.IN.LIST% = FN.CONV.TO.INTEGER(MID$(PILST.RECORD$, 25, 1))
9170: 3339:       PILST.TO.BE.COUNTED% = FN.CONV.TO.INTEGER(MID$(PILST.RECORD$, 26, 1))
9171: 3378:       PILST.COUNT.DATE$ = MID$(PILST.RECORD$, 27, 3)
9172: 339c:       PILST.LIST.STATUS$ = MID$(PILST.RECORD$, 30, 1)
9173: 33c0:       PILST.RECOUNT.DATE$ = MID$(PILST.RECORD$, 31, 3)
9174: 33e4:       PILST.RECOUNT.ALLOWED$ = MID$(PILST.RECORD$, 34, 1)
9175: 3408:       SORT.ORDER$ = "B"                                                 
9176: 341d:       IF PILST.LIST.TYPE$ = "E" THEN SORT.ORDER$ = "A"                  
9177: 3448:       SORT.DATE$ = UNPACK$(PILST.COUNT.BY.DATE$)
9178: 3469:       LIST.BC$ = PILST.BC.LETTER$
9179: 3485: 
9180: 3485:       COUNT.DATE$ = UNPACK$(PILST.COUNT.DATE$)
9181: 34a6:       RECOUNT.DATE$ = UNPACK$(PILST.RECOUNT.DATE$)
9182: 34c7:       TEST.LIST$ = PILST.LIST.NUMBER$
9183: 34e3:       GOSUB WAS.EPSOM.LIST.REQUESTED                                    
9184: 34f5: 
9185: 34f5:       IF PILST.LIST.STATUS$ = "X" OR PILST.LIST.STATUS$ = "F" THEN BEGIN
9186: 3547:          IF REQ.FLAG$ = "Y" THEN REQ.LIST.DATA$(LIST%) = PILST.LIST.STATUS$
9187: 3586:          RETURN
9188: 3596:       ENDIF
9189: 359e: 
9190: 359e:       IF PILST.LIST.STATUS$ = "C" THEN BEGIN
9191: 35bf:          IF COUNT.DATE$ = "000000"                                      \
9192: 360c:          OR DATE.GT(COUNT.DATE$,DATE.TODAY$)  THEN BEGIN               ! ENS        
9193: 360c:             IF REQ.FLAG$ = "Y" THEN BEGIN
9194: 362a:                SORT.ORDER$ = "C"                                        
9195: 363f:                SORT.DATE$ = "850101"                                   ! FNS
9196: 3654:                PILST.LIST.NAME$ = "Future List"                         
9197: 366b:                PILST.ITEMS.IN.LIST% = 0
9198: 367b:                PILST.LIST.STATUS$ = "?"
9199: 3692:                PILST.LIST.TYPE$ = "?"
9200: 36a9:                GOSUB STORE.EPSOM.LIST.INFO                              
9201: 36bb:                REQ.LIST.DATA$(LIST%) = "D"
9202: 36e0:             ENDIF
9203: 36e8:             RETURN
9204: 36f8:          ENDIF
9205: 3700:       ENDIF
9206: 3708: 
9207: 3708:       IF PILST.LIST.STATUS$ = "R" THEN BEGIN
9208: 3729:          IF RECOUNT.DATE$ = "000000"                                    \
9209: 3776:          OR DATE.GT(RECOUNT.DATE$,DATE.TODAY$) THEN BEGIN              ! ENS        
9210: 3776:             IF REQ.FLAG$ = "Y" THEN BEGIN
9211: 3794:                SORT.ORDER$ = "C"                                        
9212: 37a9:                SORT.DATE$ = "850101"                                   ! FNS
9213: 37be:                PILST.LIST.NAME$ = "Future List"                         
9214: 37d5:                PILST.ITEMS.IN.LIST% = 0
9215: 37e5:                PILST.LIST.STATUS$ = "?"
9216: 37fc:                PILST.LIST.TYPE$ = "?"
9217: 3813:                GOSUB STORE.EPSOM.LIST.INFO                              
9218: 3825:                REQ.LIST.DATA$(LIST%) = "D"
9219: 384a:             ENDIF
9220: 3852:             RETURN
9221: 3862:          ENDIF
9222: 386a:       ENDIF
9223: 3872: 
9224: 3872:       IF REQ.FLAG$ = "Y" THEN BEGIN
9225: 388d:          GOSUB STORE.EPSOM.LIST.INFO                                    
9226: 389f:          REQ.LIST.DATA$(LIST%) = "D"
9227: 38c4:          RETURN
9228: 38d4:       ENDIF
9229: 38dc: 
9230: 38dc:       IF (SELECT.ALL.FLAG$ = "Y" AND PILST.BC.LETTER$ <> "Z")                                           \
9231: 3954:       OR MATCH(PILST.BC.LETTER$, REQ.BC$, 1) > 0 THEN BEGIN
9232: 3954:          GOSUB STORE.EPSOM.LIST.INFO                                    
9233: 3966:          BC.CHECK%(ASC("X") - ASC("A") + 1) = 1
9234: 399c:          RETURN
9235: 39ac:       ENDIF
9236: 39b4: 
9237: 39b4:    RETURN
9238: 39c4: 
9239: 39c4: 
9240: 39c4: \******************************************************************************
9241: 39c4: \***
9242: 39c4: \***   WAS.EPSOM.LIST.REQUESTED:
9243: 39c4: \***
9244: 39c4: \***      Determine whether TEST.LIST$ was a list requested by the PDT
9245: 39c4: \***      (REQ.FLAG$ = "Y" for a requested list,
9246: 39c4: \***                   "N" for a non-requested list.)
9247: 39c4: \***
9248: 39c4: \***   RETURN
9249: 39c4: \***
9250: 39c4: \******************************************************************************
9251: 39c4: 
9252: 39c4:    WAS.EPSOM.LIST.REQUESTED:                                            
9253: 39d4: 
9254: 39d4:       REQ.FLAG$ = "N"
9255: 39e9: 
9256: 39e9:       IF REQ.LIST.PTR% < 1 THEN RETURN
9257: 3a00: 
9258: 3a00:       LIST% = 0
9259: 3a0e:       WHILE LIST% < REQ.LIST.PTR% AND REQ.FLAG$ = "N"
9260: 3a18:          LIST% = LIST% + 1
9261: 3a24:          IF REQ.LIST.STORE$(LIST%) = TEST.LIST$ THEN REQ.FLAG$ = "Y"
9262: 3a61:       WEND
9263: 3aa0: 
9264: 3aa0:    RETURN
9265: 3ab0: 
9266: 3ab0: \******************************************************************************
9267: 3ab0: \***
9268: 3ab0: \***   STORE.EPSOM.LIST.INFO:
9269: 3ab0: \***
9270: 3ab0: \***      Add a list number to the list transmission list
9271: 3ab0: \***      (this list contains the list numbers of all lists that will
9272: 3ab0: \***      eventually be transmitted to the PDT)
9273: 3ab0: \***
9274: 3ab0: \***   RETURN
9275: 3ab0: \***
9276: 3ab0: \******************************************************************************
9277: 3ab0: 
9278: 3ab0:    STORE.EPSOM.LIST.INFO:                                               
9279: 3ac0: 
9280: 3ac0:       PILST.LIST.NAME$ = LEFT$(PILST.LIST.NAME$ + STRING$(16, " "), 16)
9281: 3b0f:       LIST.TRANSMIT.PTR% = LIST.TRANSMIT.PTR% + 1
9282: 3b1b:       LIST.TRANSMIT$(LIST.TRANSMIT.PTR%) =                              \
9283: 3bc1:                 SORT.ORDER$ +                                           \
9284: 3bc1:                 SORT.DATE$ +                                            \
9285: 3bc1:                 PILST.LIST.NUMBER$ +                                    \
9286: 3bc1:                 FN.TRANSLATE.TEXT(PILST.LIST.NAME$) +                   \
9287: 3bc1:                 FN.Z.PACK(STR$(PILST.ITEMS.IN.LIST%), 3) +              \
9288: 3bc1:                 PILST.LIST.STATUS$ +                                    \
9289: 3bc1:                 PILST.LIST.TYPE$ +                                      \
9290: 3bc1:                 LIST.BC$
9291: 3bc1: 
9292: 3bc1:       IF PILST.LIST.STATUS$ = "C"                                       \
9293: 3c13:       OR PILST.LIST.STATUS$ = "R" THEN BEGIN
9294: 3c13:          BC.CHECK%(ASC(PILST.BC.LETTER$) - ASC("A") + 1) = 1
9295: 3c50:       ENDIF
9296: 3c58: 
9297: 3c58:    RETURN
9298: 3c68: 
9299: 3c68: \******************************************************************************
9300: 3c68: \***
9301: 3c68: \***   ADD.EXCEPTIONS.TO.EPSOM.LIST:
9302: 3c68: \***
9303: 3c68: \***      add to the transmission list a list of all invalid / unavailable
9304: 3c68: \***      lists and business centre codes
9305: 3c68: \***
9306: 3c68: \***   RETURN
9307: 3c68: \***
9308: 3c68: \******************************************************************************
9309: 3c68: 
9310: 3c68:    ADD.EXCEPTIONS.TO.EPSOM.LIST:                                        
9311: 3c78:       SORT.PTR% = 1
9312: 3c86:       GOSUB SORT.EPSOM.TRANSMISSION.LIST                                
9313: 3c98: 
9314: 3c98:       FOR LIST% = 1 TO REQ.LIST.PTR%
9315: 3ca9:          PILST.LIST.NAME$ = "List Error"
9316: 3cc0:          DATA$ = REQ.LIST.DATA$(LIST%)
9317: 3cea:          IF DATA$ <> "D" THEN BEGIN
9318: 3d08:             IF DATA$ = "C" THEN PILST.LIST.NAME$ = "List Not Found"
9319: 3d32:             IF DATA$ = "F" THEN PILST.LIST.NAME$ = "List Completed"
9320: 3d5c:             IF DATA$ = "X" THEN PILST.LIST.NAME$ = "List Cancelled"
9321: 3d86:             SORT.ORDER$ = "C"                                           
9322: 3d9b:             SORT.DATE$ = "850101"                                      ! FNS
9323: 3db0:             PILST.LIST.NUMBER$ = REQ.LIST.STORE$(LIST%)
9324: 3ddc:             PILST.ITEMS.IN.LIST% = 0
9325: 3dec:             PILST.LIST.STATUS$ = "?"
9326: 3e03:             PILST.LIST.TYPE$ = "?"
9327: 3e1a:             GOSUB STORE.EPSOM.LIST.INFO                                 
9328: 3e2c:          ENDIF
9329: 3e34:       NEXT LIST%
9330: 3e4f: 
9331: 3e4f:       GOSUB SORT.EPSOM.TRANSMISSION.LIST                                
9332: 3e61: 
9333: 3e61:       IF LEN(REQ.BC$) > 0 THEN BEGIN
9334: 3e7f:          FOR BC% = 1 TO LEN(REQ.BC$)
9335: 3e90:             BCSMF.FSI$ = MID$(REQ.BC$, BC%, 1)
9336: 3eb6:             IF (BC.CHECK%(ASC(BCSMF.FSI$) - ASC("A") + 1) = 0)          \
9337: 3f27:             AND BCSMF.FSI$ <> "X" THEN BEGIN
9338: 3f27:                CURRENT.KEY$ = BCSMF.FSI$
9339: 3f43:                RC% = READ.BCSMF                                          
9340: 3f57:               IF RC% = 1 THEN GOTO BC.NOT.FOUND                     
9341: 3f6c:                SORT.ORDER$ = "C"                                        
9342: 3f81:                SORT.DATE$ = "850101"                                   ! FNS
9343: 3f96:                PILST.LIST.NUMBER$ = BCSMF.FSI$ + "   "
9344: 3fbb:                PILST.LIST.NAME$ = "Lists Not Found"
9345: 3fd2:                PILST.ITEMS.IN.LIST% = 0                                 
9346: 3fe2:                PILST.LIST.STATUS$ = "?"
9347: 3ff9:                PILST.LIST.TYPE$ = "?"
9348: 4010:                GOSUB STORE.EPSOM.LIST.INFO                              
9349: 4022:             ENDIF
9350: 402a:          RETURN.TO.BC.CHECK:
9351: 403a:          NEXT BC%
9352: 4060:       ENDIF
9353: 4068: 
9354: 4068:       GOSUB SORT.EPSOM.TRANSMISSION.LIST                                
9355: 407a: 
9356: 407a:    RETURN
9357: 408a: 
9358: 408a: \******************************************************************************
9359: 408a: \***
9360: 408a: \***   SORT.EPSOM.TRANSMISSION.LIST:
9361: 408a: \***
9362: 408a: \***      sort the transmission list into ascending order of list number
9363: 408a: \***      (the subroutine actually sorts a group of list numbers within
9364: 408a: \***      the main transmission list so the valid lists can be separated
9365: 408a: \***      from the invalid / unavailable lists and business centres)
9366: 408a: \***
9367: 408a: \***   RETURN
9368: 408a: \***
9369: 408a: \******************************************************************************
9370: 408a: 
9371: 408a:    SORT.EPSOM.TRANSMISSION.LIST:                     
9372: 409a: 
9373: 409a:       IF SORT.PTR% >= LIST.TRANSMIT.PTR% THEN RETURN
9374: 40b3:        
9375: 40b3:       FOR A% = SORT.PTR% TO LIST.TRANSMIT.PTR%                         ! ENS
9376: 40cd:          TEMP.LIST$ = "19"                                             ! ENS
9377: 40e2:          IF MID$(LIST.TRANSMIT$(A%),2,2) < "85" THEN TEMP.LIST$ = "20" ! ENS
9378: 4136:          LIST.TRANSMIT$(A%) = LEFT$(LIST.TRANSMIT$(A%),1) +            \ ENS
9379: 41de:             TEMP.LIST$ + RIGHT$(LIST.TRANSMIT$(A%),                     \ ENS
9380: 41de:                LEN(LIST.TRANSMIT$(A%)) - 1)                             ! ENS
9381: 41de:       NEXT A%                                                          ! ENS
9382: 4208: 
9383: 4208: 
9384: 4208:       FOR A% = SORT.PTR% TO (LIST.TRANSMIT.PTR% - 1)
9385: 4222:          FOR B% = (A% + 1) TO LIST.TRANSMIT.PTR%
9386: 423e:             IF LIST.TRANSMIT$(A%) > LIST.TRANSMIT$(B%) THEN BEGIN
9387: 428a:                TEMP.LIST$ = LIST.TRANSMIT$(A%)
9388: 42b8:                LIST.TRANSMIT$(A%) = LIST.TRANSMIT$(B%)
9389: 42fa:                LIST.TRANSMIT$(B%) = TEMP.LIST$
9390: 4327:             ENDIF
9391: 432f:          NEXT B%
9392: 4359:       NEXT A%
9393: 4384: 
9394: 4384:       FOR A% = SORT.PTR% TO LIST.TRANSMIT.PTR%                         ! ENS
9395: 439e:          LIST.TRANSMIT$(A%) = LEFT$(LIST.TRANSMIT$(A%),1) +            \ ENS
9396: 4440:              RIGHT$(LIST.TRANSMIT$(A%), LEN(LIST.TRANSMIT$(A%)) - 3)   ! ENS
9397: 4440:       NEXT A%                                                          ! ENS
9398: 446a: 
9399: 446a: 
9400: 446a: 
9401: 446a:       SORT.PTR% = LIST.TRANSMIT.PTR% + 1
9402: 4479: 
9403: 4479:    RETURN
9404: 4489: 
9405: 4489: \******************************************************************************
9406: 4489: \***
9407: 4489: \***   CREATE.EPSOM.TRANSMISSION.FILE:
9408: 4489: \***
9409: 4489: \***      create a PDTWF file header and write it to the PDTWF
9410: 4489: \***      work through the list created by CREATE.TRANSMISSION.LIST
9411: 4489: \***      and for each list entry do the following
9412: 4489: \***         create and write a list header to the PDTWF
9413: 4489: \***         for each item within the list GOSUB GET.EPSOM.ITEM.INFO,
9414: 4489: \***         which sets-up
9415: 4489: \***         PDTWF.RECORD$
9416: 4489: \***         if PDTWF.RECORD$ is not null then write it to the PDTWF
9417: 4489: \***         create and write a list trailer to the PDTWF
9418: 4489: \***
9419: 4489: \***      create a PDTWF file header and write it to the PDTWF
9420: 4489: \***
9421: 4489: \***   RETURN
9422: 4489: \***
9423: 4489: \******************************************************************************
9424: 4489: 
9425: 4489:    CREATE.EPSOM.TRANSMISSION.FILE:                                      
9426: 4499: 
9427: 4499:       IF STKMQ.OPEN.FLAG$ <> "Y" THEN BEGIN                             ! ASMG
9428: 44ba:        IF END# STKMQ.SESS.NUM% THEN OPEN.ERROR                          ! ASMG
9429: 44d6:        CURR.SESS.NUM% = STKMQ.SESS.NUM%                                 ! ASMG
9430: 44e8:        OPEN STKMQ.FILE.NAME$ AS STKMQ.SESS.NUM% BUFFSIZE 512 READONLY  \ ASMG
9431: 4511:        NODEL APPEND                                                 ! ASMG
9432: 4511:        STKMQ.OPEN.FLAG$ = "Y"                                           ! ASMG
9433: 4528:        TOTAL.WAIT.TIME% = 0                                             ! ASMG
9434: 4536:       ENDIF                                                             ! ASMG
9435: 453e: 
9436: 453e:       NESTING.LEVEL% = 0
9437: 454e:       PDTWF.RECORD$ = STX$ + "CH" + APPLICATION.NO$ +                   \
9438: 45a5:                       CURR.TERMINAL$ +                                  \
9439: 45a5:                       FN.Z.PACK(STR$(LIST.TRANSMIT.PTR%) , 2)
9440: 45a5:       CURR.SESS.NUM% = PDTWF.SESS.NUM%
9441: 45b7:       CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)
9442: 45dc:       RC% = WRITE.PDTWF                                                 
9443: 45f0:       IF RC% = 1 THEN GOTO WRITE.ERROR                                   
9444: 4605:       NESTING.LEVEL% = 1
9445: 4615:       FOR LIST% = 1 TO LIST.TRANSMIT.PTR%
9446: 4626: 
9447: 4626:          IF RECEIVE.STATE$ = "*" THEN GOTO BACK.OUT.EPSOM.LIST.LOOP     
9448: 4647:          LIST.NUMBER$ = MID$(LIST.TRANSMIT$(LIST%), 8, 4)
9449: 467a:          LIST.NAME$ = MID$(LIST.TRANSMIT$(LIST%), 12, 16)
9450: 46ad:          NUMBER.OF.ITEMS% = VAL(MID$(LIST.TRANSMIT$(LIST%), 28, 3))
9451: 46e4:          LIST.STATUS$ = MID$(LIST.TRANSMIT$(LIST%), 31, 1)
9452: 4717:          LIST.TYPE$ = MID$(LIST.TRANSMIT$(LIST%), 32, 1)
9453: 474a:          LIST.BC$ = MID$(LIST.TRANSMIT$(LIST%), 33, 1)
9454: 477d:          USER.DATA$ = LEFT$(LIST.STATUS$ +                              \
9455: 47c5:                             LIST.TYPE$ +                                \
9456: 47c5:                             LIST.BC$ +                                  \
9457: 47c5:                             "-----", 5)
9458: 47c5:          ITEM.TRAILER.COUNT% = 0
9459: 47d3:          LISTS.CANCELLED% = 0                                           
9460: 47e8:          RECORDS.WRITTEN% = 0                                           
9461: 47fd:          PDTWF.HEADER.RECORD$ = "LH" + LIST.NUMBER$ + LIST.NAME$ +      \ 
9462: 482d:                                 USER.DATA$                              
9463: 482d:          IF RECEIVE.STATE$ = "*" THEN GOTO BACK.OUT.EPSOM.LIST.LOOP     
9464: 484e:          IF LIST.STATUS$ = "C" OR LIST.STATUS$ = "R" THEN BEGIN
9465: 489d:             NESTING.LEVEL% = 2
9466: 48ad:             FOR ITEM% = 1 TO NUMBER.OF.ITEMS%
9467: 48be: 
9468: 48be:                CURR.TIME$ = TIME$                                       
9469: 48d4:                IF MOD(VAL(CURR.TIME$), INT.DELAY%) = 0                  \
9470: 493a:                AND LAST.TIME$ <> CURR.TIME$ THEN BEGIN                  
9471: 493a:                   GOSUB INTERROGATE.PSS38                               
9472: 494c:                   LAST.TIME$ = CURR.TIME$                               
9473: 4965:                   IF LEFT$(PSS38.STATUS$,2) = "I" + "N" THEN BEGIN      
9474: 49a6:                      RECEIVE.STATE$ = "*"                               
9475: 49bd:                   ENDIF                                                 
9476: 49c5:                ENDIF                                                    
9477: 49cd: 
9478: 49cd:                IF RECEIVE.STATE$ = "*" THEN GOTO BACK.OUT.EPSOM.ITEM.LOOP
9479: 49ee:                GOSUB GET.EPSOM.ITEM.INFO                                
9480: 4a00:                IF PDTWF.RECORD$ <> "" THEN BEGIN
9481: 4a21:                   IF RECORDS.WRITTEN% = 0 THEN BEGIN                   
9482: 4a3f:                      TEMP.PDTWF.RECORD$ = PDTWF.RECORD$                
9483: 4a5b:                      PDTWF.RECORD$ = PDTWF.HEADER.RECORD$              
9484: 4a76:                      CURR.SESS.NUM% = PDTWF.SESS.NUM%                  
9485: 4a88:                      CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)             
9486: 4aad:                      RC% = WRITE.PDTWF                                 
9487: 4ac1:                    IF RC% = 1 THEN GOTO WRITE.ERROR                     
9488: 4ad6:                      PDTWF.RECORD$ = TEMP.PDTWF.RECORD$                 
9489: 4af1:                   ENDIF                                                 
9490: 4af9:                   CURR.SESS.NUM% = PDTWF.SESS.NUM%
9491: 4b0b:                   CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)
9492: 4b30:                   RC% = WRITE.PDTWF                                   
9493: 4b44:                 IF RC% = 1 THEN GOTO WRITE.ERROR                     
9494: 4b59:                   RECORDS.WRITTEN% = RECORDS.WRITTEN% + 1               
9495: 4b72:                ENDIF
9496: 4b7a:             BACK.OUT.EPSOM.ITEM.LOOP:                                   
9497: 4b8a:             NEXT ITEM%
9498: 4ba5:             NESTING.LEVEL% = 1
9499: 4bb5:             IF RECEIVE.STATE$ = "*" THEN GOTO BACK.OUT.EPSOM.LIST.LOOP  
9500: 4bd6:          ENDIF                                                          
9501: 4bde:          IF RECORDS.WRITTEN% = 0                                        \
9502: 4c10:          AND NUMBER.OF.ITEMS% > 0 THEN BEGIN                            
9503: 4c10:             PDTWF.RECORD$ = LEFT$(PDTWF.HEADER.RECORD$, 6) +            \
9504: 4c57:                             "Items Not Found " +                        \
9505: 4c57:                             MID$(PDTWF.HEADER.RECORD$, 23, 5)           
9506: 4c57:             CURR.SESS.NUM% = PDTWF.SESS.NUM%                            
9507: 4c69:             CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)                       
9508: 4c8e:             RC% = WRITE.PDTWF                                           
9509: 4ca2:            IF RC% = 1 THEN GOTO WRITE.ERROR                            
9510: 4cb7:             RECORDS.WRITTEN% = RECORDS.WRITTEN% + 1                     
9511: 4cd0:          ENDIF                                                          
9512: 4cd8:          IF NUMBER.OF.ITEMS% = LISTS.CANCELLED%                         \
9513: 4d07:          AND NUMBER.OF.ITEMS% > 0 THEN BEGIN                            
9514: 4d07:             PILST.LIST.NUMBER$ = LIST.NUMBER$                           
9515: 4d22:             CURR.SESS.NUM% = PILST.SESS.NUM%                            
9516: 4d34:             CURRENT.KEY$ = LIST.NUMBER$                                 
9517: 4d4d:             RC% = READ.PILST                                            
9518: 4d61:            IF RC% = 1 THEN GOTO READ.ERROR                            
9519: 4d76:             PILST.LIST.STATUS$ = "X"                                    
9520: 4d8d:             CURR.SESS.NUM% = PILST.SESS.NUM%                            
9521: 4d9f:             CURRENT.KEY$ = LIST.NUMBER$                                 
9522: 4db8:             RC% = WRITE.PILST                                           
9523: 4dcc:            IF RC% = 1 THEN GOTO WRITE.ERROR                            
9524: 4de1:          ENDIF                                                          
9525: 4de9:          IF LIST.STATUS$ = "?" THEN BEGIN                               
9526: 4e07:             NUMBER.OF.ITEMS% = 0                                        
9527: 4e15:             IF RECORDS.WRITTEN% = 0 THEN BEGIN                          
9528: 4e33:                PDTWF.RECORD$ = PDTWF.HEADER.RECORD$                     
9529: 4e4e:                CURR.SESS.NUM% = PDTWF.SESS.NUM%                         
9530: 4e60:                CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)                    
9531: 4e85:                RC% = WRITE.PDTWF                                        
9532: 4e99:               IF RC% = 1 THEN GOTO WRITE.ERROR                            
9533: 4eae:             ENDIF                                                       
9534: 4eb6:          ENDIF                                                          
9535: 4ebe:          PDTWF.RECORD$ = "LT" + LIST.NUMBER$ +                          \
9536: 4f13:                          RIGHT$("000"+STR$(ITEM.TRAILER.COUNT%), 3)
9537: 4f13:          CURR.SESS.NUM% = PDTWF.SESS.NUM%
9538: 4f25:          CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)
9539: 4f4a:          RC% = WRITE.PDTWF                                          
9540: 4f5e:         IF RC% = 1 THEN GOTO WRITE.ERROR                            
9541: 4f73:       BACK.OUT.EPSOM.LIST.LOOP:                                         
9542: 4f83:       NEXT LIST%
9543: 4f9e:       NESTING.LEVEL% = 0
9544: 4fae:       IF RECEIVE.STATE$ = "*" THEN RETURN
9545: 4fd4:       PDTWF.RECORD$ = "CT" +                                            \
9546: 5020:                       APPLICATION.NO$ +                                 \
9547: 5020:                       CURR.TERMINAL$ +                                  \
9548: 5020:                       FN.Z.PACK(STR$(LIST.TRANSMIT.PTR%), 2)
9549: 5020:       CURR.SESS.NUM% = PDTWF.SESS.NUM%
9550: 5032:       CURRENT.KEY$ = LEFT$(PDTWF.RECORD$,8)
9551: 5057:       RC% = WRITE.PDTWF                                                 
9552: 506b:       IF RC% = 1 THEN GOTO WRITE.ERROR                                   
9553: 5080: 
9554: 5080:    CREATE.EPSOM.XM.FILE.CONTINUE:                                       
9555: 5090: 
9556: 5090:        IF STKMQ.OPEN.FLAG$ = "Y" THEN BEGIN                             ! ASMG 
9557: 50ae:          CLOSE STKMQ.SESS.NUM%                                          ! ASMG
9558: 50c2:          STKMQ.OPEN.FLAG$ = "N"                                         ! ASMG
9559: 50d9:        ENDIF                                                            ! ASMG
9560: 50e1: 
9561: 50e1:    RETURN
9562: 50f1: 
9563: 50f1: 
9564: 50f1: \******************************************************************************
9565: 50f1: \***
9566: 50f1: \***   GET.EPSOM.ITEM.INFO:
9567: 50f1: \***
9568: 50f1: \***      for each item number passed do the following ;
9569: 50f1: \***      read the IDF ( to get the item description )
9570: 50f1: \***      if the item is on the IDF then
9571: 50f1: \***         get 2 bar codes ( from the IEF if available, if not use the IDF
9572: 50f1: \***                          bar code(s) )
9573: 50f1: \***         read the IRF ( to get the price )
9574: 50f1: \***         if the IRF was not readable or the item code was not the same
9575: 50f1: \***         as the one on the IDF then set the price to zero
9576: 50f1: \***         format a PDTWF record
9577: 50f1: \***         write a type 12 transaction to the STKMQ
9578: 50f1: \***      else
9579: 50f1: \***         update the item's status, on the item list file, to "X"
9580: 50f1: \***      endif
9581: 50f1: \***
9582: 50f1: \***   RETURN
9583: 50f1: \***
9584: 50f1: \******************************************************************************
9585: 50f1: 
9586: 50f1:    GET.EPSOM.ITEM.INFO:                                                 
9587: 5101: 
9588: 5101:       PDTWF.RECORD$ = ""
9589: 5118: 
9590: 5118:       PIITM.LIST.ITEM.KEY$ = LIST.NUMBER$ + RIGHT$("00"+STR$(ITEM%), 2)
9591: 5169:       CURR.SESS.NUM% = PIITM.SESS.NUM%
9592: 517b:       CURRENT.KEY$ = PIITM.LIST.ITEM.KEY$
9593: 5197:       RC% = READ.PIITM                                                 
9594: 51ab:       IF RC% = 1 THEN GOTO READ.ERROR                                   
9595: 51c0:       IF RECEIVE.STATE$ = "*" THEN RETURN
9596: 51e6:       IF PIITM.LIST.STATUS$="C" OR PIITM.LIST.STATUS$="R" THEN BEGIN
9597: 523b:          IDF.BOOTS.CODE$ = PIITM.ITEM.CODE$
9598: 5259:          CURR.SESS.NUM% = IDF.SESS.NUM%
9599: 526b:          CURRENT.KEY$ = UNPACK$(PIITM.ITEM.CODE$)
9600: 528c:          RC% = READ.IDF                                                 
9601: 52a0:         IF RC% = 1 THEN GOTO NOT.ON.IDF                            
9602: 52b5:          ITEM.ON.IDF.FLAG$ = "Y"
9603: 52ca:       NO.IDF.REC.RETURN1:
9604: 52da:          IF ITEM.ON.IDF.FLAG$ = "Y" THEN BEGIN
9605: 52f8:             BAR.CODES% = VAL(UNPACK$(IDF.NO.OF.BAR.CODES$))
9606: 531d: 
9607: 531d:             FOR BC%=1 TO 2
9608: 532d:                BAR.CODES$(BC%) = STRING$(12,"0")
9609: 5359:             NEXT BC%
9610: 536f:             BAR.CODE.PTR% = 0
9611: 537c:             IF BAR.CODES% < 3 THEN BEGIN
9612: 538e: 
9613: 538e:                BAR.CODE.PTR% = BAR.CODE.PTR% + 1
9614: 539a:                BAR.CODES$(BAR.CODE.PTR%) = UNPACK$(IDF.FIRST.BAR.CODE$)
9615: 53cc:                IF BAR.CODES% = 2 THEN BEGIN
9616: 53db:                   BAR.CODE.PTR% = BAR.CODE.PTR% + 1
9617: 53e7:                   BAR.CODES$(BAR.CODE.PTR%) = UNPACK$(IDF.SECOND.BAR.CODE$)
9618: 5419:                ENDIF
9619: 5424: 
9620: 5424:             ENDIF ELSE BEGIN
9621: 542c: 
9622: 542c:                BAR.CODE.PTR% = BAR.CODE.PTR% + 1
9623: 5438:                BAR.CODES$(BAR.CODE.PTR%) = UNPACK$(IDF.SECOND.BAR.CODE$)
9624: 546a:                F11.CURRENT.COUNT% = 1
9625: 547b:                F11.NEXT.BAR.CODE$ = IDF.SECOND.BAR.CODE$
9626: 5499:                MORE.FLAG$ = "Y"
9627: 54ae:                WHILE BAR.CODE.PTR% < 2 AND MORE.FLAG$ = "Y"
9628: 54b9:                   CURR.SESS.NUM% = IEF.SESS.NUM%
9629: 54cb:                   RC% = READ.NEXT.IEF( F11.NEXT.BAR.CODE$,              \
9630: 5516:                                       BAR.CODES%,                       \
9631: 5516:                                       RIGHT$(UNPACK$(PIITM.ITEM.CODE$),7) )
9632: 5516:                   IF UNPACK$(F11.NEXT.BAR.CODE$) = STRING$(12, "0")     \
9633: 556c:                   OR RC% <> 0 THEN BEGIN                            
9634: 556c:                      MORE.FLAG$ = "N"
9635: 5583:                   ENDIF ELSE BEGIN
9636: 558b:                      BAR.CODE.PTR% = BAR.CODE.PTR% + 1
9637: 5597:                      BAR.CODES$(BAR.CODE.PTR%) = UNPACK$(F11.NEXT.BAR.CODE$)
9638: 55c9:                   ENDIF
9639: 55d1:                WEND
9640: 560e: 
9641: 560e:             ENDIF
9642: 5616: 
9643: 5616:             IF BAR.CODE.PTR% < 2 AND BAR.CODES% > 1 THEN BEGIN
9644: 563a:                BAR.CODES$(2) = BAR.CODES$(1)
9645: 5670:                BAR.CODES$(1) = UNPACK$(IDF.FIRST.BAR.CODE$)
9646: 569f:                BAR.CODE.PTR% = 2
9647: 56ac:             ENDIF
9648: 56b4: 
9649: 56b4:             IRF.BAR.CODE$ = FN.Z.PACK(UNPACK$(IDF.FIRST.BAR.CODE$), 22)
9650: 56e8:             IRF.BAR.CODE$ = PACK$(IRF.BAR.CODE$)
9651: 570b:             CURR.SESS.NUM% = IRF.SESS.NUM%
9652: 571d:             RC% = READ.IRF                                          
9653: 5731:            IF RC% = 1 THEN GOTO IRF.ERROR                            
9654: 5746:             PRICE$ = "000000"
9655: 575b: !           IRF.PRICE.TYPE$ = MID$(UNPACK$(IRF.INDICAT2$), 2, 1)        !GSWM
9656: 575b: !           IF IRF.PRICE.TYPE$ = "0" OR IRF.PRICE.TYPE$ = "1" THEN      !GSWM
9657: 575b:                PRICE$ = MID$(UNPACK$(IRF.SALEPRIC$), 4, 7)              \
9658: 5790: !           ELSE                                                        !GSWM
9659: 5790: !              IF IRF.PRICE.TYPE$ = "2" THEN                            !GSWM
9660: 5790: !                 PRICE$ = MID$(UNPACK$(IRF.SALEPRIC$), 6, 5)           !GSWM
9661: 5790: !              ELSE                                                     !GSWM
9662: 5790: !                 IF IRF.PRICE.TYPE$ = "3" THEN                         !GSWM
9663: 5790: !                    PRICE$ = MID$(UNPACK$(IRF.SALEPRIC$), 1, 5)        !GSWM
9664: 5790:             IF UNPACK$(IRF.BOOTS.CODE$)                                 \
9665: 57e1:             <> MID$(UNPACK$(IDF.BOOTS.CODE$), 2, 6) THEN                \
9666: 57e1:                GOTO IRF.ERROR
9667: 57ec:          IRF.ERROR.RETURN:
9668: 57fc: 
9669: 57fc:             GOSUB FORMAT.BAR.CODES
9670: 580e: 
9671: 580e:             USER.DATA$ = FN.Z.PACK(STR$(ITEM%), 2) +                    \
9672: 5882:                          LEFT$(PIITM.LIST.STATUS$+" ", 1) +             \
9673: 5882:                          "------"
9674: 5882:             IDF.STNDRD.DESC$ = LEFT$(IDF.STNDRD.DESC$+STRING$(24," "),24)
9675: 58d1:             PDTWF.RECORD$ = "LI" +                                      \
9676: 59b9:                             RIGHT$(UNPACK$(PIITM.ITEM.CODE$),7) +       \
9677: 59b9:                             FN.TRANSLATE.TEXT(IDF.STNDRD.DESC$) +       \
9678: 59b9:                             FN.Z.PACK(PRICE$, 6) +                      \
9679: 59b9:                             FN.Z.PACK(PIITM.FAMILY.MARKER$, 1) +        \
9680: 59b9:                             FN.Z.PACK(PIITM.MEMBERS$, 1) +              \
9681: 59b9:                             BAR.CODES$(1) +                             \
9682: 59b9:                             BAR.CODES$(2) +                             \
9683: 59b9:                             USER.DATA$
9684: 59b9:             ITEM.TRAILER.COUNT% = ITEM.TRAILER.COUNT% + 1
9685: 59c5: 
9686: 59c5:             IF LIST.BC$ <> "Z" THEN BEGIN
9687: 59e3:                STKMQ.TRANS.TYPE$ = PACK$("12")
9688: 59ff:                STKMQ.DATE$ = PACK$(DATE$)
9689: 5a1c:                STKMQ.TIME$ = PACK$(TIME$)
9690: 5a39:                STKMQ.BOOTS.CODE$ = IDF.BOOTS.CODE$
9691: 5a57:                STKMQ.RECORD$ = STKMQ.RECORD.DELIMITER$ +                \
9692: 5ac5:                                STKMQ.TRANS.TYPE$ +                      \
9693: 5ac5:                                STKMQ.FIELD.DELIMITER$ +                 \
9694: 5ac5:                                STKMQ.DATE$ +                            \
9695: 5ac5:                                STKMQ.TIME$ +                            \
9696: 5ac5:                                STKMQ.BOOTS.CODE$ +                      \
9697: 5ac5:                                STKMQ.RECORD.DELIMITER$ +                \
9698: 5ac5:                                STKMQ.ENDREC.MARKER$
9699: 5ac5:                CURR.SESS.NUM% = STKMQ.SESS.NUM%
9700: 5ad7:                CURRENT.KEY$ = ""
9701: 5aec:                RC% = WRITE.STKMQ                                   
9702: 5b00:               IF RC% = 1 THEN GOTO WRITE.ERROR                            
9703: 5b15:             ENDIF
9704: 5b1d:             IF RECEIVE.STATE$ = "*" THEN RETURN
9705: 5b46:          ENDIF ELSE BEGIN
9706: 5b4e:             PDTWF.RECORD$ = ""
9707: 5b65:             PIITM.LIST.STATUS$ = "X"
9708: 5b7c:             CURR.SESS.NUM% = PIITM.SESS.NUM%
9709: 5b8e:             CURRENT.KEY$ = PIITM.LIST.ITEM.KEY$
9710: 5baa:             RC% = WRITE.PIITM                                          
9711: 5bbe:            IF RC% = 1 THEN GOTO WRITE.ERROR                            
9712: 5bd3:             LISTS.CANCELLED% = LISTS.CANCELLED% + 1                     
9713: 5bec:             IF RECEIVE.STATE$ = "*" THEN RETURN
9714: 5c12:          ENDIF
9715: 5c1c:       ENDIF ELSE BEGIN                                                  
9716: 5c24:          IF PIITM.LIST.STATUS$ = "X" THEN BEGIN                        
9717: 5c42:             LISTS.CANCELLED% = LISTS.CANCELLED% + 1                    
9718: 5c5b:          ENDIF                                                         
9719: 5c63:       ENDIF                                                            
9720: 5c6b: 
9721: 5c6b:    GET.EPSOM.ITEM.INFO.CONTINUE:                                       
9722: 5c7b:    RETURN
9723: 5c8b: 
9724: 5c8b: \******************************************************************************
9725: 5c8b: \***
9726: 5c8b: \***   FORMAT.BAR.CODES:
9727: 5c8b: \***
9728: 5c8b: \***      add a check digit onto bar codes to be passed to PDT
9729: 5c8b: \***      note : instore bar codes are treated differently to non-instore
9730: 5c8b: \***             bar codes
9731: 5c8b: \***
9732: 5c8b: \***   RETURN
9733: 5c8b: \***
9734: 5c8b: \******************************************************************************
9735: 5c8b: 
9736: 5c8b:    FORMAT.BAR.CODES:
9737: 5c9b: 
9738: 5c9b:       FOR BC% = 1 TO 2
9739: 5cac:          BAR.CODES$(BC%) = FN.Z.PACK(BAR.CODES$(BC%),12)
9740: 5cec:          BC$ = BAR.CODES$(BC%)
9741: 5d16:          IF BC$ <> STRING$(12, "0") THEN BEGIN
9742: 5d3b:             RC% = CALC.BAR.CODE.CHECK.DIGIT( BC$ )
9743: 5d5a:             IF RC% <> 0 THEN F06.CHECK.DIGIT$ = ""
9744: 5d7b:             BC$ = BC$ + F06.CHECK.DIGIT$
9745: 5da2:          ENDIF
9746: 5daa:          BAR.CODES$(BC%) = FN.Z.PACK(BC$, 13)
9747: 5dd9:       NEXT BC%
9748: 5df2: 
9749: 5df2:    RETURN
9750: 5e02: 
9751: 5e02: \******************************************************************************
9752: 5e02: \***
9753: 5e02: \***   SEND.TO.PSS38:
9754: 5e02: \***
9755: 5e02: \***      transmit data to PSS38 (data contained in PIPE.OUT$)
9756: 5e02: \***
9757: 5e02: \***   RETURN
9758: 5e02: \***
9759: 5e02: \******************************************************************************
9760: 5e02: 
9761: 5e02:    SEND.TO.PSS38:
9762: 5e12:    
9763: 5e12:       IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR
9764: 5e30:       CURR.SESS.NUM% = PIPEI.SESS.NUM%
9765: 5e42:       WRITE# PIPEI.SESS.NUM%; PIPE.OUT$
9766: 5e6a: 
9767: 5e6a:    RETURN
9768: 5e7a: 
9769: 5e7a: 
9770: 5e7a: \******************************************************************************
9771: 5e7a: \***
9772: 5e7a: \***   HOLD.PDT:
9773: 5e7a: \***
9774: 5e7a: \***      send a hold PDT command to PSS38
9775: 5e7a: \***
9776: 5e7a: \***   RETURN
9777: 5e7a: \***
9778: 5e7a: \******************************************************************************
9779: 5e7a:    
9780: 5e7a:    HOLD.PDT:
9781: 5e8a: 
9782: 5e8a:       PIPE.OUT$ = "HY"
9783: 5ea1:       GOSUB SEND.TO.PSS38
9784: 5eb3:       HOLD.FLAG$ = "Y"
9785: 5eca: 
9786: 5eca:    RETURN
9787: 5eda: 
9788: 5eda: 
9789: 5eda: \******************************************************************************
9790: 5eda: \***
9791: 5eda: \***   RELEASE.PDT:
9792: 5eda: \***
9793: 5eda: \***      send a release PDT command to PSS38
9794: 5eda: \***
9795: 5eda: \***   RETURN
9796: 5eda: \***
9797: 5eda: \******************************************************************************
9798: 5eda:    
9799: 5eda:    RELEASE.PDT:
9800: 5eea: 
9801: 5eea:       PIPE.OUT$ = "HN"
9802: 5f01:       GOSUB SEND.TO.PSS38
9803: 5f13:       HOLD.FLAG$ = "N"
9804: 5f2a: 
9805: 5f2a:    RETURN
9806: 5f3a: 
9807: 5f3a: 
9808: 5f3a: 
9809: 5f3a: \******************************************************************************   
9810: 5f3a: \***
9811: 5f3a: \***   LOG.TO.AUDIT.FILE
9812: 5f3a: \***
9813: 5f3a: \***   RETURN
9814: 5f3a: \***
9815: 5f3a: \******************************************************************************
9816: 5f3a:    
9817: 5f3a:    LOG.TO.AUDIT.FILE:
9818: 5f4a: 
9819: 5f4a:       IF CSR.AUDIT.OPEN.FLAG$ = "N" THEN BEGIN                       
9820: 5f68:          IF END #CSR.AUDIT.SESS.NUM% THEN AUDIT.FAIL               
9821: 5f84:          OPEN CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM% APPEND        
9822: 5fab:          CSR.AUDIT.OPEN.FLAG$ = "Y"                                
9823: 5fc2:       ENDIF                                                        
9824: 5fca:                                                                      
9825: 5fca:       PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$          
9826: 5ff9:                                                                        
9827: 5ff9:    AUDIT.FAIL:               
9828: 6009:    
9829: 6009:    RETURN
9830: 6019: 
9831: 6019: \******************************************************************************
9832: 6019: \***
9833: 6019: \***   LOG.TO.LDTAF.FILE
9834: 6019: \***
9835: 6019: \******************************************************************************
9836: 6019: 
9837: 6019:    LOG.TO.LDTAF.FILE:                                                 ! BMJK
9838: 6029:                                                                ! BMJK
9839: 6029:        CURRENT.KEY$ = ""                                          ! BMJK
9840: 603e:        CURR.SESS.NUM% = LDTAF.SESS.NUM%                            ! BMJK
9841: 6050:         IF LDTAF.OPEN.FLAG$ = "N" THEN BEGIN                               ! BMJK 
9842: 606e:            IF END #LDTAF.SESS.NUM% THEN CREATE.LDTAF.FILE                  ! BMJK 
9843: 608a:            OPEN LDTAF.FILE.NAME$ AS LDTAF.SESS.NUM% APPEND                     ! BMJK
9844: 60b1:            LDTAF.OPEN.FLAG$ = "Y"                                          ! BMJK
9845: 60c8:         ENDIF                                                           ! BMJK
9846: 60d0:         IF LDTAF.LINK.TYPE% <> 0 THEN                                    \ BMJK
9847: 60e2:          IF WRITE.LDTAF THEN GOTO WRITE.ERROR                            ! BMJK
9848: 60f6:        LDTAF.OPEN.FLAG$ = "N"                                          ! BMJK
9849: 610d:        CLOSE LDTAF.SESS.NUM%                                          ! BMJK
9850: 6121:                                                                ! BMJK
9851: 6121:    RETURN                                                        ! BMJK
9852: 6131:                                                                ! BMJK
9853: 6131:    CREATE.LDTAF.FILE:                                                       ! BMJK
9854: 6141:                                                                ! BMJK
9855: 6141:        IF END #LDTAF.SESS.NUM% THEN CREATE.ERROR                     ! BMJK
9856: 615d:        CREATE POSFILE LDTAF.FILE.NAME$ AS LDTAF.SESS.NUM%              \ BMJK 
9857: 6183:           MIRRORED ATCLOSE                                          ! BMJK
9858: 6183:         LDTAF.OPEN.FLAG$ = "Y"                                             ! BMJK
9859: 619a:         IF LDTAF.LINK.TYPE% <> 0 THEN                                    \ BMJK
9860: 61ac:          IF WRITE.LDTAF THEN GOTO WRITE.ERROR                            ! BMJK
9861: 61c0:        LDTAF.OPEN.FLAG$ = "N"                                          ! BMJK
9862: 61d7:        CLOSE LDTAF.SESS.NUM%                                          ! BMJK
9863: 61eb:                                                                ! BMJK
9864: 61eb:    RETURN                                                        ! BMJK
9865: 61fb: 
9866: 61fb: \******************************************************************************
9867: 61fb: \***
9868: 61fb: \***   TRANSMIT.EPSOM.FILE:
9869: 61fb: \***
9870: 61fb: \***      send file transmission request to PSS38
9871: 61fb: \***
9872: 61fb: \***   RETURN
9873: 61fb: \***
9874: 61fb: \******************************************************************************
9875: 61fb: 
9876: 61fb:    TRANSMIT.EPSOM.FILE:                     
9877: 620b: 
9878: 620b:       PIPE.OUT$ = "F"
9879: 6222:       GOSUB SEND.TO.PSS38
9880: 6234: 
9881: 6234:       SB.MESSAGE$ = "PDT Support - Waiting for EPSOM E.O.T"             
9882: 6249:       GOSUB SB.BG.MESSAGE 
9883: 625b:          
9884: 625b:    RETURN
9885: 626b: 
9886: 626b: \******************************************************************************
9887: 626b: \***
9888: 626b: \***   INTERROGATE.PSS38:
9889: 626b: \***
9890: 626b: \***      determine current state of PSS38
9891: 626b: \***
9892: 626b: \***   RETURN
9893: 626b: \***
9894: 626b: \******************************************************************************
9895: 626b: 
9896: 626b:    INTERROGATE.PSS38:
9897: 627b:    
9898: 627b:       SAVED.PIPE.OUT$ = PIPE.OUT$
9899: 6297:       PIPE.OUT$ = "I"
9900: 62ae:       GOSUB SEND.TO.PSS38
9901: 62c0:       IF END# PIPEO.SESS.NUM% THEN READ.ERROR
9902: 62de:       CURR.SESS.NUM% = PIPEO.SESS.NUM%
9903: 62f0:       READ# PIPEO.SESS.NUM%; PSS38.STATUS$
9904: 6318:       PIPE.OUT$ = SAVED.PIPE.OUT$
9905: 6333: 
9906: 6333:    RETURN
9907: 6343: 
9908: 6343: \******************************************************************************
9909: 6343: \******************************************************************************
9910: 6343: \***                                                                        ***
9911: 6343: \***                                                                        ***
9912: 6343: \***   L O W   L E V E L   S U B R O U T I N E S                            ***
9913: 6343: \***                                                                        ***
9914: 6343: \***                                                                        ***
9915: 6343: \***   - SB.FILE.UTILS                                                      ***
9916: 6343: \***   - SB.BG.MESSAGE                                                      ***
9917: 6343: \***   - SB.LOG.AN.EVENT                                                    ***
9918: 6343: \***   - SB.FORMAT.ERROR.DATA                                               ***
9919: 6343: \***   - SB.FILE.OPEN.ERROR                                                 ***
9920: 6343: \***   - SB.FILE.READ.ERROR                                                 ***
9921: 6343: \***   - SB.FILE.WRITE.ERROR                                                ***
9922: 6343: \***                                                                        ***
9923: 6343: \******************************************************************************
9924: 6343: \******************************************************************************
9925: 6343: 
9926: 6343: \******************************************************************************
9927: 6343: \***
9928: 6343: \***   Subroutine : SB.FILE.UTILS
9929: 6343: \***
9930: 6343: \***   Purpose    : Allocate / report / de-allocate a file session number
9931: 6343: \***
9932: 6343: \***   Parameters : 2 or 3 (depending on action)
9933: 6343: \***
9934: 6343: \***      SB.ACTION$  = "O" for allocate file session number
9935: 6343: \***                    "R" for report file session number
9936: 6343: \***                    "C" for de-allocate file session number
9937: 6343: \***      SB.INTEGER% = file reporting number for action "O" or 
9938: 6343: \***                  = file session number for actions "R" or "C"
9939: 6343: \***
9940: 6343: \***      SB.STRING$  = logical file name for action "O" or
9941: 6343: \***                    null ("") for actions "R" and "C"
9942: 6343: \***
9943: 6343: \***   Output     : 1 or 2 (depending on action)
9944: 6343: \***      SB.FILE.SESS.NUM% = file session number for action "O" or
9945: 6343: \***                          undefined for action "C"
9946: 6343: \***      or
9947: 6343: \***      SB.FILE.REP.NUM%  = file reporting number for action "R" or
9948: 6343: \***                          undefined for action "C"  
9949: 6343: \***
9950: 6343: \***   Error action : log event 48 and end program
9951: 6343: \***
9952: 6343: \******************************************************************************
9953: 6343: 
9954: 6343:    SB.FILE.UTILS:
9955: 6353:    
9956: 6353:       RC% = SESS.NUM.UTILITY(SB.ACTION$,                            \
9957: 637f:                           SB.INTEGER%,                            \
9958: 637f:                           SB.STRING$ )
9959: 637f:                           
9960: 637f:       IF RC% <> 0 THEN BEGIN
9961: 6391:          SB.EVENT.NO% = 48
9962: 639e:         SB.UNIQUE$ = FN.Z.PACK(STR$(F20.INTEGER.FILE.NO%), 10)
9963: 63cf:         SB.MESSAGE$ = "SESSION NUMBER ALLOCATION ROUTINE FAILED"
9964: 63e4:         GOSUB SB.LOG.AN.EVENT
9965: 63f6:         GOTO PROGRAM.EXIT
9966: 6401:       ENDIF
9967: 6409:       
9968: 6409:       IF SB.ACTION$ = "O" THEN                                          \
9969: 6424:          SB.FILE.SESS.NUM% = F20.INTEGER.FILE.NO%
9970: 6436:       IF SB.ACTION$ = "R" OR SB.ACTION$ = "D" THEN BEGIN               ! DNS
9971: 6482:          SB.FILE.REP.NUM% = F20.INTEGER.FILE.NO%
9972: 6494:          SB.ERRF$ = CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +                  \ DNS
9973: 64dd:                     CHR$(SHIFT(SB.FILE.REP.NUM%,0))                    ! DNS
9974: 64dd:       ENDIF                                                            ! DNS
9975: 64e5:                     
9976: 64e5: 
9977: 64e5: 
9978: 64e5:    RETURN
9979: 64f5: 
9980: 64f5: 
9981: 64f5: \******************************************************************************
9982: 64f5: \***
9983: 64f5: \***   Subroutine : SB.BG.MESSAGE
9984: 64f5: \***
9985: 64f5: \***   Purpose    : Display a message to the background screen
9986: 64f5: \***
9987: 64f5: \***   Parameters : 1
9988: 64f5: \***
9989: 64f5: \***      SB.MESSAGE$ = message to be displayed (message will be truncated to
9990: 64f5: \***                    46 characters if the message is longer than 46 chars)
9991: 64f5: \***                    Minus the port letter.
9992: 64f5: \***
9993: 64f5: \***   Output     : 1
9994: 64f5: \***      SB.MESSAGE$ = null   
9995: 64f5: \***
9996: 64f5: \***   Error action : log an event 23 and end program
9997: 64f5: \***
9998: 64f5: \******************************************************************************
9999: 64f5: 
10000: 64f5:    SB.BG.MESSAGE:
10001: 6505:    
10002: 6505:       IF SB.MESSAGE$ = LAST.MESSAGE$ THEN RETURN
10003: 652f:       LAST.MESSAGE$ = SB.MESSAGE$                                   
10004: 654a:    
10005: 654a:       SB.MESSAGE$ = MONITORED.PORT$ + ": " + SB.MESSAGE$                    
10006: 6575:       SB.MESSAGE$ = LEFT$(SB.MESSAGE$ + STRING$(46, " "), 46)              
10007: 65bf:       CALL ADXSERVE( ADX.RET.CODE%, 26, 0, SB.MESSAGE$)
10008: 65f7:       
10009: 65f7:       IF ADX.RET.CODE% <> 0 THEN BEGIN
10010: 6612:          SB.EVENT.NO% = 23
10011: 661f:         SB.UNIQUE$ = FN.Z.PACK(STR$(ADX.RET.CODE%),5) + "04   "
10012: 6660:         SB.MESSAGE$ = ""
10013: 6675:         GOSUB SB.LOG.AN.EVENT
10014: 6687:       ENDIF
10015: 668f:       
10016: 668f:       SB.MESSAGE$ = ""
10017: 66a4:       
10018: 66a4:    RETURN
10019: 66b4: 
10020: 66b4: 
10021: 66b4: \******************************************************************************
10022: 66b4: \***
10023: 66b4: \***   Subroutine : SB.LOG.AN.EVENT
10024: 66b4: \***
10025: 66b4: \***   Purpose    : General routine to log an event using passed data. If
10026: 66b4: \***                program has been started manually for a re-run then also
10027: 66b4: \***                display a message on the background screen.
10028: 66b4: \***                The event will be preceded by one indicating the port
10029: 66b4: \***                being monitored by the program in error.
10030: 66b4: \***
10031: 66b4: \***   Parameters : 2
10032: 66b4: \***
10033: 66b4: \***      SB.EVENT.NO% = number of event to be logged
10034: 66b4: \***      SB.UNIQUE$   = 10 byte block of data unique to event
10035: 66b4: \***
10036: 66b4: \***   Output     : none
10037: 66b4: \***
10038: 66b4: \***   Error action : none
10039: 66b4: \***
10040: 66b4: \******************************************************************************
10041: 66b4: 
10042: 66b4:    SB.LOG.AN.EVENT:
10043: 66c4:    
10044: 66c4:       MESSAGE.NO% = 0
10045: 66d2:       UNIQUE.2$ = ""
10046: 66e7:       
10047: 66e7:       PORT.STRING$ = "PORT : " + MONITORED.PORT$ + "  "                           
10048: 6710:       PORT.EVENT% = 75                                                        
10049: 6720:       
10050: 6720:       RC% = APPLICATION.LOG(MESSAGE.NO%,                            \      
10051: 6757:                          PORT.STRING$,                                   \      
10052: 6757:                          UNIQUE.2$,                                   \      
10053: 6757:                          PORT.EVENT% )                                  
10054: 6757:                          
10055: 6757:       RC% = APPLICATION.LOG(MESSAGE.NO%,                            \
10056: 6787:                          SB.UNIQUE$,                                   \
10057: 6787:                          UNIQUE.2$,                                   \
10058: 6787:                          SB.EVENT.NO% )
10059: 6787: 
10060: 6787:    RETURN
10061: 6797: 
10062: 6797: 
10063: 6797: \******************************************************************************
10064: 6797: \***
10065: 6797: \***   Subroutine : SB.FORMAT.ERROR.DATA
10066: 6797: \***
10067: 6797: \***   Purpose    : General routine to format the common error reporting
10068: 6797: \***                data
10069: 6797: \***
10070: 6797: \***   Parameters : 0
10071: 6797: \***
10072: 6797: \***   Output     : 
10073: 6797: \***      SB.ERRS$   = ERRN converted to a 4 byte string
10074: 6797: \***      SB.ERRL$   = ERRL zero packed up to 6 bytes
10075: 6797: \***      SB.ERRF$   = ERRF converted to a reporting number (1 byte)
10076: 6797: \***
10077: 6797: \***   Error action : if hex conversion or string conversion fails then the
10078: 6797: \***                  program ends
10079: 6797: \***
10080: 6797: \******************************************************************************
10081: 6797:    
10082: 6797:    SB.FORMAT.ERROR.DATA:
10083: 67a7:    
10084: 67a7:       RC% = CONV.TO.HEX( ERRN )                                          
10085: 67c7:       IF RC% <> 0 THEN                                                 \
10086: 67d9:          GOTO PROGRAM.EXIT
10087: 67e4:         
10088: 67e4:       RC% = CONV.TO.STRING(0,                                          \
10089: 6808:                         ERRN )
10090: 6808:       IF RC% <> 0 THEN                                                 \
10091: 681a:          GOTO PROGRAM.EXIT
10092: 6825:       SB.ERRS$ = F17.RETURNED.STRING$        
10093: 6841:         
10094: 6841:       SB.ERRL$ = FN.Z.PACK(STR$(ERRL), 6)
10095: 6870:       SB.ACTION$ = "R" : SB.INTEGER% = ERRF% : SB.STRING$ = ""
10096: 689a:       GOSUB SB.FILE.UTILS
10097: 68ac:    
10098: 68ac:    RETURN
10099: 68bc: 
10100: 68bc: 
10101: 68bc: \******************************************************************************
10102: 68bc: \***
10103: 68bc: \***   Subroutine : SB.FILE.OPEN.ERROR
10104: 68bc: \***
10105: 68bc: \***   Purpose    : Log an event 6 with unique data indicating an error has
10106: 68bc: \***                occurred whilst attempting to open a file.
10107: 68bc: \***
10108: 68bc: \***   Parameters : 1
10109: 68bc: \***
10110: 68bc: \***      CURR.SESS.NUM% = file session number of the file that caused the
10111: 68bc: \***                       error, this is used to look-up the file reporting
10112: 68bc: \***                       number that is logged in the event's unique data.
10113: 68bc: \***
10114: 68bc: \***   Output     : none
10115: 68bc: \***
10116: 68bc: \***   Error action : none
10117: 68bc: \***
10118: 68bc: \******************************************************************************
10119: 68bc: 
10120: 68bc:    SB.FILE.OPEN.ERROR:
10121: 68cc:    
10122: 68cc:       SB.ACTION$ = "R"
10123: 68e1:       SB.INTEGER% = CURR.SESS.NUM%
10124: 68ef:       SB.STRING$ = ""
10125: 6904:       GOSUB SB.FILE.UTILS
10126: 6916:       SB.EVENT.NO% = 106                                          ! BMJK
10127: 6923:       SB.UNIQUE$ = "O" + SB.ERRF$ + PACK$(STRING$(16,"0"))             ! DNS
10128: 6953:       GOSUB SB.LOG.AN.EVENT
10129: 6965:       
10130: 6965:    RETURN
10131: 6975: 
10132: 6975: 
10133: 6975: \******************************************************************************
10134: 6975: \***
10135: 6975: \***   Subroutine : SB.FILE.READ.ERROR
10136: 6975: \***
10137: 6975: \***   Purpose    : Log an event 6 with unique data indicating an error has
10138: 6975: \***                occurred whilst attempting to read a file.
10139: 6975: \***
10140: 6975: \***   Parameters : 2
10141: 6975: \***
10142: 6975: \***      CURR.SESS.NUM%  = file session number of the file that caused the
10143: 6975: \***                        error, this is used to look-up the file reporting
10144: 6975: \***                        number that is logged in the event's unique data.
10145: 6975: \***      CURRENT.KEY$    = value of key used to try to read from file.
10146: 6975: \***
10147: 6975: \***   Output     : none
10148: 6975: \***
10149: 6975: \***   Error action : none
10150: 6975: \***
10151: 6975: \******************************************************************************
10152: 6975: 
10153: 6975:   SB.FILE.READ.ERROR:
10154: 6985:    
10155: 6985:       SB.ACTION$ = "R"
10156: 699a:       SB.INTEGER% = CURR.SESS.NUM%
10157: 69a8:       SB.STRING$ = ""
10158: 69bd:       GOSUB SB.FILE.UTILS
10159: 69cf:       SB.EVENT.NO% = 6
10160: 69dc:       
10161: 69dc:       SB.UNIQUE$ = "R" +                                          \
10162: 6a0a:                    SB.ERRF$ +                                          \ DNS
10163: 6a0a:                    FN.Z.PACK(CURRENT.KEY$,7)                           ! DNS        
10164: 6a0a:       
10165: 6a0a:       GOSUB SB.LOG.AN.EVENT
10166: 6a1c:       
10167: 6a1c:    RETURN
10168: 6a2c: 
10169: 6a2c:    
10170: 6a2c: \******************************************************************************
10171: 6a2c: \***
10172: 6a2c: \***   Subroutine : SB.FILE.WRITE.ERROR
10173: 6a2c: \***
10174: 6a2c: \***   Purpose    : Log an event 6 with unique data indicating an error has
10175: 6a2c: \***                occurred whilst attempting to write a file.
10176: 6a2c: \***
10177: 6a2c: \***   Parameters : 2
10178: 6a2c: \***
10179: 6a2c: \***      CURR.SESS.NUM%  = file session number of the file that caused the
10180: 6a2c: \***                        error, this is used to look-up the file reporting
10181: 6a2c: \***                        number that is logged in the event's unique data.
10182: 6a2c: \***    CURRENT.KEY$    = value of key used to try to write to file.  
10183: 6a2c: \***
10184: 6a2c: \***   Output     : none
10185: 6a2c: \***
10186: 6a2c: \***   Error action : none
10187: 6a2c: \***
10188: 6a2c: \******************************************************************************
10189: 6a2c: 
10190: 6a2c:    SB.FILE.WRITE.ERROR:
10191: 6a3c:    
10192: 6a3c:       SB.ACTION$ = "R"
10193: 6a51:       SB.INTEGER% = CURR.SESS.NUM%
10194: 6a5f:       SB.STRING$ = ""
10195: 6a74:       GOSUB SB.FILE.UTILS
10196: 6a86:       SB.EVENT.NO% = 106                                          ! BMJK
10197: 6a93:       SB.UNIQUE$ = "W" +                                                \
10198: 6ac1:                    SB.ERRF$ +                                          \ DNS
10199: 6ac1:                   FN.Z.PACK(CURRENT.KEY$,8)
10200: 6ac1:       GOSUB SB.LOG.AN.EVENT
10201: 6ad3:       
10202: 6ad3:    RETURN
10203: 6ae3: 
10204: 6ae3: 
10205: 6ae3: \******************************************************************************
10206: 6ae3: \***
10207: 6ae3: \***   Subroutine : SB.FILE.CREATE.ERROR
10208: 6ae3: \***
10209: 6ae3: \***   Purpose    : Log an event 6 with unique data indicating an error has
10210: 6ae3: \***                occurred whilst attempting to create a file.
10211: 6ae3: \***
10212: 6ae3: \***   Parameters : 2
10213: 6ae3: \***
10214: 6ae3: \***      CURR.SESS.NUM%  = file session number of the file that caused the
10215: 6ae3: \***                        error, this is used to look-up the file reporting
10216: 6ae3: \***                        number that is logged in the event's unique data.
10217: 6ae3: \***
10218: 6ae3: \***   Output     : none
10219: 6ae3: \***
10220: 6ae3: \***   Error action : none
10221: 6ae3: \***
10222: 6ae3: \******************************************************************************
10223: 6ae3: 
10224: 6ae3:    SB.FILE.CREATE.ERROR:
10225: 6af3:    
10226: 6af3:       SB.ACTION$ = "R"
10227: 6b08:       SB.INTEGER% = CURR.SESS.NUM%
10228: 6b16:       SB.STRING$ = ""
10229: 6b2b:       GOSUB SB.FILE.UTILS
10230: 6b3d:       SB.EVENT.NO% = 106                                          ! BMJK
10231: 6b4a:       SB.UNIQUE$ = "C" + SB.ERRF$                                      ! DNS
10232: 6b6a:       GOSUB SB.LOG.AN.EVENT
10233: 6b7c:       
10234: 6b7c:    RETURN
10235: 6b8c: 
10236: 6b8c: 
10237: 6b8c: \******************************************************************************
10238: 6b8c: \******************************************************************************
10239: 6b8c: \***                                                                        ***
10240: 6b8c: \***                                                                        ***
10241: 6b8c: \***   E R R O R   H A N D L I N G                                          ***
10242: 6b8c: \***                                                                        ***
10243: 6b8c: \***                                                                        ***
10244: 6b8c: \******************************************************************************
10245: 6b8c: \******************************************************************************
10246: 6b8c: 
10247: 6b8c: \******************************************************************************
10248: 6b8c: \***
10249: 6b8c: \***   OPEN.ERROR:
10250: 6b8c: \***
10251: 6b8c: \***      log an event 6 (open error)
10252: 6b8c: \***      set RECEIVE.STATE$ to "*"
10253: 6b8c: \***
10254: 6b8c: \***      if the source of the error is known then return to one of the
10255: 6b8c: \***      specified return points so the program does not end
10256: 6b8c: \***
10257: 6b8c: \***   GOTO MODULE.EXIT (no return is possible)
10258: 6b8c: \***
10259: 6b8c: \******************************************************************************
10260: 6b8c: 
10261: 6b8c:    OPEN.ERROR:
10262: 6b9c:   
10263: 6b9c:       TEMP.STATE$ = RECEIVE.STATE$ 
10264: 6bb8:       GOSUB SB.FILE.OPEN.ERROR
10265: 6bca:       RECEIVE.STATE$ = "*"
10266: 6be1:       
10267: 6be1:       IF TEMP.STATE$ = "H" THEN GOTO EPSOM.LIST.REQUEST.CONTINUE       
10268: 6bff:       IF TEMP.STATE$ = "C" THEN GOTO EPSOM.FILE.HEADER.CONTINUE        
10269: 6c1d:       
10270: 6c1d:       GOTO MODULE.EXIT
10271: 6c28: 
10272: 6c28: 
10273: 6c28: \******************************************************************************
10274: 6c28: \***
10275: 6c28: \***   READ.ERROR:
10276: 6c28: \***
10277: 6c28: \***      log an event 6 (read error)
10278: 6c28: \***      set RECEIVE.STATE$ to "*"
10279: 6c28: \***      if the source of the error is known then return to one of the
10280: 6c28: \***      specified return points so the program does not end
10281: 6c28: \***
10282: 6c28: \***   GOTO MODULE.EXIT (no return is possible)
10283: 6c28: \***
10284: 6c28: \******************************************************************************
10285: 6c28: 
10286: 6c28:    READ.ERROR:
10287: 6c38:   
10288: 6c38:       TEMP.STATE$ = RECEIVE.STATE$ 
10289: 6c54:       GOSUB SB.FILE.READ.ERROR
10290: 6c66:       RECEIVE.STATE$ = "*"       
10291: 6c7d: 
10292: 6c7d:       IF TEMP.STATE$ = "H" THEN BEGIN
10293: 6c98:          IF CURR.SESS.NUM% = PIITM.SESS.NUM% THEN BEGIN
10294: 6cad:             GOTO GET.EPSOM.ITEM.INFO.CONTINUE                          
10295: 6cb8:          ENDIF
10296: 6cc0:       ENDIF
10297: 6cc8: 
10298: 6cc8:       IF CURR.SESS.NUM% = STKMQ.SESS.NUM% THEN BEGIN
10299: 6cdd:          IF TEMP.STATE$ = "E" THEN GOTO EPSOM.LIST.ITEM.CONTINUE       
10300: 6cfb:       ENDIF
10301: 6d03: 
10302: 6d03: 
10303: 6d03:       GOTO MODULE.EXIT
10304: 6d0e: 
10305: 6d0e: 
10306: 6d0e: \******************************************************************************
10307: 6d0e: \***
10308: 6d0e: \***   WRITE.ERROR:
10309: 6d0e: \***
10310: 6d0e: \***      log an event 6 (write error)
10311: 6d0e: \***      set RECEIVE.STATE$ to "*"
10312: 6d0e: \***
10313: 6d0e: \***      if the source of the error is known then return to one of the
10314: 6d0e: \***      specified return points so the program does not end
10315: 6d0e: \***
10316: 6d0e: \***   GOTO MODULE.EXIT (no return is possible)
10317: 6d0e: \***
10318: 6d0e: \******************************************************************************
10319: 6d0e: 
10320: 6d0e:    WRITE.ERROR:
10321: 6d1e:   
10322: 6d1e:       TEMP.STATE$ = RECEIVE.STATE$ 
10323: 6d3a:       GOSUB SB.FILE.WRITE.ERROR
10324: 6d4c:       RECEIVE.STATE$ = "*"
10325: 6d63:    
10326: 6d63:          IF TEMP.STATE$ = "H" THEN BEGIN
10327: 6d81:          IF CURR.SESS.NUM% = PDTWF.SESS.NUM% THEN BEGIN
10328: 6d96:             IF NESTING.LEVEL% = 0 THEN GOTO CREATE.EPSOM.XM.FILE.CONTINUE 
10329: 6dab:             IF NESTING.LEVEL% = 1 THEN GOTO BACK.OUT.EPSOM.LIST.LOOP   
10330: 6dc0:             IF NESTING.LEVEL% = 2 THEN GOTO BACK.OUT.EPSOM.ITEM.LOOP   
10331: 6dd5:          ENDIF
10332: 6ddd:          IF CURR.SESS.NUM% = PIITM.SESS.NUM%                            \
10333: 6e0b:          OR CURR.SESS.NUM% = STKMQ.SESS.NUM% THEN BEGIN
10334: 6e0b:             GOTO GET.EPSOM.ITEM.INFO.CONTINUE                          
10335: 6e16:          ENDIF
10336: 6e1e:       ENDIF
10337: 6e26: 
10338: 6e26:       IF CURR.SESS.NUM% = STKMQ.SESS.NUM% THEN BEGIN
10339: 6e3b:          IF TEMP.STATE$ = "E" THEN GOTO EPSOM.LIST.ITEM.CONTINUE       
10340: 6e59:          IF TEMP.STATE$ = "F" THEN GOTO EPSOM.LIST.TRAILER.CONTINUE    
10341: 6e77:       ENDIF
10342: 6e7f: 
10343: 6e7f:    
10344: 6e7f:    GOTO MODULE.EXIT
10345: 6e8a: 
10346: 6e8a: 
10347: 6e8a: \******************************************************************************
10348: 6e8a: \***
10349: 6e8a: \***   CREATE.ERROR:
10350: 6e8a: \***
10351: 6e8a: \***      log an event 6 (create error)
10352: 6e8a: \***      set RECEIVE.STATE$ to "*"
10353: 6e8a: \***
10354: 6e8a: \***      if the source of the error is known then return to one of the
10355: 6e8a: \***      specified return points so the program does not end
10356: 6e8a: \***
10357: 6e8a: \***   GOTO MODULE.EXIT (no return is possible)
10358: 6e8a: \***
10359: 6e8a: \******************************************************************************
10360: 6e8a: 
10361: 6e8a:    CREATE.ERROR:
10362: 6e9a:   
10363: 6e9a:       TEMP.STATE$ = RECEIVE.STATE$ 
10364: 6eb6:       GOSUB SB.FILE.CREATE.ERROR
10365: 6ec8:       RECEIVE.STATE$ = "*"
10366: 6edf:    
10367: 6edf:          IF CURR.SESS.NUM% = PDTWF.SESS.NUM% THEN BEGIN
10368: 6ef4:          IF TEMP.STATE$ = "H" THEN GOTO EPSOM.LIST.REQUEST.CONTINUE     
10369: 6f12:       ENDIF
10370: 6f1a:    
10371: 6f1a:    GOTO MODULE.EXIT
10372: 6f25:    
10373: 6f25: 
10374: 6f25: \******************************************************************************
10375: 6f25: \***
10376: 6f25: \***   NOT.ON.IDF:
10377: 6f25: \***
10378: 6f25: \***      the item was not found on the IDF so log a read error
10379: 6f25: \***
10380: 6f25: \***   GOTO NO.IDF.REC.RETURN1:
10381: 6f25: \***
10382: 6f25: \******************************************************************************
10383: 6f25: 
10384: 6f25:    NOT.ON.IDF:
10385: 6f35: 
10386: 6f35:       ITEM.ON.IDF.FLAG$ = "N"
10387: 6f4a:       GOSUB SB.FILE.READ.ERROR
10388: 6f5c: 
10389: 6f5c:    GOTO NO.IDF.REC.RETURN1
10390: 6f67: 
10391: 6f67: \******************************************************************************
10392: 6f67: \***
10393: 6f67: \***   IRF.ERROR:
10394: 6f67: \***
10395: 6f67: \***      the item was either not found on the IRF or the item code on the
10396: 6f67: \***      IDF did not match the one or the IRF so and log an error
10397: 6f67: \***
10398: 6f67: \***   GOTO IRF.ERROR.RETURN
10399: 6f67: \***
10400: 6f67: \******************************************************************************
10401: 6f67: 
10402: 6f67:    IRF.ERROR:
10403: 6f77: 
10404: 6f77:       SB.EVENT.NO% = 8
10405: 6f84:       SB.UNIQUE$ = IDF.BOOTS.CODE$                                      
10406: 6fa0:       GOSUB SB.LOG.AN.EVENT
10407: 6fb2: 
10408: 6fb2:    GOTO IRF.ERROR.RETURN
10409: 6fbd: 
10410: 6fbd: \******************************************************************************
10411: 6fbd: \***
10412: 6fbd: \***   PILST.READ.FAIL:
10413: 6fbd: \***
10414: 6fbd: \***      end of PILST file encountered so set the E.O.F flag
10415: 6fbd: \***
10416: 6fbd: \***   GOTO RETURN.PILST.EOF
10417: 6fbd: \***
10418: 6fbd: \******************************************************************************
10419: 6fbd: 
10420: 6fbd:    PILST.READ.FAIL:                                             !!
10421: 6fcd: 
10422: 6fcd:       PILST.EOF.FLAG$ = "Y"                                     !!
10423: 6fe2: 
10424: 6fe2:    GOTO RETURN.PILST.EOF                                        !!
10425: 6fed: 
10426: 6fed: \******************************************************************************
10427: 6fed: \***
10428: 6fed: \***   BC.NOT.FOUND:
10429: 6fed: \***
10430: 6fed: \***      An invalid business centre code was encountered so set up the
10431: 6fed: \***      return data to indicate this
10432: 6fed: \***
10433: 6fed: \***   GOTO RETURN.TO.BC.CHECK
10434: 6fed: \***
10435: 6fed: \******************************************************************************
10436: 6fed: 
10437: 6fed:    BC.NOT.FOUND:
10438: 6ffd: 
10439: 6ffd:       SORT.ORDER$ = "C"                                                 
10440: 7012:       SORT.DATE$ = "850101"                                            ! FNS
10441: 7027:       PILST.LIST.NUMBER$ = BCSMF.FSI$ + "   "
10442: 704c:       PILST.LIST.NAME$ = "Invalid Letter"
10443: 7063:       PILST.ITEMS.IN.LIST% = 0                                          
10444: 7073:       PILST.LIST.STATUS$ = "?"
10445: 708a:       PILST.LIST.TYPE$ = "?"
10446: 70a1:       GOSUB STORE.EPSOM.LIST.INFO                                       
10447: 70b3: 
10448: 70b3:    GOTO RETURN.TO.BC.CHECK
10449: 70be: 
10450: 70be: 
10451: 70be: \*****************************************************************************
10452: 70be: \***   REDIRECT:
10453: 70be: \***
10454: 70be: \*****************************************************************************
10455: 70be: 
10456: 70be:    REDIRECT:
10457: 70ce: 
10458: 70ce:       RECEIVE.STATE$ = "*"
10459: 70e5:       ON RES.POS% GOTO EPSOM.FILE.HEADER.CONTINUE,                      \ 
10460: 7103:                        EPSOM.LIST.ITEM.CONTINUE,                        \ 
10461: 7103:                        EPSOM.LIST.TRAILER.CONTINUE,                     \ 
10462: 7103:                        EPSOM.FILE.TRAILER.CONTINUE                      
10463: 7103: 
10464: 7103:    GOTO MODULE.EXIT 
10465: 710e:    
10466: 710e: \******************************************************************************
10467: 710e: \***
10468: 710e: \***   ERROR.DETECTED:
10469: 710e: \***
10470: 710e: \***      if an error has occurred after a 'fatal' error then quit program
10471: 710e: \***
10472: 710e: \***      increment ERROR.COUNT% 
10473: 710e: \***      NOTE : all returns from error detected should decrement the
10474: 710e: \***             variable ERROR.COUNT% and exit using the RESUME command
10475: 710e: \***      if ERROR.COUNT% > 1 then end program (error within error detected)
10476: 710e: \***
10477: 710e: \***      set-up common error reporting information
10478: 710e: \***
10479: 710e: \***      if an access conflict occurs on a session then retry
10480: 710e: \***
10481: 710e: \***      if error is out of memory then log an event, using ADXERROR and
10482: 710e: \***      quit program
10483: 710e: \***
10484: 710e: \***      log an event 1
10485: 710e: \***
10486: 710e: \***   resume MODULE.EXIT
10487: 710e: \***
10488: 710e: \******************************************************************************
10489: 710e: 
10490: 710e: ERROR.DETECTED:
10491: 711e:  
10492: 711e: 
10493: 711e:    
10494: 711e:    ERROR.COUNT% = ERROR.COUNT% + 1
10495: 712d:    IF ERROR.COUNT% > 1 THEN RESUME PROGRAM.EXIT
10496: 714e: 
10497: 714e:    GOSUB SB.FORMAT.ERROR.DATA
10498: 7160: 
10499: 7160:    IF (ERRN AND 0000FFFFh) = 0000400Ch THEN BEGIN
10500: 719d:       ERROR.COUNT% = ERROR.COUNT% - 1
10501: 71ac:         REP% = SB.FILE.REP.NUM%                                        ! DNS
10502: 71ba:        IF REP% = STKMQ.REPORT.NUM% THEN BEGIN                          ! ASMG
10503: 71d2:          IF TOTAL.WAIT.TIME% < 600 THEN BEGIN                          ! ASMG
10504: 71e2:             WAIT;2000                                                  ! ASMG
10505: 71f9:             TOTAL.WAIT.TIME% = TOTAL.WAIT.TIME% + 2                    ! ASMG
10506: 7206:             RESUME RETRY                                               ! ASMG
10507: 721f:          ENDIF ELSE BEGIN                                              ! ASMG
10508: 7227:             SB.EVENT.NO% = 49                                          ! ASMG
10509: 7234:             GOSUB SB.LOG.AN.EVENT                                      ! ASMG
10510: 7246:             RESUME PROGRAM.EXIT                                        ! ASMG
10511: 725d:          ENDIF                                                         ! ASMG
10512: 7265:        ENDIF                                                           ! ASMG
10513: 726d:    ENDIF
10514: 7275: 
10515: 7275:    IF ERRN = 80F3400CH AND SB.FILE.REP.NUM% = PDTWF.REPORT.NUM% THEN BEGIN ! DNS
10516: 72ad:       ERROR.COUNT% = ERROR.COUNT% - 1                                  ! DNS
10517: 72bc:       RECEIVE.STATE$ = "*"                                             ! DNS
10518: 72d3:       RESUME MODULE.EXIT                                               ! DNS
10519: 72ea:    ENDIF                                                               ! DNS
10520: 72f2: 
10521: 72f2:     IF ERR = "CU" OR ERR = "OE" OR ERR = "DF" THEN BEGIN               ! DNS
10522: 737e:        ERROR.COUNT% = ERROR.COUNT% - 1                                 ! DNS
10523: 738d:        RESUME                                                          ! DNS
10524: 73a4:     ENDIF                                                              ! DNS
10525: 73ac: 
10526: 73ac:    
10527: 73ac:    IF ERR = "OM" THEN BEGIN
10528: 73d5:       SB.UNIQUE$ = SB.ERRS$ + SB.ERRF$ +                             \ BMJK
10529: 7435:                        PACK$(RIGHT$(STRING$(8,"0")+SB.ERRL$,8))              ! BMJK
10530: 7435:       CALL ADXERROR(0, 74, 0, 3, 101, SB.UNIQUE$ )
10531: 745d:       ERROR.COUNT% = ERROR.COUNT% - 1
10532: 746c:       RESUME PROGRAM.EXIT
10533: 7483:    ENDIF
10534: 748b: 
10535: 748b:    IF ERR = "IH" AND ERRN = 00000094h THEN BEGIN
10536: 74df:       TEMP.STATE$ = RECEIVE.STATE$
10537: 74fb:       RES.POS% = MATCH(TEMP.STATE$, "CEFG", 1)
10538: 7519:       IF RES.POS% = 0 THEN BEGIN
10539: 7528:          RESUME PROGRAM.EXIT
10540: 7541:       ENDIF ELSE BEGIN
10541: 7549:          RESUME REDIRECT
10542: 7560:       ENDIF
10543: 7568:    ENDIF
10544: 7570: 
10545: 7570:    SB.EVENT.NO% = 101                                                  ! DNS
10546: 757d:    SB.UNIQUE$ = SB.ERRS$ + SB.ERRF$ +                                  \ DNS
10547: 75dd:                  PACK$(RIGHT$(STRING$(8,"0")+SB.ERRL$,8))              ! BMJK
10548: 75dd:    GOSUB SB.LOG.AN.EVENT       
10549: 75ef:    
10550: 75ef:    ERROR.COUNT% = ERROR.COUNT% - 1
10551: 75fe:    RECEIVE.STATE$ = "*"
10552: 7615:    RESUME MODULE.EXIT
10553: 762c: 
10554: 762c: END SUB
10555: 7640: End of Compilation
