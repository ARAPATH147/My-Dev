   1: 0003: \******************************************************************************
   2: 0003: \******************************************************************************
   3: 0003: \***
   4: 0003: \***   $Workfile:   PSS3700.bas  $
   5: 0003: \***
   6: 0003: \***   $Revision:   1.23  $
   7: 0003: \***
   8: 0003: \******************************************************************************
   9: 0003: \******************************************************************************
  10: 0003: \***
  11: 0003: \***   $Log:   V:/Archive/Basarch/PSS3700.bav  $
  12: 0003: \***   
  13: 0003: \***      Rev 1.23   12 Jan 2009 12:06:42   stuart.highley
  14: 0003: \***   Changes for +UODs (A9B)
  15: 0003: \***   
  16: 0003: \***      Rev 1.22   06 Oct 2008 09:40:32   Peter.Sserunkuma
  17: 0003: \***   A9A. Relinked to include changes made to
  18: 0003: \***   the PLLDB functions
  19: 0003: \***   
  20: 0003: \***      Rev 1.21   02 Jul 2007 12:44:44   greenfield.brian
  21: 0003: \***   Changes for A7C Recalls.
  22: 0003: \***   
  23: 0003: \***      Rev 1.20   16 Feb 2007 10:28:48   paul.bowers
  24: 0003: \***   NB A7B defect resolution 
  25: 0003: \***   for ASN processing
  26: 0003: \***
  27: 0003: \***      Rev 1.18   18 Jul 2006 12:08:24   charles.skadorwa
  28: 0003: \***   PDT Connection Checker. PSS38 can now
  29: 0003: \***   instruct PSS37 to end if it detects that a
  30: 0003: \***   PDT is not connected after 5 minutes. It
  31: 0003: \***   sends the status "@@".
  32: 0003: \***
  33: 0003: \***      Rev 1.17   01 Mar 2005 11:33:48   dev07ps
  34: 0003: \***   Upwards TSF Fix.
  35: 0003: \***   Fix to Report & Session numbers.
  36: 0003: \***   Relinked with latest PLLOL object.
  37: 0003: \***   Removal of LSS specific code.
  38: 0003: \***   Fix to Stock Counting - moved to new program PDTSC.286 to solve PDT
  39: 0003: \***   timeout when > 40 counts.
  40: 0003: \***
  41: 0003: \***
  42: 0003: \***      Rev 1.16   12 Jan 2005 12:20:42   dev88ps
  43: 0003: \***   Corrected so that old and new price checks
  44: 0003: \***   work in this release. Changes could be
  45: 0003: \***   removed in the future to get rid of the old
  46: 0003: \***   price check code. For A5A
  47: 0003: \***
  48: 0003: \***      Rev 1.15   24 Dec 2004 13:04:00   dev07ps
  49: 0003: \***   A5A Shelf Monitor Project
  50: 0003: \***
  51: 0003: \***
  52: 0003: \***      Rev 1.14   20 Apr 2004 13:50:44   devjsps
  53: 0003: \***   Changes to Goods Out functionality
  54: 0003: \***   as part of A4D package upgrade
  55: 0003: \***
  56: 0003: \***      Rev 1.13   16 Dec 2003 09:03:34   devjsps
  57: 0003: \***   Program updated to add Pharmacy Smartscript
  58: 0003: \***   Stock count changes and Credit Claim changes.
  59: 0003: \***   David Artiss has also added Stock takings changes
  60: 0003: \***   to PSB3704.BAS
  61: 0003: \***
  62: 0003: \***      Rev 1.12   30 Jul 2003 14:27:48   dev88ps
  63: 0003: \***   Changes made to accomodate new Stock
  64: 0003: \***   Count facility on the PDT. New module
  65: 0003: \***   PSS3705 created.
  66: 0003: \***
  67: 0003: \***      Rev 1.11   09 Jul 2003 11:18:18   dev38ps
  68: 0003: \***   Reduced file allocations
  69: 0003: \***
  70: 0003: \***      Rev 1.11   09 Jul 2003 11:04:20   dev38ps
  71: 0003: \***   Ensure LOCCNT is opened whether it's a normal stocktake or BOL one.
  72: 0003: \***
  73: 0003: \***      Rev 1.9   29 Oct 2002 09:09:24   dev88ps
  74: 0003: \***   Changes to accomodate live stock counting
  75: 0003: \***   in the LSS only (store 2999.) Changes are
  76: 0003: \***   not visible in any other store.
  77: 0003: \***
  78: 0003: \***      Rev 1.8   12 Oct 2001 12:03:42   DEV38PS
  79: 0003: \***   Added LDT audit file processing
  80: 0003: \***
  81: 0003: \***      Rev 1.7   05 Feb 1998 11:57:42   DEV45PS
  82: 0003: \***
  83: 0003: \***
  84: 0003: \***      Rev 1.6   25 Sep 1997 13:22:02   DEV45PS
  85: 0003: \***   Increased processing speed of data from stocktake PDT. Also
  86: 0003: \***   now sends acknowledgement back to PDT after transmission.
  87: 0003: \***
  88: 0003: \***      Rev 1.5   10 Sep 1997 11:44:20   DEV45PS
  89: 0003: \***   Changes For Stocktake System - Processes transmissions from
  90: 0003: \***   stocktake PDT's
  91: 0003: \***
  92: 0003: \***      Rev 1.4   21 Aug 1996 14:25:44   DEVDSPS
  93: 0003: \***   ECC Enhancements
  94: 0003: \***
  95: 0003: \***      Rev 1.3   21 May 1996 09:58:20   DEV20PS
  96: 0003: \***   Gap Monitor Changes
  97: 0003: \***
  98: 0003: \***      Rev 1.2   28 Jul 1995 13:22:24   DEVDSPS
  99: 0003: \***   CSR PHASE 2 - disallow PDT linking when PHASE 2.
 100: 0003: \***
 101: 0003: \***      Rev 1.1   07 Oct 1994 15:51:14   DEVSPPS
 102: 0003: \***   Fixed PDT Support hang
 103: 0003: \***
 104: 0003: \***   REVISION 1.2  David Smallwood    16th February 1995
 105: 0003: \***
 106: 0003: \***   Disallow linking to CSR application if CSR conversion has either
 107: 0003: \***   started or finished. Also bypass processing of CSR item file at
 108: 0003: \***   startup if conversion completed.
 109: 0003: \***
 110: 0003: \******************************************************************************
 111: 0003: \******************************************************************************
 112: 0003: 
 113: 0003: \******************************************************************************
 114: 0003: \******************************************************************************
 115: 0003: \***                                                                        ***
 116: 0003: \***                                                                        ***
 117: 0003: \***           PROGRAM  :  PSS3700                                          ***
 118: 0003: \***                                                                        ***
 119: 0003: \***           AUTHOR   :  S.Wright  (Pseudocode / BASIC code)              ***
 120: 0003: \***                                                                        ***
 121: 0003: \***           DATE     :  23rd May 1989                                    ***
 122: 0003: \***                                                                        ***
 123: 0003: \***                                                                        ***
 124: 0003: \***           Current version letter : O                                   ***
 125: 0003: \***                                                                        ***
 126: 0003: \***           Date of last amendment : 17th May 1994                       ***
 127: 0003: \***                                                                        ***
 128: 0003: \*** NOTE: IN PARAGRAPH CREATE.AUDIT.FILE REMEMBER TO CHANGE PROGRAM        ***
 129: 0003: \*** VERSION NUMBER AND DATE OF CREATION AS THIS IS WRITTEN TO THE AUDIT    ***
 130: 0003: \*** FILE. THIS ALSO REQUIRES CHANGING IN MODULE 1 IN CREATE.AUDIT.FILE     ***
 131: 0003: \***                                                                        ***
 132: 0003: \******************************************************************************
 133: 0003: \******************************************************************************
 134: 0003: 
 135: 0003: \******************************************************************************
 136: 0003: \******************************************************************************
 137: 0003: \***                                                                        ***
 138: 0003: \***   O V E R V I E W                                                      ***
 139: 0003: \***                                                                        ***
 140: 0003: \***   PSS37 - L.D.T. / P.D.T. Support Program.                             ***
 141: 0003: \***                                                                        ***
 142: 0003: \***   PSS37 is designed to run concurrently with PSS38. PSS38 handles      ***
 143: 0003: \***   all asyncronous communications with a connected LDT/PDT. All data    ***
 144: 0003: \***   sent by the LDT/PDT is passed to PSS37 via PSS38 by means of a       ***
 145: 0003: \***   'pipe'.                                                              ***
 146: 0003: \***                                                                        ***
 147: 0003: \***   PSS37 validates the data sent to ensure the data has been sent in    ***
 148: 0003: \***   the correct sequence, has a valid format and is meaningful.          ***
 149: 0003: \***   There are basically two processes PSS37 performs to either an LDT    ***
 150: 0003: \***   or PDT;                                                              ***
 151: 0003: \***                                                                        ***
 152: 0003: \***   i)  Reception of data from connected device to provide stock         ***
 153: 0003: \***        updating information usually onto the STKMQ.                    ***
 154: 0003: \***   ii) Transfer of data to the connected device to provide a basis for  ***
 155: 0003: \***        the user to capture stock information.                          ***
 156: 0003: \***                                                                        ***
 157: 0003: \******************************************************************************
 158: 0003: \******************************************************************************
 159: 0003: 
 160: 0003: \******************************************************************************
 161: 0003: \******************************************************************************
 162: 0003: \***                                                                        ***
 163: 0003: \***   A M E N D M E N T S                                                  ***
 164: 0003: \***                                                                        ***
 165: 0003: \***   Version B.   S.Wright.                            21st August 1989   ***
 166: 0003: \***   Compare only the leftmost six characters of the IRF and IDF Boots    ***
 167: 0003: \***   codes.                                                               ***
 168: 0003: \***                                                                        ***
 169: 0003: \***   Version C.   S.Wright.                          6th September 1989   ***
 170: 0003: \***   Alter program so text strings sent to the PDT can be converted, to   ***
 171: 0003: \***   allow for the differences in the PDT character set and the 4680      ***
 172: 0003: \***   character set. Alter program to allow for a log on time less than    ***
 173: 0003: \***   the current time.                                                    ***
 174: 0003: \***                                                                        ***
 175: 0003: \***   Version D.   Janet Lawrence                     11th July 1990       ***
 176: 0003: \***   EPOS-CSR link II.                                                    ***
 177: 0003: \***   The PDT now runs three applications - EPSOM, CSR and PRICE CHECK.    ***
 178: 0003: \***   Both PSS37 and PSS38 are being altered to cope with the two extra    ***
 179: 0003: \***   applications, also to monitor two ports.  Consequently a parameter   ***
 180: 0003: \***   will be passed to the program to indicate the port being monitored.  ***
 181: 0003: \***   NB.  Because the original program referred to "lists" this has been  ***
 182: 0003: \***   left to mean EPSOM lists; CSR lists will be "CSR lists".             ***
 183: 0003: \***                                                                        ***
 184: 0003: \***   Version D.   Paul Bowers                        1st July 1991        ***
 185: 0003: \***   EPOS-CSR Link II.                                                    ***
 186: 0003: \***   Comments:                                                            ***
 187: 0003: \***   To include code to perform an auto shut down after 10pm daily to     ***
 188: 0003: \***   prevent files being left open during the night causing access        ***
 189: 0003: \***   conflicts in the batch suites.                                       ***
 190: 0003: \***                                                                        ***
 191: 0003: \***   Version E.   Paul Bowers                        2nd October 1991     ***
 192: 0003: \***   EPOS-CSR Link II.                                                    ***
 193: 0003: \***   To include processing for the new CSRAF CSR Audit File               ***
 194: 0003: \***                                                                        ***
 195: 0003: \***   Version F.  SSJ/P Bowers/S Wright               30th October 1991    ***
 196: 0003: \***   Performance improvements to idle state, reduce processor usage from  ***
 197: 0003: \***   11% to 0% !!! Yes really.                                            ***
 198: 0003: \***   Correct bug in b/g message display.                                  ***
 199: 0003: \***   Remove Ev. 66s.                                                      ***
 200: 0003: \***                                                                        ***
 201: 0003: \***   Version G.  Paul Bowers                          8th January 1992    ***
 202: 0003: \***   CSR Change to remove update of WEEK 4 SALES                          ***
 203: 0003: \***                                                                        ***
 204: 0003: \***   Version H.  David Smallwood                     17th March 1992      ***
 205: 0003: \***   A new application for Directs Receiving is being introduced.  This   ***
 206: 0003: \***   application uses a new piece of hardware, the Laser Data Terminal    ***
 207: 0003: \***   (LDT).  When orders are requested from the LDT PSS37 will process    ***
 208: 0003: \***   new data files to format the order information for transmitting back ***
 209: 0003: \***   to the LDT.  The new data files are the Direct Supplier File         ***
 210: 0003: \***   (DIRSUP) and the Direct Orders File (DIRORD).  When receipts are     ***
 211: 0003: \***   passed back to the controller PSS37 will write receipts information  ***
 212: 0003: \***   to the Stock Movement Queue for processing by Stock Support.         ***
 213: 0003: \***                                                                        ***
 214: 0003: \***   Version I.  Les Cook                            30th October 1992    ***
 215: 0003: \***   Streamlined code as per new Programming guidelines.                  ***
 216: 0003: \***   Checks made to ensure printer is switched                            ***
 217: 0003: \***   on and online before CHKBF.BIN is created during PRICE CHECK appl.   ***
 218: 0003: \***   A relevant message is sent to the PDT if it is not.                  ***
 219: 0003: \***   At end of each application link, PSS37 & PSS38 chain onto themselves ***
 220: 0003: \***   to solve memory problems.                                            ***
 221: 0003: \***   Fix to problem 761.                                                  ***
 222: 0003: \***                                                                        ***
 223: 0003: \***   Version J.  Les Cook                            23rd November 1992   ***
 224: 0003: \***   LDTBF file now created by PSS37 for use by PSS78 (LDT Reporting      ***
 225: 0003: \***   Program). Event 6 messages not logged now for read errors on the     ***
 226: 0003: \***   CITEM or IDF.                                                        ***
 227: 0003: \***   Fix to problem B??? - if wrong store on LDT it now says "LDT" rather ***
 228: 0003: \***   than "PDT".                                                          ***
 229: 0003: \***   Also, all checks to the printer and SEL from version I are deleted.  ***
 230: 0003: \***   CSR lines linked for the first time which have an allocation record  ***
 231: 0003: \***   on the Initial Display Stock Outstanding File (IDSOF) will have sales***
 232: 0003: \***   figures on the CIMF adjusted accordingly and the matching IDSOF      ***
 233: 0003: \***   record deleted.                                                      ***
 234: 0003: \***                                                                        ***
 235: 0003: \***   Version K.  Les Cook / Steven Goulding          13th January 1993    ***
 236: 0003: \***   Interim version to fix problem where STKMQ is being corrupted.       ***
 237: 0003: \***   STKMQ is now opened with BUFFSIZE 512 and READONLY. The STKMQ is now ***
 238: 0003: \***   to opened, written & closed at list level for type 12 & 13 txns      ***
 239: 0003: \***                                                                        ***
 240: 0003: \***   Version L.  Les Cook                                25th March 1993  ***
 241: 0003: \***   Extra data states created to accomodate UOD Receiving using and LDT. ***
 242: 0003: \***   These states are a - f (NOTE!!!! lower case letters)                 ***
 243: 0003: \***   When a successful transmission of UOD data has occurred, type        ***
 244: 0003: \***   21 and 23 records are written to the STKMQ and UODBF, and PSS45 is   ***
 245: 0003: \***   kicked off as a background task to produce the Missing UOD Report    ***
 246: 0003: \***   and the Picking Check Report (if necessary).                         ***
 247: 0003: \***                                                                        ***
 248: 0003: \***   Version L (Supplemental).  Steven Goulding           24th June 1993  ***
 249: 0003: \***   Changes to problems identified with reporting two byte file reporting***
 250: 0003: \***   numbers and addition of UOD report number to access conflict within  ***
 251: 0003: \***   ERROR.DETECTED routine.                                              ***
 252: 0003: \***                                                                        ***
 253: 0003: \***   Version L (Supplemental).  Michael J. Kelsall        14th July 1993  ***
 254: 0003: \***   Changes to validate CSR header record transmission before data is    ***
 255: 0003: \***   written to the CSRBF to correct problem within system.               ***
 256: 0003: \***                                                                        ***
 257: 0003: \***   Version M Michael J. Kelsall                        30th Sept 1993   ***
 258: 0003: \***   Addition of code to handle the LDT transmissions concerned with the  ***
 259: 0003: \***   Returns/Automatic Credit Claiming System. The main functionality     ***
 260: 0003: \***   will be present in an additional module (four).                      ***
 261: 0003: \***   Inclusion of change to fix to BOOTS problem 1060.                    ***
 262: 0003: \***                                                                        ***
 263: 0003: \***   Version M (Supplemental).  David Smallwood         7th January 1994  ***
 264: 0003: \***   If failure to open CCUOD/read CCUOD header record then log error     ***
 265: 0003: \***   and goto program exit.  Also fix CCDMY error reporting.  Now report  ***
 266: 0003: \***   2 byte file number.                                                  ***
 267: 0003: \***                                                                        ***
 268: 0003: \***   Version N  Michael J. Kelsall                      23rd March 1994   ***
 269: 0003: \***   RETURNS/AUTOMATIC CREDIT CLAIMING SYSTEM MODIFICATIONS.              ***
 270: 0003: \***   Various fixes and changes to LDT/PSS37 interface for Returns;        ***
 271: 0003: \***   - Change to Returns data state validation to allow a UOD trailer to  ***
 272: 0003: \***     follow a UOD header with no item level records present             ***
 273: 0003: \***   - Change to LDTAF duration to seconds as opposed to minutes.         ***
 274: 0003: \***   - Four digit quantity being supplied from LDT as opposed to three.   ***
 275: 0003: \***   - Change to CSRAF to add port letter to every output line except '-' ***
 276: 0003: \***                                                                        ***
 277: 0003: \***   Version O  Steven Goulding                         2nd June 1994     ***
 278: 0003: \***   Move write to audit files after PSS37 has acknowledged a logon to    ***
 279: 0003: \***   PDT via PSS38 - to reduce double logon failures                      ***
 280: 0003: \***                                                                        ***
 281: 0003: \***   Version O (Supplemental)   Michael J. Kelsall     15th June 1994     ***
 282: 0003: \***   Change to Data state S valid data state options to prevent PSS37     ***
 283: 0003: \***   logging abort at end of LDT program load (even though load is        ***
 284: 0003: \***   successful).                                                         ***
 285: 0003: \***                                                                        ***
 286: 0003: \***                                                                        ***
 287: 0003: \***   REVISION 1.1      ROBERT COWEY / STEVE WRIGHT      6TH OCTOBER 1994  ***
 288: 0003: \***   Removed version letters from included code.                          ***
 289: 0003: \***                                                                        ***
 290: 0003: \***   REVISION 1.2      David Smallwood                 17th November 1994 ***
 291: 0003: \***   Do not allow CSR link if PHASE2 CSR has been activated. Also bypass  ***
 292: 0003: \***   processing of CSR item file at startup if conversion activated.      ***
 293: 0003: \***                                                                        ***
 294: 0003: \***   REVISION 1.3      Stuart Highley                   10th April 1996   ***
 295: 0003: \***   Redirect gapped items (distinguished from price checked items due to ***
 296: 0003: \***   the price of the item being entered as 1p at the PDT) to a new file, ***
 297: 0003: \***   the Gapped Item Buffer File. Also, start the Gap Report application  ***
 298: 0003: \***   (PSS47).                                                             ***
 299: 0003: \***                                                                        ***
 300: 0003: \***   REVISION 1.4      David Smallwood                  21st May 1996     ***
 301: 0003: \***   Include file processing for CCLAM.  Module 4 is being changed to     ***
 302: 0003: \***   transmit despatched UODs from CCLAM to the LDT.  This change is part ***
 303: 0003: \***   of ECC enhancements and will help prevent duplicate claims returning ***
 304: 0003: \***   to the centre.                                                       ***
 305: 0003: \***                                                                        ***
 306: 0003: \***   REVISION 1.5      Nik Sen                          30th June 1997    ***
 307: 0003: \***   Added new data states p,q,r and new files SXTCF, SXTMP, STKBF, STKTK ***
 308: 0003: \***   to support stocktaking PDT's.                                        ***
 309: 0003: \***                                                                        ***
 310: 0003: \***   REVISION 1.6            Nik Sen                 10th December 1997   ***
 311: 0003: \***   Changed length of file received from PDT to include an extra digit   ***
 312: 0003: \***   for the location.                                                    ***
 313: 0003: \***                                                                        ***
 314: 0003: \***   REVISION 1.7      David Artiss                   29th January 2001   ***
 315: 0003: \***   Added new file STLDT.                                                ***
 316: 0003: \***                                                                        ***
 317: 0003: \***   REVISION 1.8      Brian Greenfield               17th October 2002   ***
 318: 0003: \***   Added LSSST and IMSTC for LSS stock counts.                          ***
 319: 0003: \***                                                                        ***
 320: 0003: \***   REVISION 1.9      David Artiss                      7th March 2003   ***
 321: 0003: \***   Added new processing to allow stocktake PDTs with other stores       ***
 322: 0003: \***   data to be transmitted and sent straight to the appropriate          ***
 323: 0003: \***   mainframe file.                                                      ***
 324: 0003: \***                                                                        ***
 325: 0003: \***   REVISION 2.0      David Artiss                       27th May 2003   ***
 326: 0003: \***   During the testing of version 1.9 of this code there were problems   ***
 327: 0003: \***   with the fact that the code kept running out of session numbers to   ***
 328: 0003: \***   allocate. This I got around by allocating certain files only when    ***
 329: 0003: \***   entering the appropriate module and then deallocating on exit.       ***
 330: 0003: \***   However, this problem has persisted in the live environment. To      ***
 331: 0003: \***   this end I have improved this by allocating/deallocating more files  ***
 332: 0003: \***   as well as the fact that I've commented out reference to STKCF       ***
 333: 0003: \***   which doesn't seem to be used any more.                              ***
 334: 0003: \***                                                                        ***
 335: 0003: \***   *** !!!WARNING!!!  ***                                               ***
 336: 0003: \***                                                                        ***
 337: 0003: \***   There are still potential problems due to the large number of        ***
 338: 0003: \***   files that this program uses.                                        ***
 339: 0003: \***   Module 1 contains a lot of code for the old CSR transmissions        ***
 340: 0003: \***   system which is no longer used. In fact now that the PDT6100 has     ***
 341: 0003: \***   rolled out the function is not even accessable anymore. This code    ***
 342: 0003: \***   should be removed and this will also free up a lot of extra files.   ***
 343: 0003: \***                                                                        ***
 344: 0003: \***   REVISION 2.1      Brian Greenfield                  17th July 2003   ***
 345: 0003: \***   Changes made to add three new data states s, t, AND u to accomodate  ***
 346: 0003: \***   new store stock counts. A new module of PSS3705 has been created.    ***
 347: 0003: \***                                                                        ***
 348: 0003: \***   REVISION 2.2      Julia Stones                  21st October 2003    ***
 349: 0003: \***   Changes made to add four new data states w, x, y AND z to accomodate ***
 350: 0003: \***   new Pharmacy stock counts. The main bulk of the code to process the  ***
 351: 0003: \***   data in the four new data states has been added to module PSS3705.   ***
 352: 0003: \***                                                                        ***
 353: 0003: \***   REVISION 2.3     Julia Stones                   13th November 2003   ***
 354: 0003: \***   Changes made to change existing returns data state g to accomodate   ***
 355: 0003: \***   new Other Credit Claiming.  The main bulk of the code to process the ***
 356: 0003: \***   data for Other Credit Claiming has been added to module PSS3704      ***
 357: 0003: \***                                                                        ***
 358: 0003: \***   REVISION 2.4    Julia Stones                   12th March 2004       ***
 359: 0003: \***   Other Credit Claim is being changed so that items not on file are    ***
 360: 0003: \***   allowed as part of the claim (items not on file were being rejected  ***
 361: 0003: \***   from the claim and added to the rejection file).  Also instead of    ***
 362: 0003: \***   PSS37 creating the rejection report, the information is now written  ***
 363: 0003: \***   out to a new credit claim rejection file CCREJ.  If any items have   ***
 364: 0003: \***   been rejected the PSS25 is started via ADXSTART                      ***
 365: 0003: \***   Goods out has been changed to be in line with Other Credit claiming  ***
 366: 0003: \***   Items that are for invalid Business Centres are rejected from the    ***
 367: 0003: \***   claims and added to the rejection file                               ***
 368: 0003: \***   Items where the item qty x the item value is > £9,999.99 will have   ***
 369: 0003: \***   the record split into individual items.                              ***
 370: 0003: \***   If a new flag on SOFTS record 43 shows that all rejections are req   ***
 371: 0003: \***   then if the item business centre does not match the claim business   ***
 372: 0003: \***   centre this item will be removed from the claim and a record added   ***
 373: 0003: \***   to the rejection file CCREJ                                          ***
 374: 0003: \***   For both Other Credit Claiming and goods out - the rejecting of items***
 375: 0003: \***   not on file has been commented out (in case this becomes a later     ***
 376: 0003: \***   requirement as part of all items in all stores)                      ***
 377: 0003: \***                                                                        ***
 378: 0003: \***   REVISION 2.5    Charles Skadorwa             25th October 2004       ***
 379: 0003: \***   Shelf Monitor Project changes.                                       ***
 380: 0003: \***   Record size for Price Check item increased as PDT now transmits      ***
 381: 0003: \***   Shelf and Fill quantity data.                                        ***
 382: 0003: \***   IMPORTANT: Update CREATE.AUDIT.FILE                                  ***
 383: 0003: \***                                                                        ***
 384: 0003: \***   REVISION 2.6    Brian Greenfield             11th January 2005       ***
 385: 0003: \***   Fixes to allow old record type P and new record type P to both work. ***
 386: 0003: \***   The old record type P can be removed next time this module is        ***
 387: 0003: \***   altered.                                                             ***
 388: 0003: \***                                                                        ***
 389: 0003: \***   REVISION 2.7    Charles Skadorwa             4th February 2005       ***
 390: 0003: \***   Fix file reporting issue. When opening files you pass the file       ***
 391: 0003: \***   reporting number to SB.FILE.UTILS function. When closing, you pass   ***
 392: 0003: \***   the session number. This has not been adhered to which results in    ***
 393: 0003: \***   the wrong file being reported. The SB.FILE.UTILS should also be      ***
 394: 0003: \***   called to remove an entry from the session number table, otherwise   ***
 395: 0003: \***   it fills up and causes PSS37 to become unstable.                     ***
 396: 0003: \***                                                                        ***
 397: 0003: \***   Removed LSS 2999 processing as redundant now.                        ***
 398: 0003: \***                                                                        ***
 399: 0003: \***   SB.FILE.UTILS now called when closing the TSF. The Session Number    ***
 400: 0003: \***   Table was getting filled up because a new entry was added each time  ***
 401: 0003: \***   the TSF was re-opened.                                               ***
 402: 0003: \***                                                                        ***
 403: 0003: \***   REVISION 2.8    Charles Skadorwa             3rd July 2006           ***
 404: 0003: \***   This program will now shutdown if an "@@" request is received from   ***
 405: 0003: \***   PSS38. This will prevent PSS37 taking up any resources if a PDT is   ***
 406: 0003: \***   not connected.                                                       ***
 407: 0003: \***                                                                        ***
 408: 0003: \***   REVISION 2.9    Neil Bennett                22nd December 2006       ***
 409: 0003: \***   Add ASN processing support.                                          ***
 410: 0003: \***   Remove CSR processing support.                                       ***
 411: 0003: \***                                                                        ***
 412: 0003: \***   REVISION 2.10   Brian Greenfield            11th May 2007            ***
 413: 0003: \***   Added Recalls functionality for A7C.                                 ***
 414: 0003: \***   Added new states 1, 2, 3, 4, 5, & 6.                                 ***
 415: 0003: \***                                                                        ***
 416: 0003: \***   REVISION 2.11   Peter Sserunkuma            25th Sep 2008            ***
 417: 0003: \***   Relinked to include changes made to the PLLDB function as part of    ***
 418: 0003: \***   the work to allow the counting of Multi-sited items.                 ***
 419: 0003: \***                                                                        ***
 420: 0003: \***   REVISION 2.12   Stuart Highley              13th Nov 2008            ***
 421: 0003: \***   Positive UOD receiving.                                              ***
 422: 0003: \***                                                                        ***
 423: 0003: \******************************************************************************
 424: 0003: \******************************************************************************
 425: 0003: 
 426: 0003: \******************************************************************************
 427: 0003: \******************************************************************************
 428: 0003: \***                                                                        ***
 429: 0003: \***   P R O G R A M   S T R U C T U R E                                    ***
 430: 0003: \***                                                                        ***
 431: 0003: \*** - Global definitions                                                   ***
 432: 0003: \*** - Variable declarations                                                ***
 433: 0003: \*** - External function declarations                                       ***
 434: 0003: \*** - Internal function declarations (all prefixed 'FN.')                  ***
 435: 0003: \*** - Mainline code                                                        ***
 436: 0003: \*** - Mainline code subroutines                                            ***
 437: 0003: \*** - Low level subroutines (all passed vars and routines prefixed 'SB.')  ***
 438: 0003: \*** - Error handling (IF END processing and all general error trapping)    ***
 439: 0003: \***                                                                        ***
 440: 0003: \******************************************************************************
 441: 0003: \******************************************************************************
 442: 0003: 
 443: 0003: \******************************************************************************
 444: 0003: \******************************************************************************
 445: 0003: \***                                                                        ***
 446: 0003: \***   G L O B A L   D E F I N I T I O N S                                  ***
 447: 0003: \***                                                                        ***
 448: 0003: \******************************************************************************
 449: 0003: \******************************************************************************
 450: 0003: 
 451: 0003: %INCLUDE PSBF06G.J86                                                    ! ILC
 452: 0003: REM\
 453: 0003: \*******************************************************************************
 454: 0003: \*******************************************************************************
 455: 0003: \***
 456: 0003: \***        INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT globals
 457: 0003: \***
 458: 0003: \***        REFERENCE     : PSBF06G.J86
 459: 0003: \***
 460: 0003: \***        Version A     Bruce Scriver                 24th February 1986 
 461: 0003: \***
 462: 0003: \***        Version B     Andrew Wedgeworth                 15th July 1992
 463: 0003: \***        Removal of return code field which no longer required.
 464: 0003: \***
 465: 0003: \*******************************************************************************
 466: 0003: \*******************************************************************************
 467: 0003: 
 468: 0003:       STRING   GLOBAL F06.CHECK.DIGIT$
 469: 0003: 
 470: 0003: 
 471: 0003: 
 472: 0003: %INCLUDE ASYNCNUB.J86                                                   ! ILC
 473: 0003: 
 474: 0003: \******************************************************************************
 475: 0003: \******************************************************************************
 476: 0003: \***
 477: 0003: \***          %INCLUDE FOR ASYNC PDT LINK (STOCK COUTING - PSS37)
 478: 0003: \***
 479: 0003: \***                         LINK TYPE : ASYNC
 480: 0003: \***
 481: 0003: \***                     REFERENCE : ASYNCNUM.J86
 482: 0003: \***
 483: 0003: \******************************************************************************
 484: 0003: \******************************************************************************
 485: 0003: 
 486: 0003:    STRING GLOBAL							\
 487: 0003: 	ASYNC.FILE.NAME$,						\
 488: 0003: 	ASYNC.OPEN.FLAG$
 489: 0003: 	
 490: 0003:    INTEGER*1 GLOBAL							\
 491: 0003: 	ASYNC.REPORT.NUM%,						\
 492: 0003: 	ASYNC.SESS.NUM%
 493: 0003: %INCLUDE EPSOMDEC.J86                                                   ! ILC
 494: 0003: REM \
 495: 0003: \******************************************************************************
 496: 0003: \******************************************************************************
 497: 0003: \***
 498: 0003: \***         %INCLUDE FOR EPSOM DUMMY FILE - FILE REFERENCE PARAMETERS
 499: 0003: \***
 500: 0003: \***               REFERENCE    : EPSOMDEC.J86
 501: 0003: \***
 502: 0003: \******************************************************************************
 503: 0003: \*******************************************************************************
 504: 0003: 
 505: 0003:   STRING GLOBAL           \
 506: 0003:     EPSOM.FILE.NAME$
 507: 0003: 
 508: 0003:   INTEGER*2 GLOBAL        \
 509: 0003:     EPSOM.REPORT.NUM%,      \
 510: 0003:     EPSOM.SESS.NUM%
 511: 0003: %INCLUDE PDTWFDEC.J86                                                   ! ILC
 512: 0003: REM \
 513: 0003: \******************************************************************************
 514: 0003: \******************************************************************************
 515: 0003: \***
 516: 0003: \***            %INCLUDE FOR PDT WORK FILE - FIELD DECLARATIONS
 517: 0003: \***                                         FILE REFERENCE PARAMETERS
 518: 0003: \***
 519: 0003: \***                          8th October 1992
 520: 0003: \***
 521: 0003: \******************************************************************************
 522: 0003: \*******************************************************************************
 523: 0003: 
 524: 0003:   STRING GLOBAL								\
 525: 0003:         PDTWF.RECORD$,							\
 526: 0003: 	PDTWF.FILE.NAME$
 527: 0003: 
 528: 0003:   INTEGER*2 GLOBAL							\
 529: 0003: 	PDTWF.SESS.NUM%,						\
 530: 0003: 	PDTWF.REPORT.NUM%
 531: 0003: %INCLUDE PIPEONUB.J86                                                   ! ILC
 532: 0003: 
 533: 0003: \******************************************************************************
 534: 0003: \******************************************************************************
 535: 0003: \***
 536: 0003: \***                  %INCLUDE FOR PSS38 OUTPUT PIPE
 537: 0003: \***
 538: 0003: \***                         LINK TYPE : PIPEO
 539: 0003: \***
 540: 0003: \***                     REFERENCE : PIPEONUM.J86
 541: 0003: \***
 542: 0003: \******************************************************************************
 543: 0003: \******************************************************************************
 544: 0003: 
 545: 0003:    STRING GLOBAL							\
 546: 0003: 	PIPEO.FILE.NAME$
 547: 0003: 	
 548: 0003:    INTEGER*1 GLOBAL							\
 549: 0003: 	PIPEO.REPORT.NUM%,						\
 550: 0003: 	PIPEO.SESS.NUM%
 551: 0003: %INCLUDE PLDTNUMA.J86                                                   ! ILC
 552: 0003: 
 553: 0003: \******************************************************************************
 554: 0003: \******************************************************************************
 555: 0003: \***
 556: 0003: \***                   %INCLUDE FOR PSS38 LDT PIPE
 557: 0003: \***
 558: 0003: \***
 559: 0003: \***                     REFERENCE : PLDTNUM.J86
 560: 0003: \***
 561: 0003: \******************************************************************************
 562: 0003: \******************************************************************************
 563: 0003: 
 564: 0003:    STRING GLOBAL							\
 565: 0003: 	PLDT.FILE.NAME$
 566: 0003: 	
 567: 0003:    INTEGER*1 GLOBAL							\
 568: 0003: 	PLDT.REPORT.NUM%,						\
 569: 0003: 	PLDT.SESS.NUM%
 570: 0003: %INCLUDE SITEMDEC.J86                                                   ! ILC
 571: 0003: REM \
 572: 0003: \******************************************************************************
 573: 0003: \******************************************************************************
 574: 0003: \***
 575: 0003: \***         %INCLUDE FOR SHELF EDGE LABELS INDIVIDUAL ITEM 
 576: 0003: \***
 577: 0003: \***               - FIELD DECLARATIONS
 578: 0003: \***               - FILE REFERENCE PARAMETERS
 579: 0003: \***
 580: 0003: \***               REFERENCE    : SITEMDEC.J86
 581: 0003: \***
 582: 0003: \***
 583: 0003: \***    VERSION B.             STUART HIGHLEY              26TH JUNE 1997
 584: 0003: \***    Added global variable RPRT.LINE$ (already referenced in WRITE.SITEM).
 585: 0003: \***
 586: 0003: \***    VERSION C.             STUART HIGHLEY              30TH JUNE 1997
 587: 0003: \***    Removed it!!!
 588: 0003: \***
 589: 0003: \******************************************************************************
 590: 0003: *******************************************************************************
 591: 0003: 
 592: 0003:   STRING GLOBAL           \
 593: 0003:     SELFITEM.FILE.NAME$
 594: 0003: 
 595: 0003:   INTEGER*2 GLOBAL        \
 596: 0003:     SELFITEM.REPORT.NUM%, \
 597: 0003:     SELFITEM.SESS.NUM%
 598: 0003: %INCLUDE CBDEC.J86                                                      !2.9NWB
 599: 0003: \/******************************************************************/
 600: 0003: \/*                                                                */
 601: 0003: \/* Carton Buffer FILE GLOBAL VARIABLE DECLARATIONS                */
 602: 0003: \/*                                                                */
 603: 0003: \/* REFERENCE   : CBDEC.J86                                        */
 604: 0003: \/*                                                                */
 605: 0003: \/* VERSION A.          Neil Bennett.           27 DECEMBER 2006   */
 606: 0003: \/*                                                                */
 607: 0003: \/******************************************************************/
 608: 0003: 
 609: 0003:    STRING GLOBAL                \
 610: 0003:       CB.FILE.NAME$,            \
 611: 0003:                                 \
 612: 0003:       CB.RCD$,                  \  ? bytes  (18/17/20/ 8)
 613: 0003:       CB.REC.TYPE$,             \  1 byte   ( C/ H/ D/ T)
 614: 0003:       CB.ITEM.BARCODE$,         \ 13 bytes  (with check digit)
 615: 0003:       CB.CARTON.BARCODE$,       \ 14 bytes (6 bytes supplier ref.)
 616: 0003:                                 \          (8 bytes Carton Number)
 617: 0003:       CB.REPORT.RQD$,           \  1 byte  (Y/N)
 618: 0003:       CB.ITEM.QUANTITY$,        \  4 bytes (1 -  9999)
 619: 0003:       CB.ITEM.COUNT$            !  5 bytes (1 - 99999)
 620: 0003: 
 621: 0003:    INTEGER*2 GLOBAL             \
 622: 0003:       CB.REPORT.NUM%,           \
 623: 0003:       CB.SESS.NUM%              !
 624: 0003: 
 625: 0003: \/******************************************************************/
 626: 0003: 
 627: 0003: \******************************************************************************
 628: 0003: \******************************************************************************
 629: 0003: \***                                                                        ***
 630: 0003: \***   V A R I A B L E   D E C L A R A T I O N S                            ***
 631: 0003: \***                                                                        ***
 632: 0003: \******************************************************************************
 633: 0003: \******************************************************************************
 634: 0003: 
 635: 0003: INTEGER*1                                                               \
 636: 0003:         CURR.SESS.NUM%,                                                 \
 637: 0003:         MATCH.DELIMITER1,                                               \ 2.4JAS
 638: 0003:         MATCH.DELIMITER2,                                               \ 2.4JAS
 639: 0003:         MATCH.DELIMITER3,                                               \ 2.4JAS
 640: 0003:         RES.POS%,                                                       \
 641: 0003:         SB.EVENT.NO%,                                                   \
 642: 0003:         SB.FILE.SESS.NUM%,                                              \
 643: 0003:         STORE.NUMBER.INCORRECT,                                         \ 1.9DA
 644: 0003:         RETURNS.LOGON.VALID                                             ! MMJK
 645: 0003: 
 646: 0003: INTEGER*1 GLOBAL                                                        \
 647: 0003:         STOCKTAKING.ALTERNATIVE.STORE                                   ! 1.9DA
 648: 0003: 
 649: 0003: INTEGER*2                                                               \
 650: 0003:         ADX.FUNCTION%,                                                  \ ILC
 651: 0003:         ADX.PARM.1%,                                                    \ ILC
 652: 0003:         ASN.RCD.CNT%,                                                   \ 2.9NWB
 653: 0003:         CB.MANUAL.COUNT%,                                               \ 2.9NWB
 654: 0003:         CB.RECORD.COUNT%,                                               \ 2.9NWB
 655: 0003:         DATA.LENGTH%,                                                   \
 656: 0003:         INACTIVITY.SHUTDOWN%,                                           \ DSW
 657: 0003:         INDX%,                                                          \ HDS
 658: 0003:         LOG.ON.DISABLE%,                                                \ ILC
 659: 0003:         MAN.REC.CNT%,                                                   \ 2.9NWB
 660: 0003:         MESSAGE.NO%,                                                    \
 661: 0003:         MESSAGE.NUMBER%,                                                \ ILC
 662: 0003:         NUMBER.OF.RECORDS%,                                             \ NMJK
 663: 0003:         POSITION%,                                                      \
 664: 0003:         REP%,                                                           \ DSW
 665: 0003:         SB.FILE.REP.NUM%,                                               \
 666: 0003:         SB.INTEGER%,                                                    \
 667: 0003:         SECTOR.COUNT%,                                                  \
 668: 0003:         TEMP.EVENT%                                                     ! CSW
 669: 0003: 
 670: 0003: INTEGER*4                                                               \
 671: 0003:         ADX.RET.CODE%,                                                  \
 672: 0003: \       CSRWF.EXISTS%,                                                  \ DJAL!2.9NWB
 673: 0003:         I%,                                                             \
 674: 0003:         NOW%,                                                           \ DSW
 675: 0003:         START.TIME%                                                     ! NMJK
 676: 0003: 
 677: 0003: 
 678: 0003: 
 679: 0003: REAL                                                                    \
 680: 0003:         TIME.DIFFERENCE
 681: 0003: 
 682: 0003: STRING                                                                  \
 683: 0003:         ADX.PARM.2$,                                                    \ ILC
 684: 0003:         APPL.STATUS$,                                                   \
 685: 0003:         CB.FN$,                                                         \ 2.9NWB
 686: 0003:         CB.TN$,                                                         \ 2.9NWB
 687: 0003:         CB.OPEN.FLAG$,                                                  \ 2.9NWB
 688: 0003: \       CITEM.RECORD$,                                                  \ DJAL!2.9NWB
 689: 0003: \       CITEM.SECTOR.ALTERED$,                                          \ DJAL!2.9NWB
 690: 0003:         CR$,                                                            \
 691: 0003:         CRLF$,                                                          \
 692: 0003:         CURRENT.KEY$,                                                   \
 693: 0003:         DEVICE$,                                                        \ LLC
 694: 0003: \       END.OF.CITEM$,                                                  \ DJAL!2.9NWB
 695: 0003:         ENQ$,                                                           \
 696: 0003:         FILLER$,                                                        \ DJAL
 697: 0003:         INVOK.OPEN.FLAG$,                                               \ DJAL
 698: 0003:         LAST.SHUTDOWN.DATE$,                                            \ DPAB
 699: 0003:         LF$,                                                            \
 700: 0003:         LOCATION$,                                                      \ DSW
 701: 0003:         LOG.STATE$,                                                     \
 702: 0003:         NAK$,                                                           \
 703: 0003:         NAK.LINE.1$,                                                    \ DSW
 704: 0003:         NAK.LINE.2$,                                                    \ DSW
 705: 0003:         NAK.LINE.3$,                                                    \ DSW
 706: 0003:         PLDT.RECORD$,                                                   \ HDS
 707: 0003:         PIPE.IN$,                                                       \
 708: 0003:         QUIT.FLAG$,                                                     \
 709: 0003:         REJECTION.TYPE$,                                                \ 2.4JAS
 710: 0003:         SB.ACTION$,                                                     \
 711: 0003:         SB.ERRF$,                                                       \
 712: 0003:         SB.ERRL$,                                                       \
 713: 0003:         SB.ERRS$,                                                       \
 714: 0003:         SB.MESSAGE$,                                                    \
 715: 0003:         SB.STRING$,                                                     \
 716: 0003:         SB.UNIQUE$,                                                     \
 717: 0003:         STKTK.OPEN.FLAG$,                                               \ 1.5
 718: 0003:         STORE.CLOSE.FLAG$,                                              \ 2.3JAS
 719: 0003:         SUCCESS.FLAG$,                                                  \ DJAL
 720: 0003:         TEMP.STATE$,                                                    \
 721: 0003:         TIDY.FLAG$,                                                     \
 722: 0003:         UNIQUE.2$                                                       !
 723: 0003: 
 724: 0003: STRING                                                                  \
 725: 0003:         APPL.TABLE$(1),                                                 \ HDS
 726: 0003:         LOGON.TAB$(1)                                                   ! DJAL
 727: 0003: 
 728: 0003: 
 729: 0003: \******************************************************************************
 730: 0003: \******************************************************************************
 731: 0003: \***                                                                        ***
 732: 0003: \***   C O M M O N   D A T A   I N C L U D E                                ***
 733: 0003: \***                                                                        ***
 734: 0003: \******************************************************************************
 735: 0003: \******************************************************************************
 736: 0003: 
 737: 0003: %INCLUDE PSS37G.J86                                                    ! NMJK
 738: 0003: \*****************************************************************************
 739: 0003: \*****************************************************************************
 740: 0003: \***                                                                       ***
 741: 0003: \***      G L O B A L   D E F I N I T I O N S   F O R   P S S 3 7          ***
 742: 0003: \***                                                                       ***
 743: 0003: \***           REFERENCE : PSS37G                                          ***
 744: 0003: \***                                                                       ***
 745: 0003: \***           VERSION E                                                   ***
 746: 0003: \***           5th November 1992                                           ***
 747: 0003: \***           Ver D.  Add support for ADXSERCL routine.                   ***
 748: 0003: \***           Ver E.  Add support for LDTBF                               ***
 749: 0003: \***                                                                       ***
 750: 0003: \***                                                                       ***
 751: 0003: \***           Version G                                                   ***
 752: 0003: \***           Add support for Returns/Automatic credit claiming           ***
 753: 0003: \***                                                                       ***
 754: 0003: \***           Version H  Michael J. Kelsall    24th March 1994.           ***
 755: 0003: \***           Add support for CCUPF                                       ***
 756: 0003: \***
 757: 0003: \***           REVISION 1.1  ROBERT COWEY / STEVE WRIGHT  6TH OCTOBER 1994
 758: 0003: \***           Removed version letters from included code (not commented).
 759: 0003: \***
 760: 0003: \***           REVISION 1.2  David Smallwood    26th May 1995
 761: 0003: \***           Add global variable ALLOW.CSR.PROCESSING.
 762: 0003: \***
 763: 0003: \***           REVISION 1.3  Stuart Highly      April 1996
 764: 0003: \***           Gap monitor changes
 765: 0003: \***
 766: 0003: \***           REVISION 1.4  David Smallwood    21st May 1996
 767: 0003: \***           Change global variable "NUM.OF.UODS%" to
 768: 0003: \***           "NUM.STATUS.O.C.X.UODS%".  Add variables "NUM.OF.CANCELLED.UODS%"
 769: 0003: \***           "NUM.OF.DESPATCHED.UODS%".  Add global variables for CCLAM.
 770: 0003: \***
 771: 0003: \***           REVISION 1.5  Nik Sen            30th June 1997
 772: 0003: \***           Add variables for SXTMP STKTK and STKBUF for stocktaking.
 773: 0003: \***
 774: 0003: \***           REVISION 1.6  David Artiss       23rd January 2001
 775: 0003: \***           Add new audit file STLDT
 776: 0003: \***
 777: 0003: \***           REVISION 1.7  Brian Greenfield   17th October 2002
 778: 0003: \***           Added LSSST and IMSTC for LSS stock counts.
 779: 0003: \***
 780: 0003: \***           REVISION 1.8  David Artiss       7th March 2003
 781: 0003: \***           Lots of file and field definitions added for BOL
 782: 0003: \***           stocktake changes.
 783: 0003: \***
 784: 0003: \***           REVISION 1.9  Brian Greenfield   18th July 2003
 785: 0003: \***           New file additions for Store Stock Counts
 786: 0003: \***
 787: 0003: \***           REVISION 2.0  Julia Stones      22nd October 2003
 788: 0003: \***           New file additions for SmartScript Pharmacy Stock system
 789: 0003: \***
 790: 0003: \***           REVISION 2.1  Julia Stones      12th November 2003
 791: 0003: \***           New file additions for Simplification of the credit claim system
 792: 0003: \***
 793: 0003: \***           REVISION 2.2 Julia Stones       12th March 2004
 794: 0003: \***           New file addition for Credit Claim rejection information
 795: 0003: \***
 796: 0003: \***           REVISION 2.3 Charles Skadorwa   10th November 2004
 797: 0003: \***           Shelf Monitor Project: add declarations for PLLOL & PLLDB files
 798: 0003: \***
 799: 0003: \***           REVISION 2.4 Brian Greenfield   11th January 2005
 800: 0003: \***           Fixes to allow old record type P and new record type P to both work.
 801: 0003: \***           The old record type P can be removed next time this module is
 802: 0003: \***           altered.
 803: 0003: \***
 804: 0003: \***           REVISION 2.5    Neil Bennett    22nd December 2006
 805: 0003: \***           Add ASN processing support.
 806: 0003: \***           Remove CSR processing support.
 807: 0003: \***
 808: 0003: \***           REVISION 2.6    Brian Greenfield 11th may 2007
 809: 0003: \***           Added recalls processing for A7C.
 810: 0003: \***
 811: 0003: \*****************************************************************************
 812: 0003: \*****************************************************************************
 813: 0003: 
 814: 0003: \*****************************************************************************
 815: 0003: \***   include global definitions for the following functions and procedures
 816: 0003: \***
 817: 0003: \***     APPLICATION.LOG              01
 818: 0003: \***     READ.NEXT.IEF                11
 819: 0003: \***     SORT.TABLE                   14
 820: 0003: \***     CONV.TO.HEX                  16
 821: 0003: \***     CONV.TO.STRING               17
 822: 0003: \***     SESS.NUM.UTILITY             20
 823: 0003: \***     CIMF
 824: 0003: \***     CITEM
 825: 0003: \***     CSR
 826: 0003: \***     CSRWF
 827: 0003: \***     CSRBF
 828: 0003: \***     FPF
 829: 0003: \***     IDF
 830: 0003: \***     IDSOF
 831: 0003: \***     INVOK
 832: 0003: \***     ONORD
 833: 0003: \***     PCHK
 834: 0003: \***     PIPEI
 835: 0003: \***     UNITS
 836: 0003: \***     STKMQ
 837: 0003: \***     BCSMF
 838: 0003: \***     IEF
 839: 0003: \***     DIRORD
 840: 0003: \***     DIRSUP
 841: 0003: \***     DIRWF
 842: 0003: \***     DIR
 843: 0003: \***     LDTBF
 844: 0003: \***     LDTCF
 845: 0003: \***     UOD
 846: 0003: \***     UODBF
 847: 0003: \***     UODTF
 848: 0003: \***     STKBF
 849: 0003: \***     SXTMP
 850: 0003: \***     STKTK
 851: 0003: \***     SSPSC
 852: 0003: \***     BTCS
 853: 0003: \***     PRINT
 854: 0003: \***     SOPTS
 855: 0003: \***     TSF
 856: 0003: \***     LOCAL
 857: 0003: \***
 858: 0003: \*****************************************************************************
 859: 0003: 
 860: 0003:  %INCLUDE PSBF01G.J86                     ! FLC
 861: 0003: REM \
 862: 0003: \*******************************************************************************
 863: 0003: \*******************************************************************************
 864: 0003: \***
 865: 0003: \***       %INCLUDE FOR GLOBAL DEFINITIONS FOR FUNCTION APPLICATION.LOG
 866: 0003: \***
 867: 0003: \***                FUNCTION NUMBER    : PSBF01
 868: 0003: \***
 869: 0003: \***                REFERENCE          : PSBF01G.J86
 870: 0003: \***
 871: 0003: \***                DATE OF LAST AMENDMENT  - 27/2/86
 872: 0003: \***
 873: 0003: \***
 874: 0003: \*******************************************************************************
 875: 0003: 
 876: 0003:       INTEGER GLOBAL  F01.RETURN.CODE%
 877: 0003: 
 878: 0003: 
 879: 0003:  %INCLUDE PSBF05G.J86                     ! 1.9BG
 880: 0003: REM\
 881: 0003: \*******************************************************************************
 882: 0003: \*******************************************************************************
 883: 0003: \***
 884: 0003: \***        INCLUDE       : CHECK.BOOTS.CODE globals
 885: 0003: \***
 886: 0003: \***        REFERENCE     : PSBF05G.J86
 887: 0003: \***
 888: 0003: \***        Version A      Bruce Scriver              25th February 1986
 889: 0003: \*** 
 890: 0003: \***        Version B      Andrew Wedgeworth              15th July 1992
 891: 0003: \***        Removal of return code field which no longer required.
 892: 0003: \***
 893: 0003: \*******************************************************************************
 894: 0003: \*******************************************************************************
 895: 0003: 
 896: 0003:       STRING   GLOBAL F05.VALID.CODE$
 897: 0003: 
 898: 0003: 
 899: 0003: !%INCLUDE PSBF06G.J86                     ! FLC
 900: 0003:  %INCLUDE PSBF11G.J86                     ! DLC
 901: 0003: REM \
 902: 0003: \*******************************************************************************
 903: 0003: \*******************************************************************************
 904: 0003: \***
 905: 0003: \***    %INCLUDE FOR GLOBALS DEFINITIONS FOR FUNCTION READ.NEXT.IEF
 906: 0003: \***
 907: 0003: \***            FUNCTION NUMBER    : PSBF11
 908: 0003: \***
 909: 0003: \***            REFERENCE          : PSBF11G.J86
 910: 0003: \***
 911: 0003: \***    Version B            Bruce Scriver             11th December 1986 
 912: 0003: \***
 913: 0003: \***    Version C            Andrew Wedgeworth             15th July 1992
 914: 0003: \***    Redundant return code field removed.
 915: 0003: \***
 916: 0003: \*******************************************************************************
 917: 0003: \*******************************************************************************
 918: 0003: 
 919: 0003:       STRING    GLOBAL  F11.ERROR.FLAG$,                               \ BBAAS
 920: 0003:                         F11.NEXT.BAR.CODE$                             ! BBAAS
 921: 0003: 
 922: 0003:       INTEGER*2 GLOBAL  F11.CURRENT.COUNT%
 923: 0003: 
 924: 0003: 
 925: 0003:  %INCLUDE PSBF14G.J86                     ! DLC
 926: 0003: REM\
 927: 0003: \*******************************************************************************
 928: 0003: \*******************************************************************************
 929: 0003: \***
 930: 0003: \***        INCLUDE       : SORT.TABLE globals
 931: 0003: \***
 932: 0003: \***        REFERENCE     : PSBF14G.J86
 933: 0003: \***
 934: 0003: \***        Version A     Bruce Scriver                3rd March 1986
 935: 0003: \*** 
 936: 0003: \***        Version B     Andrew Wedgeworth            17th July 1992
 937: 0003: \***        Removal of now redundant return code field.
 938: 0003: \***
 939: 0003: \*******************************************************************************
 940: 0003: \*******************************************************************************
 941: 0003: 
 942: 0003:       STRING   GLOBAL F14.TABLE$(1)
 943: 0003: 
 944: 0003: 
 945: 0003:  %INCLUDE PSBF16G.J86                     ! DLC
 946: 0003: REM\
 947: 0003: \*******************************************************************************
 948: 0003: \*******************************************************************************
 949: 0003: \***
 950: 0003: \***           %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.HEX FUNCTION
 951: 0003: \***
 952: 0003: \***                       REFERENCE     : PSBF16G.J86
 953: 0003: \*** 
 954: 0003: \***       Version A           Bruce Scriver            25th February 1986
 955: 0003: \***
 956: 0003: \***       Version B         Andrew Wedgeworth               2nd July 1992
 957: 0003: \***       Removal of now redundant F16.RETURN.CODE%.
 958: 0003: \***
 959: 0003: \*******************************************************************************
 960: 0003: \*******************************************************************************
 961: 0003: 
 962: 0003:       STRING   GLOBAL F16.HEX.STRING$
 963: 0003: 
 964: 0003:       ! 1 line deleted from here                                       ! BAW
 965: 0003:  %INCLUDE PSBF17G.J86                     ! DLC
 966: 0003: REM \
 967: 0003: \*******************************************************************************
 968: 0003: \*******************************************************************************
 969: 0003: \***
 970: 0003: \***
 971: 0003: \***        %INCLUDE GLOBAL DEFINITIONS FOR CONV.TO.STRING FUNCTION
 972: 0003: \***
 973: 0003: \***                    REFERENCE     : PSBF17G.J86
 974: 0003: \***
 975: 0003: \***        Version A         Bruce Scriver      24th February 1986
 976: 0003: \***
 977: 0003: \***        Version B       Andrew Wedgeworth         2nd July 1992
 978: 0003: \***        Removal of now redundant F17.RETURN.CODE%
 979: 0003: \***
 980: 0003: \*******************************************************************************
 981: 0003: \*******************************************************************************
 982: 0003: 
 983: 0003:       STRING   GLOBAL F17.RETURNED.STRING$
 984: 0003: 
 985: 0003:       ! 1 line deleted from here                                       ! BAW
 986: 0003: 
 987: 0003:  %INCLUDE PSBF18G.J86                     ! 1.8DA
 988: 0003: REM\
 989: 0003: \*******************************************************************************
 990: 0003: \*******************************************************************************
 991: 0003: \***
 992: 0003: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT globals
 993: 0003: \***
 994: 0003: \***        REFERENCE     : PSBF18G.J86
 995: 0003: \***
 996: 0003: \***        Version A     Stephen Kelsey                  23rd March 1987
 997: 0003: \***
 998: 0003: \***        Version B     Andrew Wedgeworth                 7th July 1992
 999: 0003: \***        Removal of return code field which no longer required.
1000: 0003: \***
1001: 0003: \*******************************************************************************
1002: 0003: \*******************************************************************************
1003: 0003: 
1004: 0003:       STRING   GLOBAL F18.CHECK.DIGIT$
1005: 0003:     
1006: 0003:       ! 1 line deleted from here                                       ! BAW    
1007: 0003: 
1008: 0003:  %INCLUDE PSBF20G.J86                     ! DLC
1009: 0003: REM\
1010: 0003: \*******************************************************************************
1011: 0003: \*******************************************************************************
1012: 0003: \***
1013: 0003: \***     %INCLUDE GLOBAL VARIABLE DEFINITIONS FOR SESS.NUM.UTILITY FUNCTION
1014: 0003: \***
1015: 0003: \***                       REFERENCE     : PSBF20G.J86
1016: 0003: \*** 
1017: 0003: \***     Version A              Bruce Scrive                   5th May 1988   
1018: 0003: \*** 
1019: 0003: \***     Version B              Robert Cowey                   7th May 1991
1020: 0003: \***     Global variable F20.INTEGER.FILE.NO% changed from one byte integer
1021: 0003: \***     to two byte integer.
1022: 0003: \***
1023: 0003: \***     Version D              Andrew Wedgeworth             1st July 1992
1024: 0003: \***     F20.RETURN.CODE% removed as it is no longer required.
1025: 0003: \***
1026: 0003: \*******************************************************************************
1027: 0003: \*******************************************************************************
1028: 0003: 
1029: 0003:       STRING    GLOBAL F20.FILE.NAME$,                                 \
1030: 0003:                        F20.STRING.FILE.NO$,                            \
1031: 0003:                        F20.TABLE.DIMENSIONED.FLAG$,                    \
1032: 0003:                        SESS.NUM.TABLE$(1)
1033: 0003: 
1034: 0003:       INTEGER*2 GLOBAL F20.INTEGER.FILE.NO%
1035: 0003: 
1036: 0003:       ! 1 line deleted from here                                       ! DAW 
1037: 0003: 
1038: 0003:  %INCLUDE PSBF21G.J86                     ! 1.9BG
1039: 0003: REM\
1040: 0003: \*******************************************************************************
1041: 0003: \*******************************************************************************
1042: 0003: \***
1043: 0003: \***        INCLUDE       : CHECK.BAR.CODE globals
1044: 0003: \***
1045: 0003: \***        REFERENCE     : PSBF21G.J86
1046: 0003: \***
1047: 0003: \***        Version A     Bruce Scriver                  13th May 1988
1048: 0003: \***
1049: 0003: \***        Version B     Andrew Wedgeworth             21st July 1992
1050: 0003: \***        Return code removed as no longer used.
1051: 0003: \***
1052: 0003: \*******************************************************************************
1053: 0003: \*******************************************************************************
1054: 0003: 
1055: 0003:       STRING    GLOBAL F21.VALID.CODE.FLAG$
1056: 0003: 
1057: 0003: 
1058: 0003: 
1059: 0003: !%INCLUDE ASYNCNUB.J86                    ! FLC
1060: 0003:  %INCLUDE CHKBFDEC.J86                    ! DLC
1061: 0003: \******************************************************************************
1062: 0003: \***
1063: 0003: \***           %INCLUDE FOR CHKBF - PRICE CHECK BUFFER FILE
1064: 0003: \***
1065: 0003: \***                    - FIELD DECLARATIONS   
1066: 0003: \***                    - FILE REFERENCE PARAMETERS  
1067: 0003: \***  
1068: 0003: \***                    REFERENCE: CHKBFDEC.J86
1069: 0003: \***
1070: 0003: \******************************************************************************
1071: 0003: 
1072: 0003:    INTEGER*1 GLOBAL				\
1073: 0003: 	CHKBF.SESS.NUM%
1074: 0003: 
1075: 0003:    INTEGER*2 GLOBAL				\
1076: 0003: 	CHKBF.RECL%,                            \
1077: 0003:         CHKBF.REPORT.NUM% 	
1078: 0003: 
1079: 0003:    INTEGER*4 GLOBAL				\ DLC
1080: 0003:         CHKBF.POINTER%
1081: 0003: 	
1082: 0003:    STRING GLOBAL			\
1083: 0003: 	CHKBF.ITEM.CODE$,	\ 13 byte ASC - bar code, as passed from PDT
1084: 0003: 	CHKBF.PRICE$,		\  6 byte ASC - price, as passed from PDT 
1085: 0003: 	CHKBF.FILLER$,		\  1 byte ASC - spare
1086: 0003: 	CHKBF.FILE.NAME$
1087: 0003:  %INCLUDE GAPBFDEC.J86                    ! SDH !2.3CS !2.4BG
1088: 0003: \*****************************************************************************
1089: 0003: \***                                                                         *
1090: 0003: \***           %INCLUDE FOR GAPBF - GAP BUFFER FILE                          *
1091: 0003: \***                                                                         *
1092: 0003: \***                    - FIELD DECLARATIONS                                 *
1093: 0003: \***                    - FILE REFERENCE PARAMETERS                          *
1094: 0003: \***                                                                         *
1095: 0003: \***                    REFERENCE: GAPBFDEC.J86                              *
1096: 0003: \***                                                                         *
1097: 0003: \*****************************************************************************
1098: 0003: 
1099: 0003:    INTEGER*1 GLOBAL            \
1100: 0003:    GAPBF.SESS.NUM%
1101: 0003: 
1102: 0003:    INTEGER*2 GLOBAL            \   
1103: 0003:    GAPBF.REPORT.NUM%    
1104: 0003: 
1105: 0003:    STRING GLOBAL               \
1106: 0003:    GAPBF.BOOTS.CODE$,          \ 7 bytes ASC - Item code
1107: 0003:    GAPBF.FILE.NAME$
1108: 0003:  %INCLUDE PLLOLDEC.J86                    ! 2.3CS
1109: 0003: 
1110: 0003: \******************************************************************************
1111: 0003: \******************************************************************************
1112: 0003: \***
1113: 0003: \***         %INCLUDE FOR RF PICKING LIST OF LISTS FILE FIELD DECLARATIONS
1114: 0003: \***
1115: 0003: \***               FILE TYPE    : DIRECT
1116: 0003: \***
1117: 0003: \***               REFERENCE    : PLLOLDEC.J86
1118: 0003: \***
1119: 0003: \***    VERSION A.           Julia Stones.               11 August 2004
1120: 0003: \***               New file for RF system. Holds list of picking lists.
1121: 0003: \***
1122: 0003: \***    VERSION B            Mark Goode                  17th January 2005
1123: 0003: \***    Additional field required to state the lists status ('S' - Shelf Monitor
1124: 0003: \***    'F' - Fast Fill, 'O' - OSSR or 'E' - excess stock.
1125: 0003: \*******************************************************************************
1126: 0003: \*******************************************************************************
1127: 0003: 
1128: 0003: STRING GLOBAL                                                  \
1129: 0003:    PLLOL.FILE.NAME$,           \
1130: 0003:    PLLOL.LISTID$,              \ 3 bytes unpacked list ID
1131: 0003:    PLLOL.CREATOR.ID$,          \ 3 bytes unpacked Creator user ID
1132: 0003:    PLLOL.PICKER.ID$,           \ 3 bytes unpacked Picker user ID
1133: 0003:    PLLOL.ITEM.STATUS$,         \ 1 byte item status " "
1134: 0003:                                \                    "P" = Picked
1135: 0003:                                \                    "U" = Unpicked
1136: 0003:                                \                    "A" = List is active (someone is picking it)
1137: 0003:                                \                    "X" = List is cancelled
1138: 0003:    PLLOL.CREATE.DATE$,         \ 6 bytes unpacked create date YYMMDD
1139: 0003:    PLLOL.CREATE.TIME$,         \ 4 bytes unpacked create time HH:MM
1140: 0003:    PLLOL.PICK.START.TIME$,     \ 4 bytes unpacked pick start time HH:MM
1141: 0003:    PLLOL.PICK.END.TIME$,       \ 4 bytes unpacked pick end time HH:MM
1142: 0003:    PLLOL.ITEM.COUNT$,          \ 4 bytes unpacked item count (max number of items in list
1143: 0003:                                \                              duplicates will cobine to 1 record
1144: 0003:                                \                              on the PLLDB file)
1145: 0003:    PLLOL.OSSR.PICKING$,        \ 1 byte Marked for OSSR picking "Y" = marked for OSSR picking
1146: 0003:                                \                                "N" = not marked for OSSR picking
1147: 0003:    PLLOL.OSSR.STATUS$          ! 1 byte mark the status of the list.         ! BMG         
1148: 0003: 
1149: 0003: 
1150: 0003: INTEGER*4 GLOBAL               \
1151: 0003:        PLLOL.RECORD.NUM%
1152: 0003: 
1153: 0003: INTEGER*2 GLOBAL                \
1154: 0003:    PLLOL.REPORT.NUM%,           \
1155: 0003:    PLLOL.SESS.NUM%
1156: 0003: 
1157: 0003: 
1158: 0003: INTEGER*1 GLOBAL                \
1159: 0003:    PLLOL.RECL%
1160: 0003: 
1161: 0003: 
1162: 0003:  %INCLUDE PLLDBDEC.J86                    ! 2.3CS
1163: 0003: 
1164: 0003: \******************************************************************************
1165: 0003: \******************************************************************************
1166: 0003: \***
1167: 0003: \***         %INCLUDE FOR RF PICKING LIST ITEMS IN LISTS FILE FIELD DECLARATIONS
1168: 0003: \***
1169: 0003: \***               FILE TYPE    : KEYED
1170: 0003: \***
1171: 0003: \***               REFERENCE    : PLLDBDEC.J86
1172: 0003: \***
1173: 0003: \***    VERSION A.              Julia Stones.                   11th August 2004
1174: 0003: \***    New file for RF system. Holds picking list items in lists information.
1175: 0003: \***
1176: 0003: \***    VERSION B.              Mark Goode                     17th january 2005
1177: 0003: \***    Changes for OSSR WAN
1178: 0003: \***
1179: 0003: \***    VERSION C.              Charlies Skadorwa
1180: 0003: \***    Add Stock fig to filler space for PST47
1181: 0003: \***
1182: 0003: \***    VERSION D.              Mark Goode                      29th August 2008
1183: 0003: \***    Add new fields for Multi-site project
1184: 0003: \***
1185: 0003: \***    VERSION E.              Wasim Abdulkalam              11th November 2011
1186: 0003: \***    Added new fields for backshop and OSSR pending sales plan for Stock
1187: 0003: \***    file accuracy project
1188: 0003: \*******************************************************************************
1189: 0003: \*******************************************************************************
1190: 0003: 
1191: 0003: STRING GLOBAL                          \
1192: 0003:        PLLDB.FILE.NAME$,               \
1193: 0003:        PLLDB.KEY$,                     \ 6 bytes unpacked LISTID + ITEMSEQ
1194: 0003:        PLLDB.LISTID$,                  \ 3 bytes unpacked List Number
1195: 0003:        PLLDB.ITEMSEQ$,                 \ 3 bytes unpacked Item Sequence Number
1196: 0003:        PLLDB.BOOTSCODE$,               \ 4 bytes packed Boots item code including check digit
1197: 0003:        PLLDB.QTY.ONSHELF$,             \ 4 bytes unpacked Quantity on shelf
1198: 0003:        PLLDB.FILL.QTY$,                \ 4 bytes unpacked Fill quantity
1199: 0003:        PLLDB.GAPFILL.MRK$,             \ 1 byte ASC Gap/Fill marker "Y" = Gap created from Shelf monitor
1200: 0003:                                        \                            "N" = Fast Fill no TSF update
1201: 0003:        PLLDB.ITEM.STATUS$,             \ 1 byte ASC Item Status "U" = Unpicked, "P" = picked
1202: 0003:        PLLDB.STOCKROOM.CNT$,           \ 4 bytes unpacked Stock Room Count
1203: 0003:        PLLDB.SHELFMON.SALE.FIG$,       \ 4 bytes unpacked Sales figure at Shelf Monitoring
1204: 0003:        PLLDB.OSSR.FLAG$,               \ 1 bytes item OSSR flag   ! BMG
1205: 0003:      \!PLLDB.FILLER$,                  \ 7 byte filler            ! BMG !EWA
1206: 0003:        PLLDB.CNT.PENDSALES.BACKSHOP$,  \ 2 bytes packed backshop pending sales plan count      ! EWA
1207: 0003:        PLLDB.TIME.PENDSALES.BACKSHOP$, \ 2 bytes packed backshop pending sales plan count time ! EWA
1208: 0003:        PLLDB.CNT.PENDSALES.OSSR$,      \ 2 bytes packed OSSR pending sales plan count          ! EWA
1209: 0003:        PLLDB.TIME.PENDSALES.OSSR$,     \ 2 bytes packed OSSR pending sales plan count time     ! EWA
1210: 0003:        PLLDB.STKFIG.STOCKROOM$,        \ 4 bytes unpacked Sales figure at Shelf Monitoring
1211: 0003:                                        \ progam submitted for pint out
1212: 0003:        PLLDB.OSSR.CNT$,                \ 4 bytes unpacked OSSR item stock count figure
1213: 0003:        PLLDB.TIME.SHELFMON$,           \ 2 bytes packed Time of stock floor count hh:mm
1214: 0003:        PLLDB.TIME.BACKSHOP$,           \ 2 bytes packed Time of back shop count hh:mm
1215: 0003:        PLLDB.TIME.OSSR$,               \ 2 bytes packed Time of OSSR count hh:mm
1216: 0003:        PLLDB.BACKSHOP.SALE$,           \ 4 bytes unpacked Sale at time of backshop count
1217: 0003:        PLLDB.OSSR.SALE$,               \ 4 bytes unpacked Sale at time of OSSR count
1218: 0003:        PLLDB.MS.TABLE$,                \                                           ! DMG
1219: 0003:        PLLDB.MS.LOCATION.CNT$(1),      \ 2 byte packed multi-site location count   ! DMG
1220: 0003:        PLLDB.MS.SALES.FIG$(1),         \ 2 byte packed multi-site sales figure     ! DMG                                             ! CMG
1221: 0003:        PLLDB.MS.TIME.CNT$(1),          \ 2 byte packed multi-site time of count    ! DMG                                             ! CMG
1222: 0003:        PLLDB.MS.FILL.QTY$(1),          \ 2 byte packed multi-site fill quantity    ! DMG                                                        ! CMG
1223: 0003:        PLLDB.FILLER2$(1)               ! 2 byte filler                             ! DMG
1224: 0003: 
1225: 0003: INTEGER*2 GLOBAL                       \
1226: 0003:    PLLDB.REPORT.NUM%,                  \
1227: 0003:    PLLDB.SESS.NUM%
1228: 0003: 
1229: 0003: INTEGER*2 GLOBAL                       \
1230: 0003:    PLLDB.RECL%
1231: 0003: 
1232: 0003: 
1233: 0003: 
1234: 0003: \%INCLUDE CIMFDEC.J86                     ! DLC !2.5NWB
1235: 0003: \%INCLUDE CITEMDEC.J86                    ! DLC !2.5NWB
1236: 0003: \%INCLUDE CSRDEC.J86                      ! DLC !2.5NWB
1237: 0003: \%INCLUDE CSRWFDEC.J86                    ! DLC !2.5NWB
1238: 0003: \%INCLUDE CSRBFDEC.J86                    ! DLC !2.5NWB
1239: 0003: !%INCLUDE EPSOMDEC.J86                    ! FLC TEST
1240: 0003:  %INCLUDE FPFDEC.J86                      ! DLC
1241: 0003:  REM \
1242: 0003: \******************************************************************************
1243: 0003: \******************************************************************************
1244: 0003: \***
1245: 0003: \***         %INCLUDE FOR FLASHPACK / PARENT FILE FIELD DECLARATIONS
1246: 0003: \***
1247: 0003: \***               FILE TYPE    : Keyed
1248: 0003: \***
1249: 0003: \***               REFERENCE    : FPFDEC.J86
1250: 0003: \***
1251: 0003: \***         VERSION A : LES COOK  - 21/8/92
1252: 0003: \***
1253: 0003: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
1254: 0003: \***    No changes to this file.
1255: 0003: \***
1256: 0003: \***    VERSION C.              CLIVE NORRIS.                       17 JAN 1994.
1257: 0003: \***    No changes to this file. Version updated to keep in line 
1258: 0003: \***    with changes in FPFFUNC.BAS.
1259: 0003: \***
1260: 0003: \*******************************************************************************
1261: 0003: \*******************************************************************************
1262: 0003: 
1263: 0003:   STRING GLOBAL                  \
1264: 0003:     FPF.FILE.NAME$,              \
1265: 0003:     FPF.PARENT.CODE$,            \ 4 byte UPD with a check digit
1266: 0003:     FPF.CODE$(1),                \ 4 bytes upd first flashpack code of 10                 ! Boots code with a check digit 
1267: 0003:                                  \ (99999999 if no code) 
1268: 0003:     FPF.MULT.FACTOR$(1)          \ 2 bytes UPD multiplication factor for
1269: 0003:                   		 ! first flashpack code.
1270: 0003: 
1271: 0003:   INTEGER*2 GLOBAL        \
1272: 0003:     FPF.RECL%,            \
1273: 0003:     FPF.REPORT.NUM%,      \
1274: 0003:     FPF.SESS.NUM%,        \
1275: 0003:     MAX.FPF.CODES%
1276: 0003: 
1277: 0003:  %INCLUDE IDFDEC.J86                      ! FLC
1278: 0003: REM \
1279: 0003: \******************************************************************************
1280: 0003: \******************************************************************************
1281: 0003: \***
1282: 0003: \***         %INCLUDE FOR ITEM DATA FILE - FIELD DECLARATIONS
1283: 0003: \***                                       FILE REFERENCE PARAMETERS
1284: 0003: \***
1285: 0003: \***                  FILE TYPE    : Keyed
1286: 0003: \***
1287: 0003: \***                  REFERENCE    : IDFDEC.J86
1288: 0003: \***
1289: 0003: \***         VERSION A : Andrew Wedgeworth  29th June 1992    
1290: 0003: \***
1291: 0003: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
1292: 0003: \***    Replaced un-used RANK$ with BSNS.CNTR$ and FILLER$.
1293: 0003: \***
1294: 0003: \***    VERSION D.              Andrew Wedgeworth               15th March 1995
1295: 0003: \***    Comments updated to reflect the fact that some bits on the file are
1296: 0003: \***    no longer used.
1297: 0003: \***
1298: 0003: \*******************************************************************************
1299: 0003: \*******************************************************************************
1300: 0003: 
1301: 0003:   STRING GLOBAL           \
1302: 0003:     IDF.FILE.NAME$,       \  
1303: 0003:     IDF.BOOTS.CODE$,      \ 4 byte UPD with check digit (key)
1304: 0003:     IDF.FIRST.BAR.CODE$,  \ 6 byte UPD without check digit
1305: 0003:     IDF.SECOND.BAR.CODE$, \ 6 byte UPD without check digit
1306: 0003:     IDF.NO.OF.BAR.CODES$, \ 2 byte UPD. Total number of bar codes for this item
1307: 0003:     IDF.PRODUCT.GRP$,     \ 3 byte UPD. The first two digits are the concept
1308: 0003:                           \ group and the last four the concept sequence
1309: 0003:     IDF.STNDRD.DESC$,     \ 24 bytes
1310: 0003:     IDF.STATUS.1$,        \ 1 byte, values B,C,D,P,X,Z and blank
1311: 0003:     IDF.INTRO.DATE$,      \ 3 byte UPD YYMMDD. Date first added to this file
1312: 0003:     IDF.BSNS.CNTR$,       \ 1 byte ASC. Business Centre ID letter      ! CRC
1313: 0003:     IDF.FILLER$,          \ 1 byte un-used                             ! CRC
1314: 0003:     IDF.PARENT.CODE$,     \ 4 byte UPD with check digit ; may be zero if no
1315: 0003:                           \ flashpacks, current IDF.BOOTS.CODE$ if parent line
1316: 0003:                           \ or Boots Code of parent line if a flashpack.
1317: 0003:     IDF.DATE.OF.LAST.SALE$! 3 byte UPD. Date of last sale.
1318: 0003: 
1319: 0003:   INTEGER*1 GLOBAL        \
1320: 0003:     IDF.BIT.FLAGS.1%,     \ 1 byte - bit values
1321: 0003:                           \ X"80"  - Group code flag
1322: 0003:                           \ X"40"  - Keylines flag
1323: 0003:                           \ X"20"  - Markdown flag
1324: 0003:                           \ X"10"  - Warehouse flag
1325: 0003:                           \ X"08"  - CSR flag
1326: 0003:                           \ X"04"  - Directs A flag
1327: 0003:                           \ X"02"  - Directs B flag
1328: 0003:                           \ X"01"  - Directs C flag
1329: 0003:     IDF.BIT.FLAGS.2%      \ 1 byte - bit values
1330: 0003:                           \ X"80"  - Own brand line flag
1331: 0003:                           \ X"40"  - Exclusive line flag
1332: 0003:                           \ X"20"  - Unused 
1333: 0003:                           \ X"10"  - Unused
1334: 0003:                           \ X"08"  - Stock system flag
1335: 0003:                           \ X"04"  - Pending count flag
1336: 0003:                           \ X"02"  - Reserved
1337: 0003:                           ! X"01"  - Reserved
1338: 0003: 
1339: 0003:   INTEGER*2 GLOBAL        \
1340: 0003:     IDF.RECL%,            \  
1341: 0003:     IDF.REPORT.NUM%,      \ 
1342: 0003:     IDF.SESS.NUM%
1343: 0003:  %INCLUDE INVOKDEC.J86                    ! FLC
1344: 0003: \******************************************************************************
1345: 0003: \******************************************************************************
1346: 0003: \***
1347: 0003: \***   $Workfile:   INVOKDEC.J86  $
1348: 0003: \***
1349: 0003: \***   $Revision:   1.4  $
1350: 0003: \***
1351: 0003: \******************************************************************************
1352: 0003: \******************************************************************************
1353: 0003: \***
1354: 0003: \***   $Log:   V:\archive\j86\invokdec.j8v  $
1355: 0003: \***   
1356: 0003: \***      Rev 1.4   10 Feb 1998 14:11:36   DEV45PS
1357: 0003: \***   Added RP Delivery Days field
1358: 0003: \***   
1359: 0003: \***      Rev 1.3   09 Apr 1997 09:22:06   DEVAWPS
1360: 0003: \***   Added date of successful processing of Points
1361: 0003: \***   Events details.
1362: 0003: \***   
1363: 0003: \***      Rev 1.2   20 Dec 1994 11:02:52   DEVMJPS
1364: 0003: \***   CSR/2 Amendments - new fields added are 
1365: 0003: \***   PSC14 flag and Conversion Status flag 
1366: 0003: \***   
1367: 0003: \******************************************************************************
1368: 0003: \******************************************************************************
1369: 0003: REM \
1370: 0003: \******************************************************************************
1371: 0003: \******************************************************************************
1372: 0003: \***
1373: 0003: \***    FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS FOR INVCE OK FILE 
1374: 0003: \***
1375: 0003: \***                     REFERENCE   : INVOKDEC.J86
1376: 0003: \***
1377: 0003: \***    Version A            Andrew Wedgeworth              3rd August 1992
1378: 0003: \***    
1379: 0003: \***    Version B            Stephen Kelsey                 12th October 1992
1380: 0003: \***    Include Direct Implementation Flag, PSC30 flag and date.
1381: 0003: \***
1382: 0003: \***    Version C            Les Cook                       15th February 1993
1383: 0003: \***    Include UOD Implementation Flag, UOD Booked in date, Previous serial
1384: 0003: \***    number and success flag.
1385: 0003: \***
1386: 0003: \***    Version D            David Smallwood                20th July 1994   
1387: 0003: \***    Include CSR PHASE1 transmission flag and CSR start method flag.
1388: 0003: \***    
1389: 0003: \***    Version E            Mick Bayliss                   19th Oct. 1994
1390: 0003: \***    New fields for CSR Phase 2 - PSC14 Flag and Conversion Status Flag.
1391: 0003: \***
1392: 0003: \***    Version F            Andrew Wedgeworth              27th March 1997
1393: 0003: \***    Added date of successful processing of Points Events details sent from 
1394: 0003: \***    the mainframe.
1395: 0003: \***
1396: 0003: \***    Version G            Nik Sen                        10th February 1998
1397: 0003: \***    Added parameter used by MINSITS RP to determine number of days to 
1398: 0003: \***    check for late delivery.
1399: 0003: \***
1400: 0003: \******************************************************************************
1401: 0003: \******************************************************************************
1402: 0003: 
1403: 0003: 
1404: 0003: \******************************************************************************
1405: 0003: \***
1406: 0003: \***   FILE REFERENCE PARAMETERS
1407: 0003: \***
1408: 0003: \******************************************************************************
1409: 0003: 
1410: 0003:   STRING GLOBAL           \
1411: 0003:     INVOK.FILE.NAME$
1412: 0003: 
1413: 0003:   INTEGER*2 GLOBAL        \
1414: 0003:     INVOK.SESS.NUM%,      \
1415: 0003:     INVOK.REPORT.NUM%
1416: 0003: 
1417: 0003: 
1418: 0003: \******************************************************************************
1419: 0003: \***
1420: 0003: \***   FIELD DECLARATIONS
1421: 0003: \***
1422: 0003: \******************************************************************************
1423: 0003: 
1424: 0003:   STRING GLOBAL                \
1425: 0003:     INVOK.SERIAL.NO$,          \ 5 bytes ASCII
1426: 0003:     INVOK.DATE$,               \ 3 bytes YYMMDD UPD
1427: 0003:     INVOK.SUCCESS.FLAG$,       \ 1 bytes ASCII
1428: 0003:     INVOK.STORE.NO$,           \ 4 bytes ASCII with leading zeroes
1429: 0003:     INVOK.INVENTORY.SRLNO$,    \ 5 bytes ASCII leading zeros
1430: 0003:     INVOK.INVENTORY.SUCCESS$,  \ 1 bytes ASCII 0=failed/1=success
1431: 0003:     INVOK.SALES.SRLNO$,        \ 5 bytes ASCII leading zeros
1432: 0003:     INVOK.SALES.SUCCESS$,      \ 1 bytes ASCII 0=failed/1=success
1433: 0003:     INVOK.NEW.LIST.SRLNO$,     \ 5 bytes ASCII
1434: 0003:     INVOK.NEW.LIST.SUCCESS$,   \ 1 bytes ASCII 0=failed/1=success
1435: 0003:     INVOK.CSR.DELIVERY.NO$,    \ 5 bytes ASCII				
1436: 0003:     INVOK.CSR.IDENT$,          \ 1 bytes ASCII value "Y" 		
1437: 0003:     INVOK.CSR.DELIVERY.DATE$,  \ 6 bytes ASCII YYMMDD			
1438: 0003:     INVOK.CSR.PSC11.FLAG$,     \ 1 bytes ASCII				
1439: 0003:     INVOK.CSR.PSC12.FLAG$,     \ 1 bytes ASCII				
1440: 0003:     INVOK.CSR.PSC13.FLAG$,     \ 1 bytes ASCII				
1441: 0003:     INVOK.CSR.PSC12.DAYS$,     \ 1 bytes UPD				
1442: 0003:     INVOK.PSS33.RUN.DATE$,     \ 3 bytes YYMMDD UPD                     
1443: 0003:     INVOK.PSS33.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success       
1444: 0003:     INVOK.DIR.IMPL.FLAG$,      \ 1 byte ASCII  1=phase 1 implemented   BSPK   
1445: 0003:                                \           blank=not yet implemented   BSPK 
1446: 0003:     INVOK.PSC30.RUN.DATE$,     \ 3 bytes YYMMDD UPD                    BSPK                     
1447: 0003:     INVOK.PSC30.SUCCESS.FLAG$, \ 1 bytes ASCII 0=failed/1=success      BSPK
1448: 0003:     INVOK.UOD.IMPL.FLAG$,      \ 1 byte ASCII 1=implemented            CLC
1449: 0003:     INVOK.LAST.UOD.DATE$,      \ 3 bytes UPD                           CLC
1450: 0003:     INVOK.PREV.SERIAL.NO$,     \ 5 bytes ASCII                         CLC
1451: 0003:     INVOK.PREV.SUCCESS.FLAG$,  \ 1 byte ASCII                          CLC
1452: 0003:     INVOK.SUPPRESS.EXCEP.REPORT$,     \ 1 byte ASCII Y/N               DDS
1453: 0003:     INVOK.CSR.STARTED.BY.SUP$,        \ 1 byte ASCII Y/N               DDS
1454: 0003:     INVOK.CSR.PSC14.FLAG$,            \ 1 byte ASCII S/E/X/Y           EMJB
1455: 0003:     INVOK.CSR.CONVERSION.STATUS.FLAG$,\ 1 byte ASCII P/S/X/C           EMJB
1456: 0003:     INVOK.PTS.EVENTS.OK.DATE$, \ 3 bytes UPD                           FAW
1457: 0003:     INVOK.RP.DAYS$,            \ 1 byte ASCII                          GNS
1458: 0003:     INVOK.FILLER$              ! 6 bytes spaces                        GNS
1459: 0003: 
1460: 0003:   INTEGER*2 GLOBAL        \
1461: 0003:     INVOK.RECL%
1462: 0003:  %INCLUDE ONORDDEC.J86                    ! DLC
1463: 0003: \******************************************************************************
1464: 0003: \******************************************************************************
1465: 0003: \***
1466: 0003: \***         %INCLUDE FOR CSR ON ORDER FILE - FIELD DECLARATIONS
1467: 0003: \***                                          FILE REFERENCE PARAMETERS
1468: 0003: \***
1469: 0003: \***               FILE TYPE    : Keyed     
1470: 0003: \***
1471: 0003: \***               REFERENCE    : ONORDDEC.J86
1472: 0003: \***
1473: 0003: \***               DATE OF LAST AMENDMENT -  09/10/92
1474: 0003: \***
1475: 0003: \******************************************************************************
1476: 0003: \*******************************************************************************
1477: 0003: 
1478: 0003:   STRING GLOBAL                  \
1479: 0003:     ONORD.FILE.NAME$,		 \
1480: 0003:     ONORD.KEY$,                  \ 12byte ASC
1481: 0003:     ONORD.ORDER.DATE$,           \ 6 byte ASC
1482: 0003:     ONORD.LIST.FREQ$,            \ 1 byte ASC
1483: 0003:     ONORD.UNIT.NO$,              \ 2 byte ASC 
1484: 0003:     ONORD.SEQ.NO$,               \ 3 byte ASC 
1485: 0003:     ONORD.HIGHEST.SEQ.NO$,       \ 3 byte ASC 
1486: 0003:     ONORD.FILLER$,               \
1487: 0003:     ONORD.ITEM.CODE$,            \ 7 byte ASC 
1488: 0003:     ONORD.QTY.1$,                \ 3 byte ASC
1489: 0003:     ONORD.QTY.2$,                \ 3 byte ASC 
1490: 0003:     ONORD.CSRITEM.UNDONE.FLAG$,  \ 1 byte ASC "Y" or "N"
1491: 0003:     ONORD.CSRIMF.UNDONE.FLAG$,   \ 1 byte ASC "Y" or "N" 
1492: 0003:     ONORD.DELETED.FLAG$          ! 1 byte ASC "Y" or "N" 
1493: 0003:     
1494: 0003:   INTEGER*2 GLOBAL		 \
1495: 0003:     ONORD.REPORT.NUM%,		 \
1496: 0003:     ONORD.RECL%,		 \
1497: 0003:     ONORD.SESS.NUM%  
1498: 0003:     
1499: 0003:  %INCLUDE PCHKDEC.J86                     ! DLC
1500: 0003: \******************************************************************************
1501: 0003: \******************************************************************************
1502: 0003: \***
1503: 0003: \***         %INCLUDE FOR PRICE CHECK FILE - FILE REFERENCE PARAMETERS
1504: 0003: \***
1505: 0003: \***               REFERENCE    : PCHKDEC.J86
1506: 0003: \***
1507: 0003: \******************************************************************************
1508: 0003: \*******************************************************************************
1509: 0003: 
1510: 0003:   STRING GLOBAL           \
1511: 0003:     PCHK.FILE.NAME$
1512: 0003: 
1513: 0003:   INTEGER*2 GLOBAL        \
1514: 0003:     PCHK.REPORT.NUM%,      \
1515: 0003:     PCHK.SESS.NUM%
1516: 0003:  %INCLUDE PIPEINUB.J86                    ! DLC
1517: 0003: 
1518: 0003: \******************************************************************************
1519: 0003: \******************************************************************************
1520: 0003: \***
1521: 0003: \***                   %INCLUDE FOR PSS38 INPUT PIPE
1522: 0003: \***
1523: 0003: \***                         LINK TYPE : PIPEI
1524: 0003: \***
1525: 0003: \***                     REFERENCE : PIPEINUM.J86
1526: 0003: \***
1527: 0003: \******************************************************************************
1528: 0003: \******************************************************************************
1529: 0003: 
1530: 0003:    STRING GLOBAL							\
1531: 0003: 	PIPEI.FILE.NAME$
1532: 0003: 	
1533: 0003:    INTEGER*1 GLOBAL							\
1534: 0003: 	PIPEI.REPORT.NUM%,						\
1535: 0003: 	PIPEI.SESS.NUM%
1536: 0003: !%INCLUDE PIPEONUB.J86                    ! FLC TEST
1537: 0003:  %INCLUDE UNITSDEC.J86                    ! DLC
1538: 0003: \******************************************************************************
1539: 0003: \******************************************************************************
1540: 0003: \***
1541: 0003: \***         %INCLUDE FOR UNITS - FILE REFERENCE PAREMETERS
1542: 0003: \***                              FIELD DECLARATIONS
1543: 0003: \***
1544: 0003: \***               REFERENCE    : UNITSDEC.J86
1545: 0003: \***
1546: 0003: \***
1547: 0003: \******************************************************************************
1548: 0003: \******************************************************************************
1549: 0003: 
1550: 0003:   STRING GLOBAL           \
1551: 0003:     UNITS.UNIT$,          \ 1  byte UPD (key)
1552: 0003:     UNITS.UNIT.NAME$,     \ 27 bytes ASCII
1553: 0003:     UNITS.BC.LETTER$,     \ 1  byte  ASCII
1554: 0003:     UNITS.FILLER$,        \ 6  bytes ASCII (spaces).
1555: 0003:     UNITS.FILE.NAME$
1556: 0003: 
1557: 0003:   INTEGER*2 GLOBAL        \
1558: 0003:     UNITS.REPORT.NUM%,    \ 
1559: 0003:     UNITS.RECL%,          \ 
1560: 0003:     UNITS.SESS.NUM%
1561: 0003:  %INCLUDE STKMQDEC.J86                    ! MMJK
1562: 0003: REM \
1563: 0003: \******************************************************************************
1564: 0003: \******************************************************************************
1565: 0003: \***
1566: 0003: \***      %INCLUDE FOR STOCK MOVEMENT QUEUE FILE FIELD DECLARATIONS
1567: 0003: \***                                             FILE REFERENCE PARAMETERS
1568: 0003: \***
1569: 0003: \***               FILE TYPE    : Sequential
1570: 0003: \***
1571: 0003: \***               REFERENCE    : STKMQDEC.J86
1572: 0003: \***
1573: 0003: \***      Version A.     L. Cook
1574: 0003: \***
1575: 0003: \***      Combined from STKMQNUE.J86 and STKMQFLE.J86
1576: 0003: \***
1577: 0003: \***      Version B.     S.P. Kelsey (CTG)            7th November
1578: 0003: \***      Include CSR Marker in the Type 1 and Type 18 transactions.
1579: 0003: \***
1580: 0003: \***      Version C.     S. Goulding                 8th March
1581: 0003: \***      Add fields for new tranctions types 21 & 23
1582: 0003: \***
1583: 0003: \***      Version D.     ???????????            ????????????
1584: 0003: \***      ????????????????????????????????????????????????????????
1585: 0003: \***
1586: 0003: \***      Version E.     Michael J. Kelsall           16th Dec 1993.
1587: 0003: \***      Addition of txn types, 24, 25, 26, 27 and 28. As part of the
1588: 0003: \***      RETURNS/AUTOMATIC CREDIT CLAIMING system.
1589: 0003: \***
1590: 0003: \***      Version 1.1    Michael J. Kelsall           10th Aug 1994.
1591: 0003: \***      Changes as part of R/ACC update to allow for zero price claim
1592: 0003: \***      processing. Addition of type 29 txn for this change.
1593: 0003: \***
1594: 0003: \***      Version 1.2    Nik Sen                       8th November 1994
1595: 0003: \***      Addition of transaction type 30 as oart of Epsom Life CSR Phase 2
1596: 0003: \***
1597: 0003: \***      Version 1.3    Neil Bennett                   2nd January 2007
1598: 0003: \***      Add ASN processing support. (Rec Type 17)
1599: 0003: \***
1600: 0003: \***      Version 1.4    Brian Greenfield               14th may 2007
1601: 0003: \***      Added STKMQ.RECALL.TYPE$ for use in A7C RECALLS - only type 26 records.
1602: 0003: \***
1603: 0003: \***      Version 1.5    Neil Bennett                  31st January 2008
1604: 0003: \***      Add STKMQ.FLAG$ for record type 11
1605: 0003: \***
1606: 0003: \***      Version 1.6    Dave Constable                5th September 2008
1607: 0003: \***      Add STKMQ.FLAG$ for record type 33
1608: 0003: \***
1609: 0003: \***      Version 1.7    Dave Constable                30th December 2008
1610: 0003: \***      Add STKMQ.RESCAN$ for record type 33
1611: 0003: \***
1612: 0003: \***      Version 1.8    Dave Constable                6th January 2009
1613: 0003: \***      Add Bookin date & time for record type 33
1614: 0003: \***
1615: 0003: \***      Version F      Mark Walker                      27th Mar 2014
1616: 0003: \***      F337 Centralised View of Stock
1617: 0003: \***      - Relocated STKMQ item processing variables to here.
1618: 0003: \***
1619: 0003: \******************************************************************************
1620: 0003: \*******************************************************************************
1621: 0003: \***
1622: 0003: \***  The length of the records on this file vary depending on the record
1623: 0003: \***  transaction type, but they all comprise combinations of the fields
1624: 0003: \***  defined below.
1625: 0003: \***
1626: 0003: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,
1627: 0003: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
1628: 0003: \***     END OF RECORD MARKER.
1629: 0003: \***
1630: 0003: \***  Transaction type 1 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1631: 0003: \***     TIME, FSI, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER, STORE SUFFIX,
1632: 0003: \***     COUNT OF ITEMS, INVOICE DAY,(FIELD DELIMITER, BOOTS CODE,
1633: 0003: \***     FIELD DELIMITER, QUANTITY, FIELD DELIMITER, CSR MARKER),
1634: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER.
1635: 0003: \***     The fields within brackets are repeated as many times as count of items.
1636: 0003: \***
1637: 0003: \***  Transaction type 2 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1638: 0003: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, RECORD DELIMITER,
1639: 0003: \***     END OF RECORD MARKER.
1640: 0003: \***
1641: 0003: \***  Transaction type 3 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1642: 0003: \***     TIME, BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER,
1643: 0003: \***     REASON CODE, STORE/RETURN CODE, RECORD DELIMITER, END OF RECORD MARKER
1644: 0003: \***
1645: 0003: \***  Transaction type 4 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1646: 0003: \***     TIME, BOOTS CODE, ON IDF FLAG, FIELD DELIMITER, QUANTITY,
1647: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1648: 0003: \***
1649: 0003: \***  Transaction type 5 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1650: 0003: \***     TIME, BOOTS CODE, COUNT FLAG, STOCK MOVEMENT DATE, FIELD DELIMITER,
1651: 0003: \***     QUANTITY, RECORD DELIMITER, END OF RECORD MARKER
1652: 0003: \***
1653: 0003: \***  Transaction type 6 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1654: 0003: \***     TIME, BOOTS CODE, REASON (1 byte ASCII)
1655: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1656: 0003: \***
1657: 0003: \***  Transaction type 7 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1658: 0003: \***     TIME, BOOTS CODE, CONCEPT SEQUENCE
1659: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1660: 0003: \***
1661: 0003: \***  Transaction type 8 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1662: 0003: \***     TIME, PRODUCT GROUP, RECORD DELIMITER, END OF RECORD
1663: 0003: \***     MARKER
1664: 0003: \***
1665: 0003: \***  Transaction type 9 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1666: 0003: \***     TIME, LIST NUMBER, ITEM NUMBER, LIST TYPE,
1667: 0003: \***     COUNT.BY.DATE, RECORD DELIMITER, END OF RECORD MARKER
1668: 0003: \***
1669: 0003: \***  Transaction type 10- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1670: 0003: \***     TIME, BOOTS CODE,
1671: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1672: 0003: \***
1673: 0003: \***  Transaction type 11- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1674: 0003: \***     TIME, BOOTS CODE, FIELD DELIMITER, COUNT QUANTITY, FIELD DELIMITER(opt),
1675: 0003: \***     SOURCE(opt), FLAG(opt), RECORD DELIMITER, END OF RECORD MARKER
1676: 0003: \***
1677: 0003: \***  Transaction type 12- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1678: 0003: \***     TIME, BOOTS CODE,
1679: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1680: 0003: \***
1681: 0003: \***  Transaction type 13- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1682: 0003: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1683: 0003: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1684: 0003: \***     FIELD DELIMITER, BACKROOM COUNT, RECORD DELIMITER, END OF REC MARKER
1685: 0003: \***
1686: 0003: \***  Transaction type 14- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1687: 0003: \***     TIME, LIST NUMBER, LIST STATUS, RECORD DELIMITER,
1688: 0003: \***     END OF RECORD MARKER
1689: 0003: \***
1690: 0003: \***  Transaction type 16- RECORD DELIMIER, TRANS TYPE, FIELD DELIMITER, DATE,
1691: 0003: \***     TIME, BC LETTER, FIELD DELIMITER, ORIGINAL RECOUNT
1692: 0003: \***     PERCENTAGE, FIELD DELIMITER, CHANGED RECOUNT PERCENTAGE,
1693: 0003: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1694: 0003: \***
1695: 0003: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1696: 0003: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
1697: 0003: \***     NUMBER, ITEM COUNT,
1698: 0003: \***     CARTON NUMBER, CARTON FLAG,                                        ! 1.3NWB
1699: 0003: \***     FIELD DELIMITER, ITEM CODE, BAR CODE,
1700: 0003: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
1701: 0003: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
1702: 0003: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1703: 0003: \***
1704: 0003: \***  Transaction type 18- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1705: 0003: \***     TIME, FOLIO IDENTIFIER, FOLIO YEAR, FOLIO MONTH, FOLIO NUMBER,
1706: 0003: \***     STORE SUFFIX, ITEM COUNT, INVOICE DAY, EXPECTED DATE OF DELIVERY,
1707: 0003: \***     DALLAS MARKER, FIELD DELIMITER, ITEM CODE, FIELD DELIMITER,
1708: 0003: \***     ORDER QUANTITY, FIELD DELIMITER, CSR MARKER,
1709: 0003: \***     (the last six fields repeat ITEM COUNT times),
1710: 0003: \***     RECORD DELIMITER, END OF RECORD DELIMITER
1711: 0003: \***
1712: 0003: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1713: 0003: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
1714: 0003: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
1715: 0003: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
1716: 0003: \***
1717: 0003: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1718: 0003: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1719: 0003: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
1720: 0003: \***
1721: 0003: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1722: 0003: \***     TIME, DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
1723: 0003: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, FIELD DELIMITER
1724: 0003: \***     FSI,FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, FOLIO NO, CSR MARKER
1725: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
1726: 0003: \***
1727: 0003: \***
1728: 0003: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
1729: 0003: \***
1730: 0003: \***  Transaction type 24 - Whole or Part consignment record
1731: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1732: 0003: \***     CREDIT CLAIM NUM, BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM,
1733: 0003: \***     FOLIO NUM, BATCH REF NUM, WHOLE/PART CONSIGNMENT, REPAIR CATEGORY,
1734: 0003: \***     REPAIR NUM, PLAN4 POLICY NUM, DDDA/DCDR NUM, DELIV NOTE NUM,
1735: 0003: \***     DELIV DATE, NUM OF CARTONS, ORDER NUM, COMMENT, NUM OF ITEMS,
1736: 0003: \***     ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, RECORD DELIMITER,
1737: 0003: \***     END OF RECORD MARKER
1738: 0003: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1739: 0003: \***
1740: 0003: \***  Transaction type 25 - Non-sales func 16 and Misc. txns from controller
1741: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1742: 0003: \***     CREDIT CLAIM NUM, NUM OF ITEMS, AUTH CODE/CONTACT,
1743: 0003: \***     ADJUST STOCK FIGURE FLAG, REASON, ITEM/BAR CODE FLAG, BOOTS/BAR CODE,
1744: 0003: \***     QTY, PRICE, RECORD DELIMITER, END OF RECORD MARKER
1745: 0003: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
1746: 0003: \***
1747: 0003: \***  Transaction type 26 - Data from LDT
1748: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME, UOD NUM,
1749: 0003: \***     UOD STATUS, CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD,
1750: 0003: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER,
1751: 0003: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
1752: 0003: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
1753: 0003: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD
1754: 0003: \***     DESPATCHED, RECALL TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.4BG
1755: 0003: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
1756: 0003: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
1757: 0003: \***
1758: 0003: \***  Transaction type 27 - End of LDT session
1759: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1760: 0003: \***     DATE SESSION ENDED, TIME SESSION ENDED, RECORD DELIMITER,
1761: 0003: \***     END OF RECORD MARKER
1762: 0003: \***
1763: 0003: \***  Transaction type 28 - Cancelled Credit Claim
1764: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1765: 0003: \***     CLAIM NUMBER, UOD NUM, NEW STATUS FLAG, RECORD DELIMITER,
1766: 0003: \***     END OF RECORD MARKER
1767: 0003: \***
1768: 0003: \***  Transaction type 29 - Zero price update
1769: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1770: 0003: \***     CLAIM NUMBER, ITEM NUMBER, CLAIM VALUE, RECORD DELIMITER,
1771: 0003: \***     END OF RECORD MARKER
1772: 0003: \***
1773: 0003: \***  Transaction type 30 - CSR Issues
1774: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE, TIME,
1775: 0003: \***     BOOTS CODE, FIELD DELIMITER, QUANTITY, FIELD DELIMITER
1776: 0003: \***     EXPECTED DELIVERY DATE, RECORD DELIMITER, END OF RECORD MARKER
1777: 0003: \***
1778: 0003: \***  Transaction type 31 - Quasi Count
1779: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1780: 0003: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1781: 0003: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1782: 0003: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1783: 0003: \***      END OF REC MARKER
1784: 0003: \***
1785: 0003: \***  Transaction type 32 - Quasi Adjustment count
1786: 0003: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1787: 0003: \***     TIME, LIST NUMBER, ITEM NUMBER, ITEM STATUS,ITEM CODE,
1788: 0003: \***     COUNT DATE, COUNT TIME, PRICE, FIELD DELIMITER, SHOP FLOOR COUNT,
1789: 0003: \***     FIELD DELIMITER, BACKROOM COUNT (PREV STOCK FIG), RECORD DELIMITER,
1790: 0003: \***     END OF REC MARKER
1791: 0003: \***
1792: 0003: \***  Transaction type 33 - +UOD Receiving
1793: 0003: \**      RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
1794: 0003: \***     TIME, UOD LICENCE PLATE, DESPATCH DATE, ACTION, ITEM COUNT,
1795: 0003: \***     for audit type+(ITEM CODE, BARCODE, DESPATCHED QTY, VARIANCE )
1796: 0003: \***     END OF REC MARKER
1797: 0003: \***
1798: 0003: \******************************************************************************
1799: 0003: 
1800: 0003:   STRING GLOBAL              \
1801: 0003:     STKMQ.FILE.NAME$,        \
1802: 0003:     STKMQ.RECORD$,           \ Used to store the whole record which is unstrung
1803: 0003:                              \ into the fields below
1804: 0003:     STKMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
1805: 0003:     STKMQ.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
1806: 0003:                              \             01 = W'house invoice delivery record
1807: 0003:                              \             02 = Delivery without invoice record
1808: 0003:                              \             03 = Stock out record
1809: 0003:                              \             04 = Stock count record
1810: 0003:                              \             17 = Delivery without confirmation
1811: 0003:                              \                  of Direct Order detail
1812: 0003:                              \             18 = Confirmed Dallas invoice record
1813: 0003:                              \             19 = Delivery without confirmation
1814: 0003:                              \                  of Direct Order header
1815: 0003:                              \             21 = UOD record
1816: 0003:                              \             23 = Item Level UOD record
1817: 0003:                              \             24 = Whole/Part consignment (R/ACC)
1818: 0003:                              \             25 = NS16 / Misc cont txn (R/ACC)
1819: 0003:                              \             26 = Data from LDT (R/ACC)
1820: 0003:                              \             27 = End of LDT session (R/ACC)
1821: 0003:                              \             28 = Canc. Credit Claim (R/ACC)
1822: 0003:                              \             29 = Zero price update (R/ACC)
1823: 0003:     STKMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
1824: 0003:     STKMQ.CREATION.DATE$,    \ 3 byte UPD set to current date
1825: 0003:     STKMQ.CREATION.TIME$,    \ 3 byte UPD set to current time
1826: 0003:     STKMQ.CSR.MARKER$,       \ 1 byte ASCII. "Y" - This is a CSR Item      BSPK
1827: 0003:                              \               " " - This is not a CSR Item  BSPK
1828: 0003:     STKMQ.DATE$,             \ 3 byte UPD set to current date
1829: 0003:     STKMQ.TIME$,             \ 3 byte UPD set to current time
1830: 0003:     STKMQ.FSI$,              \ 1 byte ASCII
1831: 0003:     STKMQ.FOLIO.YEAR$,       \ 1 byte UPD
1832: 0003:     STKMQ.FOLIO.MONTH$,      \ 1 byte UPD
1833: 0003:     STKMQ.FOLIO.NUMBER$,     \ 2 bytes UPD
1834: 0003:     STKMQ.STORE.SUFFIX$,     \ 1 byte ASCII
1835: 0003:     STKMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
1836: 0003:     STKMQ.BOOTS.CODE$,       \ 4 bytes UPD
1837: 0003:     STKMQ.ON.IDF.FLAG$,      \ 1 byte ASCII. Y = On IDF   N = Not on IDF
1838: 0003:     STKMQ.QUANTITY$,         \ variable length string equivalent to
1839: 0003:                              \ STR$(STKMQ.QUANTITY%)
1840: 0003:                              \ +ve indicates add to stock
1841: 0003:                              \ -ve indicates subtract from stock
1842: 0003:     STKMQ.REASON.CODE$,      \ 2 bytes UPD
1843: 0003:     STKMQ.STORE.RET.CODE$,   \ 2 bytes UPD
1844: 0003:     STKMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
1845: 0003:     STKMQ.REASON$,           \ 1 byte ASCII. "I" = ineligible,
1846: 0003:                              \               "U" = unsuppliable,
1847: 0003:                              \               "Z" = deleted,
1848: 0003:                              \               " " = not removed.
1849: 0003:     STKMQ.CONCEPT.SEQUENCE$, \ 3 byte UPD. Concept group / sequence
1850: 0003:     STKMQ.INVOICE.DAY$,      \ 1 byte UPD
1851: 0003:     STKMQ.LIST.NUMBER$,      \ 4 byte ASCII
1852: 0003:     STKMQ.ITEM.NUMBER$,      \ 2 byte ASCII
1853: 0003:     STKMQ.ITEM.STATUS$,      \ 1 byte ASCII
1854: 0003:     STKMQ.COUNT.DATE$,       \ 3 byte UPD - YYMMDD
1855: 0003:     STKMQ.COUNT.TIME$,       \ 2 byte UPD - HHMM
1856: 0003:     STKMQ.PRICE$,            \ 5 byte UPD
1857: 0003:     STKMQ.SHOP.COUNT$,       \ variable ASCII
1858: 0003:     STKMQ.BKRM.COUNT$,       \ variable ASCII
1859: 0003:     STKMQ.LIST.STATUS$,      \ 1 byte ASCII
1860: 0003:     STKMQ.LEFT.TO.COUNT$,    \ variable ASCII
1861: 0003:     STKMQ.COUNT.BY.DATE$,    \ 3 bytes UPD
1862: 0003:     STKMQ.PRODUCT.GROUP$,    \ 3 bytes UPD
1863: 0003:     STKMQ.BC.LETTER$,        \ 1 byte ASCII
1864: 0003:     STKMQ.ORG.RECOUNT$,      \ VARIABLE ASCII
1865: 0003:     STKMQ.NEW.RECOUNT$,      \ VARIABLE ASCII
1866: 0003:     STKMQ.LIST.TYPE$,        \ 1 byte ASCII
1867: 0003:     STKMQ.COUNT.FLAG$,       \ 1 byte ASC from corrections file
1868: 0003:     STKMQ.STMVT.DATE$,       \ 3 bytes UPD
1869: 0003:     STKMQ.SUPPLIER.NO$,      \ 4 bytes UPD
1870: 0003:     STKMQ.ORDER.NO$,         \ 2 bytes UPD
1871: 0003:     STKMQ.ORDER.SFX$,        \ 1 byte ASCII
1872: 0003:     STKMQ.PAGE.NO$,          \ 1 byte UPD
1873: 0003:     STKMQ.ORDER.DATE$,       \ 3 bytes UPD
1874: 0003:     STKMQ.EXP.DELV.DATE$,    \ 3 bytes UPD
1875: 0003:     STKMQ.DALLAS.MKR$,       \ 1 byte ASCII DALLAS system marker
1876: 0003:                              \ 'Y' - invoice is from DALLAS system,
1877: 0003:                              \ 'N' - invoice is not from DALLAS system
1878: 0003:                              \ 'Q' - invoice contains quantity alterations
1879: 0003:     STKMQ.SOURCE$,           \ 1 byte ASCII Source flag
1880: 0003:                              \ 'S' - PSS65, 'P' - PDT, PSS57
1881: 0003:                              \ Transaction type 11 'S' - Stocktake else ' '
1882: 0003:     STKMQ.FLAG$,             \ Transaction type 11 'F' - First 'L' - Last or ' '
1883: 0003:     STKMQ.BAR.CODE$,         \ 6 bytes UPD
1884: 0003:     STKMQ.CODE.FLAG$,        \ 1 BYTE ASCII
1885: 0003:     STKMQ.QTY.GOOD$,         \ VARIABLE ASCII
1886: 0003:                              \ Quantity of singles booked in in good condition
1887: 0003:     STKMQ.QTY.BAD$,          \ VARIABLE ASCII
1888: 0003:                              \ Quantity of singles booked in in bad condition
1889: 0003:     STKMQ.QTY.STOLEN$,       \ VARIABLE ASCII
1890: 0003:                              \ Quantity of singles recognised as stolen
1891: 0003:     STKMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
1892: 0003:                              \ 'C' - Order has been confirmed
1893: 0003:                              \ 'A' - Order has been amended
1894: 0003:                              \ ' ' - Nothing has been done to the order
1895: 0003:     STKMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
1896: 0003:                              \ processed
1897: 0003:     STKMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
1898: 0003:     STKMQ.SNGLS.ADDED$,      \ 2 byte UPD  Singles added to order
1899: 0003:     STKMQ.ITEMS.ADDED$,      \ 2 byte UPD  Items added to order
1900: 0003:     STKMQ.ITEMS.BOOKED$,     \ 2 byte UPD  Items booked in on the order
1901: 0003:     STKMQ.DIST.CENTRE$,      \ 1 byte UPD
1902: 0003:     STKMQ.WHSE.NUMBER$,      \ 1 byte UPD
1903: 0003:     STKMQ.STORE.NUMBER$,     \ 2 byte UPD
1904: 0003:     STKMQ.UOD.NUMBER$,       \ 3 byte UPD
1905: 0003:     STKMQ.STATUS$,           \ 1 byte ASCII
1906: 0003:                              \
1907: 0003:     STKMQ.CREDIT.CLAIM.NUM$, \ 4 byte UPD
1908: 0003:     STKMQ.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
1909: 0003:                              \              "E" = Excess,
1910: 0003:                              \              "R" = Repairs
1911: 0003:     STKMQ.SUPPLIER.NUM$,     \ 3 byte UPD
1912: 0003:     STKMQ.INVOICE.NUM$,      \*9 byte ASC
1913: 0003:     STKMQ.FOLIO.NUM$,        \ 3 byte UPD
1914: 0003:     STKMQ.BATCH.REF$,        \ 3 byte UPD
1915: 0003:     STKMQ.WHOLE.PART.CON$,   \ 1 byte ASC   "W" = Whole, "P" = Part
1916: 0003:     STKMQ.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
1917: 0003:                              \               2 = Estimate,
1918: 0003:                              \               3 = Boots guarantee,
1919: 0003:                              \               4 = Supplier guarantee,
1920: 0003:                              \               5 = Other guarantee,
1921: 0003:     STKMQ.REPAIR.NUM$,       \ 6 byte UPD
1922: 0003:     STKMQ.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
1923: 0003:     STKMQ.DDDA.DCDR.NUM$,    \ 4 byte UPD
1924: 0003:     STKMQ.DELIV.NOTE.NUM$,   \*9 byte ASC
1925: 0003:     STKMQ.NUM.CARTONS.RECEIV$,\1 byte UPD
1926: 0003:     STKMQ.ORDER.NUM$,        \*7 byte ASC
1927: 0003:     STKMQ.COMMENT$,          \*20 byte ASC
1928: 0003:     STKMQ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
1929: 0003:                              \               "B" = Barcode.
1930: 0003:     STKMQ.ITEM.BARCODE$,     \ 7 byte UPD
1931: 0003:     STKMQ.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
1932: 0003:     STKMQ.AUTHORISATION$,    \ 15 byte ASC
1933: 0003:     STKMQ.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
1934: 0003:     STKMQ.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
1935: 0003:     STKMQ.UOD.NUM$,          \ 7 byte UPD
1936: 0003:     STKMQ.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
1937: 0003:                              \              "C" = Closed,
1938: 0003:                              \              "D" = Despatched
1939: 0003:     STKMQ.SUPPLY.ROUTE$,     \ 1 byte ASC
1940: 0003:     STKMQ.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
1941: 0003:                              \              "D" = Dispensary
1942: 0003:     STKMQ.RECALL.NUM$,       \ 8 byte ASC
1943: 0003:     STKMQ.SUPPLIER$,         \ 15 byte ASC
1944: 0003:     STKMQ.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
1945: 0003:                              \               2 = BIRD,
1946: 0003:                              \               3 = Via D6,
1947: 0003:                              \               4 = Representative
1948: 0003:     STKMQ.CARRIER$,          \ 1 byte UPD;   1 = GPO,
1949: 0003:                              \               2 = Parcelforce,
1950: 0003:                              \               3 = Securicor,
1951: 0003:                              \               4 = Other
1952: 0003:     STKMQ.BIRD.NUM$,         \ 8 byte ASC
1953: 0003:     STKMQ.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
1954: 0003:                              \              "C" = CSR
1955: 0003:     STKMQ.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
1956: 0003:                              \               2 = Town Tray,
1957: 0003:                              \               3 = Roll cage,
1958: 0003:                              \               4 = Other
1959: 0003:     STKMQ.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
1960: 0003:                              \               2 = Poor handling
1961: 0003:     STKMQ.RECEIVING.STORE$,  \ 2 byte UPD
1962: 0003:     STKMQ.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
1963: 0003:                              \               2 = MTS,
1964: 0003:                              \               3 = Other
1965: 0003:     STKMQ.DATE.UOD.OPENED$,  \ 3 byte UPD
1966: 0003:     STKMQ.DATE.DESPATCHED$,  \ 3 byte UPD
1967: 0003:     STKMQ.TIME.DESPATCHED$,  \ 3 byte UPD
1968: 0003:     STKMQ.ITEM.UPDATED$,     \ 1 byte ASC
1969: 0003:     STKMQ.DATE.SESS.END$,    \ 3 byte UPD
1970: 0003:     STKMQ.TIME.SESS.END$,    \ 3 byte UPD
1971: 0003:     STKMQ.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
1972: 0003:                              \              "D" = Despatched,
1973: 0003:                              \              "X" = Cancelled
1974: 0003:     STKMQ.ITEM.NUM$,         \ 2 byte UPD   (CCITF key value)
1975: 0003:     STKMQ.CLAIM.VALUE$,      \ 3 byte UPD
1976: 0003:     STKMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.3NWB
1977: 0003:                              \                 'N' Normal Book In           ! 1.3NWB
1978: 0003:                              \                 'A' Carton Audit Process     ! 1.3NWB
1979: 0003:                              \                 'E' Exception Process (nof)  ! 1.3NWB
1980: 0003:     STKMQ.CARTON.NO$,        \ 4 bytes UPD (0-9999)                         ! 1.3NWB
1981: 0003:     STKMQ.RECALL.TYPE$       ! 1 byte ASC   "B" = Batch Recall              ! 1.4BG
1982: 0003:                              !              "N" = Non-batch Recall          ! 1.4BG
1983: 0003:                              !              " " = Old Credit Claim          ! 1.4BG
1984: 0003: 
1985: 0003: !***********************************************************!* DC 1.6
1986: 0003: !* Added for +UOD Development                               !* DC 1.6
1987: 0003: !***********************************************************!* DC 1.6
1988: 0003:   STRING GLOBAL \                                           !* DC 1.6 
1989: 0003:     STKMQ.LICENCE.PLATE$, \                                 !* DC 1.6 
1990: 0003:     STKMQ.DESPATCH.DATE$, \                                 !* DC 1.6 
1991: 0003:     STKMQ.ACTION$, \                                        !* DC 1.6 
1992: 0003:     STKMQ.DELIVERY.DATE$, \                                 !* DC 1.6 
1993: 0003:     STKMQ.DELIVERY.TIME$, \                                 !* DC 1.6 
1994: 0003:     STKMQ.DRIVER.ID$, \                                     !* DC 1.6 
1995: 0003:     STKMQ.BOOKIN.DATE$, \                                   !* DC 1.8
1996: 0003:     STKMQ.BOOKIN.TIME$, \                                   !* DC 1.8 
1997: 0003:     STKMQ.OP.ID$, \                                         !* DC 1.6 
1998: 0003:     STKMQ.BOOKIN.METHOD$, \                                 !* DC 1.6 
1999: 0003:     STKMQ.BOOKIN.LEVEL$, \                                  !* DC 1.6 
2000: 0003:     STKMQ.GIT$, \                                           !* DC 1.6 
2001: 0003:     STKMQ.RESCAN$, \                                        !* DC 1.7
2002: 0003:     STKMQ.FILLER$                                           !* DC 1.6 
2003: 0003: 
2004: 0003:   INTEGER*2 GLOBAL           \                              !* DC 1.6 
2005: 0003:     STKMQ.SESS.NUM%,         \                              !* DC 1.6 
2006: 0003:     STKMQ.REPORT.NUM%                                       !* DC 1.6 
2007: 0003: !***********************************************************!* DC 1.6
2008: 0003: 
2009: 0003:     STRING GLOBAL                                                       \   !FMW
2010: 0003:         STKMQ.UOD.QTY$,         \                                       \   !FMW
2011: 0003:         STKMQ.CODE$(1),         \ Item Code                             \   !FMW
2012: 0003:         STKMQ.TYPE$(1),         \ Code type I = Item code               \   !FMW
2013: 0003:                                 \           B = Barcode                 \   !FMW
2014: 0003:         STKMQ.CSR.FLAG$(1),     \ CSR Flag                              \   !FMW
2015: 0003:         STKMQ.EAN.CODE$(1),     \ Barcode                               \   !FMW
2016: 0003:         STKMQ.QTY$(1),          \ Quantity                              \   !FMW
2017: 0003:         STKMQ.GOOD.QUAN$(1),    \ Good Quantity                         \   !FMW
2018: 0003:         STKMQ.DAM.QUAN$(1),     \ Damaged Quantity                      \   !FMW
2019: 0003:         STKMQ.STOL.QUAN$(1),    \ Stolen Quantity                       \   !FMW
2020: 0003:         STKMQ.PRICE.ARRAY$(1)   ! Retail Price                              !FMW
2021: 0003:                                                                             !FMW
2022: 0003:     INTEGER*2 GLOBAL                                                    \   !FMW
2023: 0003:         STKMQ.ITEM%             ! Count of items in a transaction           !FMW
2024: 0003: 
2025: 0003:  %INCLUDE BCSMFDEC.J86                    ! FLC
2026: 0003: REM \
2027: 0003: \******************************************************************************
2028: 0003: \******************************************************************************
2029: 0003: \***
2030: 0003: \***   %INCLUDE FOR BUSINESS CENTRE SUPPLY METHOD FILE REFERENCE PARAMETERS
2031: 0003: \***                                              FIELD DECLARATIONS
2032: 0003: \***
2033: 0003: \***               REFERENCE    : BCSMFDEC.J86
2034: 0003: \***
2035: 0003: \***  Version A - L Cook
2036: 0003: \***  Copied from bcsmfnue.j86 and bcsmffle.j86
2037: 0003: \***
2038: 0003: \***  Version B - Les Cook
2039: 0003: \***  to include integer missed from bcsmfflf.j86 in error
2040: 0003: \***
2041: 0003: \******************************************************************************
2042: 0003: \*******************************************************************************
2043: 0003: 
2044: 0003:   STRING GLOBAL           \
2045: 0003:     BCSMF.FILE.NAME$,              \ 
2046: 0003:     BCSMF.FSI$,                    \ 1 byte ASCII folio series identifier (key)
2047: 0003:     BCSMF.NAME$,                   \ 14 bytes ASCII business centre name
2048: 0003:     BCSMF.PSEUDO.BUSINESS.CENTRE$, \ 1 byte flag "Y" = pseudo bc
2049: 0003:     BCSMF.FILLER$                  ! 3 bytes spaces
2050: 0003: 
2051: 0003:   INTEGER*1 GLOBAL          \
2052: 0003:     BCSMF.RECNT.LIMIT%,     \ percentage of recounts that may be generated
2053: 0003:     BCSMF.MIN.RECNT.LIMIT%, \ minimum limit
2054: 0003:     BCSMF.MAX.RECNT.LIMIT%, \ maximum limit
2055: 0003:     BCSMF.DISCRPNCY.CNT%,   \ used to calculate   
2056: 0003:     BCSMF.DISCRPNCY.PERCNT%,\ if recount
2057: 0003:     BCSMF.STK.CNT.LIMIT%,   \ is necessary
2058: 0003:     BCSMF.SEQUENCE.NO%,     \ used for displaying
2059: 0003:     BCSMF.NO.REPEAT.TICKETS% ! Number of repeat FALCONCRAFT tickets	! CLC
2060: 0003: 
2061: 0003:   INTEGER*2 GLOBAL        \
2062: 0003:     BCSMF.DISCRPNCY.VAL%,   \ (in pounds) used for determining recounts
2063: 0003:     BCSMF.MIN.LIST.NO%,     \ allowable range of 
2064: 0003:     BCSMF.MAX.LIST.NO%,     \ spare list numbers
2065: 0003:     BCSMF.RECL%,          \
2066: 0003:     BCSMF.SESS.NUM%,      \
2067: 0003:     BCSMF.REPORT.NUM%
2068: 0003:  %INCLUDE IEFDEC.J86                      ! DLC
2069: 0003: REM \
2070: 0003: \******************************************************************************
2071: 0003: \******************************************************************************
2072: 0003: \***
2073: 0003: \***         %INCLUDE FOR ITEM EAN CODES FILE - FIELD DECLARATIONS
2074: 0003: \***                                            FILE REFERENCE PARAMETERS
2075: 0003: \***
2076: 0003: \***               FILE TYPE    : Keyed
2077: 0003: \***
2078: 0003: \***               REFERENCE    : IEFDEC.J86
2079: 0003: \***
2080: 0003: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
2081: 0003: \***    No changes to this file.
2082: 0003: \***
2083: 0003: \*******************************************************************************
2084: 0003: \*******************************************************************************
2085: 0003: 
2086: 0003:   STRING GLOBAL                      \
2087: 0003:     IEF.FILE.NAME$,		     \
2088: 0003:     IEF.BOOTS.CODE.BAR.CODE$,        \ 9 byte UPD -                        BBAAS
2089: 0003:                                      \ 3 bytes UPD boots code              BBAAS   
2090: 0003:                                      \ + 6 UPD bar code,                   BBAAS
2091: 0003:                                      \ no check digits. (key)              BBAAS
2092: 0003:     IEF.NEXT.BAR.CODE$               ! 6 byte UPD without check digit
2093: 0003: 
2094: 0003:   INTEGER*2 GLOBAL        \
2095: 0003:     IEF.REPORT.NUM%,	  \
2096: 0003:     IEF.SESS.NUM%,	  \ 
2097: 0003:     IEF.RECL%
2098: 0003:  %INCLUDE DIRORDEC.J86                    ! DLC
2099: 0003: REM \
2100: 0003: \******************************************************************************
2101: 0003: \******************************************************************************
2102: 0003: \***
2103: 0003: \***     %INCLUDE FOR STORE DIRECT ORDERS FILE  - FIELD DECLARATIONS
2104: 0003: \***                                              FILE REFERENCE PARAMETERS
2105: 0003: \***
2106: 0003: \***               FILE TYPE    : Keyed
2107: 0003: \***
2108: 0003: \***               REFERENCE    : DIRORDEC.J86
2109: 0003: \***
2110: 0003: \***               DATE OF LAST AMENDMENT - 14/08/1992
2111: 0003: \***
2112: 0003: \***               VERSION A    : Les Cook    14th August 1992
2113: 0003: \***
2114: 0003: \***  VERSION B                 Neil Bennett                21st December 2006
2115: 0003: \***  New variable added to hold superceded flag for ASN Carton Support.
2116: 0003: \***
2117: 0003: \******************************************************************************
2118: 0003: \******************************************************************************
2119: 0003: 
2120: 0003:   STRING GLOBAL               \
2121: 0003:       DIRORD.FILE.NAME$,      \
2122: 0003:     DIRORD.RECKEY$,           \ 9 byte key which comprises the following fields
2123: 0003:     DIRORD.SUPPLIER$,         \ 3 bytes UPD (key)
2124: 0003:     DIRORD.ORDER.NO$,         \ 2 bytes UPD (key)
2125: 0003:     DIRORD.ORDER.SUF$,        \ 1 byte ASCII (key)
2126: 0003:     DIRORD.BUS.CENTRE$,       \ 1 byte ASCII (key)
2127: 0003:     DIRORD.SOURCE$,           \ 1 byte ASCII (key), 'D' if from PSS57
2128: 0003:                               \                     ' ' for head office order
2129: 0003:     DIRORD.PAGE.NO$,          \ 1 byte UPD (key)
2130: 0003:                               \
2131: 0003:     DIRORD.CONF.END.TIME$,    \ 2 bytes UPD - Ending time of last update
2132: 0003:     DIRORD.CONF.STRT.TIME$,   \ 2 bytes UPD - Starting time of last update
2133: 0003:     DIRORD.CONFIRM.DATE$,     \ 3 bytes UPD. YYMMDD - set to low values if
2134: 0003:                               \                       confirm flag is blank
2135: 0003:     DIRORD.CONFIRM.FLAG$,     \ 1 byte ASCII. C=Complete, A=Amended,
2136: 0003:                               \               blank = not confirmed
2137: 0003:     DIRORD.DRRF.LAST.DATE$,   \ 3 bytes UPD Date of last run
2138: 0003:     DIRORD.DRRF.LAST.TIME$,   \ 2 bytes UPD Time of last run
2139: 0003:     DIRORD.EXP.DELV.DATE$,    \ 3 bytes UPD. YYMMDD - Expected date of order's
2140: 0003:                               \                       delivery
2141: 0003:     DIRORD.FILLER1$,          \ 494 bytes ASCII set to spaces
2142: 0003:     DIRORD.FILLER2$,          \ 474 bytes ASCII set to spaces
2143: 0003:     DIRORD.FILLER3$,          \ 15 bytes ASCII set to spaces
2144: 0003:     DIRORD.ITEM.COUNT$,       \ 1 byte UPD  - Number of items on record
2145: 0003:     DIRORD.ITEM.DETAILS$(2),  \ 256 bytes containing the repeated item string
2146: 0003:                               \ details. The first dimension has 16 elements
2147: 0003:                               \ corresponding to lines on the invoice.  The
2148: 0003:                               \ second dimension has 4 elements:-
2149: 0003:                               \   1. Boots Code - 4 bytes UPD (0 if bar code
2150: 0003:                               \                                has no matching
2151: 0003:                               \                                Boots code on
2152: 0003:                               \                                file)
2153: 0003:                               \   2. Bar Code   - 6 bytes UPD
2154: 0003:                               \   2. Price      - 4 bytes UPD
2155: 0003:                               \   3. Filler     - 2 bytes ASCII spaces
2156: 0003:                               \ Any unused entries are set to spaces
2157: 0003:     DIRORD.NO.ITEMS.BOOKED$,  \ 2 bytes UPD - Total number of items booked in
2158: 0003:     DIRORD.NO.ITEMS.LST.BKD$, \ 2 bytes UPD - Number of items booked in during
2159: 0003:                               \               last date of update
2160: 0003:     DIRORD.NO.ORDER.ITEM$,    \ 2 bytes UPD - Total number of items in order
2161: 0003:     DIRORD.NO.ORDER.SNGL$,    \ 2 bytes UPD - Total single quantity in order
2162: 0003:     DIRORD.ON.SALE.DATE$,     \ 3 bytes UPD. YYMMDD - Date stock should be on
2163: 0003:                               \                       sale
2164: 0003:     DIRORD.ORDER.DATE$,       \ 3 bytes UPD. YYMMDD Date of order
2165: 0003:     DIRORD.SUPERCEDED$        ! 1 byte ASCII (Y/N) default to N             !BNWB
2166: 0003: 
2167: 0003:     INTEGER*2 GLOBAL       \
2168: 0003:       DIRORD.ITEM.QTY%(2), \ contains the repeated item integer details. The
2169: 0003:                            \ first dimension has 16 elements corresponding to
2170: 0003:                            \ lines on the invoice.  The second dimension has 7
2171: 0003:                            \ elements:-
2172: 0003:                            \   1. Quantity expected from order
2173: 0003:                            \   2. Quantity booked in in good condition
2174: 0003:                            \   3. Quantity booked in in damaged condition
2175: 0003:                            \   4. Quantity booked in as stolen
2176: 0003:                            \   5. Quantity last booked in in good condition
2177: 0003:                            \   6. Quantity last booked in in damaged condition
2178: 0003:                            \   7. Quantity last booked in as stolen
2179: 0003:                            \   Fields 2 to 4 are running totals, fields 5 to 7
2180: 0003:                            \   are the values associated with the confirm/amend
2181: 0003:                            \   date.
2182: 0003:       DIRORD.RECL%,        \
2183: 0003:       DIRORD.SESS.NUM%,    \
2184: 0003:       DIRORD.REPORT.NUM%
2185: 0003: 
2186: 0003:     INTEGER*4 GLOBAL       \
2187: 0003:       DIRORD.NO.RECS%
2188: 0003:  %INCLUDE DIRSUDEC.J86                    ! DLC
2189: 0003: REM \
2190: 0003: \******************************************************************************
2191: 0003: \******************************************************************************
2192: 0003: \***
2193: 0003: \***     %INCLUDE FOR STORE DIRECT SUPPLIER FILE FIELD DECLARATIONS
2194: 0003: \***                                             FILE REFERENCE PARAMETERS
2195: 0003: \***      
2196: 0003: \***               FILE TYPE    : Keyed
2197: 0003: \***
2198: 0003: \***               REFERENCE    : DIRSUDEC.J86
2199: 0003: \***
2200: 0003: \***     Version A - L Cook
2201: 0003: \***
2202: 0003: \***     Combined DIRSUFLA.J86 and DIRSUNUA.J86
2203: 0003: \***
2204: 0003: \***   Version B           Mark Goode          3rd December 2008
2205: 0003: \***   Add new fields for the +ve UOD project
2206: 0003: \***
2207: 0003: \******************************************************************************
2208: 0003: \******************************************************************************
2209: 0003: 
2210: 0003:   STRING GLOBAL            \
2211: 0003:     DIRSUP.FILE.NAME$,     \
2212: 0003:     DIRSUP.RECKEY$,        \ 4 byte key which comprises the following fields
2213: 0003:       DIRSUP.BUS.CENTRE$,  \ 1 byte ASCII (key)
2214: 0003:       DIRSUP.SUPPLIER.NO$, \ 3 bytes UPD (key)
2215: 0003:                            \
2216: 0003:     DIRSUP.SUPPLIER.NAME$, \ 10 byte ASCII
2217: 0003:     DIRSUP.LEAD.TIME.MON$, \ 2 bytes UPD. Lead time for MONDAY in days
2218: 0003:     DIRSUP.LEAD.TIME.TUE$, \ 2 bytes UPD. Lead time for TUESDAY in days
2219: 0003:     DIRSUP.LEAD.TIME.WED$, \ 2 bytes UPD. Lead time for WEDNESDAY in days
2220: 0003:     DIRSUP.LEAD.TIME.THU$, \ 2 bytes UPD. Lead time for THURSDAY in days
2221: 0003:     DIRSUP.LEAD.TIME.FRI$, \ 2 bytes UPD. Lead time for FRIDAY in days
2222: 0003:     DIRSUP.LAPSING.DAYS$,  \ 2 bytes UPD. Number of days before order lapses
2223: 0003:     DIRSUP.PART.ORDER.RULES$, \ 1 byte ASCII. A=Rest of order supplied, 
2224: 0003:                               \               N,Z=not supplied 
2225: 0003:     DIRSUP.MAX.CHECK.QTY$,    \ 2 bytes UPD.
2226: 0003:     DIRSUP.CHECK.QTY$,        \ 2 bytes UPD.
2227: 0003:     DIRSUP.DISCREPANCY.QTY$,  \ 2 bytes UPD.
2228: 0003:     DIRSUP.DISCREPANCY.PERC$, \ 2 bytes UPD. Discrepancy percentage
2229: 0003:     DIRSUP.ASN.FLAG$,         \ 1 byte ASCII. Identifies supplier as ASN or Directs   ! BMG
2230: 0003:     DIRSUP.STATIC.SUPPLIER$,  \ 1 byte ASCII. Identifies supplier as being static     ! BMG
2231: 0003:     DIRSUP.FILLER$          ! 3 bytes ASCII set to low values                         ! BMG
2232: 0003: 
2233: 0003:   INTEGER*2 GLOBAL        \
2234: 0003:     DIRSUP.RECL%,         \
2235: 0003:     DIRSUP.SESS.NUM%,     \
2236: 0003:     DIRSUP.REPORT.NUM%
2237: 0003:     
2238: 0003:   INTEGER*4 GLOBAL        \
2239: 0003:     DIRSUP.NO.RECS%  
2240: 0003:  %INCLUDE DIRWFDEC.J86                    ! DLC
2241: 0003: \******************************************************************************
2242: 0003: \******************************************************************************
2243: 0003: \***
2244: 0003: \***      %INCLUDE FOR DIRWF - DIRECT WORK FILE - FIELD DEFINITIONS
2245: 0003: \***                                              FILE REFERENCE PARAMETERS
2246: 0003: \***
2247: 0003: \***
2248: 0003: \***       REFERENCE: DIRWFDEC.J86
2249: 0003: \***
2250: 0003: \******************************************************************************
2251: 0003: \*******************************************************************************
2252: 0003: 
2253: 0003:   STRING GLOBAL								\
2254: 0003: 	DIRWF.FILE.NAME$,						\
2255: 0003: 	DIRWF.RECORD$
2256: 0003: 
2257: 0003:   INTEGER*2 GLOBAL							\
2258: 0003: 	DIRWF.RECL%,	          					\
2259: 0003: 	DIRWF.SESS.NUM%,						\
2260: 0003: 	DIRWF.REPORT.NUM%
2261: 0003:  %INCLUDE DIRECDEC.J86                    ! DLC
2262: 0003: \******************************************************************************
2263: 0003: \******************************************************************************
2264: 0003: \***
2265: 0003: \***         %INCLUDE FOR DIREC DUMMY FILE I/O SESSION NUMBER
2266: 0003: \***
2267: 0003: \***               REFERENCE    : DIRECDEC.J86
2268: 0003: \***
2269: 0003: \******************************************************************************
2270: 0003: \*******************************************************************************
2271: 0003: 
2272: 0003:   STRING GLOBAL           \
2273: 0003:     DIREC.FILE.NAME$
2274: 0003: 
2275: 0003:   INTEGER*2 GLOBAL        \
2276: 0003:     DIREC.REPORT.NUM%,      \
2277: 0003:     DIREC.SESS.NUM%
2278: 0003:  %INCLUDE LDTCFDEC.J86                    ! DLC
2279: 0003: \******************************************************************************
2280: 0003: \******************************************************************************
2281: 0003: \***
2282: 0003: \***      %INCLUDE FOR LDTCF - LDT CHECK FILE - FILE REFERENCE PARAMETERS
2283: 0003: \***                                            FIELD DEFINITIONS
2284: 0003: \***
2285: 0003: \***       REFERENCE: LDTCFDEC.J86
2286: 0003: \***
2287: 0003: \***
2288: 0003: \******************************************************************************
2289: 0003: \*******************************************************************************
2290: 0003: 
2291: 0003:    STRING GLOBAL							\
2292: 0003: 	LDTCF.FILE.NAME$,						\
2293: 0003: 	LDTCF.VERSION.NO$,                                              \
2294: 0003: 	LDTCF.VERSION.DATE$
2295: 0003: 	
2296: 0003:    INTEGER*2 GLOBAL							\
2297: 0003:         LDTCF.SESS.NUM%,						\
2298: 0003: 	LDTCF.REPORT.NUM%
2299: 0003:  %INCLUDE DRSMQDEC.J86                    ! DLC
2300: 0003: \******************************************************************************
2301: 0003: \******************************************************************************
2302: 0003: \***
2303: 0003: \***      %INCLUDE FOR DIRECTS TEMPORARY STOCK MOVEMENT QUEUE
2304: 0003: \***       FILE FIELD DECLARATIONS
2305: 0003: \***       FILE REFERENCE PARAMETERS
2306: 0003: \***
2307: 0003: \***               FILE TYPE    : Sequential
2308: 0003: \***
2309: 0003: \***               REFERENCE    : DRSMQDEC.J86
2310: 0003: \***
2311: 0003: \***
2312: 0003: \******************************************************************************
2313: 0003: \*******************************************************************************
2314: 0003: \***
2315: 0003: \***  The length of the records on this file vary depending on the record
2316: 0003: \***  transaction type, but they all comprise combinations of the fields
2317: 0003: \***  defined below.
2318: 0003: \***
2319: 0003: \***  Transaction type 17- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
2320: 0003: \***     TIME, SOURCE, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, PAGE
2321: 0003: \***     NUMBER, ITEM COUNT, FIELD DELIMITER, ITEM CODE, BAR CODE,
2322: 0003: \***     QUANTITY - GOOD, FIELD DELIMITER, QUANTITY - DAMAGED, FIELD DELIMITER,
2323: 0003: \***     QUANTITY - STOLEN (the last 8 fields repeat ITEM COUNT times),
2324: 0003: \***     RECORD DELIMITER, END OF RECORD DELIMITER
2325: 0003: \***
2326: 0003: \***  Transaction type 19- RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, DATE,
2327: 0003: \***     TIME, SUPPLIER NUMBER, ORDER NUMBER, ORDER SUFFIX, CONFIRM/AMEND FLAG,
2328: 0003: \***     START TIME, END TIME, NO SINGLES ADDED, NO ITEMS ADDED, NO ITEMS
2329: 0003: \***     BOOKED IN, RECORD DELIMITER, END OF RECORD DELIMITER
2330: 0003: \***
2331: 0003: \*******************************************************************************
2332: 0003: \***
2333: 0003: \***   REVISION 1.0     Neil Bennett                 2nd January 2007
2334: 0003: \***   Add ASN processing support.
2335: 0003: \***
2336: 0003: \*******************************************************************************
2337: 0003: 
2338: 0003:   STRING GLOBAL              \
2339: 0003:     DRSMQ.FILE.NAME$,        \
2340: 0003:     DRSMQ.RECORD$,           \ Used to store the whole record which is unstrung
2341: 0003:                              \ into the fields below
2342: 0003:     DRSMQ.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34))
2343: 0003:     DRSMQ.TRANS.TYPE$,       \ 1 byte UPD.
2344: 0003:                              \             17 = Delivery without confirmation
2345: 0003:                              \                  of Direct Order detail
2346: 0003:                              \             19 = Delivery without confirmation
2347: 0003:                              \                  of Direct Order header
2348: 0003:     DRSMQ.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2349: 0003:     DRSMQ.DATE$,             \ 3 byte UPD set to current date
2350: 0003:     DRSMQ.TIME$,             \ 3 byte UPD set to current time
2351: 0003:     DRSMQ.ITEM.COUNT$,       \ 1 byte UPD between 1 and 17
2352: 0003:     DRSMQ.BOOTS.CODE$,       \ 4 bytes UPD
2353: 0003:     DRSMQ.QUANTITY$,         \ variable length string equivalent to
2354: 0003:                              \ STR$(DRSMQ.QUANTITY%)
2355: 0003:                              \ +ve indicates add to stock
2356: 0003:                              \ -ve indicates subtract from stock
2357: 0003:     DRSMQ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
2358: 0003:     DRSMQ.SUPPLIER.NO$,      \ 4 bytes UPD
2359: 0003:     DRSMQ.ORDER.NO$,         \ 2 bytes UPD
2360: 0003:     DRSMQ.ORDER.SFX$,        \ 1 byte ASCII
2361: 0003:     DRSMQ.PAGE.NO$,          \ 1 byte UPD
2362: 0003:     DRSMQ.ORDER.DATE$,       \ 3 bytes UPD
2363: 0003:     DRSMQ.SOURCE$,           \ 1 byte ASCII Source flag
2364: 0003:                              \ 'S' - PSS65, 'P' - PDT, PSS57
2365: 0003:     DRSMQ.BAR.CODE$,         \ 6 bytes UPD
2366: 0003:     DRSMQ.QTY.GOOD$,         \ VARIABLE ASCII
2367: 0003:                              \ Quantity of singles booked in in good condition
2368: 0003:     DRSMQ.QTY.BAD$,          \ VARIABLE ASCII
2369: 0003:                              \ Quantity of singles booked in in bad condition
2370: 0003:     DRSMQ.QTY.STOLEN$,       \ VARIABLE ASCII
2371: 0003:                              \ Quantity of singles recognised as stolen
2372: 0003:     DRSMQ.CONF.AMND.FLAG$,   \ 1 byte ASCII - Confirm/ Amend Flag
2373: 0003:                              \ 'C' - Order has been confirmed
2374: 0003:                              \ 'A' - Order has been amended
2375: 0003:                              \ ' ' - Nothing has been done to the order
2376: 0003:     DRSMQ.START.TIME$,       \ 2 byte UPD (HHMM) time order started to be
2377: 0003:                              \ processed
2378: 0003:     DRSMQ.END.TIME$,         \ 2 byte UPD (HHMM) time order was completed
2379: 0003:     DRSMQ.SNGLS.ADDED$,      \ 5 bytes ASCII Singles added to order
2380: 0003:     DRSMQ.ITEMS.ADDED$,      \ 5 bytes ASCII Items added to order
2381: 0003:     DRSMQ.ITEMS.BOOKED$,     \ 5 bytes ASCII Items booked in on the order
2382: 0003:     DRSMQ.CARTON.FLAG$,      \ 1 byte  ASCII - ' ' Old Process,             ! 1.0NWB
2383: 0003:                              \                 'N' Normal Book In           ! 1.0NWB
2384: 0003:                              \                 'A' Carton Audit Process     ! 1.0NWB
2385: 0003:                              \                 'E' Exception Process (nof)  ! 1.0NWB
2386: 0003:     DRSMQ.CARTON.NO$         ! 4 bytes UPD (0-9999)                         ! 1.0NWB
2387: 0003: 
2388: 0003: 
2389: 0003:   INTEGER*2 GLOBAL           \
2390: 0003:     DRSMQ.SESS.NUM%,         \
2391: 0003:     DRSMQ.REPORT.NUM%
2392: 0003:  %INCLUDE LDTBFDEC.J86                    ! ELC
2393: 0003: \******************************************************************************
2394: 0003: \***
2395: 0003: \***           %INCLUDE FOR LDTBF - LDT STOCK BUFFER FILE
2396: 0003: \***
2397: 0003: \***                    - FIELD DECLARATIONS   
2398: 0003: \***                    - FILE REFERENCE PARAMETERS  
2399: 0003: \***  
2400: 0003: \***                    REFERENCE: LDTBFDEC.J86
2401: 0003: \***      
2402: 0003: \******************************************************************************
2403: 0003: \***
2404: 0003: \***     Version A:      Mike Kelsall      12th October 1992
2405: 0003: \***
2406: 0003: \***     Each order in the LDTBF is recorded in the following format:
2407: 0003: \***
2408: 0003: \***         Order Header  -  Record Identifier   2  ASC  "OH"
2409: 0003: \***                          Supplier Number     3  UPD
2410: 0003: \***                          Order Number        2  UPD
2411: 0003: \***                          Order Suffix        1  ASC   
2412: 0003: \*** 
2413: 0003: \***  (N x)  Order Record  -  Record Identifier   2  ASC  "OD"
2414: 0003: \***                          Boots/Bar code      6  UPD
2415: 0003: \***                          Damaged Quantity    2  INT
2416: 0003: \***                          Stolen Quantity     2  INT
2417: 0003: \*** 
2418: 0003: \***         Order Trailer -  Record Identifier   2  ASC  "OT"
2419: 0003: \***                          Number of items     2  INT 
2420: 0003: \***
2421: 0003: \***
2422: 0003: \***     Version B.          Stuart Highley            8th August 1997
2423: 0003: \***     Added fields: LDTBF.DATE$, LDTBF.START.TIME$, LDTBF.END.TIME$,
2424: 0003: \***                   LDTBF.LOGGED.QTY%
2425: 0003: \***
2426: 0003: \******************************************************************************
2427: 0003: 
2428: 0003: INTEGER*1 GLOBAL                 \
2429: 0003:                                  \
2430: 0003:            LDTBF.SESS.NUM% 
2431: 0003: 
2432: 0003: 
2433: 0003: INTEGER*2 GLOBAL                 \
2434: 0003:                                  \
2435: 0003:            LDTBF.RECL%,          \
2436: 0003:            LDTBF.REPORT.NUM%,    \
2437: 0003:                                  \
2438: 0003:            LDTBF.LOGGED.QTY%,    \  2 byte INT - Already logged qty    ! BSH
2439: 0003:            LDTBF.DAMAGED.QTY%,   \  2 byte INT - Damaged quantity, from LDT
2440: 0003:            LDTBF.STOLEN.QTY%,    \  2 byte INT - Stolen quantity, from LDT
2441: 0003:            LDTBF.GOOD.QTY%,      \  2 byte INT - Good quantity, from LDT
2442: 0003:            LDTBF.ORDERED.QTY%,   \  2 byte INT - Ordered quantity
2443: 0003:            LDTBF.NUM.OF.ITEMS%   !  2 byte INT - Number of items in order
2444: 0003:      
2445: 0003: 
2446: 0003: STRING GLOBAL                    \
2447: 0003:                                  \
2448: 0003:            LDTBF.FILE.NAME$,     \
2449: 0003:                                  \
2450: 0003:            LDTBF.RECORD.ID$,     \  2 byte ASC - Record Identifier
2451: 0003:            LDTBF.SUPPLIER.NUM$,  \  3 byte UPD - Supplier number, from LDT
2452: 0003:            LDTBF.ORDER.NUM$,     \  2 byte UPD - Order number, from LDT 
2453: 0003:            LDTBF.ORDER.SUFFIX$,  \  1 byte ASC - Order suffix, from LDT
2454: 0003:            LDTBF.DATE$,          \  3 byte UPD - Date booked in        ! BSH
2455: 0003:            LDTBF.START.TIME$,    \  2 byte UPD - Time started booking  ! BSH
2456: 0003:            LDTBF.END.TIME$,      \  2 byte UPD - Time ended booking    ! BSH
2457: 0003:            LDTBF.REF.CODE$       !  6 byte UPD - Boots/Bar code, from LDT
2458: 0003:  %INCLUDE IDSOFDEC.J86                    ! ELC
2459: 0003: REM \
2460: 0003: \******************************************************************************
2461: 0003: \******************************************************************************
2462: 0003: \***
2463: 0003: \***      %INCLUDE FOR CSR OUTSTANDING INITIAL STOCK QUANTITIES FILE
2464: 0003: \***                                             FIELD DECLARATIONS
2465: 0003: \***                                             FILE REFERENCE PARAMETERS
2466: 0003: \***
2467: 0003: \***               FILE TYPE    : Keyed
2468: 0003: \***
2469: 0003: \***               REFERENCE    : IDSOFFLD.J86
2470: 0003: \***
2471: 0003: \***      Version A.     Stephen Kelsey (CTG)               21st October 1992
2472: 0003: \***
2473: 0003: \******************************************************************************
2474: 0003: \*******************************************************************************
2475: 0003: 
2476: 0003:   STRING GLOBAL                  \
2477: 0003:     IDSOF.BC.LETTER$,            \ 1 byte UPD
2478: 0003:     IDSOF.EXP.DELV.DATE$,        \ 3 byte UPD YYMMDD
2479: 0003:     IDSOF.FILE.NAME$,            \
2480: 0003:     IDSOF.FILLER$,               \ 10 bytes ASC
2481: 0003:     IDSOF.ITEM.CODE$             ! 4 byte UPD
2482: 0003: 
2483: 0003:   INTEGER*2 GLOBAL               \
2484: 0003:     IDSOF.QUANTITY%,             \ Outstanding Stock Quantity
2485: 0003:     IDSOF.RECL%,                 \     
2486: 0003:     IDSOF.REPORT.NUM%,           \     
2487: 0003:     IDSOF.SESS.NUM% 
2488: 0003:     
2489: 0003:  %INCLUDE UODDEC.J86                      ! FLC
2490: 0003: \******************************************************************************
2491: 0003: \******************************************************************************
2492: 0003: \***
2493: 0003: \***         %INCLUDE FOR UOD DUMMY FILE I/O SESSION NUMBER
2494: 0003: \***
2495: 0003: \***               REFERENCE    : UODDEC.J86
2496: 0003: \***
2497: 0003: \******************************************************************************
2498: 0003: \*******************************************************************************
2499: 0003: 
2500: 0003:   STRING GLOBAL           \
2501: 0003:     UOD.FILE.NAME$
2502: 0003: 
2503: 0003:   INTEGER*2 GLOBAL        \
2504: 0003:     UOD.REPORT.NUM%,      \
2505: 0003:     UOD.SESS.NUM%
2506: 0003:  %INCLUDE UODBFDEC.J86                    ! FLC
2507: 0003: REM \
2508: 0003: \******************************************************************************
2509: 0003: \******************************************************************************
2510: 0003: \***
2511: 0003: \***      %INCLUDE FOR UOD BUFFER FILE FIELD DECLARATIONS
2512: 0003: \***                              FILE REFERENCE PARAMETERS
2513: 0003: \***
2514: 0003: \***               FILE TYPE    : Sequential
2515: 0003: \***
2516: 0003: \***               REFERENCE    : UODBFDEC.J86
2517: 0003: \***
2518: 0003: \***      Version A.     Michael Kelsall             8th February 1993
2519: 0003: \***
2520: 0003: \******************************************************************************
2521: 0003: \*******************************************************************************
2522: 0003: \***
2523: 0003: \***  The length of the records on this file vary depending on the record
2524: 0003: \***  transaction type, but they all comprise combinations of the fields
2525: 0003: \***  defined below.
2526: 0003: \***
2527: 0003: \***  Transaction type 0 (Header record) - RECORD DELIMITER, TRANS TYPE,       
2528: 0003: \***     FIELD DELIMITER, CREATION DATE, CREATION TIME, RECORD DELIMITER,
2529: 0003: \***     END OF RECORD MARKER.
2530: 0003: \***
2531: 0003: \***  Transaction type 21 - RECORD DELIMITER, TRANS TYPE, DATE, TIME, 
2532: 0003: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
2533: 0003: \***     STATUS, RECORD DELIMITER, END OF RECORD MARKER
2534: 0003: \***
2535: 0003: \***  Transaction type 23 - RECORD DELIMITER, TRANS TYPE, DATE, TIME,
2536: 0003: \***     DISTRIBUTION CENTRE, WAREHOUSE NUMBER, STORE NUMBER, UOD NUMBER,
2537: 0003: \***     STATUS, BOOTS/BAR CODE, BOOTS/BAR CODE FLAG, QUANTITY, 
2538: 0003: \***     FIELD DELIMITER, FSI, FOLIO YEAR, FOLIO MONTH, STORE SUFFIX, 
2539: 0003: \***     FOLIO NO, RECORD DELIMITER, END OF RECORD MARKER
2540: 0003: \***
2541: 0003: \******************************************************************************
2542: 0003: 
2543: 0003:   STRING GLOBAL              \
2544: 0003:     UODBF.FILE.NAME$,	     \
2545: 0003:     UODBF.RECORD$,           \ Used to store the whole record which is unstrung
2546: 0003:                              \ into the fields below
2547: 0003:     UODBF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
2548: 0003:     UODBF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
2549: 0003:     UODBF.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0Ah
2550: 0003:     UODBF.TRANS.TYPE$,       \ 1 byte UPD. 00 = Header record
2551: 0003: 			     \             21 = UOD record
2552: 0003: 			     \             23 = Item Level UOD record
2553: 0003:     UODBF.CREATION.DATE$,    \ 3 byte UPD set to current date
2554: 0003:     UODBF.CREATION.TIME$,    \ 3 byte UPD set to current time
2555: 0003:     UODBF.DATE$,             \ 3 byte UPD set to current date
2556: 0003:     UODBF.TIME$,             \ 3 byte UPD set to current time
2557: 0003:     UODBF.DIST.CENTRE$,      \ 1 byte UPD   
2558: 0003:     UODBF.WAREHOUSE.NUM$,    \ 1 byte UPD   
2559: 0003:     UODBF.STORE.NUM$,        \ 2 byte UPD
2560: 0003:     UODBF.UOD.NUMBER$,       \ 2 byte UPD
2561: 0003:     UODBF.STATUS$,           \ 1 byte ASC.  "B" = Booked in
2562: 0003:     			     \		    "M" = Missing
2563: 0003: 			     \		    "O" = Opened
2564: 0003: 			     \		    "P" = Picking checked
2565: 0003: 			     \		    "R" = Retro booked in
2566: 0003: 			     \		    "D" = Retrospective opened
2567: 0003: 			     \		    "G" = Retrospective checked
2568: 0003: 			     \		    "A" = Automatically booked in
2569: 0003:     UODBF.BOOTS.BAR.CODE$,   \ 6 byte UPD    
2570: 0003:     UODBF.BOOTS.BAR.CODE.FLAG$, \ 1 byte ASC
2571: 0003:     UODBF.FSI$,              \ 1 byte ASCII
2572: 0003:     UODBF.FOLIO.YEAR$,       \ 1 byte UPD
2573: 0003:     UODBF.FOLIO.MONTH$,      \ 1 byte UPD
2574: 0003:     UODBF.FOLIO.NUMBER$,     \ 2 bytes UPD
2575: 0003:     UODBF.STORE.SUFFIX$      ! 1 byte ASCII
2576: 0003: 
2577: 0003: 			     			     			     
2578: 0003:   INTEGER*2 GLOBAL	     \
2579: 0003:     UODBF.SESS.NUM%,         \
2580: 0003:     UODBF.REPORT.NUM%,	     \
2581: 0003:     UODBF.QUANTITY%
2582: 0003: 			     
2583: 0003:  %INCLUDE UODTFDEC.J86                    ! FLC
2584: 0003: \******************************************************************************
2585: 0003: \******************************************************************************
2586: 0003: \***
2587: 0003: \***      %INCLUDE FOR UODS TEMPORARY FILE
2588: 0003: \***       FILE FIELD DECLARATIONS
2589: 0003: \***       FILE REFERENCE PARAMETERS
2590: 0003: \***
2591: 0003: \***               FILE TYPE    : Sequential
2592: 0003: \***
2593: 0003: \***               REFERENCE    : UODTFDEC.J86
2594: 0003: \***
2595: 0003: \***
2596: 0003: \******************************************************************************
2597: 0003: \*******************************************************************************
2598: 0003: 
2599: 0003:   STRING GLOBAL              \
2600: 0003:     UODTF.FILE.NAME$,	     \
2601: 0003:     UODTF.RECORD$            ! Used to store the whole record 
2602: 0003: 			     			     			     
2603: 0003:   INTEGER*2 GLOBAL	     \
2604: 0003:     UODTF.SESS.NUM%,	     \
2605: 0003:     UODTF.REPORT.NUM%			     
2606: 0003: 			     
2607: 0003:  %INCLUDE PILSTDEC.J86                    ! FLC
2608: 0003: 
2609: 0003: \******************************************************************************
2610: 0003: \***
2611: 0003: \***      %INCLUDE FOR PILST - LIST OF LISTS FILE - FIELD DECLARATIONS
2612: 0003: \***                                                FILE REFERENCE PARAMETERS
2613: 0003: \***
2614: 0003: \***                           8th October 1992
2615: 0003: \***
2616: 0003: \******************************************************************************
2617: 0003: 
2618: 0003:    INTEGER*1 GLOBAL             	\
2619: 0003:         PILST.REPORT.NUM%,		\
2620: 0003: 	PILST.SESS.NUM%,		\
2621: 0003: 	PILST.ITEMS.IN.LIST%,		\ No of items in list
2622: 0003: 	PILST.TO.BE.COUNTED%		! No of items left to be counted
2623: 0003: 
2624: 0003:    INTEGER*2 GLOBAL			\
2625: 0003:         PILST.RECL%
2626: 0003: 
2627: 0003:    STRING GLOBAL			\
2628: 0003: 	PILST.FILE.NAME$,		\
2629: 0003: 	PILST.LIST.NUMBER$,		\ 4 byte - list number
2630: 0003: 	PILST.SPARE.LIST.NUMBER$,	\ 4 byte - spare list number
2631: 0003: 	PILST.LIST.NAME$,		\12 byte - list name
2632: 0003: 	PILST.BC.LETTER$,		\ 1 byte - business centre letter
2633: 0003: 	PILST.LIST.TYPE$,		\ 1 byte - list type :
2634: 0003: 					\    "R" = regular,
2635: 0003: 					\    "C" = CSR,
2636: 0003: 					\    "E" = exceptions.
2637: 0003: 	PILST.COUNT.BY.DATE$,		\ 3 byte UPD - count by date
2638: 0003: 	PILST.PRODUCT.GROUP$,		\ 3 byte UPD - product group
2639: 0003: 	PILST.COUNT.DATE$,		\ 3 byte UPD - scheduled count date
2640: 0003: 	PILST.LIST.STATUS$,		\ 1 byte - list status :
2641: 0003: 					\    "C" = to be counted,
2642: 0003: 					\    "R" = to be re-counted,
2643: 0003: 					\    "X" = cancelled,
2644: 0003: 					\    "F" = completed.
2645: 0003: 	PILST.RECOUNT.DATE$,		\ 3 byte UPD - scheduled re-count date
2646: 0003: 	PILST.RECOUNT.ALLOWED$,		\ 1 byte UPD - re-count allowed flag
2647: 0003: 	PILST.CPM.RUN.DATE$,		\ 3 byte UPD - cpm. run date
2648: 0003: 	PILST.PIPLN.RUN.OK$,	        \ 1 byte - PIPLN run ok flag "Y" / "N"
2649: 0003: 	PILST.HIGHEST.LIST.NO$,	        \ 4 byte - highest transmitted list no
2650: 0003:         PILST.DET.FILLER$,              \ 6 bytes
2651: 0003:         PILST.HDR.FILLER$               ! 24 bytes
2652: 0003: 	
2653: 0003:  %INCLUDE PIITMDEC.J86                    ! FLC
2654: 0003: 
2655: 0003: \******************************************************************************
2656: 0003: \***
2657: 0003: \***     %INCLUDE FOR PIITM - ITEM LIST FILE - FIELD DECLARATIONS
2658: 0003: \***                                           FILE REFERENCE PARAMETERS
2659: 0003: \***
2660: 0003: \***     REFERENCE: PIITMDEC.J86
2661: 0003: \***        
2662: 0003: \***                           8TH OCTOBER 1992
2663: 0003: \***
2664: 0003: \******************************************************************************
2665: 0003: 
2666: 0003:    INTEGER*1 GLOBAL							\
2667: 0003: 	PIITM.REPORT.NUM%,						\
2668: 0003: 	PIITM.SESS.NUM%
2669: 0003: 
2670: 0003:    INTEGER*2 GLOBAL			\
2671: 0003: 	PIITM.RECL%,			\
2672: 0003: 	PIITM.DISCREPANCY%,		\ discrepancy
2673: 0003: 	PIITM.DISCREPANCY.AMT%		! discrepancy amount
2674: 0003: 	
2675: 0003:    STRING GLOBAL			\
2676: 0003: 	PIITM.FILE.NAME$,		\
2677: 0003: 	PIITM.LIST.ITEM.KEY$,		\ 4 + 1 bytes - list no. & item no
2678: 0003: 	PIITM.LIST.NUMBER$,		\ 4 byte - list number
2679: 0003: 	PIITM.ITEM.NUMBER$,		\ 2 byte - item number
2680: 0003: 	PIITM.ITEM.CODE$,		\ 4 byte UPD - item code
2681: 0003: 	PIITM.ON.IDF$,			\ 1 byte - on IDF flag "Y" / "N"
2682: 0003: 	PIITM.ACTIVITY.FLAG$,		\ 1 byte - activity flag
2683: 0003: 	PIITM.CYCLE.LENGTH$,		\ 2 byte - count cycle length (weeks)
2684: 0003: 	PIITM.FAMILY.MARKER$,		\ 2 byte - family marker
2685: 0003: 	PIITM.MEMBERS$,			\ 2 byte - number of members
2686: 0003: 	PIITM.ELIGIBILITY.FLAG$,	\ 1 byte - eligibility flag
2687: 0003: 	PIITM.LIST.STATUS$,		\ 1 byte - list status :
2688: 0003: 					\    "C" = to be counted,
2689: 0003: 					\    "R" = to be re-counted,
2690: 0003: 					\    "D" = counted,
2691: 0003: 					\    "F" = completed,
2692: 0003: 					\    "X" = cancelled.
2693: 0003: 	PIITM.POTENTIAL.RECOUNT$,	\ 1 byte - potential recount flag :
2694: 0003: 					\    "0" = not a potential re-count,
2695: 0003: 					\    "1" = failed value test,
2696: 0003: 					\    "2" = failed percentage test.
2697: 0003:         PIITM.FILLER$                   ! 5 bytes
2698: 0003: 					
2699: 0003: !%INCLUDE PDTWFDEC.J86                    ! FLC
2700: 0003: !%INCLUDE IRFDEC.J86                      ! FLC TEST
2701: 0003: 
2702: 0003:  %INCLUDE CCUODDEC.J86                    ! GMJK
2703: 0003: 
2704: 0003: \*****************************************************************************
2705: 0003: \*****************************************************************************
2706: 0003: \***
2707: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2708: 0003: \***
2709: 0003: \***                   FILE TYPE:  KEYED
2710: 0003: \***
2711: 0003: \***                   REFERENCE:  CCUODDEC.J86
2712: 0003: \***
2713: 0003: \***                 DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2714: 0003: \***                   FILE OF OPEN/CLOSED UODS
2715: 0003: \***
2716: 0003: \***
2717: 0003: \***    VERSION A : Michael J. Kelsall      13th September 1993
2718: 0003: \***      
2719: 0003: \***    VERSION B : Mark Walker                   18th Jul 2015
2720: 0003: \***    F392 Retail Stock 5
2721: 0003: \***    Added CCUOD.RETRIEVAL.FLAG$ field to allow record to be
2722: 0003: \***    marked as processed.
2723: 0003: \***
2724: 0003: \*****************************************************************************
2725: 0003: \*****************************************************************************
2726: 0003: 
2727: 0003: STRING GLOBAL           \
2728: 0003:    CCUOD.FILE.NAME$,        \
2729: 0003:    CCUOD.UOD.NUM$,      \  7 byte UPD;  Record key
2730: 0003:    CCUOD.STATUS$,       \  1 byte ASC;  "O" = Open,
2731: 0003:                 \           "C" = Closed,
2732: 0003:                 \           "D" = Despatched,       
2733: 0003:                 \           "X" = Cancelled.
2734: 0003:    CCUOD.CREDIT.CLAIM.NUM$, \  4 byte UPD
2735: 0003:                 \  CCUOD.NUM.OF.ITEMS% here (I2)
2736: 0003:    CCUOD.SUPPLY.ROUTE$,     \  1 byte ASC;  "W" = Warehouse,
2737: 0003:                 \           "E" = EPSOM,
2738: 0003:                 \           "O" = Other Directs,
2739: 0003:                 \               "D" = Dispensary.
2740: 0003:    CCUOD.DISP.LOCATION$,    \  1 byte ASC   "M" = MDS, "D" = Dispensary.
2741: 0003:    CCUOD.BC.LETTER$,        \  1 byte ASC    
2742: 0003:    CCUOD.RECALL.NUM$,       \  8 byte ASC
2743: 0003:    CCUOD.AUTHORISATION$,    \ 15 byte ASC
2744: 0003:    CCUOD.SUPPLIER$,     \ 15 byte ASC
2745: 0003:    CCUOD.METHOD.OF.RETURN$, \  1 byte UPD;   1 = Carrier,
2746: 0003:                 \                2 = BIRD,
2747: 0003:                 \        3 = Via D6,
2748: 0003:                 \        4 = Representative.
2749: 0003:    CCUOD.CARRIER$,      \  1 byte UPD;   1 = GPO,
2750: 0003:                 \                2 = Parcelforce,
2751: 0003:                 \        3 = Securicor,
2752: 0003:                 \        4 = Other.
2753: 0003:    CCUOD.BIRD.NUM$,     \  8 byte ASC                   
2754: 0003:    CCUOD.REASON.NUM$,       \  1 byte UPD     (See CSRNS declaration)
2755: 0003:    CCUOD.RECEIVING.STORE$,  \  2 byte UPD    
2756: 0003:    CCUOD.DESTINATION$,      \  1 byte UPD    1 = Business Centre, 
2757: 0003:                 \            2 = MTS,
2758: 0003:                 \        3 = Pharmacy, 
2759: 0003:                 \        4 = Other.
2760: 0003:    CCUOD.WAREHOUSE.ROUTE$,  \  1 byte ASC   "R" = RDC, "C" = CSR.
2761: 0003:    CCUOD.UOD.TYPE$,     \  1 byte UPD    1 = Travel Outer,
2762: 0003:                 \        2 = Town tray,
2763: 0003:                 \        3 = Roll cage,
2764: 0003:                 \                4 = Other.
2765: 0003:    CCUOD.DAMAGE.REASON$,         \  1 byte UPD    1 = Bad packaging,    
2766: 0003:                 \        2 = Poor handling.
2767: 0003:    CCUOD.DATE.UOD.OPENED$,  \  3 byte UPD 
2768: 0003:    CCUOD.DATE.UOD.DESPATCHED$,  \  3 byte UPD
2769: 0003:    CCUOD.TIME.UOD.DESPATCHED$,  \  3 byte UPD
2770: 0003:    CCUOD.RETRIEVAL.FLAG$, \  1 byte ASC;  " " = to be retrieved             !BMW
2771: 0003:                           \               "N" = marked as processed         !BMW
2772: 0003:    CCUOD.FILLER$,       \ 19 byte ASC;   Spaces.
2773: 0003:                 \
2774: 0003:                 \
2775: 0003:                 \
2776: 0003:    CCUOD.HEADER$,       \   Hdr rec layout; (key of High values)
2777: 0003:    CCUOD.DATE.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2778: 0003:    CCUOD.TIME.FILE.UPDATED$,    \  3 byte UPD (all 9's if empty file created)
2779: 0003:    CCUOD.LDT.NUM$,      \  3 byte UPD (Zeros if no outstanding data
2780: 0003:                 \              to be processed by PSS35)
2781: 0003:    CCUOD.HEADER.FILLER$     ! 84 byte ASC;  Spaces.
2782: 0003: 
2783: 0003: 
2784: 0003: INTEGER*2 GLOBAL        \
2785: 0003:    CCUOD.RECL%,         \
2786: 0003:    CCUOD.REPORT.NUM%,       \
2787: 0003:    CCUOD.SESS.NUM%,     \
2788: 0003:                 \
2789: 0003:    CCUOD.NUM.OF.ITEMS%      ! 2 byte INT
2790: 0003: 
2791: 0003:  %INCLUDE CCLAMDEC.J86                    ! 1.4
2792: 0003: 
2793: 0003: \*****************************************************************************
2794: 0003: \*****************************************************************************
2795: 0003: \***
2796: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2797: 0003: \***
2798: 0003: \***                   FILE TYPE:  KEYED
2799: 0003: \***
2800: 0003: \***                   REFERENCE:  CCLAMDEC.J86
2801: 0003: \***
2802: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2803: 0003: \***				   FILE OF CURRENT CREDIT CLAIMS
2804: 0003: \***
2805: 0003: \***
2806: 0003: \***      VERSION A : Michael J. Kelsall      16th December 1993
2807: 0003: \***      
2808: 0003: \*****************************************************************************
2809: 0003: \*****************************************************************************
2810: 0003: 
2811: 0003: STRING GLOBAL			\
2812: 0003:    CCLAM.FILE.NAME$,		\
2813: 0003:    CCLAM.CREDIT.CLAIM.NUM$,	\  4 byte UPD;   Record Key
2814: 0003:    CCLAM.UOD.NUM$,		\  7 byte UPD
2815: 0003:    				\  CCLAM.NUM.OF.ITEMS% here (I2)
2816: 0003:    CCLAM.SUPPLY.ROUTE$,		\  1 byte ASC;  "W" = Warehouse,
2817: 0003:    				\ 	        "E" = EPSOM,
2818: 0003: 				\	        "O" = Other Directs,
2819: 0003: 				\               "D" = Dispensary.
2820: 0003:    CCLAM.DISP.LOCATION$,	\  1 byte ASC   "M" = MDS, "D" = Dispensary.
2821: 0003:    CCLAM.BC.LETTER$,		\  1 byte ASC    
2822: 0003:    CCLAM.RECALL.NUM$,		\  8 byte ASC
2823: 0003:    CCLAM.AUTHORISATION$,	\ 15 byte ASC
2824: 0003:    CCLAM.SUPPLIER$,		\ 15 byte ASC
2825: 0003:    CCLAM.METHOD.OF.RETURN$,	\  1 byte UPD;   1 = Carrier,
2826: 0003:    				\                2 = BIRD,
2827: 0003: 				\	 	 3 = Via D6,
2828: 0003: 				\		 4 = Representative.
2829: 0003:    CCLAM.CARRIER$,		\  1 byte UPD;   1 = GPO,
2830: 0003:    				\                2 = Parcelforce,
2831: 0003: 				\	 	 3 = Securicor,
2832: 0003: 				\ 		 4 = Other.
2833: 0003:    CCLAM.BIRD.NUM$,		\  8 byte ASC					
2834: 0003:    CCLAM.REASON.NUM$,		\  1 byte UPD     (See CSRNS declaration)
2835: 0003:    CCLAM.RECEIVING.STORE$,	\  2 byte UPD    
2836: 0003:    CCLAM.DESTINATION$,		\  1 byte UPD    1 = Business Centre, 
2837: 0003:    				\	         2 = MTS,
2838: 0003:    				\		 3 = Pharmacy, 
2839: 0003: 				\		 4 = Other.
2840: 0003:    CCLAM.WAREHOUSE.ROUTE$,	\  1 byte ASC   "R" = RDC, "C" = CSR.
2841: 0003:    CCLAM.UOD.TYPE$,		\  1 byte UPD    1 = Travel Outer,
2842: 0003:    				\		 2 = Town tray,
2843: 0003: 				\		 3 = Roll cage,
2844: 0003: 				\     	         4 = Other.
2845: 0003:    CCLAM.DAMAGE.REASON$,        \  1 byte UPD    1 = Bad packaging,	
2846: 0003:    				\		 2 = Poor handling.
2847: 0003:    CCLAM.INVOICE.NUM$,		\* 9 byte ASC 
2848: 0003:    CCLAM.FOLIO.NUM$,		\  3 byte UPD
2849: 0003:    CCLAM.BATCH.REF$,		\  3 byte UPD
2850: 0003:    CCLAM.WHOLE.PART.CON$,       \  1 byte ASC   "W" = Whole, "P" = Part
2851: 0003:    CCLAM.REPAIR.CATEGORY$, 	\  1 byte UPD;   1 = Plan4,
2852: 0003:    				\   		 2 = Estimate,
2853: 0003: 				\		 3 = Boots guarantee,
2854: 0003: 				\		 4 = Supplier guarantee,
2855: 0003: 				\		 5 = Other guarantee,
2856: 0003:    CCLAM.REPAIR.NUM$,		\  6 byte UPD
2857: 0003:    CCLAM.PLAN4.POLICY.NUM$,	\  6 byte UPD 
2858: 0003:    CCLAM.DDDA.DCDR.NUM$,	\  4 byte UPD
2859: 0003:    CCLAM.DELIV.NOTE.NUM$,	\* 9 byte ASC
2860: 0003:    CCLAM.DELIV.DATE$,		\  3 byte UPD
2861: 0003:    CCLAM.NUM.CARTONS.RECEIV$,	\  1 byte UPD
2862: 0003:    CCLAM.ORDER.NUM$,		\  7 byte ASC
2863: 0003:    CCLAM.COMMENT$,  		\*20 byte ASC
2864: 0003:    CCLAM.DATE.OF.CLAIM$,	\  3 byte UPD;  Date of UOD despatch
2865: 0003:    CCLAM.TIME.OF.CLAIM$,	\  3 byte UPD;  Time of UOD despatch
2866: 0003:    CCLAM.RETRIEVAL.FLAG$,	\  1 byte ASC;  "Y", "N"  PSS35 sets to Y
2867: 0003:    				\                         PSB30 sets to N
2868: 0003:    CCLAM.CF.RPT.MARKER$,	\  1 byte ASC;  "Y"       PSS35 sets to Y
2869: 0003:    				\               "N"       PSS20 sets to N
2870: 0003:    CCLAM.CANC.MARKER$,		\  1 byte ASC;  Y or N
2871: 0003:    CCLAM.FILLER$		!  7 byte ASC;  Spaces.
2872: 0003: 
2873: 0003: 
2874: 0003: INTEGER*2 GLOBAL		\
2875: 0003:    CCLAM.RECL%,			\
2876: 0003:    CCLAM.REPORT.NUM%,		\
2877: 0003:    CCLAM.SESS.NUM%,		\
2878: 0003: 				\
2879: 0003:    CCLAM.NUM.OF.ITEMS%		!  2 byte INT
2880: 0003: 
2881: 0003:  %INCLUDE CCITMDEC.J86                    ! GMJK
2882: 0003: 
2883: 0003: \*****************************************************************************
2884: 0003: \*****************************************************************************
2885: 0003: \***
2886: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2887: 0003: \***
2888: 0003: \***                   FILE TYPE:  KEYED
2889: 0003: \***
2890: 0003: \***                   REFERENCE:  CCUODITM.J86
2891: 0003: \***
2892: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2893: 0003: \***				   FILE OF ITEMS PER OPEN/CLOSED UOD
2894: 0003: \***
2895: 0003: \***
2896: 0003: \***      VERSION A : Michael J. Kelsall      13th September 1993
2897: 0003: \***      
2898: 0003: \*****************************************************************************
2899: 0003: \*****************************************************************************
2900: 0003: 
2901: 0003: STRING GLOBAL			\
2902: 0003:    CCITM.FILE.NAME$,		\
2903: 0003:    CCITM.KEY$,			\  Consists of next two fields;
2904: 0003:    CCITM.UOD.NUM$,		\  7 byte UPD
2905: 0003:    CCITM.ITEM.NUM$,		\  2 byte UPD
2906: 0003:    				\
2907: 0003:    CCITM.BOOTS.BAR.CODE.FLAG$,	\  1 byte ASC;  "I" = Boots code,
2908: 0003:    				\		"B" = Bar code.
2909: 0003:    CCITM.BOOTS.BAR.CODE$,	\  7 byte UPD
2910: 0003:    				\  CCITM.QTY% here (I2)
2911: 0003:    CCITM.FILLER$                !  4 byte ASC;  Spaces
2912: 0003:       				
2913: 0003: 
2914: 0003: INTEGER*2 GLOBAL		\
2915: 0003:    CCITM.RECL%,			\
2916: 0003:    CCITM.REPORT.NUM%,		\
2917: 0003:    CCITM.SESS.NUM%,		\
2918: 0003: 				\
2919: 0003:    CCITM.QTY%			!  2 byte INT
2920: 0003: 
2921: 0003:  %INCLUDE CCTRLDEC.J86                    ! GMJK
2922: 0003: 
2923: 0003: \*****************************************************************************
2924: 0003: \*****************************************************************************
2925: 0003: \***
2926: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
2927: 0003: \***
2928: 0003: \***                   FILE TYPE:  DIRECT
2929: 0003: \***
2930: 0003: \***                   REFERENCE:  CCTRLDEC.J86
2931: 0003: \***
2932: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
2933: 0003: \***				   CREDIT CLAIMS CONTROL FILE
2934: 0003: \***
2935: 0003: \***
2936: 0003: \***      VERSION A : Michael J. Kelsall      14th September 1993
2937: 0003: \***      
2938: 0003: \*****************************************************************************
2939: 0003: \*****************************************************************************
2940: 0003: 
2941: 0003: STRING GLOBAL			\
2942: 0003:    CCTRL.FILE.NAME$,		\
2943: 0003:    CCTRL.RECORD$,		\
2944: 0003:    CCTRL.CREDIT.CLAIM.NUM$,	\  4 byte UPD
2945: 0003:    CCTRL.CREDIT.RPT.RUN.DATE$,	\  3 byte UPD
2946: 0003:    CCTRL.UOD.RPT.RUN.DATE$,	\  3 byte UPD
2947: 0003:    CCTRL.FILLER$		! 65 byte ASC;  Spaces
2948: 0003:    
2949: 0003: 
2950: 0003: INTEGER*2 GLOBAL		\
2951: 0003:    CCTRL.RECL%,			\
2952: 0003:    CCTRL.REPORT.NUM%,		\
2953: 0003:    CCTRL.SESS.NUM%,		\
2954: 0003:    CCTRL.REC.NUM%
2955: 0003: 
2956: 0003: INTEGER*4 GLOBAL		\
2957: 0003:    CCTRL.STAFF.SALES%		!  4 INT, total sales to store staff,
2958: 0003:    				!  stored as 5 byte UPD on file
2959: 0003: 
2960: 0003:  %INCLUDE CCTMPDEC.J86                    ! GMJK
2961: 0003: REM \
2962: 0003: \******************************************************************************
2963: 0003: \******************************************************************************
2964: 0003: \***
2965: 0003: \***      %INCLUDE FOR CREDIT CLAIMING TEMPORARY FILE FIELD DECLARATIONS
2966: 0003: \***                                             FILE REFERENCE PARAMETERS
2967: 0003: \***
2968: 0003: \***               FILE TYPE    : Sequential
2969: 0003: \***
2970: 0003: \***               REFERENCE    : CCTMPDEC.J86
2971: 0003: \***
2972: 0003: \***      Version A.     Michael J. Kelsall           30th September 1993.
2973: 0003: \***
2974: 0003: \***      Version 1.1    Brian Greenfield             14th May 2007
2975: 0003: \***      Added new variable CCTMP.RECALL.TYPE$ for A7C Recalls.
2976: 0003: \***
2977: 0003: \******************************************************************************
2978: 0003: \*******************************************************************************
2979: 0003: \***
2980: 0003: \***  The length of the records on this file vary depending on the record
2981: 0003: \***  transaction type, but they all comprise combinations of the fields
2982: 0003: \***  defined below.
2983: 0003: \***
2984: 0003: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
2985: 0003: \***
2986: 0003: \***  Transaction type 24 - Whole or Part consignment record
2987: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
2988: 0003: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
2989: 0003: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
2990: 0003: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
2991: 0003: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
2992: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
2993: 0003: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
2994: 0003: \***
2995: 0003: \***  Transaction type 26 - Data from LDT
2996: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
2997: 0003: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
2998: 0003: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
2999: 0003: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
3000: 0003: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
3001: 0003: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
3002: 0003: \***     DESPATCHED, RECALL.TYPE$, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY,       ! 1.1BG
3003: 0003: \***     ITEM UPDATED FLAG, RECORD DELIMITER, END OF RECORD MARKER
3004: 0003: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
3005: 0003: \***
3006: 0003: \***  Transaction type 28 - Cancelled Credit Claim
3007: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
3008: 0003: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
3009: 0003: \***
3010: 0003: \******************************************************************************
3011: 0003: 
3012: 0003:   STRING GLOBAL              \
3013: 0003:     CCTMP.FILE.NAME$,        \
3014: 0003:     CCTMP.RECORD$,           \ Used to store the whole record which is unstrung
3015: 0003:                              \ into the fields below
3016: 0003:     CCTMP.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
3017: 0003:     CCTMP.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
3018: 0003:                  \             25 = NS16 / Misc cont txn (R/ACC)
3019: 0003:                  \             26 = Data from LDT (R/ACC)
3020: 0003:                  \             27 = End of LDT session (R/ACC)
3021: 0003:                  \         28 = Canc. Credit Claim (R/ACC)
3022: 0003:     CCTMP.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
3023: 0003:     CCTMP.ENDREC.MARKER$,    \ 2 bytes ASCII set to 0D0AH
3024: 0003:     CCTMP.BC.LETTER$,        \ 1 byte ASCII
3025: 0003:     CCTMP.CREDIT.CLAIM.NUM$, \ 4 byte UPD
3026: 0003:     CCTMP.NUM.ITEMS.UPDATED$,\ 4 byte ASCII
3027: 0003:     CCTMP.TOTAL.QTY.IN.UOD$, \ 4 byte ASCII
3028: 0003:     CCTMP.CLAIM.TYPE$,       \ 1 byte ASC;  "M" = Missing,
3029: 0003:                      \          "E" = Excess,
3030: 0003:                  \              "R" = Repairs
3031: 0003:     CCTMP.SUPPLIER.NUM$,     \ 3 byte UPD
3032: 0003:     CCTMP.INVOICE.NUM$,      \ 3 byte UPD 
3033: 0003:     CCTMP.FOLIO.NUM$,        \ 3 byte UPD
3034: 0003:     CCTMP.BATCH.REF$,        \ 3 byte UPD
3035: 0003:     CCTMP.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
3036: 0003:                  \           2 = Estimate,
3037: 0003:                  \           3 = Boots guarantee,
3038: 0003:                  \           4 = Supplier guarantee,
3039: 0003:                  \           5 = Other guarantee,
3040: 0003:     CCTMP.REPAIR.NUM$,       \ 4 byte UPD
3041: 0003:     CCTMP.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
3042: 0003:     CCTMP.DDDA.DCDR.NUM$,    \ 3 byte UPD
3043: 0003:     CCTMP.DELIV.NOTE.NUM$,   \ 3 byte UPD
3044: 0003:     CCTMP.NUM.CARTONS.RECEIV$,\1 byte UPD
3045: 0003:     CCTMP.ORDER.NUM$,        \ 3 byte UPD
3046: 0003:     CCTMP.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
3047: 0003:                  \              "B" = Barcode.
3048: 0003:     CCTMP.ITEM.BARCODE$,     \ 7 byte UPD
3049: 0003:     CCTMP.ITEM.PRICE$,       \ 3 byte UPD;  Spaces.
3050: 0003:     CCTMP.AUTHORISATION$,    \ 15 byte ASC
3051: 0003:     CCTMP.ADJ.STOCK.FIGURE$, \ 1 byte ASC  "Y" or "N"
3052: 0003:     CCTMP.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
3053: 0003:     CCTMP.UOD.NUM$,      \ 7 byte UPD
3054: 0003:     CCTMP.UOD.STATUS$,       \ 1 byte ASC;  "O" = Open,
3055: 0003:                      \              "C" = Closed,
3056: 0003:                  \              "D" = Despatched
3057: 0003:     CCTMP.PREVIOUS.STATUS$,  \ 1 byte ASC   "O" = Open,
3058: 0003:                      \              "C" = Closed
3059: 0003:     CCTMP.SUPPLY.ROUTE$,     \ 1 byte ASC
3060: 0003:     CCTMP.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
3061: 0003:                      \              "D" = Dispensary
3062: 0003:     CCTMP.RECALL.NUM$,       \ 9 byte ASC 
3063: 0003:     CCTMP.SUPPLIER$,         \ 15 byte ASC
3064: 0003:     CCTMP.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
3065: 0003:                      \           2 = BIRD,
3066: 0003:                  \               3 = Via D6,
3067: 0003:                  \               4 = Representative
3068: 0003:     CCTMP.CARRIER$,      \ 1 byte UPD;   1 = GPO,
3069: 0003:                      \               2 = Parcelforce,
3070: 0003:                  \               3 = Securicor,
3071: 0003:                  \               4 = Other
3072: 0003:     CCTMP.BIRD.NUM$,         \ 8 byte ASC
3073: 0003:     CCTMP.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
3074: 0003:                      \          "C" = CSR
3075: 0003:     CCTMP.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
3076: 0003:                      \               2 = Town Tray,
3077: 0003:                  \               3 = Roll cage,
3078: 0003:                  \               4 = Other
3079: 0003:     CCTMP.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
3080: 0003:                      \               2 = Poor handling
3081: 0003:     CCTMP.RECEIVING.STORE$,  \ 2 byte UPD
3082: 0003:     CCTMP.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
3083: 0003:                      \               2 = MTS,
3084: 0003:                  \               3 = Other
3085: 0003:     CCTMP.DATE.UOD.OPENED$,  \ 3 byte UPD
3086: 0003:     CCTMP.DATE.DESPATCHED$,  \ 3 byte UPD
3087: 0003:     CCTMP.TIME.DESPATCHED$,  \ 3 byte UPD
3088: 0003:     CCTMP.ITEM.UPDATED$,     \ 1 byte ASC
3089: 0003:     CCTMP.NEW.STATUS.FLAG$,  \ 1 byte ASC   "C" = Closed,
3090: 0003:                      \          "D" = Despatched,
3091: 0003:                  \          "X" = Cancelled
3092: 0003:     CCTMP.ITEM.QTY$,         \ 3 byte ASCII              
3093: 0003:     CCTMP.RECALL.TYPE$       ! 1 byte ASCII "B" = Batch Recall              ! 1.1BG
3094: 0003:                              !              "N" = Non-batch Recall          ! 1.1BG
3095: 0003:                              !              " " = Old Credit Claim          ! 1.1BG
3096: 0003:     
3097: 0003:                                                  
3098: 0003:   INTEGER*2 GLOBAL           \
3099: 0003:     CCTMP.SESS.NUM%,         \
3100: 0003:     CCTMP.REPORT.NUM%,       \
3101: 0003:                      \
3102: 0003:     CCTMP.NUM.OF.ITEMS%,     \
3103: 0003:     CCTMP.NUM.ITEMS.UPDATED%,\ 
3104: 0003:     CCTMP.TOTAL.QTY.IN.UOD%  !
3105: 0003:                          
3106: 0003:                  
3107: 0003:  %INCLUDE CCBUFDEC.J86                    ! GMJK
3108: 0003: REM \
3109: 0003: \******************************************************************************
3110: 0003: \******************************************************************************
3111: 0003: \***
3112: 0003: \***      %INCLUDE FOR CREDIT CLAIMING BUFFER FILE FIELD DECLARATIONS
3113: 0003: \***                                          FILE REFERENCE PARAMETERS
3114: 0003: \***
3115: 0003: \***               FILE TYPE    : Sequential
3116: 0003: \***
3117: 0003: \***               REFERENCE    : CCBUFDEC.J86
3118: 0003: \***
3119: 0003: \***      Version A.     Michael J. Kelsall           30th September 1993.
3120: 0003: \***
3121: 0003: \******************************************************************************
3122: 0003: \*******************************************************************************
3123: 0003: \***
3124: 0003: \***  The length of the records on this file vary depending on the record
3125: 0003: \***  transaction type, but they all comprise combinations of the fields
3126: 0003: \***  defined below.
3127: 0003: \***
3128: 0003: \***  RETURNS/AUTOMATIC CREDIT CLAIMING RECORD TYPES;
3129: 0003: \***
3130: 0003: \***  Transaction type 24 - Whole or Part consignment record
3131: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CREDIT CLAIM NUM, 
3132: 0003: \***     BC LETTER, CLAIM TYPE, SUPPLIER NUM, INVOICE NUM, FOLIO NUM, 
3133: 0003: \***     BATCH REF NUM, REPAIR CATEGORY, REPAIR NUM, PLAN4 POLICY NUM, 
3134: 0003: \***     DDDA/DCDR NUM, DELIV NOTE NUM, DELIV DATE, NUM OF CARTONS, ORDER NUM,
3135: 0003: \***     NUM OF ITEMS, ITEM/BAR CODE FLAG, BOOTS/BAR CODE, QTY, PRICE, 
3136: 0003: \***     RECORD DELIMITER, END OF RECORD MARKER
3137: 0003: \***     (ITEM/BAR CODE FLAG to PRICE repeated NUM OF ITEMS times)
3138: 0003: \***
3139: 0003: \***  Transaction type 26 - Data from LDT
3140: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, UOD NUM, UOD STATUS, 
3141: 0003: \***     CREDIT CLAIM NUM, NUM OF ITEMS UPDATED, TOTAL QTY IN UOD, 
3142: 0003: \***     ADJUST STOCK FIGURE FLAG, SUPPLY ROUTE, DISP LOCATION, BC LETTER, 
3143: 0003: \***     RECALL NUM, AUTHORISATION, SUPPLIER, RETURN METHOD, CARRIER, BIRD NUM,
3144: 0003: \***     REASON, WAREHOUSE ROUTE, UOD TYPE, REASON FOR DAMAGE, RECEIVING STORE,
3145: 0003: \***     DESTINATION, DATE UOD OPENED, DATE UOD DESPATCHED, TIME UOD 
3146: 0003: \***     DESPATCHED, ITEM.BAR CODE FLAG, BOOTS/BAR CODE, QTY, ITEM UPDATED 
3147: 0003: \***     FLAG, RECORD DELIMITER, END OF RECORD MARKER
3148: 0003: \***     (ITEM/BAR CODE FLAG to ITEM UPDATED FLAG repeated NUM OF ITEMS times)
3149: 0003: \***
3150: 0003: \***  Transaction type 28 - Cancelled Credit Claim
3151: 0003: \***     RECORD DELIMITER, TRANS TYPE, FIELD DELIMITER, CLAIM NUMBER, UOD
3152: 0003: \***     NUM, NEW STATUS FLAG, RECORD DELIMITER, END OF RECORD MARKER
3153: 0003: \***
3154: 0003: \******************************************************************************
3155: 0003: 
3156: 0003:   STRING GLOBAL              \
3157: 0003:     CCBUF.FILE.NAME$,        \
3158: 0003:     CCBUF.RECORD$,           \ Used to store the whole record which is unstrung
3159: 0003:                              \ into the fields below
3160: 0003:     CCBUF.RECORD.DELIMITER$, \ 1 byte ASCII set to " (CHR$(34)) 
3161: 0003:     CCBUF.TRANS.TYPE$,       \ 1 byte UPD. 24 = Whole/Part consignment (R/ACC)
3162: 0003: 			     \             25 = NS16 / Misc cont txn (R/ACC)
3163: 0003: 			     \	           26 = Data from LDT (R/ACC)
3164: 0003: 			     \             27 = End of LDT session (R/ACC)
3165: 0003: 			     \		   28 = Canc. Credit Claim (R/ACC)
3166: 0003:     CCBUF.FIELD.DELIMITER$,  \ 1 byte ASCII set to ; (CHR$(59))
3167: 0003:     CCBUF.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
3168: 0003:     CCBUF.BC.LETTER$,        \ 1 byte ASCII
3169: 0003:     CCBUF.CREDIT.CLAIM.NUM$, \ 4 byte UPD
3170: 0003:     CCBUF.CLAIM.TYPE$,	     \ 1 byte ASC;  "M" = Missing,
3171: 0003:     			     \		    "E" = Excess,
3172: 0003: 			     \              "R" = Repairs
3173: 0003:     CCBUF.SUPPLIER.NUM$,     \ 3 byte UPD
3174: 0003:     CCBUF.INVOICE.NUM$,	     \ 3 byte UPD 
3175: 0003:     CCBUF.FOLIO.NUM$,	     \ 3 byte UPD
3176: 0003:     CCBUF.BATCH.REF$,	     \ 3 byte UPD
3177: 0003:     CCBUF.REPAIR.CATEGORY$,  \ 1 byte UPD;   1 = Plan4,
3178: 0003:    			     \ 		     2 = Estimate,
3179: 0003: 			     \		     3 = Boots guarantee,
3180: 0003: 			     \		     4 = Supplier guarantee,
3181: 0003: 			     \		     5 = Other guarantee,
3182: 0003:     CCBUF.REPAIR.NUM$,       \ 4 byte UPD
3183: 0003:     CCBUF.PLAN4.POLICY.NUM$, \ 6 byte UPD; (Only if repair cat is Plan4)
3184: 0003:     CCBUF.DDDA.DCDR.NUM$,    \ 3 byte UPD
3185: 0003:     CCBUF.DELIV.NOTE.NUM$,   \ 3 byte UPD
3186: 0003:     CCBUF.NUM.CARTONS.RECEIV$,\1 byte UPD
3187: 0003:     CCBUF.ORDER.NUM$,	     \ 3 byte UPD
3188: 0003:     CCBUF.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
3189: 0003:   			     \              "B" = Barcode.
3190: 0003:     CCBUF.ITEM.BARCODE$,     \ 7 byte UPD
3191: 0003:     CCBUF.ITEM.PRICE$,	     \ 3 byte UPD;  Spaces.
3192: 0003:     CCBUF.AUTHORISATION$,    \ 15 byte ASC
3193: 0003:     CCBUF.ADJ.STOCK.FIGURE$, \ 1 byte ASC;  "Y" or "N"
3194: 0003:     CCBUF.RETURN.REASON$,    \ 1 byte UPD;  (See CCRSN file)
3195: 0003:     CCBUF.UOD.NUM$,	     \ 7 byte UPD
3196: 0003:     CCBUF.UOD.STATUS$,	     \ 1 byte ASC;  "O" = Open,
3197: 0003:     			     \              "C" = Closed,
3198: 0003: 			     \              "D" = Despatched
3199: 0003:     CCBUF.SUPPLY.ROUTE$,     \ 1 byte ASC
3200: 0003:     CCBUF.DISP.LOCATION$,    \ 1 byte ASC   "M" = MDS,
3201: 0003:     			     \              "D" = Dispensary
3202: 0003:     CCBUF.RECALL.NUM$,       \ 9 byte ASC 
3203: 0003:     CCBUF.SUPPLIER$,	     \ 15 byte ASC
3204: 0003:     CCBUF.RETURN.METHOD$,    \ 1 byte UPD;   1 = Carrier,
3205: 0003:     			     \		     2 = BIRD,
3206: 0003: 			     \               3 = Via D6,
3207: 0003: 			     \               4 = Representative
3208: 0003:     CCBUF.CARRIER$,	     \ 1 byte UPD;   1 = GPO,
3209: 0003:     			     \               2 = Parcelforce,
3210: 0003: 			     \               3 = Securicor,
3211: 0003: 			     \               4 = Other
3212: 0003:     CCBUF.BIRD.NUM$,	     \ 8 byte ASC
3213: 0003:     CCBUF.WAREHOUSE.ROUTE$,  \ 1 byte ASC   "R" = RDC,
3214: 0003:     			     \  	    "C" = CSR
3215: 0003:     CCBUF.UOD.TYPE$,         \ 1 byte UPD;   1 = Travel Outer,
3216: 0003:     			     \               2 = Town Tray,
3217: 0003: 			     \               3 = Roll cage,
3218: 0003: 			     \               4 = Other
3219: 0003:     CCBUF.DAMAGE.REASON$,    \ 1 byte UPD    1 = Bad packaging,
3220: 0003:      			     \               2 = Poor handling
3221: 0003:     CCBUF.RECEIVING.STORE$,  \ 2 byte UPD
3222: 0003:     CCBUF.DESTINATION$,      \ 1 byte UPD    1 = Business Centre,
3223: 0003:     			     \               2 = MTS,
3224: 0003: 			     \               3 = Other
3225: 0003:     CCBUF.DATE.UOD.OPENED$,  \ 3 byte UPD
3226: 0003:     CCBUF.DATE.DESPATCHED$,  \ 3 byte UPD
3227: 0003:     CCBUF.TIME.DESPATCHED$,  \ 3 byte UPD
3228: 0003:     CCBUF.ITEM.UPDATED$,     \ 1 byte ASC
3229: 0003:     CCBUF.NEW.STATUS.FLAG$   \ 1 byte ASC   "C" = Closed,
3230: 0003:     			     \   	    "D" = Despatched,
3231: 0003: 			     !    	    "X" = Cancelled
3232: 0003:     
3233: 0003: 			     			     			     
3234: 0003:   INTEGER*2 GLOBAL           \
3235: 0003:     CCBUF.SESS.NUM%,         \
3236: 0003:     CCBUF.REPORT.NUM%,	     \
3237: 0003:     			     \
3238: 0003:     CCBUF.NUM.OF.ITEMS%,     \
3239: 0003:     CCBUF.NUM.ITEMS.UPDATED%,\
3240: 0003:     CCBUF.QTY%,		     \
3241: 0003:     CCBUF.TOTAL.QTY.IN.UOD%  !
3242: 0003:         			     
3243: 0003: 			     
3244: 0003:  %INCLUDE CCUPFDEC.J86                    ! HMJK
3245: 0003: 
3246: 0003: \*****************************************************************************
3247: 0003: \*****************************************************************************
3248: 0003: \***
3249: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
3250: 0003: \***
3251: 0003: \***                   FILE TYPE:  KEYED
3252: 0003: \***
3253: 0003: \***                   REFERENCE:  CCUPFDEC.J86
3254: 0003: \***
3255: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
3256: 0003: \***				   UOD PROCESSED FILE
3257: 0003: \***
3258: 0003: \***
3259: 0003: \***      VERSION A : Michael J. Kelsall      14th March 1994
3260: 0003: \***      
3261: 0003: \*****************************************************************************
3262: 0003: \*****************************************************************************
3263: 0003: 
3264: 0003: STRING GLOBAL			\
3265: 0003:    CCUPF.FILE.NAME$,		\
3266: 0003:    CCUPF.UOD.NUM$,		\  7 byte UPD
3267: 0003:    CCUPF.CURRENT.STATUS$	!  1 byte ASC;  "C" = Closed,
3268: 0003:    				!               "D" - Despatched,
3269: 0003:    				!               "X" - Cancelled.
3270: 0003:       				
3271: 0003: 
3272: 0003: INTEGER*2 GLOBAL		\
3273: 0003:    CCUPF.RECL%,			\
3274: 0003:    CCUPF.REPORT.NUM%,		\
3275: 0003:    CCUPF.SESS.NUM%
3276: 0003: 
3277: 0003:  %INCLUDE CCWKFDEC.J86                    ! GMJK
3278: 0003: \******************************************************************************
3279: 0003: \******************************************************************************
3280: 0003: \***
3281: 0003: \***      %INCLUDE FOR RETURNS WORK FILE - FIELD DEFINITIONS
3282: 0003: \***                                       FILE REFERENCE PARAMETERS
3283: 0003: \***
3284: 0003: \***                  REFERENCE: CCWKFDEC.J86
3285: 0003: \***
3286: 0003: \***  Version A          Michael J. Kelsall              30th September 1993
3287: 0003: \***
3288: 0003: \******************************************************************************
3289: 0003: \*******************************************************************************
3290: 0003: 
3291: 0003:   STRING GLOBAL								\
3292: 0003: 	CCWKF.FILE.NAME$,						\
3293: 0003: 	CCWKF.RECORD$
3294: 0003: 
3295: 0003:   INTEGER*2 GLOBAL							\
3296: 0003: 	CCWKF.RECL%,	          					\
3297: 0003: 	CCWKF.SESS.NUM%,						\
3298: 0003: 	CCWKF.REPORT.NUM%
3299: 0003:  %INCLUDE CCDMYDEC.J86                    ! GMJK
3300: 0003: \******************************************************************************
3301: 0003: \******************************************************************************
3302: 0003: \***
3303: 0003: \***         %INCLUDE FOR RETURNS DUMMY FILE I/O SESSION NUMBER
3304: 0003: \***
3305: 0003: \***               REFERENCE    : CCDMYDEC.J86
3306: 0003: \***
3307: 0003: \***    Version A           Michael J. Kelsall          30th September 1993
3308: 0003: \***
3309: 0003: \******************************************************************************
3310: 0003: \*******************************************************************************
3311: 0003: 
3312: 0003:   STRING GLOBAL           \
3313: 0003:     CCDMY.FILE.NAME$
3314: 0003: 
3315: 0003:   INTEGER*2 GLOBAL        \
3316: 0003:     CCDMY.REPORT.NUM%,    \
3317: 0003:     CCDMY.SESS.NUM%
3318: 0003:  %INCLUDE LDTAFDEC.J86                    ! HMJK
3319: 0003: 
3320: 0003: \*****************************************************************************
3321: 0003: \*****************************************************************************
3322: 0003: \***
3323: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
3324: 0003: \***
3325: 0003: \***                   FILE TYPE:  DIRECT
3326: 0003: \***
3327: 0003: \***                   REFERENCE:  LDTAFDEC.J86
3328: 0003: \***
3329: 0003: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
3330: 0003: \***
3331: 0003: \***
3332: 0003: \***      VERSION A         Michael J. Kelsall       30th September 1993
3333: 0003: \***
3334: 0003: \***      VERSION B         Michael J. Kelsall       25th March 1994
3335: 0003: \***      Conversion of LDTAF link duration from minutes to seconds, requiring
3336: 0003: \***      4 byte integer to hold times >09:06:07 (= 32767 seconds)
3337: 0003: \***      
3338: 0003: \*****************************************************************************
3339: 0003: \*****************************************************************************
3340: 0003: 
3341: 0003:   STRING GLOBAL                 \
3342: 0003:     LDTAF.FILE.NAME$,		\
3343: 0003:     LDTAF.START.DATE$,		\ 3 byte UPD  (YYMMDD)
3344: 0003:     LDTAF.START.TIME$		! 3 byte UPD  (HHMMSS)
3345: 0003:     
3346: 0003: 
3347: 0003:   INTEGER*1 GLOBAL              \
3348: 0003:     LDTAF.LINK.TYPE%		!  1 - CSR file    (CSRWF size / num of UNITS)
3349: 0003: 				!  2 - PCHECK      (CHKBF size / null)
3350: 0003: 				!  3 - LDT PROG    (LDTPF size / null)
3351: 0003: 				!  4 - DIRECTS     (DRSMQ size / DIRWF size)
3352: 0003: 				!  5 - UOD         (UODTF size / null)
3353: 0003: 				!  6 - EPSOM req   (PDTWF size / null)
3354: 0003: 				!  7 - EPSOM lists (num of lists / null)
3355: 0003: 				!  8 - RETURNS UOD (CCTMP size / CCBUF size)
3356: 0003: 				!  9 - RETURNS req (CCWKF size / null)
3357: 0003: 				!  MSB ---> 0 = Port A , 1 = Port B. 
3358: 0003: 
3359: 0003:   INTEGER*2 GLOBAL              \
3360: 0003:     LDTAF.SESS.NUM%,            \
3361: 0003:     LDTAF.REPORT.NUM%,		\
3362: 0003:     LDTAF.RECL%
3363: 0003:     				
3364: 0003: 
3365: 0003:   INTEGER*4 GLOBAL              \
3366: 0003:     LDTAF.DATA.VOLUME.1%,	\
3367: 0003:     LDTAF.DATA.VOLUME.2%,	\
3368: 0003:     LDTAF.DURATION%    		! BMJK
3369: 0003:  %INCLUDE SOFTSDEC.J86                    ! GMJK
3370: 0003: REM \
3371: 0003: \******************************************************************************
3372: 0003: \******************************************************************************
3373: 0003: \***
3374: 0003: \***                 %INCLUDE FOR THE SOFTWARE STATUS FILE
3375: 0003: \***   
3376: 0003: \***                      FILE TYPE  :   Direct
3377: 0003: \***
3378: 0003: \***                      REFERENCE  :   SOFTSDEC.J86
3379: 0003: \***
3380: 0003: \***	Version A	       Andrew Wedgeworth	      24th June 1992
3381: 0003: \***
3382: 0003: \******************************************************************************
3383: 0003: \*******************************************************************************
3384: 0003: 
3385: 0003:   STRING GLOBAL           \
3386: 0003:     SOFTS.RECORD$,        \           
3387: 0003:     SOFTS.SPACE$,         \           
3388: 0003:     SOFTS.FILE.NAME$    
3389: 0003:     
3390: 0003:   INTEGER*2 GLOBAL        \
3391: 0003:     SOFTS.RECL%,          \            
3392: 0003:     SOFTS.REPORT.NUM%,	  \      
3393: 0003:     SOFTS.SESS.NUM%
3394: 0003: 
3395: 0003:   INTEGER*4 GLOBAL        \
3396: 0003:     SOFTS.REC.NUM% 	         
3397: 0003:  %INCLUDE STKBFDEC.J86                    ! 1.5
3398: 0003: \******************************************************************************
3399: 0003: \******************************************************************************
3400: 0003: \***
3401: 0003: \***   $Workfile:   STKBFDEC.J86  $
3402: 0003: \***
3403: 0003: \***   $Revision:   1.0  $
3404: 0003: \***
3405: 0003: \******************************************************************************
3406: 0003: \******************************************************************************
3407: 0003: \***
3408: 0003: \***   $Log:   V:\archive\j86\stkbfdec.j8v  $
3409: 0003: \***   
3410: 0003: \***      Rev 1.0   15 Jul 1997 14:20:36   DEV45PS
3411: 0003: \***    
3412: 0003: \***   
3413: 0003: \***      Rev 1.0   09 Jul 1997 11:04:52   DEV45PS
3414: 0003: \***   Stocktake System New Files
3415: 0003: \***   
3416: 0003: \******************************************************************************
3417: 0003: \******************************************************************************\******************************************************************************
3418: 0003: \******************************************************************************
3419: 0003: \***
3420: 0003: \***         %INCLUDE FOR STOCKTAKE BUFFER FILE FIELD DECLARATIONS
3421: 0003: \***
3422: 0003: \***               FILE TYPE    : DIRECT
3423: 0003: \***
3424: 0003: \***               REFERENCE    : STKBFDEC.J86
3425: 0003: \***
3426: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3427: 0003: \***    New file for stocktaking system. Holds counts read from PDT.
3428: 0003: \***
3429: 0003: \*******************************************************************************
3430: 0003: \*******************************************************************************
3431: 0003: 
3432: 0003: STRING GLOBAL                                                  \
3433: 0003:    STKBF.FILE.NAME$,           \
3434: 0003:    STKBF.DATA$,                \
3435: 0003:    STKBF.STORE.NUMBER$,        \
3436: 0003:    STKBF.STOCKTAKER.NO$,       \
3437: 0003:    STKBF.DATE$,                \
3438: 0003:    STKBF.LOCATION$,            \
3439: 0003:    STKBF.ITEM.CODE$,           \
3440: 0003:    STKBF.QUANTITY$,            \
3441: 0003:    STKBF.PRICE$,               \
3442: 0003:    STKBF.RECORD.COUNT$,        \
3443: 0003:    STKBF.FILLER$
3444: 0003: 
3445: 0003: 
3446: 0003: INTEGER*4 GLOBAL               \
3447: 0003:    STKBF.RECORD.NUM%
3448: 0003: 
3449: 0003: INTEGER*2 GLOBAL                \
3450: 0003:    STKBF.REPORT.NUM%,           \
3451: 0003:    STKBF.SESS.NUM%             
3452: 0003: 
3453: 0003: 
3454: 0003: INTEGER*1 GLOBAL                \
3455: 0003:    STKBF.RECL%         
3456: 0003: 
3457: 0003: 
3458: 0003:  %INCLUDE SXTMPDEC.J86                    ! 1.5
3459: 0003: \******************************************************************************
3460: 0003: \******************************************************************************
3461: 0003: \***
3462: 0003: \***         %INCLUDE FOR TEMPORARY STOCKTAKE BUFFER FILE FIELD DECLARATIONS
3463: 0003: \***
3464: 0003: \***               FILE TYPE    : DIRECT
3465: 0003: \***
3466: 0003: \***               REFERENCE    : SXTMPDEC.J86
3467: 0003: \***
3468: 0003: \***    VERSION A.              Nik Sen.               30 Jun 1997.
3469: 0003: \***    New file for stocktaking system. Holds counts read from PDT.
3470: 0003: \***
3471: 0003: \***    VERSION B              Nik Sen                 23 September 1997
3472: 0003: \***    Removed record count as file converted from direct to sequential.
3473: 0003: \***
3474: 0003: \*******************************************************************************
3475: 0003: \*******************************************************************************
3476: 0003: 
3477: 0003: STRING GLOBAL                                                  \
3478: 0003:    SXTMP.FILE.NAME$,           \
3479: 0003:    SXTMP.DATA$,                \
3480: 0003:    SXTMP.STORE.NUMBER$,        \
3481: 0003:    SXTMP.STOCKTAKER.NO$,       \
3482: 0003:    SXTMP.DATE$,                \
3483: 0003:    SXTMP.LOCATION$,            \
3484: 0003:    SXTMP.ITEM.CODE$,           \
3485: 0003:    SXTMP.QUANTITY$,            \
3486: 0003:    SXTMP.PRICE$,               \
3487: 0003:    SXTMP.RECORD.COUNT$,        \
3488: 0003:    SXTMP.FILLER$
3489: 0003: 
3490: 0003: 
3491: 0003: INTEGER*2 GLOBAL                \
3492: 0003:    SXTMP.REPORT.NUM%,           \
3493: 0003:    SXTMP.SESS.NUM%             
3494: 0003: 
3495: 0003: 
3496: 0003: INTEGER*1 GLOBAL                \
3497: 0003:    SXTMP.RECL%         
3498: 0003: 
3499: 0003: 
3500: 0003:  %INCLUDE STKTKDEC.J86                    ! 1.5
3501: 0003: REM \
3502: 0003: \******************************************************************************
3503: 0003: \******************************************************************************
3504: 0003: \***
3505: 0003: \***         %INCLUDE FOR STOCKTAKE DUMMY FILE - FILE REFERENCE PARAMETERS
3506: 0003: \***
3507: 0003: \***               REFERENCE    : STKTKDEC.J86
3508: 0003: \***
3509: 0003: \******************************************************************************
3510: 0003: \*******************************************************************************
3511: 0003: 
3512: 0003:   STRING GLOBAL           \
3513: 0003:     STKTK.FILE.NAME$
3514: 0003: 
3515: 0003:   INTEGER*2 GLOBAL        \
3516: 0003:     STKTK.REPORT.NUM%,      \
3517: 0003:     STKTK.SESS.NUM%
3518: 0003:  %INCLUDE STLDTDEC.J86                    ! 1.6
3519: 0003: REM \
3520: 0003: \******************************************************************************
3521: 0003: \******************************************************************************
3522: 0003: \***
3523: 0003: \***            %INCLUDE FOR STLDT FILE VARIABLES
3524: 0003: \***
3525: 0003: \***                 FILE TYPE    : Direct
3526: 0003: \***
3527: 0003: \***                 REFERENCE    : STLDTDEC.J86
3528: 0003: \***
3529: 0003: \***       Version B          David Artiss      03/09/2002
3530: 0003: \***       Increase field from 2 to 2 bytes
3531: 0003: \***
3532: 0003: \******************************************************************************
3533: 0003: \*******************************************************************************
3534: 0003: 
3535: 0003:   STRING GLOBAL           \
3536: 0003:     STLDT.FILE.NAME$,     \
3537: 0003:     STLDT.RECORD$,        \ 25 bytes
3538: 0003:     STLDT.STORE$,         \ 4 bytes
3539: 0003:     STLDT.STOCKTAKER$,    \ 4 bytes
3540: 0003:     STLDT.LDT.SERIAL$,    \ 6 bytes
3541: 0003:     STLDT.DATE$,          \ 6 bytes DDMMYY
3542: 0003:     STLDT.TIME$,          \ 4 bytes HHMM
3543: 0003:     STLDT.CRLF$           \
3544: 0003: 
3545: 0003:   INTEGER*2 GLOBAL        \
3546: 0003:     STLDT.RECL%,          \
3547: 0003:     STLDT.SESS.NUM%,      \
3548: 0003:     STLDT.REPORT.NUM%     ! BDA
3549: 0003:      
3550: 0003:   INTEGER*4 GLOBAL        \
3551: 0003:     STLDT.RECORD.NUM%,    \
3552: 0003:     STLDT.COUNTS%,        \ BDA
3553: 0003:     STLDT.ITEMS%
3554: 0003:       
3555: 0003:  %INCLUDE STOCKDEC.J86                    ! 1.7BG
3556: 0003: \***********************************************************************
3557: 0003: \***********************************************************************
3558: 0003: \***
3559: 0003: \***    DESCRIPTION: Stock File
3560: 0003: \***                 Field Definitions         
3561: 0003: \***
3562: 0003: \***    FILE TYPE : Keyed
3563: 0003: \***
3564: 0003: \***********************************************************************
3565: 0003: \***
3566: 0003: \***    Version B.              Robert Cowey             21st Oct 1993
3567: 0003: \***    No changes to this file.
3568: 0003: \***
3569: 0003: \***    Version C.              Mark Walker              24th Jan 2014
3570: 0003: \***    F337 Centralised View of Stock
3571: 0003: \***    - Added sequence ID and item status fields.
3572: 0003: \***    - Minor formatting changes (uncommented).
3573: 0003: \***
3574: 0003: \***    Version D.              Mark Walker              15th Mar 2014
3575: 0003: \***    F337 Centralised View of Stock
3576: 0003: \***    Added next sequence ID field.
3577: 0003: \***
3578: 0003: \***    Version E.              Mark Walker               7th May 2014
3579: 0003: \***    F337 Centralised View of Stock
3580: 0003: \***    Added new 'stock flags' field for future use.
3581: 0003: \***
3582: 0003: \***********************************************************************
3583: 0003: \***********************************************************************
3584: 0003: 
3585: 0003: \***********************************************************************
3586: 0003: \***********************************************************************
3587: 0003: \***
3588: 0003: \***    File Record Layout
3589: 0003: \***
3590: 0003: \***    STOCK.BOOTS.CODE$            4 UPD  Item Code (Key)
3591: 0003: \***    STOCK.STOCK.FIG%             2 INT  Stock Figure
3592: 0003: \***    STOCK.LAST.COUNT%            2 INT  Last Count Quantity
3593: 0003: \***    STOCK.DATE.LAST.COUNT$       3 UPD  Date of Last Count
3594: 0003: \***    STOCK.DATE.LAST.MOVE$        3 UPD  Date of Last Movement
3595: 0003: \***    STOCK.LAST.REC%              2 INT  Last Receipt Quantity
3596: 0003: \***    STOCK.DATE.LAST.REC$         3 UPD  Date of Last Receipt
3597: 0003: \***    STOCK.DATE.LAST.GAP$         3 UPD  Date of Last Gap
3598: 0003: \***    STOCK.SID%                   4 INT  Sequence ID                     !CMW
3599: 0003: \***    STOCK.STATUS.1$              1 ASC  Item Status                     !CMW
3600: 0003: \***    STOCK.FLAGS%                 1 INT  Stock flags                     !EMW
3601: 0003: \***    STOCK.FILLER$                2 UPD  Filler                          !EMW
3602: 0003: \***
3603: 0003: \***********************************************************************
3604: 0003: \***********************************************************************
3605: 0003: 
3606: 0003:     INTEGER*1 GLOBAL                                                    \
3607: 0003:         STOCK.FLAGS%,                                                   \   !EMW
3608: 0003:         STOCK.RECL%
3609: 0003: 
3610: 0003:     INTEGER*2 GLOBAL                                                    \
3611: 0003:         STOCK.LAST.COUNT%,                                              \
3612: 0003:         STOCK.LAST.REC%,                                                \
3613: 0003:         STOCK.REPORT.NUM%,                                              \
3614: 0003:         STOCK.SESS.NUM%,                                                \
3615: 0003:         STOCK.STOCK.FIG%
3616: 0003: 
3617: 0003:     INTEGER*4 GLOBAL                                                    \   !CMW
3618: 0003:         STOCK.NEXT.SID%,                                                \   !DMW
3619: 0003:         STOCK.SID%                                                          !CMW
3620: 0003: 
3621: 0003:     STRING GLOBAL                                                       \
3622: 0003:         STOCK.BOOTS.CODE$,                                              \
3623: 0003:         STOCK.DATE.LAST.COUNT$,                                         \
3624: 0003:         STOCK.DATE.LAST.GAP$,                                           \
3625: 0003:         STOCK.DATE.LAST.MOVE$,                                          \
3626: 0003:         STOCK.DATE.LAST.REC$,                                           \
3627: 0003:         STOCK.FILE.NAME$,                                               \
3628: 0003:         STOCK.FILLER$,                                                  \
3629: 0003:         STOCK.STATUS.1$                                                     !CMW
3630: 0003: 
3631: 0003:  %INCLUDE IMSTCDEC.J86                    ! 1.7BG
3632: 0003: \***********************************************************************
3633: 0003: \***********************************************************************
3634: 0003: \***
3635: 0003: \***    DESCRIPTION: Item Movement & Stock File
3636: 0003: \***                 Field Definitions         
3637: 0003: \***
3638: 0003: \***    FILE TYPE : Keyed
3639: 0003: \***
3640: 0003: \***********************************************************************
3641: 0003: \***
3642: 0003: \***    Version A.          Les Cook                     21st Aug 1992
3643: 0003: \***    Initial version.
3644: 0003: \***
3645: 0003: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
3646: 0003: \***    Added new external functions for
3647: 0003: \***        MIMSTC - merged IMSTC
3648: 0003: \***        CIMSTC - Copy of IMSTC
3649: 0003: \***        BIMSTC - Backup of IMSTC
3650: 0003: \***
3651: 0003: \***    Version C.          Mark Walker                  23rd Jan 2014
3652: 0003: \***    F337 Centralised View of Stock
3653: 0003: \***    - Added sequence ID field definition.
3654: 0003: \***    - Moved BIMST, CIMST and MIMST field definitions to separate
3655: 0003: \***      modules.
3656: 0003: \***    - Moved TIMST record length to TIMSTDEC.J86.
3657: 0003: \***    - Minor formatting changes (uncommented).
3658: 0003: \***
3659: 0003: \***    Version D.          Mark Walker                  30th Apr 2014
3660: 0003: \***    F337 Centralised View of Stock
3661: 0003: \***    QC599: Introduced item level TSL restart pointer to allow
3662: 0003: \***           Sales Support restart/recovery to continue processing
3663: 0003: \***           correctly from the next unprocessed item.
3664: 0003: \***
3665: 0003: \***********************************************************************
3666: 0003: \***********************************************************************
3667: 0003: 
3668: 0003: \***********************************************************************
3669: 0003: \***********************************************************************
3670: 0003: \***
3671: 0003: \***    File Record Layout
3672: 0003: \***
3673: 0003: \***    IMSTC.BAR.CODE$             11 UPD  Barcode (Key)
3674: 0003: \***    IMSTC.RESTART%               4 INT  IMSTC Restart pointer
3675: 0003: \***    IMSTC.NUMITEMS%              4 INT  Number of items sold
3676: 0003: \***    IMSTC.AMTSALE%               4 INT  Amount of items sold
3677: 0003: \***    IMSTC.TSL.RESTART%           4 INT  TSL Restart pointer             !DMW
3678: 0003: \***    IMSTC.STKMQ.RESTART%         4 INT  STKMQ Restart pointer
3679: 0003: \***    IMSTC.STATUS.FLAG$           1 ASC  Status flags
3680: 0003: \***    IMSTC.STOCK.FIGURE%          2 INT  Stock Figure
3681: 0003: \***    IMSTC.REASON.ITEM.REMOVED$   1 ASC  Deletion Reason
3682: 0003: \***    IMSTC.SID%                   4 INT  Sequence ID
3683: 0003: \***    IMSTC.FILLER$                1 UPD  Filler
3684: 0003: \***
3685: 0003: \***********************************************************************
3686: 0003: \***********************************************************************
3687: 0003: 
3688: 0003:     INTEGER*2 GLOBAL                                                    \
3689: 0003:         IMSTC.SESS.NUM%,                                                \
3690: 0003:         IMSTC.RECL%,                                                    \
3691: 0003:         IMSTC.REPORT.NUM%,                                              \
3692: 0003:         IMSTC.STOCK.FIGURE%
3693: 0003: 
3694: 0003:     INTEGER*4 GLOBAL                                                    \
3695: 0003:         IMSTC.AMTSALE%,                                                 \
3696: 0003:         IMSTC.NEXT.SID%,                                                \   !CMW
3697: 0003:         IMSTC.NUMITEMS%,                                                \
3698: 0003:         IMSTC.RESERVED%,                                                \
3699: 0003:         IMSTC.RESTART%,                                                 \
3700: 0003:         IMSTC.SID%,                                                     \   !CMW
3701: 0003:         IMSTC.STKMQ.RESTART%,                                           \
3702: 0003:         IMSTC.TSL.RESTART%                                                  !DMW
3703: 0003: 
3704: 0003:     STRING GLOBAL                                                       \
3705: 0003:         IMSTC.BAR.CODE$,                                                \
3706: 0003:         IMSTC.FILE.NAME$,                                               \
3707: 0003:         IMSTC.FILLER$,                                                  \
3708: 0003:         IMSTC.HOLD.PENDING$,                                            \
3709: 0003:         IMSTC.REASON.ITEM.REMOVED$,                                     \
3710: 0003:         IMSTC.STATUS.FLAG$
3711: 0003: 
3712: 0003:  %INCLUDE LSSSTDEC.J86                    ! 1.7BG
3713: 0003: REM \
3714: 0003: \******************************************************************************
3715: 0003: \******************************************************************************
3716: 0003: \***
3717: 0003: \***                 %INCLUDE FOR THE LSS STOCK COUNT FILE
3718: 0003: \***   
3719: 0003: \***                      FILE TYPE  :   Direct
3720: 0003: \***
3721: 0003: \***                      REFERENCE  :   LSSSTDEC.J86
3722: 0003: \***
3723: 0003: \***    Version A          Brian Greenfield          16th October 2002
3724: 0003: \***
3725: 0003: \******************************************************************************
3726: 0003: \*******************************************************************************
3727: 0003: 
3728: 0003:   STRING GLOBAL              \ 
3729: 0003:     LSSST.FILE.NAME$,        \
3730: 0003:     LSSST.IRF.BAR.CODE$,     \
3731: 0003:     LSSST.STOCK.BOOTS.CODE$, \
3732: 0003:     LSSST.STOCK.COUNT$,      \
3733: 0003:     LSSST.TSF$
3734: 0003:         
3735: 0003:   INTEGER*2 GLOBAL        \
3736: 0003:     LSSST.RECL%,          \            
3737: 0003:     LSSST.REPORT.NUM%,    \      
3738: 0003:     LSSST.SESS.NUM%
3739: 0003: 
3740: 0003:          
3741: 0003:  %INCLUDE SXTCFDEC.J86                    ! 1.8DA
3742: 0003: \******************************************************************************
3743: 0003: \******************************************************************************
3744: 0003: \***
3745: 0003: \***   $Workfile:   SXTCFDEC.J86  $
3746: 0003: \***
3747: 0003: \***   $Revision:   1.1  $
3748: 0003: \***
3749: 0003: \******************************************************************************
3750: 0003: \******************************************************************************
3751: 0003: \***
3752: 0003: \***   $Log:   V:\archive\j86\sxtcfdec.j8v  $
3753: 0003: \***   
3754: 0003: \***      Rev 1.1   07 Jan 1998 10:26:30   DEV69PS
3755: 0003: \***    
3756: 0003: \***   
3757: 0003: \***      Rev 1.0   15 Jul 1997 14:21:06   DEV45PS
3758: 0003: \***    
3759: 0003: \***   
3760: 0003: \***      Rev 1.1   15 Jul 1997 13:44:06   DEV45PS
3761: 0003: \***    
3762: 0003: \***   
3763: 0003: \***      Rev 1.0   09 Jul 1997 11:05:28   DEV45PS
3764: 0003: \***   Stocktake System New Files
3765: 0003: \***   
3766: 0003: \*** 
3767: 0003: \***   
3768: 0003: \******************************************************************************
3769: 0003: \******************************************************************************\*****************************************************************************
3770: 0003: \*****************************************************************************
3771: 0003: \***
3772: 0003: \***               %INCLUDE FOR SXTCF - FIELD DECLARATIONS
3773: 0003: \***                                    FILE REFERENCE PARAMETERS
3774: 0003: \***
3775: 0003: \***                      FILE TYPE    : DIRECT
3776: 0003: \***
3777: 0003: \***                      REFERENCE    : SXTCFDEC
3778: 0003: \***
3779: 0003: \***           VERSION A : NIK SEN  3rd July 1997
3780: 0003: \***
3781: 0003: \***
3782: 0003: 
3783: 0003: \*****************************************************************************
3784: 0003: \*****************************************************************************
3785: 0003: 
3786: 0003: 
3787: 0003:   STRING GLOBAL           \
3788: 0003:     SXTCF.FILE.NAME$
3789: 0003: 
3790: 0003:   INTEGER*1 GLOBAL        \
3791: 0003:     SXTCF.HEADER.EXPECTED%
3792: 0003: 
3793: 0003:   INTEGER*2 GLOBAL        \
3794: 0003:     SXTCF.SESS.NUM%,      \
3795: 0003:     SXTCF.REPORT.NUM%,    \
3796: 0003:     SXTCF.RECL%
3797: 0003: 
3798: 0003:   INTEGER*4 GLOBAL        \
3799: 0003:     SXTCF.REC.NUM%
3800: 0003: 
3801: 0003: 
3802: 0003:   INTEGER*4 GLOBAL                                   \
3803: 0003:             SXTCF.STKBF.POINTER%,                    \ Pointer to STKBF
3804: 0003:             SXTCF.ITEM.COUNT%,                       \ No of items processed
3805: 0003:             SXTCF.CURRENT.COUNT%                     ! Items in current batch
3806: 0003: 
3807: 0003: 
3808: 0003:   STRING GLOBAL                                 \
3809: 0003:        SXTCF.START.DATE$,                       \
3810: 0003:        SXTCF.START.TIME$,                       \
3811: 0003:        SXTCF.END.DATE$,                         \
3812: 0003:        SXTCF.END.TIME$,                         \
3813: 0003:        SXTCF.STOCKTAKE.IN.PROGRESS$,            \ Y=Yes; N=No; S=Stop; C=Complete 1 BYTE
3814: 0003:        SXTCF.STOCKTAKER$,                       \ Current Stocktaker
3815: 0003:        SXTCF.CUR.LOCATION$,                     \ Location code currently be processed ! 1.1
3816: 0003:        SXTCF.FILLER$                            \ 
3817: 0003: 
3818: 0003: 
3819: 0003:  %INCLUDE STKCFDEC.J86                    ! 1.8DA
3820: 0003: \******************************************************************************
3821: 0003: \******************************************************************************
3822: 0003: \***
3823: 0003: \***   $Workfile:   STKCFDEC.J86  $
3824: 0003: \***
3825: 0003: \***   $Revision:   1.2  $
3826: 0003: \***
3827: 0003: \******************************************************************************
3828: 0003: \******************************************************************************
3829: 0003: \***
3830: 0003: \***   $Log:   V:\archive\j86\stkcfdec.j8v  $
3831: 0003: \***   
3832: 0003: \***      Rev 1.2   03 Jul 1997 14:18:38   DEV45PS
3833: 0003: \***   Stocktake In Progress Flag Removed
3834: 0003: \***   
3835: 0003: \***      Rev 1.1   30 Jun 1997 15:29:04   DEV45PS
3836: 0003: \***   Added Stocktake In Progress flag
3837: 0003: \***   
3838: 0003: \******************************************************************************
3839: 0003: \******************************************************************************\*****************************************************************************
3840: 0003: \*****************************************************************************
3841: 0003: \***
3842: 0003: \***               %INCLUDE FOR STKCF - FIELD DECLARATIONS
3843: 0003: \***                                    FILE REFERENCE PARAMETERS
3844: 0003: \***
3845: 0003: \***                      FILE TYPE    : DIRECT
3846: 0003: \***
3847: 0003: \***                      REFERENCE    : STKCFDEA
3848: 0003: \***
3849: 0003: \***           VERSION A : STEVEN GOULDING  11.01.93
3850: 0003: \***
3851: 0003: \***
3852: 0003: \***           VERSION B        NIK SEN        5th June 1997
3853: 0003: \***           Added Stocktake.In.Progress flag.
3854: 0003: \***           
3855: 0003: \***           VERSION C        NIK SEN        3rd July 1997
3856: 0003: \***           Removed Stocktake.In.Progress flag. Now moved to Stocktake
3857: 0003: \***           Control File to prevent conflicts when STKCF is locked.
3858: 0003: \***
3859: 0003: \*****************************************************************************
3860: 0003: \*****************************************************************************
3861: 0003: 
3862: 0003: REM \
3863: 0003: 
3864: 0003:   STRING GLOBAL           \
3865: 0003:     STKCF.FILE.NAME$
3866: 0003: 
3867: 0003:   INTEGER*2 GLOBAL        \
3868: 0003:     STKCF.SESS.NUM%,      \
3869: 0003:     STKCF.REPORT.NUM%,    \
3870: 0003:     STKCF.RECL%
3871: 0003: 
3872: 0003:   INTEGER*4 GLOBAL        \
3873: 0003:     STKCF.REC.NUM%
3874: 0003: REM \
3875: 0003: 
3876: 0003: 
3877: 0003:   INTEGER*4 GLOBAL                                   \
3878: 0003:             STKCF.STKMQ.POINTER%,                    \ Pointer to STKMQ
3879: 0003:             STKCF.ITEM.COUNT%                        \ No of items processed
3880: 0003: 
3881: 0003:   INTEGER*2 GLOBAL                                   \
3882: 0003:             STKCF.STMVT.REC.CNT%                     \ No of recs on STMVT file
3883: 0003: 
3884: 0003:   INTEGER*1 GLOBAL                                   \
3885: 0003:             STKCF.PREV.PITRL.UPDATE%                 \ The HOUR of update
3886: 0003: 
3887: 0003:   STRING    GLOBAL                                   \ 1 BYTE
3888: 0003:             STKCF.STOCK.SUPPORT.STATUS$              \ Y = enabled
3889: 0003:                                                      \ N = disabled
3890: 0003:                                                      \ C = Not available to
3891: 0003:                                                      \         Screens
3892: 0003:                                                      \ T = Trailer written
3893: 0003:                                                      \ 1 - 7 According to
3894: 0003:                                                      \       which STKMQ backup
3895: 0003:                                                      \       done.
3896: 0003: 
3897: 0003:   STRING    GLOBAL                                   \
3898: 0003:   	    STKCF.LAST.DIRORD.BC$,	 	     \ Last BC processed
3899: 0003: 	    					     \ in type 17 (1 byte)
3900: 0003:   	    STKCF.LAST.DIRORD.SUPPLIER$,	     \ Last supplier processed
3901: 0003: 	    					     \ in type 17 (3 bytes UPD)
3902: 0003: 	    STKCF.LAST.DIRORD.ORDER.NO$,	     \ last order no processed
3903: 0003: 	    					     \ in type 17 (2 bytes UPD)
3904: 0003: 	    STKCF.LAST.DIRORD.ORDER.SUFFIX$,	     \ last order sfx processed
3905: 0003: 	    					     \ in type 17 (1 byte)
3906: 0003:   	    STKCF.LAST.DIRORD.REC.SOURCE$, 	     \ Last record source
3907: 0003: 	    					     \ in type 17 (1 byte)
3908: 0003:        STKCF.STK.FILE.AVAIL$,                   \ Y=Yes; N=No; 1 BYTE
3909: 0003:        STKCF.STOCK.TAKE.PROCESSING.REQUIRED$,   \ Y=Yes; N=No; 1 BYTE
3910: 0003:        STKCF.FILLER$                            \ 
3911: 0003: 
3912: 0003: 
3913: 0003:  %INCLUDE STKMFDEC.J86                    ! 1.8DA
3914: 0003: \******************************************************************************
3915: 0003: \******************************************************************************
3916: 0003: \***
3917: 0003: \***   $Workfile:   STKMFDEC.J86  $
3918: 0003: \***
3919: 0003: \***   $Revision:   1.0  $
3920: 0003: \***
3921: 0003: \******************************************************************************
3922: 0003: \******************************************************************************
3923: 0003: \***
3924: 0003: \***   $Log:   V:\archive\j86\stkmfdec.j8v  $
3925: 0003: \***   
3926: 0003: \***      Rev 1.0   15 Jul 1997 14:20:54   DEV45PS
3927: 0003: \***    
3928: 0003: \***   
3929: 0003: \***      Rev 1.0   09 Jul 1997 11:05:16   DEV45PS
3930: 0003: \***   Stocktake System New Files
3931: 0003: \***   
3932: 0003: \******************************************************************************
3933: 0003: \******************************************************************************\******************************************************************************
3934: 0003: \******************************************************************************
3935: 0003: \***
3936: 0003: \***  %INCLUDES FOR STOCKTAKE MAONFRAME TRANSMISSION FILE FIELD DECLARATIONS
3937: 0003: \***
3938: 0003: \***               FILE TYPE    : DIRECT
3939: 0003: \***
3940: 0003: \***               REFERENCE    : STKMFDEC.J86
3941: 0003: \***
3942: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
3943: 0003: \***    New file for stocktaking system. Holds stocktake data for 
3944: 0003: \***    transmission to the maonframe.
3945: 0003: \***
3946: 0003: \*******************************************************************************
3947: 0003: \*******************************************************************************
3948: 0003: 
3949: 0003: STRING GLOBAL                                                  \
3950: 0003:        STKMF.FILE.NAME$,               \
3951: 0003:        STKMF.DATA$,                    \
3952: 0003:        STKMF.STORE.NUMBER$,            \
3953: 0003:        STKMF.STOCKTAKER.NUM$,          \
3954: 0003:        STKMF.FILLER$,                  \
3955: 0003:        STKMF.DELIMITER$,               \
3956: 0003:        STKMF.DATE$,                    \
3957: 0003:        STKMF.LOCATION$,                \
3958: 0003:        STKMF.ITEM.CODE$,               \
3959: 0003:        STKMF.QUANTITY$,                \
3960: 0003:        STKMF.PRICE$,                   \
3961: 0003:        STKMF.RECORD.COUNT$
3962: 0003:                        
3963: 0003: INTEGER*4 GLOBAL               \
3964: 0003:        STKMF.RECORD.NUM%
3965: 0003: 
3966: 0003: INTEGER*2 GLOBAL                \
3967: 0003:    STKMF.REPORT.NUM%,           \
3968: 0003:    STKMF.SESS.NUM%             
3969: 0003: 
3970: 0003: 
3971: 0003: INTEGER*1 GLOBAL                \
3972: 0003:    STKMF.RECL%         
3973: 0003: 
3974: 0003: 
3975: 0003:  %INCLUDE STKRCDEC.J86                    ! 1.8DA
3976: 0003: \******************************************************************************
3977: 0003: \******************************************************************************
3978: 0003: \***
3979: 0003: \***   $Workfile:   STKRCDEC.J86  $
3980: 0003: \***
3981: 0003: \***   $Revision:   1.1  $
3982: 0003: \***
3983: 0003: \******************************************************************************
3984: 0003: \******************************************************************************
3985: 0003: \***
3986: 0003: \***   $Log:   V:\archive\j86\stkrcdec.j8v  $
3987: 0003: \***   
3988: 0003: \***      Rev 1.1   03 Feb 1998 10:06:02   DEV69PS
3989: 0003: \***    
3990: 0003: \***   
3991: 0003: \***      Rev 1.0   15 Jul 1997 14:20:58   DEV45PS
3992: 0003: \***    
3993: 0003: \***   
3994: 0003: \***      Rev 1.0   09 Jul 1997 11:05:22   DEV45PS
3995: 0003: \***   Stocktake System New Files
3996: 0003: \***   
3997: 0003: \******************************************************************************
3998: 0003: \******************************************************************************\******************************************************************************
3999: 0003: \******************************************************************************
4000: 0003: \***
4001: 0003: \***         %INCLUDE FOR STOCKTAKE RECOUNT FILE FIELD DECLARATIONS
4002: 0003: \***
4003: 0003: \***               FILE TYPE    : DIRECT
4004: 0003: \***
4005: 0003: \***               REFERENCE    : STKRCDEC.J86
4006: 0003: \***
4007: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4008: 0003: \***    New file for stocktaking system. Holds all items where a recount
4009: 0003: \***    has occurred.
4010: 0003: \***
4011: 0003: \*******************************************************************************
4012: 0003: \*******************************************************************************
4013: 0003: 
4014: 0003: STRING GLOBAL                                                  \
4015: 0003:        STKRC.FILE.NAME$,               \
4016: 0003:        STKRC.ITEM.CODE$,               \
4017: 0003:        STKRC.ITEM.DESCRIPTION$,        \
4018: 0003:        STKRC.LOCATION$,                \
4019: 0003:        STKRC.INITIAL.QUANTITY$,        \
4020: 0003:        STKRC.INITIAL.STOCKTAKER$,      \
4021: 0003:        STKRC.FINAL.QUANTITY$,          \
4022: 0003:        STKRC.FINAL.STOCKTAKER$
4023: 0003: 
4024: 0003: INTEGER*4 GLOBAL               \     !1.1
4025: 0003:        STKRC.RECORD.NUM%
4026: 0003: 
4027: 0003: 
4028: 0003: INTEGER*2 GLOBAL                \
4029: 0003:    STKRC.REPORT.NUM%,           \
4030: 0003:    STKRC.SESS.NUM%             
4031: 0003: 
4032: 0003: 
4033: 0003: INTEGER*1 GLOBAL                \
4034: 0003:    STKRC.LOC.CNT%,              \     
4035: 0003:    STKRC.RECL%         
4036: 0003: 
4037: 0003: 
4038: 0003:  %INCLUDE XGCFDEC.J86                     ! 1.8DA
4039: 0003: \******************************************************************************
4040: 0003: \******************************************************************************
4041: 0003: \***
4042: 0003: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
4043: 0003: \***
4044: 0003: \***                  FILE TYPE    : Keyed
4045: 0003: \***
4046: 0003: \***                  REFERENCE    : XGCFDEC.J86
4047: 0003: \***
4048: 0003: \***    VERSION A               Steve Wright                        24 Aug 1999
4049: 0003: \***
4050: 0003: \*******************************************************************************
4051: 0003: \*******************************************************************************
4052: 0003: 
4053: 0003: STRING GLOBAL           \
4054: 0003:    XGCF.FILE.NAME$,     \
4055: 0003:    XGCF.PRODUCT.GRP$,   \  Redundant - key changed from product group to BC
4056: 0003:    XGCF.BAR.CODE$,      \
4057: 0003:    XGCF.BSNS.CNTR$,     \  New key - 1 byte business centre
4058: 0003:    XGCF.RSRVD$          !  New key - 2 byte filler, must be 0x0000 (set by function)
4059: 0003: 
4060: 0003: INTEGER*2 GLOBAL        \
4061: 0003:    XGCF.RECL%,          \  
4062: 0003:    XGCF.REPORT.NUM%,    \ 
4063: 0003:    XGCF.SESS.NUM%
4064: 0003:  %INCLUDE STKEXDEC.J86                    ! 1.8DA
4065: 0003: \******************************************************************************
4066: 0003: \******************************************************************************
4067: 0003: \***
4068: 0003: \***   $Workfile:   STKEXDEC.J86  $
4069: 0003: \***
4070: 0003: \***   $Revision:   1.1  $
4071: 0003: \***
4072: 0003: \******************************************************************************
4073: 0003: \******************************************************************************
4074: 0003: \***
4075: 0003: \***   $Log:   V:\archive\j86\stkexdec.j8v  $
4076: 0003: \***   
4077: 0003: \***      Rev 1.1   05 Aug 1997 13:49:18   DEV45PS
4078: 0003: \***   Added Reason Code
4079: 0003: \***   
4080: 0003: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
4081: 0003: \***    
4082: 0003: \***   
4083: 0003: \***      Rev 1.0   09 Jul 1997 11:05:04   DEV45PS
4084: 0003: \***   Stocktake System New Files
4085: 0003: \***   
4086: 0003: \******************************************************************************
4087: 0003: \******************************************************************************\******************************************************************************
4088: 0003: \******************************************************************************
4089: 0003: \***
4090: 0003: \***         %INCLUDE FOR STOCKTAKE EXCEPTIONS FILE FIELD DECLARATIONS
4091: 0003: \***
4092: 0003: \***               FILE TYPE    : DIRECT
4093: 0003: \***
4094: 0003: \***               REFERENCE    : STKEXDEC.J86
4095: 0003: \***
4096: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4097: 0003: \***    New file for stocktaking system. Holds all counted items which  
4098: 0003: \***    are not on the IDF.
4099: 0003: \***
4100: 0003: \***    VERSION B              Nik Sen                 5th August 1997
4101: 0003: \***    Added reason code.
4102: 0003: \***
4103: 0003: \*******************************************************************************
4104: 0003: \*******************************************************************************
4105: 0003: 
4106: 0003: STRING GLOBAL                                                  \
4107: 0003:    STKEX.FILE.NAME$,            \
4108: 0003:    STKEX.ITEM.CODE$,           \
4109: 0003:    STKEX.QUANTITY$,            \
4110: 0003:    STKEX.LOCATION$,            \
4111: 0003:    STKEX.STOCKTAKER.NUM$,      \
4112: 0003:    STKEX.REASON.CODE$
4113: 0003: 
4114: 0003: 
4115: 0003: INTEGER*4 GLOBAL               \
4116: 0003:        STKEX.RECORD.NUM%
4117: 0003: 
4118: 0003: INTEGER*2 GLOBAL                \
4119: 0003:    STKEX.REPORT.NUM%,           \
4120: 0003:    STKEX.SESS.NUM%             
4121: 0003: 
4122: 0003: 
4123: 0003: INTEGER*1 GLOBAL                \
4124: 0003:    STKEX.RECL%         
4125: 0003: 
4126: 0003: 
4127: 0003:  %INCLUDE STKIFDEC.J86                    ! 1.8DA
4128: 0003: \******************************************************************************
4129: 0003: \******************************************************************************
4130: 0003: \***
4131: 0003: \***   $Workfile:   STKIFDEC.J86  $
4132: 0003: \***
4133: 0003: \***   $Revision:   1.2  $
4134: 0003: \***
4135: 0003: \******************************************************************************
4136: 0003: \******************************************************************************
4137: 0003: \***
4138: 0003: \***   $Log:   V:\archive\j86\stkifdec.j8v  $
4139: 0003: \***   
4140: 0003: \***      Rev 1.2   21 Aug 1997 11:20:56   DEV45PS
4141: 0003: \***    
4142: 0003: \***   
4143: 0003: \***      Rev 1.1   19 Aug 1997 11:06:14   DEV45PS
4144: 0003: \***   Added Stocktake Transmission File Record Number Field
4145: 0003: \***   
4146: 0003: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
4147: 0003: \***    
4148: 0003: \***   
4149: 0003: \***      Rev 1.0   09 Jul 1997 11:05:10   DEV45PS
4150: 0003: \***   Stocktake System New Files
4151: 0003: \***   
4152: 0003: \******************************************************************************
4153: 0003: \******************************************************************************\******************************************************************************
4154: 0003: \******************************************************************************
4155: 0003: \***
4156: 0003: \***         %INCLUDE FOR STOCKTAKE ITEM FILE FIELD DECLARATIONS
4157: 0003: \***
4158: 0003: \***               FILE TYPE    : KEYED
4159: 0003: \***
4160: 0003: \***               REFERENCE    : STKIFDEC.J86
4161: 0003: \***
4162: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4163: 0003: \***    New file for stocktaking system. Holds information about all counted
4164: 0003: \***    items found on the STOCK and IDF files. Key is Boots Code + Location 
4165: 0003: \***
4166: 0003: \***    VERSION B               Nik Sen                19 August 1997
4167: 0003: \***    Added STKMF Record Number field.
4168: 0003: \***
4169: 0003: \*******************************************************************************
4170: 0003: \*******************************************************************************
4171: 0003: 
4172: 0003: STRING GLOBAL                                                  \
4173: 0003:        STKIF.FILE.NAME$,               \
4174: 0003:        STKIF.KEY$,                     \
4175: 0003:        STKIF.ITEM.CODE$,               \
4176: 0003:        STKIF.LOCATION$,                \
4177: 0003:        STKIF.BUSINESS.CENTRE$,         \
4178: 0003:        STKIF.GROUP.SEQUENCE$,          \
4179: 0003:        STKIF.QUANTITY$,                \
4180: 0003:        STKIF.DESCRIPTION$,             \
4181: 0003:        STKIF.STOCKTAKER.NUM$
4182: 0003: 
4183: 0003: 
4184: 0003: 
4185: 0003: INTEGER*2 GLOBAL                \
4186: 0003:    STKIF.REPORT.NUM%,           \
4187: 0003:    STKIF.SESS.NUM%             
4188: 0003: 
4189: 0003: 
4190: 0003: INTEGER*1 GLOBAL                \
4191: 0003:    STKIF.RECL%         
4192: 0003: 
4193: 0003: INTEGER*4 GLOBAL                \
4194: 0003:    STKIF.STKMF.RECORD.NUM%
4195: 0003: 
4196: 0003: 
4197: 0003: 
4198: 0003:  %INCLUDE LOCNTDEC.J86                    ! 1.8DA
4199: 0003: \******************************************************************************
4200: 0003: \******************************************************************************
4201: 0003: \***
4202: 0003: \***   $Workfile:   LOCNTDEC.J86  $
4203: 0003: \***
4204: 0003: \***   $Revision:   1.0  $
4205: 0003: \***
4206: 0003: \******************************************************************************
4207: 0003: \******************************************************************************
4208: 0003: \***
4209: 0003: \***   $Log:   V:\archive\j86\locntdec.j8v  $
4210: 0003: \***   
4211: 0003: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
4212: 0003: \***    
4213: 0003: \***   
4214: 0003: \******************************************************************************
4215: 0003: \******************************************************************************
4216: 0003: \***
4217: 0003: \***         %INCLUDE FOR STOCKTAKE LOCATION COUNTERS (LOCCNT) DECLARATIONS
4218: 0003: \***
4219: 0003: \***               FILE TYPE    : DIRECT
4220: 0003: \***
4221: 0003: \***               REFERENCE    : LOCNTDEC.J86
4222: 0003: \***
4223: 0003: \***    VERSION A.              Johnnie Chan           6th Jan 1998
4224: 0003: \***    New file for stocktaking system. Holds all locations counted using
4225: 0003: \***    1st to 10000th record for S0000-S9999 and 10001st to 20000th record
4226: 0003: \***    for B0000-B9999.
4227: 0003: \***
4228: 0003: \*******************************************************************************
4229: 0003: \*******************************************************************************
4230: 0003: 
4231: 0003: STRING GLOBAL                           \
4232: 0003:        LOCCNT.FILE.NAME$
4233: 0003:        
4234: 0003: INTEGER*4 GLOBAL                        \
4235: 0003:        LOCCNT.RECORD.NUM%
4236: 0003: 
4237: 0003: 
4238: 0003: INTEGER*2 GLOBAL                        \
4239: 0003:        LOCCNT.REPORT.NUM%,              \
4240: 0003:        LOCCNT.SESS.NUM%             
4241: 0003: 
4242: 0003: 
4243: 0003: INTEGER*1 GLOBAL                        \
4244: 0003:        LOCCNT.LOCATION.COUNT%,          \
4245: 0003:        LOCCNT.RECL%         
4246: 0003: 
4247: 0003: 
4248: 0003:  %INCLUDE STKIGDEC.J86                    ! 1.8DA
4249: 0003: \******************************************************************************
4250: 0003: \******************************************************************************
4251: 0003: \***
4252: 0003: \***         %INCLUDE FOR STOCKTAKE ITEM GROUP FIELD DECLARATIONS
4253: 0003: \***
4254: 0003: \***               FILE TYPE    : DIRECT
4255: 0003: \***
4256: 0003: \***               REFERENCE    : STKIGDEC.J86
4257: 0003: \***
4258: 0003: \***    VERSION A.              Nik Sen.               17 Jun 1997.
4259: 0003: \***    New file for stocktaking system. Holds Business Centres, Concept
4260: 0003: \***    and product groups which define scope of stocktake.
4261: 0003: \***
4262: 0003: \*******************************************************************************
4263: 0003: \*******************************************************************************
4264: 0003: 
4265: 0003: STRING GLOBAL                                                  \
4266: 0003:    STKIG.FILE.NAME$,            \
4267: 0003:    STKIG.DATA$
4268: 0003: 
4269: 0003: INTEGER*4 GLOBAL               \
4270: 0003:    STKIG.RECORD.NUM%
4271: 0003: 
4272: 0003: INTEGER*2 GLOBAL                \
4273: 0003:    STKIG.REPORT.NUM%,           \
4274: 0003:    STKIG.SESS.NUM%             
4275: 0003: 
4276: 0003: 
4277: 0003: INTEGER*1 GLOBAL                \
4278: 0003:    STKIG.RECL%         
4279: 0003: 
4280: 0003: 
4281: 0003:  %INCLUDE STKTFDEC.J86                    ! 1.8DA
4282: 0003: \******************************************************************************
4283: 0003: \******************************************************************************
4284: 0003: \***
4285: 0003: \***   $Workfile:   STKTFDEC.J86  $
4286: 0003: \***
4287: 0003: \***   $Revision:   1.1  $
4288: 0003: \***
4289: 0003: \******************************************************************************
4290: 0003: \******************************************************************************
4291: 0003: \***
4292: 0003: \***   $Log:   V:\archive\j86\stktfdec.j8v  $
4293: 0003: \***   
4294: 0003: \***      Rev 1.1   15 Jul 1997 14:36:28   DEV45PS
4295: 0003: \***    
4296: 0003: \***   
4297: 0003: \***      Rev 1.0   15 Jul 1997 14:21:02   DEV45PS
4298: 0003: \***   Stocktake System New Files
4299: 0003: \***   
4300: 0003: \******************************************************************************
4301: 0003: \******************************************************************************\******************************************************************************
4302: 0003: \******************************************************************************
4303: 0003: \***
4304: 0003: \***         %INCLUDE FOR STOCKTAKE TOTALS FILE FIELD DECLARATIONS
4305: 0003: \***
4306: 0003: \***               FILE TYPE    : KEYED
4307: 0003: \***
4308: 0003: \***               REFERENCE    : STKTFDEC.J86
4309: 0003: \***
4310: 0003: \***    VERSION A.              Nik Sen.               15 July 1997.
4311: 0003: \***    New file for stocktaking system. Holds information about all counted
4312: 0003: \***    items found on the STOCK and IDF files. Key is Boots Code. 
4313: 0003: \***
4314: 0003: \*******************************************************************************
4315: 0003: \*******************************************************************************
4316: 0003: 
4317: 0003: STRING GLOBAL                                                  \
4318: 0003:        STKTF.FILE.NAME$,               \
4319: 0003:        STKTF.BOOTS.CODE$,              \
4320: 0003:        STKTF.BUSINESS.CENTRE$,         \
4321: 0003:        STKTF.GROUP.SEQUENCE$,          \
4322: 0003:        STKTF.QUANTITY$                
4323: 0003: 
4324: 0003: 
4325: 0003: 
4326: 0003: INTEGER*2 GLOBAL                \
4327: 0003:    STKTF.REPORT.NUM%,           \
4328: 0003:    STKTF.SESS.NUM%             
4329: 0003: 
4330: 0003: 
4331: 0003: INTEGER*1 GLOBAL                \
4332: 0003:    STKTF.RECL%         
4333: 0003: 
4334: 0003: 
4335: 0003:  %INCLUDE IRFDEC.J86                      ! 1.8DA
4336: 0003: 
4337: 0003: \**********************************************************************************
4338: 0003: \***
4339: 0003: \***       %INCLUDE FOR ITEM RECORD FILE - FIELD DECLARATIONS
4340: 0003: \***                                     - FILE REFERENCE PARAMETERS
4341: 0003: \***
4342: 0003: \***                      FILE TYPE    : Keyed
4343: 0003: \***
4344: 0003: \***                      REFERENCE    : IRFDEC.J86
4345: 0003: \***
4346: 0003: \***     Version A               Andrew Wedgeworth            29th June 1992
4347: 0003: \***
4348: 0003: \***     Version B               Andrew Wedgeworth        14th December 1992
4349: 0003: \***     Version letter incremented to match other IRF code.
4350: 0003: \***
4351: 0003: \***     Version C             Steve Windsor          12.02.93
4352: 0003: \***     Version letter incremented to match other IRF code.
4353: 0003: \***
4354: 0003: \***     Version D             Steve Windsor          12.05.93
4355: 0003: \***     Version letter incremented to match other IRF code.
4356: 0003: \***
4357: 0003: \***     Version E           Steve Perkins       20th September 1993
4358: 0003: \***     Deals project : Handling of Converted/Unconverted records
4359: 0003: \***     ++   Anything with 'Delete' after initials should be   ++
4360: 0003: \***     ++   deleted once the IRF has been converted in all    ++
4361: 0003: \***     ++   stores.                                           ++
4362: 0003: \***
4363: 0003: \***     Version F           Mark Walker            5th January 1994
4364: 0003: \***     Version letter incremented to match other IRF code.
4365: 0003: \***
4366: 0003: \***     Version 96A         Mark Walker               22nd May 1995
4367: 0003: \***     Definition for IRF.POINTS% added.
4368: 0003: \***
4369: 0003: \***                     Stuart McConnachie           12th June 1995
4370: 0003: \***     INDICAT3% comments added for discount/loyalty flags.
4371: 0003: \***
4372: 0003: \***     Version for 96C  Andrew Wedgeworth            22nd May 1996
4373: 0003: \***     Removed IRF.FILLER$ field, as this is now redundant.
4374: 0003: \***
4375: 0003: \***     Version G     Stuart William McConnachie      11th February 2000
4376: 0003: \***     Converted IRF.INDICAT2$ to integer flag byte.
4377: 0003: \***
4378: 0003: \***     REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
4379: 0003: \***     Major changes for 2002 Deals Rewrite project.
4380: 0003: \***     Incorporated up to date record layout to assist development work
4381: 0003: \***     (placed in the IRFDEC.J86 to make it visible from ...LST files).
4382: 0003: \***     Moved various comments against variables to record layout.
4383: 0003: \***     Relisted variables in alphabetical order.
4384: 0003: \***     Deleted redundant variables associated with the old deals system ...
4385: 0003: \***     DEAL.NUM$, DEAL.SAVING$
4386: 0003: \***     Retained variables that are otherwise redundant (to be set to null X'00'
4387: 0003: \***     within file functions) ...
4388: 0003: \***     INDICAT2%, INDICAT4%, SALEQUAN$, POINTS%
4389: 0003: \***     Defined variables to hold interpreted deals data for new deals system ...
4390: 0003: \***     DEAL.NUM$(n) and LIST.ID%(n) (where 'n' represents entry 0, 1 and 2).
4391: 0003: \***     These two variables are interpretations of DEAL.DATA% which is defined
4392: 0003: \***     locally within IRFFUN.BAS to keep underlying data invisible to programs.
4393: 0003: \***
4394: 0003: \***     REVISION 1.7                ROBERT COWEY.               5 AUG 2002.
4395: 0003: \***     Further changes for 2002 Deals Rewrite project (PSBF19 related).
4396: 0003: \***     Defined NEW.IRF.DATA$ as a global variable for use with new functions
4397: 0003: \***     CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
4398: 0003: \***
4399: 0003: \***     REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
4400: 0003: \***     Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
4401: 0003: \***     No changes to this file other than description.
4402: 0003: \***     No changes to IRF file functions.
4403: 0003: \***
4404: 0003: \***     REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
4405: 0003: \***     Changes to remove limit of 3 deals per item.
4406: 0003: \***     Declaration of new variables for IRF Deal Extension file (IRFDEX).
4407: 0003: \***
4408: 0003: \***     REVISION 2.0.            ALAN CARR                       9 FEB 2006.
4409: 0003: \***     Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
4410: 0003: \***
4411: 0003: \***     REVISION 2.1              TITTOO THOMAS                  01 July 2011
4412: 0003: \***     The IRF.UNUSED field is disintegrated to 2 new indicator fields
4413: 0003: \***                      IRF.INDICAT9%   1 INT
4414: 0003: \***                      IRF.INDICAT10%  1 INT
4415: 0003: \***...............................................................................
4416: 0003: 
4417: 0003: 
4418: 0003: \**********************************************************************************
4419: 0003: \***
4420: 0003: \***    IRF RECORD LAYOUT - REVISION 1.7 - CORRECT FOR 2011 CORE Stores PROJECT
4421: 0003: \***
4422: 0003: \***     1 11  UPD  BAR.CODE$   Without check digit - File KEY
4423: 0003: \***    12  1  INT  INDICAT0%
4424: 0003: \***                    X"01" - Contains statins                           ! 2.2 TT
4425: 0003: \***                    X"02" - Item not priced (giveaway)
4426: 0003: \***                    X"04" - Item not returnable
4427: 0003: \***                    X"08" - Item contains alcohol
4428: 0003: \***                    X"10" - Blocked from sale                          ! 2.2 TT
4429: 0003: \***                    X"20" - Enforced price entry
4430: 0003: \***                    X"40" - Enforced quantity entry
4431: 0003: \***                    X"80" - Movement kept
4432: 0003: \***    13  1  INT  INDICAT1%
4433: 0003: \***                    X"01" - Asprin
4434: 0003: \***                    X"02" - Paracetamol
4435: 0003: \***                    X"04" - TPLU inclusion flag
4436: 0003: \***                    X"08" - Giftcard item                              ! 2.2 TT
4437: 0003: \***                    X"10" - Withdrawn Block from sale                  ! 2.2 TT
4438: 0003: \***                    X"20" - Non-solid dose painkiller                  ! 2.2 TT
4439: 0003: \***                    X"40" - Insurance policy item                      ! 2.2 TT
4440: 0003: \***                    X"80" - Ibuprofen
4441: 0003: \***    14  2  INT  DEAL.DATA%(0)   Interpreted into sub-variables ...
4442: 0003: \***                    X'3F' - into DEAL.NUM$(0) "0000" to "9999" (2 byte UPD)
4443: 0003: \***                    X'C0' - into LIST.ID%(0) X'00' X
4444: 0003: \***                                             X'01' A
4445: 0003: \***                                             X'10' B
4446: 0003: \***                                             X'11' C                   ! 1.9 RC
4447: 0003: \***    16  1  INT  INDICAT8%                                              ! 2.0 AJC
4448: 0003: \***                    X"01" - Chlamydia NHS test kit                     ! 2.2 TT
4449: 0003: \***                    X"02" - Chlamydia open sell test kit               ! 2.2 TT
4450: 0003: \***                    X"04" - Unrestricted group code                    ! 2.2 TT
4451: 0003: \***                    X"08" - Nightingale Till prompt                    ! 2.2 TT
4452: 0003: \***                    X"10" - Contains Ephedrine                         ! 2.2 TT
4453: 0003: \***                    X"60" -  X'00' - If also Blocked From Sale Recall, ! 2.2 TT
4454: 0003: \***                                        Emergency                      ! 2.2 TT
4455: 0003: \***                             X'00' - If NOT Blocked From Sale Recall,  ! 2.2 TT
4456: 0003: \***                                        No recall                      ! 2.2 TT
4457: 0003: \***                             X'20' 100% returns                        ! 2.2 TT
4458: 0003: \***                             X'40' Withdrawn recall                    ! 2.2 TT
4459: 0003: \***                             X'60' Reverse Logistics                   ! 2.2 TT
4460: 0003: \***                    X"80" - WEEE item flag                             ! 2.0 AJC
4461: 0003: \***    17  1  INT  INDICAT9%
4462: 0003: \***                    X'3F' - Disposal special instruction (0-63)
4463: 0003: \***                    X"40" - Resaleable Indicator
4464: 0003: \***                    X"80" - Boots.com Extended Indicator
4465: 0003: \***    18  1  INT  INDICAT10%
4466: 0003: \***                    X'07' - Age restrictions
4467: 0003: \***                             X'00' - No Age restriction
4468: 0003: \***                             X'01' - Age 12 or over
4469: 0003: \***                             X'02' - Age 15 or over
4470: 0003: \***                             X'03' - Age 16 or over
4471: 0003: \***                             X'04' - Age 18 or over
4472: 0003: \***                             X'05' - Age 21 or over
4473: 0003: \***                             X'06' - Reserved
4474: 0003: \***                             X'07' - Reserved
4475: 0003: \***                    X'38' - Ethical classification
4476: 0003: \***                             X'00' - No ethical classification
4477: 0003: \***                             X'08' - Pharmacy medicine (P)
4478: 0003: \***                             X'10' - General Sale License (GSL)
4479: 0003: \***                             X'18' - Prescription Only Medicine (POM)
4480: 0003: \***                             X'20' - Reserved
4481: 0003: \***                             X'28' - Reserved
4482: 0003: \***                             X'30' - Reserved
4483: 0003: \***                             X'38' - Reserved
4484: 0003: \***                    X'C0' - Returns route
4485: 0003: \***                             X'00' - Not Returnable (Destroy)
4486: 0003: \***                             X'40' - Returns & Recovery
4487: 0003: \***                             X'80' - Direct
4488: 0003: \***                             X'C0' - Semi-centralised
4489: 0003: \***    19  5  UPD  SALEPRIC$   Current price in pence
4490: 0003: \***    24  1  INT  INDICAT5%   Guarantee duration
4491: 0003: \***                    X'3F' - Lowest 6 bits indicate duration (1-63)
4492: 0003: \***                    X'40' - Contains Pseudoephedrine                   ! 2.2 TT
4493: 0003: \***                    X'80' - Guarantee Duration Type                    ! 2.2 TT
4494: 0003: \***                              (1 = Months, 0 = Years)                  ! 2.2 TT
4495: 0003: \***    25 18  ASC  ITEMNAME$   Description used by till
4496: 0003: \***    43  3  UPD  BOOTS.CODE$ Without check digit
4497: 0003: \***    46  2  INT  DEAL.DATA%(1)   Similar structure to DEAL.DATA%(0)
4498: 0003: \***    48  2  INT  DEAL.DATA%(2)   Similar structure to DEAL.DATA%(0)
4499: 0003: \***    50  1  INT  INDICAT3%
4500: 0003: \***                    X"01" - Discountexempt (item exempt from discount)
4501: 0003: \***                    X"02" - Boots brand item
4502: 0003: \***                    X"04" - Item redeemable for loyalty
4503: 0003: \***                    X"08" - Loyalty exempt (item exempt from loyalty)
4504: 0003: \***                    X"10" - **Redundant                                ! 2.2 TT
4505: 0003: \***                    X"20" - Local Price active
4506: 0003: \***                    X"40" - Stock system item
4507: 0003: \***                    X"80" - **Redundant                                ! 2.2 TT
4508: 0003: \***
4509: 0003: \***    Record Length 50
4510: 0003: \***
4511: 0003: \***
4512: 0003: \***    IRF DEAL EXTENSION RECORD LAYOUT ! 1.9 RC
4513: 0003: \***
4514: 0003: \***     1  3  UPD  BOOTS.CODE$
4515: 0003: \***     4  2  INT  IRF.DEAL.DATA%(3)   Similar structure to DEAL.DATA%(0)
4516: 0003: \***     6  2  INT  IRF.DEAL.DATA%(4)   Similar structure to DEAL.DATA%(0)
4517: 0003: \***     8  2  INT  IRF.DEAL.DATA%(5)   Similar structure to DEAL.DATA%(0)
4518: 0003: \***    10  2  INT  IRF.DEAL.DATA%(6)   Similar structure to DEAL.DATA%(0)
4519: 0003: \***    12  2  INT  IRF.DEAL.DATA%(7)   Similar structure to DEAL.DATA%(0)
4520: 0003: \***    14  2  INT  IRF.DEAL.DATA%(8)   Similar structure to DEAL.DATA%(0)
4521: 0003: \***    16  2  INT  IRF.DEAL.DATA%(9)   Similar structure to DEAL.DATA%(0)
4522: 0003: \***
4523: 0003: \***    Record Length 17
4524: 0003: \***
4525: 0003: \**********************************************************************************
4526: 0003: 
4527: 0003: 
4528: 0003:     STRING GLOBAL            \
4529: 0003:         IRF.ALT.FILE.NAME$,  \
4530: 0003:         IRF.BAR.CODE$,       \
4531: 0003:         IRF.BOOTS.CODE$,     \
4532: 0003:         IRF.DEAL.SAVING$,    \ 2 byte - deal saving amount (0 - 99.99) ! ESP
4533: 0003:         IRF.DEPARTME$,       \ 3 byte UPD. Department number          ! ESP Delete
4534: 0003:         IRF.FILE.NAME$,      \
4535: 0003:         IRF.HOLDING.PRICE$,  \ 4 byte UPD. Current H.O. price in pence if a local
4536: 0003:                              \ price is in effect, zero otherwise.     ! ESP Delete
4537: 0003:         IRF.ITEMNAME$,       \
4538: 0003: \       IRF.MPGROUP$,        \ Removed SBH 31/1/96
4539: 0003:         IRF.RECORD$,         \                                         ! ESP Delete
4540: 0003:         IRF.SALEPRIC$,       \
4541: 0003:         IRF.SALEQUAN$,       \ Redundant (set to null within functions)    ! 1.6 RC
4542: 0003:         IRF.UNUSED$,         \                                                        ! 1.6 RC
4543: 0003:         NEW.IRF.DATA$        !                                             ! 1.7 RC
4544: 0003: 
4545: 0003:     STRING GLOBAL            \                                             ! 1.6 RC
4546: 0003:         IRF.DEAL.NUM$(1)                                                   ! 1.6 RC
4547: 0003: 
4548: 0003:     INTEGER*1 GLOBAL         \
4549: 0003:         IRF.DD.SUB%,         \ IRF.DEAL.DATA% subscript                    ! 1.6 RC
4550: 0003:         IRF.INDICAT0%,       \
4551: 0003:         IRF.INDICAT1%,       \
4552: 0003:         IRF.INDICAT2%,       \ Redundant (set to null within functions)    ! 1.6 RC
4553: 0003:         IRF.INDICAT3%,       \
4554: 0003:         IRF.INDICAT4%,       \ Redundant (set to null within functions)    ! 1.6 RC
4555: 0003:         IRF.INDICAT5%,       \                                             ! 2.0 AJC
4556: 0003:         IRF.INDICAT8%,       \                                             ! 2.0 AJC
4557: 0003:         IRF.INDICAT9%,       \                                             ! 2.2 TT
4558: 0003:         IRF.INDICAT10%                                                     ! 2.2 TT
4559: 0003: 
4560: 0003:     INTEGER*1 GLOBAL         \                                             ! 1.6 RC
4561: 0003:         IRF.LIST.ID%(1)                                                    ! 1.6 RC
4562: 0003: 
4563: 0003:     INTEGER*2 GLOBAL         \
4564: 0003:         IRF.ALT.REPORT.NUM%, \
4565: 0003:         IRF.ALT.SESS.NUM%,   \
4566: 0003:         IRF.POINTS%,         \ Redundant (set to null within functions)    ! 1.6 RC
4567: 0003:         IRF.RECL%,           \
4568: 0003:         IRF.REPORT.NUM%,     \
4569: 0003:         IRF.SESS.NUM%,       \
4570: 0003:         IRF.MAX.DEALS%       !                                             ! 1.9 SM
4571: 0003: 
4572: 0003:     STRING GLOBAL IRFDEX.FILE.NAME$                                        ! 1.9 SM
4573: 0003: 
4574: 0003:     INTEGER*2 GLOBAL IRFDEX.SESS.NUM%                                      ! 1.9 SM
4575: 0003:     INTEGER*2 GLOBAL IRFDEX.REPORT.NUM%                                    ! 1.9 SM
4576: 0003:     INTEGER*2 GLOBAL IRFDEX.RECL%                                          ! 1.9 SM
4577: 0003: 
4578: 0003: 
4579: 0003: !   INTEGER*2 GLOBAL      \ IRF.DEAL.DATA%(n) variables are defined locally  1.6 RC
4580: 0003: !       IRF.DEAL.DATA%(1) \ within IRFFUN.BAS to keep invisible to programs  1.6 RC
4581: 0003: 
4582: 0003:  %INCLUDE STKDCDEC.J86                    ! 1.8DA
4583: 0003: \******************************************************************************
4584: 0003: \******************************************************************************
4585: 0003: \***
4586: 0003: \***   $Workfile:   STKDCDEC.J86  $
4587: 0003: \***
4588: 0003: \***   $Revision:   1.0  $
4589: 0003: \***
4590: 0003: \******************************************************************************
4591: 0003: \******************************************************************************
4592: 0003: \***
4593: 0003: \***   $Log:   V:\archive\j86\stkdcdec.j8v  $
4594: 0003: \***   
4595: 0003: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
4596: 0003: \***    
4597: 0003: \***   
4598: 0003: \***      Rev 1.0   09 Jul 1997 11:04:58   DEV45PS
4599: 0003: \***   Stocktake System New Files
4600: 0003: \***   
4601: 0003: \******************************************************************************
4602: 0003: \******************************************************************************\******************************************************************************
4603: 0003: \******************************************************************************
4604: 0003: \***
4605: 0003: \***         %INCLUDE FOR STOCKTAKE DUMP CODEP FIELD DECLARATIONS
4606: 0003: \***
4607: 0003: \***               FILE TYPE    : DIRECT
4608: 0003: \***
4609: 0003: \***               REFERENCE    : STKDCDEC.J86
4610: 0003: \***
4611: 0003: \***    VERSION A.              Nik Sen.               19 Jun 1997.
4612: 0003: \***    New file for stocktaking system. Holds all items counted using
4613: 0003: \***    dump codes during the stocktake.
4614: 0003: \***
4615: 0003: \*******************************************************************************
4616: 0003: \*******************************************************************************
4617: 0003: 
4618: 0003: STRING GLOBAL                                                  \
4619: 0003:        STKDC.FILE.NAME$,               \
4620: 0003:        STKDC.DUMP.CODE$,               \
4621: 0003:        STKDC.QUANTITY$,                \
4622: 0003:        STKDC.PRICE$,                   \
4623: 0003:        STKDC.LOCATION$,                \
4624: 0003:        STKDC.STOCKTAKER.NUM$
4625: 0003:         
4626: 0003: INTEGER*4 GLOBAL               \
4627: 0003:        STKDC.RECORD.NUM%
4628: 0003: 
4629: 0003: 
4630: 0003: INTEGER*2 GLOBAL                \
4631: 0003:    STKDC.REPORT.NUM%,           \
4632: 0003:    STKDC.SESS.NUM%             
4633: 0003: 
4634: 0003: 
4635: 0003: INTEGER*1 GLOBAL                \
4636: 0003:    STKDC.RECL%         
4637: 0003: 
4638: 0003: 
4639: 0003:  %INCLUDE MINLSDEC.J86                    ! 1.9BG
4640: 0003: 
4641: 0003: \*****************************************************************************
4642: 0003: \*****************************************************************************
4643: 0003: \***
4644: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4645: 0003: \***
4646: 0003: \***                   FILE TYPE:  KEYED
4647: 0003: \***
4648: 0003: \***                   REFERENCE:  MINLSDEC.J86
4649: 0003: \***
4650: 0003: \***              DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
4651: 0003: \***
4652: 0003: \***
4653: 0003: \***
4654: 0003: \***      VERSION 1 : Julia Stones             8th January 1998  
4655: 0003: \***      
4656: 0003: \*****************************************************************************
4657: 0003: \*****************************************************************************
4658: 0003: 
4659: 0003: STRING GLOBAL   \
4660: 0003:    MINLS.FILE.NAME$,  \
4661: 0003:    MINLS.ITEM.CODE$,     \  4 byte UPD;  Record key
4662: 0003:    MINLS.RECOUNT.DATE$,  \  3 byte UPD;  YYMMDD      
4663: 0003:    MINLS.DISCREPANCY$,    \  3 byte UPD        
4664: 0003:    MINLS.COUNT.STATUS$     ! 1 byte ASCII 
4665: 0003: 
4666: 0003: INTEGER*2 GLOBAL  \
4667: 0003:    MINLS.RECL%,   \
4668: 0003:    MINLS.REPORT.NUM%,  \
4669: 0003:    MINLS.SESS.NUM%   !
4670: 0003: 
4671: 0003: 
4672: 0003: 
4673: 0003:  %INCLUDE NEGSCDEC.J86                    ! 1.9BG
4674: 0003: 
4675: 0003: \*****************************************************************************
4676: 0003: \*****************************************************************************
4677: 0003: \***
4678: 0003: \***        %INCLUDE FIELD DECLARATIONS AND FILE REFERENCE PARAMETERS
4679: 0003: \***
4680: 0003: \***                   FILE TYPE:  KEYED
4681: 0003: \***
4682: 0003: \***                   REFERENCE:  NEGSCDEC.J86
4683: 0003: \***
4684: 0003: \***              DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
4685: 0003: \***
4686: 0003: \***
4687: 0003: \***
4688: 0003: \***      VERSION 1 : Julia Stones             15th July 1999  
4689: 0003: \***      
4690: 0003: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
4691: 0003: \***    Changes for RF trial.
4692: 0003: \***    Recompiled to prevent future automatic recompiles.
4693: 0003: \***    No changes to actual code.
4694: 0003: \***
4695: 0003: \*****************************************************************************
4696: 0003: \*****************************************************************************
4697: 0003: 
4698: 0003: STRING GLOBAL   \
4699: 0003:    NEGSC.FILE.NAME$,  \
4700: 0003:    NEGSC.KEY$,   \      !  5 bytes UPD; 1 byte Record type 
4701: 0003:                         \                 Record type 01 item record
4702: 0003:                         \                 Record type 02 total count record
4703: 0003:                         \               4 bytes item code (set to zero's if
4704: 0003:                         \                 record type 02)
4705: 0003:    NEGSC.STATUS.1$      !  1 byte ASC
4706: 0003:                         !            'B' - Discontinued but still on display
4707: 0003:                         !            'C' - Cancel outstanding orders
4708: 0003:                         !            'D' - Discontinued and no longer on display
4709: 0003:                         !            'P' - Suspended (orders to Store)
4710: 0003:                         !            'X' - Deleted
4711: 0003:                         !            ' ' - No special Status (default value)
4712: 0003:   
4713: 0003: INTEGER*2 GLOBAL  \
4714: 0003:    NEGSC.RECL%,   \
4715: 0003:    NEGSC.REPORT.NUM%,  \
4716: 0003:    NEGSC.SESS.NUM%,    \
4717: 0003:    NEGSC.ITEM.TSF%,    \
4718: 0003:    NEGSC.NUMBER.OF.DAYS%   !
4719: 0003: 
4720: 0003: 
4721: 0003: 
4722: 0003:  %INCLUDE SSPSCDEC.J86                    ! 2.0JAS
4723: 0003: \*****************************************************************************
4724: 0003: \*****************************************************************************
4725: 0003: \***
4726: 0003: \***               %INCLUDE FOR SSPSCTRL - FIELD DECLARATIONS
4727: 0003: \***                                          FILE REFERENCE PARAMETERS
4728: 0003: \***
4729: 0003: \***                      FILE TYPE    : DIRECT
4730: 0003: \***
4731: 0003: \***                      REFERENCE    : SSPSCdea.J86
4732: 0003: \***
4733: 0003: \***    Version A               Julia Stones          23 Oct 2003
4734: 0003: \***
4735: 0003: \***
4736: 0003: \*****************************************************************************
4737: 0003: \*****************************************************************************
4738: 0003: 
4739: 0003: REM \
4740: 0003: 
4741: 0003:   STRING GLOBAL           \
4742: 0003:     SSPSCTRL.FILE.NAME$
4743: 0003: 
4744: 0003:   INTEGER*2 GLOBAL        \
4745: 0003:     SSPSCTRL.REPORT.NUM%,   \
4746: 0003:     SSPSCTRL.SESS.NUM%
4747: 0003: REM \
4748: 0003: 
4749: 0003:   STRING GLOBAL           \
4750: 0003:     SSPS.BTCSK.NUM$,      \ 3 byte, file ext number (000 - 999)
4751: 0003:     SSPS.BTCSF.NUM$,      \ 3 byte, file ext number (000 - 999)
4752: 0003:     SSPS.BTCSK.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4753: 0003:     SSPS.BTCSF.FTP$,      \ 3 byte, last file ext number sent to SMARTSCRIPT
4754: 0003:     SSPS.FILLER$          ! 68 byte, spaces
4755: 0003: 
4756: 0003:   INTEGER*2 GLOBAL        \
4757: 0003:     SSPSCTRL.RECL%
4758: 0003:  %INCLUDE BTCSDEC.J86                     ! 2.0JAS
4759: 0003: \*****************************************************************************
4760: 0003: \*****************************************************************************
4761: 0003: \***
4762: 0003: \***      %INCLUDE FOR BTCS FILE - FIELD DECLARATIONS
4763: 0003: \***                               FILE REFERENCE PARAMETERS
4764: 0003: \***
4765: 0003: \***      FILE TYPE    : DIRECT
4766: 0003: \***
4767: 0003: \***      REFERENCE    : BTCSDEC
4768: 0003: \***
4769: 0003: \***      VERSION A    : Julia Stones 22/10/03
4770: 0003: \***
4771: 0003: \*****************************************************************************
4772: 0003: \*****************************************************************************
4773: 0003: 
4774: 0003:     STRING GLOBAL        BTCS.FILE.NAME$
4775: 0003: 
4776: 0003: 
4777: 0003:     INTEGER*2 GLOBAL     BTCS.SESS.NUM%,        \
4778: 0003:                          BTCS.RECL%,            \
4779: 0003:                          BTCS.REPORT.NUM%
4780: 0003: 
4781: 0003: 
4782: 0003:     INTEGER*4 GLOBAL     BTCS.REC.NUM%
4783: 0003: 
4784: 0003: 
4785: 0003:     STRING GLOBAL        BTCS.RECORD$,           \ Whole record form file:
4786: 0003:                          BTCS.RECORD.TYPE$,      \ 1 ASC Type of record:
4787: 0003:                                                  \       "H" = header
4788: 0003:                                                  \       "D" = detail
4789: 0003:                                                  \       "T" = trailer
4790: 0003:                          BTCS.STORE.NUMBER$,     \ 4 ASC 4 digit Store number
4791: 0003:                          BTCS.STKTAKE.NUM$,      \ 4 ASC 4 digit Stock take number
4792: 0003:                          BTCS.DATE$,             \ 6 ASC Date YYMMDD
4793: 0003:                          BTCS.TIME$,             \ 6 ASC Time HHMMSS
4794: 0003:                          BTCS.DISP.AREA$,        \ 1 ASC M = MDS
4795: 0003:                                                  \       D = Dispensing
4796: 0003:                          BTCS.FILLER$,           \   ASC Set to spaces
4797: 0003:                          BTCS.NUM.RECORD$,       \ 4 ASC Record sequence number starting at 0001
4798: 0003:                          BTCS.ITEM.CODE$,        \13 ASC Item Code/PIP code
4799: 0003:                          BTCS.CODE.TYPE$,        \ 1 ASC E = EAN item code
4800: 0003:                                                  \       P = PIP code
4801: 0003:                          BTCS.PACK.QTY$,         \ 6 ASC Number of packs, bottles etc
4802: 0003:                          BTCS.DIS.UNIT.QTY$,     \ 4 ASC Dispensed unit quantity
4803: 0003:                          BTCS.RECORD.COUNT$,     \ 4 ASC Amount of records in file (inc header and trailer)
4804: 0003:                          BTCS.ENDREC$            \ 2 ASC ODOA
4805: 0003: 
4806: 0003:  %INCLUDE PRINTDEC.J86                    ! 2.0JAS
4807: 0003: 
4808: 0003: REM \
4809: 0003: \*******************************************************************************
4810: 0003: \*******************************************************************************
4811: 0003: \***
4812: 0003: \***    %INCLUDE FOR PRINT FILE VARIABLE DECLARATIONS
4813: 0003: \***
4814: 0003: \***        REFERENCE   :   PRINTDE (J86)
4815: 0003: \***
4816: 0003: \***        FILE TYPE   :   Printer / Labeller
4817: 0003: \***
4818: 0003: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
4819: 0003: \***    Original version created by merging PRINTFLG and PRINTNUG.
4820: 0003: \***
4821: 0003: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
4822: 0003: \***    Changes unknown.             
4823: 0003: \***
4824: 0003: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
4825: 0003: \***    No changes made to this file.
4826: 0003: \***
4827: 0003: \***    Version D               Andrew Wedgeworth                 24th May 1992
4828: 0003: \***    Variable added to contain condensed print record length.
4829: 0003: \***
4830: 0003: \*******************************************************************************
4831: 0003: \*******************************************************************************
4832: 0003: 
4833: 0003: 
4834: 0003:     STRING GLOBAL \
4835: 0003:         PRINT.LINE$, \
4836: 0003:         PRINT.FILE.NAME$, \
4837: 0003:         SELF.LAN.NAME$, \
4838: 0003:         SELF.NOLAN.NAME$
4839: 0003: 
4840: 0003:     INTEGER*2 GLOBAL \
4841: 0003:         PRINT.CONDENSED.RECL%, \                                       ! DAW  
4842: 0003:         PRINT.SESS.NUM%, \
4843: 0003:         PRINT.REPORT.NUM%, \
4844: 0003:         PRINT.REPORT.RECL%, \
4845: 0003:         PRINT.SELF.RECL%
4846: 0003: 
4847: 0003:  %INCLUDE SOPTSDEC.J86                    ! 2.1JAS
4848: 0003: REM \
4849: 0003: \******************************************************************************
4850: 0003: \******************************************************************************
4851: 0003: \***
4852: 0003: \***                 %INCLUDE FOR THE STORE OPTIONS FILE
4853: 0003: \***   
4854: 0003: \***                      FILE TYPE  :   Direct
4855: 0003: \***
4856: 0003: \***                      REFERENCE  :   SOPTSDEC.J86
4857: 0003: \***
4858: 0003: \***    Version A         Stuart William McConnachie      19th June 1995
4859: 0003: \***
4860: 0003: \******************************************************************************
4861: 0003: \*******************************************************************************
4862: 0003: 
4863: 0003:   STRING GLOBAL           \
4864: 0003:     SOPTS.RECORD$,        \           
4865: 0003:     SOPTS.SPACE$,         \           
4866: 0003:     SOPTS.FILE.NAME$
4867: 0003:     
4868: 0003:   INTEGER*2 GLOBAL        \
4869: 0003:     SOPTS.RECL%,          \            
4870: 0003:     SOPTS.REPORT.NUM%,    \      
4871: 0003:     SOPTS.SESS.NUM%
4872: 0003: 
4873: 0003:   INTEGER*4 GLOBAL        \
4874: 0003:     SOPTS.REC.NUM%
4875: 0003: 
4876: 0003:  %INCLUDE TSFDEC.J86                      ! 2.1JAS
4877: 0003: \*****************************************************************************
4878: 0003: \*****************************************************************************
4879: 0003: \***
4880: 0003: \***      %INCLUDE FOR TERMINAL STATUS FILE - FIELD DECLARATIONS
4881: 0003: \***                                          FILE REFERENCE PARAMETERS
4882: 0003: \***
4883: 0003: \***                      FILE TYPE    : KEYED
4884: 0003: \***
4885: 0003: \***                      REFERENCE    : TSFDEC
4886: 0003: \***
4887: 0003: \***           VERSION A : STEVEN GOULDING              13.10.92
4888: 0003: \***
4889: 0003: \***           VERSION B : STEVE WINDSOR                15.09.93
4890: 0003: \***           Updated to keep in step.
4891: 0003: \***
4892: 0003: \***           VERSION C : STUART WILLIAM MCCONNACHIE   18.03.97
4893: 0003: \***           Added extra fields in user data.
4894: 0003: \*** 
4895: 0003: \***           VERSION D : REBECCA DAKIN                22.02.99
4896: 0003: \***           Added ACSALD.CUT.OFF, as part of Cash Accounting project.
4897: 0003: \***
4898: 0003: \***           VERSION E : AMY HOGGARD                  16.10.00
4899: 0003: \***           Added TILLBAG.CUT.OFF, as part of ECO project.
4900: 0003: \***
4901: 0003: \***           VERSION F : STUART WILLIAM MCCONNACHIE   20.05.05
4902: 0003: \***           Added "new" fields as no one else can be bothered.
4903: 0003: \***           Corrected offset bug of controller ID.
4904: 0003: \***
4905: 0003: \***           VERSION G : JAMIE THORPE                 05.10.05
4906: 0003: \***           Added new INVDUE.DATE record to the store record 
4907: 0003: \***           (for Zero TSF proj.)
4908: 0003: \***           This is the date that the most recent INVDUE file
4909: 0003: \***           was created.
4910: 0003: \***
4911: 0003: \***    VERSION H               Mark Walker                      3rd Nov 2014
4912: 0003: \***    F294 PCI Phase 1
4913: 0003: \***    Includes the following changes:
4914: 0003: \***    - Removed redundant 'smartcard software level' field.
4915: 0003: \***    - Extended TSF.INDICAT2% integer field from 1 to 2 bytes.
4916: 0003: \***
4917: 0003: \*****************************************************************************
4918: 0003: \*****************************************************************************
4919: 0003: 
4920: 0003:     STRING GLOBAL               \
4921: 0003:         TSF.FILE.NAME$,         \
4922: 0003:         TSF.REC$(1),            \ One dimensional array
4923: 0003:         TSF.SECTOR.FILLER$,     \
4924: 0003:         TSF.SECTOR.INFO$
4925: 0003:         
4926: 0003:     INTEGER*1 GLOBAL            \
4927: 0003:         TSF.REC.SUB%            ! Subscript used with TSF.REC array
4928: 0003: 
4929: 0003:     INTEGER*2 GLOBAL            \
4930: 0003:         TSF.SESS.NUM%,          \
4931: 0003:         TSF.RECL%,              \
4932: 0003:         TSF.REPORT.NUM%,        \
4933: 0003:         TSF.SECTOR.NUM%
4934: 0003: 
4935: 0003:     STRING GLOBAL               \
4936: 0003:         TSF.TERM.STORE$,        \ 2 byte UPD.Terminal number or 
4937: 0003:                                 \ 9999 for store (key)
4938: 0003:         TSF.TSL.NAME$,          \ 8 bytes. Most recent old TSL file
4939: 0003:         TSF.MONITOR$,           \ 2 byte UPD last monitoring terminal
4940: 0003:         TSF.TLOGFLAG$,          \ 1 byte, EALLGHC processed flag
4941: 0003:         TSF.OPERATOR$,          \ Operator number
4942: 0003:         TSF.TRANSNUM$,          \ Most recent transaction
4943: 0003:         TSF.RCPSTATUS$,         \ Store close requested through RCF                                                             
4944: 0003:         TSF.SIGN.OFF.DELAY$,    \ 1 byte PD counter to auto sign off    \  !CSWM
4945: 0003:         TSF.USER$,              \ User data
4946: 0003:         TSF.CONTROLLER$,        \ Controller ID
4947: 0003:         TSF.INVDUE.DATE$,       \ Creation date of the INVDUE
4948: 0003:                                 \ (Updated by PSS33)                    \   !GJT
4949: 0003:         TSF.SPACE$              ! 34 bytes or 14 bytes
4950: 0003: 
4951: 0003:     INTEGER*1 GLOBAL            \
4952: 0003:         TSF.INDICAT0%,          \ Indicator byte 0
4953: 0003:         TSF.INDICAT1%,          \ Indicator byte 1
4954: 0003: \       TSF.INDICAT2%,          \ Indicator byte 2                      \   !HMW
4955: 0003:         TSF.MTSL.CUT.OFF%,      \ MTSL cut-off required flag            \  !CSWM
4956: 0003:         TSF.CUSTD.CUT.OFF%,     \ CUSTD cut-off required flag           \  !CSWM
4957: 0003:         TSF.ACSAL.CUT.OFF%,     \ ACSAL cut-off required flag               !DRD
4958: 0003:         TSF.TILLBAG.CUT.OFF%    ! TILLBAG cut-off required flag             !EAH
4959: 0003:     
4960: 0003:     INTEGER*2 GLOBAL            \
4961: 0003: \       TSF.SC.LEVEL%           ! Smartcard software level              \   !HMW
4962: 0003:         TSF.INDICAT2%           ! Indicator flags 2                         !HMW
4963: 0003: 
4964: 0003:     INTEGER*4 GLOBAL            \
4965: 0003:         TSF.GROSSPOS,           \ Gross plus
4966: 0003:         TSF.GROSSNEG,           \ Gross minus
4967: 0003:         TSF.NETCASH,            \ Net cash
4968: 0003:         TSF.NETNCASH,           \ Net non-cash
4969: 0003:         TSF.AMTLOAN,            \ Loans
4970: 0003:         TSF.AMTPICKU,           \ Withdrawals
4971: 0003:         TSF.AMTCASHC,           \ Cash count
4972: 0003:         TSF.NETCCURR,           \ Net cash currency face value
4973: 0003:         TSF.NETCCCURR           ! Net cash count currency face value
4974: 0003: 
4975: 0003:  %INCLUDE LOCALDEC.J86                    ! 2.1JAS
4976: 0003: \***********************************************************************
4977: 0003: \***********************************************************************
4978: 0003: \***
4979: 0003: \***    DESCRIPTION: Local Price File
4980: 0003: \***                 Field Definitions
4981: 0003: \***
4982: 0003: \***    FILE TYPE : Keyed
4983: 0003: \***
4984: 0003: \***********************************************************************
4985: 0003: \***
4986: 0003: \***    Version A.          Paul Flanagan                1st Jul 1993
4987: 0003: \***    Initial version.
4988: 0003: \***
4989: 0003: \***    Version B.          Clive Norris                24th Nov 1993
4990: 0003: \***    AUTH.NUM$, STOCK.FIG$ and RETRIEVAL.FLAG$ replaced filler as
4991: 0003: \***    part of the RETURNS/AUTOMATIC CREDIT CLAIMING package.
4992: 0003: \***
4993: 0003: \***    Version C.          Mick Bayliss                 6th Dec 1994
4994: 0003: \***    Added missing field.
4995: 0003: \***
4996: 0003: \***    Version D.          Mark Walker                  1st Jul 2015
4997: 0003: \***    F392 Retail Stock 5
4998: 0003: \***    Added key length field.
4999: 0003: \***
5000: 0003: \***********************************************************************
5001: 0003: \***********************************************************************
5002: 0003: 
5003: 0003:     STRING GLOBAL             \
5004: 0003:         LOCAL.AUTH.NUM$,      \ 4 bytes UPD Auth'n number
5005: 0003:                               \             from Business Centre.
5006: 0003:         LOCAL.END.DATE$,      \ 3 bytes UPD yymmdd.
5007: 0003:         LOCAL.FILE.NAME$,     \
5008: 0003:         LOCAL.H.O.PRICE$,     \ 5 byte UPD.
5009: 0003:         LOCAL.HO.CHANGE$,     \ 3 bytes UPD. Date of HO price change
5010: 0003:                               \ (this will be zero if no change since
5011: 0003:                               \ local price was initiated).
5012: 0003:         LOCAL.ITEM.CODE$,     \ 4 bytes UPD (key) Boots code 
5013: 0003:                               \                   with check digit. 
5014: 0003:         LOCAL.OPERATOR$,      \ 4 bytes UPD operator id (when set up).
5015: 0003:         LOCAL.PRICE$,         \ 5 bytes UPD.
5016: 0003:         LOCAL.REASON$,        \ 4 byte ASCII 
5017: 0003:         LOCAL.RETRIEVAL.FLAG$,\ 1 byte ASC "Y" or "N"  
5018: 0003:         LOCAL.SPACE$,         \                                            !CMJB
5019: 0003:         LOCAL.START.DATE$,    \ 3 bytes UPD yymmdd. 
5020: 0003:         LOCAL.START.TIME$     ! 2 bytes UPD hhmm.
5021: 0003:         
5022: 0003:     INTEGER*2 GLOBAL          \
5023: 0003:         LOCAL.KEYL%,          \                                             !DMW
5024: 0003:         LOCAL.RECL%,          \
5025: 0003:         LOCAL.REPORT.NUM%,    \
5026: 0003:         LOCAL.SESS.NUM%,      \
5027: 0003:         LOCAL.STOCK.FIG%      !  No. of items authorised at the price.
5028: 0003: 
5029: 0003:  %INCLUDE CCREJDEC.J86                    ! 1.2JAS
5030: 0003: REM \
5031: 0003: \******************************************************************************
5032: 0003: \******************************************************************************
5033: 0003: \***
5034: 0003: \***      %INCLUDE FOR CREDIT CLAIMING REJECT FILE FIELD DECLARATIONS
5035: 0003: \***                                          FILE REFERENCE PARAMETERS
5036: 0003: \***
5037: 0003: \***               FILE TYPE    : Sequential
5038: 0003: \***
5039: 0003: \***               REFERENCE    : CCREJDEC.J86
5040: 0003: \***
5041: 0003: \***      Version A.     Julia Stones           11th March 2004.
5042: 0003: \***
5043: 0003: \******************************************************************************
5044: 0003: \*******************************************************************************
5045: 0003: \***
5046: 0003: \***
5047: 0003: \***
5048: 0003: \******************************************************************************
5049: 0003: 
5050: 0003:   STRING GLOBAL              \
5051: 0003:     CCREJ.FILE.NAME$,        \
5052: 0003:     CCREJC.FILE.NAME$,       \
5053: 0003:     CCREJP.FILE.NAME$,       \
5054: 0003:     CCREJ.RECORD$,           \ Used to store the whole record which is unstrung
5055: 0003:                              \ into the fields below
5056: 0003:     CCREJ.ENDREC.MARKER$,    \ 2 bytes ASCII set to XODOA
5057: 0003:     CCREJ.DATE$,             \ 8 byte ASCII
5058: 0003:     CCREJ.RETURN.REASON$,    \ 2 byte ASCII
5059: 0003:     CCREJ.BC.LETTER$,        \ 1 byte ASCII
5060: 0003:     CCREJ.UOD.NUM$,          \ 14 byte ASCII
5061: 0003:     CCREJ.ITEM.BARCODE.FLAG$,\ 1 byte ASC;  "I" = Boots item code,
5062: 0003:               \                             "B" = Barcode.
5063: 0003:     CCREJ.ITEM.BARCODE$,     \ 12 byte ASCII
5064: 0003:     CCREJ.DESC$,             \ 24 byte ASCII
5065: 0003:     CCREJ.ITEM.BC$,          \ 1 byte ASCII
5066: 0003:     CCREJ.ITEM.QTY$,         \ 4 byte ASCII
5067: 0003:     CCREJ.REJECT.REASON$     ! 1 byte ASCII "1" = Item not on file
5068: 0003:                              !              "2" = Credit Claim not allowed against this
5069: 0003:                              !                    Business Centre
5070: 0003:                              !              "3" = Item does not belong to Business Centre
5071: 0003:                              !                    being claimed against
5072: 0003: 
5073: 0003: 
5074: 0003:   INTEGER*2 GLOBAL           \
5075: 0003:     CCREJ.RECL%,             \
5076: 0003:     CCREJC.RECL%,            \
5077: 0003:     CCREJP.RECL%,            \
5078: 0003:     CCREJC.SESS.NUM%,        \
5079: 0003:     CCREJP.SESS.NUM%,        \
5080: 0003:     CCREJ.SESS.NUM%,         \
5081: 0003:     CCREJC.REPORT.NUM%,      \
5082: 0003:     CCREJP.REPORT.NUM%,      \
5083: 0003:     CCREJ.REPORT.NUM%
5084: 0003: 
5085: 0003: 
5086: 0003:  %INCLUDE RBDEC.J86                       ! 2.6BG
5087: 0003: \/******************************************************************/
5088: 0003: \/*                                                                */
5089: 0003: \/* Recalls Buffer FILE GLOBAL VARIABLE DECLARATIONS               */
5090: 0003: \/*                                                                */
5091: 0003: \/* REFERENCE   : RBDEC.J86                                        */
5092: 0003: \/*                                                                */
5093: 0003: \/* VERSION A.          Brian Greenfield        11th may 2007      */
5094: 0003: \/*                                                                */
5095: 0003: \/******************************************************************/
5096: 0003: 
5097: 0003:    STRING GLOBAL                \
5098: 0003:       RB.FILE.NAME$,            \
5099: 0003:                                 \
5100: 0003:       RB.RCD$,                  \  ? bytes  (25/14/12)
5101: 0003:       RB.REC.TYPE$,             \  1 byte   (H/D/T)
5102: 0003:       RB.REFERENCE$,            \  8 bytes
5103: 0003:       RB.LABEL$,                \ 14 bytes (8 bytes label type)
5104: 0003:                                 \          (6 bytes label number)
5105: 0003:       RB.ITEM.CODE$,            \  7 bytes (with check digit)
5106: 0003:       RB.STOCK.COUNT$,          \  4 bytes (1 - 9999)
5107: 0003:       RB.ITEM.COUNT$,           \  5 bytes (1 - 99999)
5108: 0003:       RB.RECORD.COUNT$          !  4 bytes (1 - 9999 inc header and trailer)
5109: 0003: 
5110: 0003:    INTEGER*2 GLOBAL             \
5111: 0003:       RB.REPORT.NUM%,           \
5112: 0003:       RB.SESS.NUM%              !
5113: 0003: 
5114: 0003: \/******************************************************************/
5115: 0003:  %INCLUDE REWKFDEC.J86                    ! 2.6BG
5116: 0003: \/******************************************************************/
5117: 0003: \/*                                                                */
5118: 0003: \/* Recalls Work FILE GLOBAL VARIABLE DECLARATIONS                 */
5119: 0003: \/*                                                                */
5120: 0003: \/* REFERENCE   : REWKFDEC.J86                                     */
5121: 0003: \/*                                                                */
5122: 0003: \/* VERSION A.          Brian Greenfield        11th may 2007      */
5123: 0003: \/*                                                                */
5124: 0003: \/* VERSION B.          Brian Greenfield        15th April 2008    */
5125: 0003: \/*                                                                */
5126: 0003: \/* VERSION C.          Brian Greenfield        6th May 2008       */
5127: 0003: \/*                                                                */
5128: 0003: \/******************************************************************/
5129: 0003: 
5130: 0003:    STRING GLOBAL                \
5131: 0003:       REWKF.FILE.NAME$,         \
5132: 0003:                                 \
5133: 0003:       REWKF.RCD$,               \  ? bytes  (25/47/8)
5134: 0003:       REWKF.REC.TYPE$,          \  1 byte   (H/D/T)
5135: 0003:       REWKF.REFERENCE$,         \  8 bytes
5136: 0003:       REWKF.LABEL$,             \ 14 bytes (8 bytes label type)
5137: 0003:                                 \          (6 bytes label number - zero's)
5138: 0003:       REWKF.BATCH.TYPE$,        \  1 byte  (E/F/R/S/W/X/I/C) !BBG
5139: 0003:       REWKF.MRQ$,               \  2 bytes ASCII !CBG
5140: 0003:       REWKF.DUE.BY.DATE$,       \  8 bytes (YYYYMMDD) !BBG
5141: 0003:       REWKF.BARCODE$,           \ 13 bytes (with check digit)
5142: 0003:       REWKF.ITEM.CODE$,         \  7 bytes (with check digit)
5143: 0003:       REWKF.DESCRIPTION$,       \ 20 bytes (truncated from the IDF)
5144: 0003:       REWKF.TSF$,               \  4 bytes (1 - 9999 or SPACES for recall types F, S, & X)
5145: 0003:       REWKF.ITEM.COUNT$         !  5 bytes (1 - 99999)
5146: 0003:       
5147: 0003:    INTEGER*2 GLOBAL             \
5148: 0003:       REWKF.REPORT.NUM%,        \
5149: 0003:       REWKF.SESS.NUM%           !
5150: 0003: 
5151: 0003: \/******************************************************************/
5152: 0003:  %INCLUDE RECALDEC.J86                    ! 2.6BG
5153: 0003: \******************************************************************************
5154: 0003: \******************************************************************************
5155: 0003: \***
5156: 0003: \***         INCLUDE FOR RECALLS.BIN DECLARATIONS
5157: 0003: \***
5158: 0003: \***               FILE TYPE    : Keyed
5159: 0003: \***
5160: 0003: \***               REFERENCE    : RECALDEC.J86
5161: 0003: \***
5162: 0003: \***    VERSION A               BRIAN GREENFIELD                    14th May 2007
5163: 0003: \***    Initial Version
5164: 0003: \***
5165: 0003: \***    Version B               BRIAN GREENFIELD                    20th June 2007
5166: 0003: \***    Altered due to a change in the file layout.
5167: 0003: \***
5168: 0003: \*******************************************************************************
5169: 0003: \*******************************************************************************
5170: 0003: 
5171: 0003:   STRING GLOBAL                \
5172: 0003:     RECALLS.FILE.NAME$,        \
5173: 0003:                                \
5174: 0003:     RECALLS.REFERENCE$,        \ 8 bytes UPD  - Key is reference + RECALLS.CHAIN%
5175: 0003:     RECALLS.TYPE$,             \ 1 byte  ASC  - E = Emergency
5176: 0003:                                \                F = Batch Emergency
5177: 0003:                                \                G = generic items not authorised for sale
5178: 0003:                                \                R = 100% Returns
5179: 0003:                                \                S = Batch 100% Returns
5180: 0003:                                \                W = Withdrawn
5181: 0003:                                \                X = batch Withdrawn
5182: 0003:     RECALLS.DESCRIPTION$,      \ 20 bytes ASC
5183: 0003:     RECALLS.LABEL.TYPE$,       \ 8 bytes ASC
5184: 0003:     RECALLS.SUPPLY.ROUTE$,     \ 1 byte ASC
5185: 0003:     RECALLS.REASON.CODE$,      \ 1 byte ASC
5186: 0003:     RECALLS.BC$,               \ 1 byte ASC
5187: 0003:     RECALLS.ACTIVE.DATE$,      \ 8 bytes ASC  - YYYYMMDD
5188: 0003:     RECALLS.DUE.BY.DATE$,      \ 8 bytes ASC  - YYYYMMDD
5189: 0003:     RECALLS.COMPLETION.DATE$,  \ 8 bytes ASC  - YYYYMMDD
5190: 0003:     RECALLS.STATUS$,           \ 1 byte ASC   - N = Not Actioned, A = Actioned, P = Partially Actioned
5191: 0003:     RECALLS.BATCH.NUM$,        \ 30 bytes ASC
5192: 0003:     RECALLS.ITEM.COUNT$,       \ 4 bytes ASC  - Total count of items in this recall
5193: 0003:                                \
5194: 0003:                                \ The following 8 bytes are repeated for the number of items in this part
5195: 0003:                                \ of the recall chain - up to 50 items per chain.
5196: 0003:     RECALLS.ITEM.CODE$(1),     \ 4 bytes PD   - 6 digit Item Code
5197: 0003:     RECALLS.ITEM.STOCK$(1),    \ 2 bytes PD   - SPACES if not yet actioned                         !BBG
5198: 0003:     RECALLS.SESS.STOCK$(1),    \ 2 bytes PD   - 4 digit session stock count - used only by the PPC !BBG
5199: 0003:     RECALLS.ITEM.UPT.FLAG$(1), \ 1 byte ASC   - used by the PPC only - Y = actioned, N - reset, space = unactioned
5200: 0003:                                \
5201: 0003:     RECALLS.FILLER$            !
5202: 0003:     
5203: 0003:   INTEGER*1 GLOBAL             \
5204: 0003:     RECALLS.CHAIN%
5205: 0003:     
5206: 0003:   INTEGER*2 GLOBAL             \
5207: 0003:     RECALLS.RECL%,             \
5208: 0003:     RECALLS.KEYL%,             \
5209: 0003:     RECALLS.REPORT.NUM%,       \
5210: 0003:     RECALLS.SESS.NUM%,         \
5211: 0003:     RECALLS.MAX.REC.ITEMS%
5212: 0003: 
5213: 0003: 
5214: 0003:  %INCLUDE DELVIDEC.J86                    ! 2.7SH
5215: 0003: \/******************************************************************/
5216: 0003: \/*                                                                */
5217: 0003: \/* DELVINDX FILE GLOBAl VARIABLE DECLARATIONS                     */
5218: 0003: \/*                                                                */
5219: 0003: \/* REFERENCE   : DELVIDEC.J86                                     */
5220: 0003: \/*                                                                */
5221: 0003: \/* VERSION A.          Stuart Highley              14 July 2008   */
5222: 0003: \/*                                                                */
5223: 0003: \/* VERSION B.          Stuart Highley               18 Dec 2008   */
5224: 0003: \/* Make file fixed rec length.                                    */
5225: 0003: \/******************************************************************/
5226: 0003: 
5227: 0003:    STRING GLOBAL                    \
5228: 0003:       DELVINDX.FILE.NAME$,          \
5229: 0003:       DELVINDX.FILLER$,             \
5230: 0003:       DELVINDX.ASN.NUM$,            \
5231: 0003:       DELVINDX.ASN.CARTON.COUNT$,   \
5232: 0003:       DELVINDX.UOD.LICENCE$,        \
5233: 0003:       DELVINDX.UOD.DESPATCH.DATE$,  \
5234: 0003:       DELVINDX.UOD.BOL.FLAG$,       \
5235: 0003:       DELVINDX.UOD.SEQ$,            \
5236: 0003:       DELVINDX.UOD.PARENT$,         \
5237: 0003:       DELVINDX.UOD.TYPE$,           \
5238: 0003:       DELVINDX.UOD.EXP.DEL.DATE$
5239: 0003: 
5240: 0003:    INTEGER*2 GLOBAL             \
5241: 0003:       DELVINDX.REPORT.NUM%,     \
5242: 0003:       DELVINDX.SESS.NUM%
5243: 0003: 
5244: 0003: \/******************************************************************/
5245: 0003:  %INCLUDE UODOTDEC.J86                    ! 2.7SH
5246: 0003: \*******************************************************************************
5247: 0003: \***
5248: 0003: \***    UOD Outers FILE GLOBAl VARIABLE DECLARATIONS
5249: 0003: \***
5250: 0003: \***    REFERENCE   : UODOTDEC.J86
5251: 0003: \***
5252: 0003: \***    VERSION A.              Stuart Highley                  14th Jul 2008
5253: 0003: \***
5254: 0003: \***    VERSION B.              Mark Goode                      10th Dec 2008
5255: 0003: \***    Add summary record read/write functionality.
5256: 0003: \***
5257: 0003: \***    REVISION 1.8.           Robert Cowey                    14th Jan 2009
5258: 0003: \***    Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
5259: 0003: \***    No new variables but defined new function UODOT.REC$.
5260: 0003: \***
5261: 0003: \***    VERSION C.              Mark Walker                     18th Feb 2015
5262: 0003: \***    F391 HUMSS UOD Messaging
5263: 0003: \***    Includes the following changes:
5264: 0003: \***    - Defined UOD number field.
5265: 0003: \***    - Various coding standards related changes (uncommented).
5266: 0003: \***
5267: 0003: \*******************************************************************************
5268: 0003: 
5269: 0003:     STRING GLOBAL                                                       \
5270: 0003:         UODOT.AUDIT.OP.ID$,                                             \
5271: 0003:         UODOT.BOOKED.DATE$,                                             \
5272: 0003:         UODOT.BOOKED.TIME$,                                             \
5273: 0003:         UODOT.CHILD.LICENCE$(1),                                        \
5274: 0003:         UODOT.CHILD.TYPE$(1),                                           \
5275: 0003:         UODOT.DESPATCH.DATE$,                                           \
5276: 0003:         UODOT.DRVR.DEL.DATE$,                                           \
5277: 0003:         UODOT.DRVR.DEL.TIME$,                                           \
5278: 0003:         UODOT.DRVR.ID$,                                                 \
5279: 0003:         UODOT.EST.DEL.DATE$,                                            \
5280: 0003:         UODOT.FILE.NAME$,                                               \
5281: 0003:         UODOT.FILLER$,                                                  \
5282: 0003:         UODOT.IMMEDIATE.PARENT$,                                        \
5283: 0003:         UODOT.LEVEL$,                                                   \
5284: 0003:         UODOT.LICENCE$,                                                 \
5285: 0003:         UODOT.OPEN.FLAG$,                                               \
5286: 0003:         UODOT.REASON$,                                                  \
5287: 0003:         UODOT.STATUS$,                                                  \
5288: 0003:         UODOT.STORE.OP.ID$,                                             \
5289: 0003:         UODOT.SUMMARY.STATUS$,                                          \   !BMG
5290: 0003:         UODOT.TYPE$,                                                    \
5291: 0003:         UODOT.ULTIMATE.PARENT$,                                         \
5292: 0003:         UODOT.UOD.NUMBER$,                                              \   !CMW
5293: 0003:         UODOT.WAREHOUSE.AREA$
5294: 0003: 
5295: 0003:     INTEGER*1 GLOBAL                                                    \
5296: 0003:         UODOT.BOL,                                                      \
5297: 0003:         UODOT.SDPD
5298: 0003: 
5299: 0003:     INTEGER*2 GLOBAL                                                    \
5300: 0003:         UODOT.AUDITED,                                                  \
5301: 0003:         UODOT.AUTO,                                                     \
5302: 0003:         UODOT.BOOKED,                                                   \
5303: 0003:         UODOT.CONTROLLER,                                               \
5304: 0003:         UODOT.GIT.MISMATCH,                                             \
5305: 0003:         UODOT.KEYL%,                                                    \
5306: 0003:         UODOT.MAX.CHILDREN%,                                            \
5307: 0003:         UODOT.MC70,                                                     \
5308: 0003:         UODOT.NUM.CHILDREN%,                                            \
5309: 0003:         UODOT.NUM.ITEMS%,                                               \
5310: 0003:         UODOT.PARTIAL,                                                  \
5311: 0003:         UODOT.PDT,                                                      \
5312: 0003:         UODOT.RECL%,                                                    \
5313: 0003:         UODOT.REPORT.NUM%,                                              \
5314: 0003:         UODOT.RF,                                                       \
5315: 0003:         UODOT.SEQ%,                                                     \
5316: 0003:         UODOT.SESS.NUM%,                                                \
5317: 0003:         UODOT.STOCK.UPDATED
5318: 0003: 
5319: 0003:  %INCLUDE AFDEC.J86                       ! 2.7SH
5320: 0003: 
5321: 0003: \REM
5322: 0003: \*******************************************************************************
5323: 0003: \*******************************************************************************
5324: 0003: \***
5325: 0003: \***    %INCLUDE FOR GSA AUTHORISATION FILE VARIABLE DECLARATIONS
5326: 0003: \***
5327: 0003: \***        REFERENCE   :  AFDEC (J86)
5328: 0003: \***
5329: 0003: \***        FILE TYPE   :  Keyed
5330: 0003: \***
5331: 0003: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
5332: 0003: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
5333: 0003: \***
5334: 0003: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
5335: 0003: \***    Original version created by merging AFFLDD and AFNUMD.
5336: 0003: \***
5337: 0003: \***    VERSION B.              Steve Windsor                          Nov 1992.
5338: 0003: \***    Addition of new fields for the CASTLE project.
5339: 0003: \***    Supervisor flag and operator model.
5340: 0003: \***
5341: 0003: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
5342: 0003: \***    Defined fields DATE.PSWD.CHANGE$, and MODEL.FLAGS.1% and ...2%.
5343: 0003: \***
5344: 0003: \***    VERSION D.             Mike Bishop                          30 JUN 2004
5345: 0003: \***    Defined field AF.STAFF.NUM$ AF.EMPLOYEE.FLAG$
5346: 0003: \***
5347: 0003: \***    VERSION E.             Alan Carr  (AJC)                      4 Oct 2004
5348: 0003: \***    Defined field AF.RECEIPT.NAME$
5349: 0003: \***
5350: 0003: \***    VERSION F.             Alan Carr  (AJC)                     31 Jan 2005
5351: 0003: \***    Defined field AF.GROUP.CODE$
5352: 0003: \***
5353: 0003: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
5354: 0003: \***    Changes for A9C POS improvements project.
5355: 0003: \***    Used up last available three bytes of EALAUTH user data by redefining 
5356: 0003: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
5357: 0003: \***    See IBM manual "GSA Programming Guide" Appendix A-27 for file layout 
5358: 0003: \***    describing INDICAT flags (and position of original 20 bytes user data).
5359: 0003: \***
5360: 0003: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
5361: 0003: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
5362: 0003: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format as UPD-hex DDMCYY.
5363: 0003: \***    Description text change only - No code changes to this file.
5364: 0003: \***
5365: 0003: \*******************************************************************************
5366: 0003: \*******************************************************************************
5367: 0003: 
5368: 0003: 
5369: 0003:     STRING GLOBAL \
5370: 0003:         AF.BIRTH.DATE$,       \ ! 3 byte DDMCYY UPD/hex format         ! 1.7 RC
5371: 0003:                               \ ! M is month  A=Oct B=Nov C=Dec        ! 1.7 RC
5372: 0003:                               \ ! C is century  0=19xx 1=20xx          ! 1.7 RC
5373: 0003:         AF.DATE.PSWD.CHANGE$, \ ! 3 bytes UPD                          ! CRC
5374: 0003:         AF.FILE.NAME$, \
5375: 0003:         AF.FLAGS.01.12$, \      ! 15 bytes
5376: 0003:         AF.FLAGS.13.16$, \      ! 4 bytes
5377: 0003:         AF.OPERATOR.NAME$,\     ! 20 bytes
5378: 0003:         AF.OPERATOR.NO$, \      ! 4 byte UPD (key)
5379: 0003:         AF.OPTIONS.KEY$, \      ! 1 byte UPD
5380: 0003:         AF.PASSWORD$, \         ! 4 byte UPD
5381: 0003:         AF.RECEIPT.NAME$, \     ! 12 bytes                             ! AJC
5382: 0003:         AF.STAFF.NUM$, \         ! 4 byte UPD                          DMB
5383: 0003:         AF.EMPLOYEE.FLAG$, \     ! 1 byte UPD                          DMB
5384: 0003:         AF.GROUP.CODE$, \       ! 1  byte UPD                          AJC
5385: 0003: \       AF.USER$, \             ! 3  bytes                             ! 1.6 RC
5386: 0003:         AF.SUP.FLAG$, \         ! 1  byte                              BSJW
5387: 0003:         AF.OP.MODEL$            ! 3  bytes                             BSJW
5388: 0003: 
5389: 0003:     INTEGER*1 GLOBAL \
5390: 0003:         AF.INDICAT4%, \
5391: 0003:         AF.INDICAT5%, \
5392: 0003:         AF.INDICAT6%, \
5393: 0003:         AF.INDICAT7%, \
5394: 0003:         AF.INDICAT8%, \
5395: 0003:         AF.INDICAT9%, \
5396: 0003:         AF.INDICAT10%, \
5397: 0003:         AF.INDICAT11%, \
5398: 0003:         AF.INDICAT12%, \
5399: 0003:         AF.INDICAT13%, \
5400: 0003:         AF.INDICAT14%, \
5401: 0003:         AF.INDICAT15%, \
5402: 0003:         AF.INDICAT16%, \
5403: 0003:         AF.REPORT.NUM%
5404: 0003: 
5405: 0003:     INTEGER*2 GLOBAL \
5406: 0003:         AF.INDICAT1%, \
5407: 0003:         AF.INDICAT2%, \
5408: 0003:         AF.INDICAT3%, \
5409: 0003:         AF.MODEL.FLAGS.1%, \                                           ! CRC
5410: 0003:         AF.MODEL.FLAGS.2%, \                                           ! CRC
5411: 0003:         AF.RECL%, \
5412: 0003:         AF.SESS.NUM%
5413: 0003: 
5414: 0003:  %INCLUDE UBDEC.J86                       ! 2.7SH
5415: 0003: \/******************************************************************/
5416: 0003: \/*                                                                */
5417: 0003: \/* UOD Banked FILE GLOBAL VARIABLE DECLARATIONS                   */
5418: 0003: \/*                                                                */
5419: 0003: \/* REFERENCE   : UBDEC.J86                                        */
5420: 0003: \/*                                                                */
5421: 0003: \/* VERSION A.          Stuart Highley            14 August 2008   */
5422: 0003: \/                                                                 */
5423: 0003: \/* VERSION B.          Charles Skadorwa          9 October 2008   */
5424: 0003: \/*                                                                */
5425: 0003: \/* VERSION C.          Stuart Highley            16 December 2008 */
5426: 0003: \/* Look carefully below and ye shall find my change.              */
5427: 0003: \/*                                                                */
5428: 0003: \/* VERSION D.          Mark Goode                22nd December 08 */
5429: 0003: \/* Changes to the fields on the audit record                      */
5430: 0003: \/******************************************************************/
5431: 0003: 
5432: 0003:    STRING GLOBAL                \
5433: 0003:       UB.TEMP.NAME$,            \
5434: 0003:       UB.FILE.NAME$,            \
5435: 0003:       UB.REC$,                  \
5436: 0003:       UB.REC.TYPE$,             \
5437: 0003:       UB.OP.ID$,                \
5438: 0003:       UB.METHOD$,               \
5439: 0003:       UB.REPORT.RQD$,           \
5440: 0003:       UB.LICENCE$,              \
5441: 0003:       UB.DESPATCH.DATE$,        \
5442: 0003:       UB.BOOKED.DATE$,          \
5443: 0003:       UB.BOOKED.TIME$,          \
5444: 0003:       UB.BOOK.TYPE$,            \
5445: 0003:       UB.BAR.CODE$,             \
5446: 0003:       UB.QTY$,                  \
5447: 0003:       UB.DRVR.ID$,              \
5448: 0003:       UB.DRVR.CHCK.DATE$,       \
5449: 0003:       UB.DRVR.CHCK.TIME$,       \
5450: 0003:       UB.DRVR.GIT.MATCH$,       \
5451: 0003:       UB.REC.COUNT$,            \
5452: 0003:       UB.ONIGHT.DELIVERY.TYPE$, \                                !BCSk
5453: 0003:       UB.DRIVER.CHECKIN.REQD$,  \                                !BCSk
5454: 0003:       UB.DRVR.REJECTED$,        \ "Y" or "N" on batch rec,       !CSH
5455: 0003:                                 \ " " on session rec             !CSH
5456: 0003:       UB.DRVR.CONFIRM.SCAN$,    \                                !BCSk
5457: 0003:       UB.BOOKED.STATUS$                                          !DMG
5458: 0003:       
5459: 0003:    INTEGER*2 GLOBAL             \
5460: 0003:       UB.RECL%,                 \
5461: 0003:       UB.REPORT.NUM%,           \
5462: 0003:       UB.SESS.NUM%
5463: 0003: 
5464: 0003: \/******************************************************************/
5465: 0003:  
5466: 0003: \*****************************************************************************
5467: 0003: \*****************************************************************************
5468: 0003: \***                                                                       ***
5469: 0003: \***      V A R I A B L E   D E C L A R A T I O N S                        ***
5470: 0003: \***                                                                       ***
5471: 0003: \*****************************************************************************
5472: 0003: \*****************************************************************************
5473: 0003: 
5474: 0003: INTEGER*1 GLOBAL                          \
5475: 0003:         ASN.ACTIVE%,                      \ 2.5NWB
5476: 0003:         BC.CHECK%(1),                     \ FLC
5477: 0003:         ERROR.COUNT%,                     \
5478: 0003:         REC.MAX%,                         \
5479: 0003:         LDT.TRANSMIT,                     \ HDS
5480: 0003:         NESTING.LEVEL%,                   \ FLC
5481: 0003:         TRUE,                             \ HDS
5482: 0003:         FALSE,                            \ HDS
5483: 0003:         PORT.EVENT%,                      \ FLC
5484: 0003:         RE.CHAIN,                         \ DSW
5485: 0003:         WARM.START,                       \ DSW
5486: 0003:         GAP,                              \ GMJK
5487: 0003:         CCBUF.ENTRY.REQUIRED,             \ GMJK
5488: 0003:         CCBUF.RECS.PRESENT,               \ GMJK
5489: 0003:         CCREJ.RECS.PRESENT,               \ 2.2JAS
5490: 0003:         DETAIL.RECORDS.RECEIVED,          \ GMJK
5491: 0003:         END.OF.CCTMP,                     \ GMJK
5492: 0003:         END.OF.FILE,                      \ GMJK
5493: 0003:         TABLE.FULL,                       \ GMJK
5494: 0003:         REWKF.RECS.PRESENT,               \ 2.6BG
5495: 0003:         ALL.PRODUCTS                      ! 1.8DA
5496: 0003: \       ALLOW.CSR.PROCESSING              ! 1.2 !2.5NWB
5497: 0003: 
5498: 0003: INTEGER*2 GLOBAL                          \
5499: 0003:         ACTUAL.NUM.OF.UODS%,              \ FLC
5500: 0003:         BTSCNT%,                          \2.3CS
5501: 0003:         EANCNT%,                          \2.3CS
5502: 0003:         COUNTED.ITEMS%,                   \ FLC
5503: 0003: \       CSR.ITEMS.COUNT%,                 \     !2.5NWB
5504: 0003:         CSR.AUDIT.SESS.NUM%,              \ CDS
5505: 0003:         CURRENT.REPORT.NUM%,              \ DLC
5506: 0003:         EXPECTED.NUM.OF.UODS%,            \ FLC
5507: 0003:         FILE.HEADER.LISTS%,               \ FLC
5508: 0003:         FILE.TRAILER.LISTS%,              \ FLC
5509: 0003:         FIRST.TIME,                       \ CDS
5510: 0003:         ORDERS.EXPECTED%,                 \ CDS
5511: 0003:         INT.DELAY%,                       \ FLC
5512: 0003:         ITEMS.BOOKED.IN%,                 \ CDS
5513: 0003:         ITEM.COUNT%,                      \ FLC
5514: 0003:         LINES.BOOKED.IN%,                 \ CDS
5515: 0003:         LINES.ADDED%,                     \ CDS
5516: 0003:         LINE.TOTAL%,                      \ CDS
5517: 0003:         LIST.COUNT%,                      \ FLC
5518: 0003:         LIST.TRAILER.ITEMS%,              \ FLC
5519: 0003:         ONORD.COUNT%,                     \
5520: 0003:         ORDERS.FOUND%,                    \ CDS
5521: 0003:         RC%,                              \ DLC
5522: 0003:         SINGLES.ADDED%,                   \ CDS
5523: 0003:         TYPE.17.WRITTEN,                  \ CDS
5524: 0003:         UOD.NUM.ITEMS%,                   \ FLC
5525: 0003:         ACTUAL.NUM%,                      \ GMJK
5526: 0003:         ACTUAL.UOD.ITEMS%,                \ GMJK
5527: 0003:         CURR.ITEM%,                       \ GMJK
5528: 0003:         CURR.REC%,                        \ GMJK
5529: 0003:         CURR.SUBSCRIPT%,                  \ GMJK
5530: 0003:         EXPECTED.NUM%,                    \ GMJK
5531: 0003:         FILE.NUM%,                        \ GMJK
5532: 0003:         ITEM.POS%,                        \ GMJK
5533: 0003:         MAX.TABLE.SIZE%,                  \ GMJK
5534: 0003:         NUM.BARCODES%,                    \ GMJK
5535: 0003:         NUM.BC.EXTRACTED%,                \ GMJK
5536: 0003:         NUM.ITEMS%,                       \ GMJK
5537: 0003:         NUM.STATUS.O.C.X.UODS%,           \ 1.4
5538: 0003:         NUM.OF.CANCELLED.UODS%,           \ 1.4
5539: 0003:         NUM.OF.DESPATCHED.UODS%,          \ 1.4
5540: 0003:         NUM.RECORDS%,                     \ GMJK
5541: 0003:         RECORD$,                          \ GMJK
5542: 0003:         REC.NUM%,                         \ GMJK
5543: 0003:         RECS.PER.SECTOR%,                 \ GMJK
5544: 0003:         BC%,CG%,PG%,                      \ 1.8DA
5545: 0003:         SECTOR%                           ! GMJK
5546: 0003: 
5547: 0003: INTEGER*4 GLOBAL                          \
5548: 0003:         LAST.ACTIVE%,                     \
5549: 0003:         LAST.STOCKTAKE%,                  \ 1.5
5550: 0003:         TIMEOUT.VALUE%                    ! FLC
5551: 0003: 
5552: 0003: 
5553: 0003: STRING GLOBAL                             \ for modules 00, 01 , 02 , 03 and 04
5554: 0003:         ACK$,                             \ 1.5
5555: 0003:         ALL.FILES.CLOSED$,                \
5556: 0003:         APPL$,                            \ FLC
5557: 0003:         APPLICATION.NO$,                  \
5558: 0003:         BAR.CODES$(1),                    \ FLC
5559: 0003:         BCSMF.RECORD$,                    \ GMJK
5560: 0003:         BOOKING.STARTED$,                 \ CDS
5561: 0003:         BOOKING.ENDED$,                   \ CDS
5562: 0003:         CCUOD.OPEN.FLAG$,                 \ GMJK
5563: 0003:         CCLAM.OPEN.FLAG$,                 \ 1.4
5564: 0003:         CCITM.OPEN.FLAG$,                 \ GMJK
5565: 0003:         CCTRL.OPEN.FLAG$,                 \ GMJK
5566: 0003:         CCDMY.OPEN.FLAG$,                 \ GMJK
5567: 0003:         CCTMP.OPEN.FLAG$,                 \ GMJK
5568: 0003:         CCBUF.OPEN.FLAG$,                 \ GMJK
5569: 0003:         CCUPF.OPEN.FLAG$,                 \ HMJK
5570: 0003:         CCWKF.OPEN.FLAG$,                 \ GMJK
5571: 0003:         STKRC.OPEN.FLAG$,                 \ 1.8DA
5572: 0003:         XGCF.OPEN.FLAG$,                  \ 1.8DA
5573: 0003:         STKEX.OPEN.FLAG$,                 \ 1.8DA
5574: 0003:         STKIF.OPEN.FLAG$,                 \ 1.8DA
5575: 0003:         LOCCNT.OPEN.FLAG$,                \ 1.8DA
5576: 0003:         STKTF.OPEN.FLAG$,                 \ 1.8DA
5577: 0003:         STKDC.OPEN.FLAG$,                 \ 1.8DA
5578: 0003: \       CSR.LIST.ALREADY.PROCESSED.FLAG$, \ !2.5NWB
5579: 0003: \       CSR.OPEN.FLAG$,                   \ !2.5NWB
5580: 0003:         CHKBF.OPEN.FLAG$,                 \ DSW
5581: 0003:         GAPBF.OPEN.FLAG$,                 \ SDH  2.3CS !2.4BG
5582: 0003:         PLLOL.OPEN.FLAG$,                 \ 2.3CS
5583: 0003:         PLLDB.OPEN.FLAG$,                 \ 2.3CS
5584: 0003:         PLLDB.TABLE$(1),                  \ 2.3CS
5585: 0003:         EAN.TABLE$(1),                    \ 2.3CS
5586: 0003: \       CITEM.OPEN.FLAG$,                 \ !2.5NWB
5587: 0003: \       CIMF.OPEN.FLAG$,                  \ !2.5NWB
5588: 0003: \       CSRWF.OPEN.FLAG$,                 \ !2.5NWB
5589: 0003: \       CSRBF.OPEN.FLAG$,                 \ !2.5NWB
5590: 0003:         CSR.AUDIT.FILE$,                  \ CDS
5591: 0003:         CSR.AUDIT.DATA$,                  \ CDS
5592: 0003:         CSR.AUDIT.OPEN.FLAG$,             \ CDS
5593: 0003:         CURR.LIST$,                       \ FLC
5594: 0003:         CURR.TERMINAL$,                   \
5595: 0003:         CURRENT.CODE$,                    \ DLC
5596: 0003:         DATA.IN$,                         \
5597: 0003:         DATE.TODAY$,                      \ FLC
5598: 0003:         STKMQ.OPEN.FLAG$,                 \ CDS
5599: 0003:         STLDT.OPEN.FLAG$,                 \ 1.6
5600: 0003:         BCSMF.OPEN.FLAG$,                 \ CDS
5601: 0003:         IEF.OPEN.FLAG$,                   \ CDS
5602: 0003:         DATA.FILES.REQ$,                  \ GMJK
5603: 0003:         DETAIL.RECORDS.RECEIVED$,         \ FLC
5604: 0003:         DIREC.OPEN.FLAG$,                 \ CDS
5605: 0003:         DIRORD.OPEN.FLAG$,                \ CDS
5606: 0003:         DIRSUP.OPEN.FLAG$,                \ CDS
5607: 0003:         DIRWF.OPEN.FLAG$,                 \ CDS
5608: 0003:         EPSOM.OPEN.FLAG$,                 \ FLC
5609: 0003:         LDTAF.OPEN.FLAG$,                 \ GMJK
5610: 0003:         LDTCF.OPEN.FLAG$,                 \ CDS
5611: 0003:         DRSMQ.OPEN.FLAG$,                 \ CDS
5612: 0003:         FILE.OPERATION$,                  \ DLC
5613: 0003: \       FIRST.CSR.LIST.FOR.PDT$,          \ 2.5NWB
5614: 0003:         FIRST.EOT.FOR.THIS.PDT$,          \
5615: 0003:         FIRST.ITEM.TO.BE.PROCESSED$,      \
5616: 0003:         FIRST.RETURN$,                    \ FLC
5617: 0003:         FPF.OPEN.FLAG$,                   \
5618: 0003:         HOLD.FLAG$,                       \
5619: 0003:         IDF.OPEN.FLAG$,                   \
5620: 0003:         IDSOF.OPEN.FLAG$,                 \ ELC
5621: 0003:         IRF.OPEN.FLAG$,                   \ FLC
5622: 0003:         IMSTC.OPEN.FLAG$,                 \1.7BG
5623: 0003:         LAST.ACTIVE.DATE$,                \
5624: 0003:         LAST.STOCKTAKE.DATE$,             \ 1.5
5625: 0003:         LAST.MESSAGE$,                    \
5626: 0003:         LOG.ON.DATE$,                     \ GMJK
5627: 0003:         LOG.ON.TIME$,                     \ GMJK
5628: 0003:         LDTBF.HEADER.WRITTEN$,            \ ELC
5629: 0003:         LDTBF.OPEN.FLAG$,                 \ ELC
5630: 0003:         LIST.ABANDONED$,                  \
5631: 0003:         LIST.BC$,                         \ FLC
5632: 0003:         LIST.TRANSMIT$(1),                \ FLC
5633: 0003:         LSSST.OPEN.FLAG$,                 \1.7BG
5634: 0003:         MONITORED.PORT$,                  \ DLC
5635: 0003:         NUM.SECTOR$,                      \ GMJK
5636: 0003:         ONORD.OPEN.FLAG$,                 \
5637: 0003:         ONORD.DELETED$(1),                \
5638: 0003:         ORDER.LINE.TABLE$(1),             \ CDS
5639: 0003:         PCHK.OPEN.FLAG$,                  \
5640: 0003:         PDT.ACTION$,                      \ FLC
5641: 0003:         PIITM.OPEN.FLAG$,                 \ FLC
5642: 0003:         PILST.OPEN.FLAG$,                 \ FLC
5643: 0003:         PIPE.OUT$,                        \
5644: 0003:         PDTWF.OPEN.FLAG$,                 \ FLC
5645: 0003:         PK2$,                             \
5646: 0003:         PK4$,                             \
5647: 0003:         PORT.STRING$,                     \
5648: 0003:         PREV.LOGGED.STATE$,               \ ELC
5649: 0003: \       PROCESS.CSR.WORKFILE$,            \ !2.5NWB
5650: 0003:         PSS38.STATUS$,                    \ FLC
5651: 0003:         RB.OPEN.FLAG$,                    \ 2.6BG
5652: 0003:         REWKF.OPEN.FLAG$,                 \ 2.6BG
5653: 0003:         RECALLS.OPEN.FLAG$,               \ 2.6BG
5654: 0003:         DELVINDX.OPEN.FLAG$,              \ 2.7SH
5655: 0003:         AF.OPEN.FLAG$,                    \ 2.7SH
5656: 0003:         UB.OPEN.FLAG$,                    \ 2.7SH
5657: 0003:         RECEIVE.STATE$,                   \
5658: 0003:         REQ.LIST.STORE$(1),               \ FLC
5659: 0003:         REQ.LIST.DATA$(1),                \ FLC
5660: 0003:         SAVED.ORDER.NO$,                  \ CDS
5661: 0003:         SAVED.ORDER.SUFFIX$,              \ CDS
5662: 0003:         SAVED.PAGE.NO$,                   \ CDS
5663: 0003:         SAVED.STORE.NUMBER$,              \ 1.8DA
5664: 0003:         SAVED.SUPPLIER.NO$,               \ CDS
5665: 0003:         SECTOR$,                          \ GMJK
5666: 0003:         SOFTS.OPEN.FLAG$,                 \ GMJK
5667: 0003:         SOH$,                             \ 1.5
5668: 0003:         STORED.UOD.HEADER$,               \ FLC
5669: 0003:         STORE.NUMBER$,                    \ 1.5
5670: 0003:         STOCK.OPEN.FLAG$,                 \1.7BG
5671: 0003:         STX$,                             \ FLC
5672: 0003:         STKBF.OPEN.FLAG$,                 \ 1.5
5673: 0003:         SXTMP.OPEN.FLAG$,                 \ 1.5
5674: 0003:         T.DATE$,                          \ 1.5
5675: 0003:         T.TIME$,                          \ 1.5
5676: 0003:         TEMP.TIME$,                       \ GMJK
5677: 0003:         TRAILER.LIST$,                    \ FLC
5678: 0003:         UOD.NUMBER$,                      \ FLC
5679: 0003:         UOD.NUM.ITEMS$,                   \ FLC
5680: 0003:         UOD.OPEN.FLAG$,                   \ FLC
5681: 0003:         UOD.STATUS.FLAG$,                 \ FLC
5682: 0003:         UODBF.OPEN.FLAG$,                 \ FLC
5683: 0003:         UODTF.OPEN.FLAG$,                 \ FLC
5684: 0003:         UNITS.OPEN.FLAG$
5685: 0003: 
5686: 0003: STRING GLOBAL                             \ GMJK
5687: 0003:         ITEM.STORAGE$,                    \ GMJK
5688: 0003:         ITEM.DESC.STORAGE$,               \ GMJK
5689: 0003:         BARCODE.DATA$,                    \ GMJK
5690: 0003:         BARCODE.INDEX$,                   \ GMJK
5691: 0003:         BARCODE.INDEX.STORAGE$,           \ GMJK
5692: 0003:         BARCODE.STORAGE$,                 \ GMJK
5693: 0003:         ITEM.DATA$,                       \ GMJK
5694: 0003:         ITEM.DATA.DESC$,                  \ GMJK
5695: 0003:         ITEM.POS.TABLE$(1),               \ GMJK
5696: 0003:         CCUOD.TABLE$(1),                  \ GMJK
5697: 0003:         CCLAM.TABLE$(1),                  \ 1.4
5698: 0003:         DATA.FILES.REQUIRED$,             \ GMJK
5699: 0003:         FINISH.DATE$,                     \ GMJK
5700: 0003:         FINISH.TIME$,                     \ GMJK
5701: 0003:         LDT.CCUOD.UPDATE.DATE$,           \ GMJK
5702: 0003:         LDT.CCUOD.UPDATE.TIME$,           \ GMJK
5703: 0003:         LDT.DATE.TIME$,                   \ GMJK
5704: 0003:         LDT.LAST.CLAIM.NUM$,              \ GMJK
5705: 0003:         STKCF.OPEN.FLAG$,                 \ 1.8DA
5706: 0003:         STKMF.OPEN.FLAG$,                 \ 1.8DA
5707: 0003:         CONCEPT.GROUPS$(1),               \ 1.8DA
5708: 0003:         PRODUCT.GROUPS$(1),               \ 1.8DA
5709: 0003:         BUSINESS.CENTRES$(1),             \ ! 1.8DA 2.1JAS
5710: 0003:         SOPTS.OPEN.FLAG$,                 \ ! 2.1JAS
5711: 0003:         LOCAL.OPEN.FLAG$,                 \ ! 2.1JAS
5712: 0003:         TSF.OPEN.FLAG$,                   \ ! 2.1JAS 2.2JAS
5713: 0003:         CCREJ.OPEN.FLAG$,                 \ 2.2JAS
5714: 0003:         CREDIT.CLAIM.FLAG$                ! 2.2JAS
5715: 0003: 
5716: 0003: 
5717: 0003: STRING GLOBAL                             \
5718: 0003:         BATCH.SCREEN.FLAG$,               \
5719: 0003:         EXP.STATES$,                      \
5720: 0003:         MODULE.NUMBER$,                   \
5721: 0003:         OPERATOR.ID$,                     \
5722: 0003:         STATE$,                           \
5723: 0003:         TRANS.FROM$,                      \
5724: 0003:         TRANS.TO$
5725: 0003: 
5726: 0003:  STRING GLOBAL                            \
5727: 0003:         REC.CHECK$(1),                    \
5728: 0003:         V.TAB$(1)
5729: 0003: 
5730: 0003: \*****************************************************************************
5731: 0003: \*****************************************************************************
5732: 0003: \***                                                                       ***
5733: 0003: \*** E X T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
5734: 0003: \***                                                                       ***
5735: 0003: \*****************************************************************************
5736: 0003: \*****************************************************************************
5737: 0003: 
5738: 0003: \*****************************************************************************
5739: 0003: \***   include external definitions for the following functions
5740: 0003: \***
5741: 0003: \***     ADXERROR
5742: 0003: \***     ADXSERVE
5743: 0003: \***     ADXSERCL
5744: 0003: \***     APPLICATION.LOG             01
5745: 0003: \***     READ.NEXT.IEF               11
5746: 0003: \***     SORT.TABLE                  14
5747: 0003: \***     CONV.TO.HEX                 16
5748: 0003: \***     CONV.TO.STRING              17
5749: 0003: \***     SESS.NUM.UTILITY            20
5750: 0003: \***     STKMQ
5751: 0003: \***     BCSMF
5752: 0003: \***     IDF
5753: 0003: \***     INVOK
5754: 0003: \***     PCHK
5755: 0003: \***     UOD
5756: 0003: \***     UODBF
5757: 0003: \***     UODTF
5758: 0003: \***     STKBF
5759: 0003: \***     SXTMP
5760: 0003: \***     SSPSC
5761: 0003: \***     BTCS
5762: 0003: \***     PRINT
5763: 0003: \***     SOPTS
5764: 0003: \***     LOCAL
5765: 0003: \***
5766: 0003: \*****************************************************************************
5767: 0003: 
5768: 0003:  %INCLUDE ADXERROR.J86
5769: 0003: \******************************************************************************
5770: 0003: \******************************************************************************
5771: 0003: \***                                                                        ***
5772: 0003: \***    %INCLUDE FOR FUNCTION ADXERROR (an I.B.M. system function)          ***
5773: 0003: \***                                                                        ***
5774: 0003: \***         AUTHOR        :  Stephen Kelsey                                ***
5775: 0003: \***                                                                        ***
5776: 0003: \***         DATE WRITTEN  :  21st February 1986                            ***
5777: 0003: \***                                                                        ***
5778: 0003: \***         DATE OF LAST REVISION  - 21st February 1986                    ***
5779: 0003: \***                                                                        ***
5780: 0003: \***         VERSION B     :  Stuart William McConnachie  18th March 1997   ***
5781: 0003: \***    Define size of ADXERROR return value from function.  This change    ***
5782: 0003: \***    was introduced by IBM in the 4690 Programming Guide.  Not defining  ***
5783: 0003: \***    this variable can cause Memory Protection Violations at run time.   ***
5784: 0003: \***                                                                        ***
5785: 0003: \******************************************************************************
5786: 0003: \******************************************************************************
5787: 0003: 
5788: 0003:    FUNCTION ADXERROR (TERM%,                                                  \
5789: 0003:                       MSGGRP%,                                                \
5790: 0003:                       MSGNUM%,                                                \
5791: 0003:                       SEVERITY%,                                              \
5792: 0003:                       EVENT.NUM%,                                             \
5793: 0003:                       UNIQUE$) EXTERNAL
5794: 0003: 
5795: 0003:       INTEGER*2  MSGNUM%,                                                     \
5796: 0003:                  TERM%,                                                       \
5797: 0003:                  ADXERROR                                                     !BSWM
5798: 0003: 
5799: 0003:       INTEGER*1 EVENT.NUM%,                                                   \
5800: 0003:                 MSGGRP%,                                                      \
5801: 0003:                 SEVERITY%
5802: 0003: 
5803: 0003:       STRING  UNIQUE$
5804: 0003: 
5805: 0003:    END FUNCTION
5806: 0003: 
5807: 0003:  %INCLUDE ADXSERVE.J86
5808: 0003: \******************************************************************************
5809: 0003: \******************************************************************************
5810: 0003: \***                                                                        ***
5811: 0003: \***    %INCLUDE FOR FUNCTION ADXSERVE (an I.B.M. system function)          ***
5812: 0003: \***                                                                        ***
5813: 0003: \***         AUTHOR        :  Bruce Scriver                                 ***
5814: 0003: \***                                                                        ***
5815: 0003: \***         DATE WRITTEN  :  14th March 1986                               ***
5816: 0003: \***                                                                        ***
5817: 0003: \***         DATE OF LAST REVISION  - 14th March 1986                       ***
5818: 0003: \***                                                                        ***
5819: 0003: \***                                                                        ***
5820: 0003: \******************************************************************************
5821: 0003: \******************************************************************************
5822: 0003: 
5823: 0003:    SUB ADXSERVE (RETURN.CODE%,                                                \
5824: 0003:                  ADX.FUNCTION%,                                               \
5825: 0003:                  ADX.PARM.1%,                                                 \
5826: 0003:                  ADX.PARM.2$)                                                 \
5827: 0003:    EXTERNAL
5828: 0003:   
5829: 0003:       STRING     ADX.PARM.2$
5830: 0003: 
5831: 0003:       INTEGER*2  ADX.FUNCTION%,                                               \
5832: 0003:                  ADX.PARM.1%
5833: 0003: 
5834: 0003:       INTEGER*4  RETURN.CODE%                                                 \
5835: 0003: 
5836: 0003:    END SUB     
5837: 0003: 
5838: 0003:  %INCLUDE ADXSERCL.J86                    ! DSW
5839: 0003: SUB ADXSERCL EXTERNAL
5840: 0003: END SUB
5841: 0003:  %INCLUDE PSBF01E.J86                     ! DLC
5842: 0003: REM \
5843: 0003: \*******************************************************************************
5844: 0003: \*******************************************************************************
5845: 0003: \***
5846: 0003: \***      %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION APPLICATION.LOG
5847: 0003: \***
5848: 0003: \***                      FUNCTION NUMBER   : PSBF01
5849: 0003: \***
5850: 0003: \***                    INCLUDE REFERENCE : PSBF01E.J86
5851: 0003: \*** 
5852: 0003: \***      Version B           Andrew Wedgeworth          1st July 1992
5853: 0003: \***      Three parameters which passed to the function have been removed.
5854: 0003: \***      APPLICATION.LOG has been added as a variable name (this holds the
5855: 0003: \***      return code).
5856: 0003: \***
5857: 0003: \*******************************************************************************
5858: 0003: 
5859: 0003: 
5860: 0003:    FUNCTION APPLICATION.LOG (MESSAGE.NO%,                                     \
5861: 0003:                              VAR.STRING.1$,                                   \
5862: 0003:                              VAR.STRING.2$,                                   \
5863: 0003:                              EVENT.NO%)  EXTERNAL
5864: 0003: 
5865: 0003:       INTEGER*1 EVENT.NO%
5866: 0003: 
5867: 0003:       INTEGER*2 APPLICATION.LOG,                                       \ GAW
5868: 0003:                 MESSAGE.NO%
5869: 0003: 
5870: 0003:       STRING VAR.STRING.1$,                                            \
5871: 0003:              VAR.STRING.2$
5872: 0003: 
5873: 0003:    END FUNCTION
5874: 0003: 
5875: 0003: \*******************************************************************************
5876: 0003:  %INCLUDE PSBF05E.J86                     ! 1.9BG
5877: 0003: REM\
5878: 0003: \*******************************************************************************
5879: 0003: \*******************************************************************************
5880: 0003: \***
5881: 0003: \***        INCLUDE       : CHECK.BOOTS.CODE external definition
5882: 0003: \***
5883: 0003: \***        REFERENCE     : PSBF05E.J86
5884: 0003: \***
5885: 0003: \***        Version A       Bruce Scriver                  24th February 1986  
5886: 0003: \*** 
5887: 0003: \***        Version B       Andrew Wedgeworth                  15th July 1992 
5888: 0003: \***        Redundant parameters removed, and CHECK.BOOTS.CODE defined as a 
5889: 0003: \***        variable to hold the return code.  
5890: 0003: \***
5891: 0003: \*******************************************************************************
5892: 0003: \*******************************************************************************
5893: 0003: 
5894: 0003:    FUNCTION CHECK.BOOTS.CODE (BOOTS.CODE$)                                     \
5895: 0003:    EXTERNAL
5896: 0003:    ! 3 parameters removed from here                                    ! BAW   
5897: 0003: 
5898: 0003:       STRING BOOTS.CODE$
5899: 0003:    ! 3 variables removed from here                                     ! BAW
5900: 0003:    
5901: 0003:       INTEGER*2 CHECK.BOOTS.CODE                                       ! BAW
5902: 0003:    
5903: 0003: 
5904: 0003:    END FUNCTION
5905: 0003: 
5906: 0003: !%INCLUDE PSBF06E.J86                     ! FLC
5907: 0003:  %INCLUDE PSBF11E.J86                     ! DLC
5908: 0003: REM \
5909: 0003: \*******************************************************************************
5910: 0003: \*******************************************************************************
5911: 0003: \***
5912: 0003: \***    %INCLUDE FOR EXTERNAL DEFINITION OF FUNCTION READ.NEXT.IEF
5913: 0003: \***
5914: 0003: \***
5915: 0003: \***            FUNCTION NUMBER       : PSBF11
5916: 0003: \***
5917: 0003: \***            INCLUDE REFERENCE     : PSBF11E.J86
5918: 0003: \***
5919: 0003: \***            DATE OF LAST AMENDMENT -  3rd March 1986
5920: 0003: \***
5921: 0003: \***     Version B             Andrew Wedgeworth          15th July 1992
5922: 0003: \***     Removal of redundant function parameters.  READ.NEXT.IEF defined as
5923: 0003: \***     a variable to hold the return code.
5924: 0003: \***
5925: 0003: \*******************************************************************************
5926: 0003: \*******************************************************************************
5927: 0003: 
5928: 0003: REM \
5929: 0003: \*******************************************************************************
5930: 0003: \*******************************************************************************
5931: 0003: \***
5932: 0003: \***
5933: 0003: \***            FUNCTION OVERVIEW
5934: 0003: \***            -----------------
5935: 0003: \***
5936: 0003: \***   This function finds and retreives the next bar code in an IEF chain.
5937: 0003: \***   If the code found is the last code in the chain, the function checks that
5938: 0003: \***   the number of codes in the chain is equal to the expected number.  If it
5939: 0003: \***   is not, a message is displayed and logged.  If an error occurs in reading
5940: 0003: \***   the IEF, a message is displayed and logged, and the function returns to
5941: 0003: \***   the calling program with a return code of 1.
5942: 0003: \***
5943: 0003: \***
5944: 0003: \*******************************************************************************
5945: 0003: \*******************************************************************************
5946: 0003: 
5947: 0003:    FUNCTION READ.NEXT.IEF (LAST.BAR.CODE$,                             \
5948: 0003:                            TOTAL.COUNT%,                               \
5949: 0003:                            BOOTS.CODE$)  EXTERNAL
5950: 0003:    ! 3 parameters deleted from here                                    ! BAW			   
5951: 0003: 
5952: 0003:       STRING  BOOTS.CODE$,                                             \
5953: 0003:               LAST.BAR.CODE$
5954: 0003:       ! 3 variables removed from here                                  ! BAW
5955: 0003: 
5956: 0003:       INTEGER*2 READ.NEXT.IEF,                                         \ BAW
5957: 0003:                 TOTAL.COUNT%
5958: 0003:              
5959: 0003: 
5960: 0003: 
5961: 0003:    END FUNCTION
5962: 0003: 
5963: 0003: \*******************************************************************************
5964: 0003:  %INCLUDE PSBF14E.J86                     ! DLC
5965: 0003: REM\
5966: 0003: \*******************************************************************************
5967: 0003: \*******************************************************************************
5968: 0003: \***
5969: 0003: \***        INCLUDE       : SORT.TABLE external definition
5970: 0003: \***
5971: 0003: \***        REFERENCE     : PSBF14E.J86
5972: 0003: \***
5973: 0003: \***        Version A     Bruce Scriver                   3rd March 1986   
5974: 0003: \*** 
5975: 0003: \***        Version B     Andrew Wedgeworth               17th July 1992
5976: 0003: \***        Redundant function parameters removed.  SORT.TABLE defined as a
5977: 0003: \***        variable to hold the return code.
5978: 0003: \***
5979: 0003: \*******************************************************************************
5980: 0003: \*******************************************************************************
5981: 0003: 
5982: 0003:    FUNCTION SORT.TABLE (NUMBER.OF.ENTRIES%)                                    \
5983: 0003:    EXTERNAL
5984: 0003: 
5985: 0003:       INTEGER   NUMBER.OF.ENTRIES%,                                    \ BAW
5986: 0003:                 SORT.TABLE                 
5987: 0003: 
5988: 0003:    END FUNCTION
5989: 0003: 
5990: 0003:  %INCLUDE PSBF16E.J86                     ! DLC
5991: 0003: REM\
5992: 0003: \*******************************************************************************
5993: 0003: \*******************************************************************************
5994: 0003: \***
5995: 0003: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.HEX FUNCTION
5996: 0003: \***
5997: 0003: \***                  REFERENCE     : PSBF16E.J86
5998: 0003: \***
5999: 0003: \***       Version A            Bruce Scriver          25th February 1986
6000: 0003: \***
6001: 0003: \***       Version B           Andrew Wedgeworth            2nd July 1992
6002: 0003: \***       Removal of redundant parameters, and CONV.TO.HEX defined as a 
6003: 0003: \***       variable to hold the return code. 
6004: 0003: \***
6005: 0003: \*******************************************************************************
6006: 0003: \*******************************************************************************
6007: 0003: 
6008: 0003:    FUNCTION CONV.TO.HEX (INTEGER4%)                                            \
6009: 0003:    EXTERNAL
6010: 0003:    ! 3 parameters removed from here                                    ! BAW
6011: 0003: 
6012: 0003:    ! 3 lines deleted from here                                         ! BAW
6013: 0003:    
6014: 0003:       INTEGER*2 CONV.TO.HEX                                            ! BAW
6015: 0003: 
6016: 0003:       INTEGER*4 INTEGER4%
6017: 0003: 
6018: 0003:    END FUNCTION
6019: 0003: 
6020: 0003:  %INCLUDE PSBF17E.J86                     ! DLC
6021: 0003: REM \
6022: 0003: \*******************************************************************************
6023: 0003: \*******************************************************************************
6024: 0003: \***
6025: 0003: \***
6026: 0003: \***       %INCLUDE FOR EXTERNAL DEFINITION OF CONV.TO.STRING FUNCTION
6027: 0003: \***
6028: 0003: \***                     REFERENCE     : PSBF17E.J86
6029: 0003: \***
6030: 0003: \***       Version A            Bruce Scriver       24th February 1986           
6031: 0003: \***
6032: 0003: \***       Version B          Andrew Wedgeworth          2nd July 1992
6033: 0003: \***       Redundant parameters removed, and the function's name is 
6034: 0003: \***       is defined as a variable to hold the return code. 
6035: 0003: \***
6036: 0003: \*******************************************************************************
6037: 0003: \*******************************************************************************
6038: 0003: 
6039: 0003:    FUNCTION CONV.TO.STRING (EVENT.NUMBER%,                                     \
6040: 0003:                             INTEGER4%)                                         \
6041: 0003:    EXTERNAL
6042: 0003: ! 3 parameters removed from here                                       ! BAW
6043: 0003: 
6044: 0003: ! 3 lines deleted from here                                            ! BAW
6045: 0003: 
6046: 0003:       INTEGER*1 EVENT.NUMBER%
6047: 0003: 
6048: 0003:       INTEGER*2 CONV.TO.STRING                                         ! BAW
6049: 0003: 
6050: 0003:       INTEGER*4 INTEGER4%
6051: 0003: 
6052: 0003:    END FUNCTION
6053: 0003: 
6054: 0003:  %INCLUDE PSBF18E.J86                     ! 1.8DA
6055: 0003: REM\
6056: 0003: \*******************************************************************************
6057: 0003: \*******************************************************************************
6058: 0003: \***
6059: 0003: \***        INCLUDE       : CALC.BOOTS.CODE.CHECK.DIGIT external definition
6060: 0003: \***
6061: 0003: \***        REFERENCE     : PSBF18E.J86
6062: 0003: \***
6063: 0003: \***        Version A      Stephen Kelsey                   23rd March 1987 
6064: 0003: \***
6065: 0003: \***        Version B      Andrew Wedgeworth                  7th July 1992 
6066: 0003: \***        Removal of redundant parameters, and inclusion of function's 
6067: 0003: \***        name as a variable to hold the return code.
6068: 0003: \***
6069: 0003: \*******************************************************************************
6070: 0003: \*******************************************************************************
6071: 0003: 
6072: 0003:    FUNCTION CALC.BOOTS.CODE.CHECK.DIGIT (BOOTS.CODE.6.DIGIT$)          \ 
6073: 0003:    EXTERNAL
6074: 0003:    ! 3 parameters removed from here                                    ! BAW
6075: 0003: 
6076: 0003:    STRING BOOTS.CODE.6.DIGIT$
6077: 0003:    ! 3 variables deleted from here                                     ! BAW
6078: 0003:    
6079: 0003:    INTEGER* 2 CALC.BOOTS.CODE.CHECK.DIGIT                              ! BAW
6080: 0003:    
6081: 0003:    END FUNCTION
6082: 0003: 
6083: 0003:  %INCLUDE PSBF20E.J86                     ! DLC
6084: 0003: REM\
6085: 0003: \*******************************************************************************
6086: 0003: \*******************************************************************************
6087: 0003: \***
6088: 0003: \***       %INCLUDE FOR EXTERNAL DEFINITION OF SESS.NUM.UTILITY
6089: 0003: \***
6090: 0003: \***                  REFERENCE     : PSBF20E.J86
6091: 0003: \***
6092: 0003: \***     VERSION C            Janet Smith                13th May 1992
6093: 0003: \***     Increased PASSED.INTEGER to 2 bytes to cater for more than
6094: 0003: \***     128 files.
6095: 0003: \***
6096: 0003: \***     VERSION D.           Andrew Wedgeworth          1st July 1992
6097: 0003: \***     Removal of redundant parameters and addition of SESS.NUM.UTILITY
6098: 0003: \***     as a variable.  This new variable contains the function's return
6099: 0003: \***     code.
6100: 0003: \***
6101: 0003: \*******************************************************************************
6102: 0003: \*******************************************************************************
6103: 0003: 
6104: 0003:    FUNCTION SESS.NUM.UTILITY (FUNCTION.FLAG$,                          \
6105: 0003:                               PASSED.INTEGER%,                         \
6106: 0003:                               PASSED.STRING$)                          \
6107: 0003:    EXTERNAL
6108: 0003: 
6109: 0003:    STRING    FUNCTION.FLAG$,                                           \
6110: 0003:              PASSED.STRING$
6111: 0003:    ! 3 variables removed from here                                     ! CAW
6112: 0003: 
6113: 0003: 
6114: 0003:    INTEGER*2 SESS.NUM.UTILITY,                                         \ CAW
6115: 0003:              PASSED.INTEGER%				               ! CJAS
6116: 0003: 
6117: 0003:    END FUNCTION
6118: 0003: 
6119: 0003:  %INCLUDE PSBF21E.J86                     ! 1.9BG
6120: 0003: REM\
6121: 0003: \*******************************************************************************
6122: 0003: \*******************************************************************************
6123: 0003: \***
6124: 0003: \***        INCLUDE       : CHECK.BAR.CODE external definition
6125: 0003: \***
6126: 0003: \***        REFERENCE     : PSBF21E.J86
6127: 0003: \***
6128: 0003: \***        Version A     Bruce Scriver                  13th May 1988
6129: 0003: \***
6130: 0003: \***        Version B     Andrew Wedgeworth             21st July 1992
6131: 0003: \***        Redundant function parameters removed.  CHECK.BAR.CODE defined as
6132: 0003: \***        a variable to hold the return code.
6133: 0003: \***
6134: 0003: \*******************************************************************************
6135: 0003: \*******************************************************************************
6136: 0003: 
6137: 0003:    FUNCTION CHECK.BAR.CODE (BAR.CODE$)                                 \
6138: 0003:    EXTERNAL
6139: 0003: 
6140: 0003:    STRING    BAR.CODE$
6141: 0003: 
6142: 0003:    INTEGER*2 CHECK.BAR.CODE                                            ! BAW
6143: 0003: 
6144: 0003:    END FUNCTION
6145: 0003: 
6146: 0003: 
6147: 0003:  %INCLUDE IDFEXT.J86                      ! FLC
6148: 0003: \*******************************************************************************
6149: 0003: \***                                                                         ***
6150: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM DESCRIPTION FILE        ***
6151: 0003: \***                                                                         ***
6152: 0003: \***                       REFERENCE : IDFEXT.J86                            ***
6153: 0003: \***                                                                         ***
6154: 0003: \***      Version A           Andrew Wedgeworth         9th July 1992        ***
6155: 0003: \***
6156: 0003: \***    VERSION C.              Robert Cowey.                       25 AUG 1993.
6157: 0003: \***    No changes to this file.
6158: 0003: \***
6159: 0003: \***   VERSION D               Nik Sen                 22nd December 1994
6160: 0003: \***   WRITE.IDF.HOLD added
6161: 0003: \***
6162: 0003: \*******************************************************************************
6163: 0003: 
6164: 0003:        FUNCTION IDF.SET EXTERNAL                                      
6165: 0003:        END FUNCTION                                                   
6166: 0003: 
6167: 0003: 
6168: 0003:        FUNCTION READ.IDF EXTERNAL                                     
6169: 0003:           INTEGER*2 READ.IDF                                          
6170: 0003:        END FUNCTION                                                   
6171: 0003: 
6172: 0003: 
6173: 0003:        FUNCTION READ.IDF.LOCK EXTERNAL                                
6174: 0003:           INTEGER*2 READ.IDF.LOCK                                     
6175: 0003:        END FUNCTION                                                   
6176: 0003: 
6177: 0003:        FUNCTION WRITE.IDF EXTERNAL
6178: 0003:           INTEGER*2 WRITE.IDF
6179: 0003:        END FUNCTION	       
6180: 0003: 
6181: 0003:        FUNCTION WRITE.IDF.HOLD EXTERNAL
6182: 0003:           INTEGER*2 WRITE.IDF.HOLD
6183: 0003:        END FUNCTION
6184: 0003: 
6185: 0003:        FUNCTION WRITE.IDF.UNLOCK EXTERNAL                                  
6186: 0003:           INTEGER*2 WRITE.IDF.UNLOCK                                      
6187: 0003:        END FUNCTION                                                   
6188: 0003: !%INCLUDE IRFEXT.J86                      ! FLC TEST
6189: 0003:  %INCLUDE STKMQEXT.J86                    ! GMJK
6190: 0003: \*****************************************************************************
6191: 0003: \*****************************************************************************
6192: 0003: \***
6193: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCK MOVEMENT QUEUE FILE
6194: 0003: \***
6195: 0003: \***                      REFERENCE: STKMQEXT.J86
6196: 0003: \***
6197: 0003: \***       Version A            Les Cook                     8/9/92
6198: 0003: \***
6199: 0003: \***    VERSION F.              ROBERT COWEY.                       21 OCT 1993.
6200: 0003: \***    No changes to this file.
6201: 0003: \***
6202: 0003: \*******************************************************************************
6203: 0003: \*******************************************************************************
6204: 0003: 
6205: 0003:      FUNCTION STKMQ.SET EXTERNAL
6206: 0003:      END FUNCTION
6207: 0003:      
6208: 0003:      FUNCTION READ.STKMQ EXTERNAL
6209: 0003:         INTEGER*2 READ.STKMQ
6210: 0003:      END FUNCTION
6211: 0003:      
6212: 0003:      FUNCTION WRITE.STKMQ EXTERNAL
6213: 0003:         INTEGER*2 WRITE.STKMQ
6214: 0003:      END FUNCTION
6215: 0003:      
6216: 0003:      FUNCTION WRITE.HOLD.STKMQ EXTERNAL
6217: 0003:         INTEGER*2 WRITE.HOLD.STKMQ
6218: 0003:      END FUNCTION
6219: 0003:      
6220: 0003:      
6221: 0003:      
6222: 0003:  %INCLUDE BCSMFEXT.J86                    ! FLC
6223: 0003: \*****************************************************************************
6224: 0003: \*****************************************************************************
6225: 0003: \***
6226: 0003: \***   EXTERNAL FUNCTION DEFINITIONS FOR BUSINESS CENTRE SUPPLY METHOD FILE
6227: 0003: \***
6228: 0003: \***               REFERENCE: BCSMFFUN.BAS
6229: 0003: \***
6230: 0003: \***        Version B           Les Cook              11/1/93
6231: 0003: \***
6232: 0003: \*****************************************************************************
6233: 0003: \*****************************************************************************
6234: 0003: 
6235: 0003:     FUNCTION BCSMF.SET EXTERNAL
6236: 0003:     END FUNCTION
6237: 0003:     
6238: 0003:     FUNCTION READ.BCSMF EXTERNAL
6239: 0003:        INTEGER*2 READ.BCSMF
6240: 0003:     END FUNCTION
6241: 0003:     
6242: 0003:     FUNCTION READ.BCSMF.LOCK EXTERNAL
6243: 0003:        INTEGER*2 READ.BCSMF.LOCK
6244: 0003:     END FUNCTION
6245: 0003:     
6246: 0003:     FUNCTION WRITE.BCSMF EXTERNAL
6247: 0003:        INTEGER*2 WRITE.BCSMF
6248: 0003:     END FUNCTION
6249: 0003:     
6250: 0003:     FUNCTION WRITE.BCSMF.UNLOCK EXTERNAL
6251: 0003:        INTEGER*2 WRITE.BCSMF.UNLOCK
6252: 0003:     END FUNCTION
6253: 0003:     
6254: 0003:     
6255: 0003:  %INCLUDE INVOKEXT.J86                    ! FLC
6256: 0003: \*******************************************************************************
6257: 0003: \***                                                                         ***
6258: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE INVCE OK FILE                ***
6259: 0003: \***                                                                         ***
6260: 0003: \***                     REFERENCE : INVOKEXT.J86                            ***
6261: 0003: \***                                                                         ***
6262: 0003: \***      Version A         Andrew Wedgeworth       3rd August 1992          ***
6263: 0003: \***                                                                         ***
6264: 0003: \***      Version B         Stephen Kelsey (CTG)    9th October 1992         ***
6265: 0003: \***          Add functions READ.INVOK.LOCKED and WRITE.INVOK.UNLOCK         ***
6266: 0003: \***                                                                         ***
6267: 0003: \*******************************************************************************
6268: 0003: 
6269: 0003: 
6270: 0003:       FUNCTION INVOK.SET EXTERNAL 
6271: 0003:       END FUNCTION
6272: 0003:       
6273: 0003:       FUNCTION READ.INVOK EXTERNAL
6274: 0003:          INTEGER*2 READ.INVOK
6275: 0003:       END FUNCTION	             
6276: 0003:       
6277: 0003:       FUNCTION READ.INVOK.LOCKED EXTERNAL                              ! BSPK
6278: 0003:          INTEGER*2 READ.INVOK.LOCKED                                   ! BSPK
6279: 0003:       END FUNCTION	                                               ! BSPK
6280: 0003:       
6281: 0003:       FUNCTION WRITE.INVOK.UNLOCK EXTERNAL                             ! BSPK
6282: 0003:          INTEGER*2 WRITE.INVOK.UNLOCK                                  ! BSPK
6283: 0003:       END FUNCTION	                                               ! BSPK
6284: 0003:  %INCLUDE PCHKEXT.J86                     ! DLC
6285: 0003: \*****************************************************************************
6286: 0003: \*****************************************************************************
6287: 0003: \***
6288: 0003: \***        EXTERNAL FUNCTION DEFINITIONS FOR PCHK
6289: 0003: \***
6290: 0003: \***        REFERENCE: PCHKEXT.J86
6291: 0003: \***
6292: 0003: \*****************************************************************************
6293: 0003: \*****************************************************************************
6294: 0003: 
6295: 0003: 
6296: 0003:    FUNCTION PCHK.SET EXTERNAL
6297: 0003:    END FUNCTION
6298: 0003:    
6299: 0003:    FUNCTION READ.PCHK EXTERNAL
6300: 0003:    END FUNCTION
6301: 0003:    
6302: 0003:    FUNCTION WRITE.PCHK EXTERNAL
6303: 0003:    END FUNCTION
6304: 0003:    
6305: 0003:    
6306: 0003: \%INCLUDE CSREXT.J86                      ! DLC !2.5NWB
6307: 0003:  %INCLUDE EPSOMEXT.J86                    ! DLC
6308: 0003: \*****************************************************************************
6309: 0003: \*****************************************************************************
6310: 0003: \***
6311: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR EPSOM
6312: 0003: \***
6313: 0003: \***      REFERENCE: EPSOMEXT.J86
6314: 0003: \***
6315: 0003: \*****************************************************************************
6316: 0003: \*****************************************************************************
6317: 0003: 
6318: 0003: 
6319: 0003:    FUNCTION EPSOM.SET EXTERNAL
6320: 0003:    END FUNCTION
6321: 0003:    
6322: 0003:  %INCLUDE UNITSEXT.J86                    ! DLC
6323: 0003: \*****************************************************************************
6324: 0003: \*****************************************************************************
6325: 0003: \*** 
6326: 0003: \***        EXTERNAL FUNCTION DEFINITIONS FOR UNITS
6327: 0003: \***
6328: 0003: \***        REFERENCE:  UNITSEXT.J86
6329: 0003: \***
6330: 0003: \*****************************************************************************
6331: 0003: \*****************************************************************************
6332: 0003: 
6333: 0003:    FUNCTION UNITS.SET EXTERNAL
6334: 0003:    END FUNCTION
6335: 0003:    
6336: 0003:    FUNCTION READ.UNITS EXTERNAL
6337: 0003:       INTEGER*2 READ.UNITS
6338: 0003:    END FUNCTION
6339: 0003:    
6340: 0003:    FUNCTION READ.UNITS.LOCK EXTERNAL
6341: 0003:       INTEGER*2 READ.UNITS.LOCK
6342: 0003:    END FUNCTION
6343: 0003:    
6344: 0003:    FUNCTION WRITE.UNITS EXTERNAL
6345: 0003:       INTEGER*2 WRITE.UNITS
6346: 0003:    END FUNCTION
6347: 0003:    
6348: 0003:    FUNCTION WRITE.UNITS.UNLOCK EXTERNAL
6349: 0003:       INTEGER*2 WRITE.UNITS.UNLOCK
6350: 0003:    END FUNCTION
6351: 0003:    
6352: 0003:    
6353: 0003:    
6354: 0003:  %INCLUDE DIRECEXT.J86                    ! DLC
6355: 0003: \*****************************************************************************
6356: 0003: \*****************************************************************************
6357: 0003: \***
6358: 0003: \***       EXTERNAL FUNCTION DEFINITIONS FOR DIREC
6359: 0003: \***
6360: 0003: \***       REFERENCE: DIRECEXT.J86
6361: 0003: \***
6362: 0003: \*****************************************************************************
6363: 0003: \*****************************************************************************
6364: 0003: 
6365: 0003:    FUNCTION DIREC.SET EXTERNAL 
6366: 0003:    END FUNCTION
6367: 0003:    
6368: 0003:    
6369: 0003:  %INCLUDE LDTBFEXT.J86                    ! ELC
6370: 0003: \*******************************************************************************
6371: 0003: \***                                                                         
6372: 0003: \***         EXTERNAL FUNCTION DEFINITIONS FOR THE LDT BUFFER FILE          
6373: 0003: \***                                                                         
6374: 0003: \***                     REFERENCE : LDTBFEXT.J86                            
6375: 0003: \***                                                                         
6376: 0003: \***          Version B     Les Cook      4th November 1992               
6377: 0003: \***                                                                         
6378: 0003: \*******************************************************************************
6379: 0003: 
6380: 0003:        FUNCTION LDTBF.SET EXTERNAL                                      
6381: 0003:        END FUNCTION                                                   
6382: 0003: 
6383: 0003: 
6384: 0003:        FUNCTION READ.LDTBF EXTERNAL                                  
6385: 0003:           INTEGER*2 READ.LDTBF                                       
6386: 0003:        END FUNCTION                                                   
6387: 0003:        
6388: 0003:        FUNCTION WRITE.LDTBF EXTERNAL
6389: 0003:           INTEGER*2 WRITE.LDTBF
6390: 0003:        END FUNCTION
6391: 0003:  %INCLUDE UODEXT.J86                      ! FLC
6392: 0003: \*****************************************************************************
6393: 0003: \*****************************************************************************
6394: 0003: \***
6395: 0003: \***     EXTERNAL FUNCTION DEFINITIONS FOR UOD DUMMY FILE
6396: 0003: \***
6397: 0003: \***     REFERENCE: UODEXT.J86
6398: 0003: \***
6399: 0003: \*****************************************************************************
6400: 0003: \*****************************************************************************
6401: 0003: 
6402: 0003:    FUNCTION UOD.SET EXTERNAL
6403: 0003:    END FUNCTION
6404: 0003:    
6405: 0003:    
6406: 0003:  %INCLUDE UODBFEXT.J86                    ! FLC
6407: 0003: \*******************************************************************************
6408: 0003: \*******************************************************************************
6409: 0003: \***
6410: 0003: \***           UOD BUFFER FILE EXTERNAL FILE PUBLIC DEFINITIONS
6411: 0003: \***
6412: 0003: \***                    REFERENCE    : UODBFEXT.BAS
6413: 0003: \***
6414: 0003: \***    Version A.         Michael Kelsall              08th February 1993
6415: 0003: \***
6416: 0003: \*******************************************************************************
6417: 0003: \*******************************************************************************
6418: 0003: 
6419: 0003:  
6420: 0003:   FUNCTION UODBF.SET EXTERNAL
6421: 0003:       INTEGER*2 UODBF.SET
6422: 0003:   END FUNCTION
6423: 0003: 
6424: 0003: 
6425: 0003:   FUNCTION READ.UODBF EXTERNAL
6426: 0003:       INTEGER*2 READ.UODBF 
6427: 0003:   END FUNCTION
6428: 0003: 
6429: 0003:   
6430: 0003:   FUNCTION WRITE.UODBF EXTERNAL
6431: 0003:       INTEGER*2 WRITE.UODBF
6432: 0003:   END FUNCTION
6433: 0003: 
6434: 0003:   
6435: 0003:   FUNCTION WRITE.HOLD.UODBF EXTERNAL
6436: 0003:       INTEGER*2 WRITE.HOLD.UODBF						
6437: 0003:   END FUNCTION								
6438: 0003: 
6439: 0003:  %INCLUDE UODTFEXT.J86                    ! FLC
6440: 0003: \*****************************************************************************
6441: 0003: \*****************************************************************************
6442: 0003: \***
6443: 0003: \***        EXTERNAL FUNCTION DEFINITIONS FOR UODTF
6444: 0003: \***
6445: 0003: \***        REFERENCE:  UODTFEXT.J86
6446: 0003: \***
6447: 0003: \***        Version A         Les Cook         22/2/1993
6448: 0003: \***
6449: 0003: \*****************************************************************************
6450: 0003: \*****************************************************************************
6451: 0003: 
6452: 0003:    FUNCTION UODTF.SET EXTERNAL
6453: 0003:    END FUNCTION
6454: 0003:    
6455: 0003:    FUNCTION READ.UODTF EXTERNAL
6456: 0003:       INTEGER*2 READ.UODTF
6457: 0003:    END FUNCTION
6458: 0003:    
6459: 0003:    FUNCTION WRITE.UODTF EXTERNAL
6460: 0003:       INTEGER*2 WRITE.UODTF
6461: 0003:    END FUNCTION
6462: 0003:    
6463: 0003:    
6464: 0003:  %INCLUDE PILSTEXT.J86                    ! FLC
6465: 0003: \*****************************************************************************
6466: 0003: \*****************************************************************************
6467: 0003: \***
6468: 0003: \***     EXTERNAL FUNCTION DEFINITIONS FOR PILST
6469: 0003: \***
6470: 0003: \***     REFERENCE: PILSTEXT.J86
6471: 0003: \***
6472: 0003: \***     9th October 1992
6473: 0003: \***
6474: 0003: \*****************************************************************************
6475: 0003: \*****************************************************************************
6476: 0003: 
6477: 0003:    FUNCTION PILST.SET EXTERNAL
6478: 0003:    END FUNCTION
6479: 0003:    
6480: 0003:    FUNCTION READ.PILST EXTERNAL
6481: 0003:       INTEGER*2 READ.PILST
6482: 0003:    END FUNCTION
6483: 0003:    
6484: 0003:    FUNCTION READ.PILST.LOCK EXTERNAL
6485: 0003:       INTEGER*2 READ.PILST.LOCK
6486: 0003:    END FUNCTION
6487: 0003:    
6488: 0003:    FUNCTION WRITE.PILST EXTERNAL
6489: 0003:       INTEGER*2 WRITE.PILST
6490: 0003:    END FUNCTION
6491: 0003:    
6492: 0003:    FUNCTION WRITE.PILST.HOLD EXTERNAL
6493: 0003:       INTEGER*2 WRITE.PILST.HOLD
6494: 0003:    END FUNCTION
6495: 0003:    
6496: 0003:    FUNCTION WRITE.PILST.UNLOCK EXTERNAL
6497: 0003:       INTEGER*2 WRITE.PILST.UNLOCK
6498: 0003:    END FUNCTION
6499: 0003:    
6500: 0003:    
6501: 0003:  %INCLUDE PIITMEXT.J86                    ! FLC
6502: 0003: \*****************************************************************************
6503: 0003: \*****************************************************************************
6504: 0003: \***
6505: 0003: \***            EXTERNAL FUNCTION DEFINITIONS FOR PIITM
6506: 0003: \***
6507: 0003: \***            REFERENCE: PIITMEXT.J86
6508: 0003: \***
6509: 0003: \***            Les Cook 9/10/1992
6510: 0003: \***
6511: 0003: \*****************************************************************************
6512: 0003: \*****************************************************************************
6513: 0003: 
6514: 0003:    FUNCTION PIITM.SET EXTERNAL
6515: 0003:    END FUNCTION
6516: 0003:    
6517: 0003:    FUNCTION READ.PIITM EXTERNAL
6518: 0003:       INTEGER*2 READ.PIITM
6519: 0003:    END FUNCTION
6520: 0003:    
6521: 0003:    FUNCTION READ.PIITM.LOCK EXTERNAL
6522: 0003:       INTEGER*2 READ.PIITM.LOCK
6523: 0003:    END FUNCTION
6524: 0003:    
6525: 0003:    FUNCTION WRITE.PIITM EXTERNAL
6526: 0003:       INTEGER*2 WRITE.PIITM
6527: 0003:    END FUNCTION
6528: 0003:    
6529: 0003:    FUNCTION WRITE.PIITM.UNLOCK EXTERNAL
6530: 0003:       INTEGER*2 WRITE.PIITM.UNLOCK
6531: 0003:    END FUNCTION
6532: 0003:    
6533: 0003:    FUNCTION WRITE.PIITM.HOLD.UNLOCK EXTERNAL
6534: 0003:       INTEGER*2 WRITE.PIITM.HOLD.UNLOCK
6535: 0003:    END FUNCTION
6536: 0003:    
6537: 0003:    FUNCTION WRITE.PIITM.HOLD EXTERNAL
6538: 0003:       INTEGER*2 WRITE.PIITM.HOLD
6539: 0003:    END FUNCTION
6540: 0003:    
6541: 0003: !%INCLUDE PDTWFEXT.J86                    ! FLC
6542: 0003: 
6543: 0003:  %INCLUDE CCUODEXT.J86                    ! GMJK
6544: 0003: 
6545: 0003: \*****************************************************************************
6546: 0003: \*****************************************************************************
6547: 0003: \***
6548: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6549: 0003: \***
6550: 0003: \***                   FILE TYPE:  KEYED
6551: 0003: \***
6552: 0003: \***                   REFERENCE:  CCUODEXT.J86
6553: 0003: \***
6554: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6555: 0003: \***				   FILE OF OPEN/CLOSED UODS
6556: 0003: \***
6557: 0003: \***
6558: 0003: \***      VERSION A : Michael J. Kelsall      13th September 1993
6559: 0003: \***      
6560: 0003: \*****************************************************************************
6561: 0003: \*****************************************************************************
6562: 0003: 
6563: 0003: 
6564: 0003:   FUNCTION CCUOD.SET EXTERNAL
6565: 0003:      INTEGER*2 CCUOD.SET
6566: 0003:   END FUNCTION
6567: 0003: 
6568: 0003: 
6569: 0003:   FUNCTION READ.CCUOD EXTERNAL
6570: 0003:     INTEGER*2 READ.CCUOD
6571: 0003:   END FUNCTION
6572: 0003:   
6573: 0003: 
6574: 0003:   FUNCTION READ.CCUOD.LOCKED EXTERNAL
6575: 0003:     INTEGER*2 READ.CCUOD.LOCKED
6576: 0003:   END FUNCTION  
6577: 0003: 
6578: 0003: 
6579: 0003:   FUNCTION WRITE.HOLD.CCUOD EXTERNAL
6580: 0003:     INTEGER*2 WRITE.HOLD.CCUOD
6581: 0003:   END FUNCTION
6582: 0003: 
6583: 0003: 
6584: 0003:   FUNCTION WRITE.UNLOCK.CCUOD EXTERNAL
6585: 0003:     INTEGER*2 WRITE.UNLOCK.CCUOD
6586: 0003:   END FUNCTION
6587: 0003: 
6588: 0003: 
6589: 0003:   FUNCTION WRITE.HOLD.UNLOCK.CCUOD EXTERNAL
6590: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUOD
6591: 0003:   END FUNCTION
6592: 0003:   
6593: 0003: 
6594: 0003:   FUNCTION WRITE.CCUOD EXTERNAL
6595: 0003:     INTEGER*2 WRITE.CCUOD
6596: 0003:   END FUNCTION
6597: 0003: 
6598: 0003:  %INCLUDE CCLAMEXT.J86                    ! 1.4
6599: 0003: 
6600: 0003: \*****************************************************************************
6601: 0003: \*****************************************************************************
6602: 0003: \***
6603: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6604: 0003: \***
6605: 0003: \***                   FILE TYPE:  KEYED
6606: 0003: \***
6607: 0003: \***                   REFERENCE:  CCLAMEXT.J86
6608: 0003: \***
6609: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6610: 0003: \***				   FILE OF CURRENT CREDIT CLAIMS
6611: 0003: \***
6612: 0003: \***
6613: 0003: \***      VERSION A : Michael J. Kelsall      14th September 1993
6614: 0003: \***      
6615: 0003: \*****************************************************************************
6616: 0003: \*****************************************************************************
6617: 0003: 
6618: 0003: 
6619: 0003:   FUNCTION CCLAM.SET EXTERNAL
6620: 0003:      INTEGER*2 CCLAM.SET
6621: 0003:   END FUNCTION
6622: 0003: 
6623: 0003: 
6624: 0003:   FUNCTION READ.CCLAM EXTERNAL
6625: 0003:     INTEGER*2 READ.CCLAM
6626: 0003:   END FUNCTION
6627: 0003:   
6628: 0003: 
6629: 0003:   FUNCTION READ.CCLAM.LOCKED EXTERNAL
6630: 0003:     INTEGER*2 READ.CCLAM.LOCKED
6631: 0003:   END FUNCTION  
6632: 0003: 
6633: 0003: 
6634: 0003:   FUNCTION WRITE.HOLD.CCLAM EXTERNAL
6635: 0003:     INTEGER*2 WRITE.HOLD.CCLAM
6636: 0003:   END FUNCTION
6637: 0003: 
6638: 0003: 
6639: 0003:   FUNCTION WRITE.UNLOCK.CCLAM EXTERNAL
6640: 0003:     INTEGER*2 WRITE.UNLOCK.CCLAM
6641: 0003:   END FUNCTION
6642: 0003: 
6643: 0003: 
6644: 0003:   FUNCTION WRITE.HOLD.UNLOCK.CCLAM EXTERNAL
6645: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.CCLAM
6646: 0003:   END FUNCTION
6647: 0003:   
6648: 0003: 
6649: 0003:   FUNCTION WRITE.CCLAM EXTERNAL
6650: 0003:     INTEGER*2 WRITE.CCLAM
6651: 0003:   END FUNCTION
6652: 0003: 
6653: 0003:  %INCLUDE CCITMEXT.J86                    ! GMJK
6654: 0003: 
6655: 0003: \*****************************************************************************
6656: 0003: \*****************************************************************************
6657: 0003: \***
6658: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6659: 0003: \***
6660: 0003: \***                   FILE TYPE:  KEYED
6661: 0003: \***
6662: 0003: \***                   REFERENCE:  CCITMEXT.J86
6663: 0003: \***
6664: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6665: 0003: \***				   FILE OF ITEMS PER OPEN/CLOSED UODS
6666: 0003: \***
6667: 0003: \***
6668: 0003: \***      VERSION A : Michael J. Kelsall      13th September 1993
6669: 0003: \***      
6670: 0003: \*****************************************************************************
6671: 0003: \*****************************************************************************
6672: 0003: 
6673: 0003: 
6674: 0003:   FUNCTION CCITM.SET EXTERNAL
6675: 0003:      INTEGER*2 CCITM.SET
6676: 0003:   END FUNCTION
6677: 0003: 
6678: 0003: 
6679: 0003:   FUNCTION READ.CCITM EXTERNAL
6680: 0003:     INTEGER*2 READ.CCITM
6681: 0003:   END FUNCTION
6682: 0003:   
6683: 0003: 
6684: 0003:   FUNCTION READ.CCITM.LOCKED EXTERNAL
6685: 0003:     INTEGER*2 READ.CCITM.LOCKED
6686: 0003:   END FUNCTION  
6687: 0003: 
6688: 0003: 
6689: 0003:   FUNCTION WRITE.HOLD.CCITM EXTERNAL
6690: 0003:     INTEGER*2 WRITE.HOLD.CCITM
6691: 0003:   END FUNCTION
6692: 0003: 
6693: 0003: 
6694: 0003:   FUNCTION WRITE.UNLOCK.CCITM EXTERNAL
6695: 0003:     INTEGER*2 WRITE.UNLOCK.CCITM
6696: 0003:   END FUNCTION
6697: 0003: 
6698: 0003: 
6699: 0003:   FUNCTION WRITE.HOLD.UNLOCK.CCITM EXTERNAL
6700: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.CCITM
6701: 0003:   END FUNCTION
6702: 0003: 
6703: 0003: 
6704: 0003:   FUNCTION WRITE.CCITM EXTERNAL
6705: 0003:     INTEGER*2 WRITE.CCITM
6706: 0003:   END FUNCTION
6707: 0003: 
6708: 0003:  %INCLUDE CCTRLEXT.J86                    ! GMJK
6709: 0003: 
6710: 0003: \*****************************************************************************
6711: 0003: \*****************************************************************************
6712: 0003: \***
6713: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6714: 0003: \***
6715: 0003: \***                   FILE TYPE:  DIRECT
6716: 0003: \***
6717: 0003: \***                   REFERENCE:  CCTRLEXT.J86
6718: 0003: \***
6719: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6720: 0003: \***				   CREDIT CLAIMS CONTROL FILE
6721: 0003: \***
6722: 0003: \***
6723: 0003: \***      VERSION A : Michael J. Kelsall      14th September 1993
6724: 0003: \***      
6725: 0003: \*****************************************************************************
6726: 0003: \*****************************************************************************
6727: 0003: 
6728: 0003: 
6729: 0003:   FUNCTION CCTRL.SET EXTERNAL
6730: 0003:      INTEGER*2 CCTRL.SET
6731: 0003:   END FUNCTION
6732: 0003: 
6733: 0003: 
6734: 0003:   FUNCTION READ.CCTRL EXTERNAL
6735: 0003:     INTEGER*2 READ.CCTRL
6736: 0003:   END FUNCTION
6737: 0003:   
6738: 0003: 
6739: 0003:   FUNCTION READ.CCTRL.LOCKED EXTERNAL
6740: 0003:     INTEGER*2 READ.CCTRL.LOCKED
6741: 0003:   END FUNCTION  
6742: 0003: 
6743: 0003: 
6744: 0003:   FUNCTION WRITE.HOLD.CCTRL EXTERNAL
6745: 0003:     INTEGER*2 WRITE.HOLD.CCTRL
6746: 0003:   END FUNCTION
6747: 0003: 
6748: 0003: 
6749: 0003:   FUNCTION WRITE.UNLOCK.CCTRL EXTERNAL
6750: 0003:     INTEGER*2 WRITE.UNLOCK.CCTRL
6751: 0003:   END FUNCTION
6752: 0003: 
6753: 0003: 
6754: 0003:   FUNCTION WRITE.HOLD.UNLOCK.CCTRL EXTERNAL
6755: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.CCTRL
6756: 0003:   END FUNCTION
6757: 0003:   
6758: 0003: 
6759: 0003:   FUNCTION WRITE.CCTRL EXTERNAL
6760: 0003:     INTEGER*2 WRITE.CCTRL
6761: 0003:   END FUNCTION
6762: 0003: 
6763: 0003:  %INCLUDE CCTMPEXT.J86                    ! GMJK
6764: 0003: \*******************************************************************************
6765: 0003: \*******************************************************************************
6766: 0003: \***
6767: 0003: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6768: 0003: \***
6769: 0003: \***                    REFERENCE    : CCTMPEXT.BAS
6770: 0003: \***
6771: 0003: \***    Version A.         Michael Kelsall              30th September 1993
6772: 0003: \***
6773: 0003: \*******************************************************************************
6774: 0003: \*******************************************************************************
6775: 0003: 
6776: 0003:  
6777: 0003:   FUNCTION CCTMP.SET EXTERNAL
6778: 0003:       INTEGER*2 CCTMP.SET
6779: 0003:   END FUNCTION
6780: 0003: 
6781: 0003: 
6782: 0003:   FUNCTION READ.CCTMP EXTERNAL
6783: 0003:       INTEGER*2 READ.CCTMP 
6784: 0003:   END FUNCTION
6785: 0003: 
6786: 0003:   
6787: 0003:   FUNCTION WRITE.CCTMP EXTERNAL
6788: 0003:       INTEGER*2 WRITE.CCTMP
6789: 0003:   END FUNCTION
6790: 0003: 
6791: 0003:   
6792: 0003:   FUNCTION WRITE.HOLD.CCTMP EXTERNAL
6793: 0003:       INTEGER*2 WRITE.HOLD.CCTMP						
6794: 0003:   END FUNCTION								
6795: 0003: 
6796: 0003:  %INCLUDE CCBUFEXT.J86                    ! GMJK
6797: 0003: \*******************************************************************************
6798: 0003: \*******************************************************************************
6799: 0003: \***
6800: 0003: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
6801: 0003: \***
6802: 0003: \***                    REFERENCE    : CCBUFEXT.BAS
6803: 0003: \***
6804: 0003: \***    Version A.         Michael Kelsall              30th September 1993
6805: 0003: \***
6806: 0003: \*******************************************************************************
6807: 0003: \*******************************************************************************
6808: 0003: 
6809: 0003:  
6810: 0003:   FUNCTION CCBUF.SET EXTERNAL
6811: 0003:       INTEGER*2 CCBUF.SET
6812: 0003:   END FUNCTION
6813: 0003: 
6814: 0003: 
6815: 0003:   FUNCTION READ.CCBUF EXTERNAL
6816: 0003:       INTEGER*2 READ.CCBUF 
6817: 0003:   END FUNCTION
6818: 0003: 
6819: 0003:   
6820: 0003:   FUNCTION WRITE.CCBUF EXTERNAL
6821: 0003:       INTEGER*2 WRITE.CCBUF
6822: 0003:   END FUNCTION
6823: 0003: 
6824: 0003:   
6825: 0003:   FUNCTION WRITE.HOLD.CCBUF EXTERNAL
6826: 0003:       INTEGER*2 WRITE.HOLD.CCBUF						
6827: 0003:   END FUNCTION								
6828: 0003: 
6829: 0003:  %INCLUDE CCUPFEXT.J86                    ! HMJK
6830: 0003: 
6831: 0003: \*****************************************************************************
6832: 0003: \*****************************************************************************
6833: 0003: \***
6834: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTION EXTERNAL DECLARATIONS
6835: 0003: \***
6836: 0003: \***                   FILE TYPE:  KEYED
6837: 0003: \***
6838: 0003: \***                   REFERENCE:  CCUPFEXT.J86
6839: 0003: \***
6840: 0003: \***	             DESCRIPTION:  RETURNS / AUTOMATIC CREDIT CLAIMING
6841: 0003: \***				   UOD PROCESSED FILE 
6842: 0003: \***
6843: 0003: \***      VERSION A : Michael J. Kelsall      14th March 1994
6844: 0003: \***      
6845: 0003: \*****************************************************************************
6846: 0003: \*****************************************************************************
6847: 0003: 
6848: 0003: 
6849: 0003:   FUNCTION CCUPF.SET EXTERNAL
6850: 0003:      INTEGER*2 CCUPF.SET
6851: 0003:   END FUNCTION
6852: 0003: 
6853: 0003: 
6854: 0003:   FUNCTION READ.CCUPF EXTERNAL
6855: 0003:     INTEGER*2 READ.CCUPF
6856: 0003:   END FUNCTION
6857: 0003:   
6858: 0003: 
6859: 0003:   FUNCTION READ.CCUPF.LOCKED EXTERNAL
6860: 0003:     INTEGER*2 READ.CCUPF.LOCKED
6861: 0003:   END FUNCTION  
6862: 0003: 
6863: 0003: 
6864: 0003:   FUNCTION WRITE.HOLD.CCUPF EXTERNAL
6865: 0003:     INTEGER*2 WRITE.HOLD.CCUPF
6866: 0003:   END FUNCTION
6867: 0003: 
6868: 0003: 
6869: 0003:   FUNCTION WRITE.UNLOCK.CCUPF EXTERNAL
6870: 0003:     INTEGER*2 WRITE.UNLOCK.CCUPF
6871: 0003:   END FUNCTION
6872: 0003: 
6873: 0003: 
6874: 0003:   FUNCTION WRITE.HOLD.UNLOCK.CCUPF EXTERNAL
6875: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.CCUPF
6876: 0003:   END FUNCTION
6877: 0003: 
6878: 0003: 
6879: 0003:   FUNCTION WRITE.CCUPF EXTERNAL
6880: 0003:     INTEGER*2 WRITE.CCUPF
6881: 0003:   END FUNCTION
6882: 0003: 
6883: 0003:  %INCLUDE CCWKFEXT.J86                    ! GMJK
6884: 0003: \*****************************************************************************
6885: 0003: \*****************************************************************************
6886: 0003: \***
6887: 0003: \***       EXTERNAL FUNCTION DEFINTIONS FOR CCWKF - RETURNS WORK FILE
6888: 0003: \***
6889: 0003: \***                      REFERENCE: CCWKFEXT.J86
6890: 0003: \***
6891: 0003: \***    Version A          Michael J. Kelsall            30th September 1993
6892: 0003: \***
6893: 0003: \*****************************************************************************
6894: 0003: \*****************************************************************************
6895: 0003: 
6896: 0003:    FUNCTION CCWKF.SET EXTERNAL
6897: 0003:       INTEGER*2 CCWKF.SET
6898: 0003:    END FUNCTION
6899: 0003:    
6900: 0003:    FUNCTION READ.CCWKF EXTERNAL
6901: 0003:       INTEGER*2 READ.CCWKF
6902: 0003:    END FUNCTION
6903: 0003:    
6904: 0003:    FUNCTION WRITE.CCWKF EXTERNAL
6905: 0003:       INTEGER*2 WRITE.CCWKF
6906: 0003:    END FUNCTION
6907: 0003:    
6908: 0003:  %INCLUDE CCDMYEXT.J86                    ! GMJK
6909: 0003: \*****************************************************************************
6910: 0003: \*****************************************************************************
6911: 0003: \***
6912: 0003: \***        EXTERNAL FUNCTION DEFINITIONS FOR RETURNS DUMMY FILE
6913: 0003: \***
6914: 0003: \***                      REFERENCE: CCDMYEXT.J86
6915: 0003: \***
6916: 0003: \***    Version A       Michael J. Kelsall             30th September 1993
6917: 0003: \***
6918: 0003: \*****************************************************************************
6919: 0003: \*****************************************************************************
6920: 0003: 
6921: 0003:    FUNCTION CCDMY.SET EXTERNAL
6922: 0003:       INTEGER*2 CCDMY.SET
6923: 0003:    END FUNCTION
6924: 0003:    
6925: 0003:    
6926: 0003:  %INCLUDE LDTAFEXT.J86                    ! HMJK
6927: 0003: 
6928: 0003: \*****************************************************************************
6929: 0003: \*****************************************************************************
6930: 0003: \***
6931: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
6932: 0003: \***
6933: 0003: \***                   FILE TYPE:  DIRECT
6934: 0003: \***
6935: 0003: \***                   REFERENCE:  LDTAFEXT.J86
6936: 0003: \***
6937: 0003: \***	             DESCRIPTION:  LDT / PDT SUPPORT LINK AUDIT FILE
6938: 0003: \***
6939: 0003: \***
6940: 0003: \***      VERSION A        Michael J. Kelsall        30th September 1993
6941: 0003: \*** 
6942: 0003: \***      VERSION B        Michael J. Kelsall        25th March 1994
6943: 0003: \***      No change to external definitions.
6944: 0003: \***      
6945: 0003: \*****************************************************************************
6946: 0003: \*****************************************************************************
6947: 0003: 
6948: 0003: 
6949: 0003:   FUNCTION LDTAF.SET EXTERNAL
6950: 0003:      INTEGER*2 LDTAF.SET
6951: 0003:   END FUNCTION
6952: 0003: 
6953: 0003: 
6954: 0003:   FUNCTION READ.LDTAF EXTERNAL
6955: 0003:     INTEGER*2 READ.LDTAF
6956: 0003:   END FUNCTION
6957: 0003:   
6958: 0003: 
6959: 0003:   FUNCTION WRITE.HOLD.LDTAF EXTERNAL
6960: 0003:     INTEGER*2 WRITE.HOLD.LDTAF
6961: 0003:   END FUNCTION
6962: 0003: 
6963: 0003: 
6964: 0003:   FUNCTION WRITE.LDTAF EXTERNAL
6965: 0003:     INTEGER*2 WRITE.LDTAF
6966: 0003:   END FUNCTION
6967: 0003: 
6968: 0003:  %INCLUDE SOFTSEXT.J86                    ! GMJK
6969: 0003: \*******************************************************************************
6970: 0003: \***                                                                         ***
6971: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE SOFTWARE STATUS FILE         ***
6972: 0003: \***                                                                         ***
6973: 0003: \***                     REFERENCE : SOFTSEXT.J86                            ***
6974: 0003: \***                                                                         ***
6975: 0003: \***      Version A         Andrew Wedgeworth          1st July 1992         ***
6976: 0003: \***
6977: 0003: \***   Version B
6978: 0003: \***                                                                      ***
6979: 0003: \***      Version C         Steve Wright               3rd May 1996          ***
6980: 0003: \***      Synchronise with function source.                                  ***
6981: 0003: \*******************************************************************************
6982: 0003: 
6983: 0003:       FUNCTION SOFTS.SET EXTERNAL 
6984: 0003:       END FUNCTION
6985: 0003:       
6986: 0003:       FUNCTION READ.SOFTS EXTERNAL
6987: 0003:           INTEGER*2 I%, READ.SOFTS
6988: 0003:       END FUNCTION	                   
6989: 0003: 
6990: 0003:       FUNCTION WRITE.SOFTS EXTERNAL
6991: 0003:           INTEGER*2 I%, WRITE.SOFTS
6992: 0003:       END FUNCTION
6993: 0003: 
6994: 0003: 
6995: 0003:  %INCLUDE STKBFEXT.J86                    ! 1.5
6996: 0003: \******************************************************************************
6997: 0003: \******************************************************************************
6998: 0003: \***
6999: 0003: \***   $Workfile:   STKBFEXT.J86  $
7000: 0003: \***
7001: 0003: \***   $Revision:   1.0  $
7002: 0003: \***
7003: 0003: \******************************************************************************
7004: 0003: \******************************************************************************
7005: 0003: \***
7006: 0003: \***   $Log:   V:\archive\j86\stkbfext.j8v  $
7007: 0003: \***   
7008: 0003: \***      Rev 1.0   15 Jul 1997 14:20:38   DEV45PS
7009: 0003: \***    
7010: 0003: \***   
7011: 0003: \***      Rev 1.0   09 Jul 1997 11:04:54   DEV45PS
7012: 0003: \***   Stocktake System New Files
7013: 0003: \***   
7014: 0003: \******************************************************************************
7015: 0003: \******************************************************************************\*****************************************************************************
7016: 0003: \***
7017: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE BUFFER FILE
7018: 0003: \***
7019: 0003: \***           REFERENCE:   STKBFEXT.J86
7020: 0003: \***
7021: 0003: \***           VERSION A         Nik Sen         19th June 1997
7022: 0003: \***
7023: 0003: \***
7024: 0003: \*******************************************************************************
7025: 0003: \*******************************************************************************
7026: 0003: 
7027: 0003:    FUNCTION STKBF.SET EXTERNAL
7028: 0003:    END FUNCTION
7029: 0003:    
7030: 0003:    FUNCTION READ.STKBF EXTERNAL
7031: 0003:       INTEGER*2 READ.STKBF
7032: 0003:    END FUNCTION
7033: 0003:    
7034: 0003:    FUNCTION WRITE.STKBF EXTERNAL
7035: 0003:       INTEGER*2 WRITE.STKBF
7036: 0003:    END FUNCTION
7037: 0003:  
7038: 0003:  %INCLUDE SXTMPEXT.J86                    ! 1.5
7039: 0003: \*****************************************************************************
7040: 0003: \***
7041: 0003: \***           FUNCTION DEFINITIONS FOR THE TEMPORARY STOCKTAKE BUFFER FILE
7042: 0003: \***
7043: 0003: \***           REFERENCE:   STKBFEXT.J86
7044: 0003: \***
7045: 0003: \***           VERSION A         Nik Sen         30th June 1997
7046: 0003: \***
7047: 0003: \***
7048: 0003: \*******************************************************************************
7049: 0003: \*******************************************************************************
7050: 0003: 
7051: 0003:    FUNCTION SXTMP.SET EXTERNAL
7052: 0003:    END FUNCTION
7053: 0003:    
7054: 0003:    FUNCTION READ.SXTMP EXTERNAL
7055: 0003:       INTEGER*2 READ.SXTMP
7056: 0003:    END FUNCTION
7057: 0003:    
7058: 0003:    FUNCTION WRITE.SXTMP EXTERNAL
7059: 0003:       INTEGER*2 WRITE.SXTMP
7060: 0003:    END FUNCTION
7061: 0003:  
7062: 0003:  %INCLUDE STKTKEXT.J86                    ! 1.5
7063: 0003: \*****************************************************************************
7064: 0003: \*****************************************************************************
7065: 0003: \***
7066: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR STOCKTAKE
7067: 0003: \***
7068: 0003: \***      REFERENCE: STKTKEXT.J86
7069: 0003: \***
7070: 0003: \*****************************************************************************
7071: 0003: \*****************************************************************************
7072: 0003: 
7073: 0003: 
7074: 0003:    FUNCTION STKTK.SET EXTERNAL
7075: 0003:    END FUNCTION
7076: 0003:    
7077: 0003:  %INCLUDE STLDTEXT.J86                    ! 1.6
7078: 0003: \*****************************************************************************
7079: 0003: \*****************************************************************************
7080: 0003: \***
7081: 0003: \***                   FUNCTION DEFINITIONS FOR THE STLDT
7082: 0003: \***
7083: 0003: \***           Version A           David Artiss         20th December 2000
7084: 0003: \***
7085: 0003: \*****************************************************************************
7086: 0003: \*****************************************************************************
7087: 0003: 
7088: 0003:    FUNCTION STLDT.SET EXTERNAL
7089: 0003:    END FUNCTION
7090: 0003: 
7091: 0003:   FUNCTION READ.STLDT EXTERNAL
7092: 0003:    INTEGER*2 READ.STLDT
7093: 0003:   END FUNCTION
7094: 0003: 
7095: 0003:   FUNCTION WRITE.STLDT EXTERNAL
7096: 0003:    INTEGER*2 WRITE.STLDT
7097: 0003:   END FUNCTION
7098: 0003:  %INCLUDE SXTCFEXT.J86                    ! 1.8DA
7099: 0003: \******************************************************************************
7100: 0003: \******************************************************************************
7101: 0003: \***
7102: 0003: \***   $Workfile:   SXTCFEXT.J86  $
7103: 0003: \***
7104: 0003: \***   $Revision:   1.0  $
7105: 0003: \***
7106: 0003: \******************************************************************************
7107: 0003: \******************************************************************************
7108: 0003: \***
7109: 0003: \***   $Log:   V:\archive\j86\sxtcfext.j8v  $
7110: 0003: \***   
7111: 0003: \***      Rev 1.0   15 Jul 1997 14:21:08   DEV45PS
7112: 0003: \***    
7113: 0003: \***   
7114: 0003: \***      Rev 1.0   09 Jul 1997 11:05:30   DEV45PS
7115: 0003: \***   Stocktake System New Files
7116: 0003: \***   
7117: 0003: \******************************************************************************
7118: 0003: \******************************************************************************\*****************************************************************************
7119: 0003: \*****************************************************************************
7120: 0003: \***
7121: 0003: \***                  FUNCTION DEFINITIONS FOR SXTCF
7122: 0003: \***
7123: 0003: \***                      REFERENCE    : SXTCFEXA
7124: 0003: \***
7125: 0003: \***           VERSION A : NIK SEN  3rd July 1997
7126: 0003: \***
7127: 0003: \*****************************************************************************
7128: 0003: \*****************************************************************************
7129: 0003: 
7130: 0003:    FUNCTION SXTCF.SET EXTERNAL
7131: 0003:    END FUNCTION
7132: 0003: 
7133: 0003:   FUNCTION READ.SXTCF.LOCK EXTERNAL
7134: 0003:    INTEGER*1 READ.SXTCF.LOCK
7135: 0003:   END FUNCTION
7136: 0003: 
7137: 0003:   FUNCTION WRITE.SXTCF.UNLOCK EXTERNAL
7138: 0003:    INTEGER*1 WRITE.SXTCF.UNLOCK
7139: 0003:   END FUNCTION
7140: 0003: 
7141: 0003:   FUNCTION WRITE.SXTCF.UNLOCK.HOLD EXTERNAL
7142: 0003:    INTEGER*1 WRITE.SXTCF.UNLOCK.HOLD
7143: 0003:   END FUNCTION
7144: 0003: 
7145: 0003:   FUNCTION READ.SXTCF EXTERNAL
7146: 0003:    INTEGER*1 READ.SXTCF
7147: 0003:   END FUNCTION
7148: 0003: 
7149: 0003:   FUNCTION WRITE.SXTCF         EXTERNAL
7150: 0003:    INTEGER*1 WRITE.SXTCF        
7151: 0003:   END FUNCTION
7152: 0003: 
7153: 0003:  %INCLUDE STKCFEXT.J86                    ! 1.8DA
7154: 0003: \*****************************************************************************
7155: 0003: \*****************************************************************************
7156: 0003: \***
7157: 0003: \***                  FUNCTION DEFINITIONS FOR STKCF
7158: 0003: \***
7159: 0003: \***                      REFERENCE    : STKCFEXA
7160: 0003: \***
7161: 0003: \***           VERSION A : STEVEN GOULDING  11.01.93
7162: 0003: \***
7163: 0003: \*****************************************************************************
7164: 0003: \*****************************************************************************
7165: 0003: 
7166: 0003:    FUNCTION STKCF.SET EXTERNAL
7167: 0003:    END FUNCTION
7168: 0003: 
7169: 0003:   FUNCTION READ.STKCF.LOCK EXTERNAL
7170: 0003:    INTEGER*1 READ.STKCF.LOCK
7171: 0003:   END FUNCTION
7172: 0003: 
7173: 0003:   FUNCTION WRITE.STKCF.UNLOCK EXTERNAL
7174: 0003:    INTEGER*1 WRITE.STKCF.UNLOCK
7175: 0003:   END FUNCTION
7176: 0003: 
7177: 0003:   FUNCTION WRITE.STKCF.UNLOCK.HOLD EXTERNAL
7178: 0003:    INTEGER*1 WRITE.STKCF.UNLOCK.HOLD
7179: 0003:   END FUNCTION
7180: 0003: 
7181: 0003:   FUNCTION READ.STKCF EXTERNAL
7182: 0003:    INTEGER*1 READ.STKCF
7183: 0003:   END FUNCTION
7184: 0003: 
7185: 0003:   FUNCTION WRITE.STKCF         EXTERNAL
7186: 0003:    INTEGER*1 WRITE.STKCF        
7187: 0003:   END FUNCTION
7188: 0003: 
7189: 0003:  %INCLUDE STKMFEXT.J86                    ! 1.8DA
7190: 0003: \******************************************************************************
7191: 0003: \******************************************************************************
7192: 0003: \***
7193: 0003: \***   $Workfile:   STKMFEXT.J86  $
7194: 0003: \***
7195: 0003: \***   $Revision:   1.0  $
7196: 0003: \***
7197: 0003: \******************************************************************************
7198: 0003: \******************************************************************************
7199: 0003: \***
7200: 0003: \***   $Log:   V:\archive\j86\stkmfext.j8v  $
7201: 0003: \***   
7202: 0003: \***      Rev 1.0   15 Jul 1997 14:20:56   DEV45PS
7203: 0003: \***    
7204: 0003: \***   
7205: 0003: \***      Rev 1.0   09 Jul 1997 11:05:18   DEV45PS
7206: 0003: \***   Stocktake System New Files
7207: 0003: \***   
7208: 0003: \******************************************************************************
7209: 0003: \******************************************************************************\*****************************************************************************
7210: 0003: \***
7211: 0003: \***  FUNCTION DEFINITIONS FOR THE STOCKTAKE MAINFRAME TRANSMISSION FILE
7212: 0003: \***
7213: 0003: \***           REFERENCE:   STKMFEXT.J86
7214: 0003: \***
7215: 0003: \***           VERSION A         Nik Sen         19th June 1997
7216: 0003: \***
7217: 0003: \***
7218: 0003: \*******************************************************************************
7219: 0003: \*******************************************************************************
7220: 0003: 
7221: 0003:    FUNCTION STKMF.SET EXTERNAL
7222: 0003:    END FUNCTION
7223: 0003:    
7224: 0003:    FUNCTION READ.STKMF EXTERNAL
7225: 0003:       INTEGER*2 READ.STKMF
7226: 0003:    END FUNCTION
7227: 0003:    
7228: 0003:    FUNCTION WRITE.STKMF EXTERNAL
7229: 0003:       INTEGER*2 WRITE.STKMF
7230: 0003:    END FUNCTION
7231: 0003:  
7232: 0003:  %INCLUDE STKRCEXT.J86                    ! 1.8DA
7233: 0003: \******************************************************************************
7234: 0003: \******************************************************************************
7235: 0003: \***
7236: 0003: \***   $Workfile:   STKRCEXT.J86  $
7237: 0003: \***
7238: 0003: \***   $Revision:   1.0  $
7239: 0003: \***
7240: 0003: \******************************************************************************
7241: 0003: \******************************************************************************
7242: 0003: \***
7243: 0003: \***   $Log:   V:\archive\j86\stkrcext.j8v  $
7244: 0003: \***   
7245: 0003: \***      Rev 1.0   15 Jul 1997 14:21:00   DEV45PS
7246: 0003: \***    
7247: 0003: \***   
7248: 0003: \***      Rev 1.0   09 Jul 1997 11:05:24   DEV45PS
7249: 0003: \***   Stocktake System New Files
7250: 0003: \***   
7251: 0003: \******************************************************************************
7252: 0003: \******************************************************************************\*****************************************************************************
7253: 0003: \***
7254: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE RECOUNT FILE
7255: 0003: \***
7256: 0003: \***           REFERENCE:   STKRCEXT.J86
7257: 0003: \***
7258: 0003: \***           VERSION A         Nik Sen         19th June 1997
7259: 0003: \***
7260: 0003: \***
7261: 0003: \*******************************************************************************
7262: 0003: \*******************************************************************************
7263: 0003: 
7264: 0003:    FUNCTION STKRC.SET EXTERNAL
7265: 0003:    END FUNCTION
7266: 0003:    
7267: 0003:    FUNCTION READ.STKRC EXTERNAL
7268: 0003:       INTEGER*2 READ.STKRC
7269: 0003:    END FUNCTION
7270: 0003:    
7271: 0003:    FUNCTION WRITE.STKRC EXTERNAL
7272: 0003:       INTEGER*2 WRITE.STKRC
7273: 0003:    END FUNCTION
7274: 0003:  
7275: 0003:  %INCLUDE XGCFEXT.J86                     ! 1.8DA
7276: 0003: \******************************************************************************
7277: 0003: \******************************************************************************
7278: 0003: \***
7279: 0003: \***         %INCLUDE FOR STOCKTAKE GROUP CODE FILE
7280: 0003: \***
7281: 0003: \***                  FILE TYPE    : Keyed
7282: 0003: \***
7283: 0003: \***                  REFERENCE    : XGCFEXT.J86
7284: 0003: \***
7285: 0003: \***    VERSION A               Steve Wright                        24 Aug 1999
7286: 0003: \***
7287: 0003: \*******************************************************************************
7288: 0003: \*******************************************************************************
7289: 0003: 
7290: 0003: FUNCTION XGCF.SET EXTERNAL
7291: 0003: END FUNCTION
7292: 0003: 
7293: 0003: FUNCTION READ.XGCF EXTERNAL
7294: 0003:    INTEGER*2 READ.XGCF
7295: 0003: END FUNCTION
7296: 0003: 
7297: 0003: FUNCTION READ.XGCF.LOCK EXTERNAL
7298: 0003:    INTEGER*2 READ.XGCF.LOCK
7299: 0003: END FUNCTION
7300: 0003: 
7301: 0003: FUNCTION WRITE.XGCF EXTERNAL
7302: 0003:    INTEGER*2 WRITE.XGCF
7303: 0003: END FUNCTION
7304: 0003: 
7305: 0003: FUNCTION WRITE.XGCF.HOLD EXTERNAL
7306: 0003:    INTEGER*2 WRITE.XGCF.HOLD
7307: 0003: END FUNCTION
7308: 0003: 
7309: 0003: FUNCTION WRITE.XGCF.UNLOCK EXTERNAL
7310: 0003:    INTEGER*2 WRITE.XGCF.UNLOCK
7311: 0003: END FUNCTION
7312: 0003: 
7313: 0003:  %INCLUDE STKEXEXT.J86                    ! 1.8DA
7314: 0003: \******************************************************************************
7315: 0003: \******************************************************************************
7316: 0003: \***
7317: 0003: \***   $Workfile:   STKEXEXT.J86  $
7318: 0003: \***
7319: 0003: \***   $Revision:   1.0  $
7320: 0003: \***
7321: 0003: \******************************************************************************
7322: 0003: \******************************************************************************
7323: 0003: \***
7324: 0003: \***   $Log:   V:\archive\j86\stkexext.j8v  $
7325: 0003: \***   
7326: 0003: \***      Rev 1.0   15 Jul 1997 14:20:44   DEV45PS
7327: 0003: \***    
7328: 0003: \***   
7329: 0003: \***      Rev 1.0   09 Jul 1997 11:05:06   DEV45PS
7330: 0003: \***   Stocktake System New Files
7331: 0003: \***   
7332: 0003: \******************************************************************************
7333: 0003: \******************************************************************************\*****************************************************************************
7334: 0003: \***
7335: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE EXCEPTIONS FILE
7336: 0003: \***
7337: 0003: \***           REFERENCE:   STKEXEXT.J86
7338: 0003: \***
7339: 0003: \***           VERSION A         Nik Sen         19th June 1997
7340: 0003: \***
7341: 0003: \***
7342: 0003: \*******************************************************************************
7343: 0003: \*******************************************************************************
7344: 0003: 
7345: 0003:    FUNCTION STKEX.SET EXTERNAL
7346: 0003:    END FUNCTION
7347: 0003:    
7348: 0003:    FUNCTION READ.STKEX EXTERNAL
7349: 0003:       INTEGER*2 READ.STKEX
7350: 0003:    END FUNCTION
7351: 0003:    
7352: 0003:    FUNCTION WRITE.STKEX EXTERNAL
7353: 0003:       INTEGER*2 WRITE.STKEX
7354: 0003:    END FUNCTION
7355: 0003:  
7356: 0003:  %INCLUDE STKIFEXT.J86                    ! 1.8DA
7357: 0003: \******************************************************************************
7358: 0003: \******************************************************************************
7359: 0003: \***
7360: 0003: \***   $Workfile:   STKIFEXT.J86  $
7361: 0003: \***
7362: 0003: \***   $Revision:   1.0  $
7363: 0003: \***
7364: 0003: \******************************************************************************
7365: 0003: \******************************************************************************
7366: 0003: \***
7367: 0003: \***   $Log:   V:\archive\j86\stkifext.j8v  $
7368: 0003: \***   
7369: 0003: \***      Rev 1.0   15 Jul 1997 14:20:48   DEV45PS
7370: 0003: \***    
7371: 0003: \***   
7372: 0003: \***      Rev 1.0   09 Jul 1997 11:05:12   DEV45PS
7373: 0003: \***   Stocktake System New Files
7374: 0003: \***   
7375: 0003: \******************************************************************************
7376: 0003: \******************************************************************************\*****************************************************************************
7377: 0003: \***
7378: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM FILE
7379: 0003: \***
7380: 0003: \***           REFERENCE:   STKIFEXT.J86
7381: 0003: \***
7382: 0003: \***           VERSION A         Nik Sen         19th June 1997
7383: 0003: \***
7384: 0003: \***
7385: 0003: \*******************************************************************************
7386: 0003: \*******************************************************************************
7387: 0003: 
7388: 0003:    FUNCTION STKIF.SET EXTERNAL
7389: 0003:    END FUNCTION
7390: 0003:    
7391: 0003:    FUNCTION READ.STKIF EXTERNAL
7392: 0003:       INTEGER*2 READ.STKIF
7393: 0003:    END FUNCTION
7394: 0003:    
7395: 0003:    FUNCTION WRITE.STKIF EXTERNAL
7396: 0003:       INTEGER*2 WRITE.STKIF
7397: 0003:    END FUNCTION
7398: 0003:  
7399: 0003:  %INCLUDE LOCNTEXT.J86                    ! 1.8DA
7400: 0003: \******************************************************************************
7401: 0003: \******************************************************************************
7402: 0003: \***
7403: 0003: \***   $Workfile:   LOCNTEXT.J86  $
7404: 0003: \***
7405: 0003: \***   $Revision:   1.0  $
7406: 0003: \***
7407: 0003: \******************************************************************************
7408: 0003: \******************************************************************************
7409: 0003: \***
7410: 0003: \***   $Log:   V:\archive\j86\locntext.j8v  $
7411: 0003: \***   
7412: 0003: \***      Rev 1.0   03 Feb 1998 10:07:40   DEV69PS
7413: 0003: \***    
7414: 0003: \***   
7415: 0003: \******************************************************************************
7416: 0003: \******************************************************************************
7417: 0003: \***
7418: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE LOCATION COUNT FILE
7419: 0003: \***
7420: 0003: \***           REFERENCE:   LOCNTEXT.J86
7421: 0003: \***
7422: 0003: \***           VERSION A         Johnnie Chan    6th Jan 1998
7423: 0003: \***
7424: 0003: \***
7425: 0003: \*******************************************************************************
7426: 0003: \*******************************************************************************
7427: 0003: 
7428: 0003:    FUNCTION LOCCNT.SET EXTERNAL
7429: 0003:    END FUNCTION
7430: 0003:    
7431: 0003:    FUNCTION READ.LOCCNT EXTERNAL
7432: 0003:       INTEGER*2 READ.LOCCNT
7433: 0003:    END FUNCTION
7434: 0003:    
7435: 0003:    FUNCTION WRITE.LOCCNT EXTERNAL
7436: 0003:       INTEGER*2 WRITE.LOCCNT
7437: 0003:    END FUNCTION
7438: 0003: 
7439: 0003:    FUNCTION GET.LOCCNT.RECNUM(LOC.CODE$) EXTERNAL
7440: 0003:       INTEGER*4 GET.LOCCNT.RECNUM
7441: 0003:       STRING LOC.CODE$
7442: 0003:    END FUNCTION
7443: 0003:  
7444: 0003:  %INCLUDE STKIGEXT.J86                    ! 1.8DA
7445: 0003: \*****************************************************************************
7446: 0003: \***
7447: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE ITEM GROUP FILE
7448: 0003: \***
7449: 0003: \***           REFERENCE:   STKIGEXT.J86
7450: 0003: \***
7451: 0003: \***           VERSION A         Nik Sen         17th June 1997
7452: 0003: \***
7453: 0003: \***
7454: 0003: \*******************************************************************************
7455: 0003: \*******************************************************************************
7456: 0003: 
7457: 0003:    FUNCTION STKIG.SET EXTERNAL
7458: 0003:    END FUNCTION
7459: 0003:    
7460: 0003:    FUNCTION READ.STKIG EXTERNAL
7461: 0003:       INTEGER*2 READ.STKIG
7462: 0003:    END FUNCTION
7463: 0003:    
7464: 0003:    FUNCTION WRITE.STKIG EXTERNAL
7465: 0003:       INTEGER*2 WRITE.STKIG
7466: 0003:    END FUNCTION
7467: 0003:  
7468: 0003:  %INCLUDE STKTFEXT.J86                    ! 1.8DA
7469: 0003: \******************************************************************************
7470: 0003: \******************************************************************************
7471: 0003: \***
7472: 0003: \***   $Workfile:   STKTFEXT.J86  $
7473: 0003: \***
7474: 0003: \***   $Revision:   1.1  $
7475: 0003: \***
7476: 0003: \******************************************************************************
7477: 0003: \******************************************************************************
7478: 0003: \***
7479: 0003: \***   $Log:   V:\archive\j86\stktfext.j8v  $
7480: 0003: \***   
7481: 0003: \***      Rev 1.1   15 Jul 1997 14:36:30   DEV45PS
7482: 0003: \***    
7483: 0003: \***   
7484: 0003: \***      Rev 1.0   15 Jul 1997 14:21:04   DEV45PS
7485: 0003: \***   Stocktake System New Files
7486: 0003: \***   
7487: 0003: \******************************************************************************
7488: 0003: \******************************************************************************\*****************************************************************************
7489: 0003: \***
7490: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE TOTALS FILE
7491: 0003: \***
7492: 0003: \***           REFERENCE:   STKTFEXT.J86
7493: 0003: \***
7494: 0003: \***           VERSION A         Nik Sen         15th July 1997
7495: 0003: \***
7496: 0003: \***
7497: 0003: \*******************************************************************************
7498: 0003: \*******************************************************************************
7499: 0003: 
7500: 0003:    FUNCTION STKTF.SET EXTERNAL
7501: 0003:    END FUNCTION
7502: 0003:    
7503: 0003:    FUNCTION READ.STKTF EXTERNAL
7504: 0003:       INTEGER*2 READ.STKTF
7505: 0003:    END FUNCTION
7506: 0003:    
7507: 0003:    FUNCTION WRITE.STKTF EXTERNAL
7508: 0003:       INTEGER*2 WRITE.STKTF
7509: 0003:    END FUNCTION
7510: 0003:  
7511: 0003:  %INCLUDE IRFEXT.J86                      ! 1.8DA
7512: 0003: \*********************************************************************************
7513: 0003: \***
7514: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE ITEM REFERENCE FILE
7515: 0003: \***
7516: 0003: \***                    REFERENCE : IRFEXT.J86
7517: 0003: \***
7518: 0003: \***      Version A          Andrew Wedgeworth        9th July 1992
7519: 0003: \***
7520: 0003: \***      Version B          Andrew Wedgeworth        14th December 1992
7521: 0003: \***      Version letter incremented to match other IRF code.
7522: 0003: \***
7523: 0003: \***      Version C           Steve Windsor        12.02.93
7524: 0003: \***      Added external reference to read the alternate IRF.
7525: 0003: \***
7526: 0003: \***      Version D           Steve Windsor        12.05.93
7527: 0003: \***      Added all external references that wre in the original FNS.
7528: 0003: \***
7529: 0003: \***      Version E           Steve Perkins        21.09.93
7530: 0003: \***      Deals project: Fields changed for new deals project
7531: 0003: \*** 
7532: 0003: \***      Version F           Mark Walker          5th January 1994
7533: 0003: \***      Version letter incremented to match other IRF code.           
7534: 0003: \***                                                                    
7535: 0003: \***      Version G     Stuart William McConnachie      11th February 2000
7536: 0003: \***      Converted IRF.INDICAT2$ to integer flag byte.
7537: 0003: \***
7538: 0003: \***      REVISION 1.6.               ROBERT COWEY.               9 JUL 2002.
7539: 0003: \***      Major changes to IRF layout for 2002 Deals Rewrite project.
7540: 0003: \***      No changes to this particular file for this revision.
7541: 0003: \***
7542: 0003: \***      REVISION 1.7.               ROBERT COWEY.               5 AUG 2002.
7543: 0003: \***      Further changes for 2002 Deals Rewrite project (PSBF19 related).
7544: 0003: \***      Defined new functions CONCAT.NEW.IRF.DATA$ and SPLIT.NEW.IRF.DATA$.
7545: 0003: \***
7546: 0003: \***      REVISION 1.8                ROBERT COWEY.              15 JUL 2003.
7547: 0003: \***      Usage of INDICAT0% bit-3 X'08' changed to Item Contains Alcohol.
7548: 0003: \***      No changes to this file other than description.
7549: 0003: \***      No changes to IRF file functions.
7550: 0003: \***
7551: 0003: \***      REVISION 1.9.      STUART WILLIAM MCCONNACHIE           22 OCT 2003.
7552: 0003: \***      Changes to remove limit of 3 deals per item.
7553: 0003: \***      No changes to this file.
7554: 0003: \***
7555: 0003: \***      REVISION 2.0.             ALAN CARR                      9 FEB 2006.
7556: 0003: \***      Add new IRF.INDICAT8% 1 byte, amend IRF.UNUSED$ from 3 to 2 bytes.
7557: 0003: \***      No changes to this file.
7558: 0003: \***
7559: 0003: \***..............................................................................
7560: 0003:    
7561: 0003:    FUNCTION IRF.SET EXTERNAL
7562: 0003:    END FUNCTION
7563: 0003: 
7564: 0003:   FUNCTION CONCAT.NEW.IRF.DATA$ EXTERNAL                                  ! 1.7 RC
7565: 0003:   END FUNCTION                                                            ! 1.7 RC
7566: 0003: 
7567: 0003:   FUNCTION SPLIT.NEW.IRF.DATA$ EXTERNAL                                   ! 1.7 RC
7568: 0003:   END FUNCTION                                                            ! 1.7 RC
7569: 0003:   
7570: 0003:   FUNCTION READ.IRF EXTERNAL
7571: 0003:    INTEGER*2 READ.IRF
7572: 0003:   END FUNCTION
7573: 0003: 
7574: 0003:   FUNCTION READ.IRF.ALT EXTERNAL
7575: 0003:    INTEGER*2 READ.IRF.ALT
7576: 0003:   END FUNCTION
7577: 0003: 
7578: 0003:   FUNCTION READ.IRF.LOCK EXTERNAL
7579: 0003:    INTEGER*2 READ.IRF.LOCK
7580: 0003:   END FUNCTION
7581: 0003: 
7582: 0003:   FUNCTION WRITE.IRF EXTERNAL
7583: 0003:    INTEGER*2 WRITE.IRF
7584: 0003:   END FUNCTION
7585: 0003: 
7586: 0003:   FUNCTION WRITE.IRF.UNLOCK EXTERNAL
7587: 0003:    INTEGER*2 WRITE.IRF.UNLOCK
7588: 0003:   END FUNCTION
7589: 0003: 
7590: 0003:   FUNCTION WRITE.IRF.HOLD EXTERNAL
7591: 0003:    INTEGER*2 WRITE.IRF.HOLD
7592: 0003:   END FUNCTION
7593: 0003: 
7594: 0003:   FUNCTION WRITE.IRF.HOLD.UNLOCK EXTERNAL
7595: 0003:    INTEGER*2 WRITE.IRF.HOLD.UNLOCK
7596: 0003:   END FUNCTION
7597: 0003: 
7598: 0003:   
7599: 0003:  %INCLUDE STKDCEXT.J86                    ! 1.8DA
7600: 0003: \******************************************************************************
7601: 0003: \******************************************************************************
7602: 0003: \***
7603: 0003: \***   $Workfile:   STKDCEXT.J86  $
7604: 0003: \***
7605: 0003: \***   $Revision:   1.0  $
7606: 0003: \***
7607: 0003: \******************************************************************************
7608: 0003: \******************************************************************************
7609: 0003: \***
7610: 0003: \***   $Log:   V:\archive\j86\stkdcext.j8v  $
7611: 0003: \***   
7612: 0003: \***      Rev 1.0   15 Jul 1997 14:20:40   DEV45PS
7613: 0003: \***    
7614: 0003: \***   
7615: 0003: \***      Rev 1.0   09 Jul 1997 11:05:00   DEV45PS
7616: 0003: \***   Stocktake System New Files
7617: 0003: \***   
7618: 0003: \******************************************************************************
7619: 0003: \******************************************************************************\*****************************************************************************
7620: 0003: \***
7621: 0003: \***           FUNCTION DEFINITIONS FOR THE STOCKTAKE DUMP CODE FILE
7622: 0003: \***
7623: 0003: \***           REFERENCE:   STKDCEXT.J86
7624: 0003: \***
7625: 0003: \***           VERSION A         Nik Sen         19th June 1997
7626: 0003: \***
7627: 0003: \***
7628: 0003: \*******************************************************************************
7629: 0003: \*******************************************************************************
7630: 0003: 
7631: 0003:    FUNCTION STKDC.SET EXTERNAL
7632: 0003:    END FUNCTION
7633: 0003:    
7634: 0003:    FUNCTION READ.STKDC EXTERNAL
7635: 0003:       INTEGER*2 READ.STKDC
7636: 0003:    END FUNCTION
7637: 0003:    
7638: 0003:    FUNCTION WRITE.STKDC EXTERNAL
7639: 0003:       INTEGER*2 WRITE.STKDC
7640: 0003:    END FUNCTION
7641: 0003:  
7642: 0003:  %INCLUDE IMSTCEXT.J86                    ! 1.9BG
7643: 0003: \***********************************************************************
7644: 0003: \***********************************************************************
7645: 0003: \***
7646: 0003: \***    DESCRIPTION: Item Movement & Stock File
7647: 0003: \***                 External File Function Definitions
7648: 0003: \***
7649: 0003: \***    FILE TYPE : Keyed
7650: 0003: \***
7651: 0003: \***********************************************************************
7652: 0003: \***
7653: 0003: \***    Version A.          Les Cook                     21st Aug 1992
7654: 0003: \***    Initial version.
7655: 0003: \***
7656: 0003: \***    VERSION 1.1         Julia Stones                 13th Jun 2005
7657: 0003: \***    Added new external functions for
7658: 0003: \***        MIMSTC - merged IMSTC
7659: 0003: \***        CIMSTC - Copy of IMSTC
7660: 0003: \***        BIMSTC - Backup of IMSTC
7661: 0003: \***
7662: 0003: \***    Version C.          Mark Walker                  23rd Jan 2014
7663: 0003: \***    F337 Centralised View of Stock
7664: 0003: \***    - Moved BIMST, CIMST and MIMST external function definitions
7665: 0003: \***      to separate modules.
7666: 0003: \***    - Minor formatting changes (uncommented).
7667: 0003: \***
7668: 0003: \***********************************************************************
7669: 0003: \***********************************************************************
7670: 0003: 
7671: 0003: FUNCTION IMSTC.SET EXTERNAL
7672: 0003: END FUNCTION
7673: 0003: 
7674: 0003: FUNCTION READ.IMSTC EXTERNAL
7675: 0003:     INTEGER*2 READ.IMSTC
7676: 0003: END FUNCTION
7677: 0003: 
7678: 0003: FUNCTION READ.IMSTC.LOCK EXTERNAL
7679: 0003:     INTEGER*2 READ.IMSTC.LOCK
7680: 0003: END FUNCTION
7681: 0003: 
7682: 0003: FUNCTION WRITE.IMSTC EXTERNAL
7683: 0003:    INTEGER*2 WRITE.IMSTC
7684: 0003: END FUNCTION
7685: 0003: 
7686: 0003: FUNCTION WRITE.IMSTC.UNLOCK.HOLD EXTERNAL
7687: 0003:     INTEGER*2 WRITE.IMSTC.UNLOCK.HOLD
7688: 0003: END FUNCTION
7689: 0003: 
7690: 0003: FUNCTION WRITE.IMSTC.UNLOCK EXTERNAL
7691: 0003:    INTEGER*2 WRITE.IMSTC.UNLOCK
7692: 0003: END FUNCTION
7693: 0003: 
7694: 0003: FUNCTION WRITE.IMSTC.HOLD EXTERNAL
7695: 0003:    INTEGER*2 WRITE.IMSTC.HOLD
7696: 0003: END FUNCTION
7697: 0003: 
7698: 0003:  %INCLUDE STOCKEXT.J86                    ! 1.9BG
7699: 0003: \***********************************************************************
7700: 0003: \***********************************************************************
7701: 0003: \***
7702: 0003: \***    DESCRIPTION: Stock File
7703: 0003: \***                 External File Function Definitions
7704: 0003: \***
7705: 0003: \***    FILE TYPE : Keyed
7706: 0003: \***
7707: 0003: \***********************************************************************
7708: 0003: \***
7709: 0003: \***    Version A.          Les Cook                     21st Aug 1992
7710: 0003: \***    Initial version.
7711: 0003: \***
7712: 0003: \***    Version B.          Robert Cowey                 21st Oct 1993
7713: 0003: \***    No changes to this file.
7714: 0003: \***
7715: 0003: \***    Version C.          Nik Sen                      22nd Dec 1994
7716: 0003: \***    WRITE.STOCK.HOLD added.
7717: 0003: \***
7718: 0003: \***    Version D.          Mark Walker                  23rd Jan 2014
7719: 0003: \***    F337 Centralised View of Stock
7720: 0003: \***    - Minor formatting changes (uncommented).
7721: 0003: \***
7722: 0003: \***********************************************************************
7723: 0003: \***********************************************************************
7724: 0003: 
7725: 0003: FUNCTION STOCK.SET EXTERNAL
7726: 0003: END FUNCTION
7727: 0003:    
7728: 0003: FUNCTION READ.STOCK EXTERNAL
7729: 0003:     INTEGER*2 READ.STOCK
7730: 0003: END FUNCTION
7731: 0003:    
7732: 0003: FUNCTION WRITE.STOCK EXTERNAL
7733: 0003:     INTEGER*2 WRITE.STOCK
7734: 0003: END FUNCTION
7735: 0003:    
7736: 0003: FUNCTION WRITE.STOCK.HOLD EXTERNAL
7737: 0003:     INTEGER*2 WRITE.STOCK.HOLD
7738: 0003: END FUNCTION
7739: 0003: 
7740: 0003: FUNCTION READ.STOCK.LOCK EXTERNAL
7741: 0003:     INTEGER*2 READ.STOCK.LOCK
7742: 0003: END FUNCTION
7743: 0003:    
7744: 0003: FUNCTION WRITE.STOCK.UNLOCK EXTERNAL
7745: 0003:     INTEGER*2 WRITE.STOCK.UNLOCK
7746: 0003: END FUNCTION
7747: 0003:    
7748: 0003: FUNCTION WRITE.STOCK.UNLOCK.HOLD EXTERNAL
7749: 0003:     INTEGER*2 WRITE.STOCK.UNLOCK.HOLD
7750: 0003: END FUNCTION
7751: 0003: 
7752: 0003:  %INCLUDE MINLSEXT.J86                    ! 1.9BG
7753: 0003: 
7754: 0003: \*****************************************************************************
7755: 0003: \*****************************************************************************
7756: 0003: \***
7757: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7758: 0003: \***
7759: 0003: \***                   FILE TYPE:  KEYED
7760: 0003: \***
7761: 0003: \***                   REFERENCE:  MINLSEXT.J86
7762: 0003: \***
7763: 0003: \***	             DESCRIPTION:  MINSITS RP - SCREEN COUNT INFORMATION
7764: 0003: \***
7765: 0003: \***
7766: 0003: \***
7767: 0003: \***      VERSION 1 : Julia Stones             8th January 1998   
7768: 0003: \***      
7769: 0003: \*****************************************************************************
7770: 0003: \*****************************************************************************
7771: 0003: 
7772: 0003: 
7773: 0003:   FUNCTION MINLS.SET EXTERNAL
7774: 0003:      INTEGER*2 MINLS.SET
7775: 0003:   END FUNCTION
7776: 0003: 
7777: 0003: 
7778: 0003:   FUNCTION READ.MINLS EXTERNAL
7779: 0003:     INTEGER*2 READ.MINLS
7780: 0003:   END FUNCTION
7781: 0003:   
7782: 0003: 
7783: 0003:   FUNCTION READ.MINLS.LOCKED EXTERNAL
7784: 0003:     INTEGER*2 READ.MINLS.LOCKED
7785: 0003:   END FUNCTION  
7786: 0003: 
7787: 0003: 
7788: 0003:   FUNCTION WRITE.HOLD.MINLS EXTERNAL
7789: 0003:     INTEGER*2 WRITE.HOLD.MINLS
7790: 0003:   END FUNCTION
7791: 0003: 
7792: 0003: 
7793: 0003:   FUNCTION WRITE.UNLOCK.MINLS EXTERNAL
7794: 0003:     INTEGER*2 WRITE.UNLOCK.MINLS
7795: 0003:   END FUNCTION
7796: 0003: 
7797: 0003: 
7798: 0003:   FUNCTION WRITE.HOLD.UNLOCK.MINLS EXTERNAL
7799: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.MINLS
7800: 0003:   END FUNCTION
7801: 0003:   
7802: 0003: 
7803: 0003:   FUNCTION WRITE.MINLS EXTERNAL
7804: 0003:     INTEGER*2 WRITE.MINLS
7805: 0003:   END FUNCTION
7806: 0003: 
7807: 0003:  %INCLUDE NEGSCEXT.J86                    ! 1.9BG
7808: 0003: 
7809: 0003: \*****************************************************************************
7810: 0003: \*****************************************************************************
7811: 0003: \***
7812: 0003: \***        %INCLUDE FOR FILE HANDLING FUNCTIONS EXTERNAL DEFINITIONS
7813: 0003: \***
7814: 0003: \***                   FILE TYPE:  KEYED
7815: 0003: \***
7816: 0003: \***                   REFERENCE:  NEGSCEXT.J86
7817: 0003: \***
7818: 0003: \***                 DESCRIPTION:  CURRENT NEGATIVE STOCK COUNT INFORMATION
7819: 0003: \***
7820: 0003: \***
7821: 0003: \***
7822: 0003: \***      VERSION 1 : Julia Stones             15th July 1999   
7823: 0003: \***      
7824: 0003: \***    REVISION 1.2.            ROBERT COWEY.                  09 SEP 2003.
7825: 0003: \***    Changes for RF trial.
7826: 0003: \***    Recompiled to prevent future automatic recompiles.
7827: 0003: \***    No changes to actual code.
7828: 0003: \***
7829: 0003: \*****************************************************************************
7830: 0003: \*****************************************************************************
7831: 0003: 
7832: 0003: 
7833: 0003:   FUNCTION NEGSC.SET EXTERNAL
7834: 0003:      INTEGER*2 NEGSC.SET
7835: 0003:   END FUNCTION
7836: 0003: 
7837: 0003: 
7838: 0003:   FUNCTION READ.NEGSC EXTERNAL
7839: 0003:     INTEGER*2 READ.NEGSC
7840: 0003:   END FUNCTION
7841: 0003:   
7842: 0003: 
7843: 0003:   FUNCTION READ.NEGSC.LOCKED EXTERNAL
7844: 0003:     INTEGER*2 READ.NEGSC.LOCKED
7845: 0003:   END FUNCTION  
7846: 0003: 
7847: 0003: 
7848: 0003:   FUNCTION WRITE.HOLD.NEGSC EXTERNAL
7849: 0003:     INTEGER*2 WRITE.HOLD.NEGSC
7850: 0003:   END FUNCTION
7851: 0003: 
7852: 0003: 
7853: 0003:   FUNCTION WRITE.UNLOCK.NEGSC EXTERNAL
7854: 0003:     INTEGER*2 WRITE.UNLOCK.NEGSC
7855: 0003:   END FUNCTION
7856: 0003: 
7857: 0003: 
7858: 0003:   FUNCTION WRITE.HOLD.UNLOCK.NEGSC EXTERNAL
7859: 0003:     INTEGER*2 WRITE.HOLD.UNLOCK.NEGSC
7860: 0003:   END FUNCTION
7861: 0003:   
7862: 0003: 
7863: 0003:   FUNCTION WRITE.NEGSC EXTERNAL
7864: 0003:     INTEGER*2 WRITE.NEGSC
7865: 0003:   END FUNCTION
7866: 0003: 
7867: 0003:  %INCLUDE SSPSCEXT.J86                    ! 2.0JAS
7868: 0003: \*****************************************************************************
7869: 0003: \*****************************************************************************
7870: 0003: \***
7871: 0003: \***         FUNCTION DEFINITIONS FOR SSPSCTRL
7872: 0003: \***
7873: 0003: \***                    REFERENCE : SSPSCexa.J86
7874: 0003: \***
7875: 0003: \***    Version A           Julia Stones         23.10.2003
7876: 0003: \***
7877: 0003: \*******************************************************************************
7878: 0003: \*******************************************************************************
7879: 0003: 
7880: 0003:   FUNCTION SSPSCTRL.SET EXTERNAL
7881: 0003:    INTEGER*2 SSPSCTRL.SET
7882: 0003:   END FUNCTION
7883: 0003: 
7884: 0003:   FUNCTION READ.SSPSCTRL EXTERNAL
7885: 0003:    INTEGER*2 READ.SSPSCTRL
7886: 0003:   END FUNCTION
7887: 0003: 
7888: 0003:   FUNCTION READ.SSPSCTRL.LOCKED EXTERNAL
7889: 0003:    INTEGER*2 READ.SSPSCTRL.LOCKED
7890: 0003:   END FUNCTION
7891: 0003: 
7892: 0003:   FUNCTION WRITE.SSPSCTRL EXTERNAL
7893: 0003:    INTEGER*2 WRITE.SSPSCTRL
7894: 0003:   END FUNCTION
7895: 0003: 
7896: 0003:   FUNCTION WRITE.SSPSCTRL.UNLOCK EXTERNAL
7897: 0003:    INTEGER*2 WRITE.SSPSCTRL.UNLOCK
7898: 0003:   END FUNCTION
7899: 0003: 
7900: 0003:  %INCLUDE BTCSEXT.J86                     ! 2.0JAS
7901: 0003: \*****************************************************************************
7902: 0003: \*****************************************************************************
7903: 0003: \***
7904: 0003: \***         FUNCTION DEFINITIONS FOR BTCS FILE
7905: 0003: \***
7906: 0003: \***         REFERENCE    : BTCSEXT
7907: 0003: \***
7908: 0003: \***         VERSION A    : JULIA STONES 23/10/03
7909: 0003: \***
7910: 0003: \*****************************************************************************
7911: 0003: \*****************************************************************************
7912: 0003: 
7913: 0003:     FUNCTION BTCS.SET EXTERNAL
7914: 0003:     END FUNCTION
7915: 0003: 
7916: 0003:     FUNCTION READ.BTCS EXTERNAL
7917: 0003:     INTEGER*1 READ.BTCS
7918: 0003:     END FUNCTION
7919: 0003: 
7920: 0003:     FUNCTION READ.BTCS.LOCK EXTERNAL
7921: 0003:     INTEGER*1 READ.BTCS.LOCK
7922: 0003:     END FUNCTION
7923: 0003: 
7924: 0003:     FUNCTION WRITE.BTCS EXTERNAL
7925: 0003:     INTEGER*1 WRITE.BTCS
7926: 0003:     END FUNCTION
7927: 0003: 
7928: 0003:     FUNCTION WRITE.BTCS.UNLOCK EXTERNAL
7929: 0003:     INTEGER*1 WRITE.BTCS.UNLOCK
7930: 0003:     END FUNCTION
7931: 0003: 
7932: 0003:     FUNCTION WRITE.BTCS.UNLOCK.HOLD EXTERNAL
7933: 0003:     INTEGER*1 WRITE.BTCS.UNLOCK.HOLD
7934: 0003:     END FUNCTION
7935: 0003: 
7936: 0003:  %INCLUDE PRINTEXT.J86                    ! 2.0JAS
7937: 0003: 
7938: 0003: REM \
7939: 0003: \*******************************************************************************
7940: 0003: \*******************************************************************************
7941: 0003: \***
7942: 0003: \***    %INCLUDE FOR PRINT FILE EXTERNAL FUNCTIONS
7943: 0003: \***
7944: 0003: \***        REFERENCE   :   PRINTEX (J86)
7945: 0003: \***
7946: 0003: \***        FILE TYPE   :   Printer / Labeller
7947: 0003: \***
7948: 0003: \***    VERSION A.              ANDREW WEDGEWORTH                   09 JUL 1992.
7949: 0003: \***    Original version created from PRINTEXG.
7950: 0003: \***
7951: 0003: \***    VERSION B.              UNKNOWN.                            ?? ??? 1992.
7952: 0003: \***    Changes unknown.
7953: 0003: \***
7954: 0003: \***    VERSION C.              ROBERT COWEY.                       18 NOV 1992.
7955: 0003: \***    Defined function variables for use as return codes.
7956: 0003: \***
7957: 0003: \***    Version C               Andrew Wedgeworth                 24th May 1992
7958: 0003: \***    Condensed print function added.
7959: 0003: \***
7960: 0003: \***    Version D               Stuart WIlliam McConnachie       31st July 2000.
7961: 0003: \***    Added function for PCL printing to LaserJet.
7962: 0003: \***
7963: 0003: \***    Version E               Charles Skadorwa                   4th Apr 2008.
7964: 0003: \***    Added parameter to WRITE.CONDENSED.PRINT function to
7965: 0003: \***    enable Alliance Pharmacy Brother Laser printers to print
7966: 0003: \***    in condensed mode.
7967: 0003: \***
7968: 0003: \***    Version F           Charles Skadorwa                       2nd Mar 2016.
7969: 0003: \***    It was found that certain reports would not print when stores
7970: 0003: \***    were converted to LAN attached printing.
7971: 0003: \***
7972: 0003: \***    Added new function: WRITE.PRINT.PLUS.LF based on WRITE.PRINT.
7973: 0003: \***    This adds a Line-Feed characters to every print line.
7974: 0003: \***
7975: 0003: \*******************************************************************************
7976: 0003: \*******************************************************************************
7977: 0003: 
7978: 0003: 
7979: 0003:     FUNCTION PRINT.SET EXTERNAL
7980: 0003:         INTEGER*2 PRINT.SET
7981: 0003:     END FUNCTION
7982: 0003: 
7983: 0003: 
7984: 0003:     FUNCTION WRITE.PRINT EXTERNAL
7985: 0003:        INTEGER*2 WRITE.PRINT
7986: 0003:     END FUNCTION
7987: 0003: 
7988: 0003: 
7989: 0003:     FUNCTION WRITE.PRINT.PLUS.LF EXTERNAL                               !FCS
7990: 0003:        INTEGER*2 WRITE.PRINT.PLUS.LF                                    !FCS
7991: 0003:     END FUNCTION                                                        !FCS
7992: 0003: 
7993: 0003: 
7994: 0003:     FUNCTION WRITE.CONDENSED.PRINT (AP.STORE) EXTERNAL                 ! ECSk
7995: 0003:        INTEGER*2 WRITE.CONDENSED.PRINT
7996: 0003:     END FUNCTION
7997: 0003: 
7998: 0003: 
7999: 0003:     FUNCTION WRITE.PCL.PRINT EXTERNAL                                  ! DSWM
8000: 0003:        INTEGER*2 WRITE.PCL.PRINT                                       ! DSWM
8001: 0003:     END FUNCTION                                                       ! DSWM
8002: 0003: 
8003: 0003: 
8004: 0003:     FUNCTION WRITE.LABEL EXTERNAL
8005: 0003:         INTEGER*2 WRITE.LABEL
8006: 0003:     END FUNCTION
8007: 0003: 
8008: 0003:  %INCLUDE SOPTSEXT.J86                    ! 2.1JAS
8009: 0003: \*******************************************************************************
8010: 0003: \***                                                                         ***
8011: 0003: \***      EXTERNAL FUNCTION DEFINITIONS FOR THE STORE OPTIONS FILE           ***
8012: 0003: \***                                                                         ***
8013: 0003: \***                     REFERENCE : SOPTSEXT.J86                            ***
8014: 0003: \***                                                                         ***
8015: 0003: \***      Version A      Stuart William McConnachie      19th June 1995      ***
8016: 0003: \***                                                                         ***
8017: 0003: \*******************************************************************************
8018: 0003: 
8019: 0003:       FUNCTION SOPTS.SET EXTERNAL
8020: 0003:       END FUNCTION
8021: 0003:       
8022: 0003:       FUNCTION READ.SOPTS EXTERNAL
8023: 0003:          INTEGER*2 READ.SOPTS
8024: 0003:       END FUNCTION
8025: 0003: 
8026: 0003:       FUNCTION WRITE.SOPTS EXTERNAL
8027: 0003:          INTEGER*2 WRITE.SOPTS
8028: 0003:       END FUNCTION
8029: 0003: 
8030: 0003:  %INCLUDE LOCALEXT.J86                    ! 2.1JAS
8031: 0003: \***********************************************************************
8032: 0003: \***********************************************************************
8033: 0003: \***
8034: 0003: \***    DESCRIPTION: Local Price File
8035: 0003: \***                 External File Function Definitions
8036: 0003: \***
8037: 0003: \***    FILE TYPE : Keyed
8038: 0003: \***
8039: 0003: \***********************************************************************
8040: 0003: \***
8041: 0003: \***    Version A.              Paul Flanagan            1st Jul 1993
8042: 0003: \***    Initial version.
8043: 0003: \***
8044: 0003: \***    Version B.              Clive Norris            30th Nov 1993
8045: 0003: \***    Renamed to keep the versions in line.
8046: 0003: \***
8047: 0003: \***    Version C.              Mark Walker             29th Jun 2015
8048: 0003: \***    F392 Retail Stock 5
8049: 0003: \***    Added function WRITE.LOCAL.UNLOCK.HOLD
8050: 0003: \***
8051: 0003: \***********************************************************************
8052: 0003: \***********************************************************************
8053: 0003: 
8054: 0003: FUNCTION LOCAL.SET EXTERNAL
8055: 0003: END FUNCTION
8056: 0003: 
8057: 0003: FUNCTION READ.LOCAL EXTERNAL
8058: 0003:     INTEGER*2 READ.LOCAL
8059: 0003: END FUNCTION
8060: 0003: 
8061: 0003: FUNCTION READ.LOCAL.LOCK EXTERNAL
8062: 0003:     INTEGER*2 READ.LOCAL.LOCK
8063: 0003: END FUNCTION
8064: 0003: 
8065: 0003: FUNCTION WRITE.LOCAL EXTERNAL
8066: 0003:     INTEGER*2 WRITE.LOCAL
8067: 0003: END FUNCTION
8068: 0003: 
8069: 0003: FUNCTION WRITE.LOCAL.UNLOCK EXTERNAL
8070: 0003:     INTEGER*2 WRITE.LOCAL.UNLOCK
8071: 0003: END FUNCTION
8072: 0003: 
8073: 0003: FUNCTION WRITE.LOCAL.UNLOCK.HOLD EXTERNAL                                   !CMW
8074: 0003:     INTEGER*2 WRITE.LOCAL.UNLOCK.HOLD                                       !CMW
8075: 0003: END FUNCTION                                                                !CMW
8076: 0003: 
8077: 0003:  %INCLUDE CCREJEXT.J86                    ! 2.2JAS
8078: 0003: \*******************************************************************************
8079: 0003: \*******************************************************************************
8080: 0003: \***
8081: 0003: \*** RETURNS / AUTOMATIC CREDIT CLAIMING FILE EXTERNAL FILE PUBLIC DEFINITIONS
8082: 0003: \***
8083: 0003: \***                    REFERENCE    : CCREJEXT.BAS
8084: 0003: \***
8085: 0003: \***    Version A.         Julia Stones              12th March 2004
8086: 0003: \***
8087: 0003: \*******************************************************************************
8088: 0003: \*******************************************************************************
8089: 0003: 
8090: 0003: 
8091: 0003:   FUNCTION CCREJ.SET EXTERNAL
8092: 0003:       INTEGER*2 CCREJ.SET
8093: 0003:   END FUNCTION
8094: 0003: 
8095: 0003:   FUNCTION CCREJC.SET EXTERNAL
8096: 0003:       INTEGER*2 CCREJC.SET
8097: 0003:   END FUNCTION
8098: 0003: 
8099: 0003:   FUNCTION CCREJP.SET EXTERNAL
8100: 0003:       INTEGER*2 CCREJP.SET
8101: 0003:   END FUNCTION
8102: 0003: 
8103: 0003:   FUNCTION READ.CCREJ EXTERNAL
8104: 0003:       INTEGER*2 READ.CCREJ
8105: 0003:   END FUNCTION
8106: 0003: 
8107: 0003:   FUNCTION READ.CCREJC EXTERNAL
8108: 0003:       INTEGER*2 READ.CCREJC
8109: 0003:   END FUNCTION
8110: 0003: 
8111: 0003:   FUNCTION READ.CCREJP EXTERNAL
8112: 0003:       INTEGER*2 READ.CCREJP
8113: 0003:   END FUNCTION
8114: 0003: 
8115: 0003:   FUNCTION WRITE.CCREJ EXTERNAL
8116: 0003:       INTEGER*2 WRITE.CCREJ
8117: 0003:   END FUNCTION
8118: 0003: 
8119: 0003:   FUNCTION WRITE.CCREJC EXTERNAL
8120: 0003:       INTEGER*2 WRITE.CCREJC
8121: 0003:   END FUNCTION
8122: 0003: 
8123: 0003:   FUNCTION WRITE.HOLD.CCREJ EXTERNAL
8124: 0003:       INTEGER*2 WRITE.HOLD.CCREJ
8125: 0003:   END FUNCTION
8126: 0003: 
8127: 0003:   FUNCTION WRITE.HOLD.CCREJC EXTERNAL
8128: 0003:       INTEGER*2 WRITE.HOLD.CCREJC
8129: 0003:   END FUNCTION
8130: 0003: 
8131: 0003:  %INCLUDE RBEXT.J86                       ! 2.6BG
8132: 0003: \/******************************************************************/
8133: 0003: \/*                                                                */
8134: 0003: \/* Recalls Buffer FILE EXTERNAL FUNCTION DEFNS                    */
8135: 0003: \/*                                                                */
8136: 0003: \/* REFERENCE   : RBEXT.J86                                        */
8137: 0003: \/*                                                                */
8138: 0003: \/* VERSION A.          Brian Greenield         11th May 2007      */
8139: 0003: \/*                                                                */
8140: 0003: \/******************************************************************/
8141: 0003: 
8142: 0003:    FUNCTION RB.SET EXTERNAL
8143: 0003:       INTEGER*1 RB.SET
8144: 0003:    END FUNCTION
8145: 0003: 
8146: 0003:    FUNCTION READ.RB EXTERNAL
8147: 0003:       INTEGER*2 READ.RB
8148: 0003:    END FUNCTION
8149: 0003: 
8150: 0003:    FUNCTION WRITE.RB EXTERNAL
8151: 0003:       INTEGER*2 WRITE.RB
8152: 0003:    END FUNCTION
8153: 0003: 
8154: 0003: \/******************************************************************/
8155: 0003:  %INCLUDE REWKFEXT.J86                    ! 2.6BG
8156: 0003: \/******************************************************************/
8157: 0003: \/*                                                                */
8158: 0003: \/* Recalls Work FILE EXTERNAL FUNCTION DEFNS                      */
8159: 0003: \/*                                                                */
8160: 0003: \/* REFERENCE   : REWKFEXT.J86                                     */
8161: 0003: \/*                                                                */
8162: 0003: \/* VERSION A.          Brian Greenield         11th May 2007      */
8163: 0003: \/*                                                                */
8164: 0003: \/******************************************************************/
8165: 0003: 
8166: 0003:    FUNCTION REWKF.SET EXTERNAL
8167: 0003:       INTEGER*1 REWKF.SET
8168: 0003:    END FUNCTION
8169: 0003: 
8170: 0003:    FUNCTION READ.REWKF EXTERNAL
8171: 0003:       INTEGER*2 READ.REWKF
8172: 0003:    END FUNCTION
8173: 0003: 
8174: 0003:    FUNCTION WRITE.REWKF EXTERNAL
8175: 0003:       INTEGER*2 WRITE.REWKF
8176: 0003:    END FUNCTION
8177: 0003: 
8178: 0003: \/******************************************************************/
8179: 0003:  %INCLUDE RECALEXT.J86                    ! 2.6BG
8180: 0003: \******************************************************************************
8181: 0003: \******************************************************************************
8182: 0003: \***
8183: 0003: \***                 FUNCTION DEFINITIONS FOR RECALLS.BIN
8184: 0003: \***
8185: 0003: \***                        REFERENCE: RECALFEXT.J86
8186: 0003: \***
8187: 0003: \***    VERSION A               BRIAN GREENFIELD                14th May 2007
8188: 0003: \***    Initial Version
8189: 0003: \***
8190: 0003: \***    Version B               CHARLES SKADORWA                26th June 2007
8191: 0003: \***    Added DELETE.RECALLS function.
8192: 0003: \***
8193: 0003: \*******************************************************************************
8194: 0003: \*******************************************************************************
8195: 0003: 
8196: 0003:    FUNCTION RECALLS.SET EXTERNAL
8197: 0003:       INTEGER*1 RECALLS.SET
8198: 0003:    END FUNCTION
8199: 0003:    
8200: 0003:    FUNCTION WRITE.RECALLS EXTERNAL
8201: 0003:       INTEGER*1 WRITE.RECALLS
8202: 0003:    END FUNCTION
8203: 0003:    
8204: 0003:    FUNCTION READ.RECALLS EXTERNAL
8205: 0003:       INTEGER*1 READ.RECALLS
8206: 0003:    END FUNCTION
8207: 0003:    
8208: 0003:   FUNCTION DELETE.RECALLS (KEY$) EXTERNAL
8209: 0003:       INTEGER*1 DELETE.RECALLS
8210: 0003:    END FUNCTION
8211: 0003:  %INCLUDE DELVIEXT.J86                    ! 2.7SH
8212: 0003: \/******************************************************************/
8213: 0003: \/*                                                                */
8214: 0003: \/* DELVINDX FILE EXTERNAL FUNCTION DEFNS                          */
8215: 0003: \/*                                                                */
8216: 0003: \/* REFERENCE   : DELVIEXT.J86                                     */
8217: 0003: \/*                                                                */
8218: 0003: \/* VERSION A.          Stuart Highley              14 July 2008   */
8219: 0003: \/*                                                                */
8220: 0003: \/******************************************************************/
8221: 0003: 
8222: 0003:    FUNCTION DELVINDX.SET EXTERNAL
8223: 0003:       INTEGER*1 DELVINDX.SET
8224: 0003:    END FUNCTION
8225: 0003: 
8226: 0003:    FUNCTION READ.DELVINDX EXTERNAL
8227: 0003:       INTEGER*2 READ.DELVINDX
8228: 0003:    END FUNCTION
8229: 0003: 
8230: 0003:    FUNCTION WRITE.DELVINDX EXTERNAL
8231: 0003:       INTEGER*2 WRITE.DELVINDX
8232: 0003:    END FUNCTION
8233: 0003: 
8234: 0003: \/******************************************************************/
8235: 0003:  %INCLUDE UODOTEXT.J86                    ! 2.7SH
8236: 0003: \/******************************************************************/
8237: 0003: \/*                                                                */
8238: 0003: \/* UOD Outers FILE EXTERNAL FUNCTION DEFNS                        */
8239: 0003: \/*                                                                */
8240: 0003: \/* REFERENCE   : UODOTEXT.J86                                     */
8241: 0003: \/*                                                                */
8242: 0003: \/* VERSION A.          Stuart Highley              14 July 2008   */
8243: 0003: \/*                                                                
8244: 0003: \/* REVISION 1.8.            ROBERT COWEY.            14 JAN 2009.
8245: 0003: \/* Changes for 10A PosUOD fixes creating SSC04.286 Rv 1.3.
8246: 0003: \/* Defined new function UODOT.REC$.
8247: 0003: \/*
8248: 0003: \/******************************************************************/
8249: 0003: 
8250: 0003:     FUNCTION UODOT.KEY$ EXTERNAL
8251: 0003:         STRING    UODOT.KEY$
8252: 0003:         STRING    WORK$
8253: 0003:     END FUNCTION
8254: 0003: 
8255: 0003:     FUNCTION UODOT.SET EXTERNAL
8256: 0003:         INTEGER*1 UODOT.SET
8257: 0003:     END FUNCTION
8258: 0003: 
8259: 0003:     FUNCTION READ.UODOT EXTERNAL
8260: 0003:         STRING    CHILD.LIST$
8261: 0003:         INTEGER*1 UODOT.INDICAT1%
8262: 0003:         INTEGER*2 UODOT.STATUS%
8263: 0003:         INTEGER*2 READ.UODOT
8264: 0003:         INTEGER*2 I%
8265: 0003:     END FUNCTION
8266: 0003: 
8267: 0003: 
8268: 0003:     FUNCTION READ.UODOT.ON.DESPATCH EXTERNAL
8269: 0003:         STRING TEMP$
8270: 0003:         INTEGER*2 RC%
8271: 0003:         INTEGER*2 READ.UODOT.ON.DESPATCH
8272: 0003:     END FUNCTION
8273: 0003: 
8274: 0003:     FUNCTION READ.UODOT.LOCK EXTERNAL
8275: 0003:         INTEGER*1 UODOT.INDICAT1%
8276: 0003:         INTEGER*2 UODOT.STATUS%
8277: 0003:         INTEGER*2 READ.UODOT.LOCK
8278: 0003:         INTEGER*2 I%
8279: 0003:         STRING    CHILD.LIST$
8280: 0003:     END FUNCTION
8281: 0003: 
8282: 0003:     FUNCTION WRITE.UODOT EXTERNAL
8283: 0003:         INTEGER*1 UODOT.INDICAT1%
8284: 0003:         INTEGER*2 UODOT.STATUS%
8285: 0003:         INTEGER*2 WRITE.UODOT
8286: 0003:         INTEGER*2 I%
8287: 0003:         STRING    CHILD.LIST$
8288: 0003:     END FUNCTION
8289: 0003: 
8290: 0003:     FUNCTION WRITE.UODOT.UNLOCK EXTERNAL
8291: 0003:         INTEGER*1 UODOT.INDICAT1%
8292: 0003:         INTEGER*2 UODOT.STATUS%
8293: 0003:         INTEGER*2 WRITE.UODOT.UNLOCK
8294: 0003:         INTEGER*2 I%
8295: 0003:         STRING    CHILD.LIST$
8296: 0003:     END FUNCTION
8297: 0003: 
8298: 0003: \/******************************************************************/
8299: 0003: 
8300: 0003:     FUNCTION DELETE.UODOT EXTERNAL
8301: 0003:         INTEGER*2 DELETE.UODOT
8302: 0003:     END FUNCTION
8303: 0003: 
8304: 0003: \/******************************************************************/
8305: 0003: 
8306: 0003:     FUNCTION UODOT.REC$ EXTERNAL                                      ! 1.8 RC
8307: 0003:         STRING UODOT.REC$                                             ! 1.8 RC
8308: 0003:     END FUNCTION                                                      ! 1.8 RC
8309: 0003: 
8310: 0003: 
8311: 0003:  %INCLUDE AFEXT.J86                       ! 2.7SH
8312: 0003: 
8313: 0003: \REM
8314: 0003: \*******************************************************************************
8315: 0003: \*******************************************************************************
8316: 0003: \***
8317: 0003: \***    %INCLUDE FOR GSA AUTHORISATION FILE EXTERNAL FUNCTIONS
8318: 0003: \***
8319: 0003: \***        REFERENCE   :  AFEXT (J86)
8320: 0003: \***
8321: 0003: \***        FILE TYPE   :  Keyed
8322: 0003: \***
8323: 0003: \***    The GSA Authorisation File (EALAUTH.DAT) should not be confused with
8324: 0003: \***    the Operating System Authorisation File (ADXCSOUF.DAT).
8325: 0003: \***
8326: 0003: \***    VERSION A.              ROBERT COWEY.                       18 AUG 1992.
8327: 0003: \***    Original version created from AFEXTA.
8328: 0003: \***
8329: 0003: \***    VERSION B.              Steve Windsor                       29 Dec 1992.
8330: 0003: \***    Version incremented to keep in line with other included code           
8331: 0003: \***
8332: 0003: \***    VERSION C.              ROBERT COWEY.                       03 MAR 1994.
8333: 0003: \***    No changes to this file.
8334: 0003: \***
8335: 0003: \***    REVISION 1.6.                ROBERT COWEY.                15 JUN 2009.
8336: 0003: \***    Changes for A9C POS improvements project.
8337: 0003: \***    Used up last available three bytes of EALAUTH user data by redefining 
8338: 0003: \***    remaining AF.USER$ variable as AF.BIRTH.DATE$.
8339: 0003: \***    No changes to this file.
8340: 0003: \***
8341: 0003: \***    REVISION 1.7.                ROBERT COWEY.                22 JUN 2009.
8342: 0003: \***    Changes for A9C POS improvements project creating PSB99.286 Rv 1.8.
8343: 0003: \***    Defect 3247 - Redefined AF.BIRTH.DATE$ format within AFDEC.J86.
8344: 0003: \***    Description text change only - No code changes to this file.
8345: 0003: \***
8346: 0003: \*******************************************************************************
8347: 0003: \*******************************************************************************
8348: 0003: 
8349: 0003: 
8350: 0003: FUNCTION AF.SET EXTERNAL
8351: 0003:     INTEGER*2 AF.SET
8352: 0003: END FUNCTION
8353: 0003: 
8354: 0003: 
8355: 0003: FUNCTION READ.AF EXTERNAL
8356: 0003:     INTEGER*2 READ.AF
8357: 0003: END FUNCTION
8358: 0003: 
8359: 0003: 
8360: 0003: FUNCTION READ.AF.LOCKED EXTERNAL
8361: 0003:     INTEGER*2 READ.AF.LOCKED
8362: 0003: END FUNCTION
8363: 0003: 
8364: 0003:   
8365: 0003: FUNCTION READ.AF.ABREV EXTERNAL
8366: 0003:     INTEGER*2 READ.AF.ABREV
8367: 0003: END FUNCTION
8368: 0003: 
8369: 0003: 
8370: 0003: FUNCTION READ.AF.ABREV.LOCKED EXTERNAL
8371: 0003:     INTEGER*2 READ.AF.ABREV.LOCKED
8372: 0003: END FUNCTION
8373: 0003: 
8374: 0003:   
8375: 0003: FUNCTION WRITE.AF.UNLOCK EXTERNAL
8376: 0003:     INTEGER*2 WRITE.AF.UNLOCK
8377: 0003: END FUNCTION
8378: 0003: 
8379: 0003: 
8380: 0003: FUNCTION WRITE.AF.ABREV EXTERNAL
8381: 0003:     INTEGER*2 WRITE.AF.ABREV
8382: 0003: END FUNCTION
8383: 0003: 
8384: 0003: 
8385: 0003: FUNCTION WRITE.AF.ABREV.UNLOCK EXTERNAL
8386: 0003:     INTEGER*2 WRITE.AF.ABREV.UNLOCK
8387: 0003: END FUNCTION
8388: 0003: 
8389: 0003:  %INCLUDE UBEXT.J86                       ! 2.7SH
8390: 0003: \/******************************************************************/
8391: 0003: \/*                                                                */
8392: 0003: \/* UOD Bookin FILE EXTERNAL FUNCTION DEFNS                        */
8393: 0003: \/*                                                                */
8394: 0003: \/* REFERENCE   : UBEXT.J86                                        */
8395: 0003: \/*                                                                */
8396: 0003: \/* VERSION A.          Stuart Highley            14 August 2008   */
8397: 0003: \/*                                                                */
8398: 0003: \/******************************************************************/
8399: 0003: 
8400: 0003:    FUNCTION UB.SET EXTERNAL
8401: 0003:       INTEGER*1 UB.SET
8402: 0003:    END FUNCTION
8403: 0003: 
8404: 0003:    FUNCTION READ.UB EXTERNAL
8405: 0003:       INTEGER*2 READ.UB
8406: 0003:    END FUNCTION
8407: 0003: 
8408: 0003:    FUNCTION WRITE.UB EXTERNAL
8409: 0003:       INTEGER*2 WRITE.UB
8410: 0003:    END FUNCTION
8411: 0003: 
8412: 0003: \/******************************************************************/
8413: 0003:  
8414: 0003: \*****************************************************************************
8415: 0003: \*****************************************************************************
8416: 0003: \***                                                                       ***
8417: 0003: \*** I N T E R N A L   F U N C T I O N   D E C L A R A T I O N S           ***
8418: 0003: \***                                                                       ***
8419: 0003: \***   - FN.SECONDS                                                        ***
8420: 0003: \***   - FN.Z.PACK                                                         ***
8421: 0003: \***   - FN.VALIDATE.DATA                                                  ***
8422: 0003: \***   - FN.CONV.TO.INTEGER (SIGNED)                                       ***
8423: 0003: \***                                                                       ***
8424: 0003: \*****************************************************************************
8425: 0003: \*****************************************************************************
8426: 0003: 
8427: 0003: \******************************************************************************
8428: 0003: \***
8429: 0003: \***   Function : FN.SECONDS( TIME.VALUE$ )
8430: 0003: \***
8431: 0003: \***   Purpose  : Convert passed TIME in format HHMMSS to seconds
8432: 0003: \***
8433: 0003: \***   Output   : = 4 byte integer
8434: 0003: \***
8435: 0003: \******************************************************************************
8436: 0003: 
8437: 0003:    FUNCTION FN.SECONDS( TIME.VALUE$ )
8438: 002c: 
8439: 002c:       STRING                                                                  \
8440: 002c:          TIME.VALUE$
8441: 002c:       INTEGER*4                                                               \
8442: 002c:          FN.SECONDS
8443: 002c: 
8444: 002c:       FN.SECONDS = VAL(MID$(TIME.VALUE$,1,2)) * 3600 +                        \
8445: 00fe:                    VAL(MID$(TIME.VALUE$,3,2)) * 60 +                          \
8446: 00fe:                    VAL(MID$(TIME.VALUE$,5,2))
8447: 00fe: 
8448: 00fe:    END FUNCTION
8449: 011d: 
8450: 011d: \******************************************************************************
8451: 011d: \***
8452: 011d: \***   Function : FN.Z.PACK( NUM.STRING$, LENGTH% )
8453: 011d: \***
8454: 011d: \***   Purpose  : Zero pack (to the left) NUM.STRING$ out to LENGTH%
8455: 011d: \***
8456: 011d: \******************************************************************************
8457: 011d: 
8458: 011d:    FUNCTION FN.Z.PACK(NUM.STRING$, LENGTH%)
8459: 0146: 
8460: 0146:       STRING                                                                 \
8461: 0146:          FN.Z.PACK,                                                          \
8462: 0146:          NUM.STRING$
8463: 0146:       INTEGER*2                                                              \
8464: 0146:          LENGTH%
8465: 0146: 
8466: 0146:       FN.Z.PACK = RIGHT$(STRING$(LENGTH%,"0")+NUM.STRING$,LENGTH%)
8467: 018f: 
8468: 018f:    END FUNCTION
8469: 01ad: 
8470: 01ad: \******************************************************************************
8471: 01ad: \***
8472: 01ad: \***   Function : FN.VALIDATE.DATA( RECORD$, FORMAT% )
8473: 01ad: \***
8474: 01ad: \***   Purpose  : Test received record RECORD$ is in correct format for
8475: 01ad: \***              data format FORMAT%
8476: 01ad: \***
8477: 01ad: \***   Output   : = 0 if RECORD$ does not conform to data format FORMAT%
8478: 01ad: \***              = 1 if RECORD$ does conform to data format FORMAT%
8479: 01ad: \***
8480: 01ad: \******************************************************************************
8481: 01ad: 
8482: 01ad:    FUNCTION FN.VALIDATE.DATA(RECORD$, FORMAT%)
8483: 01d6: 
8484: 01d6:       STRING                                                                  \
8485: 01d6:          CHECK$,                                                              \
8486: 01d6:          DATA$,                                                               \
8487: 01d6:          RECORD$,                                                             \
8488: 01d6:          TEST$,                                                               \
8489: 01d6:          TYPE$,                                                               \
8490: 01d6:          VALID.FLAG$
8491: 01d6:       INTEGER*1                                                               \
8492: 01d6:          FORMAT%,                                                             \
8493: 01d6:          FN.VALIDATE.DATA
8494: 01d6:       INTEGER*2                                                               \
8495: 01d6:          BYTE.PTR%,                                                           \
8496: 01d6:          CHECK.PTR%,                                                          \
8497: 01d6:          REC.LENGTH%
8498: 01d6: 
8499: 01d6:       REC.LENGTH% = LEN(RECORD$)
8500: 01ee:       IF REC.LENGTH% < 1                                                      \
8501: 0223:       OR FORMAT% < 1 OR FORMAT% > REC.MAX% THEN BEGIN                         \
8502: 0223:          FN.VALIDATE.DATA = 0
8503: 022f:          EXIT FUNCTION
8504: 023a:       ENDIF
8505: 0242: 
8506: 0242:       CHECK$ = REC.CHECK$(FORMAT%)
8507: 026d:       CHECK.PTR% = 1
8508: 027b:       BYTE.PTR% = 1
8509: 0289:       VALID.FLAG$ = "Y"
8510: 029e: 
8511: 029e:       WHILE BYTE.PTR% <= REC.LENGTH%                                          \
8512: 02a9:         AND CHECK.PTR% < LEN(CHECK$)
8513: 02a9: 
8514: 02a9:          TYPE$ = MID$(CHECK$, CHECK.PTR%, 1)
8515: 02cd:          DATA$ = MID$(CHECK$, CHECK.PTR%+1, 1)
8516: 02f2:          CHECK.PTR% = CHECK.PTR% + 2
8517: 02ff: 
8518: 02ff:          IF TYPE$ = "B" THEN BEGIN
8519: 031a:             IF MID$(RECORD$, BYTE.PTR%, 1) <> DATA$ THEN BEGIN
8520: 0350:                VALID.FLAG$ = "N"
8521: 0365:             ENDIF
8522: 036d:             BYTE.PTR% = BYTE.PTR% + 1
8523: 0379:          ENDIF
8524: 0381: 
8525: 0381:          IF TYPE$ = "N" THEN BEGIN
8526: 039f:             WHILE BYTE.PTR% <= REC.LENGTH% AND DATA$ <> CHR$(0)
8527: 03aa:                TEST$ = MID$(RECORD$, BYTE.PTR%, 1)
8528: 03cc:                IF (TEST$ < "0" OR TEST$ > "9")                               \
8529: 0487:               AND TEST$ <> "-" AND TEST$ <> "+"                              \
8530: 0487:               AND TEST$ <> "." THEN VALID.FLAG$ = "N"
8531: 049c:                BYTE.PTR% = BYTE.PTR% + 1
8532: 04a8:                DATA$ = CHR$(ASC(DATA$) - 1)
8533: 04cd:             WEND
8534: 050d:             IF BYTE.PTR% > REC.LENGTH%                                       \
8535: 054a:            AND DATA$ <> CHR$(0) THEN VALID.FLAG$ = "N"
8536: 055f:          ENDIF
8537: 0567: 
8538: 0567:          IF TYPE$ = "A" THEN BYTE.PTR% = BYTE.PTR% + ASC(DATA$)
8539: 0593: 
8540: 0593:       WEND
8541: 05c8: 
8542: 05c8:       IF CHECK.PTR% <= LEN(CHECK$) THEN VALID.FLAG$ = "N"
8543: 05f1: 
8544: 05f1:       IF VALID.FLAG$ = "Y" THEN BEGIN
8545: 060c:          FN.VALIDATE.DATA = 1
8546: 0618:          LAST.ACTIVE.DATE$ = DATE$
8547: 0630:          LAST.ACTIVE% = FN.SECONDS(TIME$)
8548: 0658:       ENDIF ELSE BEGIN
8549: 0660:          FN.VALIDATE.DATA = 0
8550: 066c:       ENDIF
8551: 0674: 
8552: 0674:    END FUNCTION
8553: 0690: 
8554: 0690: \******************************************************************************
8555: 0690: \***
8556: 0690: \***   Function : FN.CONV.TO.INTEGER( NUM.STRING$ )
8557: 0690: \***
8558: 0690: \***   Purpose  : Convert passed string to a 1, 2 or 4 byte (dependant on
8559: 0690: \***              length of passed string) signed integer.
8560: 0690: \***
8561: 0690: \***   Output   : = 1, 2 or 4 byte integer
8562: 0690: \***
8563: 0690: \******************************************************************************
8564: 0690: 
8565: 0690:    FUNCTION FN.CONV.TO.INTEGER( NUM.STRING$ )
8566: 06b9: 
8567: 06b9:       INTEGER*4                                                              \
8568: 06b9:          BYTE%,                                                              \
8569: 06b9:          BYTE.POS%,                                                          \
8570: 06b9:          BYTES%,                                                             \
8571: 06b9:          SIGN.BIT%
8572: 06b9:       REAL                                                                   \
8573: 06b9:          FN.CONV.TO.INTEGER,                                                 \
8574: 06b9:          NUMBER
8575: 06b9:       STRING                                                                 \
8576: 06b9:          NUM.STRING$
8577: 06b9: 
8578: 06b9:       BYTES% = LEN(NUM.STRING$)
8579: 06de:       NUMBER = 0
8580: 06f9:       FOR BYTE.POS% = 1 TO BYTES%
8581: 0711:          BYTE% = ASC(MID$(NUM.STRING$, BYTE.POS%, 1))
8582: 0742:          IF BYTE.POS% = BYTES% THEN BEGIN
8583: 075d:             SIGN.BIT% = BYTE% AND 80h
8584: 0776:             BYTE% = BYTE% AND (SIGN.BIT% XOR 0FFh)
8585: 07a2:          ENDIF
8586: 07aa:          NUMBER = NUMBER + (100h ^ (BYTE.POS% - 1)) * BYTE%
8587: 0800:       NEXT BYTE.POS%
8588: 082d:       IF SIGN.BIT% <> 0 THEN NUMBER = NUMBER - (80h * (100h ^ (BYTES% - 1)))
8589: 0896: 
8590: 0896:       FN.CONV.TO.INTEGER = NUMBER
8591: 08ac: 
8592: 08ac:    END FUNCTION
8593: 08c5: 
8594: 08c5: \******************************************************************************
8595: 08c5: \***
8596: 08c5: \***   Function : FN.ZERO.PL( TEXT$,
8597: 08c5: \***                          LENGTH% )
8598: 08c5: \***
8599: 08c5: \***   Purpose  : Zero pack, to the left, the passed string TEXT$ to the
8600: 08c5: \***              specified length.
8601: 08c5: \***
8602: 08c5: \******************************************************************************
8603: 08c5: 
8604: 08c5:    FUNCTION FN.ZERO.PL(TEXT$,LENGTH%)
8605: 08ee: 
8606: 08ee:       STRING    FN.ZERO.PL, TEXT$
8607: 08ee:       INTEGER*2 LENGTH%
8608: 08ee: 
8609: 08ee:       FN.ZERO.PL = RIGHT$( STRING$( LENGTH%, "0" ) + TEXT$ , LENGTH% )
8610: 0937: 
8611: 0937:    END FUNCTION
8612: 0955: 
8613: 0955: \*****************************************************************************
8614: 0955: \*****************************************************************************
8615: 0955: \***                                                                       ***
8616: 0955: \*** E N D   OF   G L O B A L   D E F N S   F O R   P S S 3 7              ***
8617: 0955: \***                                                                       ***
8618: 0955: \*****************************************************************************
8619: 0955: \*****************************************************************************
8620: 0955: 
8621: 0955: \******************************************************************************
8622: 0955: \******************************************************************************
8623: 0955: \***                                                                        ***
8624: 0955: \***   S U B R O U T I N E   D E C L A R A T I O N                          ***
8625: 0955: \***                                                                        ***
8626: 0955: \******************************************************************************
8627: 0955: \******************************************************************************
8628: 0955: 
8629: 0955: SUB PSS3701 EXTERNAL
8630: 0955: END SUB
8631: 0955: 
8632: 0955: SUB PSS3702 EXTERNAL                                                    ! HDS
8633: 0955: END SUB                                                                 ! HDS
8634: 0955: 
8635: 0955: SUB PSS3703 EXTERNAL                                                    ! LLC
8636: 0955: END SUB                                                                 ! LLC
8637: 0955: 
8638: 0955: SUB PSS3704 EXTERNAL                                                    ! MMJK
8639: 0955: END SUB                                                                 ! MMJK
8640: 0955: 
8641: 0955: SUB PSS3705 EXTERNAL                                                    ! 2.1BG
8642: 0955: END SUB                                                                 ! 2.1BG
8643: 0955: 
8644: 0955: \******************************************************************************
8645: 0955: \******************************************************************************
8646: 0955: \***                                                                        ***
8647: 0955: \***   E X T E R N A L   F U N C T I O N   D E C L A R A T I O N S          ***
8648: 0955: \***                                                                        ***
8649: 0955: \******************************************************************************
8650: 0955: \******************************************************************************
8651: 0955: 
8652: 0955: %INCLUDE PSBF06E.J86                                                    ! ILC
8653: 0955: rem\
8654: 0955: \*******************************************************************************
8655: 0955: \*******************************************************************************
8656: 0955: \***
8657: 0955: \***
8658: 0955: \***         INCLUDE       : CALC.BAR.CODE.CHECK.DIGIT external definition
8659: 0955: \***
8660: 0955: \***         REFERENCE     : PSBF06E.J86
8661: 0955: \***
8662: 0955: \***         Version A     Bruce Scriver                  24th February 1986
8663: 0955: \***
8664: 0955: \***         Version B     Andrew Wedgeworth                  15th July 1992
8665: 0955: \***         Removal of redundant parameters, and inclusion of 
8666: 0955: \***         CALC.BAR.CODE.CHECK.DIGIT as a variable to hold the return code.
8667: 0955: \***
8668: 0955: \*******************************************************************************
8669: 0955: \*******************************************************************************
8670: 0955: 
8671: 0955:    FUNCTION CALC.BAR.CODE.CHECK.DIGIT (BAR.CODE.12$)                           \
8672: 0955:    EXTERNAL
8673: 0955:    ! 3 parameters removed from here                                    ! BAW
8674: 0955: 
8675: 0955:       STRING    BAR.CODE.12$
8676: 0955:    ! 3 variables removed from here                                     ! BAW
8677: 0955:    
8678: 0955:       INTEGER*2 CALC.BAR.CODE.CHECK.DIGIT                              ! BAW
8679: 0955:       
8680: 0955: 
8681: 0955:    END FUNCTION
8682: 0955: 
8683: 0955: %INCLUDE CHKBFEXT.J86                                                   ! ILC
8684: 0955: \*******************************************************************************
8685: 0955: \***                                                                         ***
8686: 0955: \***          EXTERNAL FUNCTION DEFINITIONS FOR THE SITEM FILE               ***
8687: 0955: \***                                                                         ***
8688: 0955: \***                     REFERENCE : CHKBFEXT.J86                            ***
8689: 0955: \***                                                                         ***
8690: 0955: \***          Version A     Andrew Wedgeworth    9th July 1992               ***
8691: 0955: \***                                                                         ***
8692: 0955: \*******************************************************************************
8693: 0955: 
8694: 0955:        FUNCTION CHKBF.SET EXTERNAL                                      
8695: 0955:        END FUNCTION                                                   
8696: 0955: 
8697: 0955: 
8698: 0955:        FUNCTION READ.CHKBF EXTERNAL                                  
8699: 0955:           INTEGER*2 READ.CHKBF                                       
8700: 0955:        END FUNCTION                                                   
8701: 0955:        
8702: 0955:        FUNCTION WRITE.CHKBF EXTERNAL
8703: 0955:           INTEGER*2 WRITE.CHKBF
8704: 0955:        END FUNCTION
8705: 0955: %INCLUDE GAPBFEXT.J86                                                  ! 1.3 !2.5CS !2.6BG
8706: 0955: \*******************************************************************************
8707: 0955: \***                                                                         ***
8708: 0955: \***          EXTERNAL FUNCTION DEFINITIONS FOR THE GAP BUFFER FILE          ***
8709: 0955: \***                                                                         ***
8710: 0955: \***                     REFERENCE : GAPBFEXT.J86                            ***
8711: 0955: \***                                                                         ***
8712: 0955: \***          Version A     Stuart Highley    3rd April 1996                 ***
8713: 0955: \***                                                                         ***
8714: 0955: \*******************************************************************************
8715: 0955: 
8716: 0955:        FUNCTION GAPBF.SET EXTERNAL                                      
8717: 0955:        END FUNCTION                                                   
8718: 0955: 
8719: 0955:        FUNCTION READ.GAPBF EXTERNAL                                  
8720: 0955:           INTEGER*2 READ.GAPBF                                       
8721: 0955:        END FUNCTION                                                   
8722: 0955:        
8723: 0955:        FUNCTION WRITE.GAPBF EXTERNAL
8724: 0955:           INTEGER*2 WRITE.GAPBF
8725: 0955:        END FUNCTION
8726: 0955: %INCLUDE PLLOLEXT.J86                                                   !2.5CS
8727: 0955: 
8728: 0955: \******************************************************************************
8729: 0955: \******************************************************************************
8730: 0955: \***
8731: 0955: \***           FUNCTION DEFINITIONS FOR THE RF PICKING LIST OF LISTS FILE
8732: 0955: \***
8733: 0955: \***           REFERENCE:   PLLOLEXT.J86
8734: 0955: \***
8735: 0955: \***           VERSION A         Julia Stones         11th August 2004
8736: 0955: \***
8737: 0955: \***           VERSION B         Neil Bennett            3rd June 2009
8738: 0955: \***           Added functions for READ.PLLOL.LOCK and WRITE.PLLOL.UNLOCK
8739: 0955: \***
8740: 0955: \*******************************************************************************
8741: 0955: \*******************************************************************************
8742: 0955: 
8743: 0955:    FUNCTION PLLOL.SET EXTERNAL
8744: 0955:    END FUNCTION
8745: 0955: 
8746: 0955:    FUNCTION READ.PLLOL EXTERNAL
8747: 0955:       INTEGER*2 READ.PLLOL
8748: 0955:    END FUNCTION
8749: 0955: 
8750: 0955:    FUNCTION READ.PLLOL.LOCK EXTERNAL                                   ! BNB
8751: 0955:       INTEGER*2 READ.PLLOL.LOCK                                        ! BNB
8752: 0955:    END FUNCTION                                                        ! BNB
8753: 0955: 
8754: 0955:    FUNCTION WRITE.PLLOL EXTERNAL
8755: 0955:       INTEGER*2 WRITE.PLLOL
8756: 0955:    END FUNCTION
8757: 0955: 
8758: 0955:    FUNCTION WRITE.PLLOL.UNLOCK EXTERNAL                                ! BNB
8759: 0955:       INTEGER*2 WRITE.PLLOL.UNLOCK                                     ! BNB
8760: 0955:    END FUNCTION                                                        ! BNB
8761: 0955: 
8762: 0955: %INCLUDE PLLDBEXT.J86                                                   !2.5CS
8763: 0955: 
8764: 0955: \******************************************************************************
8765: 0955: \******************************************************************************
8766: 0955: \***
8767: 0955: \***           FUNCTION DEFINITIONS FOR THE RF PICKING LIST ITEMS IN LISTS FILE
8768: 0955: \***
8769: 0955: \***           REFERENCE:   PLLDBEXT.J86
8770: 0955: \***
8771: 0955: \***           VERSION A         Julia Stones         11th August 2004
8772: 0955: \***
8773: 0955: \***           VERSION B         Charles Skadorwa     15th February 2005
8774: 0955: \***               Added WRITE.BRIEF.PLLDB for Shelf Monitor Project.
8775: 0955: \***
8776: 0955: \***           VERSION C         Neil Bennett              3rd June 2009
8777: 0955: \***               Added functions for lock/unlock/hold.
8778: 0955: \***
8779: 0955: \*******************************************************************************
8780: 0955: \*******************************************************************************
8781: 0955: 
8782: 0955: 
8783: 0955:    FUNCTION PLLDB.SET EXTERNAL
8784: 0955:    END FUNCTION
8785: 0955: 
8786: 0955:    FUNCTION READ.PLLDB EXTERNAL
8787: 0955:       INTEGER*2 READ.PLLDB
8788: 0955:    END FUNCTION
8789: 0955: 
8790: 0955:    FUNCTION READ.PLLDB.LOCK EXTERNAL             ! CNB
8791: 0955:       INTEGER*2 READ.PLLDB.LOCK                  ! CNB
8792: 0955:    END FUNCTION                                  ! CNB
8793: 0955: 
8794: 0955:    FUNCTION WRITE.PLLDB EXTERNAL
8795: 0955:       INTEGER*2 WRITE.PLLDB
8796: 0955:    END FUNCTION
8797: 0955: 
8798: 0955:    FUNCTION WRITE.PLLDB.UNLOCK EXTERNAL          ! CNB
8799: 0955:       INTEGER*2 WRITE.PLLDB.UNLOCK               ! CNB
8800: 0955:    END FUNCTION                                  ! CNB
8801: 0955: 
8802: 0955:    FUNCTION DELREC.PLLDB EXTERNAL
8803: 0955:       INTEGER*2 DELREC.PLLDB
8804: 0955:    END FUNCTION
8805: 0955: 
8806: 0955:    FUNCTION WRITE.BRIEF.PLLDB EXTERNAL           ! BCS
8807: 0955:       INTEGER*2 WRITE.BRIEF.PLLDB                ! BCS
8808: 0955:    END FUNCTION                                  ! BCS
8809: 0955: 
8810: 0955: \%INCLUDE CSRBFEXT.J86                                                  ! ILC !2.9NWB
8811: 0955: %INCLUDE IEFEXT.J86                                                     ! ILC
8812: 0955: \*****************************************************************************
8813: 0955: \*****************************************************************************
8814: 0955: \***
8815: 0955: \***         EXTERNAL FUNCTION DEFINITIONS FOR IEF
8816: 0955: \***
8817: 0955: \***         REFERENCE: IEFEXT.J86
8818: 0955: \***
8819: 0955: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
8820: 0955: \***    No changes to this file.
8821: 0955: \***
8822: 0955: \*******************************************************************************
8823: 0955: \*******************************************************************************
8824: 0955: 
8825: 0955:    FUNCTION IEF.SET EXTERNAL
8826: 0955:    END FUNCTION
8827: 0955:    
8828: 0955:    FUNCTION READ.IEF EXTERNAL
8829: 0955:       INTEGER*2 READ.IEF
8830: 0955:    END FUNCTION
8831: 0955:    
8832: 0955:    FUNCTION WRITE.IEF EXTERNAL
8833: 0955:       INTEGER*2 WRITE.IEF
8834: 0955:    END FUNCTION
8835: 0955:    
8836: 0955:    
8837: 0955: %INCLUDE PDTWFEXT.J86                                                   ! ILC
8838: 0955: \*****************************************************************************
8839: 0955: \*****************************************************************************
8840: 0955: \***
8841: 0955: \***       EXTERNAL FILE DEFINITIONS FOR PDTWF
8842: 0955: \***
8843: 0955: \***       REFERENCE: PDTWFEXT.J86
8844: 0955: \***
8845: 0955: \*****************************************************************************
8846: 0955: \*****************************************************************************
8847: 0955: 
8848: 0955:    FUNCTION PDTWF.SET EXTERNAL
8849: 0955:    END FUNCTION
8850: 0955:    
8851: 0955:    FUNCTION READ.PDTWF EXTERNAL
8852: 0955:       INTEGER*2 READ.PDTWF
8853: 0955:    END FUNCTION
8854: 0955:    
8855: 0955:    FUNCTION WRITE.PDTWF EXTERNAL
8856: 0955:       INTEGER*2 WRITE.PDTWF
8857: 0955:    END FUNCTION
8858: 0955:    
8859: 0955:    
8860: 0955: \%INCLUDE CIMFEXT.J86                                                   ! ILC !2.9NWB
8861: 0955: \%INCLUDE CITEMEXT.J86                                                  ! ILC !2.9NWB
8862: 0955: \%INCLUDE CSRWFEXT.J86                                                  ! ILC !2.9NWB
8863: 0955: %INCLUDE FPFEXT.J86                                                     ! ILC
8864: 0955: \*****************************************************************************
8865: 0955: \***
8866: 0955: \***                    FUNCTION DEFINITIONS FOR THE FPF
8867: 0955: \***
8868: 0955: \***                          REFERENCE: FPFEXT.J86
8869: 0955: \***
8870: 0955: \***             Version A         Les Cook        21st August 1992
8871: 0955: \***
8872: 0955: \***    VERSION B.              ROBERT COWEY.                       21 OCT 1993.
8873: 0955: \***    No changes to this file.
8874: 0955: \***
8875: 0955: \***    VERSION C.              CLIVE NORRIS.                       17 JAN 1994.
8876: 0955: \***    No changes to this file. Version updated to keep in line 
8877: 0955: \***    with changes in FPFFUNC.BAS.
8878: 0955: \***
8879: 0955: \*******************************************************************************
8880: 0955: \*******************************************************************************
8881: 0955: 
8882: 0955:    FUNCTION FPF.SET EXTERNAL
8883: 0955:    END FUNCTION
8884: 0955:    
8885: 0955:    FUNCTION WRITE.FPF EXTERNAL
8886: 0955:       INTEGER*1 WRITE.FPF
8887: 0955:    END FUNCTION
8888: 0955:    
8889: 0955:    FUNCTION READ.FPF EXTERNAL
8890: 0955:       INTEGER*1 READ.FPF
8891: 0955:    END FUNCTION
8892: 0955: %INCLUDE ONORDEXT.J86                                                   ! ILC
8893: 0955: \*****************************************************************************
8894: 0955: \*****************************************************************************
8895: 0955: \***
8896: 0955: \***        EXTERNAL FILE DEFINITIONS FOR ONORDER FILE
8897: 0955: \***
8898: 0955: \***        REFERENCE: ONORDEXT.J86
8899: 0955: \***
8900: 0955: \*****************************************************************************
8901: 0955: \*****************************************************************************
8902: 0955: 
8903: 0955:    FUNCTION ONORD.SET EXTERNAL
8904: 0955:    END FUNCTION
8905: 0955:    
8906: 0955:    FUNCTION READ.ONORDER EXTERNAL
8907: 0955:       INTEGER*2 READ.ONORDER
8908: 0955:    END FUNCTION
8909: 0955:    
8910: 0955:    FUNCTION WRITE.ONORDER EXTERNAL
8911: 0955:       INTEGER*2 WRITE.ONORDER
8912: 0955:    END FUNCTION
8913: 0955:    
8914: 0955:    FUNCTION WRITE.ONORDER.HOLD EXTERNAL
8915: 0955:       INTEGER*2 WRITE.ONORDER.HOLD
8916: 0955:    END FUNCTION
8917: 0955:    
8918: 0955:    
8919: 0955:     
8920: 0955: %INCLUDE DIROREXT.J86                                                   ! ILC
8921: 0955: \*****************************************************************************
8922: 0955: \***
8923: 0955: \***         FUNCTION DEFINITIONS FOR THE DIRORD FILE
8924: 0955: \***
8925: 0955: \***                 REFERENCE:   DIROREXT.J86
8926: 0955: \***
8927: 0955: \***      VERSION A         Les Cook     17th August 1992
8928: 0955: \***
8929: 0955: \***      VERSION B         Les Cook     27th April 1993
8930: 0955: \***      To fix WRITE.UNLOCK problem - not defined as EXTERNAL in Version A
8931: 0955: \***
8932: 0955: \*****************************************************************************
8933: 0955: 
8934: 0955:    FUNCTION DIRORD.SET EXTERNAL
8935: 0955:    END FUNCTION
8936: 0955:    
8937: 0955:    FUNCTION READ.DIRORD.LOCK EXTERNAL
8938: 0955:       INTEGER*2 READ.DIRORD.LOCK
8939: 0955:    END FUNCTION
8940: 0955:    
8941: 0955:    FUNCTION READ.DIRORD EXTERNAL
8942: 0955:       INTEGER*2 READ.DIRORD
8943: 0955:    END FUNCTION
8944: 0955:    
8945: 0955:    FUNCTION WRITE.DIRORD.UNLOCK EXTERNAL
8946: 0955:       INTEGER*2 WRITE.DIRORD.UNLOCK
8947: 0955:    END FUNCTION
8948: 0955:    
8949: 0955:    FUNCTION WRITE.DIRORD EXTERNAL
8950: 0955:       INTEGER*2 WRITE.DIRORD
8951: 0955:    END FUNCTION
8952: 0955:    
8953: 0955:    
8954: 0955: %INCLUDE DIRSUEXT.J86                                                   ! ILC
8955: 0955: \*****************************************************************************
8956: 0955: \*****************************************************************************
8957: 0955: \***
8958: 0955: \***           EXTERNAL FUNCTION DEFINITIONS FOR DIRECT SUPPLIER FILE
8959: 0955: \***
8960: 0955: \***                         REFERENCE: DIRSUEXT.J86
8961: 0955: \***
8962: 0955: \***           Version A            Les Cook                8/9/92
8963: 0955: \***
8964: 0955: \***           Version B            Les Cook               29/3/93
8965: 0955: \***           To fix WRITE.UNLOCK problem - not defined as EXTERNAL in ver A
8966: 0955: \*** 
8967: 0955: \*****************************************************************************
8968: 0955: \*****************************************************************************
8969: 0955: 
8970: 0955:      FUNCTION DIRSUP.SET EXTERNAL
8971: 0955:      END FUNCTION
8972: 0955:      
8973: 0955:      FUNCTION READ.DIRSUP.LOCK EXTERNAL
8974: 0955:         INTEGER*2 READ.DIRSUP.LOCK
8975: 0955:      END FUNCTION
8976: 0955:      
8977: 0955:      FUNCTION READ.DIRSUP EXTERNAL
8978: 0955:         INTEGER*2 READ.DIRSUP
8979: 0955:      END FUNCTION
8980: 0955:      
8981: 0955:      FUNCTION WRITE.DIRSUP EXTERNAL
8982: 0955:         INTEGER*2 WRITE.DIRSUP
8983: 0955:      END FUNCTION
8984: 0955:      
8985: 0955:      FUNCTION WRITE.DIRSUP.UNLOCK EXTERNAL
8986: 0955:         INTEGER*2 WRITE.DIRSUP.UNLOCK
8987: 0955:      END FUNCTION
8988: 0955:      
8989: 0955:      
8990: 0955: %INCLUDE DIRWFEXT.J86                                                   ! ILC
8991: 0955: \*****************************************************************************
8992: 0955: \*****************************************************************************
8993: 0955: \***
8994: 0955: \***       EXTYERNAL FUNCTION DEFINTIONS FOR DIRWF - DIRECT WORK FILE
8995: 0955: \***
8996: 0955: \***       REFERENCE: DIRWFEXT.J86
8997: 0955: \***
8998: 0955: \*****************************************************************************
8999: 0955: \*****************************************************************************
9000: 0955: 
9001: 0955:    FUNCTION DIRWF.SET EXTERNAL
9002: 0955:    END FUNCTION
9003: 0955:    
9004: 0955:    FUNCTION READ.DIRWF EXTERNAL
9005: 0955:       INTEGER*2 READ.DIRWF
9006: 0955:    END FUNCTION
9007: 0955:    
9008: 0955:    FUNCTION WRITE.DIRWF EXTERNAL
9009: 0955:       INTEGER*2 WRITE.DIRWF
9010: 0955:    END FUNCTION
9011: 0955:    
9012: 0955: %INCLUDE LDTCFEXT.J86                                                   ! ILC
9013: 0955: \*****************************************************************************
9014: 0955: \*****************************************************************************
9015: 0955: \***
9016: 0955: \***      EXTERNAL FUNCTION DEFINITIONS FOR LDTCF
9017: 0955: \***
9018: 0955: \***      REFERENCE: LDTCFEXT.J86
9019: 0955: \***
9020: 0955: \***      Version A             Les Cook         12/10/92
9021: 0955: \***
9022: 0955: \*****************************************************************************
9023: 0955: \*****************************************************************************
9024: 0955: 
9025: 0955:     FUNCTION LDTCF.SET EXTERNAL
9026: 0955:     END FUNCTION
9027: 0955:     
9028: 0955:     FUNCTION READ.LDTCF EXTERNAL
9029: 0955:        INTEGER*2 READ.LDTCF
9030: 0955:     END FUNCTION
9031: 0955:     
9032: 0955:     FUNCTION WRITE.LDTCF EXTERNAL
9033: 0955:        INTEGER*2 WRITE.LDTCF
9034: 0955:     END FUNCTION
9035: 0955:     
9036: 0955:     
9037: 0955: %INCLUDE DRSMQEXT.J86                                                   ! ILC
9038: 0955: \*****************************************************************************
9039: 0955: \*****************************************************************************
9040: 0955: \***
9041: 0955: \***        EXTERNAL FUNCTION DEFINITIONS FOR DRSMQ
9042: 0955: \***
9043: 0955: \***        REFERENCE:  DRSMQEXT.J86
9044: 0955: \***
9045: 0955: \***        Version A         Les Cook         12/10/1992
9046: 0955: \***
9047: 0955: \*****************************************************************************
9048: 0955: \*****************************************************************************
9049: 0955: 
9050: 0955:    FUNCTION DRSMQ.SET EXTERNAL
9051: 0955:    END FUNCTION
9052: 0955:    
9053: 0955:    FUNCTION READ.DRSMQ EXTERNAL
9054: 0955:       INTEGER*2 READ.DRSMQ
9055: 0955:    END FUNCTION
9056: 0955:    
9057: 0955:    FUNCTION WRITE.DRSMQ EXTERNAL
9058: 0955:       INTEGER*2 WRITE.DRSMQ
9059: 0955:    END FUNCTION
9060: 0955:    
9061: 0955:    
9062: 0955: %INCLUDE SITEMEXT.J86                                                   ! ILC
9063: 0955: \*******************************************************************************
9064: 0955: \***                                                                         ***
9065: 0955: \***          EXTERNAL FUNCTION DEFINITIONS FOR THE SITEM FILE               ***
9066: 0955: \***                                                                         ***
9067: 0955: \***                     REFERENCE : SITEMEXT.J86                            ***
9068: 0955: \***                                                                         ***
9069: 0955: \***          Version A     Andrew Wedgeworth    9th July 1992               ***
9070: 0955: \***                                                                         ***
9071: 0955: \*******************************************************************************
9072: 0955: 
9073: 0955:        FUNCTION SITEM.SET EXTERNAL                                      
9074: 0955:        END FUNCTION                                                   
9075: 0955: 
9076: 0955: 
9077: 0955:        FUNCTION WRITE.SITEM EXTERNAL                                  
9078: 0955:           INTEGER*2 WRITE.SITEM                                       
9079: 0955:        END FUNCTION                                                   
9080: 0955: %INCLUDE IDSOFEXT.J86                                                   ! JLC
9081: 0955: \*****************************************************************************
9082: 0955: \*****************************************************************************
9083: 0955: \***
9084: 0955: \***      EXTERNAL FUNCTION DEFINITIONS FOR OUTSTANDING INITIAL DISPLAY 
9085: 0955: \***      QUANTITY FILE
9086: 0955: \***
9087: 0955: \***                      REFERENCE: IDSOFEXT.J86
9088: 0955: \***
9089: 0955: \***       Version A            Stephen Kelsey (CTG)               20/10/92
9090: 0955: \***
9091: 0955: \*****************************************************************************
9092: 0955: \*****************************************************************************
9093: 0955: 
9094: 0955:      FUNCTION IDSOF.SET EXTERNAL
9095: 0955:      END FUNCTION
9096: 0955:      
9097: 0955:      
9098: 0955:      FUNCTION READ.IDSOF EXTERNAL
9099: 0955:         INTEGER*2 READ.IDSOF
9100: 0955:      END FUNCTION	
9101: 0955: 
9102: 0955:   
9103: 0955:      FUNCTION READ.IDSOF.LOCK EXTERNAL
9104: 0955:         INTEGER*2 READ.IDSOF.LOCK
9105: 0955:      END FUNCTION
9106: 0955: 
9107: 0955: 
9108: 0955:      FUNCTION WRITE.IDSOF EXTERNAL
9109: 0955:         INTEGER*2 WRITE.IDSOF
9110: 0955:      END FUNCTION
9111: 0955: 
9112: 0955: 
9113: 0955:      FUNCTION WRITE.IDSOF.UNLOCK EXTERNAL
9114: 0955:         INTEGER*2 WRITE.IDSOF.UNLOCK
9115: 0955:      END FUNCTION
9116: 0955: 
9117: 0955: 
9118: 0955:      FUNCTION WRITE.IDSOF.HOLD EXTERNAL
9119: 0955:         INTEGER*2 WRITE.IDSOF.HOLD
9120: 0955:      END FUNCTION	
9121: 0955: 
9122: 0955: 
9123: 0955:      FUNCTION WRITE.IDSOF.HOLD.UNLOCK EXTERNAL
9124: 0955:         INTEGER*2 WRITE.IDSOF.HOLD.UNLOCK
9125: 0955:      END FUNCTION
9126: 0955: 
9127: 0955: 
9128: 0955: !%INCLUDE STOCKEXT.J86                                                  !1.8BG !2.1BG !2.5CS
9129: 0955: !%INCLUDE IMSTCEXT.J86                                                  !1.8BG !2.1BG !2.5CS
9130: 0955: !%INCLUDE LSSSTEXT.J86                                                  !1.8BG !2.7CS
9131: 0955: %INCLUDE TSFEXT.J86                                                     !2.3JAS
9132: 0955: \*****************************************************************************
9133: 0955: \*****************************************************************************
9134: 0955: \***
9135: 0955: \***         FUNCTION DEFINITIONS FOR TERMINAL STATUS
9136: 0955: \***
9137: 0955: \***                      REFERENCE    : TSFEXTA
9138: 0955: \***
9139: 0955: \***           VERSION A : STEVEN GOULDING  14.10.92
9140: 0955: \***
9141: 0955: \***           VERSION B : STEVE WINDSOR    15.09.93
9142: 0955: \***           EXTERNAL label missing from READ.TSF.SECTOR function.
9143: 0955: \***
9144: 0955: \*****************************************************************************
9145: 0955: \****************************************************************************
9146: 0955: 
9147: 0955:    FUNCTION TSF.SET EXTERNAL
9148: 0955:    END FUNCTION
9149: 0955: 
9150: 0955: FUNCTION READ.TSF EXTERNAL
9151: 0955:    INTEGER*1 READ.TSF
9152: 0955:   END FUNCTION
9153: 0955: 
9154: 0955:   FUNCTION READ.TSF.LOCK EXTERNAL
9155: 0955:    INTEGER*1 READ.TSF.LOCK
9156: 0955:   END FUNCTION
9157: 0955: 
9158: 0955:   FUNCTION WRITE.TSF EXTERNAL
9159: 0955:    INTEGER*1 WRITE.TSF
9160: 0955:   END FUNCTION
9161: 0955: 
9162: 0955:   FUNCTION WRITE.TSF.UNLOCK EXTERNAL
9163: 0955:    INTEGER*1 WRITE.TSF.UNLOCK
9164: 0955:   END FUNCTION
9165: 0955: 
9166: 0955: FUNCTION WRITE.TSF.UNLOCK.HOLD EXTERNAL
9167: 0955:    INTEGER*1 WRITE.TSF.UNLOCK.HOLD         
9168: 0955:   END FUNCTION
9169: 0955: 
9170: 0955: FUNCTION READ.TSF.SECTOR EXTERNAL					!BSJW
9171: 0955:    INTEGER*1 READ.TSF.SECTOR               
9172: 0955:   END FUNCTION
9173: 0955: 
9174: 0955: %INCLUDE CBEXT.J86                                                      !2.9NWB
9175: 0955: \/******************************************************************/
9176: 0955: \/*                                                                */
9177: 0955: \/* Carton Buffer FILE EXTERNAL FUNCTION DEFNS                     */
9178: 0955: \/*                                                                */
9179: 0955: \/* REFERENCE   : CBEXT.J86                                        */
9180: 0955: \/*                                                                */
9181: 0955: \/* VERSION A.          Neil Bennett.           27 DECEMBER 2006   */
9182: 0955: \/*                                                                */
9183: 0955: \/******************************************************************/
9184: 0955: 
9185: 0955:    FUNCTION CB.SET EXTERNAL
9186: 0955:       INTEGER*1 CB.SET
9187: 0955:    END FUNCTION
9188: 0955: 
9189: 0955:    FUNCTION READ.CB EXTERNAL
9190: 0955:       INTEGER*2 READ.CB
9191: 0955:    END FUNCTION
9192: 0955: 
9193: 0955:    FUNCTION WRITE.CB EXTERNAL
9194: 0955:       INTEGER*2 WRITE.CB
9195: 0955:    END FUNCTION
9196: 0955: 
9197: 0955: \/******************************************************************/
9198: 0955: 
9199: 0955:    FUNCTION ADXSTART(NAME$, PARM$, MESS$) EXTERNAL                            !2.9NWB
9200: 0955:       INTEGER*2 ADXSTART                                                      !2.9NWB
9201: 0955:       STRING    NAME$, PARM$, MESS$                                           !2.9NWB
9202: 0955:    END FUNCTION                                                               !2.9NWB
9203: 0955: 
9204: 0955: \*******************************************************************************
9205: 0955: \***
9206: 0955: \***   SUB ASYNC.ERROR
9207: 0955: \***
9208: 0955: \***      STANDARD.ERROR.DETECTED is called to log the error.  If an
9209: 0955: \***      error is detected in this section of code it is logged from
9210: 0955: \***      ERROR.DETECTED.IN.ASYNC.
9211: 0955: \***
9212: 0955: \*******************************************************************************
9213: 0955: 
9214: 0955:     SUB ASYNC.ERROR(RETRY.FLAG%,OVERLAY.STRING$)
9215: 0979: 
9216: 0979:        STRING OVERLAY.STRING$
9217: 0979:        INTEGER*2 RETRY.FLAG%
9218: 0979: 
9219: 0979:        RETRY.FLAG% = 0
9220: 0989:        ON ERROR GOTO ERROR.DETECTED.IN.ASYNC
9221: 099e: 
9222: 099e:        EXIT SUB
9223: 09a8: 
9224: 09a8: \***---------------------------------------------------------------------------
9225: 09a8: \***   ERROR.DETECTED.IN.ASYNC:
9226: 09a8: \***
9227: 09a8: \***      The standard error detected function is called to log the error.
9228: 09a8: \***
9229: 09a8: \***---------------------------------------------------------------------------
9230: 09a8:      ERROR.DETECTED.IN.ASYNC:
9231: 09b8: 
9232: 09b8:        EXIT SUB
9233: 09c2: 
9234: 09c2:    END SUB
9235: 09d6: 
9236: 09d6: 
9237: 09d6: \******************************************************************************
9238: 09d6: \******************************************************************************
9239: 09d6: \***                                                                        ***
9240: 09d6: \***   I N T E R N A L   F U N C T I O N   D E C L A R A T I O N S          ***
9241: 09d6: \***                                                                        ***
9242: 09d6: \***   - FN.VALIDATE.STATE                                                  ***
9243: 09d6: \***   - FN.TRANSLATE.TEXT                                                  ***
9244: 09d6: \***                                                                        ***
9245: 09d6: \******************************************************************************
9246: 09d6: \******************************************************************************
9247: 09d6: 
9248: 09d6: \******************************************************************************
9249: 09d6: \***
9250: 09d6: \***   Function : FN.VALIDATE.STATE( C.STATE$, L.STATE$ )
9251: 09d6: \***
9252: 09d6: \***   Purpose  : Validate received record type C.STATE$, given L.STATE$ was
9253: 09d6: \***              the last state received
9254: 09d6: \***
9255: 09d6: \***   Output   : = 0 for invalid (out of sequence)
9256: 09d6: \***              = 1 for valid (in sequence)
9257: 09d6: \***
9258: 09d6: \******************************************************************************
9259: 09d6: 
9260: 09d6:    FUNCTION FN.VALIDATE.STATE(C.STATE$, L.STATE$)
9261: 0a04:       STRING     C.STATE$, L.STATE$
9262: 0a04:       INTEGER*1  FN.VALIDATE.STATE
9263: 0a04:         EXP.STATES$ = V.TAB$(ASC(L.STATE$) - ASC("1") + 1 ) ! 2.10BG Changed from "A" to "1" to allow earlier Data States
9264: 0a4a:         FN.VALIDATE.STATE = MATCH(C.STATE$, EXP.STATES$, 1)
9265: 0a6d:    END FUNCTION
9266: 0a8e: 
9267: 0a8e: \******************************************************************************
9268: 0a8e: \***
9269: 0a8e: \***   Function : FN.TRANSLATE.TEXT( TEXT$ )
9270: 0a8e: \***
9271: 0a8e: \***   Purpose  : Translate passed text from 4680 character set to PDT
9272: 0a8e: \***              character set
9273: 0a8e: \***
9274: 0a8e: \***   Output   : = string
9275: 0a8e: \***
9276: 0a8e: \******************************************************************************
9277: 0a8e: 
9278: 0a8e:    FUNCTION FN.TRANSLATE.TEXT( TEXT$ )                                  ! CSW
9279: 0ab7:       STRING  FN.TRANSLATE.TEXT, TEXT$                                  ! CSW
9280: 0ab7:       FN.TRANSLATE.TEXT = TRANSLATE$(TEXT$, TRANS.FROM$, TRANS.TO$)     ! CSW
9281: 0aea:    END FUNCTION                                                         ! CSW
9282: 0b08: 
9283: 0b08: \******************************************************************************
9284: 0b08: \******************************************************************************
9285: 0b08: \***                                                                        ***
9286: 0b08: \***   M A I N L I N E   C O D E                                            ***
9287: 0b08: \***                                                                        ***
9288: 0b08: \******************************************************************************
9289: 0b08: \******************************************************************************
9290: 0b08: 
9291: 0b08: \******************************************************************************
9292: 0b08: \***
9293: 0b08: \***   PROGRAM.START:
9294: 0b08: \***
9295: 0b08: \***      handle all errors in ERROR.DETECTED
9296: 0b08: \***
9297: 0b08: \***      execute all SET included code
9298: 0b08: \***
9299: 0b08: \***      display 'start-up message'
9300: 0b08: \***      initialise the program / allocate session numbers
9301: 0b08: \***
9302: 0b08: \***      set RECEIVE.STATE$ to "A"
9303: 0b08: \***      while RECEIVE.STATE$ does not equal "Z"
9304: 0b08: \***
9305: 0b08: \***      WAITING:
9306: 0b08: \***         display 'waiting' message
9307: 0b08: \***
9308: 0b08: \***         wait until able to read data from PSS38
9309: 0b08: \***              or until the LDT pipe has become active
9310: 0b08: \***
9311: 0b08: \***         if the LDT pipe has data then read pipe and send a
9312: 0b08: \***            message to PSS38 to load program into LDT
9313: 0b08: \***            GOTO waiting
9314: 0b08: \***         endif
9315: 0b08: \***
9316: 0b08: \***         read data from PSS38 (via pipe)
9317: 0b08: \***         work out the data type of the received data ( "A" - "Z")
9318: 0b08: \***
9319: 0b08: \***         check the data is expected
9320: 0b08: \***
9321: 0b08: \***         if data is not expected then set STATE$ to "*" (out of sequence)
9322: 0b08: \***
9323: 0b08: \***         if the data type is "A" - "o" then call the appropriate
9324: 0b08: \***            subroutine ;
9325: 0b08: \***            TIDY.UP,                        A
9326: 0b08: \***            RECEIVED.LOG.ON,                B
9327: 0b08: \***            RECEIVED.EPSOM.FILE.HEADER,     C ***
9328: 0b08: \***            RECEIVED.EPSOM.LIST.HEADER,     D ***
9329: 0b08: \***            RECEIVED.EPSOM.LIST.COUNT,      E ***
9330: 0b08: \***            RECEIVED.EPSOM.LIST.TRAILER,    F ***
9331: 0b08: \***            RECEIVED.EPSOM.FILE.TRAILER,    G ***
9332: 0b08: \***            RECEIVED.EPSOM.LIST.REQUEST     H ***
9333: 0b08: \***            RECEIVED.EPSOM.EOT              I ***
9334: 0b08: \*** >>> Following states removed and Replaced  ver 2.9NWB
9335: 0b08: \*** >>>        RECEIVED.CSR.LIST.HEADER        J *
9336: 0b08: \*** >>>        RECEIVED.CSR.LIST.RECORD        K *
9337: 0b08: \*** >>>        RECEIVED.CSR.LIST.TRAILER       L *
9338: 0b08: \*** >>>        RECEIVED.CSR.TABLE.REQUEST      M *
9339: 0b08: \*** >>>        RECEIVED.CSR.EOT                N *
9340: 0b08: \*** >>> End of Replaced states                 ver 2.9NWB
9341: 0b08: \***            RECEIVED.ASN.CARTON.SOT         J                       ! 2.9NWB
9342: 0b08: \***            RECEIVED.ASN.CARTON.AUTO.RCD    K                       ! 2.9NWB
9343: 0b08: \***            RECEIVED.ASN.CARTON.MAN.RCD     L                       ! 2.9NWB
9344: 0b08: \***            ????????                        M                       ! 2.9NWB
9345: 0b08: \***            RECEIVED.ASN.CARTON.EOT         N                       ! 2.9NWB
9346: 0b08: \***            RECEIVED.PCHECK.HEADER          O *
9347: 0b08: \***            RECEIVED.PCHECK.RECORD          P *
9348: 0b08: \***            RECEIVED.PCHECK.TRAILER         Q *
9349: 0b08: \***            RECEIVED.CHECK.VERSION.REQUEST  R **
9350: 0b08: \***            RECEIVED.PROGRAM.TRAILER        S **
9351: 0b08: \***            RECEIVED.DIRECT.ORDERS.REQUEST  T **
9352: 0b08: \***            RECEIVED.DIRECT.FILE.HEADER     U **
9353: 0b08: \***            RECEIVED.DIRECT.ORDERS.HEADER   V **
9354: 0b08: \***            RECEIVED.DIRECT.ORDERS.DETAIL   W **
9355: 0b08: \***            RECEIVED.DIRECT.ORDERS.TRAILER  X **
9356: 0b08: \***            RECEIVED.DIRECT.FILE.TRAILER    Y **
9357: 0b08: \***            RECEIVED.DIRECT.EOT             Z **
9358: 0b08: \***            RECEIVED.UOD.FILE.HEADER        a **
9359: 0b08: \***            RECEIVED.UOD.HEADER             b **
9360: 0b08: \***            RECEIVED.UOD.DETAIL             c **
9361: 0b08: \***            RECEIVED.UOD.TRAILER            d **
9362: 0b08: \***            RECEIVED.UOD.FILE.TRAILER       e **
9363: 0b08: \***            RECEIVED.UOD.EOT                f **
9364: 0b08: \***            RECEIVED.RETURNS.FILE.ID        g ****
9365: 0b08: \***            RECEIVED.RETURNS.FILE.HDR       h ****
9366: 0b08: \***            RECEIVED.RETURNS.UOD.HDR        i ****
9367: 0b08: \***            RECEIVED.RETURNS.UOD.DETAIL     j ****
9368: 0b08: \***            RECEIVED.RETURNS.UOD.TRAILER    k ****
9369: 0b08: \***            RECEIVED.RETURNS.FILE.TRAILER   l ****
9370: 0b08: \***            RECEIVED.RETURNS.FILE.REQUEST   m ****
9371: 0b08: \***            RECEIVED.RETURNS.FILE.REC.OK    n ****
9372: 0b08: \***            RECEIVED.RETURNS.EOT            o ****
9373: 0b08: \***            RECEIVED.STOCKTAKE.HEADER       p ****
9374: 0b08: \***            RECEIVED.STOCKTAKE.DETAIL       q ****
9375: 0b08: \***            RECEIVED.STOCKTAKE.TRAILER      r ****
9376: 0b08: \***            RECEIVED.STOCKCOUNT.HEADER      s *****
9377: 0b08: \***            RECEIVED.STOCKCOUNT.DETAIL      t *****
9378: 0b08: \***            RECEIVED.STOCKCOUNT.TRAILER     u *****
9379: 0b08: \***            RECEIVED.STOCKCOUNT.EOT         v *****
9380: 0b08: \***            RECEIVED.PHARMACY.COUNT.HEADER  w *****
9381: 0b08: \***            RECEIVED.PHARMACY.COUNT.DETAIL  x *****
9382: 0b08: \***            RECEIVED.PHARMACY.COUNT.TRAILER y *****
9383: 0b08: \***            RECEIVED.PHARMACY.COUNT.EOT     Z *****
9384: 0b08: \***         endif
9385: 0b08: \***         *      These modules are all in module 01
9386: 0b08: \***         **     These modules are all in module 02
9387: 0b08: \***         ***    These modules are all in module 03
9388: 0b08: \***         ****   These modules are all in module 04
9389: 0b08: \***         *****  These modules are all in module 05
9390: 0b08: \***
9391: 0b08: \***         if the STATE$ is "*" then
9392: 0b08: \***            log an error
9393: 0b08: \***            wait until PDT times out (a set time)
9394: 0b08: \***            reset STATE$ to "A" (waiting for connection)
9395: 0b08: \***         endif
9396: 0b08: \***
9397: 0b08: \***      wend
9398: 0b08: \***
9399: 0b08: \***   PROGRAM.EXIT:
9400: 0b08: \***      GOSUB SHUTDOWN to close all open files and de-allocate session no.s
9401: 0b08: \***
9402: 0b08: \***   PROGRAM.QUIT:
9403: 0b08: \***   STOP
9404: 0b08: \***
9405: 0b08: \******************************************************************************
9406: 0b08: 
9407: 0b08:    PROGRAM.START:
9408: 0b35: 
9409: 0b35:       ON ASYNC ERROR CALL ASYNC.ERROR
9410: 0b4a: 
9411: 0b4a:       ON ERROR GOTO ERROR.DETECTED
9412: 0b5f: 
9413: 0b5f:       BATCH.SCREEN.FLAG$ = "B"
9414: 0b76:       OPERATOR.ID$ = "99999999"
9415: 0b8d:       MODULE.NUMBER$ = "PSS3700"
9416: 0ba4: 
9417: 0ba4:       DIM PLLDB.TABLE$(3000)                                            !2.5CS
9418: 0bd4:       DIM EAN.TABLE$(1000)                                              !2.5CS
9419: 0c04: 
9420: 0c04:       GOSUB PORT.SETUP                                                  ! DSW
9421: 0c16: 
9422: 0c16:       %INCLUDE ASYNCSEB.J86                                             ! ILC
9423: 0c16: 
9424: 0c16: \******************************************************************************
9425: 0c16: \******************************************************************************
9426: 0c16: \***
9427: 0c16: \***          %INCLUDE FOR ASYNC PDT LINK (STOCK COUTING - PSS37)
9428: 0c16: \***
9429: 0c16: \***                     REFERENCE : ASYNCSET.J86
9430: 0c16: \***
9431: 0c16: \******************************************************************************
9432: 0c16: \******************************************************************************
9433: 0c16: 
9434: 0c16:    ASYNC.FILE.NAME$ = "PDTLINK" + MONITORED.PORT$			! BJAL
9435: 0c3b:    ASYNC.OPEN.FLAG$ = "N"
9436: 0c52:    ASYNC.REPORT.NUM% = 126
9437: 0c62:    ASYNC.SESS.NUM% = 0
9438: 0c72:       %INCLUDE PIPEISEB.J86                                             ! JLC
9439: 0c72: 
9440: 0c72: \******************************************************************************
9441: 0c72: \******************************************************************************
9442: 0c72: \***
9443: 0c72: \***                  %INCLUDE FOR PSS38 INPUT PIPE
9444: 0c72: \***
9445: 0c72: \***                     REFERENCE : PIPEISET.J86
9446: 0c72: \***
9447: 0c72: \***   VERSION B : CSR2                      Janet Lawrence    23/07/90
9448: 0c72: \***   To open the pipe according to the parameter passed to the program.
9449: 0c72: \***   Filename will be set to PIPAIN, PIPBN depending upon port.
9450: 0c72: \***
9451: 0c72: \******************************************************************************
9452: 0c72: \******************************************************************************
9453: 0c72: 
9454: 0c72:    PIPEI.FILE.NAME$ = "PI:PIP" + MONITORED.PORT$ + "IN"                ! BJAL
9455: 0c9b:    PIPEI.REPORT.NUM% = 134 
9456: 0cab:    PIPEI.SESS.NUM% = 0                                        
9457: 0cbb:       %INCLUDE PIPEOSEB.J86                                             ! JLC
9458: 0cbb: 
9459: 0cbb: \******************************************************************************
9460: 0cbb: \******************************************************************************
9461: 0cbb: \***
9462: 0cbb: \***                  %INCLUDE FOR PSS38 OUTPUT PIPE
9463: 0cbb: \***
9464: 0cbb: \***                     REFERENCE : PIPEOSET.J86
9465: 0cbb: \***
9466: 0cbb: \***   VERSION B : CSR2                      Janet Lawrence      23/07/90
9467: 0cbb: \***   To open the pipe according to the parameter passed to the program.
9468: 0cbb: \***   The file name will be PIPAOUT, PIPBOUT depending upon the port.
9469: 0cbb: \******************************************************************************
9470: 0cbb: \******************************************************************************
9471: 0cbb: 
9472: 0cbb:    PIPEO.FILE.NAME$ = "PI:PIP" + MONITORED.PORT$ + "OUT"
9473: 0ce4:    PIPEO.REPORT.NUM% = 135
9474: 0cf4:    PIPEO.SESS.NUM% = 0
9475: 0d04:       %INCLUDE PLDTSETA.J86                                             ! JLC
9476: 0d04: 
9477: 0d04: \******************************************************************************
9478: 0d04: \******************************************************************************
9479: 0d04: \***
9480: 0d04: \***                  %INCLUDE FOR PSS38 LDT PIPE
9481: 0d04: \***
9482: 0d04: \***                     REFERENCE : PLDTSET.J86
9483: 0d04: \***
9484: 0d04: \***   Filename will be set to PLDTA, PLDTB depending upon port.
9485: 0d04: \***
9486: 0d04: \******************************************************************************
9487: 0d04: \******************************************************************************
9488: 0d04: 
9489: 0d04:    PLDT.FILE.NAME$ = "PI:PLDT" + MONITORED.PORT$ 
9490: 0d29:    PLDT.REPORT.NUM% = 244 
9491: 0d39:    PLDT.SESS.NUM% = 0                                        
9492: 0d49:       CALL BCSMF.SET                                                    ! ILC
9493: 0d64:       CALL CCUOD.SET                                                    ! MMJK
9494: 0d71:       CALL CCLAM.SET                                                    ! 1.4
9495: 0d7e:       CALL CCITM.SET                                                    ! MMJK
9496: 0d8b:       CALL CCTRL.SET                                                    ! MMJK
9497: 0d98:       CALL CCDMY.SET                                                    ! MMJK
9498: 0da5:       CALL CCTMP.SET                                                    ! MMJK
9499: 0db2:       CALL CCBUF.SET                                                    ! MMJK
9500: 0dbf:       CALL CCUPF.SET                                                    ! NMJK
9501: 0dcc:       CALL CCWKF.SET                                                    ! MMJK
9502: 0dd9:       CALL CHKBF.SET                                                    ! ILC
9503: 0df4:       CALL GAPBF.SET                                                    ! 1.3  !2.5CS !2.6BG
9504: 0e0f:       CALL PLLOL.SET                                                    !2.5CS
9505: 0e2a:       CALL PLLDB.SET                                                    !2.5CS
9506: 0e45: \     CALL CIMF.SET                                                     ! ILC !2.9NWB
9507: 0e45: \     CALL CITEM.SET                                                    ! ILC !2.9NWB
9508: 0e45: \     CALL CSR.SET                                                      ! ILC !2.9NWB
9509: 0e45: \     CALL CSRBF.SET                                                    ! ILC !2.9NWB
9510: 0e45: \     CALL CSRWF.SET                                                    ! ILC !2.9NWB
9511: 0e45:       CALL EPSOM.SET                                                    ! ILC
9512: 0e60:       CALL FPF.SET                                                      ! ILC
9513: 0e7b:       CALL IDF.SET                                                      ! ILC
9514: 0e96:       CALL IEF.SET                                                      ! ILC
9515: 0eb1:       CALL INVOK.SET                                                    ! ILC
9516: 0ecc:       CALL IRF.SET                                                      ! ILC
9517: 0ee7:       CALL LDTAF.SET                                                    ! MMJK
9518: 0ef4:       CALL ONORD.SET                                                    ! ILC
9519: 0f0f:       CALL PCHK.SET                                                     ! ILC
9520: 0f2a:       CALL PDTWF.SET                                                    ! ILC
9521: 0f45:       CALL PIITM.SET                                                    ! ILC
9522: 0f60:       CALL PILST.SET                                                    ! ILC
9523: 0f7b:       CALL SOFTS.SET                                                    ! MMJK
9524: 0f96:       CALL STKMQ.SET                                                    ! ILC
9525: 0fb1:       CALL UNITS.SET                                                    ! ILC
9526: 0fcc:       CALL DIRORD.SET                                                   ! ILC
9527: 0fe7:       CALL DIRSUP.SET                                                   ! ILC
9528: 1002:       CALL DIRWF.SET                                                    ! ILC
9529: 101d:       CALL DIREC.SET                                                    ! ILC
9530: 1038:       CALL LDTCF.SET                                                    ! ILC
9531: 1053:       CALL DRSMQ.SET                                                    ! ILC
9532: 106e:       CALL LDTBF.SET                                                    ! JLC
9533: 1089:       CALL IDSOF.SET                                                    ! JLC
9534: 10a4:       CALL UOD.SET                                                      ! LLC
9535: 10bf:       CALL UODBF.SET                                                    ! LLC
9536: 10cc:       CALL UODTF.SET                                                    ! LLC
9537: 10e7:       CALL STKBF.SET                                                    ! 1.5
9538: 1102:       CALL SXTCF.SET                                                    ! 1.5
9539: 111d:       CALL SXTMP.SET                                                    ! 1.5
9540: 1138:       CALL STKTK.SET                                                    ! 1.5
9541: 1153:       CALL STLDT.SET                                                    ! 1.7
9542: 116e:       CALL STOCK.SET                                                    !1.8BG
9543: 1189:       CALL IMSTC.SET                                                    !1.8BG
9544: 11a4: !     CALL LSSST.SET                                                    !1.8BG !2.7CS
9545: 11a4: !     CALL STKCF.SET                                                    ! 1.9DA
9546: 11a4:       CALL STKMF.SET                                                    ! 1.9DA
9547: 11bf:       CALL STKRC.SET                                                    ! 1.9DA
9548: 11da:       CALL XGCF.SET                                                     ! 1.9DA
9549: 11f5:       CALL STKEX.SET                                                    ! 1.9DA
9550: 1210:       CALL STKIF.SET                                                    ! 1.9DA
9551: 122b:       CALL LOCCNT.SET                                                   ! 1.9DA
9552: 1246:       CALL STKIG.SET                                                    ! 1.9DA
9553: 1261:       CALL STKTF.SET                                                    ! 1.9DA
9554: 127c:       CALL STKDC.SET                                                    ! 1.9DA
9555: 1297:       CALL SSPSCTRL.SET                                                 ! 2.2JAS
9556: 12a4:       CALL BTCS.SET                                                     ! 2.2JAS
9557: 12bf:       CALL TSF.SET                                                      ! 2.3JAS
9558: 12da:       CALL SOPTS.SET                                                    ! 2.3JAS
9559: 12f5:       CALL LOCAL.SET                                                    ! 2.3JAS
9560: 1310:       CALL CCREJ.SET                                                    ! 2.4JAS
9561: 131d:       CALL CB.SET                                                       !2.9NWB
9562: 132a:       CALL REWKF.SET                                                    ! 2.10BG
9563: 1337:       CALL RB.SET                                                       ! 2.10BG
9564: 1344:       CALL RECALLS.SET                                                  ! 2.10BG
9565: 1351:       CALL DELVINDX.SET                                                 ! 2.12SH
9566: 135e:       CALL AF.SET                                                       ! 2.12SH
9567: 136b:       CALL UODOT.SET                                                    ! 2.12SH
9568: 1378:       CALL UB.SET                                                       ! 2.12SH
9569: 1385:       
9570: 1385:       SB.MESSAGE$ = "PDT Support - Started"                             ! DSW
9571: 139a:       GOSUB SB.BG.MESSAGE
9572: 13ac: 
9573: 13ac:       GOSUB SETUP
9574: 13be: 
9575: 13be:       LDTAF.LINK.TYPE% = 0                                              ! MMJK
9576: 13ce:       GOSUB LOG.TO.LDTAF.FILE                                           ! MMJK
9577: 13e0: 
9578: 13e0:       RECEIVE.STATE$ = "A"
9579: 13f7:       WHILE RECEIVE.STATE$ <> "?"                                       !HDS
9580: 1402: 
9581: 1402:       WAITING:
9582: 1412: 
9583: 1412:          IF MATCH(RECEIVE.STATE$, "AHNRTlm", 1) = 0 THEN BEGIN          ! MMJK
9584: 1438:             NOW% = FN.SECONDS(TIME$)                                    ! DSW
9585: 145c:             IF DATE$ <> LAST.ACTIVE.DATE$                               \ DSW
9586: 14c0:             OR (NOW% - LAST.ACTIVE%) > INACTIVITY.SHUTDOWN% THEN BEGIN  ! DSW
9587: 14c0:                GOSUB INACTIVITY.SHUTDOWN                                ! DSW
9588: 14d2:             ENDIF                                                       ! DSW
9589: 14dd:          ENDIF ELSE BEGIN                                               ! DPAB
9590: 14e5:             IF VAL(LEFT$(TIME$,2)) >= 22 THEN BEGIN                     ! DPAB
9591: 1536:                IF DATE$ <> LAST.SHUTDOWN.DATE$ THEN BEGIN               ! DPAB
9592: 1560:                   LAST.SHUTDOWN.DATE$ = DATE$                           ! DPAB
9593: 1576:                   GOSUB INACTIVITY.SHUTDOWN                             ! DPAB
9594: 1588:                ENDIF                                                    ! DPAB
9595: 1590:             ENDIF                                                       ! DPAB
9596: 1598:          ENDIF                                                          ! DSW
9597: 15a0: 
9598: 15a0:          SB.MESSAGE$ = "PDT Support - Data state : " + RECEIVE.STATE$   ! DSW
9599: 15c3:          GOSUB SB.BG.MESSAGE                                            ! DSW
9600: 15d5: 
9601: 15d5:          WAIT PIPEO.SESS.NUM%, PLDT.SESS.NUM% ; 60000                   ! HDS
9602: 15fe:          TEMP.EVENT% = EVENT%                                           ! FSSJ
9603: 160e:          IF TEMP.EVENT% = 0 THEN GOTO WAITING                           ! FSSJ
9604: 1620: 
9605: 1620:          IF TEMP.EVENT% = PLDT.SESS.NUM% THEN BEGIN                     ! HDS
9606: 1639:             IF END# PLDT.SESS.NUM% THEN READ.ERROR                      ! HDS
9607: 1657:             CURR.SESS.NUM% = PLDT.SESS.NUM%                             ! HDS
9608: 1669:             READ# PLDT.SESS.NUM%; PLDT.RECORD$                          ! HDS
9609: 168f:             IF LEFT$(PLDT.RECORD$,4) <> "PLDT" THEN BEGIN               ! HDS
9610: 16c1:                GOTO WAITING                                             ! HDS
9611: 16cc:             ENDIF                                                       ! HDS
9612: 16d4:             GOSUB REQUEST.PROGRAM.LOAD                                  ! HDS
9613: 16e6:             GOTO WAITING                                                ! HDS
9614: 16f1:          ENDIF                                                          ! HDS
9615: 16f9: 
9616: 16f9:          IF END# PIPEO.SESS.NUM% THEN READ.ERROR
9617: 1717:          CURR.SESS.NUM% = PIPEO.SESS.NUM%
9618: 1729:          READ# PIPEO.SESS.NUM%; PIPE.IN$
9619: 174f: 
9620: 174f:          IF LEFT$(PIPE.IN$, 1) <> "R"                                   \
9621: 17ac:          OR LEN(PIPE.IN$) < 2 THEN GOTO WAITING
9622: 17b7:          DATA.IN$ = RIGHT$(PIPE.IN$, LEN(PIPE.IN$) - 1)
9623: 17e7:          GOSUB DETERMINE.DATA.TYPE
9624: 17f9:          LOG.STATE$ = STATE$
9625: 1815:          
9626: 1815:          IF STATE$ = "@" THEN BEGIN                                     !2.8CS
9627: 1833:              GOSUB SHUTDOWN                                             !2.8CS
9628: 1845:              GOTO PROGRAM.QUIT                                          !2.8CS
9629: 1850:          ENDIF                                                          !2.8CS
9630: 1858: 
9631: 1858:          IF MATCH(STATE$,                                               \ MMJK
9632: 187b:             "123456789:;<=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz", 1) > 0  \ 2.12SH
9633: 187b:             THEN BEGIN                                                  ! LLC
9634: 187b:             IF FN.VALIDATE.STATE(STATE$, RECEIVE.STATE$) = 0 THEN BEGIN
9635: 18a4:                STATE$ = "*"
9636: 18bb:             ENDIF
9637: 18c3:          ENDIF
9638: 18cb:          
9639: 18cb:          RECEIVE.STATE$ = STATE$
9640: 18e9: 
9641: 18e9:          IF MATCH(RECEIVE.STATE$,                                       \ LLC
9642: 190f:             "123456789:;<=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef", 1) > 0     \ 2.12SH
9643: 190f:             THEN BEGIN                                                  ! LLC
9644: 190f:             ON ((ASC(RECEIVE.STATE$)) - ASC("1") + 1) GOSUB             \
9645: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 1
9646: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 2
9647: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 3
9648: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 4
9649: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 5
9650: 1958:                CALL.OTHER.MODULE5,                                      \ 2.10BG  State 6
9651: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State 7
9652: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State 8
9653: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State 9
9654: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State :
9655: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State ;
9656: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State <
9657: 1958:                CALL.OTHER.MODULE5,                                      \ 2.12SH  State =
9658: 1958:                DUMMY.ROUTINE,                                           \ 2.10BG  State > !DO NOT USE
9659: 1958:                DUMMY.ROUTINE,                                           \ 2.10BG  State ? !DO NOT USE
9660: 1958:                DUMMY.ROUTINE,                                           \ 2.10BG  State @ !DO NOT USE
9661: 1958:                TIDY.UP,                                                 \
9662: 1958:                RECEIVED.LOG.ON,                                         \
9663: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9664: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9665: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9666: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9667: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9668: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9669: 1958:                CALL.OTHER.MODULE3,                                      \ LLC
9670: 1958: \              CSR.LIST.HEADER.RECEIVED,                                \ EPAB
9671: 1958: \              WRITE.DATA.TO.CSR.BUFFER,                                \ DJAL
9672: 1958: \              WRITE.DATA.TO.CSR.BUFFER,                                \ DJAL
9673: 1958: \              CALL.OTHER.MODULE,                                       \ DJAL
9674: 1958: \              RECEIVED.CSR.EOT,                                        \ DJAL
9675: 1958:                ASN.CARTON.HEADER.RECEIVED,                              \ 2.9NWB
9676: 1958:                AUTOMATIC.CARTON.BOOK.IN,                                \ 2.9NWB
9677: 1958:                MANUAL.CARTON.BOOK.IN,                                   \ 2.9NWB
9678: 1958:                DUMMY.ROUTINE,                                           \ 2.9NWB
9679: 1958:                ASN.CARTON.EOT.RECEIVED,                                 \ 2.9NWB
9680: 1958:                CALL.OTHER.MODULE,                                       \ DJAL
9681: 1958:                CALL.OTHER.MODULE,                                       \ DJAL
9682: 1958:                CALL.OTHER.MODULE,                                       \ DJAL
9683: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9684: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9685: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9686: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9687: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9688: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9689: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9690: 1958:                CALL.OTHER.MODULE2,                                      \ HDS
9691: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9692: 1958:                DUMMY.ROUTINE,                                           \ LLC State [ !DO NOT USE
9693: 1958:                DUMMY.ROUTINE,                                           \ LLC State \ !DO NOT USE
9694: 1958:                DUMMY.ROUTINE,                                           \ LLC State ] !DO NOT USE
9695: 1958:                DUMMY.ROUTINE,                                           \ LLC State ^ !DO NOT USE
9696: 1958:                DUMMY.ROUTINE,                                           \ LLC State _ !DO NOT USE
9697: 1958:                DUMMY.ROUTINE,                                           \ LLC State . !DO NOT USE
9698: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9699: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9700: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9701: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9702: 1958:                CALL.OTHER.MODULE2,                                      \ LLC
9703: 1958:                CALL.OTHER.MODULE2                                       ! LLC
9704: 1958:                !Moved last 16 from here to the next section to allow the new first 16 ! 2.10BG
9705: 1958:                
9706: 1958:          ENDIF ELSE BEGIN                                               ! 2.2JAS
9707: 1960:             IF MATCH(RECEIVE.STATE$,                                    \ 2.2JAS
9708: 1986:                "ghijklmnopqrstuvwxyz", 1) > 0                           \ 2.2JAS ! 2.10BG
9709: 1986:                THEN BEGIN                                               ! 2.2JAS
9710: 1986:                 ON ((ASC(RECEIVE.STATE$)) - ASC("g") + 1) GOSUB         \ 2.2JAS ! 2.10BG
9711: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9712: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9713: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9714: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9715: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9716: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9717: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9718: 19cc:                   CALL.OTHER.MODULE4,                                   \ MMJK
9719: 19cc:                   CALL.OTHER.MODULE4,                                   \ 1.5
9720: 19cc:                   CALL.OTHER.MODULE4,                                   \ 1.5
9721: 19cc:                   CALL.OTHER.MODULE4,                                   \ 1.5
9722: 19cc:                   CALL.OTHER.MODULE4,                                   \ 1.5
9723: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.1BG
9724: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.1BG
9725: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.1BG
9726: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.1BG ! 2.2JAS
9727: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.2JAS
9728: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.2JAS
9729: 19cc:                   CALL.OTHER.MODULE5,                                   \ 2.2JAS
9730: 19cc:                   CALL.OTHER.MODULE5                                    ! 2.2JAS
9731: 19cc:             ENDIF                                                       ! 2.2JAS
9732: 19d4:          ENDIF                                                          ! 2.2JAS
9733: 19dc: 
9734: 19dc:          IF RECEIVE.STATE$ = "*"  THEN BEGIN
9735: 19fd:             GOSUB SB.LOG.PDT.ERROR
9736: 1a0f:             IF CURR.TERMINAL$ <> "??????" THEN BEGIN                    ! LLC
9737: 1a30:                CSR.AUDIT.DATA$ = DEVICE$ +                              \ NMJK
9738: 1a6d:                    "Link session ABORTED by Application"                \ NMJK
9739: 1a6d:                    + " program, " + DEVICE$ + "number " + CURR.TERMINAL$! LLC
9740: 1a6d:                GOSUB LOG.TO.AUDIT.FILE                                  ! EPAB
9741: 1a7f:                CSR.AUDIT.DATA$ = "Message sent to " + DEVICE$ + "[" +   \ LLC
9742: 1ac9:                   NAK.LINE.1$ + " " + NAK.LINE.2$ + " " +               \ EPAB
9743: 1ac9:                   NAK.LINE.3$ + "]"                                     ! EPAB
9744: 1ac9:                GOSUB LOG.ABORT.TO.AUDIT.FILE                            ! EPAB
9745: 1adb:             ENDIF                                                       ! EPAB
9746: 1ae3:             GOSUB TIDY.UP
9747: 1af5:             RECEIVE.STATE$ = "A"                                        ! ILC
9748: 1b0c:          ENDIF
9749: 1b14: 
9750: 1b14:       WEND
9751: 1b35: 
9752: 1b35:    PROGRAM.EXIT:
9753: 1b45:    
9754: 1b45:       IF RE.CHAIN THEN BEGIN                                            ! ILC
9755: 1b57:          PIPE.OUT$ = "QR"                                               ! ILC
9756: 1b6e:          GOSUB SEND.TO.PSS38                                            ! ILC
9757: 1b80:          CALL ADXSERCL                                                  ! ILC
9758: 1b8d:          CHAIN "ADX_UPGM:PSS37.286", MONITORED.PORT$                    ! ILC
9759: 1bb8:       ENDIF ELSE BEGIN                                                  ! ILC
9760: 1bc0:          PIPE.OUT$ = "Q"                                                ! ILC
9761: 1bd7:          GOSUB SEND.TO.PSS38                                            ! ILC
9762: 1be9:       ENDIF                                                             ! ILC
9763: 1bf1: 
9764: 1bf1:       GOSUB SHUTDOWN
9765: 1c03:       
9766: 1c03:    PROGRAM.QUIT:
9767: 1c13:    STOP
9768: 1c20: 
9769: 1c20: \******************************************************************************
9770: 1c20: \******************************************************************************
9771: 1c20: \***                                                                        ***
9772: 1c20: \***   S U B R O U T I N E S                                                ***
9773: 1c20: \***                                                                        ***
9774: 1c20: \******************************************************************************
9775: 1c20: \******************************************************************************
9776: 1c20: 
9777: 1c20: \*****************************************************************************
9778: 1c20: \***   DUMMY.ROUTINE:
9779: 1c20: \***
9780: 1c20: \***   to allow the use of lower case DATA.STATEs - there are 6 non-alpha
9781: 1c20: \***   ASCII characters between Z and a.  The MATCH statement must allow
9782: 1c20: \***   for these characters, so they call this dummy routine.
9783: 1c20: \***
9784: 1c20: \*****************************************************************************
9785: 1c20: 
9786: 1c20: DUMMY.ROUTINE:
9787: 1c30: 
9788: 1c30: RETURN
9789: 1c40: 
9790: 1c40: \******************************************************************************
9791: 1c40: \***
9792: 1c40: \***   PORT.SETUP:
9793: 1c40: \***
9794: 1c40: \***      determine the port being monitored by interrogating the command tail
9795: 1c40: \***
9796: 1c40: \***   RETURN
9797: 1c40: \***
9798: 1c40: \******************************************************************************
9799: 1c40: 
9800: 1c40: PORT.SETUP:
9801: 1c50: 
9802: 1c50:    TRUE = -1                                                            ! ILC
9803: 1c60:    FALSE = 0                                                            ! ILC
9804: 1c70: 
9805: 1c70:    WARM.START = FALSE                                                   ! ILC
9806: 1c86:    RE.CHAIN = FALSE                                                     ! ILC
9807: 1c9c:    IF LEFT$(COMMAND$,3) = "PI:" THEN BEGIN                              ! ILC
9808: 1cd6:       USE MONITORED.PORT$                                               ! ILC
9809: 1cf3:       WARM.START = TRUE                                                 ! ILC
9810: 1d0c:    ENDIF ELSE BEGIN                                                     ! ILC
9811: 1d14:       IF MATCH("BACKGRND",COMMAND$,1) > 0 THEN BEGIN                    ! DSW
9812: 1d42:          IF LEN(COMMAND$) > MATCH("BACKGRND",COMMAND$,1) + 8 THEN BEGIN ! DSW
9813: 1d7e:             MONITORED.PORT$ = MID$(COMMAND$,MATCH("BACKGRND",COMMAND$,1) + 9,1)
9814: 1dc9:          ENDIF ELSE BEGIN                                               ! DSW
9815: 1dd1:             MONITORED.PORT$ = " "                                       ! DSW
9816: 1de8:          ENDIF                                                          ! DSW
9817: 1df2:       ENDIF ELSE BEGIN                                                  ! DSW
9818: 1dfa:          SB.EVENT.NO% = 73                                              ! DSW
9819: 1e07:          GOSUB SB.LOG.AN.EVENT                                          ! DSW
9820: 1e19:          GOTO PROGRAM.EXIT                                              ! DSW
9821: 1e24:       ENDIF                                                             ! DSW
9822: 1e2c:    ENDIF                                                                ! ILC
9823: 1e34: 
9824: 1e34:    IF MATCH(MONITORED.PORT$,"AB",1) = 0 THEN BEGIN                      ! DSW
9825: 1e57:       SB.MESSAGE$ = "INVALID PORT NAME"                                 ! DSW
9826: 1e6c:       GOSUB SB.BG.MESSAGE                                               ! DSW
9827: 1e7e:       SB.UNIQUE$ = MONITORED.PORT$                                      ! DSW
9828: 1e9a:       SB.EVENT.NO% = 74                                                 ! DSW
9829: 1ea7:       GOSUB SB.LOG.AN.EVENT                                             ! DSW
9830: 1eb9:       GOTO PROGRAM.EXIT                                                 ! DSW
9831: 1ec4:    ENDIF                                                                ! DSW
9832: 1ecc: 
9833: 1ecc: RETURN
9834: 1edc: 
9835: 1edc: 
9836: 1edc: \******************************************************************************
9837: 1edc: \***
9838: 1edc: \***   SETUP:
9839: 1edc: \***
9840: 1edc: \***      set-up general variables
9841: 1edc: \***      set-up link/pdt control characters
9842: 1edc: \***      dimension and set-up received data state validation tables
9843: 1edc: \***      dimension general arrays
9844: 1edc: \***      set-up all session numbers required in program
9845: 1edc: \***      set-up constant values
9846: 1edc: \***      open communication pipes PSS37 and PSS38
9847: 1edc: \***      gosub ZEROISE.CITEM (because, following a reboot, it is possible
9848: 1edc: \***      that the ON.ORDER.IN.THIS.PDT field could still be set.)
9849: 1edc: \***
9850: 1edc: \***   RETURN
9851: 1edc: \***
9852: 1edc: \******************************************************************************
9853: 1edc: 
9854: 1edc:    SETUP:
9855: 1eec: 
9856: 1eec:       CALL ADXSERVE(ADX.RET.CODE%, 4, 0, APPL.STATUS$)
9857: 1f24:       IF ADX.RET.CODE% <> 0 THEN BEGIN
9858: 1f3f:          SB.EVENT.NO% = 23
9859: 1f4c:          SB.UNIQUE$ = FN.Z.PACK(STR$(ADX.RET.CODE%),5) + "04   "
9860: 1f8d:          SB.MESSAGE$ = "ADXSERVE FUNCTION 4 FAILURE"
9861: 1fa2:          GOSUB SB.LOG.AN.EVENT
9862: 1fb4:       ENDIF
9863: 1fbc: 
9864: 1fbc:       STORE.NUMBER$ = LEFT$(APPL.STATUS$,4)
9865: 1fe0:       SAVED.STORE.NUMBER$ = STORE.NUMBER$
9866: 1ffe:       DATE.TODAY$ = DATE$
9867: 2016:       TIDY.FLAG$ = "N"
9868: 202b:       PDT.ACTION$ = "INACTIVE"
9869: 2042:       NUMBER.OF.RECORDS% = 0                                            ! MMJK
9870: 2050:       LOG.ON.TIME$ = "000000"
9871: 2067:       PK2$ = PACK$("0000")
9872: 2083:       PK4$ = PACK$("00000000")
9873: 209f:       LAST.ACTIVE.DATE$ = DATE$                                         ! DSW
9874: 20b7:       LAST.ACTIVE% = 0                                                  ! DSW
9875: 20ce:       LAST.STOCKTAKE.DATE$ = DATE$                                      ! 1.5
9876: 20e6:       LAST.STOCKTAKE% = FN.SECONDS(TIME$)                               ! 1.5
9877: 210c:       NAK.LINE.1$ = ""                                                  ! DSW
9878: 2121:       NAK.LINE.2$ = ""                                                  ! DSW
9879: 2136:       NAK.LINE.3$ = ""                                                  ! DSW
9880: 214b:       PREV.LOGGED.STATE$ = ""                                           ! JLC
9881: 2162:       LDTBF.HEADER.WRITTEN$ = "N"                                       ! JLC
9882: 2179: 
9883: 2179:       SOH$ = CHR$(01h)
9884: 2193:       STX$ = CHR$(02h)
9885: 21ad:       ENQ$ = CHR$(05h)
9886: 21c5:       CR$  = CHR$(0Dh)
9887: 21dd:       LF$  = CHR$(0Ah)
9888: 21f5:       ACK$ = CHR$(06h)
9889: 220f:       NAK$ = CHR$(15h)
9890: 2227:       CRLF$ = CR$ + LF$
9891: 224b: 
9892: 224b:       ! 4680 character set --> MSI character set translation table
9893: 224b:       !
9894: 224b:       ! character 04h on the PDT displays a pound sign
9895: 224b:       ! character 03h displays a backslash
9896: 224b:       !
9897: 224b:       TRANS.FROM$ = ""       + "\"       + "$"                         ! CSW
9898: 226d:       TRANS.TO$   = CHR$(03h) + CHR$(04h) + CHR$(03h)                   ! CSW
9899: 22ae: 
9900: 22ae:       DIM V.TAB$(74)                                                    ! 1.5 ! 2.1BG !2.2JAS ! 2.10BG
9901: 22dd:       FOR I% = 1 TO 74 : READ V.TAB$(I%) : NEXT I%                      ! 1.5 ! 2.1BG !2.2JAS ! 2.10BG
9902: 2333: 
9903: 2333: !------------------------------------------------------------------------------
9904: 2333: ! DATA - V.TAB$() - received state, validation table
9905: 2333: !
9906: 2333: ! state   description                           next valid state
9907: 2333: !------------------------------------------------------------------------------
9908: 2333: ! 1     = Recall File Request                   2                           ! 2.10BG
9909: 2333: ! 2     = Recall File Received OK               6                           ! 2.10BG
9910: 2333: ! 3     = Recall Header                         4,5                         ! 2.10BG
9911: 2333: ! 4     = Recall Detail                         4,5                         ! 2.10BG
9912: 2333: ! 5     = Recall Trailer                        3,6                         ! 2.10BG
9913: 2333: ! 6     = Recall EOT                            -                           ! 2.10BG
9914: 2333: ! 7     = +UOD sign on received                 8                           ! 2.12SH
9915: 2333: ! 8     = +UOD expected received okay received  -                           ! 2.12SH
9916: 2333: ! 9     = +UOD booking header received          : <                         ! 2.12SH
9917: 2333: ! :     = +UOD booking detail receivd           : ; <                       ! 2.12SH
9918: 2333: ! ;     = +UOD booking batch trailer received   : <                         ! 2.12SH
9919: 2333: ! <     = +UOD booking session trailer received =                           ! 2.12SH
9920: 2333: ! =     = +UOD EOT                              -                           ! 2.10BG
9921: 2333: ! >     = Dummy (ASCII 062)                     a                           ! 2.10BG
9922: 2333: ! ?     = Dummy (ASCII 063)                     a                           ! 2.10BG
9923: 2333: ! @     = Dummy (ASCII 064)                     a                           ! 2.10BG
9924: 2333: ! A     = waiting for log-on                    B
9925: 2333: ! B     = log-on record received                3,C,H,J,M,O,R,U,a,g,p,s,w     1.5 ! 2.1BG !2.2JAS ! 2.10BG
9926: 2333: ! C     = EPSOM file header record received     D
9927: 2333: ! D     = EPSOM list header record received     E
9928: 2333: ! E     = EPSOM list count record received      E,F
9929: 2333: ! F     = EPSOM list trailer record received    D,G
9930: 2333: ! G     = EPSOM file trailer record received    H,I
9931: 2333: ! H     = EPSOM list request record received    G
9932: 2333: ! I     = EPSOM EOT received                    -
9933: 2333: ! J     = ASN Carton header received            K,L                           !2.9NWB
9934: 2333: ! K     = ASN Automatic Carton Book In          K,L,N,R                       !2.9NWB
9935: 2333: ! L     = ASN Manual Carton Book In             K,L,N,R                       !2.9NWB
9936: 2333: ! M     = ASN                                                                 !2.9NWB
9937: 2333: ! N     = ASN Carton EOT received               -                             !2.9NWB
9938: 2333: ! O     = Price check header received           P
9939: 2333: ! P     = Price check record received           P,Q
9940: 2333: ! Q     = Price check trailer received          -
9941: 2333: ! R     = Check/Request program version         1,S,T,Z,f,m,v,z          2.1BG !2.2JAS ! 2.10BG
9942: 2333: ! S     = Program trailer                       T,Z,o,f                 OMJK
9943: 2333: ! T     = Directs order request                 Y
9944: 2333: ! U     = Directs file header                   V
9945: 2333: ! V     = Directs order header                  W,X
9946: 2333: ! W     = Directs order detail                  W,X
9947: 2333: ! X     = Directs order trailer                 V,Y
9948: 2333: ! Y     = Directs file trailer                  R,T,Z
9949: 2333: ! Z     = Directs EOT                           -
9950: 2333: ! [     = Dummy (ASCII 091)                     a
9951: 2333: ! \     = Dummy (ASCII 092)                     a
9952: 2333: ! ]     = Dummy (ASCII 093)                     a
9953: 2333: ! ^     = Dummy (ASCII 094)                     a
9954: 2333: ! _     = Dummy (ASCII 095)                     a
9955: 2333: ! `     = Dummy (ASCII 096)                     a
9956: 2333: ! a     = UOD File Header                       b
9957: 2333: ! b     = UOD Header                            c,d
9958: 2333: ! c     = UOD Detail                            c,d
9959: 2333: ! d     = UOD Trailer                           b,e
9960: 2333: ! e     = UOD File Trailer                      R
9961: 2333: ! f     = UOD EOT                               -
9962: 2333: ! g     = RETURNS File ID                       h,R
9963: 2333: ! h     = RETURNS File Header                   i,l                      NMJK
9964: 2333: ! i     = RETURNS UOD Header                    j,k
9965: 2333: ! j     = RETURNS Item Detail                   j,k
9966: 2333: ! k     = RETURNS UOD Trailer                   i,l
9967: 2333: ! l     = RETURNS File Trailer                  o
9968: 2333: ! m     = RETURNS File Request                  n
9969: 2333: ! n     = RETURNS File Received OK              o
9970: 2333: ! o     = RETURNS EOT                           -
9971: 2333: ! p     = STOCKTAKE File Header                 q                        1.5
9972: 2333: ! q     = STOCKTAKE Item Detail                 q,r                      1.5
9973: 2333: ! r     = STOCKTAKE File Trailer                -                        1.5
9974: 2333: ! s     = STOCKCOUNT File Header                t                        2.1BG
9975: 2333: ! t     = STOCKCOUNT Detail                     t,u                      2.1BG
9976: 2333: ! u     = STOCKCOUNT File Trailer               R                        2.1BG
9977: 2333: ! v     = STOCKCOUNT EOT                        -                        2.1BG
9978: 2333: ! w     = PHARMACY File Header                  x                        2.2JAS
9979: 2333: ! x     = PHARMACY Item Detail                  x,y                      2.2JAS
9980: 2333: ! y     = PHARMACY File Trailer                 z                        2.2JAS
9981: 2333: ! z     = PHARMACY EOT                          -                        2.2JAS
9982: 2333: !
9983: 2333: !------------------------------------------------------------------------------
9984: 2333: DATA     "2","6","45","45","36","-","8","-",":<",":;<",":<","=","-","a", \ 2.12SH
9985: 2333:          "a","a",                                                        \ 2.12SH
9986: 2333:          "B", "379CHJMORUagpsw", "D", "E", "EF", "DG", "HI", "G", "-",   \ 2.12SH
9987: 2333:          "KL", "KLNR", "KLNR", "-", "-", "P", "PQ", "-",                 \ DSW!2.9NWB
9988: 2333:          "1SNTZfmvz", "TZof", "Y", "V","WX","WX","VY","RTZ","-",         \ OMJK !2.1BG !2.2JAS ! 2.10BG
9989: 2333:          "a","a","a","a","a","a",                                        \ LLC
9990: 2333:          "b","cd","cd","be","R","-",                                     \ OMJK
9991: 2333:          "hR","il","jk","jk","il","o","n","o","-","q","qr","-",          \ 1.5
9992: 2333:          "t","tu","R", "-",                                              \! 2.1BG !2.2JAS
9993: 2333:          "x","xy","z","-"                                                ! 2.2JAS
9994: 2333: 
9995: 2333:       DIM LOGON.TAB$(12)                                                 ! 2.12SH
9996: 235c:       FOR I% = 1 TO 12 : READ LOGON.TAB$(I%) : NEXT I%                   ! 2.12SH
9997: 23af: 
9998: 23af: !------------------------------------------------------------------------------
9999: 23af: ! DATA - LOGON.TAB$() - expected states depending upon application number
10000: 23af: !
10001: 23af: ! application no.    description                next valid state
10002: 23af: !------------------------------------------------------------------------------
10003: 23af: !       01           EPSOM                      B,C,H
10004: 23af: !       02           ASN                        B,J                           !2.9NWB
10005: 23af: !       03           Price check                B,O
10006: 23af: !       27 (=4)                                 B                             !2.9NWB
10007: 23af: !       05           DIRECTS                    B,R,U
10008: 23af: !       06           UOD                        B,a
10009: 23af: !       07           RETURNS                    B,R,g
10010: 23af: !       08           STOCKTAKE                  B,p
10011: 23af: !       09           STOCKCOUNT                 B,s     2.1BG
10012: 23af: !       10           PHARMACY                   B,w     2.2JAS
10013: 23af: !       11           RECALLS                    B,1,3                         !2.10BG
10014: 23af: !       12           +UOD                       B,
10015: 23af: !                                               B,7,9                         !2.12SH
10016: 23af: ! NOTE : log-on is allowed at any point in case of previous failure
10017: 23af: !
10018: 23af: !------------------------------------------------------------------------------
10019: 23af: DATA     "BCH", "BJ", "BO", "B", "BRU", "Ba" , "BRg" , "Bp" , "Bs", "Bw", "B13", "B79" !2.12SH
10020: 23af: 
10021: 23af:       REC.MAX% = 67                                                     ! 2.12SH
10022: 23bf:       DIM REC.CHECK$(REC.MAX%)
10023: 23f5: 
10024: 23f5:       ! Log-on record (B)
10025: 23f5:       !
10026: 23f5:       ! SOH + nnnn + nnnnnn + nn + ENQ$
10027: 23f5:       !
10028: 23f5:       REC.CHECK$(1) = "B"+SOH$ + "N"+CHR$(4) + "N"+CHR$(6) +            \ DJAL
10029: 2474:                       "N"+CHR$(2) + "B"+ENQ$                            ! DJAL
10030: 2474: 
10031: 2474:       ! File header record (C)
10032: 2474:       !
10033: 2474:       ! aa + nn + nn + nnnnnn
10034: 2474:       !
10035: 2474:       REC.CHECK$(2) = "A"+CHR$(2) + "N"+CHR$(2) + "N"+CHR$(2) +         \
10036: 24e3:                       "N"+CHR$(6)
10037: 24e3: 
10038: 24e3:       ! List header record (D)
10039: 24e3:       !
10040: 24e3:       ! aa + nnnn + aaaaa
10041: 24e3:       !
10042: 24e3:       REC.CHECK$(3) = "A"+CHR$(2) + "N"+CHR$(4) + "A"+CHR$(5)
10043: 253c: 
10044: 253c:       ! List item record (E)
10045: 253c:       !
10046: 253c:       ! aa + nnnnnnn + aaaa + aaaa + aaaaaa + aaaa + nnnnnn + aaaaaaaaa
10047: 253c:       !
10048: 253c:       REC.CHECK$(4) = "A"+CHR$(2) + "N"+CHR$(7) + "A"+CHR$(4) +         \
10049: 2603:                       "A"+CHR$(4) + "A"+CHR$(6) + "A"+CHR$(4) +         \
10050: 2603:                       "N"+CHR$(6) + "A"+CHR$(9)
10051: 2603: 
10052: 2603:       ! List trailer record (F)
10053: 2603:       !
10054: 2603:       ! aa + nnnn + nnn
10055: 2603:       !
10056: 2603:       REC.CHECK$(5) = "A"+CHR$(2) + "N"+CHR$(4) + "N"+CHR$(3)
10057: 265c: 
10058: 265c:       ! File trailer record (G)
10059: 265c:       !
10060: 265c:       ! aa + nn + nnnnnn + nn
10061: 265c:       !
10062: 265c:       REC.CHECK$(6) = "A"+CHR$(2) + "N"+CHR$(2) + "N"+CHR$(6) +         \
10063: 26cb:                       "N"+CHR$(2)
10064: 26cb: 
10065: 26cb:       ! List request record (H)
10066: 26cb:       !
10067: 26cb:       ! SOH + nn + nnnnnn
10068: 26cb:       !
10069: 26cb:       REC.CHECK$(7) = "B"+SOH$ + "N"+CHR$(2) + "N"+CHR$(6)
10070: 271d: 
10071: 271d:       ! EPSOM EOT record (I)
10072: 271d:       !
10073: 271d:       ! aa + nnnnnn
10074: 271d:       !
10075: 271d:       REC.CHECK$(8) = "A"+CHR$(2) + "N"+CHR$(6)                         ! DJAL
10076: 2760: 
10077: 2760: \     ! CSR list header received (J)                                          !2.9NWB
10078: 2760: \     !                                                                       !2.9NWB
10079: 2760: \     ! aa + n + nn + nnnnnn + nnnnnn                                         !2.9NWB
10080: 2760: \     !                                                                       !2.9NWB
10081: 2760: \     REC.CHECK$(9) = "A"+CHR$(2) + "N"+CHR$(1) + "N"+CHR$(2) +        \ DJAL !2.9NWB
10082: 2760: \                     "N"+CHR$(6) + "N"+CHR$(4)                        ! DJAL !2.9NWB
10083: 2760: 
10084: 2760: \     ! CSR list record received (K)                                          !2.9NWB
10085: 2760: \     !                                                                       !2.9NWB
10086: 2760: \     ! XU: aa + nn + nnn + nnn                                               !2.9NWB
10087: 2760: \     ! XM: aa + nnnnnnn + nnn + a + aaa + aaa                                !2.9NWB
10088: 2760: \     ! XO: aa + nnnnnnn + nnn                                                !2.9NWB
10089: 2760: \     !                                                                       !2.9NWB
10090: 2760: \     REC.CHECK$(10) = "A"+CHR$(2) + "N"+CHR$(2) + "N"+CHR$(3) +       \ DJAL !2.9NWB
10091: 2760: \                      "N"+CHR$(3)                                     ! DJAL !2.9NWB
10092: 2760: \     REC.CHECK$(11) = "A"+CHR$(2) + "N"+CHR$(7) + "N"+CHR$(3) +       \ DJAL !2.9NWB
10093: 2760: \                      "A"+CHR$(1) + "A"+CHR$(3) + "A"+CHR$(3)         ! DJAL !2.9NWB
10094: 2760: \     REC.CHECK$(12) = "A"+CHR$(2) + "N"+CHR$(7) + "N"+CHR$(3)         ! DJAL !2.9NWB
10095: 2760: 
10096: 2760: \     ! CSR list trailer received (L)                                         !2.9NWB
10097: 2760: \     !                                                                       !2.9NWB
10098: 2760: \     ! aa + nnn                                                              !2.9NWB
10099: 2760: \     !                                                                       !2.9NWB
10100: 2760: \     REC.CHECK$(13) = "A"+CHR$(2) + "N"+CHR$(3)                       ! DJAL !2.9NWB
10101: 2760: 
10102: 2760: \     ! CSR table request received (M)                                        !2.9NWB
10103: 2760: \     !                                                                       !2.9NWB
10104: 2760: \     ! aa                                                                    !2.9NWB
10105: 2760: \     !                                                                       !2.9NWB
10106: 2760: \     REC.CHECK$(14) = "A"+CHR$(2)                                     ! DJAL !2.9NWB
10107: 2760: 
10108: 2760: \     ! CSR EOT received (N)                                                  !2.9NWB
10109: 2760: \     !                                                                       !2.9NWB
10110: 2760: \     ! aa + nnnnnn + nnn                                                     !2.9NWB
10111: 2760: \     !                                                                       !2.9NWB
10112: 2760: \     REC.CHECK$(15) = "A"+CHR$(2) + "N"+CHR$(6) + "N"+CHR$(3)         ! DJAL !2.9NWB
10113: 2760: 
10114: 2760:       ! ASN Carton Header Received (J)                                        !2.9NWB
10115: 2760:       !                                                                       !2.9NWB
10116: 2760:       ! aa                                                                    !2.9NWB
10117: 2760:       !                                                                       !2.9NWB
10118: 2760:       REC.CHECK$(9)  = "A"+CHR$(2)                                            !2.9NWB
10119: 278d: 
10120: 278d:       ! ASN Automatic Carton Book in (K)                                      !2.9NWB
10121: 278d:       !                                                                       !2.9NWB
10122: 278d:       ! aa + aaaaaaaaaaaaaa                                                   !2.9NWB
10123: 278d:       !                                                                       !2.9NWB
10124: 278d:       REC.CHECK$(10)  = "A"+CHR$(2) + "A"+CHR$(14)                            !2.9NWB
10125: 27d0: 
10126: 27d0:       ! ASN Manual Carton Book in (L)                                         !2.9NWB
10127: 27d0:       !                                                                       !2.9NWB
10128: 27d0:       ! XM: aa + aaaaaaaaaaaaaa                                               !2.9NWB
10129: 27d0:       ! XU: aa + aaaaaaaaaaaaa + aaaa                                         !2.9NWB
10130: 27d0:       ! XO: aa + aaaaa + aaaa                                                 !2.9NWB
10131: 27d0:       !                                                                       !2.9NWB
10132: 27d0:       REC.CHECK$(11)  = "A"+CHR$(2) + "A"+CHR$(14)                            !2.9NWB
10133: 2813:       REC.CHECK$(12)  = "A"+CHR$(2) + "A"+CHR$(13) + "A"+CHR$(4)              !2.9NWB
10134: 286c:       REC.CHECK$(13)  = "A"+CHR$(2) + "A"+CHR$(5) + "A"+CHR$(4)               !2.9NWB
10135: 28c5: 
10136: 28c5:       ! ASN (M)                                                               !2.9NWB
10137: 28c5:       !                                                                       !2.9NWB
10138: 28c5:       ! aa                                                                    !2.9NWB
10139: 28c5:       !                                                                       !2.9NWB
10140: 28c5:       REC.CHECK$(14)  = "A"+CHR$(2)                                           !2.9NWB
10141: 28f2: 
10142: 28f2:       ! ASN Carton EOT (N)                                                    !2.9NWB
10143: 28f2:       !                                                                       !2.9NWB
10144: 28f2:       ! aa + aaaaa                                                            !2.9NWB
10145: 28f2:       !                                                                       !2.9NWB
10146: 28f2:       REC.CHECK$(15)  = "A"+CHR$(2) + "A"+CHR$(5)                             !2.9NWB
10147: 2935: 
10148: 2935:       ! Price Check header received (O)
10149: 2935:       !
10150: 2935:       ! aa + nnnnnn
10151: 2935:       !
10152: 2935:       REC.CHECK$(16) = "A"+CHR$(2) + "N"+CHR$(6)                       ! DJAL
10153: 2978: 
10154: 2978:       ! Price check record received (P)
10155: 2978:       !
10156: 2978:       ! aa + nnnnnnnnnnnnn + aaaaaa
10157: 2978:       !
10158: 2978:       REC.CHECK$(17) = "A"+CHR$(2) + "N"+CHR$(13) + "A"+CHR$(6)        ! DJAL
10159: 29d1: 
10160: 29d1:       ! Price Check trailer received (Q)
10161: 29d1:       !
10162: 29d1:       ! aa + nnnnnn + nnn
10163: 29d1:       !
10164: 29d1:       REC.CHECK$(18) = "A"+CHR$(2) + "N"+CHR$(6) + "N"+CHR$(3)        ! DJAL
10165: 2a2a: 
10166: 2a2a:       ! Check/Request version of program (R)
10167: 2a2a:       !
10168: 2a2a:       ! aa + nnn + nnnnnn
10169: 2a2a:       !
10170: 2a2a:       REC.CHECK$(19) = "A"+CHR$(3) + "N"+CHR$(2) + "N"+CHR$(6)         ! HDS
10171: 2a83: 
10172: 2a83:       ! Program trailer (S)
10173: 2a83:       !
10174: 2a83:       ! aa + nnn + nnnnnn + nnnnnn
10175: 2a83:       !
10176: 2a83:       REC.CHECK$(20) = "A"+CHR$(5) + "N"+CHR$(6) + "N"+CHR$(5)         ! HDS
10177: 2adc: 
10178: 2adc:       ! Direct order request (T)
10179: 2adc:       !
10180: 2adc:       !           aa + nn + nnnnnn + variable portion
10181: 2adc:       !
10182: 2adc:       !           The direct order request record is variable length.
10183: 2adc:       !           PSS37 module 2 sets up the validation string after
10184: 2adc:       !           determining the length of the LDT record.
10185: 2adc:       !
10186: 2adc: 
10187: 2adc:       ! Direct file header (U)
10188: 2adc:       !
10189: 2adc:       ! aa + nn + nnnnnn + nn
10190: 2adc:       !
10191: 2adc:       REC.CHECK$(22) = "A"+CHR$(2) + "N"+CHR$(2) + "N"+CHR$(6) +      \ HDS
10192: 2b4b:                        "N"+CHR$(2)                                    ! HDS
10193: 2b4b: 
10194: 2b4b:       ! Direct order header (V)
10195: 2b4b:       !
10196: 2b4b:       ! aa + nnnnnn + nnnn + a + nnnn + nnnn + nnnn
10197: 2b4b:       !
10198: 2b4b:       REC.CHECK$(23) = "A"+CHR$(2) + "N"+CHR$(6) + "N"+CHR$(4) +      \ HDS
10199: 2bfc:                        "A"+CHR$(1) + "N"+CHR$(4) + "N"+CHR$(4) +      \ HDS
10200: 2bfc:                        "N"+CHR$(4)                                    ! HDS
10201: 2bfc: 
10202: 2bfc: 
10203: 2bfc:       ! Direct order detail (W)
10204: 2bfc:       !
10205: 2bfc:       ! aa + nn + a + nnnnnnnnnnnnn + nnnn + nnnn + nnnn
10206: 2bfc:       !
10207: 2bfc:       REC.CHECK$(24) = "A"+CHR$(2) + "N"+CHR$(2) + "A"+CHR$(1) +      \ HDS
10208: 2cad:                        "A"+CHR$(13) + "N"+CHR$(4) + "N"+CHR$(4) +     \ HDS
10209: 2cad:                        "N"+CHR$(4)                                    ! HDS
10210: 2cad: 
10211: 2cad:       ! Direct order trailer (X)
10212: 2cad:       !
10213: 2cad:       ! aa
10214: 2cad:       !
10215: 2cad:       REC.CHECK$(25) = "A"+CHR$(2)                                    ! HDS
10216: 2cda: 
10217: 2cda:       ! Direct file trailer (Y)
10218: 2cda:       !
10219: 2cda:       ! aa + nn + nnnnnn + nn
10220: 2cda:       !
10221: 2cda:       REC.CHECK$(26) = "A"+CHR$(2) + "N"+CHR$(2) + "N"+CHR$(6) +      \ HDS
10222: 2d49:                        "N"+CHR$(2)                                    ! HDS
10223: 2d49: 
10224: 2d49:       ! DIRECT EOT record (Z)
10225: 2d49:       !
10226: 2d49:       ! aa
10227: 2d49:       !
10228: 2d49:       REC.CHECK$(27) = "A"+CHR$(2)                                    ! HDS
10229: 2d76: 
10230: 2d76:       ! UOD File Header (a)                                           ! LLC
10231: 2d76:       !
10232: 2d76:       ! aa + nn + nnnnnn + nnnn
10233: 2d76:       !
10234: 2d76:       REC.CHECK$(28) = "A" +CHR$(2) + "N" +CHR$(2) + "N" +CHR$(6) +   \ LLC
10235: 2de5:                        "N" +CHR$(4)                                   ! LLC
10236: 2de5: 
10237: 2de5:       ! UOD Header (b)                                                ! LLC
10238: 2de5:       !
10239: 2de5:       ! aa + nnnnnnnnnnnnnn + a + nnnn                                ! LLC
10240: 2de5:       !
10241: 2de5:       REC.CHECK$(29) = "A" +CHR$(2) + "N" +CHR$(14) + "A" +CHR$(1) +  \ LLC
10242: 2e54:                        "N" +CHR$(4)                                   ! LLC
10243: 2e54: 
10244: 2e54:       ! UOD Detail (c)                                                ! LLC
10245: 2e54:       !
10246: 2e54:       ! aa + a + nnnnnnnnnnnnn + nnnn                                 ! LLC
10247: 2e54:       !
10248: 2e54:       REC.CHECK$(30) = "A" +CHR$(2) + "A" +CHR$(1) + "N" +CHR$(13) +  \ LLC
10249: 2ec3:                        "N" +CHR$(4)                                   ! LLC
10250: 2ec3: 
10251: 2ec3:       ! UOD Trailer (d)                                               ! LLC
10252: 2ec3:       !
10253: 2ec3:       ! aa                                                            ! LLC
10254: 2ec3:       !
10255: 2ec3:       REC.CHECK$(31) = "A" +CHR$(2)                                   ! LLC
10256: 2ef0: 
10257: 2ef0:       ! UOD File Trailer (e)                                          ! LLC
10258: 2ef0:       !
10259: 2ef0:       ! aa + nn + nnnnnn + nnnn                                       ! LLC
10260: 2ef0:       !
10261: 2ef0:       REC.CHECK$(32) = "A" +CHR$(2) + "N" +CHR$(2) + "N" +CHR$(6) +   \ LLC
10262: 2f5f:                        "N" +CHR$(4)                                   ! LLC
10263: 2f5f: 
10264: 2f5f:       ! UOD EOT (f)                                                   ! LLC
10265: 2f5f:       !
10266: 2f5f:       ! aa                                                            ! LLC
10267: 2f5f:       !
10268: 2f5f:       REC.CHECK$(33) = "A" +CHR$(2)                                   ! LLC
10269: 2f8c: 
10270: 2f8c:       ! RETURNS FILE ID (g)                                           ! MMJK
10271: 2f8c:       !                                                               ! MMJK
10272: 2f8c:       ! aa + nnnnnnnn + nnnnnnnnnnnn + a                              ! MMJK ! 2.3JAS
10273: 2f8c:       !                                                               ! MMJK
10274: 2f8c:       REC.CHECK$(34) = "A"+CHR$(2) + "N"+CHR$(8) + "N"+CHR$(12) +     \ MMJK ! 2.3JAS
10275: 2ffb:                        "A"+CHR$(1)                                    ! 2.3JAS
10276: 2ffb: 
10277: 2ffb:       ! RETURNS FILE HEADER (h)                                       ! MMJK
10278: 2ffb:       !                                                               ! MMJK
10279: 2ffb:       ! aa + nnnn                                                     ! MMJK
10280: 2ffb:       !                                                               ! MMJK
10281: 2ffb:       REC.CHECK$(35) = "A"+CHR$(2) + "N"+CHR$(4)                      ! MMJK
10282: 303e: 
10283: 303e:       ! RETURNS UOD HEADER (i)                                        ! MMJK
10284: 303e:       !                                                               ! MMJK
10285: 303e:       ! aa + nnnnnnnn + nnnnnnnnnnnnnn + a + a + nnnn + nnnn + a      ! MMJK
10286: 303e:       !    + nnnnnn + nnnnnn + nnnnnn + a + a + aaaaaaaa              ! MMJK
10287: 303e:       !    + aaaaaaaaaaaaaaa + aaaaaaaaaaaaaaa + n + n + aaaaaaaa     ! MMJK
10288: 303e:       !    + nn + nnnn + n + a + n + n                                ! MMJK
10289: 303e:       !                                                               ! MMJK
10290: 303e:       REC.CHECK$(36) = "A"+CHR$(2) + "N"+CHR$(8) + "N"+CHR$(14) +     \ MMJK
10291: 3291:                        "A"+CHR$(1) + "A"+CHR$(1) + "N"+CHR$(4) +      \ MMJK
10292: 3291:                        "N"+CHR$(4) + "A"+CHR$(1) + "N"+CHR$(6) +      \ MMJK
10293: 3291:                        "N"+CHR$(6) + "N"+CHR$(6) + "A"+CHR$(1) +      \ MMJK
10294: 3291:                        "A"+CHR$(1) + "A"+CHR$(1) + "A"+CHR$(8) +      \ MMJK
10295: 3291:                        "A"+CHR$(15) + "A"+CHR$(15) + "N"+CHR$(1) +    \ MMJK
10296: 3291:                        "N"+CHR$(1) + "A"+CHR$(8) + "N"+CHR$(2) +      \ MMJK
10297: 3291:                        "N"+CHR$(4) + "N"+CHR$(1) + "A"+CHR$(1) +      \ MMJK
10298: 3291:                        "N"+CHR$(1) + "N"+CHR$(1)                      ! MMJK
10299: 3291: 
10300: 3291:       ! RETURNS ITEM DETAIL (j)                                       ! MMJK
10301: 3291:       !                                                               ! MMJK
10302: 3291:       ! aa + a + a + nnnnnnnnnnnnn + nnnn                             ! NMJK
10303: 3291:       !                                                               ! MMJK
10304: 3291:       REC.CHECK$(37) = "A"+CHR$(2) + "A"+CHR$(1) + "A"+CHR$(1) +      \ MMJK
10305: 3316:                        "N"+CHR$(13) + "N"+CHR$(4)                     ! NMJK
10306: 3316: 
10307: 3316:       ! RETURNS UOD TRAILER (k)                                       ! MMJK
10308: 3316:       !                                                               ! MMJK
10309: 3316:       ! aa                                                            ! MMJK
10310: 3316:       !                                                               ! MMJK
10311: 3316:       REC.CHECK$(38) = "A"+CHR$(2)                                    ! MMJK
10312: 3343: 
10313: 3343:       ! RETURNS FILE TRAILER (l)                                      ! MMJK
10314: 3343:       !                                                               ! MMJK
10315: 3343:       ! aa + nnnnnnnnnnnn                                             ! MMJK
10316: 3343:       !                                                               ! MMJK
10317: 3343:       REC.CHECK$(39) = "A"+CHR$(2) + "N"+CHR$(12)                     ! MMJK
10318: 3386: 
10319: 3386:       ! RETURNS FILE REQUEST (m)                                      ! MMJK
10320: 3386:       !                                                               ! MMJK
10321: 3386:       ! aa + a                                                        ! MMJK
10322: 3386:       !                                                               ! MMJK
10323: 3386:       REC.CHECK$(40) = "A"+CHR$(2) + "A"+CHR$(1)                      ! MMJK
10324: 33c9: 
10325: 33c9:       ! RETURNS FILE RECEIVED OK (n)                                  ! MMJK
10326: 33c9:       !                                                               ! MMJK
10327: 33c9:       ! aa                                                            ! MMJK
10328: 33c9:       !                                                               ! MMJK
10329: 33c9:       REC.CHECK$(41) = "A"+CHR$(2)                                    ! MMJK
10330: 33f6: 
10331: 33f6:       ! RETURNS EOT (o)                                               ! MMJK
10332: 33f6:       !                                                               ! MMJK
10333: 33f6:       ! aa                                                            ! MMJK
10334: 33f6:       !                                                               ! MMJK
10335: 33f6:       REC.CHECK$(42) = "A"+CHR$(2)                                    ! MMJK
10336: 3423: 
10337: 3423:       ! STOCKTAKE HEADER (p)                                          ! 1.5
10338: 3423:       !                                                               ! 1.5
10339: 3423:       ! aa + aaaaaaaaaaaa                                             ! 1.5
10340: 3423:       !                                                               ! 1.5
10341: 3423:       REC.CHECK$(43) = "A"+CHR$(2) + "A"+CHR$(12)                     ! 1.5
10342: 3466: 
10343: 3466:       ! STOCKTAKE DETAIL (q)                                          ! 1.5
10344: 3466:       !                                                               ! 1.5
10345: 3466:       ! aa + aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa                          ! 1.6
10346: 3466:       !                                                               ! 1.5
10347: 3466:       REC.CHECK$(44) = "A"+CHR$(2) + "A"+CHR$(30)                     ! 1.6
10348: 34a9: 
10349: 34a9:       ! STOCKTAKE TRAILER (r)                                         ! 1.5
10350: 34a9:       !                                                               ! 1.5
10351: 34a9:       ! aa + aaaaaaaaaaaa                                             ! 1.5
10352: 34a9:       !                                                               ! 1.5
10353: 34a9:       REC.CHECK$(45) = "A"+CHR$(2) + "A"+CHR$(12)                     ! 1.5
10354: 34ec: 
10355: 34ec:       ! STOCKCOUNT HEADER (s)                                         ! 2.1BG
10356: 34ec:       !                                                               ! 2.1BG
10357: 34ec:       ! aa + aaaaaaaaaaaaa + aaaa                                     ! 2.1BG
10358: 34ec:       !                                                               ! 2.1BG
10359: 34ec:       REC.CHECK$(46) = "A"+CHR$(2) + "A"+CHR$(13) + "A"+CHR$(4)       ! 2.1BG
10360: 3545: 
10361: 3545:       ! STOCKCOUNT DETAIL (t)                                         ! 2.1BG
10362: 3545:       !                                                               ! 2.1BG
10363: 3545:       ! aa + aaaaaaaaaaaaa + aaaa                                     ! 2.1BG
10364: 3545:       !                                                               ! 2.1BG
10365: 3545:       REC.CHECK$(47) = "A"+CHR$(2) + "A"+CHR$(13) + "A"+CHR$(4)       ! 2.1BG
10366: 359e: 
10367: 359e:       ! STOCKCOUNT TRAILER (u)                                        ! 2.1BG
10368: 359e:       !                                                               ! 2.1BG
10369: 359e:       ! aa + aaaaaaaaaaaaa + aaaa                                     ! 2.1BG
10370: 359e:       !                                                               ! 2.1BG
10371: 359e:       REC.CHECK$(48) = "A"+CHR$(2) + "A"+CHR$(13) + "A"+CHR$(4)       ! 2.1BG
10372: 35f7: 
10373: 35f7:       ! STOCKCOUNT EOT (v)                                            ! 2.1BG
10374: 35f7:       !                                                               ! 2.1BG
10375: 35f7:       ! aa                                                            ! 2.1BG
10376: 35f7:       !                                                               ! 2.1BG
10377: 35f7:       REC.CHECK$(49) = "A"+CHR$(2)                                    ! 2.1BG
10378: 3624: 
10379: 3624:       ! PHARMACY HEADER (w)                                           ! 2.2JAS
10380: 3624:       !                                                               ! 2.2JAS
10381: 3624:       ! aa + aaaa + aaaa + aaaaaa + aaaaaa + a + a                    ! 2.2JAS
10382: 3624:       !                                                               ! 2.2JAS
10383: 3624:       REC.CHECK$(50) = "A"+CHR$(2) + "A"+CHR$(4) + "A"+CHR$(4) +      \ 2.2JAS
10384: 36d5:                        "A"+CHR$(6) + "A"+CHR$(6) + "A"+CHR$(1) +      \ 2.2JAS
10385: 36d5:                        "A"+CHR$(1)                                    ! 2.2JAS
10386: 36d5: 
10387: 36d5:       ! PHARMACY DETAIL (x)                                           ! 2.2JAS
10388: 36d5:       !                                                               ! 2.2JAS
10389: 36d5:       ! aa + aaaaaaaaaaaaa + a + aaaaaa + aaaa                        ! 2.2JAS
10390: 36d5:       !                                                               ! 2.2JAS
10391: 36d5:       REC.CHECK$(51) = "A"+CHR$(2) + "A"+CHR$(13) + "A"+CHR$(1) +     \ 2.2JAS
10392: 375a:                        "A"+CHR$(6) + "A"+CHR$(4)                      ! 2.2JAS
10393: 375a: 
10394: 375a:       ! PHARMACY TRAILER (y)                                          ! 2.2JAS
10395: 375a:       !                                                               ! 2.2JAS
10396: 375a:       ! aa + aaaa                                                     ! 2.2JAS
10397: 375a:       !                                                               ! 2.2JAS
10398: 375a:       REC.CHECK$(52) = "A"+CHR$(2) + "A"+CHR$(4)                      ! 2.2JAS
10399: 379d: 
10400: 379d:       ! PHARMACY EOT (z)                                              ! 2.2JAS
10401: 379d:       !                                                               ! 2.2JAS
10402: 379d:       ! aa                                                            ! 2.2JAS
10403: 379d:       !                                                               ! 2.2JAS
10404: 379d:       REC.CHECK$(53) = "A"+CHR$(2)                                    ! 2.2JAS
10405: 37ca: 
10406: 37ca:       ! Price check record received (P)                                                     ! 2.5CS !2.6BG
10407: 37ca:       ! This is a duplicate of data state P because need two record layouts for the                 !2.6BG
10408: 37ca:       ! two versions. The original Data State P (type 17) can be replaced with this                 !2.6BG
10409: 37ca:       ! long term.                                                                                  !2.6BG
10410: 37ca:       !                                                                                             !2.6BG
10411: 37ca:       ! aa + nnnnnnnnnnnnn + aaaaaa + aaa + aaa                                             ! 2.5CS !2.6BG
10412: 37ca:       !                                                                                             !2.6BG
10413: 37ca:       REC.CHECK$(54) = "A"+CHR$(2) + "N"+CHR$(13) + "A"+CHR$(6) + "A"+CHR$(3) + "A"+CHR$(3) ! 2.5CS !2.6BG
10414: 384f:       
10415: 384f:       ! RECALL REQUEST (1)                                            ! 2.10BG
10416: 384f:       !                                                               ! 2.10BG
10417: 384f:       ! aa + aaaaaaaa                                                 ! 2.10BG
10418: 384f:       !                                                               ! 2.10BG
10419: 384f:       REC.CHECK$(55) = "A"+CHR$(2) + "A"+CHR$(8)                      ! 2.10BG
10420: 3892:       
10421: 3892:       ! RECALL RECEIVED OK (2)                                        ! 2.10BG
10422: 3892:       !                                                               ! 2.10BG
10423: 3892:       ! aa                                                            ! 2.10BG
10424: 3892:       !                                                               ! 2.10BG
10425: 3892:       REC.CHECK$(56) = "A"+CHR$(2)                                    ! 2.10BG
10426: 38bf:       
10427: 38bf:       ! RECALL HEADER (3)                                             ! 2.10BG
10428: 38bf:       !                                                               ! 2.10BG
10429: 38bf:       ! aa + aaaaaaaa + aaaaaaaaaaaaaa + a                            ! 2.10BG
10430: 38bf:       !                                                               ! 2.10BG
10431: 38bf:       REC.CHECK$(57) = "A"+CHR$(2) + "A"+CHR$(8) + "A"+CHR$(14) + \   ! 2.10BG
10432: 392e:                        "A"+CHR$(1)                                    ! 2.10BG
10433: 392e:       
10434: 392e:       ! RECALL DETAIL (4)                                             ! 2.10BG
10435: 392e:       !                                                               ! 2.10BG
10436: 392e:       ! aa + aaaaaaa + aaaa                                           ! 2.10BG
10437: 392e:       !                                                               ! 2.10BG
10438: 392e:       REC.CHECK$(58) = "A"+CHR$(2) + "A"+CHR$(7) + "A"+CHR$(4)        ! 2.10BG
10439: 3987:       
10440: 3987:       ! RECALL TRAILER (5)                                            ! 2.10BG
10441: 3987:       !                                                               ! 2.10BG
10442: 3987:       ! aa + aaaaa + aaaa                                             ! 2.10BG
10443: 3987:       !                                                               ! 2.10BG
10444: 3987:       REC.CHECK$(59) = "A"+CHR$(2) + "A"+CHR$(5) + "A"+CHR$(4)        ! 2.10BG
10445: 39e0:       
10446: 39e0:       ! RECALL EOT (6)                                                ! 2.10BG
10447: 39e0:       !                                                               ! 2.10BG
10448: 39e0:       ! aa + A                                                        ! 2.10BG
10449: 39e0:       !                                                               ! 2.10BG
10450: 39e0:       REC.CHECK$(60) = "A"+CHR$(2) + "A"+CHR$(1)                      ! 2.10BG
10451: 3a23: 
10452: 3a23:       ! +UOD recs 
10453: 3a23:       REC.CHECK$(61) = "A"+CHR$(2) + "N"+CHR$(6)                !"TA" ! 2.12SH
10454: 3a66:       REC.CHECK$(62) = "A"+CHR$(2)                              !"TF" ! 2.12SH
10455: 3a93:       REC.CHECK$(63) = "A"+CHR$(2) + "N"+CHR$(3)                !"TI" ! 2.12SH
10456: 3ad6:       REC.CHECK$(64) = "A"+CHR$(2) + "N"+CHR$(28) + "A"+CHR$(1) !"TJ" ! 2.12SH
10457: 3b2f:       REC.CHECK$(65) = "A"+CHR$(2) + "N"+CHR$(8)                !"TK" ! 2.12SH
10458: 3b72:       REC.CHECK$(66) = "A"+CHR$(2) + "N"+CHR$(8) + "A"+CHR$(1) +\     ! 2.12SH
10459: 3be1:                        "N"+CHR$(5)                              !"TL" ! 2.12SH
10460: 3be1:       REC.CHECK$(67) = "A"+CHR$(2)                              !"TZ" ! 2.12SH
10461: 3c0e: 
10462: 3c0e:       DIM REQ.LIST.STORE$(50),          \ List of requested lists
10463: 3c3d:           REQ.LIST.DATA$(50),           \ Data associated with above lists
10464: 3c6c:           LIST.TRANSMIT$(500),          \ Lists to be transmitted to PDT
10465: 3c9c:           BC.CHECK%(26),                \ Business Centre 'done' flags
10466: 3ccb:           BAR.CODES$(2)                 ! Temp. Bar code store
10467: 3cfa: 
10468: 3cfa:       GOSUB LOAD.APPLICATION.TABLE                                      ! HDS
10469: 3d0c: 
10470: 3d0c:       SB.ACTION$ = "O"
10471: 3d21: 
10472: 3d21:       CSR.AUDIT.FILE$ = "CSRAF"                                         ! EPAB
10473: 3d38:       CSR.AUDIT.SESS.NUM% = 255                                         ! EPAB
10474: 3d49: 
10475: 3d49:       SB.INTEGER% = CSR.AUDIT.SESS.NUM%                                 ! EPAB
10476: 3d5b:       SB.STRING$ = CSR.AUDIT.FILE$                                      ! EPAB
10477: 3d77:       GOSUB SB.FILE.UTILS                                               ! EPAB
10478: 3d89:       CSR.AUDIT.SESS.NUM% = SB.FILE.SESS.NUM%                           ! EPAB
10479: 3d9c: 
10480: 3d9c:       SB.INTEGER% = GAPBF.REPORT.NUM%                                   ! 1.3 !2.5CS !2.6BG
10481: 3dae:       SB.STRING$ = GAPBF.FILE.NAME$                                     ! 1.3 !2.5CS !2.6BG
10482: 3dca:       GOSUB SB.FILE.UTILS                                               ! 1.3 !2.5CS !2.6BG
10483: 3ddc:       GAPBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.3 !2.5CS !2.6BG
10484: 3dee: 
10485: 3dee:       SB.INTEGER% = PLLOL.REPORT.NUM%                                   !2.5CS
10486: 3e00:       SB.STRING$ = PLLOL.FILE.NAME$                                     !2.5CS
10487: 3e1c:       GOSUB SB.FILE.UTILS                                               !2.5CS
10488: 3e2e:       PLLOL.SESS.NUM% = SB.FILE.SESS.NUM%                               !2.5CS
10489: 3e41: 
10490: 3e41:       SB.INTEGER% = PLLDB.REPORT.NUM%                                   !2.5CS
10491: 3e53:       SB.STRING$ = PLLDB.FILE.NAME$                                     !2.5CS
10492: 3e6f:       GOSUB SB.FILE.UTILS                                               !2.5CS
10493: 3e81:       PLLDB.SESS.NUM% = SB.FILE.SESS.NUM%                               !2.5CS
10494: 3e94: 
10495: 3e94:       SB.INTEGER% = BCSMF.REPORT.NUM%
10496: 3ea6:       SB.STRING$ = BCSMF.FILE.NAME$
10497: 3ec2:       GOSUB SB.FILE.UTILS
10498: 3ed4:       BCSMF.SESS.NUM% = SB.FILE.SESS.NUM%
10499: 3ee7: 
10500: 3ee7:       SB.INTEGER% = CCUOD.REPORT.NUM%                                   ! MMJK
10501: 3ef9:       SB.STRING$ = CCUOD.FILE.NAME$                                     ! MMJK
10502: 3f15:       GOSUB SB.FILE.UTILS                                               ! MMJK
10503: 3f27:       CCUOD.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10504: 3f3a: 
10505: 3f3a:       SB.INTEGER% = CCLAM.REPORT.NUM%                                   ! 1.4
10506: 3f4c:       SB.STRING$ = CCLAM.FILE.NAME$                                     ! 1.4
10507: 3f68:       GOSUB SB.FILE.UTILS                                               ! 1.4
10508: 3f7a:       CCLAM.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.4
10509: 3f8d: 
10510: 3f8d:       SB.INTEGER% = EPSOM.REPORT.NUM%                                   ! DJAL
10511: 3f9f:       SB.STRING$ = EPSOM.FILE.NAME$                                     ! DJAL
10512: 3fbb:       GOSUB SB.FILE.UTILS                                               ! DJAL
10513: 3fcd:       EPSOM.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL
10514: 3fe0: 
10515: 3fe0:       SB.INTEGER% = CCITM.REPORT.NUM%                                   ! MMJK
10516: 3ff2:       SB.STRING$ = CCITM.FILE.NAME$                                     ! MMJK
10517: 400e:       GOSUB SB.FILE.UTILS                                               ! MMJK
10518: 4020:       CCITM.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10519: 4033: 
10520: 4033:       SB.INTEGER% = CCTRL.REPORT.NUM%                                   ! MMJK
10521: 4045:       SB.STRING$ = CCTRL.FILE.NAME$                                     ! MMJK
10522: 4061:       GOSUB SB.FILE.UTILS                                               ! MMJK
10523: 4073:       CCTRL.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10524: 4086: 
10525: 4086:       SB.INTEGER% = CCDMY.REPORT.NUM%                                   ! MMJK
10526: 4098:       SB.STRING$ = CCDMY.FILE.NAME$                                     ! MMJK
10527: 40b4:       GOSUB SB.FILE.UTILS                                               ! MMJK
10528: 40c6:       CCDMY.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10529: 40d9: 
10530: 40d9:       SB.INTEGER% = CCTMP.REPORT.NUM%                                   ! MMJK
10531: 40eb:       SB.STRING$ = CCTMP.FILE.NAME$                                     ! MMJK
10532: 4107:       GOSUB SB.FILE.UTILS                                               ! MMJK
10533: 4119:       CCTMP.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10534: 412c: 
10535: 412c:       SB.INTEGER% = CCBUF.REPORT.NUM%                                   ! MMJK
10536: 413e:       SB.STRING$ = CCBUF.FILE.NAME$                                     ! MMJK
10537: 415a:       GOSUB SB.FILE.UTILS                                               ! MMJK
10538: 416c:       CCBUF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10539: 417f: 
10540: 417f:       SB.INTEGER% = CCUPF.REPORT.NUM%                                   ! NMJK
10541: 4191:       SB.STRING$ = CCUPF.FILE.NAME$                                     ! NMJK
10542: 41ad:       GOSUB SB.FILE.UTILS                                               ! NMJK
10543: 41bf:       CCUPF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! NMJK
10544: 41d2: 
10545: 41d2:       SB.INTEGER% = CCWKF.REPORT.NUM%                                   ! MMJK
10546: 41e4:       SB.STRING$ = CCWKF.FILE.NAME$                                     ! MMJK
10547: 4200:       GOSUB SB.FILE.UTILS                                               ! MMJK
10548: 4212:       CCWKF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10549: 4225: 
10550: 4225:       SB.INTEGER% = LDTAF.REPORT.NUM%                                   ! MMJK
10551: 4237:       SB.STRING$ = LDTAF.FILE.NAME$                                     ! MMJK
10552: 4253:       GOSUB SB.FILE.UTILS                                               ! MMJK
10553: 4265:       LDTAF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10554: 4278: 
10555: 4278:       SB.INTEGER% = CHKBF.REPORT.NUM%                                   ! DSW
10556: 428a:       SB.STRING$ = CHKBF.FILE.NAME$                                     ! DSW
10557: 42a6:       GOSUB SB.FILE.UTILS                                               ! DSW
10558: 42b8:       CHKBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DSW
10559: 42ca: 
10560: 42ca: \     SB.INTEGER% = CSR.REPORT.NUM%                                     ! DJAL!2.9NWB
10561: 42ca: \     SB.STRING$ = CSR.FILE.NAME$                                       ! DJAL!2.9NWB
10562: 42ca: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
10563: 42ca: \     CSR.SESS.NUM% = SB.FILE.SESS.NUM%                                 ! DJAL!2.9NWB
10564: 42ca: 
10565: 42ca: \     SB.INTEGER% = CITEM.REPORT.NUM%                                   ! DJAL!2.9NWB
10566: 42ca: \     SB.STRING$ = CITEM.FILE.NAME$                                     ! DJAL!2.9NWB
10567: 42ca: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
10568: 42ca: \     CITEM.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL!2.9NWB
10569: 42ca: 
10570: 42ca: \     SB.INTEGER% = CSRBF.REPORT.NUM%                                   ! DJAL!2.9NWB
10571: 42ca: \     SB.STRING$ = CSRBF.FILE.NAME$                                     ! DJAL!2.9NWB
10572: 42ca: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
10573: 42ca: \     CSRBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL!2.9NWB
10574: 42ca: 
10575: 42ca: \     SB.INTEGER% = CSRWF.REPORT.NUM%                                   ! DJAL!2.9NWB
10576: 42ca: \     SB.STRING$ = CSRWF.FILE.NAME$                                     ! DJAL!2.9NWB
10577: 42ca: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
10578: 42ca: \     CSRWF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL!2.9NWB
10579: 42ca: 
10580: 42ca: !     SB.INTEGER% = FPF.REPORT.NUM%                                     ! DJAL
10581: 42ca: !     SB.STRING$ = FPF.FILE.NAME$                                       ! DJAL
10582: 42ca: !     GOSUB SB.FILE.UTILS                                               ! DJAL
10583: 42ca: !     FPF.SESS.NUM% = SB.FILE.SESS.NUM%                                 ! DJAL
10584: 42ca: 
10585: 42ca:       SB.INTEGER% = IDF.REPORT.NUM%
10586: 42dc:       SB.STRING$ = IDF.FILE.NAME$
10587: 42f8:       GOSUB SB.FILE.UTILS
10588: 430a:       IDF.SESS.NUM% = SB.FILE.SESS.NUM%
10589: 431d: 
10590: 431d: 
10591: 431d:       SB.INTEGER% = IEF.REPORT.NUM%
10592: 432f:       SB.STRING$ = IEF.FILE.NAME$
10593: 434b:       GOSUB SB.FILE.UTILS
10594: 435d:       IEF.SESS.NUM% = SB.FILE.SESS.NUM%
10595: 4370: 
10596: 4370:       SB.INTEGER% = IRF.REPORT.NUM%
10597: 4382:       SB.STRING$ = IRF.FILE.NAME$
10598: 439e:       GOSUB SB.FILE.UTILS
10599: 43b0:       IRF.SESS.NUM% = SB.FILE.SESS.NUM%
10600: 43c3: 
10601: 43c3: !     SB.INTEGER% = ONORD.REPORT.NUM%                                   ! DJAL
10602: 43c3: !     SB.STRING$ = ONORD.FILE.NAME$                                     ! DJAL
10603: 43c3: !     GOSUB SB.FILE.UTILS                                               ! DJAL
10604: 43c3: !     ONORD.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL
10605: 43c3: 
10606: 43c3:       SB.INTEGER% = PCHK.REPORT.NUM%                                    ! DJAL
10607: 43d5:       SB.STRING$ = PCHK.FILE.NAME$                                      ! DJAL
10608: 43f1:       GOSUB SB.FILE.UTILS                                               ! DJAL
10609: 4403:       PCHK.SESS.NUM% = SB.FILE.SESS.NUM%                                ! DJAL
10610: 4416: 
10611: 4416:       SB.INTEGER% = PDTWF.REPORT.NUM%
10612: 4428:       SB.STRING$ = PDTWF.FILE.NAME$
10613: 4444:       GOSUB SB.FILE.UTILS
10614: 4456:       PDTWF.SESS.NUM% = SB.FILE.SESS.NUM%
10615: 4469: 
10616: 4469:       SB.INTEGER% = PIITM.REPORT.NUM%
10617: 447c:       SB.STRING$ = PIITM.FILE.NAME$
10618: 4498:       GOSUB SB.FILE.UTILS
10619: 44aa:       PIITM.SESS.NUM% = SB.FILE.SESS.NUM%
10620: 44bc: 
10621: 44bc:       SB.INTEGER% = PILST.REPORT.NUM%
10622: 44cf:       SB.STRING$ = PILST.FILE.NAME$
10623: 44eb:       GOSUB SB.FILE.UTILS
10624: 44fd:       PILST.SESS.NUM% = SB.FILE.SESS.NUM%
10625: 450f: 
10626: 450f:       SB.INTEGER% = PIPEI.REPORT.NUM%
10627: 4522:       SB.STRING$ = PIPEI.FILE.NAME$
10628: 453e:       GOSUB SB.FILE.UTILS
10629: 4550:       PIPEI.SESS.NUM% = SB.FILE.SESS.NUM%
10630: 4562: 
10631: 4562:       SB.INTEGER% = PIPEO.REPORT.NUM%
10632: 4575:       SB.STRING$ = PIPEO.FILE.NAME$
10633: 4591:       GOSUB SB.FILE.UTILS
10634: 45a3:       PIPEO.SESS.NUM% = SB.FILE.SESS.NUM%
10635: 45b5: 
10636: 45b5:       SB.INTEGER% = SOFTS.REPORT.NUM%                                   ! MMJK
10637: 45c7:       SB.STRING$ = SOFTS.FILE.NAME$                                     ! MMJK
10638: 45e3:       GOSUB SB.FILE.UTILS                                               ! MMJK
10639: 45f5:       SOFTS.SESS.NUM% = SB.FILE.SESS.NUM%                               ! MMJK
10640: 4608: 
10641: 4608:       SB.INTEGER% = STKMQ.REPORT.NUM%
10642: 461a:       SB.STRING$ = STKMQ.FILE.NAME$
10643: 4636:       GOSUB SB.FILE.UTILS
10644: 4648:       STKMQ.SESS.NUM% = SB.FILE.SESS.NUM%
10645: 465b: 
10646: 465b:       SB.INTEGER% = UNITS.REPORT.NUM%                                   ! DJAL
10647: 466d:       SB.STRING$ = UNITS.FILE.NAME$                                     ! DJAL
10648: 4689:       GOSUB SB.FILE.UTILS                                               ! DJAL
10649: 469b:       UNITS.SESS.NUM% = SB.FILE.SESS.NUM%                               ! DJAL
10650: 46ae: 
10651: 46ae:       SB.INTEGER% = DIRORD.REPORT.NUM%                                  ! HDS
10652: 46c0:       SB.STRING$ = DIRORD.FILE.NAME$                                    ! HDS
10653: 46dc:       GOSUB SB.FILE.UTILS                                               ! HDS
10654: 46ee:       DIRORD.SESS.NUM% = SB.FILE.SESS.NUM%                              ! HDS
10655: 4701: 
10656: 4701:       SB.INTEGER% = DIRSUP.REPORT.NUM%                                  ! HDS
10657: 4713:       SB.STRING$ = DIRSUP.FILE.NAME$                                    ! HDS
10658: 472f:       GOSUB SB.FILE.UTILS                                               ! HDS
10659: 4741:       DIRSUP.SESS.NUM% = SB.FILE.SESS.NUM%                              ! HDS
10660: 4754: 
10661: 4754:       SB.INTEGER% = DIRWF.REPORT.NUM%                                   ! HDS
10662: 4766:       SB.STRING$ = DIRWF.FILE.NAME$                                     ! HDS
10663: 4782:       GOSUB SB.FILE.UTILS                                               ! HDS
10664: 4794:       DIRWF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! HDS
10665: 47a7: 
10666: 47a7:       SB.INTEGER% = DIREC.REPORT.NUM%                                   ! HDS
10667: 47b9:       SB.STRING$ = DIREC.FILE.NAME$                                     ! HDS
10668: 47d5:       GOSUB SB.FILE.UTILS                                               ! HDS
10669: 47e7:       DIREC.SESS.NUM% = SB.FILE.SESS.NUM%                               ! HDS
10670: 47fa: 
10671: 47fa:       SB.INTEGER% = LDTCF.REPORT.NUM%                                   ! HDS
10672: 480c:       SB.STRING$ = LDTCF.FILE.NAME$                                     ! HDS
10673: 4828:       GOSUB SB.FILE.UTILS                                               ! HDS
10674: 483a:       LDTCF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! HDS
10675: 484d: 
10676: 484d:       SB.INTEGER% = PLDT.REPORT.NUM%                                    ! HDS
10677: 4860:       SB.STRING$ = PLDT.FILE.NAME$                                      ! HDS
10678: 487c:       GOSUB SB.FILE.UTILS                                               ! HDS
10679: 488e:       PLDT.SESS.NUM% = SB.FILE.SESS.NUM%                                ! HDS
10680: 48a0: 
10681: 48a0:       SB.INTEGER% = DRSMQ.REPORT.NUM%                                   ! HDS
10682: 48b2:       SB.STRING$ = DRSMQ.FILE.NAME$                                     ! HDS
10683: 48ce:       GOSUB SB.FILE.UTILS                                               ! HDS
10684: 48e0:       DRSMQ.SESS.NUM% = SB.FILE.SESS.NUM%                               ! HDS
10685: 48f3: 
10686: 48f3:       SB.INTEGER% = LDTBF.REPORT.NUM%                                   ! JLC
10687: 4905:       SB.STRING$ = LDTBF.FILE.NAME$                                     ! JLC
10688: 4921:       GOSUB SB.FILE.UTILS                                               ! JLC
10689: 4933:       LDTBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! JLC
10690: 4945: 
10691: 4945: !     SB.INTEGER% = IDSOF.REPORT.NUM%                                   ! JLC
10692: 4945: !     SB.STRING$ = IDSOF.FILE.NAME$                                     ! JLC
10693: 4945: !     GOSUB SB.FILE.UTILS                                               ! JLC
10694: 4945: !     IDSOF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! JLC
10695: 4945: 
10696: 4945:       SB.INTEGER% = UOD.REPORT.NUM%                                     ! LLC
10697: 4957:       SB.STRING$ = UOD.FILE.NAME$                                       ! LLC
10698: 4973:       GOSUB SB.FILE.UTILS                                               ! LLC
10699: 4985:       UOD.SESS.NUM% = SB.FILE.SESS.NUM%                                 ! LLC
10700: 4998: 
10701: 4998:       SB.INTEGER% = UODBF.REPORT.NUM%                                   ! LLC
10702: 49aa:       SB.STRING$ = UODBF.FILE.NAME$                                     ! LLC
10703: 49c6:       GOSUB SB.FILE.UTILS                                               ! LLC
10704: 49d8:       UODBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! LLC
10705: 49eb: 
10706: 49eb:       SB.INTEGER% = UODTF.REPORT.NUM%                                   ! LLC
10707: 49fd:       SB.STRING$ = UODTF.FILE.NAME$                                     ! LLC
10708: 4a19:       GOSUB SB.FILE.UTILS                                               ! LLC
10709: 4a2b:       UODTF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! LLC
10710: 4a3e: 
10711: 4a3e:       SB.INTEGER% = SXTCF.REPORT.NUM%                                   ! 1.5
10712: 4a50:       SB.STRING$ = SXTCF.FILE.NAME$                                     ! 1.5
10713: 4a6c:       GOSUB SB.FILE.UTILS                                               ! 1.5
10714: 4a7e:       SXTCF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.5
10715: 4a91: 
10716: 4a91:       SB.INTEGER% = STKBF.REPORT.NUM%                                   ! 1.5
10717: 4aa3:       SB.STRING$ = STKBF.FILE.NAME$                                     ! 1.5
10718: 4abf:       GOSUB SB.FILE.UTILS                                               ! 1.5
10719: 4ad1:       STKBF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.5
10720: 4ae4: 
10721: 4ae4:       SB.INTEGER% = SXTMP.REPORT.NUM%                                   ! 1.5
10722: 4af6:       SB.STRING$ = SXTMP.FILE.NAME$                                     ! 1.5
10723: 4b12:       GOSUB SB.FILE.UTILS                                               ! 1.5
10724: 4b24:       SXTMP.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.5
10725: 4b37: 
10726: 4b37:       SB.INTEGER% = STKTK.REPORT.NUM%                                   ! 1.5
10727: 4b49:       SB.STRING$ = STKTK.FILE.NAME$                                     ! 1.5
10728: 4b65:       GOSUB SB.FILE.UTILS                                               ! 1.5
10729: 4b77:       STKTK.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.5
10730: 4b8a: 
10731: 4b8a:       SB.INTEGER% = STLDT.REPORT.NUM%                                   ! 1.7
10732: 4b9c:       SB.STRING$ = STLDT.FILE.NAME$                                     ! 1.7
10733: 4bb8:       GOSUB SB.FILE.UTILS                                               ! 1.7
10734: 4bca:       STLDT.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.7
10735: 4bdd: 
10736: 4bdd: !      LSSST.FILE.NAME$ = "C:\LSSST" + MONITORED.PORT$ + ".BIN"          !1.8BG !2.7CS
10737: 4bdd: !      SB.INTEGER% = LSSST.REPORT.NUM%                                   !1.8BG !2.7CS
10738: 4bdd: !      SB.STRING$ = LSSST.FILE.NAME$                                     !1.8BG !2.7CS
10739: 4bdd: !      GOSUB SB.FILE.UTILS                                               !1.8BG !2.7CS
10740: 4bdd: !      LSSST.SESS.NUM% = SB.FILE.SESS.NUM%                               !1.8BG !2.7CS
10741: 4bdd: 
10742: 4bdd:       SB.INTEGER% = STOCK.REPORT.NUM%                                   !1.8BG
10743: 4bef:       SB.STRING$ = STOCK.FILE.NAME$                                     !1.8BG
10744: 4c0b:       GOSUB SB.FILE.UTILS                                               !1.8BG
10745: 4c1d:       STOCK.SESS.NUM% = SB.FILE.SESS.NUM%                               !1.8BG
10746: 4c30: 
10747: 4c30:       SB.INTEGER% = IMSTC.REPORT.NUM%                                   !1.8BG
10748: 4c42:       SB.STRING$ = IMSTC.FILE.NAME$                                     !1.8BG
10749: 4c5e:       GOSUB SB.FILE.UTILS                                               !1.8BG
10750: 4c70:       IMSTC.SESS.NUM% = SB.FILE.SESS.NUM%                               !1.8BG
10751: 4c83: 
10752: 4c83:       SB.INTEGER% = CB.REPORT.NUM%                                      ! 2.9NWB
10753: 4c95:       SB.STRING$ = CB.FILE.NAME$                                        ! 2.9NWB
10754: 4cb1:       GOSUB SB.FILE.UTILS                                               ! 2.9NWB
10755: 4cc3:       CB.SESS.NUM% = SB.FILE.SESS.NUM%                                  ! 2.9NWB
10756: 4cd6:       
10757: 4cd6:       SB.INTEGER% = RB.REPORT.NUM%                                      ! 2.10BG
10758: 4ce8:       SB.STRING$ = RB.FILE.NAME$                                        ! 2.10BG
10759: 4d04:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
10760: 4d16:       RB.SESS.NUM% = SB.FILE.SESS.NUM%                                  ! 2.10BG
10761: 4d29:       
10762: 4d29:       SB.INTEGER% = REWKF.REPORT.NUM%                                   ! 2.10BG
10763: 4d3b:       SB.STRING$ = REWKF.FILE.NAME$                                     ! 2.10BG
10764: 4d57:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
10765: 4d69:       REWKF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.10BG
10766: 4d7c:       
10767: 4d7c:       SB.INTEGER% = RECALLS.REPORT.NUM%                                 ! 2.10BG
10768: 4d8e:       SB.STRING$ = RECALLS.FILE.NAME$                                   ! 2.10BG
10769: 4daa:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
10770: 4dbc:       RECALLS.SESS.NUM% = SB.FILE.SESS.NUM%                             ! 2.10BG
10771: 4dcf: 
10772: 4dcf:       SB.INTEGER% = DELVINDX.REPORT.NUM%                                ! 2.12SH
10773: 4de1:       SB.STRING$ = DELVINDX.FILE.NAME$                                  ! 2.12SH
10774: 4dfd:       GOSUB SB.FILE.UTILS                                               ! 2.12SH
10775: 4e0f:       DELVINDX.SESS.NUM% = SB.FILE.SESS.NUM%                            ! 2.12SH
10776: 4e22: 
10777: 4e22:       SB.INTEGER% = AF.REPORT.NUM%                                      ! 2.12SH
10778: 4e35:       SB.STRING$ = AF.FILE.NAME$                                        ! 2.12SH
10779: 4e51:       GOSUB SB.FILE.UTILS                                               ! 2.12SH
10780: 4e63:       AF.SESS.NUM% = SB.FILE.SESS.NUM%                                  ! 2.12SH
10781: 4e76: 
10782: 4e76:       SB.INTEGER% = UODOT.REPORT.NUM%                                   ! 2.12SH
10783: 4e88:       SB.STRING$ = UODOT.FILE.NAME$                                     ! 2.12SH
10784: 4ea4:       GOSUB SB.FILE.UTILS                                               ! 2.12SH
10785: 4eb6:       UODOT.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.12SH
10786: 4ec9: 
10787: 4ec9:       SB.INTEGER% = UB.REPORT.NUM%                                      ! 2.12SH
10788: 4edb:       SB.STRING$ = UB.FILE.NAME$                                        ! 2.12SH
10789: 4ef7:       GOSUB SB.FILE.UTILS                                               ! 2.12SH
10790: 4f09:       UB.SESS.NUM% = SB.FILE.SESS.NUM%                                  ! 2.12SH
10791: 4f1c:       
10792: 4f1c:       UB.OPEN.FLAG$ = "N"                                               ! 2.12SH
10793: 4f33:       AF.OPEN.FLAG$ = "N"                                               ! 2.12SH
10794: 4f4a:       DELVINDX.OPEN.FLAG$ = "N"                                         ! 2.12SH
10795: 4f61:       UODOT.OPEN.FLAG$ = "N"                                            ! 2.12SH
10796: 4f78:       RECALLS.OPEN.FLAG$ = "N"                                          ! 2.10BG
10797: 4f8f:       REWKF.OPEN.FLAG$ = "N"                                            ! 2.10BG
10798: 4fa6:       RB.OPEN.FLAG$ = "N"                                               ! 2.10BG
10799: 4fbd:       CB.OPEN.FLAG$ = "N"                                               ! 2.9NWB
10800: 4fd2:       CCBUF.OPEN.FLAG$ = "N"                                            ! MMJK
10801: 4fe9:       CCDMY.OPEN.FLAG$ = "N"                                            ! MMJK
10802: 5000:       CCITM.OPEN.FLAG$ = "N"                                            ! MMJK
10803: 5017:       CCLAM.OPEN.FLAG$ = "N"                                            ! 1.4
10804: 502e:       CCREJ.OPEN.FLAG$ = "N"                                            ! 2.4JAS
10805: 5045:       CCTMP.OPEN.FLAG$ = "N"                                            ! MMJK
10806: 505c:       CCTRL.OPEN.FLAG$ = "N"                                            ! MMJK
10807: 5073:       CCUOD.OPEN.FLAG$ = "N"                                            ! MMJK
10808: 508a:       CCUPF.OPEN.FLAG$ = "N"                                            ! NMJK
10809: 50a1:       CCWKF.OPEN.FLAG$ = "N"                                            ! MMJK
10810: 50b8:       CHKBF.OPEN.FLAG$ = "N"                                            ! DSW
10811: 50cf: \     CITEM.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
10812: 50cf:       CSR.AUDIT.OPEN.FLAG$ = "N"                                        ! EPAB
10813: 50e6: \     CSR.OPEN.FLAG$ = "N"                                              ! DSW !2.9NWB
10814: 50e6: \     CSRBF.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
10815: 50e6: \     CSRWF.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
10816: 50e6:       DIREC.OPEN.FLAG$ = "N"                                            ! HDS
10817: 50fd:       DIRORD.OPEN.FLAG$ = "N"                                           ! HDS
10818: 5114:       DIRSUP.OPEN.FLAG$ = "N"                                           ! HDS
10819: 512b:       DIRWF.OPEN.FLAG$ = "N"                                            ! HDS
10820: 5142:       DRSMQ.OPEN.FLAG$ = "N"                                            ! HDS
10821: 5159: !     FPF.OPEN.FLAG$ = "N"                                              ! DSW
10822: 5159:       GAPBF.OPEN.FLAG$ = "N"                                            ! 1.3 !2.5CS !2.6BG
10823: 5170:       IDF.OPEN.FLAG$ = "N"                                              ! DSW
10824: 5187: !     IDSOF.OPEN.FLAG$ = "N"                                            ! JLC
10825: 5187:       LDTAF.OPEN.FLAG$ = "N"                                            ! MMJK
10826: 519e:       LDTBF.OPEN.FLAG$ = "N"                                            ! JLC
10827: 51b5:       LDTCF.OPEN.FLAG$ = "N"                                            ! HDS
10828: 51cc:       LOCCNT.OPEN.FLAG$ = "N"                                           ! 1.9DA
10829: 51e3: !     LSSST.OPEN.FLAG$ = "N"                                            !1.8BG !2.7CS
10830: 51e3: !     ONORD.OPEN.FLAG$ = "N"                                            ! DSW
10831: 51e3:       PCHK.OPEN.FLAG$ = "N"                                             ! DSW
10832: 51fa:       PLLDB.OPEN.FLAG$ = "N"                                            ! 2.5CS
10833: 5211:       PLLOL.OPEN.FLAG$ = "N"                                            ! 2.5CS
10834: 5228:       SOFTS.OPEN.FLAG$ = "N"                                            ! MMJK
10835: 523f:       SOPTS.OPEN.FLAG$ = "N"                                            ! 2.3JAS
10836: 5256: !     STKCF.OPEN.FLAG$ = "N"                                            ! 1.9DA
10837: 5256:       STKDC.OPEN.FLAG$ = "N"                                            ! 1.9DA
10838: 526d:       STKEX.OPEN.FLAG$ = "N"                                            ! 1.9DA
10839: 5284:       STKIF.OPEN.FLAG$ = "N"                                            ! 1.9DA
10840: 529b:       STKMF.OPEN.FLAG$ = "N"                                            ! 1.9DA
10841: 52b2:       STKRC.OPEN.FLAG$ = "N"                                            ! 1.9DA
10842: 52c9:       STKTF.OPEN.FLAG$ = "N"                                            ! 1.9DA
10843: 52e0:       TSF.OPEN.FLAG$ = "N"                                              ! 2.3JAS
10844: 52f7:       UNITS.OPEN.FLAG$ = "N"                                            ! DSW
10845: 530e:       UOD.OPEN.FLAG$ = "N"                                              ! LLC
10846: 5325:       UODBF.OPEN.FLAG$ = "N"                                            ! LLC
10847: 533c:       UODTF.OPEN.FLAG$ = "N"                                            ! LLC
10848: 5353:       XGCF.OPEN.FLAG$ = "N"                                             ! 1.9DA
10849: 536a: 
10850: 536a:       TIMEOUT.VALUE% = 2                ! Seconds delay to cause PDT timeout
10851: 5381:       INT.DELAY% = 10                   ! Seconds delay between PSS38 checks
10852: 5392:       INACTIVITY.SHUTDOWN% = VAL(RIGHT$("37INACT:0030", 4))             ! DSW
10853: 53b2:                                         ! Seconds inactivity before shutdown
10854: 53b2:                                         ! Load module is editable
10855: 53b2:       LOG.ON.DISABLE% = 8               ! Min. Seconds between logons   ! MDS
10856: 53c0:       STKMQ.RECORD.DELIMITER$ = CHR$(34)!
10857: 53da:       STKMQ.FIELD.DELIMITER$ = CHR$(59) ! STKMQ delimiters
10858: 53f4:       STKMQ.ENDREC.MARKER$ = CRLF$      !
10859: 540f:       CCTMP.RECORD.DELIMITER$ = CHR$(34)                                ! MMJK
10860: 5429:       CCTMP.FIELD.DELIMITER$ = CHR$(59)                                 ! MMJK
10861: 5443:       CCTMP.ENDREC.MARKER$ = CRLF$                                      ! MMJK
10862: 545e:       CCREJ.ENDREC.MARKER$ = CRLF$                                      ! 2.4JAS
10863: 5479: 
10864: 5479:       CURR.SESS.NUM% = PIPEI.SESS.NUM%
10865: 548b:       OPEN PIPEI.FILE.NAME$ AS PIPEI.SESS.NUM% BUFFSIZE 518
10866: 54b5:       CURR.SESS.NUM% = PIPEO.SESS.NUM%
10867: 54c7:       OPEN PIPEO.FILE.NAME$ AS PIPEO.SESS.NUM% BUFFSIZE 518
10868: 54f1:       CURR.SESS.NUM% = PLDT.SESS.NUM%                                   ! HDS
10869: 5503:       OPEN PLDT.FILE.NAME$ AS PLDT.SESS.NUM% BUFFSIZE 518               ! HDS
10870: 552d: 
10871: 552d:                                                           ! 1.2
10872: 552d: 
10873: 552d: 
10874: 552d: \     IF NOT WARM.START THEN BEGIN                                      ! ILC !2.9NWB
10875: 552d: \        ALLOW.CSR.PROCESSING = TRUE                                    ! 1.2 !2.9NWB
10876: 552d: \        CURR.SESS.NUM% = SOFTS.SESS.NUM%                               ! 1.2 !2.9NWB
10877: 552d: \        IF END #SOFTS.SESS.NUM% THEN OPEN.ERROR                        ! 1.2 !2.9NWB
10878: 552d: \        OPEN SOFTS.FILE.NAME$ DIRECT RECL SOFTS.RECL%                  \ 1.2 !2.9NWB
10879: 552d: \             AS SOFTS.SESS.NUM% NOWRITE NODEL                          ! 1.2 !2.9NWB
10880: 552d: \        SOFTS.OPEN.FLAG$ = "Y"                                         ! 1.2 !2.9NWB
10881: 552d: \        SOFTS.REC.NUM% = 6                                             ! 1.2 !2.9NWB
10882: 552d: \        IF READ.SOFTS = 0 THEN BEGIN                                   ! 1.2 !2.9NWB
10883: 552d: \           IF (LEFT$(SOFTS.RECORD$,11) = "CSR PHASE 2") THEN BEGIN ! 1.2     !2.9NWB
10884: 552d: \              ALLOW.CSR.PROCESSING = FALSE                             ! 1.2 !2.9NWB
10885: 552d: \           ENDIF                                                       ! 1.2 !2.9NWB
10886: 552d: \        ENDIF ELSE ALLOW.CSR.PROCESSING = FALSE                        ! 1.2 !2.9NWB
10887: 552d: \        CLOSE SOFTS.SESS.NUM%                                          ! 1.2 !2.9NWB
10888: 552d: \        SOFTS.OPEN.FLAG$ = "N"                                         ! 1.2 !2.9NWB
10889: 552d: 
10890: 552d: \        IF (NOT ALLOW.CSR.PROCESSING) THEN BEGIN                       ! 1.2 !2.9NWB
10891: 552d: \           GOTO BYPASS.CSR.PROCESSING                                  ! 1.2 !2.9NWB
10892: 552d: \        ENDIF                                                                !2.9NWB
10893: 552d: 
10894: 552d: \        LOCATION$ = "STARTUP"                                                !2.9NWB
10895: 552d: \        GOSUB STAGGER.PORT                                             ! DSW !2.9NWB
10896: 552d: \        CURR.SESS.NUM% = CSR.SESS.NUM%                                 ! DSW !2.9NWB
10897: 552d: \        IF END# CSR.SESS.NUM% THEN OPEN.ERROR                          ! DSW !2.9NWB
10898: 552d: \        OPEN CSR.FILE.NAME$ AS CSR.SESS.NUM% LOCKED                    ! DSW !2.9NWB
10899: 552d: \        CSR.OPEN.FLAG$ = "Y"                                           ! DSW !2.9NWB
10900: 552d: \        CSRWF.EXISTS% = SIZE(CSRWF.FILE.NAME$)                         ! DSW !2.9NWB
10901: 552d: \        IF CSRWF.EXISTS% > 0 THEN BEGIN                                ! DSW !2.9NWB
10902: 552d: \           SB.MESSAGE$ = "PDT Support - Processing CSR work file"      ! DSW !2.9NWB
10903: 552d: \           GOSUB SB.BG.MESSAGE                                         ! DSW !2.9NWB
10904: 552d: \           PROCESS.CSR.WORKFILE$ = "Y"                                 ! DSW !2.9NWB
10905: 552d: \           GOSUB ALLOCATE.MODULE.1                                     !2.0DA!2.9NWB
10906: 552d: \           CALL PSS3701                                                ! DSW !2.9NWB
10907: 552d: \           GOSUB DEALLOCATE.MODULE.1                                   !2.0DA!2.9NWB
10908: 552d: \           IF CITEM.OPEN.FLAG$ = "Y" THEN BEGIN                        ! DSW !2.9NWB
10909: 552d: \              CLOSE CITEM.SESS.NUM%                                    ! DSW !2.9NWB
10910: 552d: \              CITEM.OPEN.FLAG$ = "N"                                   ! DSW !2.9NWB
10911: 552d: \           ENDIF                                                       ! DSW !2.9NWB
10912: 552d: \        ENDIF                                                          ! DSW !2.9NWB
10913: 552d: 
10914: 552d: \        GOSUB ZEROISE.CITEM                                            ! FSW !2.9NWB
10915: 552d: \     ENDIF                                                                   !2.9NWB
10916: 552d: 
10917: 552d: \ BYPASS.CSR.PROCESSING:                                                !1.2  !2.9NWB
10918: 552d: 
10919: 552d: \     IF CSR.OPEN.FLAG$ = "Y" THEN BEGIN                                ! DSW !2.9NWB
10920: 552d: \        CLOSE CSR.SESS.NUM%                                            ! DSW !2.9NWB
10921: 552d: \        CSR.OPEN.FLAG$ = "N"                                           ! DSW !2.9NWB
10922: 552d: \     ENDIF                                                             ! DSW !2.9NWB
10923: 552d: 
10924: 552d:    IGNORE.LOCKED.FILE:                                                  ! DSW
10925: 553d: 
10926: 553d:       CURR.SESS.NUM% = SOFTS.SESS.NUM%                                  ! 2.9NWB
10927: 554f:       IF END #SOFTS.SESS.NUM% THEN OPEN.ERROR                           ! 2.9NWB
10928: 556b:       OPEN SOFTS.FILE.NAME$ DIRECT RECL SOFTS.RECL%                     \ 2.9NWB
10929: 5598:            AS SOFTS.SESS.NUM% NOWRITE NODEL                             ! 2.9NWB
10930: 5598:       SOFTS.OPEN.FLAG$ = "Y"                                            ! 2.9NWB
10931: 55af:       SOFTS.REC.NUM% = 50                                               ! 2.9NWB
10932: 55c6:       ASN.ACTIVE% = FALSE                                               ! 2.9NWB
10933: 55dc:       IF READ.SOFTS = 0 THEN BEGIN                                      ! 2.9NWB
10934: 55ee:          IF MATCH("INACTIVE", SOFTS.RECORD$, 1) = 0 THEN BEGIN          ! 2.9NWB
10935: 5611:             ASN.ACTIVE% = TRUE                                          ! 2.9NWB
10936: 5627:          ENDIF                                                          ! 2.9NWB
10937: 562f:       ENDIF                                                             ! 2.9NWB
10938: 5637:       CLOSE SOFTS.SESS.NUM%                                             ! 2.9NWB
10939: 564b:       SOFTS.OPEN.FLAG$ = "N"                                            ! 2.9NWB
10940: 5662: 
10941: 5662:       CURR.SESS.NUM% = DRSMQ.SESS.NUM%                                  ! HDS
10942: 5674:       IF END# DRSMQ.SESS.NUM% THEN DRSMQ.NOT.FOUND                      ! HDS
10943: 5690:       OPEN DRSMQ.FILE.NAME$ AS DRSMQ.SESS.NUM% NODEL                    ! HDS
10944: 56b8:       DRSMQ.OPEN.FLAG$ = "Y"                                            ! HDS
10945: 56cf: 
10946: 56cf:    DRSMQ.CONTINUE:                                                      ! HDS
10947: 56df: 
10948: 56df:       CLOSE DRSMQ.SESS.NUM%                                             ! HDS
10949: 56f3:       DRSMQ.OPEN.FLAG$ = "N"                                            ! HDS
10950: 570a: 
10951: 570a:       LOCATION$ = "RUNNING"                                             ! DSW
10952: 571f:       SB.MESSAGE$ = "PDT Support - Waiting for PSS38"                   ! DSW
10953: 5734:       GOSUB SB.BG.MESSAGE                                               ! DSW
10954: 5746: 
10955: 5746:       CR$ = CHR$(13)                                                    !1.9DA
10956: 575e: 
10957: 575e:       DIM BUSINESS.CENTRES$(26)                                         !1.9DA
10958: 578d:       DIM CONCEPT.GROUPS$(99)                                           !1.9DA
10959: 57bc:       DIM PRODUCT.GROUPS$(1000)                                         !1.9DA
10960: 57ec: 
10961: 57ec:    RETURN
10962: 57fc: 
10963: 57fc: ALLOCATE.MODULE.1:
10964: 580c: 
10965: 580c:       SB.ACTION$ = "O"                                                  !1.9DA
10966: 5821: 
10967: 5821: \     SB.INTEGER% = CIMF.REPORT.NUM%                                    !DJAL !2.9NWB
10968: 5821: \     SB.STRING$ = CIMF.FILE.NAME$                                      !DJAL !2.9NWB
10969: 5821: \     GOSUB SB.FILE.UTILS                                               !DJAL !2.9NWB
10970: 5821: \     CIMF.SESS.NUM% = SB.FILE.SESS.NUM%                                !DJAL !2.9NWB
10971: 5821: 
10972: 5821: \     SB.INTEGER% = FPF.REPORT.NUM%                                     !2.0DA!2.9NWB
10973: 5821: \     SB.STRING$ = FPF.FILE.NAME$                                       !2.0DA!2.9NWB
10974: 5821: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
10975: 5821: \     FPF.SESS.NUM% = SB.FILE.SESS.NUM%                                 !2.0DA!2.9NWB
10976: 5821: 
10977: 5821: \     SB.INTEGER% = ONORD.REPORT.NUM%                                   !2.0DA!2.9NWB
10978: 5821: \     SB.STRING$ = ONORD.FILE.NAME$                                     !2.0DA!2.9NWB
10979: 5821: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
10980: 5821: \     ONORD.SESS.NUM% = SB.FILE.SESS.NUM%                               !2.0DA!2.9NWB
10981: 5821: 
10982: 5821: \     SB.INTEGER% = IDSOF.REPORT.NUM%                                   !2.0DA!2.9NWB
10983: 5821: \     SB.STRING$ = IDSOF.FILE.NAME$                                     !2.0DA!2.9NWB
10984: 5821: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
10985: 5821: \     IDSOF.SESS.NUM% = SB.FILE.SESS.NUM%                               !2.0DA!2.9NWB
10986: 5821: 
10987: 5821: \     CIMF.OPEN.FLAG$ = "N"                                             ! DSW !2.9NWB
10988: 5821: \     FPF.OPEN.FLAG$ = "N"                                              !2.0DA!2.9NWB
10989: 5821: \     ONORD.OPEN.FLAG$ = "N"                                            !2.0DA!2.9NWB
10990: 5821: \     IDSOF.OPEN.FLAG$ = "N"                                            !2.0DA!2.9NWB
10991: 5821: 
10992: 5821: RETURN
10993: 5831: 
10994: 5831: DEALLOCATE.MODULE.1:
10995: 5841: 
10996: 5841:       SB.ACTION$ = "C"                                                  !1.9DA
10997: 5856:       SB.STRING$ = ""                                                   !1.9DA
10998: 586b: 
10999: 586b: \     IF CIMF.OPEN.FLAG$ = "Y" THEN BEGIN                               !1.9DA!2.9NWB
11000: 586b: \        CLOSE CIMF.SESS.NUM%                                           !1.9DA!2.9NWB
11001: 586b: \        SB.INTEGER% = CIMF.SESS.NUM%                                   !2.7CS!2.9NWB
11002: 586b: \        GOSUB SB.FILE.UTILS                                            !2.7CS!2.9NWB
11003: 586b: \        CIMF.OPEN.FLAG$ = "N"                                          !1.9DA!2.9NWB
11004: 586b: \     ENDIF                                                             !1.9DA!2.9NWB
11005: 586b: 
11006: 586b: \     IF FPF.OPEN.FLAG$ = "Y" THEN BEGIN                                !2.0DA!2.9NWB
11007: 586b: \        CLOSE FPF.SESS.NUM%                                            !2.0DA!2.9NWB
11008: 586b: \        SB.INTEGER% = FPF.SESS.NUM%                                    !2.7CS!2.9NWB
11009: 586b: \        GOSUB SB.FILE.UTILS                                            !2.7CS!2.9NWB
11010: 586b: \        FPF.OPEN.FLAG$ = "N"                                           !2.0DA!2.9NWB
11011: 586b: \     ENDIF                                                             !2.0DA!2.9NWB
11012: 586b: 
11013: 586b: \     IF ONORD.OPEN.FLAG$ = "Y" THEN BEGIN                              !2.0DA!2.9NWB
11014: 586b: \        CLOSE ONORD.SESS.NUM%                                          !2.0DA!2.9NWB
11015: 586b: \        SB.INTEGER% = ONORD.SESS.NUM%                                  !2.7CS!2.9NWB
11016: 586b: \        GOSUB SB.FILE.UTILS                                            !2.7CS!2.9NWB
11017: 586b: \        ONORD.OPEN.FLAG$ = "N"                                         !2.0DA!2.9NWB
11018: 586b: \     ENDIF                                                             !2.0DA!2.9NWB
11019: 586b: 
11020: 586b: \     IF IDSOF.OPEN.FLAG$ = "Y" THEN BEGIN                              !2.0DA!2.9NWB
11021: 586b: \        CLOSE IDSOF.SESS.NUM%                                          !2.0DA!2.9NWB
11022: 586b: \        SB.INTEGER% = IDSOF.SESS.NUM%                                  !2.7CS!2.9NWB
11023: 586b: \        GOSUB SB.FILE.UTILS                                            !2.7CS!2.9NWB
11024: 586b: \        IDSOF.OPEN.FLAG$ = "N"                                         !2.0DA!2.9NWB
11025: 586b: \     ENDIF                                                             !2.0DA!2.9NWB
11026: 586b: 
11027: 586b: \     SB.INTEGER% = CIMF.SESS.NUM%                                      ! DJAL!2.9NWB
11028: 586b: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
11029: 586b: 
11030: 586b: \     SB.INTEGER% = FPF.SESS.NUM%                                       !2.0DA!2.9NWB
11031: 586b: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
11032: 586b: 
11033: 586b: \     SB.INTEGER% = ONORD.SESS.NUM%                                     !2.0DA!2.9NWB
11034: 586b: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
11035: 586b: 
11036: 586b: \     SB.INTEGER% = IDSOF.SESS.NUM%                                     !2.0DA!2.9NWB
11037: 586b: \     GOSUB SB.FILE.UTILS                                               !2.0DA!2.9NWB
11038: 586b: 
11039: 586b: RETURN
11040: 587b: 
11041: 587b: ALLOCATE.MODULE.3:
11042: 588b: 
11043: 588b: 
11044: 588b: RETURN
11045: 589b: 
11046: 589b: DEALLOCATE.MODULE.3:
11047: 58ab: 
11048: 58ab: 
11049: 58ab: RETURN
11050: 58bb: 
11051: 58bb: ALLOCATE.MODULE.4:
11052: 58cb: 
11053: 58cb:       SB.ACTION$ = "O"                                                  ! 1.9DA
11054: 58e0: 
11055: 58e0: !     SB.INTEGER% = STKCF.SESS.NUM%                                     ! 1.9DA
11056: 58e0: !     SB.STRING$ = STKCF.FILE.NAME$                                     ! 1.9DA
11057: 58e0: !     GOSUB SB.FILE.UTILS                                               ! 1.9DA
11058: 58e0: !     STKCF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11059: 58e0: 
11060: 58e0:       IF APPLICATION.NO$ = "08" THEN BEGIN                              ! 2.3JAS Stocktake application
11061: 5901: 
11062: 5901:          SB.INTEGER% = STKMF.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11063: 5913:          SB.STRING$ = STKMF.FILE.NAME$                                     ! 1.9DA
11064: 592f:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11065: 5941:          STKMF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11066: 5954: 
11067: 5954:          SB.INTEGER% = STKRC.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11068: 5966:          SB.STRING$ = STKRC.FILE.NAME$                                     ! 1.9DA
11069: 5982:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11070: 5994:          STKRC.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11071: 59a7: 
11072: 59a7:          SB.INTEGER% = XGCF.REPORT.NUM%                                    ! 1.9DA  ! 2.7CS
11073: 59b9:          SB.STRING$ = XGCF.FILE.NAME$                                      ! 1.9DA
11074: 59d5:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11075: 59e7:          XGCF.SESS.NUM% = SB.FILE.SESS.NUM%                                ! 1.9DA
11076: 59fa: 
11077: 59fa:          SB.INTEGER% = STKEX.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11078: 5a0c:          SB.STRING$ = STKEX.FILE.NAME$                                     ! 1.9DA
11079: 5a28:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11080: 5a3a:          STKEX.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11081: 5a4d: 
11082: 5a4d:          SB.INTEGER% = STKIF.REPORT.NUM%                                   ! 1.9DA   ! 2.7CS
11083: 5a5f:          SB.STRING$ = STKIF.FILE.NAME$                                     ! 1.9DA
11084: 5a7b:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11085: 5a8d:          STKIF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11086: 5aa0: 
11087: 5aa0:          SB.INTEGER% = LOCCNT.REPORT.NUM%                                  ! 1.9DA  ! 2.7CS
11088: 5ab2:          SB.STRING$ = LOCCNT.FILE.NAME$                                    ! 1.9DA
11089: 5ace:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11090: 5ae0:          LOCCNT.SESS.NUM% = SB.FILE.SESS.NUM%                              ! 1.9DA
11091: 5af3: 
11092: 5af3:          SB.INTEGER% = STKIG.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11093: 5b05:          SB.STRING$ = STKIG.FILE.NAME$                                     ! 1.9DA
11094: 5b21:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11095: 5b33:          STKIG.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11096: 5b46: 
11097: 5b46:          SB.INTEGER% = STKTF.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11098: 5b58:          SB.STRING$ = STKTF.FILE.NAME$                                     ! 1.9DA
11099: 5b74:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11100: 5b86:          STKTF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11101: 5b99: 
11102: 5b99:          SB.INTEGER% = STKDC.REPORT.NUM%                                   ! 1.9DA  ! 2.7CS
11103: 5bab:          SB.STRING$ = STKDC.FILE.NAME$                                     ! 1.9DA
11104: 5bc7:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11105: 5bd9:          STKDC.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 1.9DA
11106: 5bec: 
11107: 5bec: !     STKCF.OPEN.FLAG$ = "N"                                            ! 1.9DA
11108: 5bec:          STKMF.OPEN.FLAG$ = "N"                                            ! 1.9DA
11109: 5c06: 
11110: 5c06:    ENDIF ELSE BEGIN                                                     ! 2.3JAS Returns application
11111: 5c0e: 
11112: 5c0e:       SB.INTEGER% = SOPTS.REPORT.NUM%                                   ! 2.3JAS  ! 2.7CS
11113: 5c20:       SB.STRING$ = SOPTS.FILE.NAME$                                     ! 2.3JAS
11114: 5c3c:       GOSUB SB.FILE.UTILS                                               ! 2.3JAS
11115: 5c4e:       SOPTS.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.3JAS
11116: 5c61: 
11117: 5c61:       SB.INTEGER% = LOCAL.REPORT.NUM%                                   ! 2.3JAS  ! 2.7CS
11118: 5c73:       SB.STRING$ = LOCAL.FILE.NAME$                                     ! 2.3JAS
11119: 5c8f:       GOSUB SB.FILE.UTILS                                               ! 2.3JAS
11120: 5ca1:       LOCAL.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.3JAS
11121: 5cb4: 
11122: 5cb4:       SB.INTEGER% = CCREJ.REPORT.NUM%                                   ! 2.4JAS  ! 2.7CS
11123: 5cc6:       SB.STRING$ = CCREJ.FILE.NAME$                                     ! 2.4JAS
11124: 5ce2:       GOSUB SB.FILE.UTILS                                               ! 2.4JAS
11125: 5cf4:       CCREJ.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.4JAS
11126: 5d07: 
11127: 5d07:    ENDIF                                                                ! 2.3JAS
11128: 5d0f: 
11129: 5d0f: RETURN
11130: 5d1f: 
11131: 5d1f: DEALLOCATE.MODULE.4:
11132: 5d2f: 
11133: 5d2f:       SB.ACTION$ = "C"                                                  ! 1.9DA
11134: 5d44:       SB.STRING$ = ""                                                   ! 1.9DA
11135: 5d59: 
11136: 5d59: !     IF STKCF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11137: 5d59: !        CLOSE STKCF.SESS.NUM%                                          ! 1.9DA
11138: 5d59: !        STKCF.OPEN.FLAG$ = "N"                                         ! 1.9DA
11139: 5d59: !     ENDIF                                                             ! 1.9DA
11140: 5d59: 
11141: 5d59:       IF SOPTS.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.3JAS
11142: 5d77:          CLOSE SOPTS.SESS.NUM%                                          ! 2.3JAS
11143: 5d8b:          SOPTS.OPEN.FLAG$ = "N"                                         ! 2.3JAS
11144: 5da2:       ENDIF                                                             ! 2.3JAS
11145: 5daa: 
11146: 5daa:       IF LOCAL.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.3JAS
11147: 5dc8:          CLOSE LOCAL.SESS.NUM%                                          ! 2.3JAS
11148: 5ddc:          LOCAL.OPEN.FLAG$ = "N"                                         ! 2.3JAS
11149: 5df3:       ENDIF                                                             ! 2.3JAS
11150: 5dfb: 
11151: 5dfb:       IF CCREJ.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.4JAS
11152: 5e19:          CLOSE CCREJ.SESS.NUM%                                          ! 2.4JAS
11153: 5e2d:          CCREJ.OPEN.FLAG$ = "N"                                         ! 2.4JAS
11154: 5e44:       ENDIF                                                             ! 2.4JAS
11155: 5e4c: 
11156: 5e4c:       IF STKMF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11157: 5e6a:          CLOSE STKMF.SESS.NUM%                                          ! 1.9DA
11158: 5e7e:          STKMF.OPEN.FLAG$ = "N"                                         ! 1.9DA
11159: 5e95:       ENDIF                                                             ! 1.9DA
11160: 5e9d: 
11161: 5e9d:       IF STKRC.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11162: 5ebb:          CLOSE STKRC.SESS.NUM%                                          ! 1.9DA
11163: 5ecf:          STKRC.OPEN.FLAG$ = "N"                                         ! 1.9DA
11164: 5ee6:       ENDIF                                                             ! 1.9DA
11165: 5eee: 
11166: 5eee:       IF XGCF.OPEN.FLAG$ = "Y" THEN BEGIN                               ! 1.9DA
11167: 5f0c:          CLOSE XGCF.SESS.NUM%                                           ! 1.9DA
11168: 5f20:          XGCF.OPEN.FLAG$ = "N"                                          ! 1.9DA
11169: 5f37:       ENDIF                                                             ! 1.9DA
11170: 5f3f: 
11171: 5f3f:       IF STKEX.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11172: 5f5d:          CLOSE STKEX.SESS.NUM%                                          ! 1.9DA
11173: 5f71:          STKEX.OPEN.FLAG$ = "N"                                         ! 1.9DA
11174: 5f88:       ENDIF                                                             ! 1.9DA
11175: 5f90: 
11176: 5f90:       IF STKIF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11177: 5fae:          CLOSE STKIF.SESS.NUM%                                          ! 1.9DA
11178: 5fc2:          STKIF.OPEN.FLAG$ = "N"                                         ! 1.9DA
11179: 5fd9:       ENDIF                                                             ! 1.9DA
11180: 5fe1: 
11181: 5fe1:       IF LOCCNT.OPEN.FLAG$ = "Y" THEN BEGIN                             ! 1.9DA
11182: 5fff:          CLOSE LOCCNT.SESS.NUM%                                         ! 1.9DA
11183: 6013:          LOCCNT.OPEN.FLAG$ = "N"                                        ! 1.9DA
11184: 602a:       ENDIF                                                             ! 1.9DA
11185: 6032: 
11186: 6032:       IF STKTF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11187: 6050:          CLOSE STKTF.SESS.NUM%                                          ! 1.9DA
11188: 6064:          STKTF.OPEN.FLAG$ = "N"                                         ! 1.9DA
11189: 607b:       ENDIF                                                             ! 1.9DA
11190: 6083: 
11191: 6083:       IF STKDC.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA
11192: 60a1:          CLOSE STKDC.SESS.NUM%                                          ! 1.9DA
11193: 60b5:          STKDC.OPEN.FLAG$ = "N"                                         ! 1.9DA
11194: 60cc:       ENDIF                                                             ! 1.9DA
11195: 60d4: 
11196: 60d4:       CLOSE IRF.SESS.NUM%                                               ! 1.9D
11197: 60e8:       CLOSE IDF.SESS.NUM%                                               ! 1.9D
11198: 60fc: 
11199: 60fc: !     SB.INTEGER% = STKCF.SESS.NUM%                                     ! 1.9DA
11200: 60fc: !     GOSUB SB.FILE.UTILS                                               ! 1.9DA
11201: 60fc: 
11202: 60fc:       IF APPLICATION.NO$ = "08" THEN BEGIN                              ! 2.3JAS Stocktake application
11203: 611d: 
11204: 611d:          SB.INTEGER% = STKMF.SESS.NUM%                                     ! 1.9DA
11205: 612f:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11206: 6141: 
11207: 6141:          SB.INTEGER% = STKRC.SESS.NUM%                                     ! 1.9DA
11208: 6153:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11209: 6165: 
11210: 6165:          SB.INTEGER% = XGCF.SESS.NUM%                                      ! 1.9DA
11211: 6177:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11212: 6189: 
11213: 6189:          SB.INTEGER% = STKEX.SESS.NUM%                                     ! 1.9DA
11214: 619b:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11215: 61ad: 
11216: 61ad:          SB.INTEGER% = STKIF.SESS.NUM%                                     ! 1.9DA
11217: 61bf:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11218: 61d1: 
11219: 61d1:          SB.INTEGER% = LOCCNT.SESS.NUM%                                    ! 1.9DA
11220: 61e3:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11221: 61f5: 
11222: 61f5:          SB.INTEGER% = STKIG.SESS.NUM%                                     ! 1.9DA
11223: 6207:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11224: 6219: 
11225: 6219:          SB.INTEGER% = STKTF.SESS.NUM%                                     ! 1.9DA
11226: 622b:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11227: 623d: 
11228: 623d:          SB.INTEGER% = STKDC.SESS.NUM%                                     ! 1.9DA
11229: 624f:          GOSUB SB.FILE.UTILS                                               ! 1.9DA
11230: 6263: 
11231: 6263:       ENDIF ELSE BEGIN                                                     ! 2.3JAS Returns application                                                                ! 2.3JAS
11232: 626b: 
11233: 626b:          SB.INTEGER% = SOPTS.SESS.NUM%                                     ! 2.3JAS
11234: 627d:          GOSUB SB.FILE.UTILS                                               ! 2.3JAS
11235: 628f: 
11236: 628f:          SB.INTEGER% = LOCAL.SESS.NUM%                                     ! 2.3JAS
11237: 62a1:          GOSUB SB.FILE.UTILS                                               ! 2.3JAS
11238: 62b3: 
11239: 62b3:          SB.INTEGER% = CCREJ.SESS.NUM%                                     ! 2.4JAS
11240: 62c5:          GOSUB SB.FILE.UTILS                                               ! 2.4JAS
11241: 62d7: 
11242: 62d7:       ENDIF                                                                ! 2.3JAS
11243: 62df: 
11244: 62df: RETURN
11245: 62ef: 
11246: 62ef: ALLOCATE.MODULE.5:                                                      ! 2.1BG
11247: 62ff: 
11248: 62ff:       SB.ACTION$ = "O"                                                  ! 2.1BG
11249: 6314: 
11250: 6314: !     SB.INTEGER% = STKCF.SESS.NUM%                                     ! 2.1BG
11251: 6314: !     SB.STRING$ = STKCF.FILE.NAME$                                     ! 2.1BG
11252: 6314: !     GOSUB SB.FILE.UTILS                                               ! 2.1BG
11253: 6314: !     STKCF.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.1BG
11254: 6314: 
11255: 6314:       SB.INTEGER% = SSPSCTRL.REPORT.NUM%                                ! 2.2JAS  ! 2.7CS
11256: 6326:       SB.STRING$ = SSPSCTRL.FILE.NAME$                                  ! 2.2JAS
11257: 6342:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11258: 6354:       SSPSCTRL.SESS.NUM% = SB.FILE.SESS.NUM%                            ! 2.2JAS
11259: 6367: 
11260: 6367:       SB.INTEGER% = BTCS.REPORT.NUM%                                    ! 2.2JAS  ! 2.7CS
11261: 6379:       SB.STRING$ = BTCS.FILE.NAME$                                      ! 2.2JAS
11262: 6395:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11263: 63a7:       BTCS.SESS.NUM% = SB.FILE.SESS.NUM%                                ! 2.2JAS
11264: 63ba: 
11265: 63ba:       SB.INTEGER% = PRINT.REPORT.NUM%                                   ! 2.2JAS  ! 2.7CS
11266: 63cc:       SB.STRING$ = PRINT.FILE.NAME$                                     ! 2.2JAS
11267: 63e8:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11268: 63fa:       PRINT.SESS.NUM% = SB.FILE.SESS.NUM%                               ! 2.2JAS
11269: 640d: 
11270: 640d: RETURN                                                                  ! 2.1BG
11271: 641d: 
11272: 641d: DEALLOCATE.MODULE.5:                                                    ! 2.1BG
11273: 642d: 
11274: 642d:       SB.ACTION$ = "C"                                                  ! 2.1BG
11275: 6442:       SB.STRING$ = ""                                                   ! 2.1BG
11276: 6457: 
11277: 6457: !     IF STKCF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.1BG
11278: 6457: !        CLOSE STKCF.SESS.NUM%                                          ! 2.1BG
11279: 6457: !        STKCF.OPEN.FLAG$ = "N"                                         ! 2.1BG
11280: 6457: !     ENDIF                                                             ! 2.1BG
11281: 6457: 
11282: 6457:       SB.INTEGER% = SSPSCTRL.SESS.NUM%                                  ! 2.2JAS
11283: 6469:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11284: 647b: 
11285: 647b:       SB.INTEGER% = BTCS.SESS.NUM%                                      ! 2.2JAS
11286: 648d:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11287: 649f: 
11288: 649f:       SB.INTEGER% = PRINT.SESS.NUM%                                     ! 2.2JAS
11289: 64b1:       GOSUB SB.FILE.UTILS                                               ! 2.2JAS
11290: 64c3: 
11291: 64c3: RETURN                                                                  ! 2.1BG
11292: 64d3: 
11293: 64d3: \******************************************************************************
11294: 64d3: \***
11295: 64d3: \***   DETERMINE.DATA.TYPE:
11296: 64d3: \***
11297: 64d3: \***      set RECEIVE.STATE$ depending on record received (DATA.IN$),
11298: 64d3: \***      decode is follows ;
11299: 64d3: \***      1st char = SOH char. and record length = 14           - state "B"
11300: 64d3: \***      1st char = SOH char. and record length <> 14          - state "H"
11301: 64d3: \***      1st 2 chars = "CH"                                    - state "C"
11302: 64d3: \***      1st 2 chars = "LH"                                    - state "D"
11303: 64d3: \***      1st 2 chars = "LI"                                    - state "E"
11304: 64d3: \***      1st 2 chars = "LT"                                    - state "F"
11305: 64d3: \***      1st 2 chars = "CT"                                    - state "G"
11306: 64d3: \***      1st 2 chars = "CZ"                                    - state "I"
11307: 64d3: \***      1st 2 chars = "XH"                                    - state "K"   !2.9NWB
11308: 64d3: \***      1st 2 chars = "XM"                                    - state "L"   !2.9NWB
11309: 64d3: \***      1st 2 chars = "XU"                                    - state "L"   !2.9NWB
11310: 64d3: \***      1st 2 chars = "XO"                                    - state "L"   !2.9NWB
11311: 64d3: \***      1st 2 chars = "XR"                                    - state "N"   !2.9NWB
11312: 64d3: \***      1st 2 chars = "XT"                                    - state "J"   !2.9NWB
11313: 64d3: \***      1st 2 chars = "XZ"                                    - state "M"   !2.9NWB
11314: 64d3: \***      1st 2 chars = "PH"                                    - state "O"
11315: 64d3: \***      1st 2 chars = "PC"                                    - state "P"
11316: 64d3: \***      1st 2 chars = "PT"                                    - state "Q"
11317: 64d3: \***      1st 2 chars = "CV"                                    - state "R"
11318: 64d3: \***      1st 2 chars = "PZ"                                    - state "S"
11319: 64d3: \***      1st 2 chars = "OR"                                    - state "T"
11320: 64d3: \***      1st 2 chars = "FH"                                    - state "U"
11321: 64d3: \***      1st 2 chars = "OH"                                    - state "V"
11322: 64d3: \***      1st 2 chars = "OD"                                    - state "W"
11323: 64d3: \***      1st 2 chars = "OT"                                    - state "X"
11324: 64d3: \***      1st 2 chars = "FT"                                    - state "Y"
11325: 64d3: \***      1st 2 chars = "OZ"                                    - state "Z"
11326: 64d3: \***      1st 2 chars = "UE"                                    - state "a"
11327: 64d3: \***      1st 2 chars = "UH"                                    - state "b"
11328: 64d3: \***      1st 2 chars = "UD"                                    - state "c"
11329: 64d3: \***      1st 2 chars = "UT"                                    - state "d"
11330: 64d3: \***      1st 2 chars = "UR"                                    - state "e"
11331: 64d3: \***      1st 2 chars = "UZ"                                    - state "f"
11332: 64d3: \***      1st 2 chars = "RI"                                    - state "g"
11333: 64d3: \***      1st 2 chars = "RE"                                    - state "h"
11334: 64d3: \***      1st 2 chars = "RH"                                    - state "i"
11335: 64d3: \***      1st 2 chars = "RD"                                    - state "j"
11336: 64d3: \***      1st 2 chars = "RT"                                    - state "k"
11337: 64d3: \***      1st 2 chars = "RR"                                    - state "l"
11338: 64d3: \***      1st 2 chars = "RQ"                                    - state "m"
11339: 64d3: \***      1st 2 chars = "RO"                                    - state "n"
11340: 64d3: \***      1st 2 chars = "RZ"                                    - state "o"
11341: 64d3: \***      1st 2 chars = "SH"                                    - state "p"
11342: 64d3: \***      1st 2 chars = "SR"                                    - state "q"
11343: 64d3: \***      1st 2 chars = "ST"                                    - state "r"
11344: 64d3: \***      1st 2 chars = "IH"                                    - state "s"
11345: 64d3: \***      1st 2 chars = "IR"                                    - state "t"
11346: 64d3: \***      1st 2 chars = "IT"                                    - state "u"
11347: 64d3: \***      1st 2 chars = "IZ"                                    - state "v"
11348: 64d3: \***      1st 2 chars = "AH"                                    - state "w"
11349: 64d3: \***      1st 2 chars = "AR"                                    - state "x"
11350: 64d3: \***      1st 2 chars = "AT"                                    - state "y"
11351: 64d3: \***      1st 2 chars = "AZ"                                    - state "z"
11352: 64d3: \***      1st 2 chars = "TA"                                    - state "7"
11353: 64d3: \***      1st 2 chars = "TF"                                    - state "8"
11354: 64d3: \***      1st 2 chars = "TI"                                    - state "9"
11355: 64d3: \***      1st 2 chars = "TJ"                                    - state ":"
11356: 64d3: \***      1st 2 chars = "TK"                                    - state ";"
11357: 64d3: \***      1st 2 chars = "TL"                                    - state "<"
11358: 64d3: \***      1st 2 chars = "@@"                                    - state "@"
11359: 64d3: \***      any record that does not satisfy any of the above conditions will
11360: 64d3: \***      be given a state of "*" (invalid record)
11361: 64d3: \***
11362: 64d3: \***   RETURN
11363: 64d3: \***
11364: 64d3: \******************************************************************************
11365: 64d3: 
11366: 64d3:    DETERMINE.DATA.TYPE:
11367: 64e3: 
11368: 64e3:       DATA.LENGTH% = LEN(DATA.IN$)
11369: 6500: 
11370: 6500:       IF LEFT$(DATA.IN$,1) = SOH$ THEN BEGIN
11371: 653c:          IF DATA.LENGTH% = 14 THEN                                      \ DJAL
11372: 654b:             STATE$ = "B"                                                \
11373: 6564:          ELSE                                                           \
11374: 656c:             STATE$ = "H"
11375: 6583:          RETURN
11376: 6593:       ENDIF
11377: 659b: 
11378: 659b:       IF LEFT$(DATA.IN$,2) = "CH" THEN BEGIN
11379: 65d0:          STATE$ = "C"
11380: 65e7:          RETURN
11381: 65f7:       ENDIF
11382: 65ff: 
11383: 65ff:       IF LEFT$(DATA.IN$,2) = "LH" THEN BEGIN
11384: 6634:          STATE$ = "D"
11385: 664b:          RETURN
11386: 665b:       ENDIF
11387: 6663: 
11388: 6663:       IF LEFT$(DATA.IN$,2) = "LI" THEN BEGIN
11389: 6698:          STATE$ = "E"
11390: 66af:          RETURN
11391: 66bf:       ENDIF
11392: 66c7: 
11393: 66c7:       IF LEFT$(DATA.IN$,2) = "LT" THEN BEGIN
11394: 66fc:          STATE$ = "F"
11395: 6713:          RETURN
11396: 6723:       ENDIF
11397: 672b: 
11398: 672b:       IF LEFT$(DATA.IN$,2) = "CT" THEN BEGIN
11399: 6760:          STATE$ = "G"
11400: 6777:          RETURN
11401: 6787:       ENDIF
11402: 678f: 
11403: 678f:       IF LEFT$(DATA.IN$,2) = "CZ" THEN BEGIN                            ! DJAL
11404: 67c4:          STATE$ = "I"                                                   ! DJAL
11405: 67db:          RETURN                                                         ! DJAL
11406: 67eb:       ENDIF                                                             ! DJAL
11407: 67f3: 
11408: 67f3:       IF LEFT$(DATA.IN$,2) = "XH" THEN BEGIN                            ! DJAL
11409: 6828:          STATE$ = "K"                                                   ! DJAL!2.9NWB
11410: 683f:          RETURN                                                         ! DJAL
11411: 684f:       ENDIF                                                             ! DJAL
11412: 6857: 
11413: 6857:       IF LEFT$(DATA.IN$,2) = "XM" THEN BEGIN                            ! DJAL
11414: 688c:          STATE$ = "L"                                                   ! DJAL!2.9NWB
11415: 68a3:          RETURN                                                         ! DJAL
11416: 68b3:       ENDIF                                                             ! DJAL
11417: 68bb: 
11418: 68bb:       IF LEFT$(DATA.IN$,2) = "XU" THEN BEGIN                            ! DJAL
11419: 68f0:          STATE$ = "L"                                                   ! DJAL!2.9NWB
11420: 6907:          RETURN                                                         ! DJAL
11421: 6917:       ENDIF                                                             ! DJAL
11422: 691f: 
11423: 691f:       IF LEFT$(DATA.IN$,2) = "XO" THEN BEGIN                            ! DJAL
11424: 6954:          STATE$ = "L"                                                   ! DJAL!2.9NWB
11425: 696b:          RETURN                                                         ! DJAL
11426: 697b:       ENDIF                                                             ! DJAL
11427: 6983: 
11428: 6983:       IF LEFT$(DATA.IN$,2) = "XR" THEN BEGIN                            ! DJAL
11429: 69b8:          STATE$ = "N"                                                   ! DJAL!2.9NWB
11430: 69cf:          RETURN                                                         ! DJAL
11431: 69df:       ENDIF                                                             ! DJAL
11432: 69e7: 
11433: 69e7:       IF LEFT$(DATA.IN$,2) = "XT" THEN BEGIN                            ! DJAL
11434: 6a1c:          STATE$ = "J"                                                   ! DJAL!2.9NWB
11435: 6a33:          RETURN                                                         ! DJAL
11436: 6a43:       ENDIF                                                             ! DJAL
11437: 6a4b: 
11438: 6a4b:       IF LEFT$(DATA.IN$,2) = "XZ" THEN BEGIN                            ! DJAL
11439: 6a80:          STATE$ = "M"                                                   ! DJAL!2.9NWB
11440: 6a97:          RETURN                                                         ! DJAL
11441: 6aa7:       ENDIF                                                             ! DJAL
11442: 6aaf: 
11443: 6aaf:       IF LEFT$(DATA.IN$,2) = "PH" THEN BEGIN                            ! DJAL
11444: 6ae4:          STATE$ = "O"                                                   ! DJAL
11445: 6afb:          RETURN                                                         ! DJAL
11446: 6b0b:       ENDIF                                                             ! DJAL
11447: 6b13: 
11448: 6b13:       IF LEFT$(DATA.IN$,2) = "PC" THEN BEGIN                            ! DJAL
11449: 6b48:          STATE$ = "P"                                                   ! DJAL
11450: 6b5f:          RETURN                                                         ! DJAL
11451: 6b6f:       ENDIF                                                             ! DJAL
11452: 6b77: 
11453: 6b77:       IF LEFT$(DATA.IN$,2) = "PT" THEN BEGIN                            ! DJAL
11454: 6bac:          STATE$ = "Q"                                                   ! DJAL
11455: 6bc3:          RETURN                                                         ! DJAL
11456: 6bd3:       ENDIF                                                             ! DJAL
11457: 6bdb: 
11458: 6bdb:       IF LEFT$(DATA.IN$,2) = "CV" THEN BEGIN                            ! HDS
11459: 6c10:          STATE$ = "R"                                                   ! HDS
11460: 6c27:          RETURN                                                         ! HDS
11461: 6c37:       ENDIF                                                             ! HDS
11462: 6c3f: 
11463: 6c3f:       IF LEFT$(DATA.IN$,2) = "PZ" THEN BEGIN                            ! HDS
11464: 6c74:          STATE$ = "S"                                                   ! HDS
11465: 6c8b:          RETURN                                                         ! HDS
11466: 6c9b:       ENDIF                                                             ! HDS
11467: 6ca3: 
11468: 6ca3:       IF LEFT$(DATA.IN$,2) = "OR" THEN BEGIN                            ! HDS
11469: 6cd8:          STATE$ = "T"                                                   ! HDS
11470: 6cef:          RETURN                                                         ! HDS
11471: 6cff:       ENDIF                                                             ! HDS
11472: 6d07: 
11473: 6d07:       IF LEFT$(DATA.IN$,2) = "FH" THEN BEGIN                            ! HDS
11474: 6d3c:          STATE$ = "U"                                                   ! HDS
11475: 6d53:          RETURN                                                         ! HDS
11476: 6d63:       ENDIF                                                             ! HDS
11477: 6d6b: 
11478: 6d6b:       IF LEFT$(DATA.IN$,2) = "OH" THEN BEGIN                            ! HDS
11479: 6da0:          STATE$ = "V"                                                   ! HDS
11480: 6db7:          RETURN                                                         ! HDS
11481: 6dc7:       ENDIF                                                             ! HDS
11482: 6dcf: 
11483: 6dcf:       IF LEFT$(DATA.IN$,2) = "OD" THEN BEGIN                            ! HDS
11484: 6e04:          STATE$ = "W"                                                   ! HDS
11485: 6e1b:          RETURN                                                         ! HDS
11486: 6e2b:       ENDIF                                                             ! HDS
11487: 6e33: 
11488: 6e33:       IF LEFT$(DATA.IN$,2) = "OT" THEN BEGIN                            ! HDS
11489: 6e68:          STATE$ = "X"                                                   ! HDS
11490: 6e7f:          RETURN                                                         ! HDS
11491: 6e8f:       ENDIF                                                             ! HDS
11492: 6e97: 
11493: 6e97:       IF LEFT$(DATA.IN$,2) = "FT" THEN BEGIN                            ! HDS
11494: 6ecc:          STATE$ = "Y"                                                   ! HDS
11495: 6ee3:          RETURN                                                         ! HDS
11496: 6ef3:       ENDIF                                                             ! HDS
11497: 6efb: 
11498: 6efb:       IF LEFT$(DATA.IN$,2) = "OZ" THEN BEGIN                            ! HDS
11499: 6f30:          STATE$ = "Z"                                                   ! HDS
11500: 6f47:          RETURN                                                         ! HDS
11501: 6f57:       ENDIF                                                             ! HDS
11502: 6f5f: 
11503: 6f5f:       IF LEFT$(DATA.IN$,2) = "UE" THEN BEGIN                            ! LLC
11504: 6f94:          STATE$ = "a"         ! lower case !!!!!!                       ! LLC
11505: 6fab:          RETURN                                                         ! LLC
11506: 6fbb:       ENDIF                                                             ! LLC
11507: 6fc3: 
11508: 6fc3:       IF LEFT$(DATA.IN$,2) = "UH" THEN BEGIN                            ! LLC
11509: 6ff8:          STATE$ = "b"         ! lower case !!!!!!                       ! LLC
11510: 700f:          RETURN                                                         ! LLC
11511: 701f:       ENDIF                                                             ! LLC
11512: 7027: 
11513: 7027:       IF LEFT$(DATA.IN$,2) = "UD" THEN BEGIN                            ! LLC
11514: 705c:          STATE$ = "c"         ! lower case !!!!!!                       ! LLC
11515: 7073:          RETURN                                                         ! LLC
11516: 7083:       ENDIF                                                             ! LLC
11517: 708b: 
11518: 708b:       IF LEFT$(DATA.IN$,2) = "UT" THEN BEGIN                            ! LLC
11519: 70c0:          STATE$ = "d"         ! lower case !!!!!!                       ! LLC
11520: 70d7:          RETURN                                                         ! LLC
11521: 70e7:       ENDIF                                                             ! LLC
11522: 70ef: 
11523: 70ef:       IF LEFT$(DATA.IN$,2) = "UR" THEN BEGIN                            ! LLC
11524: 7124:          STATE$ = "e"         ! lower case !!!!!!                       ! LLC
11525: 713b:          RETURN                                                         ! LLC
11526: 714b:       ENDIF                                                             ! LLC
11527: 7153: 
11528: 7153:       IF LEFT$(DATA.IN$,2) = "UZ" THEN BEGIN                            ! LLC
11529: 7188:          STATE$ = "f"         ! lower case !!!!!!                       ! LLC
11530: 719f:          RETURN                                                         ! LLC
11531: 71af:       ENDIF                                                             ! LLC
11532: 71b7: 
11533: 71b7:       IF LEFT$(DATA.IN$,2) = "RI" THEN BEGIN                            ! MMJK
11534: 71ec:          STATE$ = "g"         ! lower case !!!!!!                       ! MMJK
11535: 7203:          RETURN                                                         ! MMJK
11536: 7213:       ENDIF                                                             ! MMJK
11537: 721b: 
11538: 721b:       IF LEFT$(DATA.IN$,2) = "RE" THEN BEGIN                            ! MMJK
11539: 7250:          STATE$ = "h"         ! lower case !!!!!!                       ! MMJK
11540: 7267:          RETURN                                                         ! MMJK
11541: 7277:       ENDIF                                                             ! MMJK
11542: 727f: 
11543: 727f:       IF LEFT$(DATA.IN$,2) = "RH" THEN BEGIN                            ! MMJK
11544: 72b4:          STATE$ = "i"         ! lower case !!!!!!                       ! MMJK
11545: 72cb:          RETURN                                                         ! MMJK
11546: 72db:       ENDIF                                                             ! MMJK
11547: 72e3: 
11548: 72e3:       IF LEFT$(DATA.IN$,2) = "RD" THEN BEGIN                            ! MMJK
11549: 7318:          STATE$ = "j"         ! lower case !!!!!!                       ! MMJK
11550: 732f:          RETURN                                                         ! MMJK
11551: 733f:       ENDIF                                                             ! MMJK
11552: 7347: 
11553: 7347:       IF LEFT$(DATA.IN$,2) = "RT" THEN BEGIN                            ! MMJK
11554: 737c:          STATE$ = "k"         ! lower case !!!!!!                       ! MMJK
11555: 7393:          RETURN                                                         ! MMJK
11556: 73a3:       ENDIF                                                             ! MMJK
11557: 73ab: 
11558: 73ab:       IF LEFT$(DATA.IN$,2) = "RR" THEN BEGIN                            ! MMJK
11559: 73e0:          STATE$ = "l"         ! lower case !!!!!!                       ! MMJK
11560: 73f7:          RETURN                                                         ! MMJK
11561: 7407:       ENDIF                                                             ! MMJK
11562: 740f: 
11563: 740f:       IF LEFT$(DATA.IN$,2) = "RQ" THEN BEGIN                            ! MMJK
11564: 7444:          STATE$ = "m"         ! lower case !!!!!!                       ! MMJK
11565: 745b:          RETURN                                                         ! MMJK
11566: 746b:       ENDIF                                                             ! MMJK
11567: 7473: 
11568: 7473:       IF LEFT$(DATA.IN$,2) = "RO" THEN BEGIN                            ! MMJK
11569: 74a8:          STATE$ = "n"         ! lower case !!!!!!                       ! MMJK
11570: 74bf:          RETURN                                                         ! MMJK
11571: 74cf:       ENDIF                                                             ! MMJK
11572: 74d7: 
11573: 74d7:       IF LEFT$(DATA.IN$,2) = "RZ" THEN BEGIN                            ! MMJK
11574: 750c:          STATE$ = "o"         ! lower case !!!!!!                       ! MMJK
11575: 7523:          RETURN                                                         ! MMJK
11576: 7533:       ENDIF                                                             ! MMJK
11577: 753b: 
11578: 753b:       IF LEFT$(DATA.IN$,2) = "SH" THEN BEGIN                            ! 1.5
11579: 7570:          STATE$ = "p"         ! lower case !!!!!!                       ! 1.5
11580: 7587:          RETURN                                                         ! 1.5
11581: 7597:       ENDIF                                                             ! 1.5
11582: 759f: 
11583: 759f:       IF LEFT$(DATA.IN$,2) = "SR" THEN BEGIN                            ! 1.5
11584: 75d4:          STATE$ = "q"         ! lower case !!!!!!                       ! 1.5
11585: 75eb:          RETURN                                                         ! 1.5
11586: 75fb:       ENDIF                                                             ! 1.5
11587: 7603: 
11588: 7603:       IF LEFT$(DATA.IN$,2) = "ST" THEN BEGIN                            ! 1.5
11589: 7638:          STATE$ = "r"         ! lower case !!!!!!                       ! 1.5
11590: 764f:          RETURN                                                         ! 1.5
11591: 765f:       ENDIF                                                             ! 1.5
11592: 7667: 
11593: 7667:       IF LEFT$(DATA.IN$,2) = "IH" THEN BEGIN                            ! 2.1BG
11594: 769c:          STATE$ = "s"         ! lower case !!!!!!                       ! 2.1BG
11595: 76b3:          RETURN                                                         ! 2.1BG
11596: 76c3:       ENDIF                                                             ! 2.1BG
11597: 76cb: 
11598: 76cb:       IF LEFT$(DATA.IN$,2) = "IR" THEN BEGIN                            ! 2.1BG
11599: 7700:          STATE$ = "t"         ! lower case !!!!!!                       ! 2.1BG
11600: 7717:          RETURN                                                         ! 2.1BG
11601: 7727:       ENDIF                                                             ! 2.1BG
11602: 772f: 
11603: 772f:       IF LEFT$(DATA.IN$,2) = "IT" THEN BEGIN                            ! 2.1BG
11604: 7764:          STATE$ = "u"         ! lower case !!!!!!                       ! 2.1BG
11605: 777b:          RETURN                                                         ! 2.1BG
11606: 778b:       ENDIF                                                             ! 2.1BG
11607: 7793: 
11608: 7793:       IF LEFT$(DATA.IN$,2) = "IZ" THEN BEGIN                            ! 2.1BG
11609: 77c8:          STATE$ = "v"         ! lower case !!!!!!                       ! 2.1BG
11610: 77df:          RETURN                                                         ! 2.1BG
11611: 77ef:       ENDIF                                                             ! 2.1BG
11612: 77f7: 
11613: 77f7:       IF LEFT$(DATA.IN$,2) = "AH" THEN BEGIN                            ! 2.2JAS
11614: 782c:          STATE$ = "w"         ! lower case !!!!!!                       ! 2.2JAS
11615: 7843:          RETURN                                                         ! 2.2JAS
11616: 7853:       ENDIF                                                             ! 2.2JAS
11617: 785b: 
11618: 785b:       IF LEFT$(DATA.IN$,2) = "AR" THEN BEGIN                            ! 2.2JAS
11619: 7890:          STATE$ = "x"         ! lower case !!!!!!                       ! 2.2JAS
11620: 78a7:          RETURN                                                         ! 2.2JAS
11621: 78b7:       ENDIF                                                             ! 2.2JAS
11622: 78bf: 
11623: 78bf:       IF LEFT$(DATA.IN$,2) = "AT" THEN BEGIN                            ! 2.2JAS
11624: 78f4:          STATE$ = "y"         ! lower case !!!!!!                       ! 2.2JAS
11625: 790b:          RETURN                                                         ! 2.2JAS
11626: 791b:       ENDIF                                                             ! 2.2JAS
11627: 7923: 
11628: 7923:       IF LEFT$(DATA.IN$,2) = "AZ" THEN BEGIN                            ! 2.2JAS
11629: 7958:          STATE$ = "z"         ! lower case !!!!!!                       ! 2.2JAS
11630: 796f:          RETURN                                                         ! 2.2JAS
11631: 797f:       ENDIF                                                             ! 2.2JAS
11632: 7987:       
11633: 7987:       IF LEFT$(DATA.IN$,2) = "YR" THEN BEGIN                            ! 2.10BG
11634: 79bc:          STATE$ = "1"                                                   ! 2.10BG
11635: 79d3:          RETURN                                                         ! 2.10BG
11636: 79e3:       ENDIF                                                             ! 2.10BG
11637: 79eb:       
11638: 79eb:       IF LEFT$(DATA.IN$,2) = "YO" THEN BEGIN                            ! 2.10BG
11639: 7a20:          STATE$ = "2"                                                   ! 2.10BG
11640: 7a37:          RETURN                                                         ! 2.10BG
11641: 7a47:       ENDIF                                                             ! 2.10BG
11642: 7a4f:       
11643: 7a4f:       IF LEFT$(DATA.IN$,2) = "YH" THEN BEGIN                            ! 2.10BG
11644: 7a84:          STATE$ = "3"                                                   ! 2.10BG
11645: 7a9b:          RETURN                                                         ! 2.10BG
11646: 7aab:       ENDIF                                                             ! 2.10BG
11647: 7ab3:       
11648: 7ab3:       IF LEFT$(DATA.IN$,2) = "YD" THEN BEGIN                            ! 2.10BG
11649: 7ae8:          STATE$ = "4"                                                   ! 2.10BG
11650: 7aff:          RETURN                                                         ! 2.10BG
11651: 7b0f:       ENDIF                                                             ! 2.10BG
11652: 7b17:       
11653: 7b17:       IF LEFT$(DATA.IN$,2) = "YT" THEN BEGIN                            ! 2.10BG
11654: 7b4c:          STATE$ = "5"                                                   ! 2.10BG
11655: 7b63:          RETURN                                                         ! 2.10BG
11656: 7b73:       ENDIF                                                             ! 2.10BG
11657: 7b7b:       
11658: 7b7b:       IF LEFT$(DATA.IN$,2) = "YZ" THEN BEGIN                            ! 2.10BG
11659: 7bb0:          STATE$ = "6"                                                   ! 2.10BG
11660: 7bc7:          RETURN                                                         ! 2.10BG
11661: 7bd7:       ENDIF                                                             ! 2.10BG
11662: 7bdf: 
11663: 7bdf:       IF LEFT$(DATA.IN$,2) = "TA" THEN BEGIN                            ! 2.12SH
11664: 7c14:          STATE$ = "7"                                                   ! 2.12SH
11665: 7c2b:          RETURN                                                         ! 2.12SH
11666: 7c3b:       ENDIF                                                             ! 2.12SH
11667: 7c43: 
11668: 7c43:       IF LEFT$(DATA.IN$,2) = "TF" THEN BEGIN                            ! 2.12SH
11669: 7c78:          STATE$ = "8"                                                   ! 2.12SH
11670: 7c8f:          RETURN                                                         ! 2.12SH
11671: 7c9f:       ENDIF                                                             ! 2.12SH
11672: 7ca7: 
11673: 7ca7:       IF LEFT$(DATA.IN$,2) = "TI" THEN BEGIN                            ! 2.12SH
11674: 7cdc:          STATE$ = "9"                                                   ! 2.12SH
11675: 7cf3:          RETURN                                                         ! 2.12SH
11676: 7d03:       ENDIF                                                             ! 2.12SH
11677: 7d0b: 
11678: 7d0b:       IF LEFT$(DATA.IN$,2) = "TJ" THEN BEGIN                            ! 2.12SH
11679: 7d40:          STATE$ = ":"                                                   ! 2.12SH
11680: 7d57:          RETURN                                                         ! 2.12SH
11681: 7d67:       ENDIF                                                             ! 2.12SH
11682: 7d6f: 
11683: 7d6f:       IF LEFT$(DATA.IN$,2) = "TK" THEN BEGIN                            ! 2.12SH
11684: 7da4:          STATE$ = ";"                                                   ! 2.12SH
11685: 7dbb:          RETURN                                                         ! 2.12SH
11686: 7dcb:       ENDIF                                                             ! 2.12SH
11687: 7dd3: 
11688: 7dd3:       IF LEFT$(DATA.IN$,2) = "TL" THEN BEGIN                            ! 2.12SH
11689: 7e08:          STATE$ = "<"                                                   ! 2.12SH
11690: 7e1f:          RETURN                                                         ! 2.12SH
11691: 7e2f:       ENDIF                                                             ! 2.12SH
11692: 7e37: 
11693: 7e37:       IF LEFT$(DATA.IN$,2) = "TZ" THEN BEGIN                            ! 2.12SH
11694: 7e6c:          STATE$ = "="                                                   ! 2.12SH
11695: 7e83:          RETURN                                                         ! 2.12SH
11696: 7e93:       ENDIF                                                             ! 2.12SH
11697: 7e9b:       
11698: 7e9b:       IF LEFT$(DATA.IN$,2) = "@@" THEN BEGIN                            ! 2.8CS
11699: 7ed0:          STATE$ = "@"         ! Signal from PSS38 to end                ! 2.8CS
11700: 7ee7:          RETURN                                                         ! 2.8CS
11701: 7ef7:       ENDIF                                                             ! 2.8CS
11702: 7eff: 
11703: 7eff:       STATE$ = "*"                                                      ! HDS
11704: 7f16: 
11705: 7f16: RETURN
11706: 7f26: 
11707: 7f26: \******************************************************************************
11708: 7f26: \***
11709: 7f26: \***   LOG.TO.AUDIT.FILE
11710: 7f26: \***
11711: 7f26: \******************************************************************************
11712: 7f26: 
11713: 7f26:    LOG.TO.AUDIT.FILE:
11714: 7f36: 
11715: 7f36:         IF CSR.AUDIT.OPEN.FLAG$ = "N" THEN BEGIN                        ! EPAB
11716: 7f54:            IF END #CSR.AUDIT.SESS.NUM% THEN CREATE.AUDIT.FILE           ! EPAB
11717: 7f70:            OPEN CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM% APPEND           ! EPAB
11718: 7f97:            CSR.AUDIT.OPEN.FLAG$ = "Y"                                   ! EPAB
11719: 7fae:         ENDIF                                                           ! EPAB
11720: 7fb6: 
11721: 7fb6:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$           ! EPAB
11722: 7fe5:         IF LEFT$(APPL$,4) = "LOAD" THEN BEGIN                           ! ILC
11723: 801a:            CLOSE CSR.AUDIT.SESS.NUM%                                    ! ILC
11724: 802e:            CSR.AUDIT.OPEN.FLAG$ = "N"                                   ! ILC
11725: 8045:         ENDIF                                                           ! ILC
11726: 804d: 
11727: 804d:         RETURN
11728: 805d: 
11729: 805d:    CREATE.AUDIT.FILE:                                                   ! EPAB
11730: 806d: 
11731: 806d:         CREATE CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM%                   ! EPAB
11732: 8094:         CSR.AUDIT.OPEN.FLAG$ = "Y"                                      ! EPAB
11733: 80ab:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;                          \ EPAB
11734: 80d3:         "                          LDT/PDT Tracking Log"                ! LLC
11735: 80d3:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;" "                       ! EPAB
11736: 80fb:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"File Creation Date " +   \ EPAB
11737: 8195:           LEFT$(DATE$,2) + "/" + MID$(DATE$,3,2) + "/" + RIGHT$(DATE$,2)! EPAB
11738: 8195:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;"Currently executing " +  \ EPAB
11739: 81cc: \         "PSS37 Version 24 (A5B), Created on 4th Jan 2005"             ! 1.2 ! 2.2JAS  ! 2.7CS
11740: 81cc: \         "PSS37 Version 25 (A7B), Created on 22nd Dec 2006"            ! 2.9NWB
11741: 81cc:           "PSS37 Version 26 (A7C), Created on 11th May 2007"            ! 1.5BG
11742: 81cc:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;" "                       ! EPAB
11743: 81f4:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;" "                       ! EPAB
11744: 821c: 
11745: 821c:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$           ! EPAB
11746: 824b: 
11747: 824b:         RETURN
11748: 825b: 
11749: 825b: \******************************************************************************
11750: 825b: \***
11751: 825b: \***   LOG.TO.LDTAF.FILE
11752: 825b: \***
11753: 825b: \******************************************************************************
11754: 825b: 
11755: 825b:    LOG.TO.LDTAF.FILE:                                                   ! MMJK
11756: 826b:                                                                         ! MMJK
11757: 826b:         CURRENT.KEY$ = ""                                               ! MMJK
11758: 8280:         CURR.SESS.NUM% = LDTAF.SESS.NUM%                                ! MMJK
11759: 8292:         IF LDTAF.OPEN.FLAG$ <> "Y" THEN BEGIN                           ! MMJK
11760: 82b0:            IF END #LDTAF.SESS.NUM% THEN CREATE.LDTAF.FILE               ! MMJK
11761: 82cc:            OPEN LDTAF.FILE.NAME$ AS LDTAF.SESS.NUM% APPEND              ! MMJK
11762: 82f3:            LDTAF.OPEN.FLAG$ = "Y"                                       ! MMJK
11763: 830a:         ENDIF                                                           ! MMJK
11764: 8312:         IF LDTAF.LINK.TYPE% <> 0 THEN                                   \ MMJK
11765: 8324:           IF WRITE.LDTAF THEN GOTO WRITE.ERROR                          ! MMJK
11766: 8338:         LDTAF.OPEN.FLAG$ = "N"                                          ! MMJK
11767: 834f:         CLOSE LDTAF.SESS.NUM%                                           ! MMJK
11768: 8363:                                                                         ! MMJK
11769: 8363:    RETURN                                                               ! MMJK
11770: 8373:                                                                         ! MMJK
11771: 8373:    CREATE.LDTAF.FILE:                                                   ! MMJK
11772: 8383:                                                                         ! MMJK
11773: 8383:         IF END #LDTAF.SESS.NUM% THEN CREATE.ERROR                       ! MMJK
11774: 839f:           CREATE POSFILE LDTAF.FILE.NAME$ AS LDTAF.SESS.NUM%            \ MMJK
11775: 83c5:             MIRRORED ATCLOSE                                            ! MMJK
11776: 83c5:         LDTAF.OPEN.FLAG$ = "Y"                                          ! MMJK
11777: 83dc:         IF LDTAF.LINK.TYPE% <> 0 THEN                                   \ MMJK
11778: 83ee:           IF WRITE.LDTAF THEN GOTO WRITE.ERROR                          ! MMJK
11779: 8402:         LDTAF.OPEN.FLAG$ = "N"                                          ! MMJK
11780: 8419:         CLOSE LDTAF.SESS.NUM%                                           ! MMJK
11781: 842d:                                                                         ! MMJK
11782: 842d:    RETURN                                                               ! MMJK
11783: 843d: 
11784: 843d: \*****************************************************************************
11785: 843d: \***
11786: 843d: \***   ASN.CARTON.HEADER.RECEIVED:
11787: 843d: \***
11788: 843d: \*****************************************************************************
11789: 843d: 
11790: 843d: ASN.CARTON.HEADER.RECEIVED:                                                   !2.9NWB
11791: 844d: 
11792: 844d:    IF CB.OPEN.FLAG$ = "Y" THEN BEGIN                                          !2.9NWB
11793: 8468:       DELETE CB.SESS.NUM%                                                     !2.9NWB
11794: 847c:       CB.OPEN.FLAG$ = "N"                                                     !2.9NWB
11795: 8491:    ENDIF                                                                      !2.9NWB
11796: 8499: 
11797: 8499:    CB.FN$ = CB.FILE.NAME$ + TIME$                                             !2.9NWB
11798: 84bd:    CB.TN$ = CB.FN$ + ".TMP"                                                   !2.9NWB
11799: 84dd:    IF END #CB.SESS.NUM% THEN CREATE.ERROR                                     !2.9NWB
11800: 84f9:    CREATE CB.TN$ AS CB.SESS.NUM%                                              !2.9NWB
11801: 851d:    CB.OPEN.FLAG$ = "Y"                                                        !2.9NWB
11802: 8532: 
11803: 8532:    ASN.RCD.CNT%   = 1                           ! 1st rcd rcvd                !2.9NWB
11804: 8540: 
11805: 8540: RETURN                                                                        !2.9NWB
11806: 8550: 
11807: 8550: \*****************************************************************************
11808: 8550: \***
11809: 8550: \***   AUTOMATIC.CARTON.BOOK.IN:
11810: 8550: \***
11811: 8550: \*****************************************************************************
11812: 8550: 
11813: 8550: AUTOMATIC.CARTON.BOOK.IN:                                                     !2.9NWB
11814: 8560: 
11815: 8560:    IF CB.OPEN.FLAG$ = "N" THEN BEGIN                                          !2.9NWB
11816: 857b:       GOSUB ASN.CARTON.HEADER.RECEIVED                                        !2.9NWB
11817: 858f:    ENDIF ELSE BEGIN                                                           !2.9NWB
11818: 8597:       ASN.RCD.CNT%   = ASN.RCD.CNT% +1          ! Increment                   !2.9NWB
11819: 85a3:    ENDIF                                                                      !2.9NWB
11820: 85ab: 
11821: 85ab:    CB.REC.TYPE$       = "C"                                                   !2.9NWB
11822: 85c2:    CB.CARTON.BARCODE$ = MID$(DATA.IN$,  3, 14)                                !2.9NWB
11823: 85e9:    CB.REPORT.RQD$     = "Y"                                                   !2.9NWB
11824: 8600: 
11825: 8600:    GOSUB WRITE.DATA.TO.CB.FILE                                                !2.9NWB
11826: 8612: 
11827: 8612: RETURN                                                                        !2.9NWB
11828: 8622: 
11829: 8622: \*****************************************************************************
11830: 8622: \***
11831: 8622: \***   MANUAL.CARTON.BOOK.IN:
11832: 8622: \***
11833: 8622: \*****************************************************************************
11834: 8622: 
11835: 8622: MANUAL.CARTON.BOOK.IN:                                                        !2.9NWB
11836: 8632: 
11837: 8632:    IF CB.OPEN.FLAG$ = "N" THEN BEGIN                                          !2.9NWB
11838: 864d:       GOSUB ASN.CARTON.HEADER.RECEIVED                                        !2.9NWB
11839: 8661:    ENDIF ELSE BEGIN                                                           !2.9NWB
11840: 8669:       ASN.RCD.CNT%   = ASN.RCD.CNT% +1          ! Increment                   !2.9NWB
11841: 8675:    ENDIF                                                                      !2.9NWB
11842: 867d: 
11843: 867d:    IF LEFT$(DATA.IN$, 2) = "XM" THEN BEGIN                                    !2.9NWB
11844: 86b5:       CB.REC.TYPE$        = "H"                                               !2.9NWB
11845: 86cc:       CB.CARTON.BARCODE$  = MID$(DATA.IN$,  3, 14)                            !2.9NWB
11846: 86f3:       IF MAN.REC.CNT% <> 0 THEN BEGIN                                         !2.9NWB
11847: 8702:          ! Log to Audit File                                                  !2.9NWB
11848: 8702:          CSR.AUDIT.DATA$ = "ASN Processing - Audit/No Carton - "              \2.9NWB
11849: 8720:                          + "Out of Sequence Header Received. "                !2.9NWB
11850: 8720:          GOSUB LOG.TO.AUDIT.FILE                                              !2.9NWB
11851: 8732:       ENDIF                                                                   !2.9NWB
11852: 873a:       MAN.REC.CNT%        = 1                                                 !2.9NWB
11853: 874b:    ENDIF ELSE IF LEFT$(DATA.IN$, 2) = "XU" THEN BEGIN                         !2.9NWB
11854: 8780:       CB.REC.TYPE$        = "D"                                               !2.9NWB
11855: 8797:       CB.ITEM.BARCODE$    = MID$(DATA.IN$,  3, 13)                            !2.9NWB
11856: 87be:       CB.ITEM.QUANTITY$   = MID$(DATA.IN$, 16,  4)                            !2.9NWB
11857: 87e5:       MAN.REC.CNT%        = MAN.REC.CNT% +1                                   !2.9NWB
11858: 87f4:    ENDIF ELSE IF LEFT$(DATA.IN$, 2) = "XO" THEN BEGIN                         !2.9NWB
11859: 882c:       CB.REC.TYPE$        = "T"                                               !2.9NWB
11860: 8843:       CB.ITEM.COUNT$      = MID$(DATA.IN$,  3, 5)                             !2.9NWB
11861: 886a:       CB.MANUAL.COUNT%    = VAL(MID$(DATA.IN$,  8, 4))                        !2.9NWB
11862: 8893:       MAN.REC.CNT%        = MAN.REC.CNT% +1                                   !2.9NWB
11863: 889f:       IF MAN.REC.CNT% <> CB.MANUAL.COUNT% THEN BEGIN                          !2.9NWB
11864: 88b0:          ! Log to Audit File                                                  !2.9NWB
11865: 88b0:          CSR.AUDIT.DATA$ = "ASN Processing - Audit/No Carton - "              \2.9NWB
11866: 8902:                          + "Incorrect Number of Records Received. "           \2.9NWB
11867: 8902:                          + STR$(MAN.REC.CNT%) + " Received, "                 \2.9NWB
11868: 8902:                          + STR$(CB.MANUAL.COUNT%) + " Expected."              !2.9NWB
11869: 8902:          GOSUB LOG.TO.AUDIT.FILE                                              !2.9NWB
11870: 8914:       ENDIF                                                                   !2.9NWB
11871: 891c:       MAN.REC.CNT%        = 0                   ! Reset                       !2.9NWB
11872: 892a:    ENDIF                                                                      !2.9NWB
11873: 8932: 
11874: 8932:    GOSUB WRITE.DATA.TO.CB.FILE                                                !2.9NWB
11875: 8944: 
11876: 8944: RETURN                                                                        !2.9NWB
11877: 8954: 
11878: 8954: \*****************************************************************************
11879: 8954: \***
11880: 8954: \***   WRITE.DATA.TO.CB.FILE:
11881: 8954: \***
11882: 8954: \*****************************************************************************
11883: 8954: 
11884: 8954: WRITE.DATA.TO.CB.FILE:                                                        !2.9NWB
11885: 8964: 
11886: 8964:    RC% = WRITE.CB                                                             !2.9NWB
11887: 8978:    IF RC% <> 0 THEN BEGIN                                                     !2.9NWB
11888: 898a:       GOSUB WRITE.ERROR                                                       !2.9NWB
11889: 899c:    ENDIF                                                                      !2.9NWB
11890: 89a4: 
11891: 89a4: RETURN                                                                        !2.9NWB
11892: 89b4: 
11893: 89b4: \*****************************************************************************
11894: 89b4: \***
11895: 89b4: \***   ASN.CARTON.EOT.RECEIVED:
11896: 89b4: \***
11897: 89b4: \*****************************************************************************
11898: 89b4: 
11899: 89b4: ASN.CARTON.EOT.RECEIVED:                                                      !2.9NWB
11900: 89c4: 
11901: 89c4:    CB.RECORD.COUNT% = VAL(MID$(DATA.IN$,  3,  5))                             !2.9NWB
11902: 89ed: 
11903: 89ed:    ASN.RCD.CNT%   = ASN.RCD.CNT% +1             ! Last rcd rcvd               !2.9NWB
11904: 89f9: 
11905: 89f9:    IF CB.RECORD.COUNT% <> ASN.RCD.CNT% THEN BEGIN                             !2.9NWB
11906: 8a0a:       ! Log to Audit File                                                     !2.9NWB
11907: 8a0a:       CSR.AUDIT.DATA$ = "ASN Processing - PDT Transmission - "                \2.9NWB
11908: 8a5c:                       + "Incorrect Number of Records Received. "              \2.9NWB
11909: 8a5c:                       + STR$(ASN.RCD.CNT%) + " Received, "                    \2.9NWB
11910: 8a5c:                       + STR$(CB.RECORD.COUNT%) + " Expected."                 !2.9NWB
11911: 8a5c:       GOSUB LOG.TO.AUDIT.FILE                                                 !2.9NWB
11912: 8a6e:    ENDIF                                                                      !2.9NWB
11913: 8a76: 
11914: 8a76:    CLOSE CB.SESS.NUM%                                                         !2.9NWB
11915: 8a8a:    RC% = RENAME(CB.FN$, CB.TN$)                                               !2.9NWB
11916: 8aae:    WHILE RC% <> -1                                                            !2.9NWB
11917: 8ab8:       CB.FN$ = CB.FILE.NAME$ + TIME$                                          !2.9NWB
11918: 8adc:       RC% = RENAME(CB.FN$, CB.TN$)                                            !2.9NWB
11919: 8b00:    WEND                                                                       !2.9NWB
11920: 8b12:    CB.OPEN.FLAG$ = "N"                                                        !2.9NWB
11921: 8b27: 
11922: 8b27:    GOSUB START.PSD62                                                          !2.9NWB
11923: 8b39: 
11924: 8b39:    RE.CHAIN = TRUE                                                            !2.9NWB
11925: 8b4f:    RECEIVE.STATE$ = "?"                                                       !2.9NWB
11926: 8b66: 
11927: 8b66: RETURN                                                                        !2.9NWB
11928: 8b76: 
11929: 8b76: \*****************************************************************************
11930: 8b76: \***
11931: 8b76: \***   START.PSD62:
11932: 8b76: \***
11933: 8b76: \*****************************************************************************
11934: 8b76: 
11935: 8b76: START.PSD62:                                                                  !2.9NWB
11936: 8b86: 
11937: 8b86:    ADX.RET.CODE% = ADXSTART("ADX_UPGM:PSD62.286",                             \2.9NWB
11938: 8bb2:                             CB.FN$,                                           \2.9NWB
11939: 8bb2:                             "Carton Book In Batch Program")                   !2.9NWB
11940: 8bb2: 
11941: 8bb2: RETURN                                                                        !2.9NWB
11942: 8bc2: 
11943: 8bc2: \*****************************************************************************
11944: 8bc2: \***
11945: 8bc2: \***   CSR.LIST.HEADER.RECEIVED:   (removed v2.9)
11946: 8bc2: \***
11947: 8bc2: \*****************************************************************************
11948: 8bc2: 
11949: 8bc2: \  CSR.LIST.HEADER.RECEIVED:
11950: 8bc2: 
11951: 8bc2: \       IF (FN.VALIDATE.DATA( DATA.IN$ , 9 ) = 0) OR                    \ LMJK!2.9NWB
11952: 8bc2: \          (CSRBF.OPEN.FLAG$ = "N") THEN BEGIN                          ! LMJK!2.9NWB
11953: 8bc2: \         RECEIVE.STATE$ = "*"                                          ! LMJK!2.9NWB
11954: 8bc2: \         RETURN                                                        ! LMJK!2.9NWB
11955: 8bc2: \       ENDIF                                                           ! LMJK!2.9NWB
11956: 8bc2: 
11957: 8bc2: \       IF CSR.AUDIT.OPEN.FLAG$ = "N" THEN BEGIN                        ! EPAB!2.9NWB
11958: 8bc2: \          IF END #CSR.AUDIT.SESS.NUM% THEN AUDIT.FAIL                  ! EPAB!2.9NWB
11959: 8bc2: \          OPEN CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM% APPEND           ! EPAB!2.9NWB
11960: 8bc2: \          CSR.AUDIT.OPEN.FLAG$ = "Y"                                   ! EPAB!2.9NWB
11961: 8bc2: \       ENDIF                                                           ! EPAB!2.9NWB
11962: 8bc2: 
11963: 8bc2: \       IF MID$(DATA.IN$,6,6) <> "000000" THEN BEGIN                    ! EPAB!2.9NWB
11964: 8bc2: \       CSR.AUDIT.DATA$ = "Received Unit " +                            \ EPAB!2.9NWB
11965: 8bc2: \          MID$(DATA.IN$,4,2) + " Frequency " + MID$(DATA.IN$,3,1) +    \ EPAB!2.9NWB
11966: 8bc2: \          " Counted on " + MID$(DATA.IN$,6,2) + "/" +                  \ EPAB!2.9NWB
11967: 8bc2: \          MID$(DATA.IN$,8,2) + "/" + MID$(DATA.IN$,10,2) + " at " +    \ EPAB!2.9NWB
11968: 8bc2: \          MID$(DATA.IN$,12,2) + ":" + MID$(DATA.IN$,14,2)              ! EPAB!2.9NWB
11969: 8bc2: \       ENDIF ELSE BEGIN                                                ! EPAB!2.9NWB
11970: 8bc2: \       CSR.AUDIT.DATA$ = "Received Unit " +                            \ EPAB!2.9NWB
11971: 8bc2: \          MID$(DATA.IN$,4,2) + " Frequency " + MID$(DATA.IN$,3,1)      ! EPAB!2.9NWB
11972: 8bc2: \       ENDIF                                                           ! EPAB!2.9NWB
11973: 8bc2: \       CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] PDT No." +    \ EPAB!2.9NWB
11974: 8bc2: \                         CURR.TERMINAL$ + " " + CSR.AUDIT.DATA$        ! EPAB!2.9NWB
11975: 8bc2: \       PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$           ! EPAB!2.9NWB
11976: 8bc2: 
11977: 8bc2: \  AUDIT.FAIL:                                                          ! EPAB!2.9NWB
11978: 8bc2: 
11979: 8bc2: \       GOSUB WRITE.DATA.TO.CSR.BUFFER                                  ! EPAB!2.9NWB
11980: 8bc2: 
11981: 8bc2: \ RETURN                                                                      !2.9NWB
11982: 8bc2: 
11983: 8bc2: 
11984: 8bc2: \******************************************************************************
11985: 8bc2: \***
11986: 8bc2: \***   LOG.ABORT.TO.AUDIT.FILE
11987: 8bc2: \***
11988: 8bc2: \******************************************************************************
11989: 8bc2: 
11990: 8bc2:    LOG.ABORT.TO.AUDIT.FILE:
11991: 8bd2: 
11992: 8bd2:         IF CSR.AUDIT.OPEN.FLAG$ = "N" THEN BEGIN                        ! EPAB
11993: 8bf0:            OPEN CSR.AUDIT.FILE$ AS CSR.AUDIT.SESS.NUM% APPEND           ! EPAB
11994: 8c17:            CSR.AUDIT.OPEN.FLAG$ = "Y"                                   ! EPAB
11995: 8c2e:         ENDIF                                                           ! EPAB
11996: 8c36: 
11997: 8c36:         PRINT USING "&"; #CSR.AUDIT.SESS.NUM%;CSR.AUDIT.DATA$           ! EPAB
11998: 8c65:         CLOSE CSR.AUDIT.SESS.NUM%                                       ! EPAB
11999: 8c79:         CSR.AUDIT.OPEN.FLAG$ = "N"                                      ! EPAB
12000: 8c90: 
12001: 8c90:   RETURN
12002: 8ca0: 
12003: 8ca0: 
12004: 8ca0: \******************************************************************************
12005: 8ca0: \***
12006: 8ca0: \***   TIDY.UP
12007: 8ca0: \***
12008: 8ca0: \***      if PDT currently being 'held' then release it
12009: 8ca0: \***
12010: 8ca0: \***      if tidy then RETURN
12011: 8ca0: \***
12012: 8ca0: \***      If stocktake file open then close it                         1.5
12013: 8ca0: \***
12014: 8ca0: \***      if a CSR workfile exists, then process it
12015: 8ca0: \***
12016: 8ca0: \***      clear / tidy-up session variables
12017: 8ca0: \***
12018: 8ca0: \***   RETURN
12019: 8ca0: \***
12020: 8ca0: \******************************************************************************
12021: 8ca0: 
12022: 8ca0:    TIDY.UP:
12023: 8cb0: 
12024: 8cb0:       IF HOLD.FLAG$ = "Y" THEN GOSUB RELEASE.PDT                        ! DSW
12025: 8cd8: 
12026: 8cd8:       IF TIDY.FLAG$ = "Y" THEN RETURN
12027: 8cfb: 
12028: 8cfb:       GOSUB CLOSE.OPEN.FILES
12029: 8d0d: 
12030: 8d0d:       IF STKTK.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.5
12031: 8d28:           CLOSE STKTK.SESS.NUM%                                         ! 1.5
12032: 8d3c:           STKTK.OPEN.FLAG$ = "N"                                        ! 1.5
12033: 8d51:       ENDIF                                                             ! 1.5
12034: 8d59: 
12035: 8d59: \     PROCESS.CSR.WORKFILE$ = "N"                                       !2.9NWB
12036: 8d59: 
12037: 8d59:       CURR.TERMINAL$ = "??????"
12038: 8d70:       CURR.LIST$ = "0000"
12039: 8d87:       TRAILER.LIST$ = "0000"
12040: 8d9e:       LIST.COUNT% = 0
12041: 8daf:       ITEM.COUNT% = 0
12042: 8dc0:       FILE.HEADER.LISTS% = 0
12043: 8dd1:       FILE.TRAILER.LISTS% = 0
12044: 8de2:       LIST.TRAILER.ITEMS% = 0
12045: 8df3:       LIST.BC$ = ""
12046: 8e0a: 
12047: 8e0a:       TIDY.FLAG$ = "Y"
12048: 8e1f: 
12049: 8e1f:       GOSUB SEND.XON                                                    ! DSW
12050: 8e31: 
12051: 8e31:    RETURN
12052: 8e41: 
12053: 8e41: \******************************************************************************
12054: 8e41: \***
12055: 8e41: \***   ZEROISE.CITEM:
12056: 8e41: \***
12057: 8e41: \***      all "on order for this PDT" figures in CSRITEM are set to 0
12058: 8e41: \***
12059: 8e41: \***   RETURN
12060: 8e41: \***
12061: 8e41: \******************************************************************************
12062: 8e41: 
12063: 8e41: \  ZEROISE.CITEM:                                                       ! DJAL!2.9NWB
12064: 8e41: 
12065: 8e41: \     SB.MESSAGE$ = "PDT Support - Processing item file"                ! DSW !2.9NWB
12066: 8e41: \     GOSUB SB.BG.MESSAGE                                               ! DSW !2.9NWB
12067: 8e41: 
12068: 8e41: \     CURR.SESS.NUM% = CITEM.SESS.NUM%                                  ! DSW !2.9NWB
12069: 8e41: \     IF END #CITEM.SESS.NUM% THEN OPEN.ERROR                           ! DJAL!2.9NWB
12070: 8e41: \     OPEN CITEM.FILE.NAME$ DIRECT RECL 512 AS CITEM.SESS.NUM% NODEL    ! DJAL!2.9NWB
12071: 8e41: \     CITEM.OPEN.FLAG$ = "Y"                                            ! DSW !2.9NWB
12072: 8e41: 
12073: 8e41: \     END.OF.CITEM$ = "N"                                               ! DJAL!2.9NWB
12074: 8e41: 
12075: 8e41: \     SECTOR.COUNT% = 2                                                 ! DJAL!2.9NWB
12076: 8e41: \     CURRENT.KEY$ ="SECTOR"                                            ! DJAL!2.9NWB
12077: 8e41: \     IF END #CITEM.SESS.NUM% THEN READ.ERROR                           ! DJAL!2.9NWB
12078: 8e41: \     READ FORM "C4,C508"; #CITEM.SESS.NUM%, SECTOR.COUNT%;             \ DJAL!2.9NWB
12079: 8e41: \        FILLER$, CITEM.RECORD$                                         ! DJAL!2.9NWB
12080: 8e41: 
12081: 8e41: \     WHILE END.OF.CITEM$ = "N"                                         ! DJAL!2.9NWB
12082: 8e41: \        POSITION% = 1                                                  ! DJAL!2.9NWB
12083: 8e41: \        CITEM.SECTOR.ALTERED$ = "N"                                    ! DJAL!2.9NWB
12084: 8e41: \        WHILE POSITION% < 448                                          \ DSW !2.9NWB
12085: 8e41: \        AND MID$(CITEM.RECORD$,POSITION%,4) <> PK4$                    ! DSW !2.9NWB
12086: 8e41: \           IF MID$(CITEM.RECORD$,POSITION% + 14,2) <> PK2$ THEN BEGIN  ! DSW !2.9NWB
12087: 8e41: \              CITEM.SECTOR.ALTERED$ = "Y"                              ! DSW !2.9NWB
12088: 8e41: \              CITEM.RECORD$ = LEFT$(CITEM.RECORD$,POSITION% + 13) +    \ DSW !2.9NWB
12089: 8e41: \                              PK2$ +                                   \ DSW !2.9NWB
12090: 8e41: \                              RIGHT$(CITEM.RECORD$,                    \ DSW !2.9NWB
12091: 8e41: \                                LEN(CITEM.RECORD$) - POSITION% - 15)   ! DSW !2.9NWB
12092: 8e41: \           ENDIF                                                       ! DSW !2.9NWB
12093: 8e41: \           POSITION% = POSITION% + 64                                  ! DJAL!2.9NWB
12094: 8e41: \        WEND                                                           ! DJAL!2.9NWB
12095: 8e41: \        IF CITEM.SECTOR.ALTERED$ = "Y" THEN BEGIN                      ! DSW !2.9NWB
12096: 8e41: \           IF END #CITEM.SESS.NUM% THEN WRITE.ERROR                    ! DSW !2.9NWB
12097: 8e41: \           WRITE FORM "C4,C508"; #CITEM.SESS.NUM%, SECTOR.COUNT%;      \ DSW !2.9NWB
12098: 8e41: \                      FILLER$, CITEM.RECORD$                           ! DSW !2.9NWB
12099: 8e41: \        ENDIF                                                          ! DSW !2.9NWB
12100: 8e41: \        SECTOR.COUNT% = SECTOR.COUNT% + 1                              ! DJAL!2.9NWB
12101: 8e41: \        IF END #CITEM.SESS.NUM% THEN END.OF.CITEM                      ! DJAL!2.9NWB
12102: 8e41: \        READ FORM "C4,C508"; #CITEM.SESS.NUM%, SECTOR.COUNT%;          \ DJAL!2.9NWB
12103: 8e41: \                  FILLER$,CITEM.RECORD$                                ! DJAL!2.9NWB
12104: 8e41: \        GOTO ZEROISE.CITEM.CONTINUE                                    ! DJAL!2.9NWB
12105: 8e41: \  END.OF.CITEM:                                                        ! DJAL!2.9NWB
12106: 8e41: \        END.OF.CITEM$ = "Y"                                            ! DJAL!2.9NWB
12107: 8e41: \  ZEROISE.CITEM.CONTINUE:                                              ! DJAL!2.9NWB
12108: 8e41: \     WEND                                                              ! DJAL!2.9NWB
12109: 8e41: 
12110: 8e41: \     IF CITEM.OPEN.FLAG$ = "Y" THEN BEGIN                              ! DSW !2.9NWB
12111: 8e41: \        CLOSE CITEM.SESS.NUM%                                          ! DSW !2.9NWB
12112: 8e41: \        CITEM.OPEN.FLAG$ = "N"                                         ! DSW !2.9NWB
12113: 8e41: \     ENDIF                                                             ! DSW !2.9NWB
12114: 8e41: 
12115: 8e41: \  RETURN                                                               ! DJAL!2.9NWB
12116: 8e41: 
12117: 8e41: \******************************************************************************
12118: 8e41: \***
12119: 8e41: \***   CLOSE.OPEN.FILES:
12120: 8e41: \***
12121: 8e41: \***      close any open files, except pipe sessions
12122: 8e41: \***
12123: 8e41: \***   RETURN
12124: 8e41: \***
12125: 8e41: \******************************************************************************
12126: 8e41: 
12127: 8e41:    CLOSE.OPEN.FILES:
12128: 8e51: 
12129: 8e51:       CLOSE BCSMF.SESS.NUM%                                             ! DSW
12130: 8e65:       BCSMF.OPEN.FLAG$ = "N"                                            ! DSW
12131: 8e7c: 
12132: 8e7c:       CLOSE CHKBF.SESS.NUM%                                             ! DSW
12133: 8e92:       CHKBF.OPEN.FLAG$ = "N"                                            ! DSW
12134: 8ea9: 
12135: 8ea9: \     IF CIMF.OPEN.FLAG$ = "Y" THEN BEGIN                               ! 1.9D!2.9NWB
12136: 8ea9: \        CLOSE CIMF.SESS.NUM%                                           ! DSW !2.9NWB
12137: 8ea9: \        CIMF.OPEN.FLAG$ = "N"                                          ! DSW !2.9NWB
12138: 8ea9: \     ENDIF                                                             ! 1.9D!2.9NWB
12139: 8ea9: 
12140: 8ea9: \     CLOSE CITEM.SESS.NUM%                                             ! DSW !2.9NWB
12141: 8ea9: \     CITEM.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
12142: 8ea9: 
12143: 8ea9: \     CLOSE CSRBF.SESS.NUM%                                             ! DSW !2.9NWB
12144: 8ea9: \     CSRBF.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
12145: 8ea9: 
12146: 8ea9: \     CLOSE CSRWF.SESS.NUM%                                             ! DSW !2.9NWB
12147: 8ea9: \     CSRWF.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
12148: 8ea9: 
12149: 8ea9: !     CLOSE FPF.SESS.NUM%                                               ! DSW
12150: 8ea9: !     FPF.OPEN.FLAG$ = "N"                                              ! DSW
12151: 8ea9: 
12152: 8ea9:       CLOSE IDF.SESS.NUM%                                               ! DSW
12153: 8ebd:       IDF.OPEN.FLAG$ = "N"                                              ! DSW
12154: 8ed4: 
12155: 8ed4: !     CLOSE INVOK.SESS.NUM%                                             ! DSW
12156: 8ed4: !     INVOK.OPEN.FLAG$ = "N"                                            ! DSW
12157: 8ed4: 
12158: 8ed4:       CLOSE IEF.SESS.NUM%                                               ! DSW
12159: 8ee8:       IEF.OPEN.FLAG$ = "N"                                              ! DSW
12160: 8eff: 
12161: 8eff:       CLOSE IRF.SESS.NUM%                                               ! DSW
12162: 8f13:       IRF.OPEN.FLAG$ = "N"                                              ! DSW
12163: 8f2a: 
12164: 8f2a: !     CLOSE ONORD.SESS.NUM%                                             ! DSW
12165: 8f2a: !     ONORD.OPEN.FLAG$ = "N"                                            ! DSW
12166: 8f2a: 
12167: 8f2a:       CLOSE PDTWF.SESS.NUM%                                             ! DSW
12168: 8f3e:       PDTWF.OPEN.FLAG$ = "N"                                            ! DSW
12169: 8f55: 
12170: 8f55:       CLOSE PIITM.SESS.NUM%                                             ! DSW
12171: 8f6b:       PIITM.OPEN.FLAG$ = "N"                                            ! DSW
12172: 8f82: 
12173: 8f82:       CLOSE PILST.SESS.NUM%                                             ! DSW
12174: 8f98:       PILST.OPEN.FLAG$ = "N"                                            ! DSW
12175: 8faf: 
12176: 8faf:       CLOSE STKMQ.SESS.NUM%                                             ! DSW
12177: 8fc3:       STKMQ.OPEN.FLAG$ = "N"                                            ! DSW
12178: 8fda: 
12179: 8fda:       CLOSE UNITS.SESS.NUM%                                             ! DSW
12180: 8fee:       UNITS.OPEN.FLAG$ = "N"                                            ! DSW
12181: 9005: 
12182: 9005:       CLOSE EPSOM.SESS.NUM%                                             ! DSW
12183: 9019:       EPSOM.OPEN.FLAG$ = "N"                                            ! DSW
12184: 9030: 
12185: 9030: \     CLOSE CSR.SESS.NUM%                                               ! DSW !2.9NWB
12186: 9030: \     CSR.OPEN.FLAG$ = "N"                                              ! DSW !2.9NWB
12187: 9030: 
12188: 9030:       CLOSE PCHK.SESS.NUM%                                              ! DSW
12189: 9044:       PCHK.OPEN.FLAG$ = "N"                                             ! DSW
12190: 905b: 
12191: 905b:       CLOSE DIRORD.SESS.NUM%                                            ! HDS
12192: 906f:       DIRORD.OPEN.FLAG$ = "N"                                           ! HDS
12193: 9086: 
12194: 9086:       CLOSE DIRSUP.SESS.NUM%                                            ! HDS
12195: 909a:       DIRSUP.OPEN.FLAG$ = "N"                                           ! HDS
12196: 90b1: 
12197: 90b1:       CLOSE DIRWF.SESS.NUM%                                             ! HDS
12198: 90c5:       DIRWF.OPEN.FLAG$ = "N"                                            ! HDS
12199: 90dc: 
12200: 90dc:       CLOSE DIREC.SESS.NUM%                                             ! HDS
12201: 90f0:       DIREC.OPEN.FLAG$ = "N"                                            ! HDS
12202: 9107: 
12203: 9107:       CLOSE LDTCF.SESS.NUM%                                             ! HDS
12204: 911b:       LDTCF.OPEN.FLAG$ = "N"                                            ! HDS
12205: 9132: 
12206: 9132:       IF APPL$ = "DIRECT" THEN BEGIN                                    ! JLC
12207: 9150:          GOSUB RECREATE.DRSMQ                                           ! JLC
12208: 9162:          CLOSE DRSMQ.SESS.NUM%                                          ! HDS
12209: 9176:          DRSMQ.OPEN.FLAG$ = "N"                                         ! HDS
12210: 918d:       ENDIF                                                             ! JLC
12211: 9195: 
12212: 9195:       CLOSE LDTBF.SESS.NUM%                                             ! JLC
12213: 91ab:       LDTBF.OPEN.FLAG$ = "N"                                            ! JLC
12214: 91c2: 
12215: 91c2: !     CLOSE IDSOF.SESS.NUM%                                             ! JLC
12216: 91c2: !     IDSOF.OPEN.FLAG$ = "N"                                            ! JLC
12217: 91c2: 
12218: 91c2:       CLOSE UOD.SESS.NUM%                                               ! LLC
12219: 91d6:       UOD.OPEN.FLAG$ = "N"                                              ! LLC
12220: 91ed: 
12221: 91ed:       CLOSE UODTF.SESS.NUM%                                             ! LLC
12222: 9201:       UODTF.OPEN.FLAG$ = "N"                                            ! LLC
12223: 9218: 
12224: 9218:       CLOSE UODBF.SESS.NUM%                                             ! LLC
12225: 922c:       UODBF.OPEN.FLAG$ = "N"                                            ! LLC
12226: 9243: 
12227: 9243:       IF CSR.AUDIT.OPEN.FLAG$ = "Y" THEN BEGIN                          ! EPAB
12228: 9261:          CLOSE CSR.AUDIT.SESS.NUM%                                      ! EPAB
12229: 9275:          CSR.AUDIT.OPEN.FLAG$ = "N"                                     ! EPAB
12230: 928c:       ENDIF                                                             ! EPAB
12231: 9294: 
12232: 9294:       CLOSE CCUOD.SESS.NUM%                                             ! MMJK
12233: 92a8:       CCUOD.OPEN.FLAG$ = "N"                                            ! MMJK
12234: 92bf: 
12235: 92bf:       CLOSE CCLAM.SESS.NUM%                                             ! 1.4
12236: 92d3:       CCLAM.OPEN.FLAG$ = "N"                                            ! 1.4
12237: 92ea: 
12238: 92ea:       CLOSE CCITM.SESS.NUM%                                             ! MMJK
12239: 92fe:       CCITM.OPEN.FLAG$ = "N"                                            ! MMJK
12240: 9315: 
12241: 9315:       CLOSE CCTRL.SESS.NUM%                                             ! MMJK
12242: 9329:       CCTRL.OPEN.FLAG$ = "N"                                            ! MMJK
12243: 9340: 
12244: 9340:       CLOSE CCDMY.SESS.NUM%                                             ! MMJK
12245: 9354:       CCDMY.OPEN.FLAG$ = "N"                                            ! MMJK
12246: 936b: 
12247: 936b:       CLOSE CCTMP.SESS.NUM%                                             ! MMJK
12248: 937f:       CCTMP.OPEN.FLAG$ = "N"                                            ! MMJK
12249: 9396: 
12250: 9396:       CLOSE CCBUF.SESS.NUM%                                             ! MMJK
12251: 93aa:       CCBUF.OPEN.FLAG$ = "N"                                            ! MMJK
12252: 93c1: 
12253: 93c1:       CLOSE CCUPF.SESS.NUM%                                             ! NMJK
12254: 93d5:       CCUPF.OPEN.FLAG$ = "N"                                            ! NMJK
12255: 93ec: 
12256: 93ec:       CLOSE CCWKF.SESS.NUM%                                             ! MMJK
12257: 9400:       CCWKF.OPEN.FLAG$ = "N"                                            ! MMJK
12258: 9417: 
12259: 9417:       CLOSE LDTAF.SESS.NUM%                                             ! MMJK
12260: 942b:       LDTAF.OPEN.FLAG$ = "N"                                            ! MMJK
12261: 9442: 
12262: 9442:       CLOSE SOFTS.SESS.NUM%                                             ! MMJK
12263: 9456:       SOFTS.OPEN.FLAG$ = "N"                                            ! MMJK
12264: 946d: 
12265: 946d:       IF GAPBF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 1.9DA !2.5CS !2.6BG
12266: 948b:          CLOSE GAPBF.SESS.NUM%                                          ! 1.9DA !2.5CS !2.6BG
12267: 94a1:          GAPBF.OPEN.FLAG$ = "N"                                         ! 1.9DA !2.5CS !2.6BG
12268: 94b8:       ENDIF                                                             ! 1.9DA !2.5CS !2.6BG
12269: 94c0: 
12270: 94c0:       IF PLLOL.OPEN.FLAG$ = "Y" THEN BEGIN                              !2.5CS
12271: 94de:          CLOSE PLLOL.SESS.NUM%                                          !2.5CS
12272: 94f2:          PLLOL.OPEN.FLAG$ = "N"                                         !2.5CS
12273: 9509:       ENDIF                                                             !2.5CS
12274: 9511: 
12275: 9511:       IF PLLDB.OPEN.FLAG$ = "Y" THEN BEGIN                              !2.5CS
12276: 952f:          CLOSE PLLDB.SESS.NUM%                                          !2.5CS
12277: 9543:          PLLDB.OPEN.FLAG$ = "N"                                         !2.5CS
12278: 955a:       ENDIF                                                             !2.5CS
12279: 9562: 
12280: 9562:       IF TSF.OPEN.FLAG$ = "Y" THEN BEGIN                                ! 2.3JAS
12281: 9580:          CLOSE TSF.SESS.NUM%                                            ! 2.3JAS
12282: 9594:          TSF.OPEN.FLAG$ = "N"                                           ! 2.3JAS
12283: 95ab:       ENDIF                                                             ! 2.3JAS
12284: 95b3: 
12285: 95b3:       IF SOPTS.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.3JAS
12286: 95d1:          CLOSE SOPTS.SESS.NUM%                                          ! 2.3JAS
12287: 95e5:          SOPTS.OPEN.FLAG$ = "N"                                         ! 2.3JAS
12288: 95fc:       ENDIF                                                             ! 2.3JAS
12289: 9604: 
12290: 9604:       IF CB.OPEN.FLAG$ = "Y" THEN BEGIN                                 ! 2.9NWB
12291: 961f:          CLOSE CB.SESS.NUM%                                             ! 2.9NWB
12292: 9633:          CB.OPEN.FLAG$ = "N"                                            ! 2.9NWB
12293: 9648:       ENDIF                                                             ! 2.9NWB
12294: 9650:       
12295: 9650:       IF RB.OPEN.FLAG$ = "Y" THEN BEGIN                                 ! 2.10BG
12296: 966e:          CLOSE RB.SESS.NUM%                                             ! 2.10BG
12297: 9682:          RB.OPEN.FLAG$ = "N"                                            ! 2.10BG
12298: 9699:       ENDIF                                                             ! 2.10BG
12299: 96a1:       
12300: 96a1:       IF REWKF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! 2.10BG
12301: 96bf:          CLOSE REWKF.SESS.NUM%                                          ! 2.10BG
12302: 96d3:          REWKF.OPEN.FLAG$ = "N"                                         ! 2.10BG
12303: 96ea:       ENDIF                                                             ! 2.10BG
12304: 96f2:       
12305: 96f2:       IF RECALLS.OPEN.FLAG$ = "Y" THEN BEGIN                            ! 2.10BG
12306: 9710:          CLOSE RECALLS.SESS.NUM%                                        ! 2.10BG
12307: 9724:          RECALLS.OPEN.FLAG$ = "N"                                       ! 2.10BG
12308: 973b:       ENDIF                                                             ! 2.10BG
12309: 9743: 
12310: 9743:       IF DELVINDX.OPEN.FLAG$ = "Y" THEN BEGIN                           ! 2.12SH
12311: 9761:          CLOSE DELVINDX.SESS.NUM%                                       ! 2.12SH
12312: 9775:          DELVINDX.OPEN.FLAG$ = "N"                                      ! 2.12SH
12313: 978c:       ENDIF                                                             ! 2.12SH
12314: 9794: 
12315: 9794:       ALL.FILES.CLOSED$ = "Y"                                           ! DSW
12316: 97ab: 
12317: 97ab:    RETURN
12318: 97bb: 
12319: 97bb: \******************************************************************************
12320: 97bb: \***
12321: 97bb: \***   INACTIVITY.SHUTDOWN:
12322: 97bb: \***
12323: 97bb: \***      release PDT
12324: 97bb: \***      close ALL files
12325: 97bb: \***      Read stocktake control file
12326: 97bb: \***      If stocktake not in progress Then
12327: 97bb: \***         Receive.State = "A"
12328: 97bb: \***      Else
12329: 97bb: \***         If last stocktake data movement was today And
12330: 97bb: \***            happened more than Inactivity.Shutdown ago Then
12331: 97bb: \***               Receive.State = "A"
12332: 97bb: \***         Else
12333: 97bb: \***            If last stocktake data movement was before today And
12334: 97bb: \***               it is more than Inactivity.Shutdown after midnight Then
12335: 97bb: \***                  Receive.State = "A"
12336: 97bb: \***
12337: 97bb: \***
12338: 97bb: \***   RETURN
12339: 97bb: \***
12340: 97bb: \******************************************************************************
12341: 97bb: 
12342: 97bb: INACTIVITY.SHUTDOWN:                                                    ! DSW
12343: 97cb: 
12344: 97cb:       SB.MESSAGE$ = "PDT Support - Inactivity shutdown."                ! DSW
12345: 97e0:       GOSUB SB.BG.MESSAGE                                               ! DSW
12346: 97f2:       IF HOLD.FLAG$ = "Y" THEN GOSUB RELEASE.PDT                        ! DSW
12347: 981a:       GOSUB CLOSE.OPEN.FILES                                            ! DSW
12348: 982c: 
12349: 982c: 
12350: 982c: 
12351: 982c: 
12352: 982c:       IF END# SXTCF.SESS.NUM% THEN OPEN.ERROR                           ! 1.5
12353: 9848:       CURR.SESS.NUM% = SXTCF.SESS.NUM%                                  ! 1.5
12354: 985a:       OPEN SXTCF.FILE.NAME$ DIRECT RECL SXTCF.RECL% AS                  \ 1.5
12355: 9887:            SXTCF.SESS.NUM% NODEL                                        ! 1.5
12356: 9887:       RC% = READ.SXTCF                                                  ! 1.5
12357: 989c:       IF RC% <> 0 THEN GOTO READ.ERROR                                  ! 1.5
12358: 98b1:       CLOSE SXTCF.SESS.NUM%                                             ! 1.5
12359: 98c5:       IF SXTCF.STOCKTAKE.IN.PROGRESS$ <> "Y" THEN BEGIN                 ! 1.5
12360: 98e3:            RECEIVE.STATE$ = "A"                                         ! 1.5
12361: 98fd:       ENDIF ELSE BEGIN                                                  ! 1.5
12362: 9905:            NOW% = FN.SECONDS(TIME$)                                     ! 1.5
12363: 9929:            IF LAST.STOCKTAKE.DATE$ = DATE$ THEN BEGIN                   ! 1.5
12364: 994b:               IF (NOW% - LAST.STOCKTAKE%) > INACTIVITY.SHUTDOWN% THEN   \ 1.5
12365: 9974:                   RECEIVE.STATE$ = "A"                                  ! 1.5
12366: 998d:            ENDIF ELSE BEGIN                                             ! 1.5
12367: 9995:               IF NOW% > INACTIVITY.SHUTDOWN% THEN RECEIVE.STATE$ = "A"  ! 1.5
12368: 99ba:            ENDIF                                                        ! 1.5
12369: 99c2:        ENDIF                                                            ! 1.5
12370: 99ca: 
12371: 99ca: 
12372: 99ca: RETURN
12373: 99da: 
12374: 99da: \*****************************************************************************
12375: 99da: \***
12376: 99da: \***   RECREATE.DRSMQ:
12377: 99da: \***
12378: 99da: \***     To solve potential problems with transmission failure followed by
12379: 99da: \***     an LDT reboot. i.e. making sure there is no data in the DRSMQ.
12380: 99da: \***
12381: 99da: \*****************************************************************************
12382: 99da: 
12383: 99da:    RECREATE.DRSMQ:                                                      ! JLC
12384: 99ea: 
12385: 99ea:       CURR.SESS.NUM% = DRSMQ.SESS.NUM%                                  ! JLC
12386: 99fc: 
12387: 99fc:       IF DRSMQ.OPEN.FLAG$ = "Y" THEN BEGIN                              ! JLC
12388: 9a1a:          CLOSE DRSMQ.SESS.NUM%                                          ! JLC
12389: 9a2e:          DRSMQ.OPEN.FLAG$ = "N"                                         ! JLC
12390: 9a45:       ENDIF                                                             ! JLC
12391: 9a4d: 
12392: 9a4d:       IF END #DRSMQ.SESS.NUM% THEN CREATE.ERROR                         ! JLC
12393: 9a69:       CREATE POSFILE DRSMQ.FILE.NAME$ AS DRSMQ.SESS.NUM%                \ JLC
12394: 9a90:              BUFFSIZE 10240 LOCKED                                      ! JLC
12395: 9a90:       DRSMQ.OPEN.FLAG$ = "Y"                                            ! JLC
12396: 9aa7: 
12397: 9aa7:    RETURN
12398: 9ab7: 
12399: 9ab7: \******************************************************************************
12400: 9ab7: \***
12401: 9ab7: \***   REQUEST.PROGRAM.LOAD:
12402: 9ab7: \***
12403: 9ab7: \***      display message "PDT Support - LDT Program request received"
12404: 9ab7: \***      GOSUB SB.BG.MESSAGE
12405: 9ab7: \***
12406: 9ab7: \***      send an "E" to PSS38 to begin program load
12407: 9ab7: \***
12408: 9ab7: \***   RETURN
12409: 9ab7: \***
12410: 9ab7: \******************************************************************************
12411: 9ab7: 
12412: 9ab7:    REQUEST.PROGRAM.LOAD:                                                ! HDS
12413: 9ac7: 
12414: 9ac7:       SB.MESSAGE$ = "PDT Support - LDT Program request received"        ! HDS
12415: 9adc:       GOSUB SB.BG.MESSAGE                                               ! HDS
12416: 9aee: 
12417: 9aee:       PIPE.OUT$ = "E"                                                   ! HDS
12418: 9b05:       GOSUB SEND.TO.PSS38                                               ! HDS
12419: 9b17: 
12420: 9b17:    RETURN                                                               ! HDS
12421: 9b27: 
12422: 9b27: \******************************************************************************
12423: 9b27: \***
12424: 9b27: \***   RECEIVED.LOG.ON:                                         STATE : B
12425: 9b27: \***
12426: 9b27: \***      if received data is not valid then set the RECEIVE.STATE$ to "*" and
12427: 9b27: \***      return
12428: 9b27: \***
12429: 9b27: \***      GOSUB TIDY.UP
12430: 9b27: \***
12431: 9b27: \***      if the received store number is correct and this PDT has not sent
12432: 9b27: \***                two logons close together then
12433: 9b27: \***         gosub LOCK.APPLICATION.FILE
12434: 9b27: \***         if successful
12435: 9b27: \***            transmit a positive log-on acknowledgment
12436: 9b27: \***         else
12437: 9b27: \***            transmit a negative log-on acknowledgement
12438: 9b27: \***         endif
12439: 9b27: \***      else
12440: 9b27: \***         transmit a negative log-on acknowledgment
12441: 9b27: \***         set RECEIVE.STATE$ to "*"
12442: 9b27: \***         return
12443: 9b27: \***      endif
12444: 9b27: \***
12445: 9b27: \***      set up CURR.TERMINAL$ as PDT terminal number
12446: 9b27: \***
12447: 9b27: \***   RETURN
12448: 9b27: \***
12449: 9b27: \******************************************************************************
12450: 9b27: 
12451: 9b27:    RECEIVED.LOG.ON:
12452: 9b37: 
12453: 9b37:       SB.MESSAGE$ = "PDT Support - Log-on received"                     ! DJAL
12454: 9b4c:       GOSUB SB.BG.MESSAGE
12455: 9b5e: 
12456: 9b5e:       IF FN.VALIDATE.DATA(DATA.IN$, 1) = 0 THEN BEGIN
12457: 9b80:          RECEIVE.STATE$ = "*"
12458: 9b97:          RETURN
12459: 9ba7:       ENDIF
12460: 9baf: 
12461: 9baf:       GOSUB TIDY.UP
12462: 9bc1:       DATE.TODAY$ = DATE$
12463: 9bd9:       CURR.TERMINAL$ = MID$(DATA.IN$,6,6)
12464: 9c00:       TIDY.FLAG$ = "N"
12465: 9c15:       APPL$ = APPL.TABLE$(VAL(MID$(DATA.IN$,12,2)))                     ! HDS
12466: 9c56:       APPLICATION.NO$ = MID$(DATA.IN$,12,2)                             ! ILC
12467: 9c7d: 
12468: 9c7d:       STORE.NUMBER.INCORRECT = FALSE                                    ! 1.9DA
12469: 9c8f:       STOCKTAKING.ALTERNATIVE.STORE = FALSE                             ! 1.9DA
12470: 9ca5: 
12471: 9ca5:       TIME.DIFFERENCE = FN.SECONDS(TIME$) - FN.SECONDS(LOG.ON.TIME$)
12472: 9cf2:       IF MID$(DATA.IN$, 2, 4) = SAVED.STORE.NUMBER$ THEN BEGIN          ! 1.9DA
12473: 9d31:          IF LOG.ON.DATE$ <> DATE$                                       \ CSW
12474: 9dbe:          OR TIME.DIFFERENCE > LOG.ON.DISABLE%                           \ ILC
12475: 9dbe:          OR TIME.DIFFERENCE < 0 THEN BEGIN                              ! CSW
12476: 9dbe:             NAK.LINE.1$ = ""                                            ! DSW
12477: 9dd3:             NAK.LINE.2$ = ""                                            ! DSW
12478: 9de8:             NAK.LINE.3$ = ""                                            ! DSW
12479: 9dfd:             GOSUB LOCK.APPLICATION.FILE                                 ! DJAL
12480: 9e0f:             IF SUCCESS.FLAG$ = "Y" THEN BEGIN                           ! DJAL
12481: 9e2a:                GOSUB TRANSMIT.POSITIVE.LOG.ON
12482: 9e3c:                GOSUB SET.UP.AUDIT.FILE                                  ! OSMG
12483: 9e4e:                LOG.ON.DATE$ = DATE$
12484: 9e66:                LOG.ON.TIME$ = TIME$
12485: 9e81:             ENDIF ELSE BEGIN                                            ! DJAL
12486: 9e89:                GOSUB TRANSMIT.NEGATIVE.LOG.ON                           ! DJAL
12487: 9e9b:                GOSUB SET.UP.AUDIT.FILE                                  ! OSMG
12488: 9ead:                RECEIVE.STATE$ = "*"                                     ! DJAL
12489: 9ec4:                LOG.ON.DATE$ = DATE$                                     ! ILC
12490: 9edc:                LOG.ON.TIME$ = TIME$                                     ! ILC
12491: 9ef4:                RETURN                                                   ! DJAL
12492: 9f04:             ENDIF                                                       ! DJAL
12493: 9f0e:          ENDIF ELSE RECEIVE.STATE$ = "*"                                ! LMJK
12494: 9f28:       ENDIF ELSE BEGIN
12495: 9f30:          STORE.NUMBER.INCORRECT = TRUE                                  ! 1.9DA
12496: 9f42:          IF APPLICATION.NO$ = "08" THEN BEGIN                           ! 1.9DA
12497: 9f63:             CURR.SESS.NUM% = SXTCF.SESS.NUM%                            ! 1.9DA
12498: 9f75:             IF END #SXTCF.SESS.NUM% THEN OPEN.ERROR                     ! 1.9DA
12499: 9f91:             OPEN SXTCF.FILE.NAME$ DIRECT RECL SXTCF.RECL% AS            \ 1.9DA
12500: 9fbe:                  SXTCF.SESS.NUM% NODEL                                  ! 1.9DA
12501: 9fbe:             RC% = READ.SXTCF                                            ! 1.9DA
12502: 9fd3:             IF RC% <> 0 THEN GOTO READ.ERROR                            ! 1.9DA
12503: 9fe8:             CLOSE SXTCF.SESS.NUM%                                       ! 1.9DA
12504: 9ffc:             IF SXTCF.STOCKTAKE.IN.PROGRESS$ = "N" THEN BEGIN            ! 1.9DA
12505: a01d:                STORE.NUMBER.INCORRECT = FALSE                           ! 1.9DA
12506: a02f:                STOCKTAKING.ALTERNATIVE.STORE = TRUE                     ! 1.9DA
12507: a045:                STORE.NUMBER$ = MID$(DATA.IN$, 2, 4)                     ! 1.9DA
12508: a06c:                NAK.LINE.1$ = ""                                         ! 1.9DA
12509: a081:                NAK.LINE.2$ = ""                                         ! 1.9DA
12510: a096:                NAK.LINE.3$ = ""                                         ! 1.9DA
12511: a0ab:                GOSUB LOCK.APPLICATION.FILE                              ! 1.9DA
12512: a0bd:                IF SUCCESS.FLAG$ = "Y" THEN BEGIN                        ! 1.9DA
12513: a0d8:                   GOSUB TRANSMIT.POSITIVE.LOG.ON                        ! 1.9DA
12514: a0ea:                   GOSUB SET.UP.AUDIT.FILE                               ! 1.9DA
12515: a0fc:                   LOG.ON.DATE$ = DATE$                                  ! 1.9DA
12516: a114:                   LOG.ON.TIME$ = TIME$                                  ! 1.9DA
12517: a12e:                ENDIF ELSE BEGIN                                         ! 1.9DA
12518: a136:                   GOSUB TRANSMIT.NEGATIVE.LOG.ON                        ! 1.9DA
12519: a148:                   GOSUB SET.UP.AUDIT.FILE                               ! 1.9DA
12520: a15a:                   RECEIVE.STATE$ = "*"                                  ! 1.9DA
12521: a171:                   LOG.ON.DATE$ = DATE$                                  ! 1.9DA
12522: a189:                   LOG.ON.TIME$ = TIME$                                  ! 1.9DA
12523: a1a1:                ENDIF                                                    ! 1.9DA
12524: a1a9:                RETURN                                                   ! 1.9DA
12525: a1bc:             ENDIF ELSE BEGIN                                            ! 1.9DA
12526: a1c4:                NAK.LINE.1$ = "A stocktake is"                           ! 1.9DA
12527: a1d9:                NAK.LINE.2$ = "already in"                               ! 1.9DA
12528: a1ee:                NAK.LINE.3$ = "progress."                                ! 1.9DA
12529: a203:                GOSUB TRANSMIT.NEGATIVE.LOG.ON                           ! 1.9DA
12530: a215:                GOSUB SET.UP.AUDIT.FILE                                  ! 1.9DA
12531: a227:                RECEIVE.STATE$ = "*"                                     ! 1.9DA
12532: a23e:                RETURN                                                   ! 1.9DA
12533: a24e:             ENDIF                                                       ! 1.9DA
12534: a256:          ENDIF                                                          ! 1.9DA
12535: a25e:       ENDIF                                                             ! 1.9DA
12536: a266: 
12537: a266:       IF STORE.NUMBER.INCORRECT = TRUE THEN BEGIN                       ! 1.9DA
12538: a27e:          NAK.LINE.1$ = "The store number"                               ! DSW
12539: a293:          NAK.LINE.2$ = "is incorrect in"                                ! DSW
12540: a2a8:          IF APPL$ = "DIRECT" OR APPL$ = "UOD" OR APPL$ = "RETURNS"      \ MMJK
12541: a322:           THEN NAK.LINE.3$ = "this LDT." ELSE NAK.LINE.3$ = "this PDT." ! MMJK
12542: a346:          GOSUB TRANSMIT.NEGATIVE.LOG.ON
12543: a358:          GOSUB SET.UP.AUDIT.FILE                                        ! OSMG
12544: a36a:          RECEIVE.STATE$ = "*"
12545: a381:          RETURN
12546: a391:       ENDIF                                                             ! 1.9DA
12547: a399: 
12548: a399:    RETURN
12549: a3a9: 
12550: a3a9: \******************************************************************************
12551: a3a9: \***
12552: a3a9: \***   SET UP AUDIT FILE
12553: a3a9: \***
12554: a3a9: \******************************************************************************
12555: a3a9: 
12556: a3a9:    SET.UP.AUDIT.FILE:                                                   ! OSMG
12557: a3b9: 
12558: a3b9:       TEMP.TIME$ = TIME$                                                ! NMJK
12559: a3d1:       START.TIME% = (VAL(LEFT$(TEMP.TIME$,2))*3600) +                   \ NMJK
12560: a4b4:                     (VAL(MID$(TEMP.TIME$,3,2))*60) +                    \ NMJK
12561: a4b4:                      VAL(RIGHT$(TEMP.TIME$,2))                          ! NMJK
12562: a4b4:       LDTAF.DURATION% = START.TIME%                                     ! MMJK
12563: a4cb:       CSR.AUDIT.DATA$ = STRING$(80,"-")                                 ! EPAB
12564: a4e9:       GOSUB LOG.TO.AUDIT.FILE                                           ! EPAB
12565: a4fb:       IF APPL$ = "UOD" OR APPL$ = "DIRECT" OR APPL$ = "RETURNS"         \ MMJK
12566: a575:          THEN DEVICE$ = "LDT " ELSE DEVICE$ = "PDT "                    ! MMJK
12567: a599:       CSR.AUDIT.DATA$ = "Log on received from " + DEVICE$ +             \ LLC
12568: a69b:          CURR.TERMINAL$ +                                               \ EPAB
12569: a69b:          " at " + LEFT$(TIME$,2) + ":" + MID$(TIME$,3,2) + " on " +     \ EPAB
12570: a69b:          LEFT$(DATE$,2) + "/" + MID$(DATE$,3,2) + "/" + RIGHT$(DATE$,2) \ EPAB
12571: a69b:          + " for application " + APPL$                                  ! EPAB
12572: a69b:       GOSUB LOG.TO.AUDIT.FILE                                           ! EPAB
12573: a6ad: 
12574: a6ad:    RETURN                                                               ! OSMG
12575: a6bd: 
12576: a6bd: \******************************************************************************
12577: a6bd: \***
12578: a6bd: \***   LOAD.APPLICATION.TABLE:
12579: a6bd: \***
12580: a6bd: \***       dimension application table for 27 entries
12581: a6bd: \***
12582: a6bd: \***       load table entries
12583: a6bd: \***
12584: a6bd: \***   RETURN
12585: a6bd: \***
12586: a6bd: \******************************************************************************
12587: a6bd: 
12588: a6bd:    LOAD.APPLICATION.TABLE:                                              ! HDS
12589: a6cd: 
12590: a6cd:        DIM APPL.TABLE$(27)                                              ! HDS
12591: a6f6: 
12592: a6f6:        APPL.TABLE$(1) = "EPSOM"                                         ! HDS
12593: a716: \      APPL.TABLE$(2) = "CSR"                                           ! HDS !2.9NWB
12594: a716:        APPL.TABLE$(2) = "ASN"                                           ! 2.9NWB
12595: a736:        APPL.TABLE$(3) = "PRICE CHECK"                                   ! HDS
12596: a756:        APPL.TABLE$(4) = ""                                              ! HDS
12597: a776:        APPL.TABLE$(5) = "DIRECT"                                        ! HDS
12598: a796:        APPL.TABLE$(6) = "UOD"                                           ! LLC
12599: a7b6:        APPL.TABLE$(7) = "RETURNS"                                       ! MMJK
12600: a7d6:        APPL.TABLE$(8) = "STOCKTAKE"                                     ! 1.5
12601: a7f6:        APPL.TABLE$(9) = "STOCKCOUNT"                                    ! 2,1BG
12602: a816:        APPL.TABLE$(10) = "PHARMACY"                                     ! 2.2JAS
12603: a836:        APPL.TABLE$(11) = "RECALLS"                                      ! 2.10BG
12604: a856:        APPL.TABLE$(12) = "+UOD"                                         ! 2.12SH
12605: a876:        FOR INDX% = 13 TO 26                                             ! 2.12SH
12606: a886:            APPL.TABLE$(INDX%) = ""                                      ! HDS
12607: a8a8:        NEXT INDX%                                                       ! HDS
12608: a8be:        APPL.TABLE$(27) = "LOAD UNITS"                                   ! HDS
12609: a8de: 
12610: a8de:    RETURN                                                               ! HDS
12611: a8ee: 
12612: a8ee: 
12613: a8ee: \******************************************************************************
12614: a8ee: \***
12615: a8ee: \***   CALL.OTHER.MODULE:                               STATES : J - Q
12616: a8ee: \***
12617: a8ee: \***      call module PSS3701 which contains the processing instructions
12618: a8ee: \***      for these record types
12619: a8ee: \***
12620: a8ee: \***   RETURN
12621: a8ee: \***
12622: a8ee: \******************************************************************************
12623: a8ee: 
12624: a8ee:    CALL.OTHER.MODULE:                                                   ! DJAL
12625: a8fe: 
12626: a8fe:       GOSUB ALLOCATE.MODULE.1                                           ! 1.9DA
12627: a910: 
12628: a910:       CALL PSS3701                                                      ! DJAL
12629: a91d:       TIDY.FLAG$ = "N"                                                  ! DJAL
12630: a932: 
12631: a932:       GOSUB DEALLOCATE.MODULE.1                                         ! 1.9DA
12632: a944: 
12633: a944:    RETURN                                                               ! DJAL
12634: a954: 
12635: a954: \******************************************************************************
12636: a954: \***
12637: a954: \***   CALL.OTHER.MODULE2:                              STATES : R - f
12638: a954: \***
12639: a954: \***      call module PSS3702 which contains the processing instructions
12640: a954: \***      for these record types
12641: a954: \***
12642: a954: \***   RETURN
12643: a954: \***
12644: a954: \******************************************************************************
12645: a954: 
12646: a954:    CALL.OTHER.MODULE2:                                                  ! HDS
12647: a964: 
12648: a964:     IF RECEIVE.STATE$ = "*" THEN BEGIN                                  ! HDS
12649: a982:        RETURN                                                           ! HDS
12650: a992:     ENDIF                                                               ! HDS
12651: a99a: 
12652: a99a:     CALL PSS3702                                                        ! HDS
12653: a9a7:     TIDY.FLAG$ = "N"                                                    ! HDS
12654: a9bc: 
12655: a9bc:    RETURN                                                               ! HDS
12656: a9cc: 
12657: a9cc: \*****************************************************************************
12658: a9cc: \***
12659: a9cc: \***   CALL.OTHER.MODULE3:                            Data States C - I
12660: a9cc: \***
12661: a9cc: \***       EPSOM routines
12662: a9cc: \***
12663: a9cc: \*****************************************************************************
12664: a9cc: 
12665: a9cc: CALL.OTHER.MODULE3:
12666: a9dc: 
12667: a9dc:    IF RECEIVE.STATE$ = "*" THEN BEGIN                                   ! LLC
12668: a9fa:       RETURN                                                            ! LLC
12669: aa0a:    ENDIF                                                                ! LLC
12670: aa12: 
12671: aa12:    GOSUB ALLOCATE.MODULE.3                                              ! 1.9DA
12672: aa24: 
12673: aa24:    CALL PSS3703                                                         ! LLC
12674: aa31:    TIDY.FLAG$ = "N"                                                     ! LLC
12675: aa46: 
12676: aa46:    GOSUB DEALLOCATE.MODULE.3                                            ! 1.9DA
12677: aa58: 
12678: aa58: RETURN
12679: aa68: 
12680: aa68: \*****************************************************************************
12681: aa68: \***
12682: aa68: \***   CALL.OTHER.MODULE4:                            Data States g - o
12683: aa68: \***
12684: aa68: \***       RETURNS routines
12685: aa68: \***
12686: aa68: \*****************************************************************************
12687: aa68: 
12688: aa68: CALL.OTHER.MODULE4:
12689: aa78: 
12690: aa78:    IF RECEIVE.STATE$ = "*" THEN BEGIN                                   ! MMJK
12691: aa96:       RETURN                                                            ! MMJK
12692: aaa6:    ENDIF                                                                ! MMJK
12693: aaae: 
12694: aaae:    GOSUB ALLOCATE.MODULE.4                                              ! 1.9DA
12695: aac0: 
12696: aac0:    CALL PSS3704                                                         ! MMJK
12697: aacd:    TIDY.FLAG$ = "N"                                                     ! MMJK
12698: aae2: 
12699: aae2:    GOSUB DEALLOCATE.MODULE.4                                            ! 1.9DA
12700: aaf4: 
12701: aaf4: RETURN
12702: ab04: 
12703: ab04: 
12704: ab04: \*****************************************************************************
12705: ab04: \***
12706: ab04: \***   CALL.OTHER.MODULE5:                            Data States s - z
12707: ab04: \***
12708: ab04: \***       STOCKCOUNT routines
12709: ab04: \***
12710: ab04: \*****************************************************************************
12711: ab04: 
12712: ab04: CALL.OTHER.MODULE5:                                                     ! 2.1BG
12713: ab14: 
12714: ab14:    IF RECEIVE.STATE$ = "*" THEN BEGIN                                   ! 2.1BG
12715: ab32:       RETURN                                                            ! 2.1BG
12716: ab42:    ENDIF                                                                ! 2.1BG
12717: ab4a:    
12718: ab4a:    GOSUB ALLOCATE.MODULE.5                                              ! 2.1BG
12719: ab5c:    
12720: ab5c:    CALL PSS3705                                                         ! 2.1BG
12721: ab69:    TIDY.FLAG$ = "N"                                                     ! 2.1BG
12722: ab7e: 
12723: ab7e:    GOSUB DEALLOCATE.MODULE.5                                            ! 2.1BG
12724: ab90: 
12725: ab90: RETURN                                                                  ! 2.1BG
12726: aba0: 
12727: aba0: 
12728: aba0: \*****************************************************************************
12729: aba0: \*****************************************************************************
12730: aba0: \***
12731: aba0: \***   C S R    S U B R O U T I N E S
12732: aba0: \***
12733: aba0: \*****************************************************************************
12734: aba0: \*****************************************************************************
12735: aba0: 
12736: aba0: \******************************************************************************
12737: aba0: \***
12738: aba0: \***   WRITE.DATA.TO.CSR.BUFFER: (removed v2.9)
12739: aba0: \***
12740: aba0: \***     display message to background screen
12741: aba0: \***     unconditionally write the data received from the PDT to
12742: aba0: \***        the buffer (checking of data will all be done in
12743: aba0: \***        module 01)
12744: aba0: \***
12745: aba0: \***   RETURN
12746: aba0: \***
12747: aba0: \******************************************************************************
12748: aba0: 
12749: aba0: \  WRITE.DATA.TO.CSR.BUFFER:                                            ! DJAL!2.9NWB
12750: aba0: 
12751: aba0: \     CSRBF.DATA$ = DATA.IN$                                            ! DJAL!2.9NWB
12752: aba0: \     LAST.ACTIVE.DATE$ = DATE$                                         ! DSW !2.9NWB
12753: aba0: \     LAST.ACTIVE% = FN.SECONDS(TIME$)                                  ! DSW !2.9NWB
12754: aba0: 
12755: aba0: \     RC% = WRITE.CSRBF                                                 ! ILC !2.9NWB
12756: aba0: \     IF RC% = 1 THEN GOTO WRITE.ERROR                                  ! ILC !2.9NWB
12757: aba0: 
12758: aba0: \  RETURN                                                               ! DJAL!2.9NWB
12759: aba0: 
12760: aba0: \******************************************************************************
12761: aba0: \***
12762: aba0: \***   RECEIVED.CSR.EOT: (removed v2.9)
12763: aba0: \***
12764: aba0: \***     gosub WRITE.DATA.TO.CSR.BUFFER
12765: aba0: \***     close the buffer
12766: aba0: \***     gosub CALL.OTHER.MODULE
12767: aba0: \***
12768: aba0: \***   RETURN
12769: aba0: \***
12770: aba0: \******************************************************************************
12771: aba0: 
12772: aba0: \  RECEIVED.CSR.EOT:                                                    ! DJAL!2.9NWB
12773: aba0: 
12774: aba0: \     IF APPLICATION.NO$ <> "02" THEN BEGIN                             ! DSW !2.9NWB
12775: aba0: \        RECEIVE.STATE$ = "A"                                           ! DSW !2.9NWB
12776: aba0: \        RETURN                                                         ! DSW !2.9NWB
12777: aba0: \     ENDIF                                                             ! DSW !2.9NWB
12778: aba0: 
12779: aba0: \     LAST.ACTIVE.DATE$ = DATE$                                         ! DSW !2.9NWB
12780: aba0: \     LAST.ACTIVE% = FN.SECONDS(TIME$)                                  ! DSW !2.9NWB
12781: aba0: 
12782: aba0: \     IF FIRST.EOT.FOR.THIS.PDT$ = "N" THEN BEGIN                       ! DSW !2.9NWB
12783: aba0: \        GOSUB CALL.OTHER.MODULE                                        ! JLC !2.9NWB
12784: aba0: \        START.TIME% = ( (VAL(LEFT$(TIME$,2))*3600) +                   \ NMJK!2.9NWB
12785: aba0: \                        (VAL(MID$(TIME$,3,2))*60) +                    \ NMJK!2.9NWB
12786: aba0: \                         VAL(MID$(TIME$,3,2)) ) - START.TIME%          ! NMJK!2.9NWB
12787: aba0: \        CSR.AUDIT.DATA$ = "Link Duration was " + STR$(START.TIME%)     \ EPAB!2.9NWB
12788: aba0: \           + " seconds "                                               ! EPAB!2.9NWB
12789: aba0: \        CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " +          \ EPAB!2.9NWB
12790: aba0: \                          CSR.AUDIT.DATA$                              ! EPAB!2.9NWB
12791: aba0: \        GOSUB LOG.ABORT.TO.AUDIT.FILE                                  ! EPAB!2.9NWB
12792: aba0: \        RE.CHAIN = TRUE                                                ! ILC !2.9NWB
12793: aba0: \        RECEIVE.STATE$ = "?"                                           ! ILC !2.9NWB
12794: aba0: \        RETURN                                                         ! DSW !2.9NWB
12795: aba0: \     ENDIF                                                             ! DSW !2.9NWB
12796: aba0: 
12797: aba0: \     CSR.AUDIT.DATA$ = "Received last List from PDT " +                \ EPAB!2.9NWB
12798: aba0: \         CURR.TERMINAL$ + ", PDT contained " + MID$(DATA.IN$,9,3) +    \ EPAB!2.9NWB
12799: aba0: \         " lists "                                                     ! EPAB!2.9NWB
12800: aba0: \     CSR.AUDIT.DATA$ = "[PORT " + MONITORED.PORT$ + "] " +             \ EPAB!2.9NWB
12801: aba0: \                       CSR.AUDIT.DATA$                                 ! EPAB!2.9NWB
12802: aba0: \     GOSUB LOG.TO.AUDIT.FILE                                           ! EPAB!2.9NWB
12803: aba0: \     GOSUB WRITE.DATA.TO.CSR.BUFFER                                    ! DJAL!2.9NWB
12804: aba0: 
12805: aba0: \     CLOSE CSRBF.SESS.NUM%                                             ! DJAL!2.9NWB
12806: aba0: \     CSRBF.OPEN.FLAG$ = "N"                                            ! DJAL!2.9NWB
12807: aba0: 
12808: aba0: \     GOSUB HOLD.PDT                                                    ! DJAL!2.9NWB
12809: aba0: \     GOSUB CALL.OTHER.MODULE                                           ! JLC !2.9NWB
12810: aba0: 
12811: aba0: \  RETURN                                                               ! DJAL!2.9NWB
12812: aba0: 
12813: aba0: \******************************************************************************
12814: aba0: \******************************************************************************
12815: aba0: \***
12816: aba0: \***   P D T    S U B R O U T I N E S
12817: aba0: \***
12818: aba0: \******************************************************************************
12819: aba0: \******************************************************************************
12820: aba0: 
12821: aba0: \******************************************************************************
12822: aba0: \***
12823: aba0: \***   LOCK.APPLICATION.FILE:
12824: aba0: \***
12825: aba0: \***      wait for allocated time slot (to circumvent file LOCKing problem)
12826: aba0: \***      attempt to lock a file specific to the application, indicated
12827: aba0: \***      by the application number in the logon record
12828: aba0: \***
12829: aba0: \***      Initialise CREDIT.CLAIM.FLAG$ = "NN" and STORE.CLOSE.FLAG$ = "O"
12830: aba0: \***
12831: aba0: \***      if this is the CSR application and the deliveries logging suite
12832: aba0: \***      has not yet run then the PDT logon will fail
12833: aba0: \***
12834: aba0: \***      if the application is RETURNS then perform validation of log on
12835: aba0: \***      attempt, if conditions are not valid then set flag to indicate.
12836: aba0: \***      Check SOFTS record 43, if this shows that CREDIT CLAIMING IS ACTIVE
12837: aba0: \***      and which rejctions to be reported set to ALL set CREDIT.CLAIM.FLAG$ = "YY"
12838: aba0: \***      else set CREDIT.CLAIM.FLAG$ = "YN".  If LEFT$(CREDIT.CLAIM.FLAG$,1) = "Y" then check
12839: aba0: \***      Store open status by checking the 9999 key record on the TSF
12840: aba0: \***      If the TSF.INDICATO% = -1 then set the STORE.CLOSE.FLAG$ = "C" (Store
12841: aba0: \***      closed)
12842: aba0: \***
12843: aba0: \***      If the Price Check application, then PSS37 checks that the
12844: aba0: \***      printer and labeller are switched on.
12845: aba0: \***
12846: aba0: \***      If the Stocktake application then check for stocktake in progress.
12847: aba0: \***
12848: aba0: \***   RETURN
12849: aba0: \***
12850: aba0: \***   LOCKED.FILE
12851: aba0: \***
12852: aba0: \***      file was locked - attempt unsuccessful
12853: aba0: \***
12854: aba0: \***   RETURN
12855: aba0: \***
12856: aba0: \******************************************************************************
12857: aba0: 
12858: aba0:    LOCK.APPLICATION.FILE:                                               ! DJAL
12859: abb0: 
12860: abb0:       GOSUB STAGGER.PORT                                                ! DSW
12861: abc2: 
12862: abc2:       CREDIT.CLAIM.FLAG$ = "NN"                                         ! 2.3JAS 2.4JAS
12863: abd9:       STORE.CLOSE.FLAG$  = "O"                                          ! 2.3JAS
12864: abee: 
12865: abee:       IF APPLICATION.NO$ = "01" THEN BEGIN                              ! epsom
12866: ac0f:         CURR.SESS.NUM% = EPSOM.SESS.NUM%                                ! DSW
12867: ac21:         IF END #EPSOM.SESS.NUM% THEN OPEN.ERROR                         ! DSW
12868: ac3d:         OPEN EPSOM.FILE.NAME$ AS EPSOM.SESS.NUM% LOCKED                 ! DSW
12869: ac64:         EPSOM.OPEN.FLAG$ = "Y"                                          ! DSW
12870: ac7b:         ALL.FILES.CLOSED$ = "N"                                         ! DSW
12871: ac95:       ENDIF ELSE IF APPLICATION.NO$ = "02" THEN BEGIN                   ! DSW
12872: acb6: \       CURR.SESS.NUM% = CSR.SESS.NUM%                                  ! DSW !2.9NWB
12873: acb6: \       IF END #CSR.SESS.NUM% THEN OPEN.ERROR                           ! DSW !2.9NWB
12874: acb6: \       OPEN CSR.FILE.NAME$ AS CSR.SESS.NUM% LOCKED                     ! DSW !2.9NWB
12875: acb6: \       CSR.OPEN.FLAG$ = "Y"                                            ! DSW !2.9NWB
12876: acb6: \       ALL.FILES.CLOSED$ = "N"                                         ! DSW !2.9NWB
12877: acb6:         IF (NOT ASN.ACTIVE%) THEN BEGIN                                 ! 2.9NWB
12878: accb:            RECEIVE.STATE$ = "*"                                         ! 2.9NWB
12879: ace2:            SUCCESS.FLAG$ = "N"                                          ! 2.9NWB
12880: acf7:            NAK.LINE.1$ = "Carton Delivery"                              ! 2.9NWB
12881: ad0c:            NAK.LINE.2$ = "System is"                                    ! 2.9NWB
12882: ad21:            NAK.LINE.3$ = "Inactive."                                    ! 2.9NWB
12883: ad36:            RETURN                                                       ! 2.9NWB
12884: ad46:         ENDIF                                                           ! 2.9NWB
12885: ad51:       ENDIF ELSE IF APPLICATION.NO$ = "03" THEN BEGIN                   ! pchk
12886: ad72:         CURR.SESS.NUM% = PCHK.SESS.NUM%                                 ! DSW
12887: ad84:         IF END #PCHK.SESS.NUM% THEN OPEN.ERROR                          ! DSW
12888: ada0:         OPEN PCHK.FILE.NAME$ DIRECT RECL 1 AS PCHK.SESS.NUM% LOCKED     ! DSW
12889: adc7:         PCHK.OPEN.FLAG$ = "Y"                                           ! DSW
12890: adde:         ALL.FILES.CLOSED$ = "N"                                         ! DSW
12891: adf8:       ENDIF ELSE IF APPLICATION.NO$ = "05" THEN BEGIN                   ! HDS
12892: ae19:         CURR.SESS.NUM% = DIREC.SESS.NUM%                                ! HDS
12893: ae2b:         IF END #DIREC.SESS.NUM% THEN OPEN.ERROR                         ! HDS
12894: ae47:         OPEN DIREC.FILE.NAME$ AS DIREC.SESS.NUM% LOCKED                 ! HDS
12895: ae6e:         DIREC.OPEN.FLAG$ = "Y"                                          ! HDS
12896: ae85:         ALL.FILES.CLOSED$ = "N"                                         ! HDS
12897: ae9f:       ENDIF ELSE IF APPLICATION.NO$ = "06" THEN BEGIN                   ! LLC
12898: aec0:         CURR.SESS.NUM% = UOD.SESS.NUM%                                  ! LLC
12899: aed2:         IF END #UOD.SESS.NUM% THEN OPEN.ERROR                           ! LLC
12900: aeee:         OPEN UOD.FILE.NAME$ AS UOD.SESS.NUM% LOCKED                     ! LLC
12901: af15:         UOD.OPEN.FLAG$ = "Y"                                            ! LLC
12902: af2c:         ALL.FILES.CLOSED$ = "N"                                         ! LLC
12903: af46:       ENDIF ELSE IF APPLICATION.NO$ = "07" THEN BEGIN                   ! MMJK
12904: af67:         CURR.SESS.NUM% = CCDMY.SESS.NUM%                                ! MMJK
12905: af79:         IF END #CCDMY.SESS.NUM% THEN OPEN.ERROR                         ! MMJK
12906: af95:         OPEN CCDMY.FILE.NAME$ AS CCDMY.SESS.NUM% LOCKED                 ! MMJK
12907: afbc:         CCDMY.OPEN.FLAG$ = "Y"                                          ! MMJK
12908: afd3:         ALL.FILES.CLOSED$ = "N"                                         ! MMJK
12909: afed:       ENDIF ELSE IF APPLICATION.NO$ = "08" THEN BEGIN                   ! 1.5
12910: b00b:         CURR.SESS.NUM% = STKTK.SESS.NUM%                                ! 1.5
12911: b01d:         IF END #STKTK.SESS.NUM% THEN OPEN.ERROR                         ! 1.5
12912: b039:         OPEN STKTK.FILE.NAME$ AS STKTK.SESS.NUM% LOCKED                 ! 1.5
12913: b060:         STKTK.OPEN.FLAG$ = "Y"                                          ! 1.5
12914: b078:       ENDIF ELSE IF APPLICATION.NO$ = "09" THEN BEGIN                   ! 2.1BG
12915: b096:         SUCCESS.FLAG$ = "Y"                                             ! 2.1BG
12916: b0ae:       ENDIF ELSE IF APPLICATION.NO$ = "10" THEN BEGIN                   ! 2.2JAS
12917: b0cc:         SUCCESS.FLAG$ = "Y"                                             ! 2.2JAS
12918: b0e4:       ENDIF ELSE IF APPLICATION.NO$ = "11" THEN BEGIN                   ! 2.10BG
12919: b102:         SUCCESS.FLAG$ = "Y"                                             ! 2.10BG
12920: b11a:       ENDIF ELSE IF APPLICATION.NO$ = "12" THEN BEGIN                   ! 2.12SH
12921: b138:         SUCCESS.FLAG$ = "Y"                                             ! 2.12SH
12922: b14f:       ENDIF ELSE BEGIN                                                  ! 1.5
12923: b157:         SUCCESS.FLAG$ = "N"                                             ! DSW
12924: b16c:         RECEIVE.STATE$ = "*"                                            ! DSW
12925: b183:         RETURN                                                          ! DSW
12926: b193:       ENDIF
12927: b19b: 
12928: b19b: \     IF APPLICATION.NO$ = "02" OR                                      \ 1.2 !2.9NWB
12929: b19b: \        APPLICATION.NO$ = "04" THEN BEGIN                              ! DSW !2.9NWB
12930: b19b: 
12931: b19b: \               SB.INTEGER% = INVOK.REPORT.NUM%                         !1.9DA!2.9NWB
12932: b19b: \               SB.STRING$ = INVOK.FILE.NAME$                           !1.9DA!2.9NWB
12933: b19b: \               GOSUB SB.FILE.UTILS                                     !1.9DA!2.9NWB
12934: b19b: \               INVOK.SESS.NUM% = SB.FILE.SESS.NUM%                     !1.9DA!2.9NWB
12935: b19b: 
12936: b19b: \               CURR.SESS.NUM% = INVOK.SESS.NUM%                        ! DSW !2.9NWB
12937: b19b: \               IF END #INVOK.SESS.NUM% THEN OPEN.ERROR                 ! DSW !2.9NWB
12938: b19b: \               OPEN INVOK.FILE.NAME$ DIRECT RECL 80 AS INVOK.SESS.NUM% \ DSW !2.9NWB
12939: b19b: \                    NOWRITE NODEL                                      ! DSW !2.9NWB
12940: b19b: \               INVOK.OPEN.FLAG$ = "Y"                                  ! DSW !2.9NWB
12941: b19b: \               RC% = READ.INVOK                                        ! ILC !2.9NWB
12942: b19b: \               IF RC% = 1 THEN GOTO READ.ERROR                         ! ILC !2.9NWB
12943: b19b: \               CLOSE INVOK.SESS.NUM%                                   ! DSW !2.9NWB
12944: b19b: \               INVOK.OPEN.FLAG$ = "N"                                  ! DSW !2.9NWB
12945: b19b: 
12946: b19b: \        ALLOW.CSR.PROCESSING = TRUE                                    ! 1.2 !2.9NWB
12947: b19b: 
12948: b19b: \        IF INVOK.CSR.CONVERSION.STATUS.FLAG$ = "S" OR                  \ 1.2 !2.9NWB
12949: b19b: \           INVOK.CSR.CONVERSION.STATUS.FLAG$ = "C" THEN BEGIN          ! 1.2 !2.9NWB
12950: b19b: \           ALLOW.CSR.PROCESSING = FALSE                                ! 1.2 !2.9NWB
12951: b19b: \        ENDIF ELSE BEGIN                                               ! 1.2 !2.9NWB
12952: b19b: \           IF INVOK.CSR.CONVERSION.STATUS.FLAG$ = "X" THEN BEGIN       ! 1.2 !2.9NWB
12953: b19b: \              CURR.SESS.NUM% = SOFTS.SESS.NUM%                         ! 1.2 !2.9NWB
12954: b19b: \              IF END #SOFTS.SESS.NUM% THEN OPEN.ERROR                  ! 1.2 !2.9NWB
12955: b19b: \              OPEN SOFTS.FILE.NAME$ DIRECT RECL SOFTS.RECL%            \ 1.2 !2.9NWB
12956: b19b: \                   AS SOFTS.SESS.NUM% NOWRITE NODEL                    ! 1.2 !2.9NWB
12957: b19b: \              SOFTS.OPEN.FLAG$ = "Y"                                   ! 1.2 !2.9NWB
12958: b19b: \              SOFTS.REC.NUM% = 6                                       ! 1.2 !2.9NWB
12959: b19b: \              IF READ.SOFTS = 0 THEN BEGIN                             ! 1.2 !2.9NWB
12960: b19b: \                 IF (LEFT$(SOFTS.RECORD$,11) = "CSR PHASE 2") THEN BEGIN !1.2!2.9NWB
12961: b19b: \                    ALLOW.CSR.PROCESSING = FALSE                       ! 1.2 !2.9NWB
12962: b19b: \                 ENDIF                                                 ! 1.2 !2.9NWB
12963: b19b: \              ENDIF ELSE ALLOW.CSR.PROCESSING = FALSE                  ! 1.2 !2.9NWB
12964: b19b: \              CLOSE SOFTS.SESS.NUM%                                    ! 1.2 !2.9NWB
12965: b19b: \              SOFTS.OPEN.FLAG$ = "N"                                   ! 1.2 !2.9NWB
12966: b19b: \            ENDIF                                                      ! 1.2 !2.9NWB
12967: b19b: \         ENDIF                                                         ! 1.2 !2.9NWB
12968: b19b: 
12969: b19b: \        IF (NOT ALLOW.CSR.PROCESSING) THEN BEGIN                       ! 1.2 !2.9NWB
12970: b19b: \            NAK.LINE.1$ = "Link Inactive."                             ! 1.2 !2.9NWB
12971: b19b: \            NAK.LINE.2$ = "Press ENTER and"                            ! 1.2 !2.9NWB
12972: b19b: \            NAK.LINE.3$ = "FUNC Q to quit."                            ! 1.2 !2.9NWB
12973: b19b: \            SUCCESS.FLAG$ = "N"                                        ! 1.2 !2.9NWB
12974: b19b: \            RECEIVE.STATE$ = "*"                                       ! 1.2 !2.9NWB
12975: b19b: \            RETURN                                                     ! 1.2 !2.9NWB
12976: b19b: \        ENDIF                                                          ! 1.2 !2.9NWB
12977: b19b: 
12978: b19b: 
12979: b19b: \        IF APPLICATION.NO$ <> "04" THEN BEGIN                          ! 1.2 !2.9NWB
12980: b19b: \               IF INVOK.CSR.DELIVERY.DATE$ = DATE$ THEN BEGIN          ! DSW !2.9NWB
12981: b19b: \                     GOSUB CHECK.FOR.WORK.FILE                         ! DSW !2.9NWB
12982: b19b: \                     FIRST.CSR.LIST.FOR.PDT$ = "Y"                     ! DSW !2.9NWB
12983: b19b: \                     FIRST.EOT.FOR.THIS.PDT$ = "Y"                     ! DSW !2.9NWB
12984: b19b: \                     GOSUB CREATE.BUFFER                               ! DSW !2.9NWB
12985: b19b: \                  ENDIF ELSE BEGIN                                     ! DSW !2.9NWB
12986: b19b: \                     SUCCESS.FLAG$ = "N"                               ! DSW !2.9NWB
12987: b19b: \                     NAK.LINE.1$ = "Link unavailable"                  ! DSW !2.9NWB
12988: b19b: \                     NAK.LINE.2$ = "due to delivery"                   ! DSW !2.9NWB
12989: b19b: \                     NAK.LINE.3$ = "logging failure"                   ! DSW !2.9NWB
12990: b19b: \                     RECEIVE.STATE$ = "*"                              ! DSW !2.9NWB
12991: b19b: \                     RETURN                                            ! DSW !2.9NWB
12992: b19b: \                  ENDIF                                                ! DSW !2.9NWB
12993: b19b: \        ENDIF                                                          ! DSW !2.9NWB
12994: b19b: 
12995: b19b: \        SB.INTEGER% = INVOK.SESS.NUM%                                  !1.9DA!2.9NWB
12996: b19b: \        GOSUB SB.FILE.UTILS                                            !1.9DA!2.9NWB
12997: b19b: 
12998: b19b: \     ENDIF                                                                   !2.9NWB
12999: b19b: 
13000: b19b:       IF APPLICATION.NO$ = "07" THEN BEGIN                              ! MMJK
13001: b1bc:         RETURNS.LOGON.VALID = TRUE                                      ! MMJK
13002: b1ce:         CURR.SESS.NUM% = SOFTS.SESS.NUM%                                ! MMJK
13003: b1e0:         IF END #SOFTS.SESS.NUM% THEN SOFTS.FILE.ABSENT                  ! MMJK
13004: b1fc:         OPEN SOFTS.FILE.NAME$ DIRECT RECL SOFTS.RECL%                   \ MMJK
13005: b229:            AS SOFTS.SESS.NUM% NOWRITE NODEL                             ! MMJK
13006: b229:         SOFTS.OPEN.FLAG$ = "Y"                                          ! MMJK
13007: b240:         GOTO CHECK.SOFTS.RECORD                                         ! MMJK
13008: b24a:         SOFTS.FILE.ABSENT:                                              ! MMJK
13009: b25a:         RETURNS.LOGON.VALID = FALSE                                     ! MMJK
13010: b26c:         CHECK.SOFTS.RECORD:                                             ! MMJK
13011: b27c:         IF RETURNS.LOGON.VALID THEN BEGIN                               ! MMJK
13012: b28e:           SOFTS.REC.NUM% = 5                                            ! MMJK
13013: b2a5:           IF READ.SOFTS = 0 THEN BEGIN                                  ! MMJK
13014: b2ba:             IF (SOFTS.RECORD$<>"CHILLED FOODS IS ACTIVE") AND           \ MMJK
13015: b30c:             (SOFTS.RECORD$<>"RETURNS IS ACTIVE") THEN BEGIN             ! MMJK
13016: b30c:               NAK.LINE.1$ = "Returns/Chilled"                           ! MMJK
13017: b321:               NAK.LINE.2$ = "Food system is"                            ! MMJK
13018: b336:               NAK.LINE.3$ = "inactive"                                  ! MMJK
13019: b34b:               RETURNS.LOGON.VALID = FALSE                               ! MMJK
13020: b35d:             ENDIF                                                       ! MMJK
13021: b367:           ENDIF ELSE RETURNS.LOGON.VALID = FALSE                        ! MMJK
13022: b379:         ENDIF                                                           ! MMJK
13023: b381:         IF RETURNS.LOGON.VALID THEN BEGIN                               ! 2.3JAS
13024: b393:            SOFTS.REC.NUM% = 43                                          ! 2.3JAS
13025: b3aa:            IF READ.SOFTS = 0 THEN BEGIN                                 ! 2.3JAS
13026: b3bf:               IF LEFT$(SOFTS.RECORD$,22) = "CREDIT CLAIM IS ACTIVE" THEN BEGIN ! 2.3JAS
13027: b3f7:                  CREDIT.CLAIM.FLAG$ = "YN"                              ! 2.3JAS 2.4JAS
13028: b40e: 
13029: b40e:                  MATCH.DELIMITER1 = MATCH(",",SOFTS.RECORD$,26)                           !2.4JAS
13030: b42f:                  MATCH.DELIMITER2 = MATCH(",",SOFTS.RECORD$,(MATCH.DELIMITER1 + 1))       !2.4JAS
13031: b455:                  MATCH.DELIMITER3 = MATCH(",",SOFTS.RECORD$,(MATCH.DELIMITER2 + 1))       !2.4JAS
13032: b47b:                  REJECTION.TYPE$  = MID$(SOFTS.RECORD$,(MATCH.DELIMITER2 + 1), \          !2.4JAS
13033: b4b0:                                         (MATCH.DELIMITER3 - (MATCH.DELIMITER2 +1)))       !2.4JAS
13034: b4b0:                  IF REJECTION.TYPE$ = "ALL" THEN BEGIN                  ! 2.4JAS
13035: b4cb:                     CREDIT.CLAIM.FLAG$ = "YY"                           ! 2.4JAS
13036: b4e2:                  ENDIF                                                  ! 2.4JAS
13037: b4ea: 
13038: b4ea:                  SB.ACTION$ = "O"                                       ! 2.3JAS
13039: b4ff: 
13040: b4ff:                  SB.INTEGER% = TSF.SESS.NUM%                            ! 2.3JAS
13041: b511:                  SB.STRING$ = TSF.FILE.NAME$                            ! 2.3JAS
13042: b52d:                  GOSUB SB.FILE.UTILS                                    ! 2.3JAS
13043: b53f:                  TSF.SESS.NUM% = SB.FILE.SESS.NUM%                      ! 2.3JAS
13044: b552: 
13045: b552:                  CURR.SESS.NUM% = TSF.SESS.NUM%                         ! 2.3JAS
13046: b564: 
13047: b564:                  IF END #TSF.SESS.NUM% THEN TSF.FILE.ABSENT             ! 2.3JAS
13048: b580:                  OPEN TSF.FILE.NAME$ KEYED RECL TSF.RECL%               \ 2.3JAS
13049: b5ad:                    AS TSF.SESS.NUM% NOWRITE NODEL                       ! 2.3JAS
13050: b5ad:                  TSF.OPEN.FLAG$ = "Y"                                   ! 2.3JAS
13051: b5c4:                  GOTO CHECK.TSF.RECORD                                  ! 2.3JAS
13052: b5ce:                  TSF.FILE.ABSENT:                                       ! 2.3JAS
13053: b5de:                  RETURNS.LOGON.VALID = FALSE                            ! 2.3JAS
13054: b5f0:                  CHECK.TSF.RECORD:                                      ! 2.3JAS
13055: b600:                  IF RETURNS.LOGON.VALID THEN BEGIN                      ! 2.3JAS
13056: b612:                     TSF.TERM.STORE$ EQ PACK$("9999")                    ! 2.3JAS
13057: b62e:                     IF READ.TSF = 0 THEN BEGIN                          ! 2.3JAS
13058: b63f:                        IF TSF.INDICAT0% EQ -1 THEN BEGIN                ! 2.3JAS
13059: b651:                           STORE.CLOSE.FLAG$ = "C"                       ! 2.3JAS
13060: b666:                        ENDIF                                            ! 2.3JAS
13061: b670:                     ENDIF ELSE BEGIN                                    ! 2.3JAS
13062: b678:                        RETURNS.LOGON.VALID = FALSE                      ! 2.3JAS
13063: b68a:                     ENDIF                                               ! 2.3JAS
13064: b692:                  ENDIF                                                  ! 2.3JAS
13065: b69a: 
13066: b69a:                  SB.ACTION$ = "C"                                       ! 2.3JAS
13067: b6af:                  SB.STRING$ = ""                                        ! 2.3JAS
13068: b6c4: 
13069: b6c4:                  IF TSF.OPEN.FLAG$ = "Y" THEN BEGIN                     ! 2.3JAS
13070: b6e2:                     GOSUB SB.FILE.UTILS    ! CURR.SESS.NUM% set above   ! 2.7CS
13071: b6f4:                     CLOSE TSF.SESS.NUM%                                 ! 2.3JAS
13072: b708:                     TSF.OPEN.FLAG$ = "N"                                ! 2.3JAS
13073: b71f:                  ENDIF                                                  ! 2.3JAS
13074: b727:               ENDIF                                                     ! 2.3JAS
13075: b731:            ENDIF ELSE BEGIN                                             ! 2.3JAS
13076: b739:               RETURNS.LOGON.VALID = FALSE                               ! 2.3JAS
13077: b74b:            ENDIF                                                        ! 2.3JAS
13078: b753:         ENDIF                                                           ! 2.3JAS
13079: b75b:         IF RETURNS.LOGON.VALID THEN BEGIN                               ! MMJK
13080: b76d:           CURR.SESS.NUM% = CCUOD.SESS.NUM%                              ! MMJK
13081: b77f:           IF END #CCUOD.SESS.NUM% THEN OPEN.ERROR                       ! MDS
13082: b79b:           OPEN CCUOD.FILE.NAME$ KEYED RECL CCUOD.RECL%                  \ MMJK
13083: b7c7:              AS CCUOD.SESS.NUM%                                         ! MMJK
13084: b7c7:           CCUOD.OPEN.FLAG$ = "Y"                                        ! MMJK
13085: b7de:           GOTO CHECK.CCUOD.HDR.RECORD                                   ! MMJK
13086: b7e8:           CCUOD.FILE.ABSENT:                                            ! MMJK
13087: b7f8:           RETURNS.LOGON.VALID = FALSE                                   ! MMJK
13088: b80a:           CHECK.CCUOD.HDR.RECORD:                                       ! MMJK
13089: b81a:           CCUOD.UOD.NUM$ = PACK$(STRING$(7,"??"))                       ! MMJK
13090: b83d:           CURRENT.KEY$ = CCUOD.UOD.NUM$                                 ! MDS
13091: b859:           IF READ.CCUOD = 1 THEN GOTO READ.ERROR                        ! MDS
13092: b86e:           IF (CURR.TERMINAL$<>UNPACK$(CCUOD.LDT.NUM$)) AND              \ MMJK
13093: b8e2:              (UNPACK$(CCUOD.LDT.NUM$)<>"000000") THEN BEGIN             ! MMJK
13094: b8e2:               IF SOFTS.RECORD$="CHILLED FOODS IS ACTIVE" THEN BEGIN     ! MMJK
13095: b900:                 NAK.LINE.1$ = "Chilled Food"                            ! MMJK
13096: b915:                 NAK.LINE.2$ = "system in use"                           ! MMJK
13097: b92a:                 NAK.LINE.3$ = "Please try later"                        ! MMJK
13098: b941:               ENDIF ELSE BEGIN                                          ! MMJK
13099: b949:                 NAK.LINE.1$ = "Returns system"                          ! MMJK
13100: b95e:                 NAK.LINE.2$ = "in use"                                  ! MMJK
13101: b973:                 NAK.LINE.3$ = "Please try later"                        ! MMJK
13102: b988:               ENDIF                                                     ! MMJK
13103: b990:               RETURNS.LOGON.VALID = FALSE                               ! MMJK
13104: b9a2:           ENDIF                                                         ! MMJK
13105: b9aa:         ENDIF                                                           ! MMJK
13106: b9b2:         IF (NOT RETURNS.LOGON.VALID) THEN BEGIN                         ! MMJK
13107: b9c1:           SUCCESS.FLAG$ = "N"                                           ! MMJK
13108: b9d6:           RECEIVE.STATE$ = "*"                                          ! MMJK
13109: b9ed:           RETURN                                                        ! MMJK
13110: b9fd:         ENDIF                                                           ! MMJK
13111: ba05:       ENDIF                                                             ! MMJK
13112: ba0d: 
13113: ba0d:       IF APPLICATION.NO$ = "08" AND                                     \ 1.9DA
13114: ba50:          STOCKTAKING.ALTERNATIVE.STORE = FALSE THEN BEGIN               ! 1.9DA
13115: ba50:         IF END# SXTCF.SESS.NUM% THEN OPEN.ERROR                         ! 1.5
13116: ba6c:         CURR.SESS.NUM% = SXTCF.SESS.NUM%                                ! 1.5
13117: ba7e:         OPEN SXTCF.FILE.NAME$ DIRECT RECL SXTCF.RECL%                   \ 1.5
13118: baab:                AS SXTCF.SESS.NUM% NOWRITE NODEL                         ! 1.5
13119: baab: 
13120: baab:         CURR.SESS.NUM% = SXTCF.SESS.NUM%                                ! 1.5
13121: babd:         RC% = READ.SXTCF                                                ! 1.5
13122: bad2:         IF RC% <> 0 THEN GOTO READ.ERROR                                ! 1.5
13123: bae7:         CLOSE SXTCF.SESS.NUM%                                           ! 1.5
13124: bafb: 
13125: bafb:         IF SXTCF.STOCKTAKE.IN.PROGRESS$ <> "Y" THEN BEGIN               ! 1.5
13126: bb1c:                NAK.LINE.1$ = "Stocktake not"                            ! 1.5
13127: bb31:                NAK.LINE.2$ = "in progress."                             ! 1.5
13128: bb46:                NAK.LINE.3$ = "Log-on not valid."                        ! 1.5
13129: bb5b:                SUCCESS.FLAG$ = "N"                                      ! 1.5
13130: bb70:                RECEIVE.STATE$ = "*"                                     ! 1.5
13131: bb87:                RETURN                                                   ! 1.5
13132: bb97:         ENDIF                                                           ! 1.5
13133: bb9f: 
13134: bb9f:       ENDIF                                                             ! 1.5
13135: bba7: 
13136: bba7:       SUCCESS.FLAG$ = "Y"                                               ! DJAL
13137: bbbc:       EXP.STATES$ = LOGON.TAB$(VAL(APPLICATION.NO$))                    ! DJAL
13138: bbf4: 
13139: bbf4:    RETURN                                                               ! DJAL
13140: bc04: 
13141: bc04: LOCKED.FILE:                                                            ! DJAL
13142: bc14: 
13143: bc14:       NAK.LINE.1$ = "Application is"                                    ! DSW
13144: bc29:       NAK.LINE.2$ = "already in use."                                   ! DSW
13145: bc3e:       NAK.LINE.3$ = "Please try later"                                  ! DSW
13146: bc53:       SUCCESS.FLAG$ = "N"                                               ! DSW
13147: bc68: 
13148: bc68:    RETURN                                                               ! DJAL
13149: bc78: 
13150: bc78: \******************************************************************************
13151: bc78: \***
13152: bc78: \***   STAGGER.PORT:
13153: bc78: \***
13154: bc78: \***      if the other port calls this routine at exactly the same time as
13155: bc78: \***      this port then ensure ONE port has to wait before return
13156: bc78: \***      N.B This is a temperary workround to the file-lock problem (when
13157: bc78: \***      two applications simultaneously attempt to open a file, BOTH
13158: bc78: \***      applications get the file !)
13159: bc78: \***
13160: bc78: \***   RETURN
13161: bc78: \***
13162: bc78: \******************************************************************************
13163: bc78: 
13164: bc78:    STAGGER.PORT:                                                        ! DSW
13165: bc88: 
13166: bc88: 
13167: bc88:       WHILE MOD(VAL(TIME$), 2) <> (ASC(MONITORED.PORT$)-ASC("A"))       ! DSW
13168: bc92:         WAIT ; 200                                                      ! DSW
13169: bca9:       WEND                                                              ! DSW
13170: bd0c: 
13171: bd0c: 
13172: bd0c:    RETURN                                                               ! DSW
13173: bd1c: \******************************************************************************
13174: bd1c: \***
13175: bd1c: \***   CHECK.FOR.WORK.FILE:
13176: bd1c: \***
13177: bd1c: \***      hold PDT
13178: bd1c: \***      process CSR work file if it exists and is to be processed
13179: bd1c: \***      release PDT
13180: bd1c: \***
13181: bd1c: \***   RETURN
13182: bd1c: \***
13183: bd1c: \******************************************************************************
13184: bd1c: 
13185: bd1c: \  CHECK.FOR.WORK.FILE:                                                 ! DSW !2.9NWB
13186: bd1c: 
13187: bd1c: \     GOSUB HOLD.PDT                                                    ! DSW !2.9NWB
13188: bd1c: \     CURR.SESS.NUM% = CSRWF.SESS.NUM%                                  ! DSW !2.9NWB
13189: bd1c: \     IF END# CSRWF.SESS.NUM% THEN NO.CSRWF                             ! DSW !2.9NWB
13190: bd1c: \     OPEN CSRWF.FILE.NAME$ AS CSRWF.SESS.NUM%                          ! DSW !2.9NWB
13191: bd1c: \     CSRWF.OPEN.FLAG$ = "Y"                                            ! DSW !2.9NWB
13192: bd1c: \     CLOSE CSRWF.SESS.NUM%                                             ! DSW !2.9NWB
13193: bd1c: \     CSRWF.OPEN.FLAG$ = "N"                                            ! DSW !2.9NWB
13194: bd1c: \     SB.MESSAGE$ = "PDT Support - Processing CSR work file"            ! DSW !2.9NWB
13195: bd1c: \     GOSUB SB.BG.MESSAGE                                               ! DSW !2.9NWB
13196: bd1c: \     PROCESS.CSR.WORKFILE$ = "Y"                                       ! DSW !2.9NWB
13197: bd1c: \     GOSUB ALLOCATE.MODULE.1                                           !2.0DA!2.9NWB
13198: bd1c: \     CALL PSS3701                                                      ! DSW !2.9NWB
13199: bd1c: \     GOSUB DEALLOCATE.MODULE.1                                         !2.0DA!2.9NWB
13200: bd1c: \  NO.CSRWF:                                                            ! DSW !2.9NWB
13201: bd1c: \     GOSUB RELEASE.PDT                                                 ! DSW !2.9NWB
13202: bd1c: 
13203: bd1c: \  RETURN                                                               ! DSW !2.9NWB
13204: bd1c: 
13205: bd1c: \******************************************************************************
13206: bd1c: \***
13207: bd1c: \***   TRANSMIT.POSITIVE.LOG.ON:
13208: bd1c: \***
13209: bd1c: \***   If application transmitted is not Returns/Credit Claiming then the pipe out
13210: bd1c: \***      variable must not contain the credit claim flag or Store close flag
13211: bd1c: \***   If application transmitted is credit claiming then the pipe out
13212: bd1c: \***      variable must contain the credit claim flag and store close flag
13213: bd1c: \***
13214: bd1c: \***      send a positive log-on acknowledgment to PSS38 to indicate a
13215: bd1c: \***      successful log-on
13216: bd1c: \***
13217: bd1c: \***   RETURN
13218: bd1c: \***
13219: bd1c: \******************************************************************************
13220: bd1c: 
13221: bd1c:    TRANSMIT.POSITIVE.LOG.ON:
13222: bd2c: 
13223: bd2c:       T.DATE$ = DATE$
13224: bd44:       T.TIME$ = TIME$
13225: bd5c: 
13226: bd5c:       ! If Application "07" (is not Returns/credit claim transmission)
13227: bd5c:       IF APPLICATION.NO$ <> "07" THEN BEGIN                              ! 2.3JAS
13228: bd7d:          PIPE.OUT$ = "L" +                                                 \
13229: be6d:                      SOH$ +                                                \
13230: be6d:                      FN.Z.PACK(STORE.NUMBER$, 4) +                         \
13231: be6d:                      FN.Z.PACK(CURR.TERMINAL$, 6) +                        \
13232: be6d:                      APPLICATION.NO$ +                                     \ DJAL
13233: be6d:                      RIGHT$(T.DATE$,2)+MID$(T.DATE$,3,2)+LEFT$(T.DATE$,2) +\
13234: be6d:                      LEFT$(T.TIME$,4) +                                    \
13235: be6d:                      ACK$                                                  ! DJAL
13236: be6d:       ENDIF ELSE BEGIN                                                     ! 2.3JAS
13237: be75:          ! Application is Returns/Credit claim transmission
13238: be75:          PIPE.OUT$ = "L" +                                                 \! 2.3JAS
13239: bf89:                      SOH$ +                                                \! 2.3JAS
13240: bf89:                      FN.Z.PACK(STORE.NUMBER$, 4) +                         \! 2.3JAS
13241: bf89:                      FN.Z.PACK(CURR.TERMINAL$, 6) +                        \! 2.3JAS
13242: bf89:                      APPLICATION.NO$ +                                     \! 2.3JAS
13243: bf89:                      RIGHT$(T.DATE$,2)+MID$(T.DATE$,3,2)+LEFT$(T.DATE$,2) +\! 2.3JAS
13244: bf89:                      LEFT$(T.TIME$,4) +                                    \! 2.3JAS
13245: bf89:                      LEFT$(CREDIT.CLAIM.FLAG$,1) +                         \! 2.3JAS 2.4JAS
13246: bf89:                      STORE.CLOSE.FLAG$ +                                   \! 2.3JAS
13247: bf89:                      ACK$                                                  !  2.3JAS
13248: bf89:       ENDIF                                                                !  2.3JAS
13249: bf91: 
13250: bf91:       GOSUB SEND.TO.PSS38
13251: bfa3: 
13252: bfa3:    RETURN
13253: bfb3: 
13254: bfb3: \******************************************************************************
13255: bfb3: \***
13256: bfb3: \***   CREATE.BUFFER: (removed v2.9)
13257: bfb3: \***
13258: bfb3: \***      if a buffer already exists then close it
13259: bfb3: \***      create a new buffer
13260: bfb3: \***
13261: bfb3: \***   RETURN
13262: bfb3: \***
13263: bfb3: \******************************************************************************
13264: bfb3: 
13265: bfb3: \  CREATE.BUFFER:                                                       ! DJAL!2.9NWB
13266: bfb3: 
13267: bfb3: \     CURR.SESS.NUM% = CSRBF.SESS.NUM%                                  ! DJAL!2.9NWB
13268: bfb3: 
13269: bfb3: \     IF CSRBF.OPEN.FLAG$ = "Y" THEN BEGIN                              ! DSW !2.9NWB
13270: bfb3: \        IF END #CSRBF.SESS.NUM% THEN DELETE.ERROR                      ! DSW !2.9NWB
13271: bfb3: \        DELETE CSRBF.SESS.NUM%                                         ! DSW !2.9NWB
13272: bfb3: \        CSRBF.OPEN.FLAG$ = "N"                                         ! DSW !2.9NWB
13273: bfb3: \     ENDIF                                                             ! DSW !2.9NWB
13274: bfb3: 
13275: bfb3: \     IF END #CSRBF.SESS.NUM% THEN OPEN.ERROR                           ! DJAL!2.9NWB
13276: bfb3: \     CREATE CSRBF.FILE.NAME$ AS CSRBF.SESS.NUM%                        ! DJAL!2.9NWB
13277: bfb3: \     CSRBF.OPEN.FLAG$ = "Y"                                            ! DJAL!2.9NWB
13278: bfb3: 
13279: bfb3: \  RETURN                                                                     !2.9NWB
13280: bfb3: 
13281: bfb3: \******************************************************************************
13282: bfb3: \***
13283: bfb3: \***   TRANSMIT.NEGATIVE.LOG.ON:
13284: bfb3: \***
13285: bfb3: \***      send a negative log-on acknowledgment to PSS38 to indicate an
13286: bfb3: \***      unsuccessful log-on
13287: bfb3: \***
13288: bfb3: \***   RETURN
13289: bfb3: \***
13290: bfb3: \******************************************************************************
13291: bfb3: 
13292: bfb3:    TRANSMIT.NEGATIVE.LOG.ON:
13293: bfc3: 
13294: bfc3:       PIPE.OUT$ = "L" +                                                 \
13295: c0be:                   SOH$ +                                                \
13296: c0be:                   FN.Z.PACK(STORE.NUMBER$,4) +                          \
13297: c0be:                   FN.Z.PACK(CURR.TERMINAL$,6) +                         \
13298: c0be:                   APPLICATION.NO$ +                                     \ DJAL
13299: c0be:                   NAK$ +                                                \ DSW
13300: c0be:                   LEFT$(NAK.LINE.1$ + "                ", 16) +         \ DSW
13301: c0be:                   LEFT$(NAK.LINE.2$ + "                ", 16) +         \ DSW
13302: c0be:                   LEFT$(NAK.LINE.3$ + "                ", 16)           ! DSW
13303: c0be: 
13304: c0be:       GOSUB SEND.TO.PSS38
13305: c0d0: 
13306: c0d0:    RETURN
13307: c0e0: 
13308: c0e0: \******************************************************************************
13309: c0e0: \***
13310: c0e0: \***   HOLD.PDT:
13311: c0e0: \***
13312: c0e0: \***      send a hold PDT command to PSS38
13313: c0e0: \***
13314: c0e0: \***   RETURN
13315: c0e0: \***
13316: c0e0: \******************************************************************************
13317: c0e0: 
13318: c0e0:    HOLD.PDT:
13319: c0f0: 
13320: c0f0:       PIPE.OUT$ = "HY"
13321: c107:       GOSUB SEND.TO.PSS38
13322: c119:       HOLD.FLAG$ = "Y"
13323: c130: 
13324: c130:    RETURN
13325: c140: 
13326: c140: \******************************************************************************
13327: c140: \***
13328: c140: \***   RELEASE.PDT:
13329: c140: \***
13330: c140: \***      send a release PDT command to PSS38
13331: c140: \***
13332: c140: \***   RETURN
13333: c140: \***
13334: c140: \******************************************************************************
13335: c140: 
13336: c140:    RELEASE.PDT:
13337: c150: 
13338: c150:       PIPE.OUT$ = "HN"
13339: c167:       GOSUB SEND.TO.PSS38
13340: c179:       HOLD.FLAG$ = "N"
13341: c190: 
13342: c190:    RETURN
13343: c1a0: 
13344: c1a0: \******************************************************************************
13345: c1a0: \***
13346: c1a0: \***   SEND.XON:
13347: c1a0: \***
13348: c1a0: \***      send an XON to the PDT (via PSS38), just in case the PDT has hung
13349: c1a0: \***
13350: c1a0: \***   RETURN
13351: c1a0: \***
13352: c1a0: \******************************************************************************
13353: c1a0: 
13354: c1a0:    SEND.XON:                                                            ! DSW
13355: c1b0: 
13356: c1b0:       PIPE.OUT$ = "XY"                                                  ! DSW
13357: c1c7:       GOSUB SEND.TO.PSS38                                               ! DSW
13358: c1d9: 
13359: c1d9:    RETURN                                                               ! DSW
13360: c1e9: 
13361: c1e9: \******************************************************************************
13362: c1e9: \***
13363: c1e9: \***   SEND.TO.PSS38:
13364: c1e9: \***
13365: c1e9: \***      transmit data to PSS38 (data contained in PIPE.OUT$)
13366: c1e9: \***
13367: c1e9: \***   RETURN
13368: c1e9: \***
13369: c1e9: \******************************************************************************
13370: c1e9: 
13371: c1e9:    SEND.TO.PSS38:
13372: c1f9: 
13373: c1f9:       IF END# PIPEI.SESS.NUM% THEN WRITE.ERROR
13374: c217:       CURR.SESS.NUM% = PIPEI.SESS.NUM%
13375: c229:       WRITE# PIPEI.SESS.NUM%; PIPE.OUT$
13376: c251: 
13377: c251:    RETURN
13378: c261: 
13379: c261: \******************************************************************************
13380: c261: \******************************************************************************
13381: c261: \***
13382: c261: \***   S H U T D O W N
13383: c261: \***
13384: c261: \******************************************************************************
13385: c261: \******************************************************************************
13386: c261: 
13387: c261: \******************************************************************************
13388: c261: \***
13389: c261: \***   SHUTDOWN:
13390: c261: \***
13391: c261: \***      stop PSS38
13392: c261: \***      close PSS37 - PSS38 communications
13393: c261: \***      de-allocate all used file session numbers
13394: c261: \***      display 'ended' message
13395: c261: \***
13396: c261: \***   RETURN
13397: c261: \***
13398: c261: \******************************************************************************
13399: c261: 
13400: c261:    SHUTDOWN:
13401: c271:    
13402: c271:       QUIT.FLAG$ = "Y"
13403: c286: 
13404: c286:       PIPE.OUT$ = "Q"
13405: c29d:       GOSUB SEND.TO.PSS38
13406: c2af: 
13407: c2af:       CLOSE PIPEI.SESS.NUM%
13408: c2c5:       CLOSE PIPEO.SESS.NUM%
13409: c2db:       CLOSE PLDT.SESS.NUM%                                              ! HDS
13410: c2f1: 
13411: c2f1:       SB.ACTION$ = "C"
13412: c306:       SB.STRING$ = ""
13413: c31b: 
13414: c31b:       SB.INTEGER% = BCSMF.SESS.NUM%
13415: c32d:       GOSUB SB.FILE.UTILS
13416: c33f: \     SB.INTEGER% = CITEM.SESS.NUM%                                     ! DJAL!2.9NWB
13417: c33f: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
13418: c33f: \     SB.INTEGER% = CSR.SESS.NUM%                                       ! DJAL!2.9NWB
13419: c33f: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
13420: c33f: \     SB.INTEGER% = CSRWF.SESS.NUM%                                     ! DJAL!2.9NWB
13421: c33f: \     GOSUB SB.FILE.UTILS                                               ! DJAL!2.9NWB
13422: c33f: !     SB.INTEGER% = FPF.SESS.NUM%                                       ! DJAL
13423: c33f: !     GOSUB SB.FILE.UTILS                                               ! DJAL
13424: c33f:       SB.INTEGER% = IDF.SESS.NUM%
13425: c351:       GOSUB SB.FILE.UTILS
13426: c363:       SB.INTEGER% = IEF.SESS.NUM%
13427: c375:       GOSUB SB.FILE.UTILS
13428: c387:       SB.INTEGER% = IRF.SESS.NUM%
13429: c399:       GOSUB SB.FILE.UTILS
13430: c3ab: !     SB.INTEGER% = ONORD.SESS.NUM%                                     ! DJAL
13431: c3ab: !     GOSUB SB.FILE.UTILS                                               ! DJAL
13432: c3ab:       SB.INTEGER% = PCHK.SESS.NUM%                                      ! DJAL
13433: c3bd:       GOSUB SB.FILE.UTILS                                               ! DJAL
13434: c3cf:       SB.INTEGER% = PDTWF.SESS.NUM%
13435: c3e1:       GOSUB SB.FILE.UTILS
13436: c3f3:       SB.INTEGER% = PIITM.SESS.NUM%
13437: c406:       GOSUB SB.FILE.UTILS
13438: c418:       SB.INTEGER% = PILST.SESS.NUM%
13439: c42b:       GOSUB SB.FILE.UTILS
13440: c43d:       SB.INTEGER% = PIPEI.SESS.NUM%
13441: c450:       GOSUB SB.FILE.UTILS
13442: c462:       SB.INTEGER% = PIPEO.SESS.NUM%
13443: c475:       GOSUB SB.FILE.UTILS
13444: c487:       SB.INTEGER% = STKMQ.SESS.NUM%
13445: c499:       GOSUB SB.FILE.UTILS
13446: c4ab:       SB.INTEGER% = UNITS.SESS.NUM%                                     ! DJAL
13447: c4bd:       GOSUB SB.FILE.UTILS                                               ! DJAL
13448: c4cf:       SB.INTEGER% = DIRORD.SESS.NUM%                                    ! HDS
13449: c4e1:       GOSUB SB.FILE.UTILS                                               ! HDS
13450: c4f3:       SB.INTEGER% = DIRSUP.SESS.NUM%                                    ! HDS
13451: c505:       GOSUB SB.FILE.UTILS                                               ! HDS
13452: c517:       SB.INTEGER% = DIRWF.SESS.NUM%                                     ! HDS
13453: c529:       GOSUB SB.FILE.UTILS                                               ! HDS
13454: c53b:       SB.INTEGER% = DIREC.SESS.NUM%                                     ! HDS
13455: c54d:       GOSUB SB.FILE.UTILS                                               ! HDS
13456: c55f:       SB.INTEGER% = LDTCF.SESS.NUM%                                     ! HDS
13457: c571:       GOSUB SB.FILE.UTILS                                               ! HDS
13458: c583:       SB.INTEGER% = PLDT.SESS.NUM%                                      ! HDS
13459: c596:       GOSUB SB.FILE.UTILS                                               ! HDS
13460: c5a8:       SB.INTEGER% = DRSMQ.SESS.NUM%                                     ! HDS
13461: c5ba:       GOSUB SB.FILE.UTILS                                               ! HDS
13462: c5cc:       SB.INTEGER% = EPSOM.SESS.NUM%                                     ! DJAL
13463: c5de:       GOSUB SB.FILE.UTILS                                               ! DJAL
13464: c5f0:       SB.INTEGER% = LDTBF.SESS.NUM%                                     ! JLC
13465: c603:       GOSUB SB.FILE.UTILS                                               ! JLC
13466: c615:       SB.INTEGER% = IDSOF.SESS.NUM%                                     ! JLC
13467: c627:       GOSUB SB.FILE.UTILS                                               ! JLC
13468: c639:       SB.INTEGER% = CCUOD.SESS.NUM%                                     ! MMJK  ! 2.7CS
13469: c64b:       GOSUB SB.FILE.UTILS                                               ! MMJK
13470: c65d:       SB.INTEGER% = CCLAM.SESS.NUM%                                     ! 1.4   ! 2.7CS
13471: c66f:       GOSUB SB.FILE.UTILS                                               ! 1.4
13472: c681:       SB.INTEGER% = CCITM.SESS.NUM%                                     ! MMJK  ! 2.7CS
13473: c693:       GOSUB SB.FILE.UTILS                                               ! MMJK
13474: c6a5:       SB.INTEGER% = CCTRL.SESS.NUM%                                     ! MMJK  ! 2.7CS
13475: c6b7:       GOSUB SB.FILE.UTILS                                               ! MMJK
13476: c6c9:       SB.INTEGER% = CCDMY.SESS.NUM%                                     ! MMJK  ! 2.7CS
13477: c6db:       GOSUB SB.FILE.UTILS                                               ! MMJK
13478: c6ed:       SB.INTEGER% = CCTMP.SESS.NUM%                                     ! MMJK  ! 2.7CS
13479: c6ff:       GOSUB SB.FILE.UTILS                                               ! MMJK
13480: c711:       SB.INTEGER% = CCBUF.SESS.NUM%                                     ! MMJK  ! 2.7CS
13481: c723:       GOSUB SB.FILE.UTILS                                               ! MMJK
13482: c735:       SB.INTEGER% = CCUPF.SESS.NUM%                                     ! NMJK  ! 2.7CS
13483: c747:       GOSUB SB.FILE.UTILS                                               ! NMJK
13484: c759:       SB.INTEGER% = CCWKF.SESS.NUM%                                     ! MMJK  ! 2.7CS
13485: c76b:       GOSUB SB.FILE.UTILS                                               ! MMJK
13486: c77d:       SB.INTEGER% = LDTAF.SESS.NUM%                                     ! MMJK  ! 2.7CS
13487: c78f:       GOSUB SB.FILE.UTILS                                               ! MMJK
13488: c7a1:       SB.INTEGER% = SXTCF.SESS.NUM%                                     ! 1.5   ! 2.7CS
13489: c7b3:       GOSUB SB.FILE.UTILS                                               ! 1.5
13490: c7c5:       SB.INTEGER% = SXTMP.SESS.NUM%                                     ! 1.5   ! 2.7CS
13491: c7d7:       GOSUB SB.FILE.UTILS                                               ! 1.5
13492: c7e9:       SB.INTEGER% = STKBF.SESS.NUM%                                     ! 1.5   ! 2.7CS
13493: c7fb:       GOSUB SB.FILE.UTILS                                               ! 1.5
13494: c80d:       SB.INTEGER% = STKTK.SESS.NUM%                                     ! 1.5   ! 2.7CS
13495: c81f:       GOSUB SB.FILE.UTILS                                               ! 1.5
13496: c831: !      SB.INTEGER% = LSSST.SESS.NUM%                                     !1.8BG  ! 2.7CS
13497: c831: !      GOSUB SB.FILE.UTILS                                               !1.8BG  ! 2.7CS
13498: c831:       SB.INTEGER% = GAPBF.SESS.NUM%                                     ! DJAL !2.5CS !2.6BG
13499: c844:       GOSUB SB.FILE.UTILS                                               ! DJAL !2.5CS !2.6BG
13500: c856:       SB.INTEGER% = PLLOL.SESS.NUM%                                     !2.5CS
13501: c868:       GOSUB SB.FILE.UTILS                                               !2.5CS
13502: c87a:       SB.INTEGER% = PLLDB.SESS.NUM%                                     !2.5CS
13503: c88c:       GOSUB SB.FILE.UTILS                                               !2.5CS
13504: c89e:       SB.INTEGER% = CB.SESS.NUM%                                        ! 2.9NWB
13505: c8b0:       GOSUB SB.FILE.UTILS                                               ! 2.9NWB
13506: c8c2:       SB.INTEGER% = RB.SESS.NUM%                                        ! 2.10BG
13507: c8d4:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
13508: c8e6:       SB.INTEGER% = REWKF.SESS.NUM%                                     ! 2.10BG
13509: c8f8:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
13510: c90a:       SB.INTEGER% = RECALLS.SESS.NUM%                                   ! 2.10BG
13511: c91c:       GOSUB SB.FILE.UTILS                                               ! 2.10BG
13512: c92e:       SB.INTEGER% = DELVINDX.SESS.NUM%
13513: c940:       
13514: c940:       SB.MESSAGE$ = "PDT Support - Ended"                               ! DJAL
13515: c955:       GOSUB SB.BG.MESSAGE
13516: c967: 
13517: c967:    RETURN
13518: c977: 
13519: c977: \******************************************************************************
13520: c977: \******************************************************************************
13521: c977: \***                                                                        ***
13522: c977: \***                                                                        ***
13523: c977: \***   L O W   L E V E L   S U B R O U T I N E S                            ***
13524: c977: \***                                                                        ***
13525: c977: \***                                                                        ***
13526: c977: \***   - SB.FILE.UTILS                                                      ***
13527: c977: \***   - SB.BG.MESSAGE                                                      ***
13528: c977: \***   - SB.LOG.AN.EVENT                                                    ***
13529: c977: \***   - SB.FORMAT.ERROR.DATA                                               ***
13530: c977: \***   - SB.LOG.PDT.ERROR                                                   ***
13531: c977: \***   - SB.FILE.OPEN.ERROR                                                 ***
13532: c977: \***   - SB.FILE.READ.ERROR                                                 ***
13533: c977: \***   - SB.FILE.WRITE.ERROR                                                ***
13534: c977: \***                                                                        ***
13535: c977: \******************************************************************************
13536: c977: \******************************************************************************
13537: c977: 
13538: c977: \******************************************************************************
13539: c977: \***
13540: c977: \***   Subroutine : SB.FILE.UTILS
13541: c977: \***
13542: c977: \***   Purpose    : Allocate / report / de-allocate a file session number
13543: c977: \***
13544: c977: \***   Parameters : 2 or 3 (depending on action)
13545: c977: \***
13546: c977: \***      SB.ACTION$  = "O" for allocate file session number
13547: c977: \***                    "R" for report file session number
13548: c977: \***                    "C" for de-allocate file session number
13549: c977: \***      SB.INTEGER% = file reporting number for action "O" or
13550: c977: \***                  = file session number for actions "R" or "C"
13551: c977: \***
13552: c977: \***      SB.STRING$  = logical file name for action "O" or
13553: c977: \***                    null ("") for actions "R" and "C"
13554: c977: \***
13555: c977: \***   Output     : 1 or 2 (depending on action)
13556: c977: \***      SB.FILE.SESS.NUM% = file session number for action "O" or
13557: c977: \***                          undefined for action "C"
13558: c977: \***      or
13559: c977: \***      SB.FILE.REP.NUM%  = file reporting number for action "R" or
13560: c977: \***                          undefined for action "C"
13561: c977: \***
13562: c977: \***   Error action : log event 48 and end program
13563: c977: \***
13564: c977: \******************************************************************************
13565: c977: 
13566: c977:    SB.FILE.UTILS:
13567: c987: 
13568: c987:       RC% = SESS.NUM.UTILITY(SB.ACTION$,                                \
13569: c9b2:                              SB.INTEGER%,                               \
13570: c9b2:                              SB.STRING$ )
13571: c9b2: 
13572: c9b2:       IF RC% <> 0 THEN BEGIN
13573: c9c4:          SB.EVENT.NO% = 48
13574: c9d1:          SB.UNIQUE$ = FN.Z.PACK(STR$(F20.INTEGER.FILE.NO%), 10)
13575: ca02:          SB.MESSAGE$ = "SESSION NUMBER ALLOCATION ROUTINE FAILED"
13576: ca17:          GOSUB SB.LOG.AN.EVENT
13577: ca29:          GOTO PROGRAM.EXIT
13578: ca34:       ENDIF
13579: ca3c: 
13580: ca3c:       IF SB.ACTION$ = "O" THEN                                          \
13581: ca57:          SB.FILE.SESS.NUM% = F20.INTEGER.FILE.NO%
13582: ca69:       IF SB.ACTION$ = "R" THEN                                          \
13583: ca84:          SB.FILE.REP.NUM% = F20.INTEGER.FILE.NO%
13584: ca96: 
13585: ca96:    RETURN
13586: caa6: 
13587: caa6: \******************************************************************************
13588: caa6: \***
13589: caa6: \***   Subroutine : SB.BG.MESSAGE
13590: caa6: \***
13591: caa6: \***   Purpose    : Display a message to the background screen
13592: caa6: \***
13593: caa6: \***   Parameters : 1
13594: caa6: \***
13595: caa6: \***      SB.MESSAGE$ = message to be displayed (message will be truncated to
13596: caa6: \***                    46 characters if the message is longer than 46 chars)
13597: caa6: \***                    Minus the port letter.
13598: caa6: \***
13599: caa6: \***   Output     : 1
13600: caa6: \***      SB.MESSAGE$ = null
13601: caa6: \***
13602: caa6: \***   Error action : log an event 23 and end program
13603: caa6: \***
13604: caa6: \******************************************************************************
13605: caa6: 
13606: caa6:    SB.BG.MESSAGE:
13607: cab6: 
13608: cab6:       IF SB.MESSAGE$ = LAST.MESSAGE$ THEN RETURN
13609: cae0:       LAST.MESSAGE$ = SB.MESSAGE$                                       ! FPAB
13610: cafb: 
13611: cafb:       SB.MESSAGE$ = MONITORED.PORT$ + ": " + SB.MESSAGE$                ! DJAL
13612: cb26:       SB.MESSAGE$ = LEFT$(SB.MESSAGE$ + STRING$(46," "),46)             ! FPAB
13613: cb70:       CALL ADXSERVE( ADX.RET.CODE%, 26, 0, SB.MESSAGE$)
13614: cba8: 
13615: cba8:       IF ADX.RET.CODE% <> 0 THEN BEGIN
13616: cbc3:          SB.EVENT.NO% = 23
13617: cbd0:          SB.UNIQUE$ = FN.Z.PACK(STR$(ADX.RET.CODE%),5) + "04   "
13618: cc11:          SB.MESSAGE$ = ""
13619: cc26:          GOSUB SB.LOG.AN.EVENT
13620: cc38:       ENDIF
13621: cc40: 
13622: cc40:       SB.MESSAGE$ = ""
13623: cc55: 
13624: cc55:    RETURN
13625: cc65: 
13626: cc65: \******************************************************************************
13627: cc65: \***
13628: cc65: \***   Subroutine : SB.LOG.AN.EVENT
13629: cc65: \***
13630: cc65: \***   Purpose    : General routine to log an event using passed data. If
13631: cc65: \***                program has been started manually for a re-run then also
13632: cc65: \***                display a message on the background screen.
13633: cc65: \***                The event will be preceded by one indicating the port
13634: cc65: \***                being monitored by the program in error.
13635: cc65: \***
13636: cc65: \***   Parameters : 2
13637: cc65: \***
13638: cc65: \***      SB.EVENT.NO% = number of event to be logged
13639: cc65: \***      SB.UNIQUE$   = 10 byte block of data unique to event
13640: cc65: \***
13641: cc65: \***   Output     : none
13642: cc65: \***
13643: cc65: \***   Error action : none
13644: cc65: \***
13645: cc65: \******************************************************************************
13646: cc65: 
13647: cc65:    SB.LOG.AN.EVENT:
13648: cc75: 
13649: cc75:       MESSAGE.NO% = 0
13650: cc83:       UNIQUE.2$ = ""
13651: cc98: 
13652: cc98:       PORT.STRING$ = "PORT : " + MONITORED.PORT$ + "  "                 ! DJAL
13653: ccc1:       PORT.EVENT% = 75                                                  ! DJAL
13654: ccd1: 
13655: ccd1:       RC% = APPLICATION.LOG(MESSAGE.NO%,                                \ ILC
13656: cd08:                             PORT.STRING$,                               \ DJAL
13657: cd08:                             UNIQUE.2$,                                  \ DJAL
13658: cd08:                             PORT.EVENT% )                               ! DJAL
13659: cd08: 
13660: cd08:       RC% = APPLICATION.LOG(MESSAGE.NO%,                                \ ILC
13661: cd38:                             SB.UNIQUE$,                                 \
13662: cd38:                             UNIQUE.2$,                                  \
13663: cd38:                             SB.EVENT.NO% )
13664: cd38: 
13665: cd38:    RETURN
13666: cd48: 
13667: cd48: \******************************************************************************
13668: cd48: \***
13669: cd48: \***   Subroutine : SB.FORMAT.ERROR.DATA
13670: cd48: \***
13671: cd48: \***   Purpose    : General routine to format the common error reporting
13672: cd48: \***                data
13673: cd48: \***
13674: cd48: \***   Parameters : 0
13675: cd48: \***
13676: cd48: \***   Output     :
13677: cd48: \***      SB.ERRS$   = ERRN converted to a 4 byte string
13678: cd48: \***      SB.ERRL$   = ERRL zero packed up to 6 bytes
13679: cd48: \***      SB.ERRF$   = ERRF converted to a reporting number (1 byte)
13680: cd48: \***
13681: cd48: \***   Error action : if hex conversion or string conversion fails then the
13682: cd48: \***                  program ends
13683: cd48: \***
13684: cd48: \******************************************************************************
13685: cd48: 
13686: cd48:    SB.FORMAT.ERROR.DATA:
13687: cd58: 
13688: cd58:       RC% = CONV.TO.HEX( ERRN )
13689: cd78:       IF RC% <> 0 THEN                                                  \
13690: cd8a:          GOTO PROGRAM.QUIT
13691: cd95: 
13692: cd95:       RC% = CONV.TO.STRING(0,                                           \
13693: cdb9:                            ERRN )
13694: cdb9:       IF RC% <> 0 THEN                                                  \
13695: cdcb:          GOTO PROGRAM.QUIT
13696: cdd6:       SB.ERRS$ = F17.RETURNED.STRING$
13697: cdf2: 
13698: cdf2:       SB.ERRL$ = FN.Z.PACK(STR$(ERRL), 6)
13699: ce21:       SB.ACTION$ = "R" : SB.INTEGER% = ERRF% : SB.STRING$ = ""
13700: ce4b:       GOSUB SB.FILE.UTILS
13701: ce5d:       SB.ERRF$ = CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +                       \MDS
13702: cea6:                  CHR$(SHIFT(SB.FILE.REP.NUM%,0))                         !MDS
13703: cea6: 
13704: cea6:    RETURN
13705: ceb6: 
13706: ceb6: \******************************************************************************
13707: ceb6: \***
13708: ceb6: \***   Subroutine : SB.LOG.PDT.ERROR
13709: ceb6: \***
13710: ceb6: \***   Purpose    : Standard PDT error event logging
13711: ceb6: \***
13712: ceb6: \***   Parameters : none
13713: ceb6: \***      routine picks up current / received state and data length etc.
13714: ceb6: \***
13715: ceb6: \***   Output     : none
13716: ceb6: \***
13717: ceb6: \***   Error action : none
13718: ceb6: \***
13719: ceb6: \******************************************************************************
13720: ceb6: 
13721: ceb6:    SB.LOG.PDT.ERROR:
13722: cec6: 
13723: cec6:       IF EXP.STATES$ = "B" AND                                          \ JLC
13724: cf30:          PREV.LOGGED.STATE$ <> LOG.STATE$ + EXP.STATES$ THEN BEGIN      ! JLC
13725: cf30:          RETURN                                                         ! JLC
13726: cf40:       ENDIF                                                             ! JLC
13727: cf48:       PREV.LOGGED.STATE$ = LOG.STATE$ + EXP.STATES$                     ! JLC
13728: cf71: 
13729: cf71:       IF FN.Z.PACK(CURR.TERMINAL$,6) <> "??????" THEN BEGIN             ! JLC
13730: cfa6:          SB.EVENT.NO% = 62
13731: cfb3:          SB.UNIQUE$ = LOG.STATE$ +                                      \
13732: d015:                       LEFT$(EXP.STATES$+"   ",3) +                      \
13733: d015:                       FN.Z.PACK(CURR.TERMINAL$,6)
13734: d015:          GOSUB SB.LOG.AN.EVENT
13735: d027:       ENDIF                                                             ! JLC
13736: d02f: 
13737: d02f:    RETURN
13738: d03f: 
13739: d03f: \******************************************************************************
13740: d03f: \***
13741: d03f: \***   Subroutine : SB.FILE.OPEN.ERROR
13742: d03f: \***
13743: d03f: \***   Purpose    : Log an event 6 with unique data indicating an error has
13744: d03f: \***                occurred whilst attempting to open a file.
13745: d03f: \***
13746: d03f: \***   Parameters : 1
13747: d03f: \***
13748: d03f: \***      CURR.SESS.NUM% = file session number of the file that caused the
13749: d03f: \***                       error, this is used to look-up the file reporting
13750: d03f: \***                       number that is logged in the event's unique data.
13751: d03f: \***
13752: d03f: \***   Output     : none
13753: d03f: \***
13754: d03f: \***   Error action : none
13755: d03f: \***
13756: d03f: \******************************************************************************
13757: d03f: 
13758: d03f:    SB.FILE.OPEN.ERROR:
13759: d04f: 
13760: d04f:       SB.ACTION$ = "R"
13761: d064:       SB.INTEGER% = CURR.SESS.NUM%
13762: d073:       SB.STRING$ = ""
13763: d088:       GOSUB SB.FILE.UTILS
13764: d09a:       SB.EVENT.NO% = 106                                              ! LSMG
13765: d0a7:       SB.UNIQUE$ = "O" + CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +            \ LSMG
13766: d10f:                    CHR$(SHIFT(SB.FILE.REP.NUM%,0)) +                  \ LSMG
13767: d10f:                    PACK$(STRING$(16,"0"))                             ! LSMG
13768: d10f:       GOSUB SB.LOG.AN.EVENT
13769: d121: 
13770: d121:    RETURN
13771: d131: 
13772: d131: \******************************************************************************
13773: d131: \***
13774: d131: \***   Subroutine : SB.FILE.READ.ERROR
13775: d131: \***
13776: d131: \***   Purpose    : Log an event 6 with unique data indicating an error has
13777: d131: \***                occurred whilst attempting to read a file.
13778: d131: \***
13779: d131: \***   Parameters : 2
13780: d131: \***
13781: d131: \***      CURR.SESS.NUM%  = file session number of the file that caused the
13782: d131: \***                        error, this is used to look-up the file reporting
13783: d131: \***                        number that is logged in the event's unique data.
13784: d131: \***      CURRENT.KEY$    = value of key used to try to read from file.
13785: d131: \***
13786: d131: \***   Output     : none
13787: d131: \***
13788: d131: \***   Error action : none
13789: d131: \***
13790: d131: \******************************************************************************
13791: d131: 
13792: d131:    SB.FILE.READ.ERROR:
13793: d141: 
13794: d141:       SB.ACTION$ = "R"
13795: d156:       SB.INTEGER% = CURR.SESS.NUM%
13796: d165:       SB.STRING$ = ""
13797: d17a:       GOSUB SB.FILE.UTILS
13798: d18c:       IF CURRENT.KEY$ <> "SECTOR" AND                                   \ MDS
13799: d1e5:          CURRENT.KEY$ <> PACK$(STRING$(7,"??")) THEN BEGIN              ! MDS
13800: d1e5:          SB.EVENT.NO% = 6
13801: d1f2:          SB.UNIQUE$ = "R" +                                             \
13802: d22e:          CHR$(SB.FILE.REP.NUM%) +                                       \
13803: d22e:          FN.Z.PACK(CURRENT.KEY$,8)
13804: d22e:       ENDIF ELSE BEGIN
13805: d236:           SB.EVENT.NO% = 106                                            ! LSMG
13806: d243:           SB.UNIQUE$ = "R" + CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +          \ LSMG
13807: d2a3:                        CHR$(SHIFT(SB.FILE.REP.NUM%,0)) +                \ LSMG
13808: d2a3:                        CURRENT.KEY$                                     ! LSMG
13809: d2a3:       ENDIF                                                             ! LSMG
13810: d2ab:       GOSUB SB.LOG.AN.EVENT
13811: d2bd: 
13812: d2bd:    RETURN
13813: d2cd: 
13814: d2cd: \******************************************************************************
13815: d2cd: \***
13816: d2cd: \***   Subroutine : SB.FILE.WRITE.ERROR
13817: d2cd: \***
13818: d2cd: \***   Purpose    : Log an event 6 with unique data indicating an error has
13819: d2cd: \***                occurred whilst attempting to write a file.
13820: d2cd: \***
13821: d2cd: \***   Parameters : 2
13822: d2cd: \***
13823: d2cd: \***      CURR.SESS.NUM%  = file session number of the file that caused the
13824: d2cd: \***                        error, this is used to look-up the file reporting
13825: d2cd: \***                        number that is logged in the event's unique data.
13826: d2cd: \***      CURRENT.KEY$    = value of key used to try to write to file.
13827: d2cd: \***
13828: d2cd: \***   Output     : none
13829: d2cd: \***
13830: d2cd: \***   Error action : none
13831: d2cd: \***
13832: d2cd: \******************************************************************************
13833: d2cd: 
13834: d2cd:    SB.FILE.WRITE.ERROR:
13835: d2dd: 
13836: d2dd:       SB.ACTION$ = "R"
13837: d2f2:       SB.INTEGER% = CURR.SESS.NUM%
13838: d301:       SB.STRING$ = ""
13839: d316:       GOSUB SB.FILE.UTILS
13840: d328:       IF CURRENT.KEY$ <> "SECTOR" THEN BEGIN                            ! DSW
13841: d343:          SB.EVENT.NO% = 6
13842: d350:          SB.UNIQUE$ = "W" + CHR$(SB.FILE.REP.NUM%) +                    \
13843: d38d:          FN.Z.PACK(CURRENT.KEY$,8)
13844: d38d:       ENDIF ELSE BEGIN                                                  ! DSW
13845: d395:           SB.EVENT.NO% = 106                                            ! LSMG
13846: d3a2:           SB.UNIQUE$ = "W" + CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +          \ LSMG
13847: d408:                        CHR$(SHIFT(SB.FILE.REP.NUM%,0)) +                \ LSMG
13848: d408:                        FN.Z.PACK(CURRENT.KEY$,8)                        ! LSMG
13849: d408:       ENDIF                                                             ! DSW
13850: d410:       GOSUB SB.LOG.AN.EVENT
13851: d422: 
13852: d422:    RETURN
13853: d432: 
13854: d432: \******************************************************************************
13855: d432: \***
13856: d432: \***   Subroutine : SB.FILE.CREATE.ERROR
13857: d432: \***
13858: d432: \***   Purpose    : Log an event 6 with unique data indicating an error has
13859: d432: \***                occurred whilst attempting to create a file.
13860: d432: \***
13861: d432: \***   Parameters : 2
13862: d432: \***
13863: d432: \***      CURR.SESS.NUM%  = file session number of the file that caused the
13864: d432: \***                        error, this is used to look-up the file reporting
13865: d432: \***                        number that is logged in the event's unique data.
13866: d432: \***
13867: d432: \***   Output     : none
13868: d432: \***
13869: d432: \***   Error action : none
13870: d432: \***
13871: d432: \******************************************************************************
13872: d432: 
13873: d432:    SB.FILE.CREATE.ERROR:
13874: d442: 
13875: d442:       SB.ACTION$ = "R"
13876: d457:       SB.INTEGER% = CURR.SESS.NUM%
13877: d466:       SB.STRING$ = ""
13878: d47b:       GOSUB SB.FILE.UTILS
13879: d48d:         SB.EVENT.NO% = 106                                              ! LSMG
13880: d49a:         SB.UNIQUE$ = "C" + CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +            \ LSMG
13881: d4e7:                       CHR$(SHIFT(SB.FILE.REP.NUM%,0))                   ! LSMG
13882: d4e7:       GOSUB SB.LOG.AN.EVENT
13883: d4f9: 
13884: d4f9:    RETURN
13885: d509: 
13886: d509: \******************************************************************************
13887: d509: \***
13888: d509: \***   Subroutine : SB.FILE.DELETE.ERROR
13889: d509: \***
13890: d509: \***   Purpose    : Log an event 6 with unique data indicating an error has
13891: d509: \***                occurred whilst attempting to delete a file.
13892: d509: \***
13893: d509: \***   Parameters : 2
13894: d509: \***
13895: d509: \***      CURR.SESS.NUM%  = file session number of the file that caused the
13896: d509: \***                        error, this is used to look-up the file reporting
13897: d509: \***                        number that is logged in the event's unique data.
13898: d509: \***
13899: d509: \***   Output     : none
13900: d509: \***
13901: d509: \***   Error action : none
13902: d509: \***
13903: d509: \******************************************************************************
13904: d509: 
13905: d509:    SB.FILE.DELETE.ERROR:                                                ! DJAL
13906: d519: 
13907: d519:       SB.ACTION$ = "R"                                                  ! DJAL
13908: d52e:       SB.INTEGER% = CURR.SESS.NUM%                                      ! DJAL
13909: d53d:       SB.STRING$ = ""                                                   ! DJAL
13910: d552:       GOSUB SB.FILE.UTILS                                               ! DJAL
13911: d564:         SB.EVENT.NO% = 106                                              ! LSMG
13912: d571:         SB.UNIQUE$ = "D" + CHR$(SHIFT(SB.FILE.REP.NUM%,8)) +            \ LSMG
13913: d5be:                      CHR$(SHIFT(SB.FILE.REP.NUM%,0))                    ! LSMG
13914: d5be:       GOSUB SB.LOG.AN.EVENT                                             ! DJAL
13915: d5d0: 
13916: d5d0:    RETURN                                                               ! DJAL
13917: d5e0: 
13918: d5e0: \******************************************************************************
13919: d5e0: \******************************************************************************
13920: d5e0: \***                                                                        ***
13921: d5e0: \***                                                                        ***
13922: d5e0: \***   E R R O R   H A N D L I N G                                          ***
13923: d5e0: \***                                                                        ***
13924: d5e0: \***                                                                        ***
13925: d5e0: \******************************************************************************
13926: d5e0: \******************************************************************************
13927: d5e0: 
13928: d5e0: \******************************************************************************
13929: d5e0: \***
13930: d5e0: \***   OPEN.ERROR:
13931: d5e0: \***
13932: d5e0: \***      log an event 6 (open error)
13933: d5e0: \***      set RECEIVE.STATE$ to "*"
13934: d5e0: \***
13935: d5e0: \***   GOTO PROGRAM.EXIT (no return is possible)
13936: d5e0: \***
13937: d5e0: \******************************************************************************
13938: d5e0: 
13939: d5e0:    OPEN.ERROR:
13940: d5f0: 
13941: d5f0:       TEMP.STATE$ = RECEIVE.STATE$
13942: d60c:       GOSUB SB.FILE.OPEN.ERROR
13943: d61e:       RECEIVE.STATE$ = "*"
13944: d635: 
13945: d635:    GOTO PROGRAM.EXIT
13946: d640: 
13947: d640: \******************************************************************************
13948: d640: \***
13949: d640: \***   READ.ERROR:
13950: d640: \***
13951: d640: \***      log an event 6 (read error)
13952: d640: \***      set RECEIVE.STATE$ to "*"
13953: d640: \***
13954: d640: \***   GOTO PROGRAM.EXIT (no return is possible)
13955: d640: \***
13956: d640: \******************************************************************************
13957: d640: 
13958: d640:    READ.ERROR:
13959: d650: 
13960: d650:       TEMP.STATE$ = RECEIVE.STATE$
13961: d66c:       GOSUB SB.FILE.READ.ERROR
13962: d67e:       RECEIVE.STATE$ = "*"
13963: d695: 
13964: d695: 
13965: d695:    GOTO PROGRAM.EXIT
13966: d6a0: 
13967: d6a0: \******************************************************************************
13968: d6a0: \***
13969: d6a0: \***   WRITE.ERROR:
13970: d6a0: \***
13971: d6a0: \***      log an event 6 (write error)
13972: d6a0: \***      set RECEIVE.STATE$ to "*"
13973: d6a0: \***
13974: d6a0: \***   GOTO PROGRAM.EXIT (no return is possible)
13975: d6a0: \***
13976: d6a0: \******************************************************************************
13977: d6a0: 
13978: d6a0:    WRITE.ERROR:
13979: d6b0: 
13980: d6b0:       TEMP.STATE$ = RECEIVE.STATE$
13981: d6cc:       GOSUB SB.FILE.WRITE.ERROR
13982: d6de:       RECEIVE.STATE$ = "*"
13983: d6f5: 
13984: d6f5:    GOTO PROGRAM.EXIT
13985: d700: 
13986: d700: \******************************************************************************
13987: d700: \**
13988: d700: \***   CREATE.ERROR:
13989: d700: \***
13990: d700: \***      log an event 6 (create error)
13991: d700: \***      set RECEIVE.STATE$ to "*"
13992: d700: \***
13993: d700: \***   GOTO PROGRAM.EXIT (no return is possible)
13994: d700: \***
13995: d700: \******************************************************************************
13996: d700: 
13997: d700:    CREATE.ERROR:
13998: d710: 
13999: d710:       TEMP.STATE$ = RECEIVE.STATE$
14000: d72c:       GOSUB SB.FILE.CREATE.ERROR
14001: d73e:       RECEIVE.STATE$ = "*"
14002: d755: 
14003: d755:    GOTO PROGRAM.EXIT
14004: d760: 
14005: d760: \******************************************************************************
14006: d760: \***
14007: d760: \***   DELETE.ERROR:
14008: d760: \***
14009: d760: \***      log an event 6 (delete error)
14010: d760: \***      set RECEIVE.STATE$ to "*"
14011: d760: \***
14012: d760: \***   GOTO PROGRAM.EXIT (no return is possible)
14013: d760: \***
14014: d760: \******************************************************************************
14015: d760: 
14016: d760:    DELETE.ERROR:                                                        ! DJAL
14017: d770: 
14018: d770:       TEMP.STATE$ = RECEIVE.STATE$                                      ! DJAL
14019: d78c:       GOSUB SB.FILE.DELETE.ERROR                                        ! DJAL
14020: d79e:       RECEIVE.STATE$ = "*"                                              ! DJAL
14021: d7b5: 
14022: d7b5:    GOTO PROGRAM.EXIT                                                    ! DJAL
14023: d7c0: 
14024: d7c0: 
14025: d7c0: 
14026: d7c0: \******************************************************************************
14027: d7c0: \***
14028: d7c0: \***   DRSMQ.NOT.FOUND:
14029: d7c0: \***
14030: d7c0: \***      create DRSMQ
14031: d7c0: \***
14032: d7c0: \***   GOTO DRSMQ.CONTINUE:
14033: d7c0: \***
14034: d7c0: \******************************************************************************
14035: d7c0: 
14036: d7c0:    DRSMQ.NOT.FOUND:                                                     ! HDS
14037: d7d0: 
14038: d7d0:       IF END #DRSMQ.SESS.NUM% THEN CREATE.ERROR                         ! HDS
14039: d7ec: 
14040: d7ec:       CREATE POSFILE DRSMQ.FILE.NAME$ AS DRSMQ.SESS.NUM%                \ HDS
14041: d813:              BUFFSIZE 10240 LOCKED
14042: d813:       DRSMQ.OPEN.FLAG$ = "Y"
14043: d82a: 
14044: d82a:       GOTO DRSMQ.CONTINUE
14045: d835: 
14046: d835: 
14047: d835: \******************************************************************************
14048: d835: \***
14049: d835: \***   ERROR.DETECTED:
14050: d835: \***
14051: d835: \***      if an error has occurred after a 'fatal' error then quit program
14052: d835: \***
14053: d835: \***      increment ERROR.COUNT%
14054: d835: \***      NOTE : all returns from error detected should decrement the
14055: d835: \***             variable ERROR.COUNT% and exit using the RESUME command
14056: d835: \***      if ERROR.COUNT% > 1 then end program (error within error detected)
14057: d835: \***
14058: d835: \***      if the CSR workfile does not exist then resume
14059: d835: \***
14060: d835: \***      set-up common error reporting information
14061: d835: \***
14062: d835: \***      if the error is an access conflict on CSR, EPSOM or PCHK files then
14063: d835: \***          resume at FILE.CONFLICT
14064: d835: \***
14065: d835: \***      if unable to open PSS38 communication pipes then
14066: d835: \***         wait 3 seconds then retry
14067: d835: \***      endif
14068: d835: \***
14069: d835: \***      if an access conflict occurs on a session then retry
14070: d835: \***
14071: d835: \***      if error is invalid characters in VAL() then
14072: d835: \***         store RECEIVE.STATE$
14073: d835: \***         set RECEIVE.STATE$ to "*"
14074: d835: \***         use stored receive state variable to decide where to resume
14075: d835: \***      endif
14076: d835: \***
14077: d835: \***      if error is out of memory then log an event, using ADXERROR and
14078: d835: \***      quit program
14079: d835: \***
14080: d835: \***      log an event 1
14081: d835: \***
14082: d835: \***   resume PROGRAM.EXIT
14083: d835: \***
14084: d835: \******************************************************************************
14085: d835: 
14086: d835: ERROR.DETECTED:
14087: d845: 
14088: d845:    IF QUIT.FLAG$ = "Y" THEN RESUME PROGRAM.QUIT
14089: d86f: 
14090: d86f:    IF ERR = "CU" THEN RESUME                                            ! DSW
14091: d8a4: 
14092: d8a4:    ERROR.COUNT% = ERROR.COUNT% + 1
14093: d8b3:    IF ERROR.COUNT% > 1 THEN RESUME PROGRAM.QUIT
14094: d8d4: 
14095: d8d4:    GOSUB SB.FORMAT.ERROR.DATA
14096: d8e6: 
14097: d8e6:    IF ERR = "OE" AND ERRF% = 0 THEN BEGIN                               ! DSW
14098: d92e:       ERROR.COUNT% = ERROR.COUNT% - 1                                   ! DSW
14099: d93d: \     CSRWF.EXISTS% = 0                                                 ! DSW !2.9NWB
14100: d93d:       RESUME                                                            ! DSW
14101: d954:    ENDIF                                                                ! DSW
14102: d95c: 
14103: d95c:    IF (ERRN AND 0000FFFFh) = 0000400Ch THEN BEGIN                       ! DSW
14104: d999:       IF SB.FILE.REP.NUM% = EPSOM.REPORT.NUM%                           \ MDS
14105: da26: \     OR SB.FILE.REP.NUM% = CSR.REPORT.NUM%                             \ MDS !2.9NWB
14106: da26:       OR SB.FILE.REP.NUM% = PCHK.REPORT.NUM%                            \ MDS
14107: da26:       OR SB.FILE.REP.NUM% = DIREC.REPORT.NUM%                           \ MDS
14108: da26:       OR SB.FILE.REP.NUM% = UOD.REPORT.NUM%                             \ MDS
14109: da26:       OR SB.FILE.REP.NUM% = CCDMY.REPORT.NUM%                           \ MDS
14110: da26:       OR SB.FILE.REP.NUM% = INVOK.REPORT.NUM%                           \ 1.5
14111: da26:       OR SB.FILE.REP.NUM% = STKTK.REPORT.NUM% THEN BEGIN                ! 1.5
14112: da26:          ERROR.COUNT% = ERROR.COUNT% - 1                                ! DSW
14113: da35:          IF LOCATION$ <> "STARTUP" THEN BEGIN                           ! DSW
14114: da50:             RESUME LOCKED.FILE                                          ! DSW
14115: da69:          ENDIF ELSE BEGIN                                               ! DSW
14116: da71:             RESUME IGNORE.LOCKED.FILE                                   ! DSW
14117: da88:          ENDIF                                                          ! DSW
14118: da90:       ENDIF                                                             ! DSW
14119: da98:    ENDIF                                                                ! DSW
14120: daa0: 
14121: daa0:    IF ERR = "OE"                                                        \
14122: db0f:    AND (CURR.SESS.NUM% = PIPEI.SESS.NUM%                                \
14123: db0f:    OR CURR.SESS.NUM% = PIPEO.SESS.NUM%                                  \
14124: db0f:    OR CURR.SESS.NUM% = PLDT.SESS.NUM%) THEN BEGIN                       ! HDS
14125: db0f:       ERROR.COUNT% = ERROR.COUNT% - 1
14126: db1e:       WAIT ; 3 * 1000
14127: db33:       RESUME RETRY
14128: db4a:    ENDIF
14129: db52: 
14130: db52:    IF (ERRN AND 0000FFFFh) = 400Ch THEN BEGIN
14131: db8c:       ERROR.COUNT% = ERROR.COUNT% - 1
14132: db9b:       RESUME RETRY
14133: dbb2:    ENDIF
14134: dbba: 
14135: dbba:    IF ERR = "IH" AND ERRN = 00000094h THEN BEGIN
14136: dc0e:       TEMP.STATE$ = RECEIVE.STATE$
14137: dc2a:       RES.POS% = MATCH(TEMP.STATE$, "CEFG", 1)
14138: dc48:       IF RES.POS% = 0 THEN BEGIN
14139: dc57:          RESUME PROGRAM.EXIT
14140: dc70:       ENDIF ELSE BEGIN
14141: dc78:          RESUME PROGRAM.QUIT
14142: dc8f:       ENDIF
14143: dc97:    ENDIF
14144: dc9f: 
14145: dc9f:    SB.EVENT.NO% = 101
14146: dcac:    SB.UNIQUE$ = SB.ERRS$ + SB.ERRF$ +                                   \MDS
14147: dd0c:                 PACK$(RIGHT$(STRING$(8,"0")+SB.ERRL$,8))                !MDS
14148: dd0c:    GOSUB SB.LOG.AN.EVENT
14149: dd1e: 
14150: dd1e:    ERROR.COUNT% = ERROR.COUNT% - 1
14151: dd2d: RESUME PROGRAM.EXIT
14152: dd49: 
14153: dd49: END
14154: dd49: End of Compilation
